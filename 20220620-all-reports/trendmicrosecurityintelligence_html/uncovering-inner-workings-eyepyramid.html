
<!DOCTYPE html>
<html lang="en-US">
<head>
	<title>Uncovering the Inner Workings of EyePyramid - TrendLabs Security Intelligence Blog</title>
	<meta http-equiv="x-ua-compatible" content="IE=edge" >
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="pingback" href="https://blog.trendmicro.com/trendlabs-security-intelligence/xmlrpc.php" />
	<script type="text/javascript">
var siteUrl = "https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs";
var imageUrl = "https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/images";
var defaultBtnColor = "red";
var socialInactiveAlpha = "1";
var socialActiveAlpha = ".6";
</script>

<!--Plugin Global Hide Admin Tool Bar Active-->

<!-- This website is patched against a big problem not solved from WordPress 3.3+ to date -->

<meta name='robots' content='max-image-preview:large, index, follow, max-snippet:-1, max-video-preview:-1' />
<script type="text/javascript">
var utag_data = {
    "siteName": "",
    "siteDescription": "",
    "postCategory": [
        "malware",
        "targeted_attacks"
    ],
    "postTags": [
        "eyepyramid",
        "italy"
    ],
    "pageType": "post",
    "postId": 76959,
    "postTitle": "Uncovering the Inner Workings of EyePyramid",
    "postAuthor": "Federico Maggi (Senior Threat Researcher)",
    "postDate": "2017\/01\/18",
    "_edit_last": [
        "248"
    ],
    "_yoast_wpseo_content_score": [
        "30"
    ],
    "_jd_tweet_this": [
        "yes"
    ],
    "_yoast_wpseo_primary_category": [
        "14"
    ],
    "_disable_excerpt": [
        "false"
    ],
    "_disable_meta": [
        "false"
    ],
    "_disable_comments": [
        "false"
    ],
    "_disable_tags": [
        "false"
    ],
    "_disable_read_more": [
        "false"
    ],
    "_disable_featured_image": [
        "false"
    ],
    "_disable_image_link": [
        "false"
    ],
    "_image_border": [
        "smallBorder"
    ],
    "_image_shadow_type": [
        "0"
    ],
    "_image_lightbox": [
        "none"
    ],
    "_image_lightbox_url": [
        ""
    ],
    "_image_icon": [
        ""
    ],
    "_add_slider": [
        "false"
    ],
    "_slider_selector": [
        "-1"
    ],
    "_add_video": [
        "false"
    ],
    "_video_url": [
        ""
    ],
    "_single_sidebar": [
        "false"
    ],
    "_post_sidebar": [
        ""
    ],
    "_post_sidebar_align": [
        "rightSideBar"
    ],
    "_disable_single_meta": [
        "false"
    ],
    "_disable_single_comments": [
        "false"
    ],
    "_disable_single_tags": [
        "false"
    ],
    "_edit_lock": [
        "1486453435:21"
    ],
    "tweetbackscheck": [
        "1519826304"
    ],
    "shorturls": [
        "a:1:{s:9:\"permalink\";s:67:\"http:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/?p=76959\";}"
    ],
    "twittercomments": [
        "a:0:{}"
    ],
    "tweetcount": [
        "0"
    ],
    "_yoast_wpseo_focuskw_text_input": [
        "EyePyramid"
    ],
    "_yoast_wpseo_focuskw": [
        "EyePyramid"
    ],
    "_yoast_wpseo_linkdex": [
        "80"
    ],
    "_wpt_short_url": [
        "http:\/\/bit.ly\/2iRcU43"
    ],
    "_wp_jd_target": [
        "http:\/\/bit.ly\/2iRcU43"
    ],
    "_jd_wp_twitter": [
        "a:1:{i:0;s:87:\"New post: Uncovering the Inner Workings of EyePyramid http:\/\/bit.ly\/2iRcU43 @TrendMicro\";}"
    ],
    "_wpt_status_message": [
        "Tweet sent successfully."
    ],
    "_thumbnail_id": [
        "73278"
    ],
    "userRole": "guest"
};
</script>

	<!-- This site is optimized with the Yoast SEO plugin v15.9.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Uncovering the Inner Workings of EyePyramid - TrendLabs Security Intelligence Blog" />
	<meta property="og:description" content="Two Italians referred to as the ‚ÄúOcchionero brothers‚Äù have been arrested and accused of using malware and a¬†carefully-prepared spear-phishing scheme to spy on high-profile politicians and businessmen. This case has been called &quot;EyePyramid&quot;, which we first discussed¬†last week. (Conspiracy theories aside, the name¬†came from a domain name and directory path that was found as part of the research.)" />
	<meta property="og:url" content="https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/" />
	<meta property="article:published_time" content="2017-01-18T15:56:56+00:00" />
	<meta property="article:modified_time" content="2017-01-31T23:40:50+00:00" />
	<meta property="og:image" content="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks.jpg" />
	<meta property="og:image:width" content="400" />
	<meta property="og:image:height" content="400" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Federico Maggi (Senior Threat Researcher)">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="13 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#website","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/","name":"","description":"","potentialAction":[{"@type":"SearchAction","target":"https://blog.trendmicro.com/trendlabs-security-intelligence/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/#primaryimage","inLanguage":"en-US","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks.jpg","width":400,"height":400},{"@type":"WebPage","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/#webpage","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/","name":"Uncovering the Inner Workings of EyePyramid - TrendLabs Security Intelligence Blog","isPartOf":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#website"},"primaryImageOfPage":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/#primaryimage"},"datePublished":"2017-01-18T15:56:56+00:00","dateModified":"2017-01-31T23:40:50+00:00","author":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#/schema/person/e35bee162bc8e5fb0e340532e213bc6d"},"breadcrumb":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/"]}]},{"@type":"BreadcrumbList","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/","name":"Uncovering the Inner Workings of EyePyramid"}}]},{"@type":"Person","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#/schema/person/e35bee162bc8e5fb0e340532e213bc6d","name":"Federico Maggi (Senior Threat Researcher)"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//m9m6e2w5.stackpathcdn.com' />
<link rel='dns-prefetch' href='//cdn.shareaholic.net' />
<link rel='dns-prefetch' href='//www.shareaholic.net' />
<link rel='dns-prefetch' href='//analytics.shareaholic.com' />
<link rel='dns-prefetch' href='//recs.shareaholic.com' />
<link rel='dns-prefetch' href='//go.shareaholic.com' />
<link rel='dns-prefetch' href='//partner.shareaholic.com' />
<link rel="alternate" type="application/rss+xml" title=" &raquo; Feed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/feed/" />
<link rel="alternate" type="application/rss+xml" title=" &raquo; Comments Feed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/comments/feed/" />
<!-- Shareaholic - https://www.shareaholic.com -->
<link rel='preload' href='//cdn.shareaholic.net/assets/pub/shareaholic.js' as='script'/>
<script data-no-minify='1' data-cfasync='false'>
_SHR_SETTINGS = {"endpoints":{"local_recs_url":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-admin\/admin-ajax.php?action=shareaholic_permalink_related","ajax_url":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-admin\/admin-ajax.php"},"site_id":"f9f1a771608a24e84c49a8532e282dc1","url_components":{"year":"2017","monthnum":"01","day":"18","hour":"07","minute":"56","second":"56","post_id":"76959","postname":"uncovering-inner-workings-eyepyramid","category":"targeted_attacks"}};
</script>
<script data-no-minify='1' data-cfasync='false' src='//cdn.shareaholic.net/assets/pub/shareaholic.js' data-shr-siteid='f9f1a771608a24e84c49a8532e282dc1' async ></script>

<!-- Shareaholic Content Tags -->
<meta name='shareaholic:language' content='en-US' />
<meta name='shareaholic:url' content='https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/' />
<meta name='shareaholic:keywords' content='tag:eyepyramid, tag:italy, cat:malware, cat:targeted attacks, type:post' />
<meta name='shareaholic:article_published_time' content='2017-01-18T07:56:56-08:00' />
<meta name='shareaholic:article_modified_time' content='2017-01-31T15:40:50-08:00' />
<meta name='shareaholic:shareable_page' content='true' />
<meta name='shareaholic:article_author_name' content='Federico Maggi (Senior Threat Researcher)' />
<meta name='shareaholic:site_id' content='f9f1a771608a24e84c49a8532e282dc1' />
<meta name='shareaholic:wp_version' content='9.6.1' />
<meta name='shareaholic:image' content='https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks-300x300.jpg' />
<!-- Shareaholic Content Tags End -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"wpemoji":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-includes\/js\/wp-emoji.js?ver=3934800cf10e43fe39ddd35aef4d4ed8","twemoji":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-includes\/js\/twemoji.js?ver=3934800cf10e43fe39ddd35aef4d4ed8"}};
			/**
 * @output wp-includes/js/wp-emoji-loader.js
 */

( function( window, document, settings ) {
	var src, ready, ii, tests;

	// Create a canvas element for testing native browser support of emoji.
	var canvas = document.createElement( 'canvas' );
	var context = canvas.getContext && canvas.getContext( '2d' );

	/**
	 * Checks if two sets of Emoji characters render the same visually.
	 *
	 * @since 4.9.0
	 *
	 * @private
	 *
	 * @param {number[]} set1 Set of Emoji character codes.
	 * @param {number[]} set2 Set of Emoji character codes.
	 *
	 * @return {boolean} True if the two sets render the same.
	 */
	function emojiSetsRenderIdentically( set1, set2 ) {
		var stringFromCharCode = String.fromCharCode;

		// Cleanup from previous test.
		context.clearRect( 0, 0, canvas.width, canvas.height );
		context.fillText( stringFromCharCode.apply( this, set1 ), 0, 0 );
		var rendered1 = canvas.toDataURL();

		// Cleanup from previous test.
		context.clearRect( 0, 0, canvas.width, canvas.height );
		context.fillText( stringFromCharCode.apply( this, set2 ), 0, 0 );
		var rendered2 = canvas.toDataURL();

		return rendered1 === rendered2;
	}

	/**
	 * Detects if the browser supports rendering emoji or flag emoji.
	 *
	 * Flag emoji are a single glyph made of two characters, so some browsers
	 * (notably, Firefox OS X) don't support them.
	 *
	 * @since 4.2.0
	 *
	 * @private
	 *
	 * @param {string} type Whether to test for support of "flag" or "emoji".
	 *
	 * @return {boolean} True if the browser can render emoji, false if it cannot.
	 */
	function browserSupportsEmoji( type ) {
		var isIdentical;

		if ( ! context || ! context.fillText ) {
			return false;
		}

		/*
		 * Chrome on OS X added native emoji rendering in M41. Unfortunately,
		 * it doesn't work when the font is bolder than 500 weight. So, we
		 * check for bold rendering support to avoid invisible emoji in Chrome.
		 */
		context.textBaseline = 'top';
		context.font = '600 32px Arial';

		switch ( type ) {
			case 'flag':
				/*
				 * Test for Transgender flag compatibility. This flag is shortlisted for the Emoji 13 spec,
				 * but has landed in Twemoji early, so we can add support for it, too.
				 *
				 * To test for support, we try to render it, and compare the rendering to how it would look if
				 * the browser doesn't render it correctly (white flag emoji + transgender symbol).
				 */
				isIdentical = emojiSetsRenderIdentically(
					[ 0x1F3F3, 0xFE0F, 0x200D, 0x26A7, 0xFE0F ],
					[ 0x1F3F3, 0xFE0F, 0x200B, 0x26A7, 0xFE0F ]
				);

				if ( isIdentical ) {
					return false;
				}

				/*
				 * Test for UN flag compatibility. This is the least supported of the letter locale flags,
				 * so gives us an easy test for full support.
				 *
				 * To test for support, we try to render it, and compare the rendering to how it would look if
				 * the browser doesn't render it correctly ([U] + [N]).
				 */
				isIdentical = emojiSetsRenderIdentically(
					[ 0xD83C, 0xDDFA, 0xD83C, 0xDDF3 ],
					[ 0xD83C, 0xDDFA, 0x200B, 0xD83C, 0xDDF3 ]
				);

				if ( isIdentical ) {
					return false;
				}

				/*
				 * Test for English flag compatibility. England is a country in the United Kingdom, it
				 * does not have a two letter locale code but rather an five letter sub-division code.
				 *
				 * To test for support, we try to render it, and compare the rendering to how it would look if
				 * the browser doesn't render it correctly (black flag emoji + [G] + [B] + [E] + [N] + [G]).
				 */
				isIdentical = emojiSetsRenderIdentically(
					[ 0xD83C, 0xDFF4, 0xDB40, 0xDC67, 0xDB40, 0xDC62, 0xDB40, 0xDC65, 0xDB40, 0xDC6E, 0xDB40, 0xDC67, 0xDB40, 0xDC7F ],
					[ 0xD83C, 0xDFF4, 0x200B, 0xDB40, 0xDC67, 0x200B, 0xDB40, 0xDC62, 0x200B, 0xDB40, 0xDC65, 0x200B, 0xDB40, 0xDC6E, 0x200B, 0xDB40, 0xDC67, 0x200B, 0xDB40, 0xDC7F ]
				);

				return ! isIdentical;
			case 'emoji':
				/*
				 * So easy, even a baby could do it!
				 *
				 *  To test for Emoji 13 support, try to render a new emoji: Man Feeding Baby.
				 *
				 * The Man Feeding Baby emoji is a ZWJ sequence combining üë® Man, a Zero Width Joiner and üçº Baby Bottle.
				 *
				 * 0xD83D, 0xDC68 == Man emoji.
				 * 0x200D == Zero-Width Joiner (ZWJ) that links the two code points for the new emoji or
				 * 0x200B == Zero-Width Space (ZWS) that is rendered for clients not supporting the new emoji.
				 * 0xD83C, 0xDF7C == Baby Bottle.
				 *
				 * When updating this test for future Emoji releases, ensure that individual emoji that make up the
				 * sequence come from older emoji standards.
				 */
				isIdentical = emojiSetsRenderIdentically(
					[0xD83D, 0xDC68, 0x200D, 0xD83C, 0xDF7C],
					[0xD83D, 0xDC68, 0x200B, 0xD83C, 0xDF7C]
				);

				return ! isIdentical;
		}

		return false;
	}

	/**
	 * Adds a script to the head of the document.
	 *
	 * @ignore
	 *
	 * @since 4.2.0
	 *
	 * @param {Object} src The url where the script is located.
	 * @return {void}
	 */
	function addScript( src ) {
		var script = document.createElement( 'script' );

		script.src = src;
		script.defer = script.type = 'text/javascript';
		document.getElementsByTagName( 'head' )[0].appendChild( script );
	}

	tests = Array( 'flag', 'emoji' );

	settings.supports = {
		everything: true,
		everythingExceptFlag: true
	};

	/*
	 * Tests the browser support for flag emojis and other emojis, and adjusts the
	 * support settings accordingly.
	 */
	for( ii = 0; ii < tests.length; ii++ ) {
		settings.supports[ tests[ ii ] ] = browserSupportsEmoji( tests[ ii ] );

		settings.supports.everything = settings.supports.everything && settings.supports[ tests[ ii ] ];

		if ( 'flag' !== tests[ ii ] ) {
			settings.supports.everythingExceptFlag = settings.supports.everythingExceptFlag && settings.supports[ tests[ ii ] ];
		}
	}

	settings.supports.everythingExceptFlag = settings.supports.everythingExceptFlag && ! settings.supports.flag;

	// Sets DOMReady to false and assigns a ready function to settings.
	settings.DOMReady = false;
	settings.readyCallback = function() {
		settings.DOMReady = true;
	};

	// When the browser can not render everything we need to load a polyfill.
	if ( ! settings.supports.everything ) {
		ready = function() {
			settings.readyCallback();
		};

		/*
		 * Cross-browser version of adding a dom ready event.
		 */
		if ( document.addEventListener ) {
			document.addEventListener( 'DOMContentLoaded', ready, false );
			window.addEventListener( 'load', ready, false );
		} else {
			window.attachEvent( 'onload', ready );
			document.attachEvent( 'onreadystatechange', function() {
				if ( 'complete' === document.readyState ) {
					settings.readyCallback();
				}
			} );
		}

		src = settings.source || {};

		if ( src.concatemoji ) {
			addScript( src.concatemoji );
		} else if ( src.wpemoji && src.twemoji ) {
			addScript( src.twemoji );
			addScript( src.wpemoji );
		}
	}

} )( window, document, window._wpemojiSettings );
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='fes-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/feedburner-email-subscription/css/styles.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<link rel='stylesheet' id='staticStyle-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/style.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='dynamicStyle-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/dynamicCss.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='responsiveStyle-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/responsiveCss.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='custom-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/customCss.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/css/dist/block-library/style.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<link rel='stylesheet' id='fancybox-for-wp-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fancybox-for-wordpress/assets/css/fancybox.css?ver=1.3.4' type='text/css' media='all' />
<link rel='stylesheet' id='wpt-twitter-feed-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/wp-to-twitter/css/twitter-feed.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.2.4' type='text/css' media='all' />
<link rel='stylesheet' id='layerslider_css-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/framework/plug-ins/LayerSlider/css/layerslider.css?ver=3.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='frs-css-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/css/frs.css?ver=2.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='frs-position-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/css/frs-position.css?ver=2.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='OpenSans-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A400italic%2C700italic%2C400%2C700&#038;ver=2.3.1' type='text/css' media='all' />
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/js/jquery/jquery.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/js/jquery/jquery-migrate.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/superfish.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='superFish-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/verticalMenu.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='verticalMenu-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.tools.tabs.min.js?ver=1.2.5' id='jquery-tabs-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.imgpreload.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='imgPreloader-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.colorbox-min.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='colorBox-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.isotope.min.js?ver=1.5.19' id='isotope-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.easing.1.3.js?ver=1.3' id='easing-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/custom.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='custom-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/customJs.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='customJs-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/js/frs.js?ver=2.3.1' id='fluid-responsive-slideshow-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/js/jquery.touchSwipe.min.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='touchSwipe_js-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/js/imagesloaded.min.js?ver=2.3.1' id='images-loaded-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fancybox-for-wordpress/assets/js/jquery.fancybox.js?ver=1.3.4' id='fancybox-for-wp-js'></script>
<script type='application/json' id='wpp-json'>
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":76959,"token":"3997a158b0","lang":0,"debug":0}
</script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/wordpress-popular-posts/assets/js/wpp.min.js?ver=5.2.4' id='wpp-js-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/framework/plug-ins/LayerSlider/js/layerslider.kreaturamedia.jquery.js?ver=3.5.0' id='layerslider_js-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/framework/plug-ins/LayerSlider/js/jquery-easing-1.3.js?ver=1.3.0' id='jquery_easing-js'></script>
<link rel="https://api.w.org/" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/wp/v2/posts/76959" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.trendmicro.com/trendlabs-security-intelligence/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.trendmicro.com/trendlabs-security-intelligence/?p=76959' />
<link rel="alternate" type="application/json+oembed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.trendmicro.com%2Ftrendlabs-security-intelligence%2Funcovering-inner-workings-eyepyramid%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.trendmicro.com%2Ftrendlabs-security-intelligence%2Funcovering-inner-workings-eyepyramid%2F&#038;format=xml" />
<link rel="stylesheet" type="text/css" media="screen" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/date-stamp/date-stamp.css" />
<!-- Fancybox for WordPress v3.3.1 -->
<style type="text/css">
	.fancybox-slide--image .fancybox-content{background-color: #FFFFFF}div.fancybox-caption{display:none !important;}
	
	img.fancybox-image{border-width:10px;border-color:#FFFFFF;border-style:solid;height:auto;}
	div.fancybox-bg{background-color:rgba(102,102,102,0.3);opacity:1 !important;}div.fancybox-content{border-color:#FFFFFF}
	div#fancybox-title{background-color:#FFFFFF}
	div.fancybox-content{background-color:#FFFFFF}
	div#fancybox-title-inside{color:#333333}
	
	
	
	div.fancybox-caption p.caption-title{display:inline-block}
	div.fancybox-caption p.caption-title{font-size:14px}
	div.fancybox-caption p.caption-title{color:#333333}
	div.fancybox-caption {color:#333333}div.fancybox-caption p.caption-title {background:#fff; width:auto;padding:10px 30px;}div.fancybox-content p.caption-title{color:#333333;margin: 0;padding: 5px 0;}
</style><script type="text/javascript">
	jQuery(function () {

		var mobileOnly = false;
		
		if (mobileOnly) {
			return;
		}

		jQuery.fn.getTitle = function () { // Copy the title of every IMG tag and add it to its parent A so that fancybox can show titles
			var arr = jQuery("a[data-fancybox]");
									jQuery.each(arr, function() {
										var title = jQuery(this).children("img").attr("title");
										 var caption = jQuery(this).next("figcaption").html();
                                        if(caption && title){jQuery(this).attr("title",title+" " + caption)}else if(title){ jQuery(this).attr("title",title);}else if(caption){jQuery(this).attr("title",caption);}
									});			}

		// Supported file extensions

				var thumbnails = jQuery("a:has(img)").not(".nolightbox").not('.envira-gallery-link').not('.ngg-simplelightbox').filter(function () {
			return /\.(jpe?g|png|gif|mp4|webp|bmp|pdf)(\?[^/]*)*$/i.test(jQuery(this).attr('href'))
		});
		

		// Add data-type iframe for links that are not images or videos.
		var iframeLinks = jQuery('.fancyboxforwp').filter(function () {
			return !/\.(jpe?g|png|gif|mp4|webp|bmp|pdf)(\?[^/]*)*$/i.test(jQuery(this).attr('href'))
		}).filter(function () {
			return !/vimeo|youtube/i.test(jQuery(this).attr('href'))
		});
		iframeLinks.attr({"data-type": "iframe"}).getTitle();

				// Gallery All
		thumbnails.addClass("fancyboxforwp").attr("data-fancybox", "gallery").getTitle();
		iframeLinks.attr({"data-fancybox": "gallery"}).getTitle();

		// Gallery type NONE
		
		// Call fancybox and apply it on any link with a rel atribute that starts with "fancybox", with the options set on the admin panel
		jQuery("a.fancyboxforwp").fancyboxforwp({
			loop: false,
			smallBtn: true,
			zoomOpacity: "auto",
			animationEffect: "fade",
			animationDuration: 500,
			transitionEffect: "fade",
			transitionDuration: "300",
			overlayShow: true,
			overlayOpacity: "0.3",
			titleShow: true,
			titlePosition: "inside",
			keyboard: true,
			showCloseButton: true,
			arrows: true,
			clickContent:false,
			clickSlide: "close",
			mobile: {
				clickContent: function (current, event) {
					return current.type === "image" ? "toggleControls" : false;
				},
				clickSlide: function (current, event) {
					return current.type === "image" ? "close" : "close";
				},
			},
			wheel: false,
			toolbar: true,
			preventCaptionOverlap: true,
			onInit: function() { },			onDeactivate
	: function() { },		beforeClose: function() { },			afterShow: function(instance) { jQuery( ".fancybox-image" ).on("click", function( ){ ( instance.isScaledDown() ) ? instance.scaleToActual() : instance.scaleToFit() }) },				afterClose: function() { },					caption : function( instance, item ) {var title ="";if("undefined" != typeof jQuery(this).context ){var title = jQuery(this).context.title;} else { var title = ("undefined" != typeof jQuery(this).attr("title")) ? jQuery(this).attr("title") : false;}var caption = jQuery(this).data('caption') || '';if ( item.type === 'image' && title.length ) {caption = (caption.length ? caption + '<br />' : '') + '<p class="caption-title">'+title+'</p>' ;}return caption;},
		afterLoad : function( instance, current ) {current.$content.append('<div class=\"fancybox-custom-caption inside-caption\" style=\" position: absolute;left:0;right:0;color:#000;margin:0 auto;bottom:0;text-align:center;background-color:#FFFFFF \">' + current.opts.caption + '</div>');},
			})
		;

			})
</script>
<!-- END Fancybox for WordPress -->
<link rel="shortcut icon" href="https://www.trendmicro.com/favicon.ico" type="image/x-icon"  />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8DW3SL');</script>
<!-- End Google Tag Manager -->
<link href="https://www.trendmicro.com/vinfo/cloudlink/styles/ransomware-solutions-blog-template-style.css" rel="stylesheet" type="text/css">
<style>
#disqus_thread #dsq-app5 {
    display: none !important;
}

#disqus_thread #dsq-app4{
   display: none !important;
}
div#ransomwareSolutionContainer sup {
    vertical-align: super !important;
    font-size: 7px !important;
}
.RW_icon img {
    width: 100%;
    display: none;
}

.aligncenter {
    margin: 0 auto !important;
}

</style>
<!-- Start VWO Asynchronous Code -->
<script type='text/javascript'>
var _vwo_code=(function(){
var account_id=215154,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
/* DO NOT EDIT BELOW THIS LINE */
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
</script>
<!-- End VWO Asynchronous Code -->
        <script type="text/javascript">
            var jQueryMigrateHelperHasSentDowngrade = false;

			window.onerror = function( msg, url, line, col, error ) {
				// Break out early, do not processing if a downgrade reqeust was already sent.
				if ( jQueryMigrateHelperHasSentDowngrade ) {
					return true;
                }

				var xhr = new XMLHttpRequest();
				var nonce = '4c4e482baa';
				var jQueryFunctions = [
					'andSelf',
					'browser',
					'live',
					'boxModel',
					'support.boxModel',
					'size',
					'swap',
					'clean',
					'sub',
                ];
				var match_pattern = /\)\.(.+?) is not a function/;
                var erroredFunction = msg.match( match_pattern );

                // If there was no matching functions, do not try to downgrade.
                if ( typeof erroredFunction !== 'object' || typeof erroredFunction[1] === "undefined" || -1 === jQueryFunctions.indexOf( erroredFunction[1] ) ) {
                    return true;
                }

                // Set that we've now attempted a downgrade request.
                jQueryMigrateHelperHasSentDowngrade = true;

				xhr.open( 'POST', 'https://blog.trendmicro.com/trendlabs-security-intelligence/wp-admin/admin-ajax.php' );
				xhr.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
				xhr.onload = function () {
					var response,
                        reload = false;

					if ( 200 === xhr.status ) {
                        try {
                        	response = JSON.parse( xhr.response );

                        	reload = response.data.reload;
                        } catch ( e ) {
                        	reload = false;
                        }
                    }

					// Automatically reload the page if a deprecation caused an automatic downgrade, ensure visitors get the best possible experience.
					if ( reload ) {
						location.reload();
                    }
				};

				xhr.send( encodeURI( 'action=jquery-migrate-downgrade-version&_wpnonce=' + nonce ) );

				// Suppress error alerts in older browsers
				return true;
			}
        </script>

				<style type="text/css" id="wp-custom-css">
			/*
You can add your own CSS here.

Click the help icon above to learn more.
*/


.frs-caption-content p:nth-child(2) {
    display: block !important;
}

.frs-caption-content p:nth-child(3) {
    display: block !important;
}		</style>
		</head>
<body class="post-template-default single single-post postid-76959 single-format-standard">
	<div id="backgroundImage"></div>
	<div id="backgroundPattern"></div>
	
		<div id="topBorder"></div>
	<div class="clear"></div>
		
	
		<div id="preHeader">
		<div id="preHeaderContent">
			<div id="preHeaderLeft">
				<div id="nav_menu-2" class="widget widget_nav_menu"><div class="menu-header-container"><ul id="menu-header" class="menu"><li id="menu-item-70641" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-70641"><a href="https://www.trendmicro.com">Trend Micro</a></li>
<li id="menu-item-70642" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-70642"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/">About TrendLabs Security Intelligence Blog</a></li>
</ul></div></div><div class="clear"></div>				<div class="clear"></div>
			</div>
			<div id="preHeaderRight">
				<div id="preHeaderRightContent">
										<div class="clear"></div>
				</div>
			</div>
			<div class="clear"></div>
		</div>
	</div>
	
	<div id="wrapper">

		<div id="contentWrapper">
			
			<div id="header">
			
								<div id="headerSocial">
					<ul class="socialIcons">
														<li><a href="https://twitter.com/trendmicrorsrch" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/twitter.jpg" alt="" /></a></li>
																					<li><a href="http://www.facebook.com/trendmicro" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/fb.jpg" alt="" /></a></li>
																					<li><a href="http://www.linkedin.com/company/trend-micro" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/in.jpg" alt="" /></a></li>
																					<li><a href="http://www.youtube.com/user/TrendMicroInc" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/youtube.jpg" alt="" /></a></li>
																					<li><a href="http://feeds.trendmicro.com/Anti-MalwareBlog" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/rss.jpg" alt="" /></a></li>
																			</ul>
				</div>
				<div class="clear"></div>
								
				
				<div id="horizontalLogo">
												<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/"><img id="imageLogo" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2018/10/blog-logo-2018.jpg" alt="" /></a>
										</div>
				
								<div id="headerSearch">
					<div id="searchWrap">
													<div class="searchCaption">
								<span class="searchTitle">Search:</span>
							</div>
												<div class="headerSearchBox">
							<div>
								<div id="headerSearchDiv" style="padding-right:0px;">
									<form role="search" method="get" action="https://blog.trendmicro.com/trendlabs-security-intelligence">
										<input name="s" id="headerSearchField" title="Search Site" value="" onclick="this.value = '';" style="opacity: 0; ">
										<input id="headerSearchSubmit" type="submit" value="">
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
									<label class="custom-select">
					<select id="menu-home" class="mobile-menu dropdown-menu"><option value="" class="blank">Go to&#8230;</option><option class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-70643 menu-item-depth-0" value="http://blog.trendmicro.com/trendlabs-security-intelligence/">Home</option>
<option class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-70644 menu-item-depth-0" value="#">Categories</option>	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-73632 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/ransomware/">- &nbsp;&nbsp;Ransomware</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70648 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/vulnerabilities/">- &nbsp;&nbsp;Vulnerabilities</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70650 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/">- &nbsp;&nbsp;Exploits</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-70651 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/">- &nbsp;&nbsp;Targeted Attacks</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-71451 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/deep-web/">- &nbsp;&nbsp;Deep Web</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70649 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/mobile/">- &nbsp;&nbsp;Mobile</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70654 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/internet-of-things/">- &nbsp;&nbsp;Internet of Things</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-70646 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/">- &nbsp;&nbsp;Malware</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70645 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/bad-websites/">- &nbsp;&nbsp;Bad Sites</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70647 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/spam/">- &nbsp;&nbsp;Spam</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70652 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/botnets/">- &nbsp;&nbsp;Botnets</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70653 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/social-media/">- &nbsp;&nbsp;Social</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-71452 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/open-source/">- &nbsp;&nbsp;Open source</option>

</select>					</label>
								
				<div id="navWrap">
					<div id="horizontalNavigation">
						<ul id="menu-home-1" class="sf-menu clearfix"><li id="menu-item-70643" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href="http://blog.trendmicro.com/trendlabs-security-intelligence/">Home</a></li>
<li id="menu-item-70644" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><a href="#">Categories</a>
<ul class="sub-menu">
<div class="col">
	<li id="menu-item-73632" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/ransomware/">Ransomware</a></li>
	<li id="menu-item-70648" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/vulnerabilities/">Vulnerabilities</a></li>
	<li id="menu-item-70650" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/">Exploits</a></li>
	<li id="menu-item-70651" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/">Targeted Attacks</a></li>
	<li id="menu-item-71451" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/deep-web/">Deep Web</a></li>
	<li id="menu-item-70649" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/mobile/">Mobile</a></li>
	<li id="menu-item-70654" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/internet-of-things/">Internet of Things</a></li>
	<li id="menu-item-70646" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/">Malware</a></li>
	<li id="menu-item-70645" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/bad-websites/">Bad Sites</a></li>
	<li id="menu-item-70647" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/spam/">Spam</a></li>
	<li id="menu-item-70652" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/botnets/">Botnets</a></li>
	<li id="menu-item-70653" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/social-media/">Social</a></li>
	<li id="menu-item-71452" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/open-source/">Open source</a></li>
</div>
<div class="clear"></div></ul>
</li>
</ul> 
					<div class="clear"></div>
					</div>
					<div class="clear"></div>
				</div>
				<div class="clear"></div>
				
			</div>
			<div class="clear"></div>			<div id="innerWrap" class= "rightSideBar">
							
				<div id="content" class= "rightSideBar">
					<div id="pageContent">
						  <div id="crumbsOnly">
    <div id="breadcrumbs"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/" class="breadcrumbs-begin">Home</a> <span class="breadcrumbs-separator">&nbsp;&nbsp;&raquo;&nbsp;&nbsp;</span> <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/" title="Malware">Malware</a> <span class="breadcrumbs-separator">&nbsp;&nbsp;&raquo;&nbsp;&nbsp;</span> Uncovering the Inner Workings of EyePyramid</div>  </div>
  <div id="post-76959" class="post-76959 post type-post status-publish format-standard has-post-thumbnail hentry category-malware category-targeted_attacks tag-eyepyramid tag-italy">
    <div class="post-head">
      <div class="post-title">
        <h1>Uncovering the Inner Workings of EyePyramid</h1>
      </div>
    </div>
    <div class="clear"></div>
          <div class="post-meta">
        <ul>
          <li class="post-date">
            <div class="meta-info">
              Posted on:<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/2017/01/">January 18, 2017</a> <span class="normalText">at 7:56 am</span>
            </div>
            <div class="clear"></div>
          </li>
          <li class="post-cat">
            <div class="meta-info">
              Posted in:<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/" rel="category tag">Malware</a>, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/" rel="category tag">Targeted Attacks</a>            </div>
            <div class="clear"></div>
          </li>
          <li class="post-user">
            <div class="meta-info">
              Author:<div class="author-name-red">
<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/author/federicom/" title="Posts by Federico Maggi (Senior Threat Researcher)" rel="author">Federico Maggi (Senior Threat Researcher)</a></div>
            </div>
            <div class="clear"></div>
          </li>
        </ul>
      </div>
      <div class="clear"></div>
          <div class="post-comments">
                  <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/#respond">
								<span class="meta-comments">
									0								</span>
          </a>
              </div><!--  CLOSE post-comments -->
    
    <div class="post-text">
          <img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks-200x200.jpg" class="attachment-medium size-medium wp-post-image" alt="" loading="lazy" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks-200x200.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks-380x380.jpg 380w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks-300x300.jpg 300w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/04/feature_targeted-attacks.jpg 400w" sizes="(max-width: 200px) 100vw, 200px" />            <div style='display:none;' class='shareaholic-canvas' data-app='share_buttons' data-title='Uncovering the Inner Workings of EyePyramid' data-link='https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/' data-summary='Two Italians referred to as the ‚ÄúOcchionero brothers‚Äù have been arrested and accused of using malware and a¬†carefully-prepared spear-phishing scheme to spy on high-profile politicians and businessmen. This case has been called &quot;EyePyramid&quot;, which we first discussed¬†last week. (Conspiracy theories aside, the name¬†came from a domain name and directory path that was found as part of the research.)' data-app-id-name='post_above_content'></div>
<p>Two Italians referred to as the ‚ÄúOcchionero brothers‚Äù have been <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.theregister.co.uk/2017/01/12/eyepyramid/');"  href="http://www.theregister.co.uk/2017/01/12/eyepyramid/" target="_blank">arrested</a> and <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.reuters.com/article/italy-cybercrime-idUSL5N1F02IW');"  href="http://www.reuters.com/article/italy-cybercrime-idUSL5N1F02IW" target="_blank">accused</a> of using malware and a¬†carefully-prepared spear-phishing scheme to spy on high-profile politicians and businessmen. This case has been called &#8220;EyePyramid&#8221;, which we first discussed¬†<a href="http://blog.trendmicro.com/trendlabs-security-intelligence/eye-storm-look-eyepyramid-malware-supposedly-used-high-profile-hacks-italy/">last week</a>. (Conspiracy theories aside, the name¬†came from a domain name and directory path that was found during the research.)</p>
<p>The <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.agi.it/pictures/pdf/agi/agi/2017/01/10/132733992-5cec4d88-49a1-4a00-8a01-dde65baa5a68.pdf');"  href="http://www.agi.it/pictures/pdf/agi/agi/2017/01/10/132733992-5cec4d88-49a1-4a00-8a01-dde65baa5a68.pdf" target="_blank">court order</a> was published by AGI, an Italian news agency, around noon on January 11. It (surprisingly) contains multiple technical details which we used to bootstrap our <a onclick="javascript:pageTracker._trackPageview('/outgoing/github.com/eyepyramid/eyepyramid');"  href="https://github.com/eyepyramid/eyepyramid" target="_blank">initial</a> <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/eye-storm-look-eyepyramid-malware-supposedly-used-high-profile-hacks-italy/">analysis</a>. This post builds on the details of the case to provide a more complete and in-depth view of the activities of this campaign.</p>
<p><em><strong>Scope¬†of this analysis</strong></em></p>
<p>We have analyzed nearly 250 distinct samples, with new batches of EyePyramid-related samples seen and identified daily. Right after our initial analysis, about a dozen suspicious samples were uploaded to VirusTotal and tagged as ‚Äú#eyepyramid‚Äù. We believe that these samples are ‚Äúfalse flags,‚Äù because the samples do not resemble any of the samples that we were able to definitely relate to the EyePyramid case. Although we are not able to say with 100% certainty that there are no relationships between these ‚Äúfalse flags‚Äù and the original EyePyramid samples, we purposely did not focus on these uploaded samples.</p>
<p><em><strong>Targeted Email Accounts</strong></em></p>
<p>Evidence from some of the samples suggests that the attackers targeted email accounts from various domains. Both account credentials and messages from these accounts were stolen, with email accounts from the following domains being targeted:</p>
<table border="0" width="500" cellspacing="1" cellpadding="5">
<tbody>
<tr>
<td colspan="5" align="left" valign="top" bgcolor="#cccccc">The domains being targeted</td>
</tr>
<tr>
<td align="left" valign="top" bgcolor="#ffffff">
<p align="left">@alice.it<br />
@aol.com<br />
@att.net<br />
@badoo.com<br />
@bellsouth.net<br />
@bluewin.ch<br />
@btinternet.com<br />
@comcast.net<br />
@cox.net<br />
@cyh.com.tr<br />
@earthlink.net<br />
@eim.ae<br />
@email.com<br />
@email.it<br />
@emirates.net.ae<br />
@excite.it<br />
@facebook.com<br />
@facebookmail.com<br />
@fastweb.it<br />
@fastwebmail.it<br />
@fastwebnet.it<br />
@free.fr</p>
</td>
<td align="left" valign="top" bgcolor="#ffffff">
<p align="left">@gmail.com<br />
<strong>@gmail.it</strong><br />
@gmx.de<br />
@gmx.net<br />
@googlegroups.com<br />
@googlemail.com<br />
@groupama.it<br />
@groups.facebook.com<br />
@gvt.net.br<br />
@hanmail.net<br />
@hinet.net<br />
@hotmail.co.uk<br />
@hotmail.com<br />
@hotmail.fr<br />
@hotmail.it<br />
@infinito.it<br />
@interbusiness.it<br />
@interfree.it<br />
@inwind.it<br />
@iol.it<br />
@jazztel.es<br />
@jumpy.it</p>
</td>
<td align="left" valign="top" bgcolor="#ffffff">
<p align="left">@katamail.com<br />
@laposte.net<br />
@legalmail.it<br />
@libero.it<br />
@live.com<br />
@live.it<br />
@lycos.com<br />
@lycos.it<br />
@mac.com<br />
@mail.bakeca.it<br />
@mail.com<br />
@mail.ru<br />
@mail.vodafone.it<br />
@mail.wind.it<br />
@mclink.it<br />
@me.com<br />
@msn.com<br />
@mtnl.net.in<br />
@nate.com<br />
@netscape.net<br />
@netzero.com</p>
</td>
<td align="left" valign="top" bgcolor="#ffffff">
<p align="left">@orange.fr<br />
@otenet.gr<br />
@poczta.onet.pl<br />
@poste.it<br />
@proxad.net<br />
@rediffmail.com<br />
@rocketmail.com<br />
@runbox.com<br />
@saudi.net.sa<br />
@sbcglobal.net<br />
@skynet.be<br />
@supereva.it<br />
@sympatico.ca<br />
@t-online.de<br />
@tele2.it<br />
@verizon.net<br />
@virgilio.it<br />
@vodafone.com<br />
@vodafone.it<br />
@vsnl.net.in</p>
</td>
<td align="left" valign="top" bgcolor="#ffffff">
<p align="left">@wanadoo.fr<br />
@web.de<br />
@yahoo.ca<br />
@yahoo.co.in<br />
@yahoo.co.jp<br />
@yahoo.co.uk<br />
@yahoo.com<br />
@yahoo.com.ar<br />
@yahoo.com.br<br />
@yahoo.com.mx<br />
@yahoo.de<br />
@yahoo.es<br />
@yahoo.fr<br />
@yahoo.it<br />
@yahoogroups.com<br />
@ymail.com</p>
</td>
</tr>
</tbody>
</table>
<p><em><strong><br />
Attack scheme</strong></em></p>
<p>The attack scheme features a remarkable pre-attack phase designed to create a foundation of trust for an effective spear-phishing campaign against high-profile targets. The attacker starts with a list of email accounts‚Äîobtained either from an out-of-band compromise, or by another case using the same malware. These accounts belong to organizations or persons that are supposedly trusted by the final, high-profile victim(s).</p>
<p>Using these email accounts as senders, together with attachment names crafted to camouflage the original malware sample extension (*.exe), the attacker managed to infect the computers (directly or indirectly) used by the high-profile victims.</p>
<p>When the malware files are executed¬†on each machine it auto-updates itself, steals information related to email accounts matching the list above, and sends the¬†harvested information to dropzone email addresses and/or C&amp;C servers¬†via¬†HTTP/HTTPS. This also adds¬†these¬†email accounts to the attacker&#8217;s list of compromised accounts, which could be used to spread malware to other victims.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_00-01.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_00-01.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_00-01.jpg" alt="Attack scheme_EyePyramid" width="500" /></a></p>
<p><em><strong>Timeline and prevalence</strong></em></p>
<p>Using the compile time stamp, we obtained the following timeline, which is in line with other¬†analyses that followed our initial report. EyePyramid&#8217;s known samples peaked in 2014, with more than three times the number of samples of any other year.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_01_2.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_01_2.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_01_2.jpg" alt="Figure¬†1_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure¬†1. Distribution of EyePyramid sample compilation date, by year</em></p>
<p>While EyePyramid was based in Italy, not all of its victims were located in that country, as seen from the graph below:</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_02.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_02.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_02.jpg" alt="Figure2_EyePyramid" width="500" /></a></p>
<table style="width: 300px" border="0" cellspacing="1" cellpadding="5" align="center">
<tbody>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#cccccc">TOP 10</td>
<td style="width: 150px" align="left" bgcolor="#cccccc">%</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">Italy</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">14.77</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">United States</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">9.79</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">Japan</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">9.61</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">United Kingdom</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">5.87</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">Taiwan</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">4.45</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">Germany</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">4.27</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">France</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">3.20</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">India</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">2.14</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">Brazil</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">1.78</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">Austria</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">1.60</td>
</tr>
<tr>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">Others</td>
<td style="width: 150px" align="left" valign="top" bgcolor="#ffffff">42.52</td>
</tr>
</tbody>
</table>
<p style="text-align: center" align="center"><em>Figure 2 and Table 1. Distribution of EyePyramid victims</em></p>
<p style="text-align: left"><em><strong>EyePyramid Malware Evolution</strong></em></p>
<p style="text-align: left">After analysis, we were able to group the EyePyramid samples based on various features, including:</p>
<ul style="text-align: center">
<li style="text-align: left">year of executable file creation (compile time stamp)</li>
<li style="text-align: left">original/internal file name</li>
<li style="text-align: left">obfuscator and packer used; there were two combinations of obfuscators used:
<ul>
<li>Skater .NET + Dotfuscator, two popular obfuscators (most of the samples are post-processed in this way)</li>
<li><a onclick="javascript:pageTracker._trackPageview('/outgoing/yck1509.github.io/ConfuserEx/');"  href="https://yck1509.github.io/ConfuserEx/" target="_blank">ConfuserEx</a>, a recent and powerful obfuscator (only the most recent ones)</li>
</ul>
</li>
<li style="text-align: left">presence of relevant strings, either in the original binary, or after de-obfuscation, de-compilation and string-decryption:
<ul>
<li style="text-align: left"><strong>‚Äú</strong>gmail.it<strong>‚Äù</strong> ‚Äì this string appears next to ‚Äúgmail.com‚Äù and ‚Äúgooglemail.com‚Äù, which are known domains for Google email accounts, It&#8217;s possible this was a mistake by the author, who wanted to target Italian Gmail users. Alternately, the attacker¬†<em>could</em> be targeting the customers of the Gmail.it <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.gmail.it/freemail/request/new');"  href="http://www.gmail.it/freemail/request/new" target="_blank">free email service</a>. (Note that Gmail.it is not connected with the Google-owned service and shares nothing with it except the name.) Without the ability to ask the threat actors, no strong conclusions should be derived from this finding.</li>
<li style="text-align: left">Paths indicating a link to the case. We found the string¬†‚Äú\Work\EyePyramid\‚Äù in one sample dated December 13, 2014;¬†the¬†original file name is <em>mfkr.exe</em>. This is one of the strings that contributed to this case&#8217;s name.¬†The presence of such a string is a strong indication that the malware is related to EyePyramid.¬†However, not all samples tied to EyePyramid¬†include this string.</li>
<li style="text-align: left">Use of Desaware‚Äôs SpyWorks component, which can be used to implement key-capturing functionalities, or to create system-level hooks.</li>
</ul>
</li>
</ul>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_03.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_03.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_03.jpg" alt="Figure3_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 3. Code for key capturing features</em></p>
<ul>
<li style="text-align: left">paths or library names indicating code reuse of specific components, namely:
<ul>
<li>:\Projects\VS2005\ChromePass\Release\ChromePass.pdb</li>
<li>:\Projects\VS2005\MyLastSearch\release\MyLastSearch.pdb</li>
<li>:\Projects\VS2005\NK2View\Release\NK2View.pdb</li>
<li>:\Projects\VS2005\ProduKey\Release\ProduKey.pdb</li>
<li>:\Projects\VS2005\RecentFilesView\Release\RecentFilesView.pdb</li>
<li>:\Projects\VS2005\USBDeview\Release\USBDeview.pdb</li>
<li>:\Projects\VS2005\WirelessKeyView\Release\WirelessKeyView.pdb</li>
<li>:\Projects\VS2005\mspass\Release\mspass.pdb</li>
<li>:\Projects\VS2005\netpass\Release\netpass.pdb</li>
<li>:\projects\VS2005\iepv\Release\iepv.pdb</li>
<li>:\projects\vs2005\shortcutsman\release\shman.pdb</li>
</ul>
</li>
</ul>
<p style="text-align: left">These strings indicate that the malware incorporated various software components with specific features.¬†For example, ‚Äúiepv\Release\iepv.pdb‚Äù is the <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.nirsoft.net/utils/internet_explorer_password.html');"  href="http://www.nirsoft.net/utils/internet_explorer_password.html" target="_blank">IE Password Viewer</a>, a small utility (and library) which can be used to reveal passwords stored by Internet Explorer. Other components listed have similar features.¬†The presence of these components¬†suggests that one of the malware‚Äôs purposes is¬†to exfiltrate browser-related data.</p>
<p style="text-align: left">The recurrent path string ‚Äú:\projects\vs2005‚Äù also provides us clues about the malware author‚Äôs modus operandi. We found all of these strings in both a 2014 and 2015 variant, which both shared the file name¬†<em>vmgr.exe.¬†</em>This suggests that the author behind both samples is the same. However, these were¬†not compiled with¬†the same programming environment: the 2014 variant has been compiled with .NET 4.5.5416.41981, whereas the 2015 variant has .NET 4.5.5604.16127.</p>
<p>Based on the above features, we generated a summary of the malware samples, which can be found in the¬†appendix below. We can conclude that over time, the threat actors¬†behind this crime modified and updated the malware‚Äôs capabilities (e.g., not all variants are able to exfiltrate Skype conversations), C&amp;C and dropzones, compiler version, and protection mechanisms.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/outgoing/documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf');"  href="https://documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_04_3.jpg" alt="Figure4_EyePyramid" width="550" /></a></p>
<p align="center"><em>Figure 4. <a onclick="javascript:pageTracker._trackPageview('/outgoing/documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf');"  href="https://documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf" target="_blank">Appendix with complete table (2010 &#8211; 2016)</a></em></p>
<p style="text-align: left"><strong><em>Link back to 2011 Bisignani spy case</em></strong></p>
<p style="text-align: left">In 2012, a high-profile Italian businessman and ex-journalist named Luigi Bisignani was prosecuted as part of the ‚ÄúP4 secret society,‚Äù (short for Propaganda 4). The P4 was the fourth of the masonic lodges in Italy, which was supposedly influencing political decisions.</p>
<p style="text-align: left">The malware used in those attacks used several Gmail addresses as dropzones. Investigators at CNAIPIC (an Italian cybercrime body) found that these same addresses were used by recent EyePyramid variants as well. Independently, we found that older (2012) variants of EyePyramid were doing the same thing.</p>
<p style="text-align: left">One more interesting link that we found is the use of the¬†<em>mail.hospenta.com</em>¬†mailserver, which is similar to the one used by the recent versions of EyePyramid. Curiously, only the 2010 version‚Äîand not the 2012 version‚Äîused <em>mail.hostpenta.com</em>. Both the 2010 and 2012 versions share the infamous¬†<em>MN600-D8102F401003102110C5114F1F18-0E8C</em>¬†MailBee license key, which was¬†either purchased by Giulio Occhionero, or purchased using his name.</p>
<p style="text-align: left"><em><strong>Main Features of EyePyramid Malware</strong></em></p>
<p style="text-align: left">EyePyramid&#8217;s most important features are listed below.¬†This list is not meant to be exhaustive, but it covers the most relevant ones.</p>
<p style="text-align: left"><em>Persistency</em></p>
<p style="text-align: left">When first executed, the malware drops a copy of itself onto the hard drive (usually on the root folder C:\) using a name selected from random list, which is made up of:</p>
<p align="center"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_05.jpg" alt="Figure5_EyePyramid" width="248" /></p>
<p align="center"><em>Figure 5. Possible &#8220;random&#8221; file names</em></p>
<p style="text-align: left">To maintain persistency, the malware uses a classic mechanism that involves modifying or adding entries to the¬†<em>CurrentVersion\Run</em>¬†and¬†<em>CurrentVersion\RunOnce</em>¬†registry keys.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_06.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_06.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_06.jpg" alt="Figure6_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 6. Autostart registry entries</em></p>
<p style="text-align: left">Setting the value of these entries to the path of the malware executable will ensure that it is¬†executed upon every user logon.</p>
<p style="text-align: left"><em>Code reuse:¬†not all variants use the same combinations of libraries</em></p>
<p>An interesting characteristic of the EyePyramid malware is the use of publicly known third-party components or open-source libraries, which provide clues to the technical skills of the author.</p>
<p style="text-align: left">The following libraries were found:</p>
<ul style="text-align: left">
<li><strong>MouseKeyboardActivityMonitor</strong>, a library for globally monitoring keystrokes and mouse activity. The malware used this component to steal keystrokes.</li>
<li><strong>Internet Explorer Passwords Viewer,</strong> as well as other password-viewing components (e.g., for Google Chrome), which are used by the EyePyramid malware to steal browser-stored credentials.</li>
<li><strong>Desaware</strong>, a software company, produces SpyWorks, a component used to capture keystrokes and/or to create system hooks that can be used to programmatively ‚Äúdetour‚Äù a program‚Äôs execution flow, at runtime. The presence of Desaware components was determined by finding the following string in code:
<ul>
<li>d:\srcnet\Desaware.SpyWorksDotNet\Release820\Desaware.shcomponent20.pdb</li>
</ul>
</li>
<li><strong>MailBee</strong>, a component used to handle emails. This was the component that was used to attribute the attack to Giulio Occhionero. The embedded license key had been purchased under his name.</li>
<li><strong>SevenZip</strong>, a common library for creating 7z data, which was used by the malware to compress the stolen files before encrypting and sending them to dropzones.</li>
</ul>
<p style="text-align: left"><em>File harvesting</em></p>
<p style="text-align: left">As we noted¬†in <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/eye-storm-look-eyepyramid-malware-supposedly-used-high-profile-hacks-italy/">our initial analysis</a>, EyePyramid‚Äôs main feature¬†is to harvest and steal files. Files with the following extensions are¬†targeted:</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_07.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_07.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_07.jpg" alt="Figure7_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 7. File extensions targeted for¬†theft</em></p>
<p style="text-align: left">Among the other harvested data, EyePyramid looks for¬†<em>*.pst</em>¬†files, which are used by various applications including the Microsoft Exchange Client, Windows Messaging, and Microsoft Outlook to store copies of messages, calendar events and¬†other similar information.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_08.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_08.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_08.jpg" alt="Figure8_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 8. Code targeting PST files</em></p>
<p style="text-align: left"><em>Skype data</em></p>
<p>The following queries, found in the partially-decompiled source code of one of the EyePyramid malware samples (i.e., those variants commonly named as¬†<em>vmgr.exe</em>), show that it¬†is trying to read from the Accounts, Contacts, Messages, and SMS tables of the Skype client, which contains the information of the said application.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_09.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_09.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_09.jpg" alt="Figure9_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 9. Code targeting Skype</em></p>
<p style="text-align: left"><em>Disabling of security¬†software</em></p>
<p style="text-align: left">EyePyramid targets various security tools and¬†tries¬†to disable both real-time protection mechanisms and AV-related processes from being launched, as can be seen from the following list:</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_10.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_10.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_10.jpg" alt="Figure10_EyePyramid" width="500" /></a></p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_11.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_11.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_11.jpg" alt="Figure11_EyePyramid" width="500" /></a></p>
<p align="center"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_12.jpg" alt="Figure12_EyePyramid" width="331" /></p>
<p align="center"><em>Figures 10-12. Code targeting security software</em></p>
<p style="text-align: left"><em>Obfuscation and¬†protection</em></p>
<p style="text-align: left">The malware binary is obfuscated by three tools: Skater + Dotfuscator, or ConfuserEx. As a result, the final executable is mildly protected from na√Øve debugging and in-VM dynamic analysis. However, the amount of protection provided is relatively mild and¬†far from advanced.</p>
<p style="text-align: left">In addition, custom string-encryption/obfuscation is used to render strings non-directly readable on the decompiled source code. In particular, most of the samples using Skater + Dotfuscator encrypt the strings using 3DES, after serialization, reducing then to bytes arrays. We reverse-engineered the encryption routine and recovered the encrypted strings.</p>
<p style="text-align: left"><em><strong>Anecdotes and Other Curious Findings</strong></em></p>
<p style="text-align: left"><em>Cross-site Scripting Testing on HTML Emails?</em></p>
<p style="text-align: left">Although used for debugging only, we found that the malware author was playing around with email-based cross-site scripting, as can be seen from the following code snippet (from 21b6f2584485b8bbfffdefd45c1c72dc2133290fd8cefb235eb39cf015550316):</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_13.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_13.jpg"><img class="aligncenter size-medium wp-image-63345" src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_13.jpg" alt="Figure13_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 13. Code testing Cross-site Scripting</em></p>
<p style="text-align: left"><em>Provenance of email accounts¬†</em></p>
<p>During our analysis, we received emails from various analysts asking for clarification. One reader noted that the email address used by the EyePyramid operators to send spear-phishing messages was also used to register accounts on various dating sites, based on information from Leaked Source (a database of breaches¬†from various sites).</p>
<p style="text-align: left">Searching on Leaked Source for the domains appearing on the court order‚Äîones that were allegedly involved with the data-exfiltration activities‚Äîrevealed a similar situation. Email addresses on these domains used to register on various sites, including dating and social media sites, were from various data breaches.¬†As a result, these credentials, unless changed by the legitimate owners, are to be considered essentially publicly available.</p>
<p style="text-align: left"><em>Icons</em></p>
<p style="text-align: left">Although not a detection criterion, the samples that we processed had¬†81 distinct icon types, some of which are shown below:</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_14.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_14.jpg"><img src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_14.jpg" alt="Figure14_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 14. Icons used by EyePyramid samples</em></p>
<p style="text-align: left"><em><strong>Analysis Methodology</strong></em></p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2017/01/EyePyramid_15-01.jpg');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_15-01.jpg"><img src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2017/01/EyePyramid_15-01.jpg" alt="Figure15_EyePyramid" width="500" /></a></p>
<p align="center"><em>Figure 15. Analysis process</em></p>
<p>We followed a fairly common practice for our analysis. As mentioned in our first blog post, it all started from a court order that appeared on the AGI site. From that, we extracted some patterns, which we used to perform what is commonly referred to as ‚Äúretro-hunting,‚Äù that is, we wrote a Yara rule, plus some custom post-processing scripts, to statically match an initial set of patterns. This allowed us to get to a set of samples, among which was ‚Äúd3ad32bcb255e56cd2a768b3cbf6bafda88233288fc6650d0dfa3810be75f74c‚Äù. Other analysts found that this was related to EyePyramid as well.</p>
<p style="text-align: left">We then manually deobfuscated and decompiled the binary code, obtaining a non-compiling source code tree, which allowed us to find more details about the malware‚Äôs behavior. Some of these behaviors were also confirmed after running the initial samples in a sandboxed environment (among which we used our <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/index.html#integrated-protection');"  href="http://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/index.html#integrated-protection" target="_blank">Deep Discovery Analyzer</a>).</p>
<p style="text-align: left">The newly extracted details allowed us to refine our retro-hunting process, revealing more samples, some of which are currently being manually analyzed. Among the various patterns that we used (e.g., included library names, domain names, email addresses), we note that the executable‚Äôs original name ensures a good recall. This is unusual, and possibly tells something about the attacker‚Äôs skills: A smart attacker would, at least, take care to randomize such names consistently in the PE header. With some automation, we run this iterative process every day and cross-check our findings with the reports sent by our customers.</p>
<p style="text-align: left"><em><strong>Conclusions</strong></em></p>
<p>From a purely technical viewpoint, the origins of EyePyramid‚Äôs malware and its attribution remain unclear. While the license key registered to Giulio Occhionero‚Äôs name can be considered as strong evidence, it is unclear why a malware author would bother using (simple yet not so trivial) mechanisms to cover their traces (e.g., obfuscation, packing, encryption, disabling security tools), and then mistakenly embed the license key under his name¬†<em>in all of the main variants</em>. Moreover, an analysis of the domain-to-IP historical data of the domain names listed in the court order reveals domains named ‚Äúocchionero.com‚Äù and ‚Äúocchionero.info,‚Äù which is again another oddity.</p>
<p>From a technical viewpoint, it is certain that the original source code has gone through mild modifications. On the other hand, the computer(s) used to build the various versions over the years seem to be in line with the evolution of Microsoft developer tools (based on the progression of the compiler version) and software-protection tools (as seen on the recent substitution of Skater + Dotfuscator with the more powerful ConfuserEx).</p>
<p style="text-align: left">Here is <em><strong><a onclick="javascript:pageTracker._trackPageview('/outgoing/documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf');"  href="https://documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf" target="_blank">the appendix</a></strong></em> containing further details about the samples we analyzed.</p>
<p style="text-align: left"><em><strong>Updated on January 19, 2017, 10:15 PM (UTC-7):</strong></em><br />
<a onclick="javascript:pageTracker._trackPageview('/outgoing/documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf');"  href="https://documents.trendmicro.com/assets/Appendix_uncovering-the-inner-workings-of-eyepyramid.pdf" target="_blank">The appendix </a>related to this post was updated with SHA256 and other information.</p>
<div style='display:none;' class='shareaholic-canvas' data-app='share_buttons' data-title='Uncovering the Inner Workings of EyePyramid' data-link='https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-inner-workings-eyepyramid/' data-summary='Two Italians referred to as the ‚ÄúOcchionero brothers‚Äù have been arrested and accused of using malware and a¬†carefully-prepared spear-phishing scheme to spy on high-profile politicians and businessmen. This case has been called &quot;EyePyramid&quot;, which we first discussed¬†last week. (Conspiracy theories aside, the name¬†came from a domain name and directory path that was found as part of the research.)' data-app-id-name='post_below_content'></div>
<div class='yarpp-related yarpp-related-none'>
</div>
     <div class="banner-widget-area">
        <div id="text-7" class="widget-container widget_text">			<div class="textwidget"><!-- ransomware banner --><div style="text-align: center; background-color: #cc0001; border-radius:5px; overflow: hidden;"><div style="margin-top: 7px;"><img src="https://documents.trendmicro.com/images/TEx/articles/say-no-to-ransomware.jpg" style="width: 100% !important; max-width: 100% !important; float: none !important; border: 0px !important; box-shadow: none !important;"/></div><div class="ctaRansomware" style="color: #fff; padding-top: 5px; padding-bottom: 5px;">Learn how to protect Enterprises, Small Businesses, and Home Users from ransomware:</div><div style="/* display: table; */width: 90%;margin: 0 auto;margin-top: 5px;margin-bottom: 10px;text-align: center;"><div style="margin: 0 auto;display: inline-block;padding-right: 3px;background-color: #c70100;width: auto;line-height: 1em !important;min-width: 150px;font-size: 11px !important;vertical-align: middle;text-align: center;margin-bottom: 5px; margin-right: 10px;"><div style="width: 100%;"><div style="padding: 10px; background: #F9F8F8;"><a href="http://www.trendmicro.com/us/security-intelligence/enterprise-ransomware/index.html" target="_blank" style="color: #cc0001;margin-left: -5px;" rel="noopener">ENTERPRISE <span style="margin-top: -1px; position: absolute; margin-left: 5px; font-size: 17px;">¬ª</span></a></div></div></div><div style="margin: 0 auto;display: inline-block;padding-bottom: 3px;padding-top: 3px;background-color: #c70100;line-height: 1em !important;width: auto;font-size: 11px !important;vertical-align: middle;text-align: center;margin-bottom: 5px;min-width: 180px;margin-right: 10px;"><div style="width: 100%;"><div style="padding: 10px; background: #F9F8F8;"><a href="http://www.trendmicro.com/us/security-intelligence/small-business-ransomware/index.html" target="_blank" style="color: #cc0001;    margin-left: -5px;" rel="noopener">SMALL BUSINESS<span style="margin-top: -1px; position: absolute; margin-left: 5px; font-size: 17px;">¬ª</span></a></div></div></div><div style="margin: 0 auto;display: inline-block;padding: 3px;background-color: #c70100;line-height: 1em !important;width: auto;font-size: 11px !important;vertical-align: middle;text-align: center;margin-bottom: 5px;min-width: 150px;margin-right: 8px;"><div style="width: 100%;"><div style="padding: 10px; background: #F9F8F8;"><a href="http://www.trendmicro.com/us/home/consumer-ransomware/index.html" target="_blank" style="color: #cc0001;margin-left: -5px;" rel="noopener">HOME<span style="margin-top: -1px; position: absolute;  margin-left: 5px; font-size: 17px;">¬ª</span></a></div></div></div></div></div><!-- end ransomware banner --></div>
		</div>    </div>
        <div class="post-tags">
           Tags: <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tag/eyepyramid/" rel="tag">EyePyramid</a><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tag/italy/" rel="tag">Italy</a> 		
        </div>
          </div>
    <div class="clear"></div>
  </div> <!--  CLOSE post-entry  -->
  					</div><div class="clear"></div> <!-- CLOSE PAGE CONTENT & CLEAR DIV -->
					
				</div> <!-- CLOSE CONTENT DIV -->	
				  <div id="sideBar" class= "rightSideBar">



    <div id="sideBarWidgets">
      <div id="text-6" class="widget widget_text"><h3>Security Predictions for 2020</h3>			<div class="textwidget"><ul><li>
<div style="margin-bottom:10px; margin-top:10px; background-image: url(https://documents.trendmicro.com/images/TEx/articles/TM-predictions-2020-page-cover-thumb.jpg); width:100%; height:100px; background-size: cover; background-position-y: top center;"></div>
Cybersecurity in 2020 will be viewed through many lenses ‚Äî from differing attacker motivations and cybercriminal arsenal to technological developments and global threat intelligence ‚Äî only so defenders can keep up with the broad range of threats.<br />
 <a href="https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2020" target="_blank" rel="noopener"><span style="color:#c00;margin-top:5px">Read our security predictions for 2020.</span></a>
</li>
</ul></div>
		</div><div class="clear"></div><div id="text-13" class="widget widget_text"><h3>Business Process Compromise</h3>			<div class="textwidget"><ul><li>
<div style="margin-bottom:10px; margin-top:10px; background-image: url(https://documents.trendmicro.com/images/TEx/articles/sidebar-business-process-co.jpg); width:100%; height:100px; background-size: cover; background-position-y: top center;"></div>
Attackers are starting to invest in long-term operations that target specific processes enterprises rely on. They scout for vulnerable practices, susceptible systems and operational loopholes that they can leverage or abuse. To learn more,
 <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-business-process-compromise" target="_blank" rel="noopener"><span style="color:#c00;margin-top:5px">read our Security 101: Business Process Compromise.</span></a>
</li>
</ul>
</div>
		</div><div class="clear"></div>
		<div id="recent-posts-2" class="widget widget_recent_entries">
		<h3>Recent Posts</h3>
		<ul>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/our-new-blog/">Our New Blog</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/unsecure-grpc-implementations-compromise-apis-applications/">How Unsecure gRPC Implementations Can Compromise APIs, Applications</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/xcsset-mac-malware-infects-xcode-projects-performs-uxss-attack-on-safari-other-browsers-leverages-zero-day-exploits/">XCSSET Mac Malware: Infects Xcode Projects, Performs UXSS Attack on Safari, Other Browsers, Leverages Zero-day Exploits</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/august-patch-tuesday-fixes-critical-ie-important-windows-vulnerabilities-exploited-in-the-wild/">August Patch Tuesday Fixes Critical IE, Important Windows Vulnerabilities Exploited in the Wild</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/water-nue-campaign-targets-c-suites-office-365-accounts/">Water Nue Phishing Campaign Targets C-Suite&#8217;s Office 365 Accounts</a>
									</li>
					</ul>

		</div><div class="clear"></div>
<div id="wpp-7" class="widget popular-posts">
<h3>Popular Posts</h3><!-- cached --><p class="wpp-no-data">Sorry. No data so far.</p>
</div><div class="clear"></div>
<div id="feedburner-email-subscription-3" class="widget feedburner-email-subscription"><h3>Stay Updated</h3><form class="fes fes-default" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open( 'https://feedburner.google.com/fb/a/mailverify?uri=Anti-MalwareBlog', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true" ><div class="form-group"><label class="sr-only"><span class="screen-reader-text">Email Subscription</span></label><input class="form-control search-field" type="text" value="Your email here" onfocus="if(this.value=='Your email here')this.value='';" onblur="if(this.value=='')this.value='Your email here'" name="email" /></div><button type="submit" class="btn btn-default btn-submit">Subscribe</button><input type="hidden" value="Anti-MalwareBlog" name="uri" /><input type="hidden" name="loc" value="en_US" /></form></div><div class="clear"></div>    </div><div class="clear"></div>
  </div><div class="clear"></div><!-- CLOSE SIDEBAR -->
				
			</div> <!-- CLOSE innerWrap -->
			<div class="clear"></div>
		
		</div> <!-- CLOSE contentWrapper -->
		<div class="clear"></div>
		<div id="footer">




	<div class="fullWidth">
		<ul class="site-links">
			<li><a href="http://www.trendmicro.com/us/home/index.html">Home and Home Office</a></li>
			<li>|</li>
			<li><a href="http://www.trendmicro.com/us/business/index.html">For Business</a></li>
			<li>|</li>
			<li><a href="http://www.trendmicro.com/us/security-intelligence/index.html">Security Intelligence</a></li>
			<li>|</li>
			<li><a href="http://www.trendmicro.com/us/about-us/index.html">About Trend Micro</a></li>
		</ul>

		<ul id="regions">
			<li>Asia Pacific Region (APAC):
			<a href="http://www.trendmicro.com.au/au/home/index.html">Australia</a> / 
			<a href="http://www.trendmicro.co.nz/nz/home/index.html">New Zealand</a>,
			<a href="http://cn.trendmicro.com/cn/home/index.html">‰∏≠ÂõΩ</a>,
			<a href="http://jp.trendmicro.com/jp/home/index.html">Êó•Êú¨</a>,
			<a href="http://www.trendmicro.co.kr/index.html">ÎåÄÌïúÎØºÍµ≠</a>,
			<a href="http://tw.trendmicro.com/tw/home/index.html">Âè∞ÁÅ£</a>
			</li>
			<li>Latin America Region (LAR):
			<a href="http://br.trendmicro.com/br/home/index.html">Brasil</a>,
			<a href="http://la.trendmicro.com/la/home/index.html">M√©xico</a>
			</li>
			<li class="last">North America Region (NABU):
			<a href="http://www.trendmicro.com/us/index.html">United States</a>,
			<a href="http://ca.trendmicro.com/ca/home/index.html">Canada</a>
				<br>
			</li>
			<li>Europe, Middle East, &amp; Africa Region (EMEA):
			<a href="http://www.trendmicro.fr/">France</a>,
			<a href="http://www.trendmicro.de/">Deutschland / √ñsterreich / Schweiz</a>,
			<a href="http://www.trendmicro.it/">Italia</a>,
			<a href="http://www.trendmicro.com.ru/">–†–æ—Å—Å–∏—è</a>,
			<a href="http://www.trendmicro.es/">Espa√±a</a>,
			<a href="http://www.trendmicro.co.uk/">United Kingdom / Ireland</a>
			</li>
		</ul>
	</div>
	<div class="clear"></div>											
</div>

<div class="clear"></div>

<div id="postFooter">
	<div id="postFooterContent">
		<ul id="left">
			<li><a href="http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html">Privacy Statement</a></li>
			<li><a href="http://www.trendmicro.com/us/about-us/legal-policies/index.html">Legal Policies</a></li>
		</ul>

		<ul id="right">
			<li>Copyright &copy; <script>document.write(new Date().getFullYear());</script> Trend Micro Incorporated. All rights reserved.</li>
		</ul>
		<div id="post_footer_widget_area"></div>
		<div class="clear"></div>
	</div>
</div>




<!--Plugin Global Hide Admin Tool Bar Active-->

<!-- This website is patched against a big problem not solved from WordPress 3.3+ to date -->

<script async>(function(s,u,m,o,j,v){j=u.createElement(m);v=u.getElementsByTagName(m)[0];j.async=1;j.src=o;j.dataset.sumoSiteId='bcb4650331e445fc191ac9b7b41e418e46fc2a34a4d8417ac1cb72c278c31c3a';j.dataset.sumoPlatform='wordpress';v.parentNode.insertBefore(j,v)})(window,document,'script','//load.sumo.com/');</script>    <script type="application/javascript">
      var ajaxurl = "https://blog.trendmicro.com/trendlabs-security-intelligence/wp-admin/admin-ajax.php";

      function sumo_add_woocommerce_coupon(code) {
        jQuery.post(ajaxurl, {
          action: 'sumo_add_woocommerce_coupon',
          code: code,
        });
      }

      function sumo_remove_woocommerce_coupon(code) {
        jQuery.post(ajaxurl, {
          action: 'sumo_remove_woocommerce_coupon',
          code: code,
        });
      }

      function sumo_get_woocommerce_cart_subtotal(callback) {
        jQuery.ajax({
          method: 'POST',
          url: ajaxurl,
          dataType: 'html',
          data: {
            action: 'sumo_get_woocommerce_cart_subtotal',
          },
          success: function(subtotal) {
            return callback(null, subtotal);
          },
          error: function(err) {
            return callback(err, 0);
          }
        });
      }
    </script>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8DW3SL"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


<script type='text/javascript'>
jQuery(document).ready(function($) {
  
  if(jQuery('.Alert-widget-container').html()!=""){
     jQuery('#topBorder').append(
"<div class='AlertbarTop' style='display:none'>"+jQuery('.Alert-widget-title').text()+": "+jQuery('.Alert-widget-container.textwidget').html() +"</div>")
   }
      jQuery('#topBorder').addClass('autoHeightTopBorder');

})
</script>
<!-- tracker added by Ultimate Google Analytics plugin v1.6.0: http://www.oratransplant.nl/uga -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-137644-6");
pageTracker._initData();
pageTracker._trackPageview();
</script>
	<script>
		var getElementsByClassName=function(a,b,c){if(document.getElementsByClassName){getElementsByClassName=function(a,b,c){c=c||document;var d=c.getElementsByClassName(a),e=b?new RegExp("\\b"+b+"\\b","i"):null,f=[],g;for(var h=0,i=d.length;h<i;h+=1){g=d[h];if(!e||e.test(g.nodeName)){f.push(g)}}return f}}else if(document.evaluate){getElementsByClassName=function(a,b,c){b=b||"*";c=c||document;var d=a.split(" "),e="",f="http://www.w3.org/1999/xhtml",g=document.documentElement.namespaceURI===f?f:null,h=[],i,j;for(var k=0,l=d.length;k<l;k+=1){e+="[contains(concat(' ', @class, ' '), ' "+d[k]+" ')]"}try{i=document.evaluate(".//"+b+e,c,g,0,null)}catch(m){i=document.evaluate(".//"+b+e,c,null,0,null)}while(j=i.iterateNext()){h.push(j)}return h}}else{getElementsByClassName=function(a,b,c){b=b||"*";c=c||document;var d=a.split(" "),e=[],f=b==="*"&&c.all?c.all:c.getElementsByTagName(b),g,h=[],i;for(var j=0,k=d.length;j<k;j+=1){e.push(new RegExp("(^|\\s)"+d[j]+"(\\s|$)"))}for(var l=0,m=f.length;l<m;l+=1){g=f[l];i=false;for(var n=0,o=e.length;n<o;n+=1){i=e[n].test(g.className);if(!i){break}}if(i){h.push(g)}}return h}}return getElementsByClassName(a,b,c)},
			dropdowns = getElementsByClassName( 'dropdown-menu' );
		for ( i=0; i<dropdowns.length; i++ )
			dropdowns[i].onchange = function(){ 
				if(this.value != '' && this.value != '#' ){
					window.location.href = this.value; 
				}
			}
	</script>
	<link rel='stylesheet' id='yarppRelatedCss-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/yet-another-related-posts-plugin/style/related.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/js/wp-embed.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='wp-embed-js'></script>

</body>  
</html>