<!DOCTYPE html><html lang="en"><head>
  <!-- OneTrust Cookies Consent Notice start -->
  <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="301196e0-93ad-473e-a572-975514574496"></script>
  <script type="text/javascript">
  function OptanonWrapper() { }
  </script>
  <!-- OneTrust Cookies Consent Notice end -->
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KF7XWD');</script>
  <!-- End Google Tag Manager -->
  <meta charset="utf-8">
  <title>SolarWinds: How a Rare DGA&nbsp;Helped Attacker Communications Fly Under the Radar | Symantec Blogs</title>
  <base href="/blogs/">  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="QpS_7p7oPyNjksYmiXtMfTJDLRKiviv1FJaQOUGPnt0">
  <meta name="google-site-verification" content="Phaks0EaD7hDs8gJnbzabqgvae8ar_dbX2uUTiqhB2Y">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="assets/favicon/site.webmanifest">
  <link rel="mask-icon" href="assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#cd2031">
  <meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="styles.3fbff49e8057aa87887f.css"><style ng-transition="symantec-blogs">[_nghost-sc0]{display:block}</style><style ng-transition="symantec-blogs"></style><style ng-transition="symantec-blogs">.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-background{display:none}}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:'';display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2s infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2s infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after{animation:none;transition:none}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.70173,.49582);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.30244,.38135,.55,.95635);transform:translateX(83.67142%)}100%{transform:translateX(200.61106%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(.08)}36.65%{animation-timing-function:cubic-bezier(.33473,.12482,.78584,1);transform:scaleX(.08)}69.15%{animation-timing-function:cubic-bezier(.06,.11,.6,1);transform:scaleX(.66148)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:translateX(37.65191%)}48.35%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:translateX(84.38617%)}100%{transform:translateX(160.27778%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:scaleX(.08)}19.15%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:scaleX(.4571)}44.15%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:scaleX(.72796)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}</style><link title="Symantec Blogs" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Threat Intelligence" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/221" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Feature Stories" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/211" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Expert Perspectives" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/251" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Product Insights" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/231" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Election Security" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/4841" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Português" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/10411" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Japanese" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11291" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Chinese, Simplified" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11301" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Chinese, Traditional" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11311" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Korean" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11321" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - America Latina" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/10401" rel="alternate" type="application/rss+xml"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@symantec"><meta name="twitter:creator" content="@symantec"><meta name="twitter:title" content="SolarWinds: How a Rare DGA&nbsp;Helped Attacker Communications Fly Under the Radar"><meta name="twitter:description" content="In the second of a series of follow-up analysis on the SolarWinds attacks, we examine how the attackers made command and control communications particularly stealthy."><meta name="twitter:domain" content="symantec.com"><meta property="og:type" content="article"><meta property="og:url" content=""><meta property="og:title" content="SolarWinds: How a Rare DGA&nbsp;Helped Attacker Communications Fly Under the Radar"><meta property="og:description" content="In the second of a series of follow-up analysis on the SolarWinds attacks, we examine how the attackers made command and control communications particularly stealthy."><meta name="twitter:image" content="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/social_media_meta/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=W920KQtD"><meta property="og:image" content="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/social_media_meta/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=W920KQtD"><style ng-transition="symantec-blogs">[_nghost-sc1]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc13]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc9]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc22]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc31]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc10]{display:block}</style></head>
<body>
  <app-root ng-version="8.2.14"><app-loader _nghost-sc0=""><!----></app-loader><div><header class="header" role="banner"><div class="header-primary"><a class="header-link" rel="home" routerlink="/" title="Symantec Blogs" href="/blogs/"><img alt="Broadcom" class="header-logo" src="assets/logo.svg"><span class="header-text">Symantec Enterprise Blogs</span></a><!----><div class="header-breadcrumb"><app-breadcrumbs _nghost-sc1=""><!----><ul _ngcontent-sc1="" class="header-breadcrumb__list"><!----><li _ngcontent-sc1="" class="header-breadcrumb__item"><!----><a _ngcontent-sc1="" class="header-breadcrumb__link" href="/blogs/threat-intelligence">Threat Intelligence</a><!----></li></ul></app-breadcrumbs></div><div class="header-navigation"><button aria-hidden="true" class="nav-toggle"><span><em>Menu</em></span></button><a class="search-icon" routerlink="/search" href="/blogs/search"><i class="fa fa-search"></i></a><app-blogs-menu _nghost-sc2=""><nav _ngcontent-sc2="" aria-labelledby="primary-menu" class="nav-menu" role="navigation"><div _ngcontent-sc2="" class="inner"><header _ngcontent-sc2=""><h2 _ngcontent-sc2="">Main menu</h2></header><ul _ngcontent-sc2="" class="nav-menu__list"><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/" href="/blogs/"><i _ngcontent-sc2="" class="fa fa-home"></i>Blogs Home</a></li><!----><!----><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/threat-intelligence">Threat Intelligence</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/feature-stories">Feature Stories</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/expert-perspectives">Expert Perspectives</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/product-insights">Product Insights</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/election-security">Election Security</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/japanese" href="/blogs/japanese">日本語</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/search" href="/blogs/search"><i _ngcontent-sc2="" class="fa fa-search"></i>Search</a></li><li _ngcontent-sc2="" class="nav-menu__item external"><a _ngcontent-sc2="" class="nav-menu__link" href="https://www.broadcom.com" rel="noopener" target="_blank"><i _ngcontent-sc2="" class="fa fa-globe"></i>Broadcom Home</a></li></ul></div></nav></app-blogs-menu></div></div></header><!----><router-outlet></router-outlet><app-blog-post><div class="blog-id--221" classname="blog-id--221"><!----><app-hero _nghost-sc13=""><div _ngcontent-sc13="" class="hero"><figure _ngcontent-sc13="" app-picture="" class="hero__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_extra_wide/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=CkyyKC4P 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_extra_wide_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=QIbBJp53 2x" media="(min-width: 1900px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_wide/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=wspcy0Ge 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_wide_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=2xre5RYh 2x" media="(min-width: 1400px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_large/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=B2yQCnhI 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_large_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=njyFIbeo 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_medium/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=vO6qXZdC 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_medium_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=1QSY6yH5 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_small/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=M5FvtxRb 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_small_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=0-tu7ezG 2x" media="(min-width: 420px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=fTymcQXt 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=Z_9yE9dO 2x" media=""><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=fTymcQXt" alt=""></picture><!----></figure></div></app-hero><div class="page-container"><main class="main" role="main"><a id="main-content"></a><article class="node blog-post" role="article"><div class="blog-post__aside"><!----><div class="blog-post__author-wrapper"><!----><app-author class="author" _nghost-sc9=""><!----><figure _ngcontent-sc9="" app-picture="" class="author__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=yMcB1DYB 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=H2VWJd8e 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=yMcB1DYB" alt=""></picture><!----></figure><div _ngcontent-sc9="" class="author__content"><span _ngcontent-sc9="" class="author__name">Threat Hunter Team</span><span _ngcontent-sc9="" class="author__title">Symantec</span></div></app-author></div><!----></div><div class="blog-post__content"><!----><header class="blog-post__header"><div class="row"><div class="column column--first"><div class="meta"><span class="meta__date"><!---->Posted: <time>7 Jan, 2021</time></span><span class="meta__time-to-read">5 <!---->Min Read</span><!----><span class="meta__tag"><a href="/blogs/threat-intelligence">Threat Intelligence</a></span></div><!----></div><div class="column column--last"><div class="social-list__wrapper"><app-subscribe-button _nghost-sc4=""><button _ngcontent-sc4="" class="subscribe-email"><i _ngcontent-sc4="" class="fa fa-envelope"></i> Subscribe</button></app-subscribe-button></div></div></div><h1 class="blog-post__title" id="page-title">SolarWinds: How a Rare DGA&nbsp;Helped Attacker Communications Fly Under the Radar</h1><h2 class="blog-post__subtitle">In the second of a series of follow-up analysis on the SolarWinds attacks, we examine how the attackers made command and control communications particularly stealthy.</h2></header><!----><span><!----><app-paragraph-rte _nghost-sc16=""><div _ngcontent-sc16=""><p>In the weeks since <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sunburst-supply-chain-attack-solarwinds">news of the SolarWinds attacks broke</a>, we’ve continued our analysis into the tools used by the attackers. One of the most interesting things we’ve seen is the way the attackers configured their malware in order to contact a command and control (C&amp;C) server via DNS communications.&nbsp;It’s a technique that is rarely used, but there have been some reports of other APT groups such as Crambus (aka Oilrig) using it previously.</p>

<p>Sunburst (Backdoor.Sunburst), the malware which was used to Trojanize the SolarWinds Orion software, uses a domain generation algorithm (DGA) to generate domain names to contact for C&amp;C purposes. However, unlike most DGAs, this DGA does not just randomly generate characters. Instead, information is encoded into the text that makes up the generated domain names. By doing so, initial C&amp;C actually happens via DNS, which provides a stealthier level of communications.</p>

<p>For each infected computer, Sunburst generates a unique ID, referred to as a userid. The userid is made up of the first active MAC address that is not the loopback address, concatenated with the Windows Domain name of the computer, and then concatenated with the Windows installation UUID, a randomly generated value at Windows installation time stored in HKLM\SOFTWARE\Microsoft\Cryptography\MachineGuid. These three values are then MD5 hashed and the first 64 bits are XOR’d with the last 64 bits, resulting in a unique 64-bit userid.</p>

<p>Because multiple DNS requests will have to be made to transmit all payload information, the attackers require a unique ID to know from which computer the information is coming from. DNS is a distributed protocol, meaning the infected computer does not contact the attacker’s C&amp;C server directly, but instead the DNS request is passed through multiple intermediaries before reaching the attacker DNS server. Only by including the userid within the DNS request will the attackers be able to combine the multiple requests.</p>

<p>The DNS lookup will be in one of the following forms:</p>

<p>&lt;encoded information&gt;.appsync-api.eu-west-1.avsvmcloud.com</p>

<p>&lt;encoded information&gt;.appsync-api.us-west-2.avsvmcloud.com</p>

<p>&lt;encoded information&gt;.appsync-api.us-east-1.avsvmcloud.com</p>

<p>&lt;encoded information&gt;.appsync-api.us-east-2.avsvmcloud.com</p>

<p>The encoded information will be in one of two forms providing the attackers either the Windows domain name of the infected organization or security product statuses and feedback on the infected machine.</p>

<h2>Windows Domain Name Payload</h2>

<p>Initially, after Sunburst <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-attacks-stealthy-attackers-attempted-evade-detection">checks for or bypasses security tools and products</a>, the first DNS lookup will occur containing the infected computer’s Windows domain name or a portion thereof, encoded into the C&amp;C domain. The Windows domain is usually a human-readable string representing the name of the organization the machine belongs to, e.g. AcmeA1Corp.</p>

<p>The DGA will start by prepending the aforementioned userid with a randomly chosen key byte between 0x81 and 0xFE followed by the userid XOR’d with the key byte. These nine bytes are then encoded in a fashion similar to Base64, resulting in 15 characters.</p>

<p>This string of characters is then followed by the Windows domain name, encoded. Because Windows domain names can be up to 253 characters long, Sunburst chooses to segment the Windows domain names into 14 character chunks preceded by the chunk number (where the first chunk number is 0). Windows domain names longer than 14 characters will thus require more than one DNS lookup to provide the entire Windows domain name.</p>

<p>Sunburst will also resend previously sent chunks if an error was encountered or, under certain error conditions, set the chunk number to a negative one. The segment chunk number and the Windows domain name are both encoded separately and appended to the encoded userid. These elements form the subdomain of the domain. This domain is queried via DNS, which results in this encoded information reaching the attacker’s DNS server. The attacker can then decode the information and reply with further instructions, which will be covered in a future blog.</p>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><span><!----><!----><!----><!----><!----><!----><!----><app-paragraph-image-inline _nghost-sc22=""><div _ngcontent-sc22="" class="paragraph paragraph-image-inline"><!----><figure _ngcontent-sc22="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_medium/public/2021-01/SOK-3381%20Figure%201.jpg?itok=An-aiR33 1x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/SOK-3381%20Figure%201.jpg?itok=YEJiLsFy 1x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/SOK-3381%20Figure%201.jpg?itok=YEJiLsFy" alt="Figure 1. Structure of Sunburst DNS lookups"></picture><!----><figcaption>Figure 1. Structure of Sunburst DNS lookups</figcaption></figure></div></app-paragraph-image-inline><!----><!----><!----><!----><!----><!----><!----></span><span><!----><app-paragraph-rte _nghost-sc16=""><div _ngcontent-sc16=""><p>Sunburst does not automatically generate multiple DNS queries in order to send the entire Windows domain name. Whether Sunburst will send the remaining 14-character segments depends on the response received from the initial DNS query. Because Sunburst was delivered via a supply chain attack, many systems that are not of interest will be infected. By encoding the first 14 characters of the Windows domain name into the first DNS query, the attackers are able to triage infections and only mount second-state attacks on systems of interest - those that have Windows domain names that match organizations they wish to target.</p>

<h2>Security Product Status and Feedback Payload</h2>

<p>Depending on the response to the first DNS lookup, a second DNS lookup may occur that encodes the status of installed security products on the system and information on whether the DNS communication has been successful.</p>

<p>First, the userid is XOR’d by the third and second bytes of a timestamp value described below in an alternating fashion before being XOR’d by a randomly chosen key byte between 0x01 and 0x7E that is then prepended to the userid. The first byte thus provides not only the key byte, but informs the attackers if the remaining content will contain the Windows domain name payload (key byte is between 0x81 and 0xFE) or the security product status and feedback payload (key byte is between 0x01 and 0x7E).</p>

<p>After the userid, a nibble (half a byte) is used to specify if the security payload information has content (nibble is set to 2) or is blank (nibble is set to 1). This is followed by a timestamp in UTC of when the DNS query was sent, granular to 30-minute increments. The last bit of the timestamp is set to a bit flag representing whether the previous DNS response successfully contained partial or full instructions to start the secondary HTTP communication channel. This may have been designed by the attackers as a feedback mechanism to ensure the DNS communication mechanism is working before sending the full HTTP communication channel details and, in the case of full details, a signal that the HTTP communication should have already started. After the timestamp, the security product status payload is optionally provided if select security product services were found as running.</p>

<p>The two bytes contain a bitmask that encodes information on whether any of the following security products were not found, or found running and/or subsequently disabled and stopped:</p>

<ul>
	<li>CrowdStrike</li>
	<li>Carbon Black</li>
	<li>FireEye</li>
	<li>ESET</li>
	<li>F-Secure</li>
	<li>Microsoft Defender</li>
</ul>

<p>The userid, timestamp, feedback bit, and optional security product data are then encoded into text as the subdomain of a DNS query that is sent to the attackers.</p>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><span><!----><!----><!----><!----><!----><!----><!----><app-paragraph-image-inline _nghost-sc22=""><div _ngcontent-sc22="" class="paragraph paragraph-image-inline"><!----><figure _ngcontent-sc22="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_medium/public/2021-01/SOK-3381%20Figure%202.jpg?itok=_FVXYCQj 1x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/SOK-3381%20Figure%202.jpg?itok=kZxcO5q6 1x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/SOK-3381%20Figure%202.jpg?itok=kZxcO5q6" alt="Figure 2. Structure of second DNS lookup communicating security product status"></picture><!----><figcaption>Figure 2. Structure of second DNS lookup communicating security product status</figcaption></figure></div></app-paragraph-image-inline><!----><!----><!----><!----><!----><!----><!----></span><span><!----><app-paragraph-rte _nghost-sc16=""><div _ngcontent-sc16=""><p>The responses to these DNS queries may then contain control information for the threat to terminate or launch a secondary HTTP communication channel, something that we plan to cover in a subsequent blog.</p>

<h2>Protection/Mitigation</h2>

<p>Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products.</p>

<p><strong>File-based protection:</strong></p>

<ul>
	<li>Backdoor.Sunburst</li>
	<li>Backdoor.Sunburst!gen1</li>
	<li>Backdoor.SuperNova</li>
	<li>Backdoor.Teardrop</li>
</ul>

<p><strong>Network-based protection:</strong></p>

<ul>
	<li>System Infected: Sunburst Malware Activity</li>
</ul>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><!----><!----><div class="blog-post__about-author-wrapper"><!----><app-blog-author class="blog-author" _nghost-sc31=""><div _ngcontent-sc31="" class="blog-author__inner"><div _ngcontent-sc31="" class="blog-author__image"><!----><div _ngcontent-sc31="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_large/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=0czhl3gL 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_large_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=e65lX9T7 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=w8Rg1PQZ 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=ElOaN5mG 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=w8Rg1PQZ" alt=""></picture><!----></div><div _ngcontent-sc31="" class="ellipse"><svg _ngcontent-sc31="" height="500" viewBox="0 0 46 500" width="46"><path _ngcontent-sc31="" d="M0 0h46c-29.758 83.007-44.113 169.773-43.064 260.295 1.049 90.525 15.404 170.425 43.064 239.705h-46v-500z" fill="#213c60"></path></svg></div></div><div _ngcontent-sc31="" class="blog-author__content"><header _ngcontent-sc31=""><h2 _ngcontent-sc31="" class="blog-author__title">About the Author</h2><h3 _ngcontent-sc31="" class="blog-author__name">Threat Hunter Team</h3><!----><h4 _ngcontent-sc31="" class="blog-author__position">Symantec</h4></header><!----><p _ngcontent-sc31="">The Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis that helps customers respond to attacks.</p></div></div></app-blog-author></div><!----><div class="blog-post__comment"><header><h2 class="blog-post__comment-title"><i aria-hidden="true" class="fa fa-share-alt"></i>Want to comment on this post?</h2></header><p>We encourage you to share your thoughts on your favorite social platform.</p><!----><div class="social-list"><!----></div></div></div></article></main></div><!----><div class="related-blog-posts related-blog-posts__blog-post"><div class="inner"><header><h2 class="related-blog-posts__title"><i aria-hidden="true" class="fa fa-compass"></i>Related Blog Posts</h2></header><div class="related-blog-posts__list"><!----><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/solarwinds-attacks-stealthy-attackers-attempted-evade-detection"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=ywBD2U_W 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=4zCFC-Sr 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=dBMYaMNN 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=I5DX89II 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=m_qOTxz7 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=i3UjCQaQ 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=m_qOTxz7" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">21 Dec, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">5 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">SolarWinds Attacks: Stealthy Attackers Attempted To Evade Detection</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/threat-landscape-trends-q3-2020"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-12/Blog%20Image%20Q3%20trends.jpg?h=1043ebbd&amp;itok=lBACaq2U 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-12/Blog%20Image%20Q3%20trends.jpg?h=1043ebbd&amp;itok=syivOmNs 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-12/Blog%20Image%20Q3%20trends.jpg?h=1043ebbd&amp;itok=3rwvXJAy 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-12/Blog%20Image%20Q3%20trends.jpg?h=1043ebbd&amp;itok=fkHNb6iP 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/Blog%20Image%20Q3%20trends.jpg?h=1043ebbd&amp;itok=cBI3hWNl 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-12/Blog%20Image%20Q3%20trends.jpg?h=1043ebbd&amp;itok=G6WS9S7Z 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/Blog%20Image%20Q3%20trends.jpg?h=1043ebbd&amp;itok=cBI3hWNl" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">18 Dec, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">3 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">Threat Landscape Trends – Q3 2020</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/sunburst-supply-chain-attack-solarwinds"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-12/1173218079.jpg?h=d0633ac3&amp;itok=2Cw3vVJi 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-12/1173218079.jpg?h=d0633ac3&amp;itok=asZKAwI3 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-12/1173218079.jpg?h=d0633ac3&amp;itok=uLu1OhpL 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-12/1173218079.jpg?h=d0633ac3&amp;itok=xpJ5ThGX 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/1173218079.jpg?h=d0633ac3&amp;itok=3dbEw-pG 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-12/1173218079.jpg?h=d0633ac3&amp;itok=FgVL4zqF 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/1173218079.jpg?h=d0633ac3&amp;itok=3dbEw-pG" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">14 Dec, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">5 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">Sunburst: Supply Chain Attack Targets SolarWinds Users</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc10=""><a _ngcontent-sc10="" class="related-blog-posts__link" href="/blogs/threat-intelligence/cicada-apt10-japan-espionage"><!----><figure _ngcontent-sc10="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-11/Cicada_Hero.jpg?h=7a13cd3d&amp;itok=lHp1fYbU 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-11/Cicada_Hero.jpg?h=7a13cd3d&amp;itok=wJjFlQ0- 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-11/Cicada_Hero.jpg?h=7a13cd3d&amp;itok=yK2NPnwh 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-11/Cicada_Hero.jpg?h=7a13cd3d&amp;itok=DTZHiOc4 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-11/Cicada_Hero.jpg?h=7a13cd3d&amp;itok=WvrUuuKz 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-11/Cicada_Hero.jpg?h=7a13cd3d&amp;itok=FOIbf5VP 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-11/Cicada_Hero.jpg?h=7a13cd3d&amp;itok=WvrUuuKz" alt=""></picture><!----></figure><div _ngcontent-sc10="" class="meta"><span _ngcontent-sc10="" class="meta__date"><!---->Posted: <time _ngcontent-sc10="">17 Nov, 2020</time></span><span _ngcontent-sc10="" class="meta__time-to-read">8 <!---->Min Read</span></div><h3 _ngcontent-sc10="" class="related-blog-posts__post-title">Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign</h3><!----></a></app-related-blog-posts></div></div></div></div></app-blog-post><footer class="footer"><div class="footer-inner"><div class="footer-column footer-column__first"><a class="footer-logo" href="https://www.broadcom.com" rel="home noopener" target="_blank" title="Broadcom"><img alt="Broadcom" src="assets/logo--white.svg"><span class="footer-text">Symantec Enterprise Blogs</span></a><app-subscribe-button class="subscribe-email__wrapper" _nghost-sc4=""><button _ngcontent-sc4="" class="subscribe-email"><i _ngcontent-sc4="" class="fa fa-envelope"></i> Subscribe</button></app-subscribe-button></div><div class="footer-column footer-column__last"><ul class="footer-menu__list"><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/privacy-policy" rel="noopener" target="_blank">Privacy Policy</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/cookie-policy" rel="noopener" target="_blank">Cookie Policy</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/ca/data-transfers" rel="noopener" target="_blank">Data Processing and Data Transfers</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/citizenship/supplier-responsibility" rel="noopener" target="_blank">Supplier Responsibility</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/terms-of-use/" rel="noopener" target="_blank">Terms of Use</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/sitemap" rel="noopener" target="_blank">Sitemap</a></li></ul><div class="footer-copyright">Copyright © 2005-2021 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div><app-subscribe-form-modal _nghost-sc5=""><div _ngcontent-sc5="" class="modal"><div _ngcontent-sc5="" class="modal__inner"><!----><div _ngcontent-sc5="" class="modal__content"><i _ngcontent-sc5="" class="fa fa-envelope modal__icon"></i><h2 _ngcontent-sc5="" class="modal__title">Get Symantec's Latest Blog Posts <em _ngcontent-sc5="">In Your Inbox</em></h2><form _ngcontent-sc5="" class="subscribe-form ng-untouched ng-pristine ng-invalid" novalidate=""><!----><div _ngcontent-sc5="" class="form-fields"><!----><!----><div _ngcontent-sc5="" class="form-item subscribe-form-tos"><input _ngcontent-sc5="" name="termsAccept" type="checkbox"> I accept the <a _ngcontent-sc5="" target="_self" href="https://www.broadcom.com/company/legal/terms-of-use/">Terms of Use</a>. Your privacy is important to us. Please see our <a _ngcontent-sc5="" target="_self" href="https://www.broadcom.com/company/legal/privacy-policy">Privacy Policy</a> for more information. </div><div _ngcontent-sc5="" class="form-item"><input _ngcontent-sc5="" class="subscribe-form__email ng-untouched ng-pristine ng-valid" formcontrolname="subscriberEmail" maxlength="255" name="subscribe" placeholder="Enter your email address" size="20" title="Enter your email address" type="email" value=""></div><!----><div _ngcontent-sc5="" class="form-item"><re-captcha _ngcontent-sc5="" formcontrolname="recaptcha" id="ngrecaptcha-7952" class="ng-untouched ng-pristine ng-invalid"></re-captcha></div><button _ngcontent-sc5="" class="form-submit" disabled=""><i _ngcontent-sc5="" class="fa fa-envelope"></i> Subscribe</button><button _ngcontent-sc5="" class="form-submit form-submit__submitted hidden"><i _ngcontent-sc5="" class="fa fa-check"></i> Submitted</button></div></form><button _ngcontent-sc5="" class="modal__close"><span _ngcontent-sc5="">Close</span></button></div></div></div></app-subscribe-form-modal></app-root>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KF7XWD"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
<script src="runtime-es2015.da0a6e8d67e0e9164a4b.js" type="module"></script><script src="runtime-es5.da0a6e8d67e0e9164a4b.js" nomodule="" defer=""></script><script src="polyfills-es5.304c50711c869a9ad3f0.js" nomodule="" defer=""></script><script src="polyfills-es2015.b4a3bdae6bcd059f26dd.js" type="module"></script><script src="main-es2015.db474897433611b8a787.js" type="module"></script><script src="main-es5.db474897433611b8a787.js" nomodule="" defer=""></script>

</body></html>