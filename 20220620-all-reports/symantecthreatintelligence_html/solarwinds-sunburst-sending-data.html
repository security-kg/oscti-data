<!DOCTYPE html><html lang="en"><head>
  <!-- OneTrust Cookies Consent Notice start -->
  <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="301196e0-93ad-473e-a572-975514574496"></script>
  <script type="text/javascript">
  function OptanonWrapper() { }
  </script>
  <!-- OneTrust Cookies Consent Notice end -->
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KF7XWD');</script>
  <!-- End Google Tag Manager -->
  <meta charset="utf-8">
  <title>SolarWinds: How Sunburst Sends Data Back to the Attackers | Symantec Blogs</title>
  <base href="/blogs/">  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="QpS_7p7oPyNjksYmiXtMfTJDLRKiviv1FJaQOUGPnt0">
  <meta name="google-site-verification" content="Phaks0EaD7hDs8gJnbzabqgvae8ar_dbX2uUTiqhB2Y">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="assets/favicon/site.webmanifest">
  <link rel="mask-icon" href="assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#cd2031">
  <meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="styles.3fbff49e8057aa87887f.css"><style ng-transition="symantec-blogs">[_nghost-sc0]{display:block}</style><style ng-transition="symantec-blogs"></style><style ng-transition="symantec-blogs">.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-background{display:none}}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:'';display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2s infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2s infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after{animation:none;transition:none}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.70173,.49582);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.30244,.38135,.55,.95635);transform:translateX(83.67142%)}100%{transform:translateX(200.61106%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(.08)}36.65%{animation-timing-function:cubic-bezier(.33473,.12482,.78584,1);transform:scaleX(.08)}69.15%{animation-timing-function:cubic-bezier(.06,.11,.6,1);transform:scaleX(.66148)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:translateX(37.65191%)}48.35%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:translateX(84.38617%)}100%{transform:translateX(160.27778%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:scaleX(.08)}19.15%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:scaleX(.4571)}44.15%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:scaleX(.72796)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}</style><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@symantec"><meta name="twitter:creator" content="@symantec"><meta name="twitter:title" content="SolarWinds: How Sunburst Sends Data Back to the Attackers"><meta name="twitter:description" content="In the fourth of a series of follow-up analysis on the SolarWinds attacks, we detail how data is sent to the attackers."><meta name="twitter:domain" content="symantec.com"><meta property="og:type" content="article"><meta property="og:url" content=""><meta property="og:title" content="SolarWinds: How Sunburst Sends Data Back to the Attackers"><meta property="og:description" content="In the fourth of a series of follow-up analysis on the SolarWinds attacks, we detail how data is sent to the attackers."><meta name="twitter:image" content="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/social_media_meta/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=VdtiLzzc"><meta property="og:image" content="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/social_media_meta/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=VdtiLzzc"><style ng-transition="symantec-blogs">[_nghost-sc1]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc7]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc8]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc17]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc26]{display:block}</style><style ng-transition="symantec-blogs">[_nghost-sc27]{display:block}</style><link title="Symantec Blogs" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Threat Intelligence" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/221" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Feature Stories" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/211" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Expert Perspectives" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/251" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Product Insights" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/231" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Election Security" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/4841" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - America Latina" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/10401" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Português" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/10411" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Japanese" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11291" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Chinese, Simplified" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11301" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Chinese, Traditional" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11311" rel="alternate" type="application/rss+xml"><link title="Symantec Blogs - Korean" href="https://symantec-enterprise-blogs.security.com/blogs/rss/v1/blogs/rss.xml/11321" rel="alternate" type="application/rss+xml"></head>
<body>
  <app-root ng-version="8.2.14"><app-loader _nghost-sc0=""><!----></app-loader><div><header class="header" role="banner"><div class="header-primary"><a class="header-link" rel="home" routerlink="/" title="Symantec Blogs" href="/blogs/"><img alt="Broadcom" class="header-logo" src="assets/logo.svg"><span class="header-text">Symantec Enterprise Blogs</span></a><!----><div class="header-breadcrumb"><app-breadcrumbs _nghost-sc1=""><!----><ul _ngcontent-sc1="" class="header-breadcrumb__list"><!----><li _ngcontent-sc1="" class="header-breadcrumb__item"><!----><a _ngcontent-sc1="" class="header-breadcrumb__link" href="/blogs/threat-intelligence">Threat Intelligence</a><!----></li></ul></app-breadcrumbs></div><div class="header-navigation"><button aria-hidden="true" class="nav-toggle"><span><em>Menu</em></span></button><a class="search-icon" routerlink="/search" href="/blogs/search"><i class="fa fa-search"></i></a><app-blogs-menu _nghost-sc2=""><nav _ngcontent-sc2="" aria-labelledby="primary-menu" class="nav-menu" role="navigation"><div _ngcontent-sc2="" class="inner"><header _ngcontent-sc2=""><h2 _ngcontent-sc2="">Main menu</h2></header><ul _ngcontent-sc2="" class="nav-menu__list"><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/" href="/blogs/"><i _ngcontent-sc2="" class="fa fa-home"></i>Blogs Home</a></li><!----><!----><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/threat-intelligence">Threat Intelligence</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/feature-stories">Feature Stories</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/expert-perspectives">Expert Perspectives</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/product-insights">Product Insights</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" href="/blogs/election-security">Election Security</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/japanese" href="/blogs/japanese">日本語</a></li><li _ngcontent-sc2="" class="nav-menu__item"><a _ngcontent-sc2="" class="nav-menu__link" routerlink="/search" href="/blogs/search"><i _ngcontent-sc2="" class="fa fa-search"></i>Search</a></li><li _ngcontent-sc2="" class="nav-menu__item external"><a _ngcontent-sc2="" class="nav-menu__link" href="https://www.broadcom.com" rel="noopener" target="_blank"><i _ngcontent-sc2="" class="fa fa-globe"></i>Broadcom Home</a></li></ul></div></nav></app-blogs-menu></div></div></header><!----><router-outlet></router-outlet><app-blog-post><div class="blog-id--221" classname="blog-id--221"><!----><app-hero _nghost-sc7=""><div _ngcontent-sc7="" class="hero"><figure _ngcontent-sc7="" app-picture="" class="hero__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_extra_wide/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=3SH3YwX3 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_extra_wide_2x/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=Y6oqqAR4 2x" media="(min-width: 1900px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_wide/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=-9FLgX5F 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_wide_2x/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=oByLgOfh 2x" media="(min-width: 1400px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_large/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=Te0FvT6L 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_large_2x/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=AGkj1eiH 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_medium/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=ZrfvwOaw 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_medium_2x/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=rOP_h3Lo 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_small/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=K_jRHJwI 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_small_2x/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=HhWVSiKN 2x" media="(min-width: 420px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=uOh0AvTK 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny_2x/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=ToHFsW7i 2x" media=""><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_tiny/public/2021-01/1206098096.jpg?h=7c80df64&amp;itok=uOh0AvTK" alt=""></picture><!----></figure></div></app-hero><div class="page-container"><main class="main" role="main"><a id="main-content"></a><article class="node blog-post" role="article"><div class="blog-post__aside"><!----><div class="blog-post__author-wrapper"><!----><app-author class="author" _nghost-sc8=""><!----><figure _ngcontent-sc8="" app-picture="" class="author__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=yMcB1DYB 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=H2VWJd8e 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_avatar_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=yMcB1DYB" alt=""></picture><!----></figure><div _ngcontent-sc8="" class="author__content"><span _ngcontent-sc8="" class="author__name">Threat Hunter Team</span><span _ngcontent-sc8="" class="author__title">Symantec</span></div></app-author></div><!----></div><div class="blog-post__content"><!----><header class="blog-post__header"><div class="row"><div class="column column--first"><div class="meta"><span class="meta__date"><!---->Posted: <time>22 Jan, 2021</time></span><span class="meta__time-to-read">3 <!---->Min Read</span><!----><span class="meta__tag"><a href="/blogs/threat-intelligence">Threat Intelligence</a></span></div><!----></div><div class="column column--last"><div class="social-list__wrapper"><app-subscribe-button _nghost-sc4=""><button _ngcontent-sc4="" class="subscribe-email"><i _ngcontent-sc4="" class="fa fa-envelope"></i> Subscribe</button></app-subscribe-button></div></div></div><h1 class="blog-post__title" id="page-title">SolarWinds: How Sunburst Sends Data Back to the Attackers</h1><h2 class="blog-post__subtitle">In the fourth of a series of follow-up analysis on the SolarWinds attacks, we detail how data is sent to the attackers.</h2></header><!----><span><!----><app-paragraph-rte _nghost-sc11=""><div _ngcontent-sc11=""><p>In our <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-sunburst-command-control">previous blog</a> we described how the attackers controlled the Sunburst malware, and detailed a variety of commands that will result in data being sent to the threat actors. The next technique to discuss is how Sunburst sends this data to the attackers.</p>

<p>If data is being sent to the attacker as a result of a command, instead of performing a HTTP(S) GET request, something we described in our last blog, Sunburst initiates a HTTP(S) POST request.</p>

<p>Sunburst uses randomly generated URL paths for HTTP(S) POST requests that are different from HTTP(S) GET requests.</p>

<p>If the data to send is greater than 10,000 bytes, the URL path will be as follows:</p>

<ul>
	<li>/pki/crl/{0}{1}-{2}.crl
	<ul>
		<li>element 0 is a number between 100 and 10,000</li>
		<li>element 1 is optionally one of the following:
		<ul>
			<li>-root</li>
			<li>-cert</li>
			<li>-universal_ca</li>
			<li>-ca</li>
			<li>-primary_ca</li>
			<li>-timestamp</li>
			<li>-global</li>
			<li>-secureca</li>
		</ul>
		</li>
		<li>element 2 is the last error code</li>
	</ul>
	</li>
</ul>

<p>A Content-Type header is set to application/octet-stream and the POST data follows. The POST data consists of the data to send UTF8 encoded, concatenated with the last error code, concatenated with the userid, and subsequently compressed. Every byte of the compressed blob is then summed and the lowest byte of the sum value is used as a key. The compressed blob is XOR’d by the key byte and the key byte is prepended to the encrypted data.</p>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><span><!----><!----><!----><!----><!----><!----><!----><app-paragraph-image-inline _nghost-sc17=""><div _ngcontent-sc17="" class="paragraph paragraph-image-inline"><!----><figure _ngcontent-sc17="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_medium/public/2021-01/Figure%201.png?itok=DTVxPrSF 1x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/Figure%201.png?itok=VUuuUjFJ 1x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/Figure%201.png?itok=VUuuUjFJ" alt="Figure 1. Structure of Sunburst POST data"></picture><!----><figcaption>Figure 1. Structure of Sunburst POST data</figcaption></figure></div></app-paragraph-image-inline><!----><!----><!----><!----><!----><!----><!----></span><span><!----><app-paragraph-rte _nghost-sc11=""><div _ngcontent-sc11=""><p>If the data to send is less than, or equal to, 10,000 bytes, the URL path will take one of two forms as follows:</p>

<ul>
	<li>/fonts/woff/{0}-{1}-{2}-webfont{3}.woff2
	<ul>
		<li>element 0 is a random number between 100 and 10,000</li>
		<li>element 1 is "opensans" or “noto”</li>
		<li>element 2 is one of the following:
		<ul>
			<li>bold</li>
			<li>bolditalic</li>
			<li>extrabold</li>
			<li>extrabolditalic</li>
			<li>italic</li>
			<li>light</li>
			<li>lightitalic</li>
			<li>regular</li>
			<li>semibold</li>
			<li>semibolditalic</li>
		</ul>
		</li>
		<li>element 3 is the last error code</li>
	</ul>
	</li>
	<li>or /fonts/woff/{0}-{1}-{2}{3}.woff2
	<ul>
		<li>element 0 is a random number between 100 and 10,000</li>
		<li>element 1 is one of the following:
		<ul>
			<li>freefont</li>
			<li>SourceCodePro</li>
			<li>SourceSerifPro</li>
			<li>SourceHanSans</li>
			<li>SourceHanSerif</li>
		</ul>
		</li>
		<li>element 2 is one of the following:
		<ul>
			<li>Bold</li>
			<li>BoldItalic</li>
			<li>ExtraBold</li>
			<li>ExtraBoldItalic</li>
			<li>Italic</li>
			<li>Light</li>
			<li>LightItalic</li>
			<li>Regular</li>
			<li>SemiBold</li>
			<li>SemiBoldItalic</li>
		</ul>
		</li>
		<li>element 3 is the last error code</li>
	</ul>
	</li>
</ul>

<p>Further, instead of sending the encrypted data directly, as when the data is greater than 10,000 bytes, the data is steganographically sent in a faux JSON blob.&nbsp;</p>

<p>The JSON blob contains the following fields:</p>

<ul>
	<li>userId - contains the userid obfuscated into a GUID</li>
	<li>sessionId - a randomly generated GUID per HTTP session</li>
	<li>Timestamp - milliseconds since 1970/1/1 minus five minutes plus a random value between 0-512 with the second bit normally set to 1</li>
	<li>Index - an incrementing value</li>
	<li>EventType - set to Orion</li>
	<li>EventName - set to EventManager</li>
	<li>DurationMs - the same random value between 0-512 used in the Timestamp</li>
	<li>Succeeded - set to true</li>
	<li>Message - a chunk of Base64 encoded data</li>
</ul>

<p>The encrypted data to send is broken into multiple variable sized chunks. The size of each chunk is randomly determined, but generally will go from smaller to larger. If the randomly chosen size is 0, a random chunk between 16 and 28 bytes is generated instead and the Timestamp value is AND’d with the value 18446744073709551613, which more importantly sets the second bit to 0. Each chunk is then encoded and added to the JSON blob and sent as the HTTP(S) POST data with a Content-Type header set to application/json.</p>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><span><!----><!----><!----><!----><!----><!----><!----><app-paragraph-image-inline _nghost-sc17=""><div _ngcontent-sc17="" class="paragraph paragraph-image-inline"><!----><figure _ngcontent-sc17="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_medium/public/2021-01/Figure%202.png?itok=0S0H9tkT 1x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/Figure%202.png?itok=B__svx61 1x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_inline_small/public/2021-01/Figure%202.png?itok=B__svx61" alt="Figure 2. A contrived example of a JSON file that would be sent by Sunburst"></picture><!----><figcaption>Figure 2. A contrived example of a JSON file that would be sent by Sunburst</figcaption></figure></div></app-paragraph-image-inline><!----><!----><!----><!----><!----><!----><!----></span><span><!----><app-paragraph-rte _nghost-sc11=""><div _ngcontent-sc11=""><p>On receipt, the attacker will need to decode and concatenate all the Message chunks, skipping junk chunks where the Timestamp second bit is not set.</p>

<p>This blog is the final installment of our analysis series concerning the command and control (C&amp;C) process used by the actors behind the SolarWinds attacks. Previous entries have covered how the attackers used Sunburst to <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-attacks-stealthy-attackers-attempted-evade-detection">disable security software and avoid detection</a>, the malware's use of a <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-unique-dga">rare domain generation algorithm</a> (DGA) to generate domain names to contact for C&amp;C purposes, and Sunburst's control flow and <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-sunburst-command-control">use of IP address values as commands</a>. This final blog, detailing how the malware sends data back to the attackers, rounds out a comprehensive overview of Sunburst’s C&amp;C processes.</p>

<h2>Protection/Mitigation</h2>

<p>Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products.</p>

<p><strong>File-based protection:</strong></p>

<ul>
	<li>Backdoor.Raindrop</li>
	<li>Backdoor.Teardrop</li>
	<li>Backdoor.Sunburst</li>
	<li>Backdoor.Sunburst!gen1</li>
	<li>Backdoor.SuperNova</li>
</ul>

<p><strong>Network-based protection:</strong></p>

<ul>
	<li>System Infected: Sunburst Malware Activity</li>
</ul>

<p>For the latest protection updates, please visit the <a href="https://www.broadcom.com/support/security-center/protection-bulletin">Symantec Protection Bulletin</a>.</p>
</div></app-paragraph-rte><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></span><!----><!----><div class="blog-post__about-author-wrapper"><!----><app-blog-author class="blog-author" _nghost-sc26=""><div _ngcontent-sc26="" class="blog-author__inner"><div _ngcontent-sc26="" class="blog-author__image"><!----><div _ngcontent-sc26="" app-picture=""><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_large/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=0czhl3gL 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_large_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=e65lX9T7 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=w8Rg1PQZ 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small_2x/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=ElOaN5mG 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_author_bio_small/public/2017-10/author-profile-default.jpg?h=6386ac74&amp;itok=w8Rg1PQZ" alt=""></picture><!----></div><div _ngcontent-sc26="" class="ellipse"><svg _ngcontent-sc26="" height="500" viewBox="0 0 46 500" width="46"><path _ngcontent-sc26="" d="M0 0h46c-29.758 83.007-44.113 169.773-43.064 260.295 1.049 90.525 15.404 170.425 43.064 239.705h-46v-500z" fill="#213c60"></path></svg></div></div><div _ngcontent-sc26="" class="blog-author__content"><header _ngcontent-sc26=""><h2 _ngcontent-sc26="" class="blog-author__title">About the Author</h2><h3 _ngcontent-sc26="" class="blog-author__name">Threat Hunter Team</h3><!----><h4 _ngcontent-sc26="" class="blog-author__position">Symantec</h4></header><!----><p _ngcontent-sc26="">The Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis that helps customers respond to attacks.</p></div></div></app-blog-author></div><!----><div class="blog-post__comment"><header><h2 class="blog-post__comment-title"><i aria-hidden="true" class="fa fa-share-alt"></i>Want to comment on this post?</h2></header><p>We encourage you to share your thoughts on your favorite social platform.</p><!----><div class="social-list"><!----></div></div></div></article></main></div><!----><div class="related-blog-posts related-blog-posts__blog-post"><div class="inner"><header><h2 class="related-blog-posts__title"><i aria-hidden="true" class="fa fa-compass"></i>Related Blog Posts</h2></header><div class="related-blog-posts__list"><!----><app-related-blog-posts class="related-blog-posts__item" _nghost-sc27=""><a _ngcontent-sc27="" class="related-blog-posts__link" href="/blogs/threat-intelligence/solarwinds-raindrop-malware"><!----><figure _ngcontent-sc27="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2021-01/GettyImages-1095112402.jpg?h=bfa41935&amp;itok=zbFdvO5A 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2021-01/GettyImages-1095112402.jpg?h=bfa41935&amp;itok=rbEcbNUs 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2021-01/GettyImages-1095112402.jpg?h=bfa41935&amp;itok=D8IGEcuA 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2021-01/GettyImages-1095112402.jpg?h=bfa41935&amp;itok=NbWP4cZt 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2021-01/GettyImages-1095112402.jpg?h=bfa41935&amp;itok=XU4VzBM2 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2021-01/GettyImages-1095112402.jpg?h=bfa41935&amp;itok=KRqFmxfg 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2021-01/GettyImages-1095112402.jpg?h=bfa41935&amp;itok=XU4VzBM2" alt=""></picture><!----></figure><div _ngcontent-sc27="" class="meta"><span _ngcontent-sc27="" class="meta__date"><!---->Posted: <time _ngcontent-sc27="">18 Jan, 2021</time></span><span _ngcontent-sc27="" class="meta__time-to-read">5 <!---->Min Read</span></div><h3 _ngcontent-sc27="" class="related-blog-posts__post-title">Raindrop: New Malware Discovered in SolarWinds Investigation</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc27=""><a _ngcontent-sc27="" class="related-blog-posts__link" href="/blogs/threat-intelligence/solarwinds-sunburst-command-control"><!----><figure _ngcontent-sc27="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2021-01/GettyImages-1157048386.jpg?h=790be497&amp;itok=Tui6Il3e 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2021-01/GettyImages-1157048386.jpg?h=790be497&amp;itok=oCZcNbaF 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2021-01/GettyImages-1157048386.jpg?h=790be497&amp;itok=b-6lz66A 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2021-01/GettyImages-1157048386.jpg?h=790be497&amp;itok=eF7nAzl3 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2021-01/GettyImages-1157048386.jpg?h=790be497&amp;itok=xC-N6tTh 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2021-01/GettyImages-1157048386.jpg?h=790be497&amp;itok=UhnkAUho 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2021-01/GettyImages-1157048386.jpg?h=790be497&amp;itok=xC-N6tTh" alt=""></picture><!----></figure><div _ngcontent-sc27="" class="meta"><span _ngcontent-sc27="" class="meta__date"><!---->Posted: <time _ngcontent-sc27="">15 Jan, 2021</time></span><span _ngcontent-sc27="" class="meta__time-to-read">5 <!---->Min Read</span></div><h3 _ngcontent-sc27="" class="related-blog-posts__post-title">SolarWinds: Insights into Attacker Command and Control Process</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc27=""><a _ngcontent-sc27="" class="related-blog-posts__link" href="/blogs/threat-intelligence/solarwinds-unique-dga"><!----><figure _ngcontent-sc27="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=brAkrgfy 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=B0l562Lt 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=rdkN7Axa 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=DN3QpYr6 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=Ah3Ff0P4 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=A81-DOIb 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2021-01/GettyImages-92884243.jpg?h=2eadb7b6&amp;itok=Ah3Ff0P4" alt=""></picture><!----></figure><div _ngcontent-sc27="" class="meta"><span _ngcontent-sc27="" class="meta__date"><!---->Posted: <time _ngcontent-sc27="">7 Jan, 2021</time></span><span _ngcontent-sc27="" class="meta__time-to-read">5 <!---->Min Read</span></div><h3 _ngcontent-sc27="" class="related-blog-posts__post-title">SolarWinds: How a Rare DGA&nbsp;Helped Attacker Communications Fly Under the Radar</h3><!----></a></app-related-blog-posts><app-related-blog-posts class="related-blog-posts__item" _nghost-sc27=""><a _ngcontent-sc27="" class="related-blog-posts__link" href="/blogs/threat-intelligence/solarwinds-attacks-stealthy-attackers-attempted-evade-detection"><!----><figure _ngcontent-sc27="" app-picture="" class="related-blog-posts__image"><!----><!----><picture><!----><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=ywBD2U_W 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_large_2x/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=4zCFC-Sr 2x" media="(min-width: 1020px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=dBMYaMNN 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_medium_2x/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=I5DX89II 2x" media="(min-width: 720px)"><source srcset="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=m_qOTxz7 1x, https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small_2x/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=i3UjCQaQ 2x" media="(min-width: 420px)"><img src="https://symantec-enterprise-blogs.security.com/sites/default/files/styles/blogs_hero_related_small/public/2020-12/GettyImages-507072286.jpg?h=d1757362&amp;itok=m_qOTxz7" alt=""></picture><!----></figure><div _ngcontent-sc27="" class="meta"><span _ngcontent-sc27="" class="meta__date"><!---->Posted: <time _ngcontent-sc27="">21 Dec, 2020</time></span><span _ngcontent-sc27="" class="meta__time-to-read">5 <!---->Min Read</span></div><h3 _ngcontent-sc27="" class="related-blog-posts__post-title">SolarWinds Attacks: Stealthy Attackers Attempted To Evade Detection</h3><!----></a></app-related-blog-posts></div></div></div></div></app-blog-post><footer class="footer"><div class="footer-inner"><div class="footer-column footer-column__first"><a class="footer-logo" href="https://www.broadcom.com" rel="home noopener" target="_blank" title="Broadcom"><img alt="Broadcom" src="assets/logo--white.svg"><span class="footer-text">Symantec Enterprise Blogs</span></a><app-subscribe-button class="subscribe-email__wrapper" _nghost-sc4=""><button _ngcontent-sc4="" class="subscribe-email"><i _ngcontent-sc4="" class="fa fa-envelope"></i> Subscribe</button></app-subscribe-button></div><div class="footer-column footer-column__last"><ul class="footer-menu__list"><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/privacy-policy" rel="noopener" target="_blank">Privacy Policy</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/cookie-policy" rel="noopener" target="_blank">Cookie Policy</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/ca/data-transfers" rel="noopener" target="_blank">Data Processing and Data Transfers</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/citizenship/supplier-responsibility" rel="noopener" target="_blank">Supplier Responsibility</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/company/legal/terms-of-use/" rel="noopener" target="_blank">Terms of Use</a></li><li class="footer-menu__item"><a href="https://www.broadcom.com/sitemap" rel="noopener" target="_blank">Sitemap</a></li></ul><div class="footer-copyright">Copyright © 2005-2021 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div><app-subscribe-form-modal _nghost-sc5=""><div _ngcontent-sc5="" class="modal"><div _ngcontent-sc5="" class="modal__inner"><!----><div _ngcontent-sc5="" class="modal__content"><i _ngcontent-sc5="" class="fa fa-envelope modal__icon"></i><h2 _ngcontent-sc5="" class="modal__title">Get Symantec's Latest Blog Posts <em _ngcontent-sc5="">In Your Inbox</em></h2><form _ngcontent-sc5="" class="subscribe-form ng-untouched ng-pristine ng-invalid" novalidate=""><!----><div _ngcontent-sc5="" class="form-fields"><!----><!----><div _ngcontent-sc5="" class="form-item subscribe-form-tos"><input _ngcontent-sc5="" name="termsAccept" type="checkbox"> I accept the <a _ngcontent-sc5="" target="_self" href="https://www.broadcom.com/company/legal/terms-of-use/">Terms of Use</a>. Your privacy is important to us. Please see our <a _ngcontent-sc5="" target="_self" href="https://www.broadcom.com/company/legal/privacy-policy">Privacy Policy</a> for more information. </div><div _ngcontent-sc5="" class="form-item"><input _ngcontent-sc5="" class="subscribe-form__email ng-untouched ng-pristine ng-valid" formcontrolname="subscriberEmail" maxlength="255" name="subscribe" placeholder="Enter your email address" size="20" title="Enter your email address" type="email" value=""></div><!----><div _ngcontent-sc5="" class="form-item"><re-captcha _ngcontent-sc5="" formcontrolname="recaptcha" id="ngrecaptcha-492" class="ng-untouched ng-pristine ng-invalid"></re-captcha></div><button _ngcontent-sc5="" class="form-submit" disabled=""><i _ngcontent-sc5="" class="fa fa-envelope"></i> Subscribe</button><button _ngcontent-sc5="" class="form-submit form-submit__submitted hidden"><i _ngcontent-sc5="" class="fa fa-check"></i> Submitted</button></div></form><button _ngcontent-sc5="" class="modal__close"><span _ngcontent-sc5="">Close</span></button></div></div></div></app-subscribe-form-modal></app-root>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KF7XWD"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
<script src="runtime-es2015.da0a6e8d67e0e9164a4b.js" type="module"></script><script src="runtime-es5.da0a6e8d67e0e9164a4b.js" nomodule="" defer=""></script><script src="polyfills-es5.304c50711c869a9ad3f0.js" nomodule="" defer=""></script><script src="polyfills-es2015.b4a3bdae6bcd059f26dd.js" type="module"></script><script src="main-es2015.db474897433611b8a787.js" type="module"></script><script src="main-es5.db474897433611b8a787.js" nomodule="" defer=""></script>

</body></html>