
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Evolution of Valak, from Its Beginnings to Mass Distribution</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/valak-evolution/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/valak-evolution/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Valak is an information stealer and malware loader that has become increasingly common in our threat landscape and is being mass distributed by an actor known as Shathak/TA551."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/valak-evolution/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Evolution of Valak, from Its Beginnings to Mass Distribution" />
<meta property="og:description" content="Valak is an information stealer and malware loader that has become increasingly common in our threat landscape and is being mass distributed by an actor known as Shathak/TA551." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/valak-evolution/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="AutoFocus" />
<meta property="article:tag" content="Cortex" />
<meta property="article:tag" content="Cybercrime" />
<meta property="article:tag" content="malware" />
<meta property="article:tag" content="threat prevention" />
<meta property="article:tag" content="Valak" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2020-07-24T19:00:29+00:00" />
<meta property="article:modified_time" content="2020-07-28T21:38:33+00:00" />
<meta property="og:updated_time" content="2020-07-28T21:38:33+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image.jpeg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image.jpeg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Valak is an information stealer and malware loader that has become increasingly common in our threat landscape and is being mass distributed by an actor known as Shathak/TA551." />
<meta name="twitter:title" content="Evolution of Valak, from Its Beginnings to Mass Distribution" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/Malware-r3d2.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Evolution of Valak, from Its Beginnings to Mass Distribution Comments Feed" href="https://unit42.paloaltonetworks.com/valak-evolution/feed/" />
<meta property="og:likes" content="8"/>
<meta property="og:readtime" content="11"/>
<meta property="og:views" content="19,091"/>
<meta property="og:date_created" content="July 24, 2020 at 12:00 PM"/>
<meta property="og:post_length" content="2639"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Brad Duncan"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bduncan/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Duncan-bio-picture-1-copy-150x150.jpg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/Malware-r3d2.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Evolution of Valak, from Its Beginnings to Mass Distribution","name":"Evolution of Valak, from Its Beginnings to Mass Distribution","description":"Valak is an information stealer and malware loader that has become increasingly common in our threat landscape and is being mass distributed by an actor known as Shathak\/TA551.","url":"https:\/\/unit42.paloaltonetworks.com\/valak-evolution\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/valak-evolution\/","datePublished":"July 24, 2020","articleBody":"Executive Summary\r\nFirst noted in late 2019, Valak is an information stealer and malware loader that has become increasingly common in our threat landscape. From April through June of 2020, we saw waves of Valak malware two to four times a week on average through an email distribution network nicknamed Shathak or TA551. Characteristics of Valak include:\r\n\r\n \tValak relies on scheduled tasks and Windows registry updates to remain persistent on an infected Windows host.\r\n \tValak uses Alternate Data Stream (ADS) as a technique to run follow-up malware on an infected host.\r\n \tRecent Valak infections show an increase in obfuscated code for configuration scripts used during the infection, possibly as an attempt to avoid detection.\r\n \tSince April 2020, we have seen a great deal of Valak malware distributed by an actor sometimes referred to as Shathak\/TA551.\r\n\r\nThis blog covers the history of Valak, reviews the chain of events for an infection, examines traffic generated by Valak and explores recent updates in obfuscation techniques used by the malware in order to evade detection. This blog also examines the Shathak\/TA551 distribution system that has been consistently pushing Valak since April 2020.\r\n\r\nPalo Alto Networks customers are protected from Valak by our Threat Prevention subscription for the Next-Generation Firewall.\r\nValak History\r\nThe earliest public record of Valak comes from Proofpoint's ET Pro ruleset, where two rules detecting Valak were introduced on October 22, 2019, for the Suricata Open Source threat detection engine.\r\n\r\nValak was documented as follow-up malware during an Ursnif infection (also known as Gozi or IFSB) on December 19, 2019. Analysis by Cybereason revealed Valak used a combination of techniques to remain persistent on an infected Windows host. Valak relies on scheduled tasks combined with Windows registry updates. It also uses Alternate Data Stream (ADS) during the infection process for follow-up malware.\r\n\r\nMost examples of Valak in recent months have been distributed through malicious spam (malspam). SentinelLabs (SentinelOne) published a report providing further information about Valak, including a connection between Valak malware distribution and campaigns similar to the \u201cGozi ConfCrew.\u201d Distribution characteristics were further explored in a Threat Spotlight on Valak published by Talos (Cisco).\r\n\r\nThe distribution network using malspam to push Valak has been called Shathak on Twitter. Shathak has been attributed to an actor named TA551 on the Malware Don\u2019t Need Coffee blog.\r\nChain of Events\r\n[caption id=\"attachment_108101\" align=\"aligncenter\" width=\"900\"] Figure 1. Chain of events for recent Valak malware activity.[\/caption]\r\n\r\nFigure 1 shows the chain of events seen for Valak infections in June and early July 2020. For a Windows computer to become infected, a victim must:\r\n\r\n \tOpen malspam with password-protected ZIP attachment. On June 30 and July 1, 2020, we saw indications there may also have been a link to download a ZIP archive instead of an attachment.\r\n \tExtract Microsoft Word document from the password-protected ZIP archive using a unique password from the message text.\r\n \tOpen the Word document as shown below in Figure 2 and enable macros.\r\n\r\n[caption id=\"attachment_108103\" align=\"aligncenter\" width=\"900\"] Figure 2. Example of a Microsoft Word document from June 24, 2020, with macros for Valak.[\/caption]\r\n\r\nFor Valak infections during June 2020, the initial activity consisted of:\r\n\r\n \tAn HTTP or HTTPS URL ending with .cab that returned a DLL to install Valak.\r\n \tValak DLL was saved to the C:\\ProgramData\\ directory using a random file name, usually with a .dat or .jpg file extension, as shown in Figure 3.\r\n \tValak DLL was run using regsvr32.exe -s [filename]\r\n \tPopup message stating the DLL was successfully run, as shown in Figure 4.\r\n \tA JavaScript configuration file appeared as a random file name (always the same name for each wave of infections) under the C:\\Users\\Public\\ directory, as shown in Figures 5 and 6.\r\n \tInitial HTTP command and control (C2) traffic returned encoded ASCII text used to create additional malware\/artifacts for the infection.\r\n\r\n[caption id=\"attachment_108105\" align=\"aligncenter\" width=\"900\"] Figure 3. Initial Valak DLL retrieved after enabling macros on the Word document from Figure 2.[\/caption]\r\n\r\n[caption id=\"attachment_108107\" align=\"aligncenter\" width=\"900\"] Figure 4. Pop-up message on a Windows 10 host when an initial Valak DLL was successfully run using RegSvr32.exe after macros were enabled on June 24, 2020.[\/caption]\r\n\r\n[caption id=\"attachment_108109\" align=\"aligncenter\" width=\"900\"] Figure 5. Initial script file in C:\\Users\\Public\\ directory used during Valak infection from June 24, 2020.[\/caption]\r\n\r\n[caption id=\"attachment_108111\" align=\"aligncenter\" width=\"900\"] Figure 6. Contents of the JavaScript configuration file from June 24, 2020.[\/caption]\r\n\r\nFigure 6 reveals variable names are obfuscated in the JavaScript configuration file. This is an example of obfuscation that we have noted since June 2020, and it is covered in more detail later in this blog when discussing Valak developments.\r\n\r\nAs the infection progressed, three things happened near-simultaneously to make Valak persistent on an infected Windows host:\r\n\r\n \tA Windows executable (EXE) appeared in the infected user's AppData\\Local\\Temp directory as a random file name ending in .bin (PE32 executable, Mono\/.Net assembly), as shown in Figure 7.\r\n \tWindows registry entries were created under the key for HKCU\\SOFTWARE\\ApplicationContainer\\Appsw64\r\n \tA randomly-named text file and JavaScript (JS) file both appeared under the C:\\Users\\Public\\ directory, as shown in Figures 8, 9 and 10.\r\n \tA scheduled task was created to run the JS file located under C:\\Users\\Public\\ and repeat running it every four minutes, as shown in Figure 11.\r\n\r\n[caption id=\"attachment_108113\" align=\"aligncenter\" width=\"900\"] Figure 7. EXE file with a .bin file extension from the June 24, 2020, Valak infection.[\/caption]\r\n\r\n[caption id=\"attachment_108115\" align=\"aligncenter\" width=\"900\"] Figure 8. Additional artifacts in the C:\\Users\\Public\\ directory created during the infection.[\/caption]\r\n\r\n[caption id=\"attachment_108117\" align=\"aligncenter\" width=\"900\"] Figure 9. Contents of the text file, a random string of text.[\/caption]\r\n\r\n[caption id=\"attachment_108119\" align=\"aligncenter\" width=\"900\"] Figure 10. Contents of the JS file used to keep the Valak infection persistent.[\/caption]\r\n\r\n[caption id=\"attachment_108121\" align=\"aligncenter\" width=\"900\"] Figure 11. Scheduled task for JS file used to keep the Valak infection persistent.[\/caption]\r\n\r\nIf the C2 domains remained active during the infection, as early as four minutes later, we saw follow-up malware:\r\n\r\n \tValak C2 traffic returned encoded ASCII text used to create a follow-up malware EXE.\r\n \tThe follow-up malware EXE was appended to the randomly-named text file in C:\\Users\\Public using ADS, as shown in Figure 12.\r\n \tA scheduled task was created to run the follow-up malware EXE once, shortly after it was created, as shown in Figure 13.\r\n\r\n[caption id=\"attachment_108123\" align=\"aligncenter\" width=\"900\"] Figure 12. Text file in C:\\Users\\Public\\ directory updated with ADS.[\/caption]\r\n\r\n[caption id=\"attachment_108125\" align=\"aligncenter\" width=\"900\"] Figure 13. Scheduled task to run the follow-up malware.[\/caption]\r\n\r\nIn our tests, running Valak from a U.S. location on a vulnerable Windows 10 host returned a banking Trojan called IcedID as the follow-up malware. In one case, we saw both IcedID and NetSupport Manager RAT-based malware delivered as follow-up malware on a Windows 7 host from June 2020.\r\nValak Infection Traffic\r\nThe infection starts when a victim enables macros on one of the malicious documents. This usually generates a URL ending with .cab that returns a Windows DLL file. Figure 14 shows a Valak infection from June 24, 2020, filtered in Wireshark to list the HTTP requests and other web-based traffic. The first line shows a URL that ends with .cab. A TCP stream of this activity is shown in Figure 15, and it reveals signs of an EXE or DLL file returned from the server.\r\n\r\n[caption id=\"attachment_108127\" align=\"aligncenter\" width=\"900\"] Figure 14. Traffic from a Valak infection with IcedID as the follow-up malware from June 2020 filtered in Wireshark.[\/caption]\r\n\r\n[caption id=\"attachment_108129\" align=\"aligncenter\" width=\"900\"] Figure 15. TCP stream for the HTTP GET request ending in .cab that returned a Windows DLL file.[\/caption]\r\n\r\nChecking the binary in VirusTotal shows this file is a DLL. This DLL is an installer for Valak. Shortly after the initial HTTP traffic for the Valak DLL, we see other HTTP GET requests starting with:\r\n\r\n \tlicense.jsp?client=\r\n \tarchive.jsp?page=\r\n \tdb.aspx?dfc=\r\n\r\nThe HTTP requests are Valak C2 traffic, which is sent to decoy domains (non-malicious domains from legitimate organizations) and malicious domains. These domains are listed in the initial Valak script previously shown in Figure 5. For example, for Valak infections from the June 24, 2020, wave, the decoy domains were:\r\n\r\n \te87.dspb.akamaidege.net\r\n \tinsiderppe.cloudapp.net\r\n \tpagead46.l.doubleclick.net\r\n\r\nAlso noted in Figure 5 are the malicious domains from the June 24, 2020, wave of Valak:\r\n\r\n \tthepicklepilot.com\r\n \tjoonaskallinen.com\r\n \txfitnessproducts.com\r\n\r\nFigure 5 also shows three additional domains from the June 24, 2020, wave of Valak. These domains appear to be fake or possibly placeholders because they were not registered and did not resolve to any IP address.\r\n\r\n \t59xidd-fuel.com\r\n \t19geds-space.com\r\n \t55sfors-cask.com\r\n\r\nValak C2 traffic returns data as encoded ASCII text that is decoded on the victim host and saved as malware items like script files, EXE used during the infection and data for registry updates for the Valak infection. Figure 16 shows an example of this traffic.\r\n\r\n[caption id=\"attachment_108131\" align=\"aligncenter\" width=\"900\"] Figure 16. Valak C2 over HTTP traffic returning ASCII data used to create malware items on the victim host.[\/caption]\r\n\r\nIn addition to HTTP GET requests, Valak uses HTTP POST requests to exfiltrate certain types of data. In Figures 17 and 18, we see an HTTP POST request starting with class4.aspx?internalService= that sends login credentials used for Microsoft Outlook from an infected Windows host.\r\n\r\n[caption id=\"attachment_108133\" align=\"aligncenter\" width=\"900\"] Figure 17. Valak infection traffic filtered in Wireshark showing an HTTP POST request from the C2 traffic.[\/caption]\r\n\r\n[caption id=\"attachment_108135\" align=\"aligncenter\" width=\"900\"] Figure 18. TCP stream of the HTTP POST request showing a base64 string containing Outlook login credentials of the infected host.[\/caption]\r\n\r\nWe primarily see IcedID as follow-up malware from the Valak infections generated from U.S. locations. Figure 19 shows indicators of IcedID during the Valak infection traffic.\r\n\r\n[caption id=\"attachment_108137\" align=\"aligncenter\" width=\"900\"] Figure 19. Indicators of IcedID as the follow-up malware during this Valak infection.[\/caption]\r\nRecent Developments\r\nAs Valak has developed, we have noticed increased obfuscation in the Valak configuration script. This obfuscation finds its way into other script and Windows registry updates used to keep the infection persistent. Figure 20 shows configuration script from June 23, 2020, using Valak software version 40. Figure 21 shows configuration script from June 24, 2020, using Valak software version 41. Note how variable names and some of the values were obfuscated when Valak changed from version 40 to version 41.\r\n\r\n[caption id=\"attachment_108139\" align=\"aligncenter\" width=\"900\"] Figure 20. Valak version 40 configuration script with variable names and values in plain text.[\/caption]\r\n\r\n[caption id=\"attachment_108141\" align=\"aligncenter\" width=\"900\"] Figure 21. Valak version 41 configuration script with variable names and some values using obfuscated text.[\/caption]\r\n\r\nLike most obfuscation, this is likely an attempt to evade detection. As the weeks and months progress, we predict further obfuscation in Valak\u2019s configuration script and related files.\r\nShathak\/TA551 Distribution\r\nShathak or TA551 is the name some security researchers have given to a specific distribution method that uses password-protected ZIP archives as attachments to malspam. The distribution network may be associated with Russian cybercriminals. It has used Word document templates targeting English-, Italian-, German- and Japanese-speaking recipients. Shathak\/TA551 has been active at least as early as February 2019.\r\n\r\nShathak\/TA551 distribution has the following characteristics:\r\n\r\n \tMalspam spoofs legitimate email chains based on mailbox data retrieved from previously-infected Windows hosts. It sends copies of these email chains to senders and recipients from the original email chain.\r\n \tThe spoofed email chain includes a short message as the most recent item in the chain. This item is a generic message that instructs recipients to open an attached ZIP archive using a supplied password.\r\n \tThe password-protected ZIP attachments contain a Microsoft Word document with macros to install malware. See Appendix A for examples of these Word documents from June 2020.\r\n \tThe macros usually generate a URL ending in .cab to retrieve a binary that installs malware. This binary is currently a DLL file. Appendix B lists examples of URLs from this campaign.\r\n \tPrior to April 2020, the most common malware caused by Word documents associated with Shathak\/TA551 was Ursnif.\r\n \tSince April 2020, the most common malware distributed by these Word documents has been Valak. Appendix C lists a series of Valak DLL examples from June 2020.\r\n \tSince May 2020, passwords used for the ZIP attachments appear to be unique to each recipient.\r\n\r\nTo get an idea of traffic patterns associated with Shathak\/TA551, recent examples of URLs generated by the associated Word macros follow (Read: Date - URL).\r\n\r\n \t2020-05-26 - hxxp:\/\/c1j4xptyujjpyt8[.]com\/gg88wyaftcxr7gu\/wo0zz.php?l=sfzs9.cab\r\n \t2020-05-27 - hxxp:\/\/ft23fpcu5yabw2[.]com\/alfh\/xzrn.php?l=lfahe9.cab\r\n \t2020-06-03 - hxxp:\/\/awh93dhkylps5ulnq-be[.]com\/czwih\/fxla.php?l=gap1.cab\r\n \t2020-06-09 - hxxp:\/\/a4zy33hbmhxx70w9q[.]com\/hdil\/kzex.php?l=soub12.cab\r\n \t2020-06-10 - hxxp:\/\/kzex9vp0jfw6a8up1[.]com\/hdil\/kzex.php?l=phin1.cab\r\n \t2020-06-22 - hxxp:\/\/5u2mr[.]com\/unbbmevd\/d76.php?l=oev1.cab\r\n \t2020-06-23 - hxxp:\/\/fepz41[.]com\/unbbmevd\/d76.php?l=ynetz11.cab\r\n \t2020-06-24 - hxxp:\/\/mbzrrt[.]com\/unbbmevd\/d76.php?l=ftywl4.cab\r\n \t2020-06-26 - hxxp:\/\/ofxvp[.]com\/unbbmevd\/d76.php?l=wozmbl9.cab\r\n \t2020-07-06 - hxxp:\/\/eto9ve1[.]com\/iz5\/yaca.php?l=tze7.cab\r\n\r\nAs noted previously, Appendix B provides more examples of these URLs generated by Word macros associated with Shathak\/TA551.\r\n\r\nFigures 22-30 provide screenshots with selected examples of malspam and the extracted Word documents associated with Shathak\/TA551. These images illustrate how the Shathak\/TA551 distribution has evolved since February 2019.\r\n\r\n[caption id=\"attachment_108143\" align=\"aligncenter\" width=\"900\"] Figure 22. Shathak\/TA551 malspam to an English-speaking recipient from February 4, 2019.[\/caption]\r\n\r\n[caption id=\"attachment_108145\" align=\"aligncenter\" width=\"900\"] Figure 23. Shathak\/TA551 malspam to an Italian-speaking recipient from April 2, 2019.[\/caption]\r\n\r\n[caption id=\"attachment_108147\" align=\"aligncenter\" width=\"900\"] Figure 24. Shathak\/TA551 malspam to an English-speaking recipient from July 22, 2019.[\/caption]\r\n\r\n&nbsp;\r\n\r\n[caption id=\"attachment_108149\" align=\"aligncenter\" width=\"900\"] Figure 25. Shathak\/TA551 malspam to a German-speaking recipient from October 30, 2019.[\/caption]\r\n\r\n&nbsp;\r\n\r\n[caption id=\"attachment_108151\" align=\"aligncenter\" width=\"900\"] Figure 26. Shathak\/TA551 malspam to a Japanese-speaking recipient from December 17, 2019.[\/caption]\r\n\r\n[caption id=\"attachment_108153\" align=\"aligncenter\" width=\"900\"] Figure 27. Shathak\/TA551 malspam to a German-speaking recipient from March 26, 2020.[\/caption]\r\n\r\n[caption id=\"attachment_108155\" align=\"aligncenter\" width=\"900\"] Figure 28. Shathak\/TA551 malspam to an English-speaking recipient from April 28, 2020.[\/caption]\r\n\r\n[caption id=\"attachment_108157\" align=\"aligncenter\" width=\"900\"] Figure 29. Shathak\/TA551 malspam to an English-speaking recipient from May 22, 2020.[\/caption]\r\n\r\n[caption id=\"attachment_108159\" align=\"aligncenter\" width=\"900\"] Figure 30. Shathak\/TA551 malspam to a German-speaking recipient from May 26, 2020.[\/caption]\r\n\r\nThis distribution network has generally pushed Ursnif in previous years, but since late April 2020, we\u2019ve most often seen Valak from Shathak\/TA551. In some cases, we still see Ursnif from this distribution, which recently happened on June 10, 2020, and July 7, 2020.\r\nConclusion\r\nAs we enter the second half of 2020, Valak shows no signs of slowing down. We expect to see further waves of malspam from Shathak\/TA551 distribution pushing Word documents with macros for Valak.\r\n\r\nDue to its complex infection process that relies in part on registry updates with malware code, Valak can easily infect an unprotected Windows host. With ADS used to hide follow-up malware from a Valak infection, the risk is greatly increased.\r\n\r\nHowever, security best practices like running fully patched and up-to-date versions of Microsoft Windows will hinder or prevent Valak infections. Palo Alto Networks customers are further protected from Valak by our Threat Prevention subscription for the Next-Generation Firewall. AutoFocus users can search for Valak activity by using the Valak tag.\r\n\r\nAppendix A\r\n\r\nExamples of SHA256 file hashes along with the associated file names for Word documents from Shathak\/TA551 distribution during June 2020. Information available at: https:\/\/raw.githubusercontent.com\/pan-unit42\/iocs\/master\/Valak\/2020-June-SHA256-hashes-of-Word-docs-from-Shathak-TA551-distribution.txt\r\n\r\nAppendix B\r\n\r\nExamples of URLs generated by Word documents associated with Shathak\/TA551. Information available at: https:\/\/raw.githubusercontent.com\/pan-unit42\/iocs\/master\/Valak\/2020-03-23-to-2020-07-07-TA551-traffic-pattern-history-since-Valak.txt\r\n\r\nAppendix C\r\n\r\nExamples of SHA256 file hashes for Valak DLL files seen from Shathak\/TA551 distribution during June 2020. Information available at: https:\/\/raw.githubusercontent.com\/pan-unit42\/iocs\/master\/Valak\/2020-June-SHA256-hashes-of-Valak-DLL-files-from-Shathak-TA551-distribution.txt\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2020\/07\/Malware-r3d2.png","width":150,"height":75},"author":[{"@type":"Person","name":"Brad Duncan"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"108096","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=108096' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvalak-evolution%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvalak-evolution%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-108096 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Evolution of Valak, from Its Beginnings to Mass Distribution</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-108096 entry-meta">
			
			
			<span class="post-views-count">19,091</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'108096','like')"><i class="ui ui-2"></i><span class="ml-5">8</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 11</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvalak-evolution%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvalak-evolution%2F+-+Evolution+of+Valak%2C+from+Its+Beginnings+to+Mass+Distribution" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvalak-evolution%2F&title=Evolution+of+Valak%2C+from+Its+Beginnings+to+Mass+Distribution&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/valak-evolution/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/bduncan/" title="Posts by Brad Duncan" class="author url fn" rel="author">Brad Duncan</a>        </p>
        <p><time datetime="2020-07-24T19:00:29+00:00">July 24, 2020 at 12:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/autofocus/" rel="tag">AutoFocus</a>, <a href="https://unit42.paloaltonetworks.com/tag/cortex/" rel="tag">Cortex</a>, <a href="https://unit42.paloaltonetworks.com/tag/cybercrime/" rel="tag">Cybercrime</a>, <a href="https://unit42.paloaltonetworks.com/tag/malware/" rel="tag">malware</a>, <a href="https://unit42.paloaltonetworks.com/tag/threat-prevention/" rel="tag">threat prevention</a>, <a href="https://unit42.paloaltonetworks.com/tag/valak/" rel="tag">Valak</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/Malware-r3d2.png" class="attachment-single size-single" alt="Illustration of a malware infection" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/valak-evolution/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2><strong>Executive Summary</strong></h2>
<p>First noted in late 2019, Valak is an information stealer and malware loader that has become increasingly common in our threat landscape. From April through June of 2020, we saw waves of Valak malware two to four times a week on average through an email distribution network nicknamed Shathak or TA551. Characteristics of Valak include:</p>
<ul>
<li>Valak relies on <a href="https://attack.mitre.org/techniques/T1053/005/">scheduled tasks</a> and <a href="https://attack.mitre.org/techniques/T1547/001/">Windows registry updates</a> to remain persistent on an infected Windows host.</li>
<li>Valak uses <a href="https://www.sans.org/blog/alternate-data-streams-overview/">Alternate Data Stream (ADS)</a> as a technique to run follow-up malware on an infected host.</li>
<li>Recent Valak infections show an increase in obfuscated code for configuration scripts used during the infection, possibly as an attempt to avoid detection.</li>
<li>Since April 2020, we have seen a great deal of Valak malware distributed by an actor sometimes referred to as Shathak/TA551.</li>
</ul>
<p>This blog covers the history of Valak, reviews the chain of events for an infection, examines traffic generated by Valak and explores recent updates in obfuscation techniques used by the malware in order to evade detection. This blog also examines the Shathak/TA551 distribution system that has been consistently pushing Valak since April 2020.</p>
<p>Palo Alto Networks customers are protected from Valak by our <a href="https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention">Threat Prevention subscription</a> for the Next-Generation Firewall.</p>
<h2>Valak History</h2>
<p>The earliest public record of Valak comes from Proofpoint&#8217;s ET Pro ruleset, where <a href="https://www.proofpoint.com/us/daily-ruleset-update-summary-20191022">two rules detecting Valak were introduced on October 22, 2019</a>, for the Suricata Open Source threat detection engine.</p>
<p>Valak was documented<a href="https://www.malware-traffic-analysis.net/2019/12/19/index.html"> as follow-up malware during an Ursnif infection</a> (also known as Gozi or IFSB) on December 19, 2019. <a href="https://www.cybereason.com/blog/valak-more-than-meets-the-eye">Analysis by Cybereason</a> revealed Valak used a combination of techniques to remain persistent on an infected Windows host. Valak relies on scheduled tasks combined with Windows registry updates. It also uses <a href="https://www.sans.org/blog/alternate-data-streams-overview/">Alternate Data Stream (ADS)</a> during the infection process for follow-up malware.</p>
<p>Most examples of Valak in recent months have been distributed through malicious spam (malspam). SentinelLabs (SentinelOne) published <a href="https://labs.sentinelone.com/valak-malware-and-the-connection-to-gozi-loader-confcrew/">a report providing further information about Valak</a>, including a connection between Valak malware distribution and campaigns similar to the “Gozi ConfCrew.” Distribution characteristics were further explored in a <a href="https://blog.talosintelligence.com/2020/07/valak-emerges.html">Threat Spotlight on Valak</a> published by Talos (Cisco).</p>
<p>The distribution network using malspam to push Valak has been called<a href="https://twitter.com/luc4m/status/1265194192768315392"> Shathak</a> on Twitter. Shathak has been<a href="https://malware.dontneedcoffee.com/refs/actors/ta551/"> attributed to an actor named TA551</a> on the Malware Don’t Need Coffee blog.</p>
<h2>Chain of Events</h2>
<figure id="attachment_108101" aria-describedby="caption-attachment-108101" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108101" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image.jpeg" alt="This image illustrates the chain of events observed for recent Valak malware activity. Beginning with Shathak/TA551 distribution, the process includes malspan, password-protected ZIP attachment, extracting a Word document with macros from that attachment, enabling macros and then leading to an HTTP URL ending in .cab. This leads to downloading the initial Valak binary, configuring the script for the initial infection activity, HTTP Valak C2 traffic, and making Valak persistent through JS file, registry entries and scheduled tasks. More Valak C2 traffic can lead to followup malware added as ADS to text file, initially run through scheduled task. " width="900" height="517" /><figcaption id="caption-attachment-108101" class="wp-caption-text">Figure 1. Chain of events for recent Valak malware activity.</figcaption></figure>
<p>Figure 1 shows the chain of events seen for Valak infections in June and early July 2020. For a Windows computer to become infected, a victim must:</p>
<ul>
<li>Open malspam with password-protected ZIP attachment. On June 30 and July 1, 2020, we saw indications there may also have been a link to download a ZIP archive instead of an attachment.</li>
<li>Extract Microsoft Word document from the password-protected ZIP archive using a unique password from the message text.</li>
<li>Open the Word document as shown below in Figure 2 and enable macros.</li>
</ul>
<figure id="attachment_108103" aria-describedby="caption-attachment-108103" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108103" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-1.jpeg" alt="The text in the screenshot reads: &quot;This document created in previous version of Microsoft Office Word. To view or edit this document, please click 'Enable editing' button on the top bar, and then click 'Enable content.'&quot; This message is designed to trick the recipient into enabling macros for Valak. " width="900" height="663" /><figcaption id="caption-attachment-108103" class="wp-caption-text">Figure 2. Example of a Microsoft Word document from June 24, 2020, with macros for Valak.</figcaption></figure>
<p>For Valak infections during June 2020, the initial activity consisted of:</p>
<ul>
<li>An HTTP or HTTPS URL ending with <span style="font-family: 'courier new', courier, monospace;">.cab</span> that returned a DLL to install Valak.</li>
<li>Valak DLL was saved to the <span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\</span> directory using a random file name, usually with a <span style="font-family: 'courier new', courier, monospace;">.dat</span> or <span style="font-family: 'courier new', courier, monospace;">.jpg</span> file extension, as shown in Figure 3.</li>
<li>Valak DLL was run using <span style="font-family: 'courier new', courier, monospace;">regsvr32.exe -s</span> <em>[filename]</em></li>
<li>Popup message stating the DLL was successfully run, as shown in Figure 4.</li>
<li>A JavaScript configuration file appeared as a random file name (always the same name for each wave of infections) under the <span style="font-family: 'courier new', courier, monospace;">C:\Users\Public\ directory</span>, as shown in Figures 5 and 6.</li>
<li>Initial HTTP command and control (C2) traffic returned encoded ASCII text used to create additional malware/artifacts for the infection.</li>
</ul>
<figure id="attachment_108105" aria-describedby="caption-attachment-108105" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108105" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-2.jpeg" alt="Valak DLL is saved to the C:\ProgramData\ directory using a random file name, as shown in this screenshot. " width="900" height="349" /><figcaption id="caption-attachment-108105" class="wp-caption-text">Figure 3. Initial Valak DLL retrieved after enabling macros on the Word document from Figure 2.</figcaption></figure>
<figure id="attachment_108107" aria-describedby="caption-attachment-108107" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108107" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-3.jpeg" alt="Message shown in screenshot: RegSvr32, DllRegisterServer in c:\programdata\51508.jpg succeeded. A link is present for the user to click OK. " width="900" height="340" /><figcaption id="caption-attachment-108107" class="wp-caption-text">Figure 4. Pop-up message on a Windows 10 host when an initial Valak DLL was successfully run using RegSvr32.exe after macros were enabled on June 24, 2020.</figcaption></figure>
<figure id="attachment_108109" aria-describedby="caption-attachment-108109" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108109" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-4.jpeg" alt="A JavaScript configuration file appears as a random file name under the C:\Users\Public\ directory" width="900" height="291" /><figcaption id="caption-attachment-108109" class="wp-caption-text">Figure 5. Initial script file in C:\Users\Public\ directory used during Valak infection from June 24, 2020.</figcaption></figure>
<figure id="attachment_108111" aria-describedby="caption-attachment-108111" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108111" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-5.jpeg" alt="The screenshot shows how Valak obfuscates variable names in the JavaScript configuration file. This is an example of obfuscation that we have noted since June 2020. " width="900" height="500" /><figcaption id="caption-attachment-108111" class="wp-caption-text">Figure 6. Contents of the JavaScript configuration file from June 24, 2020.</figcaption></figure>
<p>Figure 6 reveals variable names are obfuscated in the JavaScript configuration file. This is an example of obfuscation that we have noted since June 2020, and it is covered in more detail later in this blog when discussing Valak developments.</p>
<p>As the infection progressed, three things happened near-simultaneously to make Valak persistent on an infected Windows host:</p>
<ul>
<li>A Windows executable (EXE) appeared in the infected user&#8217;s <span style="font-family: 'courier new', courier, monospace;">AppData\Local\Temp</span> directory as a random file name ending in <span style="font-family: 'courier new', courier, monospace;">.bin</span> (PE32 executable, Mono/.Net assembly), as shown in Figure 7.</li>
<li>Windows registry entries were created under the key for <span style="font-family: 'courier new', courier, monospace;">HKCU\SOFTWARE\ApplicationContainer\Appsw64</span></li>
<li>A randomly-named text file and JavaScript (JS) file both appeared under the <span style="font-family: 'courier new', courier, monospace;">C:\Users\Public\ directory</span>, as shown in Figures 8, 9 and 10.</li>
<li>A scheduled task was created to run the JS file located under <span style="font-family: 'courier new', courier, monospace;">C:\Users\Public\</span> and repeat running it every four minutes, as shown in Figure 11.</li>
</ul>
<figure id="attachment_108113" aria-describedby="caption-attachment-108113" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108113" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-6.jpeg" alt="A Windows executable appeared in the infected user's AppData\Local\Temp directory as a random file name ending in .bin" width="900" height="286" /><figcaption id="caption-attachment-108113" class="wp-caption-text">Figure 7. EXE file with a .bin file extension from the June 24, 2020, Valak infection.</figcaption></figure>
<figure id="attachment_108115" aria-describedby="caption-attachment-108115" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108115" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-7.jpeg" alt="A randomly-named text file and JavaScript (JS) file both appeared under the C:\Users\Public\ directory." width="900" height="349" /><figcaption id="caption-attachment-108115" class="wp-caption-text">Figure 8. Additional artifacts in the C:\Users\Public\ directory created during the infection.</figcaption></figure>
<figure id="attachment_108117" aria-describedby="caption-attachment-108117" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108117" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-8.jpeg" alt="Displayed in WordPad, we see the contents of the text file, which is a random string. " width="900" height="480" /><figcaption id="caption-attachment-108117" class="wp-caption-text">Figure 9. Contents of the text file, a random string of text.</figcaption></figure>
<figure id="attachment_108119" aria-describedby="caption-attachment-108119" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108119" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-9.jpeg" alt="Within the contents of the JS file used to keep the Valak infection persistent, we identified a 32-character ASCII string representing a hexadecimal value that identifies the infected Windows host" width="900" height="500" /><figcaption id="caption-attachment-108119" class="wp-caption-text">Figure 10. Contents of the JS file used to keep the Valak infection persistent.</figcaption></figure>
<figure id="attachment_108121" aria-describedby="caption-attachment-108121" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108121" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-10.jpeg" alt="The screenshot shows the context of a scheduled task that keeps the Valak infection persistent. Some of the text reads: &quot;Smart Update Service - After triggered, repeat every 00:04:00 indefinitely.&quot;" width="900" height="363" /><figcaption id="caption-attachment-108121" class="wp-caption-text">Figure 11. Scheduled task for JS file used to keep the Valak infection persistent.</figcaption></figure>
<p>If the C2 domains remained active during the infection, as early as four minutes later, we saw follow-up malware:</p>
<ul>
<li>Valak C2 traffic returned encoded ASCII text used to create a follow-up malware EXE.</li>
<li>The follow-up malware EXE was appended to the randomly-named text file in <span style="font-family: 'courier new', courier, monospace;">C:\Users\Public</span> using ADS, as shown in Figure 12.</li>
<li>A scheduled task was created to run the follow-up malware EXE once, shortly after it was created, as shown in Figure 13.</li>
</ul>
<figure id="attachment_108123" aria-describedby="caption-attachment-108123" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108123" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-11.jpeg" alt="The top section of the screenshot shows the AlternateStreamView, appended with ADS for follow-up malware. The lower section of the screenshot shows the text file modified after it first appeared. " width="900" height="494" /><figcaption id="caption-attachment-108123" class="wp-caption-text">Figure 12. Text file in C:\Users\Public\ directory updated with ADS.</figcaption></figure>
<figure id="attachment_108125" aria-describedby="caption-attachment-108125" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108125" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-12.jpeg" alt="In addition to Smart Update Service, the screenshot shows an additional scheduled task to run follow-up malware (WSUPackage...)" width="900" height="363" /><figcaption id="caption-attachment-108125" class="wp-caption-text">Figure 13. Scheduled task to run the follow-up malware.</figcaption></figure>
<p>In our tests, running Valak from a U.S. location on a vulnerable Windows 10 host returned a banking Trojan called <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.icedid">IcedID</a> as the follow-up malware. In one case, we saw both IcedID and <a href="https://threatpost.com/netsupport-manager-rat-nortonlifelock-docs/153387/">NetSupport Manager RAT-based malware</a> delivered as follow-up malware on a Windows 7 host <a href="https://twitter.com/malware_traffic/status/1276640971367776259">from June 2020</a>.</p>
<h2><strong>Valak Infection Traffic</strong></h2>
<p>The infection starts when a victim enables macros on one of the malicious documents. This usually generates a URL ending with <span style="font-family: 'courier new', courier, monospace;">.cab</span> that returns a Windows DLL file. Figure 14 shows <a href="https://www.malware-traffic-analysis.net/2020/06/24/index.html">a Valak infection from June 24, 2020</a>, filtered in Wireshark to list the HTTP requests and other web-based traffic. The first line shows a URL that ends with <span style="font-family: 'courier new', courier, monospace;">.cab</span>. A TCP stream of this activity is shown in Figure 15, and it reveals signs of an EXE or DLL file returned from the server.</p>
<figure id="attachment_108127" aria-describedby="caption-attachment-108127" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108127" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-13.jpeg" alt="This shows a log of traffic from a Valak infection with IcedID as the follow-up malware." width="900" height="504" /><figcaption id="caption-attachment-108127" class="wp-caption-text">Figure 14. Traffic from a Valak infection with IcedID as the follow-up malware from June 2020 filtered in Wireshark.</figcaption></figure>
<figure id="attachment_108129" aria-describedby="caption-attachment-108129" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108129" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-14.jpeg" alt="Indicators of an EXE or DLL file returned from the server. " width="900" height="484" /><figcaption id="caption-attachment-108129" class="wp-caption-text">Figure 15. TCP stream for the HTTP GET request ending in .cab that returned a Windows DLL file.</figcaption></figure>
<p><a href="https://www.virustotal.com/gui/file/0f0d870fcad3e935d191e4076bfdc3812c278c3bdb6ec2233d71d9cf14a04a17/">Checking the binary in VirusTotal</a> shows this file is a DLL. This DLL is an installer for Valak. Shortly after the initial HTTP traffic for the Valak DLL, we see other HTTP GET requests starting with:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">license.jsp?client=</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">archive.jsp?page=</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">db.aspx?dfc=</span></li>
</ul>
<p>The HTTP requests are Valak C2 traffic, which is sent to decoy domains (non-malicious domains from legitimate organizations) and malicious domains. These domains are listed in the initial Valak script previously shown in Figure 5. For example, for Valak infections from the June 24, 2020, wave, the decoy domains were:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">e87.dspb.akamaidege.net</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">insiderppe.cloudapp.net</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">pagead46.l.doubleclick.net</span></li>
</ul>
<p>Also noted in Figure 5 are the malicious domains from the June 24, 2020, wave of Valak:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">thepicklepilot.com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">joonaskallinen.com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">xfitnessproducts.com</span></li>
</ul>
<p>Figure 5 also shows three additional domains from the June 24, 2020, wave of Valak. These domains appear to be fake or possibly placeholders because they were not registered and did not resolve to any IP address.</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">59xidd-fuel.com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">19geds-space.com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">55sfors-cask.com</span></li>
</ul>
<p>Valak C2 traffic returns data as encoded ASCII text that is decoded on the victim host and saved as malware items like script files, EXE used during the infection and data for registry updates for the Valak infection. Figure 16 shows an example of this traffic.</p>
<figure id="attachment_108131" aria-describedby="caption-attachment-108131" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108131" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-15.jpeg" alt="Valak C2 over HTTP traffic returning ASCII data used to create malware items on the victim host." width="900" height="674" /><figcaption id="caption-attachment-108131" class="wp-caption-text">Figure 16. Valak C2 over HTTP traffic returning ASCII data used to create malware items on the victim host.</figcaption></figure>
<p>In addition to HTTP GET requests, Valak uses HTTP POST requests to exfiltrate certain types of data. In Figures 17 and 18, we see an HTTP POST request starting with <span style="font-family: 'courier new', courier, monospace;">class4.aspx?internalService=</span> that sends login credentials used for Microsoft Outlook from an infected Windows host.</p>
<figure id="attachment_108133" aria-describedby="caption-attachment-108133" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108133" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-16.jpeg" alt="HTTP POST request seen on a Valak-infected Windows host with Outlook" width="900" height="479" /><figcaption id="caption-attachment-108133" class="wp-caption-text">Figure 17. Valak infection traffic filtered in Wireshark showing an HTTP POST request from the C2 traffic.</figcaption></figure>
<figure id="attachment_108135" aria-describedby="caption-attachment-108135" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108135" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-17.jpeg" alt="The screenshot shows login credentials of email account used for Microsoft Outlook on the infected Windows host. It also shows a base64 string that translates to Outlook login credentials of the Valak-infected host. " width="900" height="574" /><figcaption id="caption-attachment-108135" class="wp-caption-text">Figure 18. TCP stream of the HTTP POST request showing a base64 string containing Outlook login credentials of the infected host.</figcaption></figure>
<p>We primarily see IcedID as follow-up malware from the Valak infections generated from U.S. locations. Figure 19 shows indicators of IcedID during the Valak infection traffic.</p>
<figure id="attachment_108137" aria-describedby="caption-attachment-108137" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108137" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-18.jpeg" alt="IcedID traffic during the Valak infection (malicious domains noted by the arrows in the screenshot)" width="900" height="504" /><figcaption id="caption-attachment-108137" class="wp-caption-text">Figure 19. Indicators of IcedID as the follow-up malware during this Valak infection.</figcaption></figure>
<h2><strong>Recent Developments</strong></h2>
<p>As Valak has developed, we have noticed increased obfuscation in the Valak configuration script. This obfuscation finds its way into other script and Windows registry updates used to keep the infection persistent. Figure 20 shows configuration script from June 23, 2020, using Valak software version 40. Figure 21 shows configuration script from June 24, 2020, using Valak software version 41. Note how variable names and some of the values were obfuscated when Valak changed from version 40 to version 41.</p>
<figure id="attachment_108139" aria-describedby="caption-attachment-108139" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108139" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-19.jpeg" alt="Valak configuration script from June 23, 2020, shows software (Valak) signature, software (Valak) version, and variable names and values in plain text. " width="900" height="575" /><figcaption id="caption-attachment-108139" class="wp-caption-text">Figure 20. Valak version 40 configuration script with variable names and values in plain text.</figcaption></figure>
<figure id="attachment_108141" aria-describedby="caption-attachment-108141" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108141" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-20.jpeg" alt="A Valak configuration script from June 24, 2020, shows software (Valak) signature, software (Valak) version, and variable names and values now using encoded strings. " width="900" height="575" /><figcaption id="caption-attachment-108141" class="wp-caption-text">Figure 21. Valak version 41 configuration script with variable names and some values using obfuscated text.</figcaption></figure>
<p>Like most obfuscation, this is likely an attempt to evade detection. As the weeks and months progress, we predict further obfuscation in Valak’s configuration script and related files.</p>
<h2><strong>Shathak/TA551 Distribution</strong></h2>
<p>Shathak or TA551 is the name some security researchers have given to a specific distribution method that uses password-protected ZIP archives as attachments to malspam. The distribution network <a href="https://www.cybereason.com/blog/valak-more-than-meets-the-eye#Relationship-Other-Malware">may be associated with Russian cybercriminals</a>. It has used Word document templates targeting English-, Italian-, German- and Japanese-speaking recipients. Shathak/TA551 has been active at least as early as February 2019.</p>
<p>Shathak/TA551 distribution has the following characteristics:</p>
<ul>
<li>Malspam spoofs legitimate email chains based on mailbox data retrieved from previously-infected Windows hosts. It sends copies of these email chains to senders and recipients from the original email chain.</li>
<li>The spoofed email chain includes a short message as the most recent item in the chain. This item is a generic message that instructs recipients to open an attached ZIP archive using a supplied password.</li>
<li>The password-protected ZIP attachments contain a Microsoft Word document with macros to install malware. See <a href="https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-June-SHA256-hashes-of-Word-docs-from-Shathak-TA551-distribution.txt">Appendix A</a> for examples of these Word documents from June 2020.</li>
<li>The macros usually generate a URL ending in .cab to retrieve a binary that installs malware. This binary is currently a DLL file. <a href="https://www.virustotal.com/gui/file/0f0d870fcad3e935d191e4076bfdc3812c278c3bdb6ec2233d71d9cf14a04a17/">Appendix B</a> lists examples of URLs from this campaign.</li>
<li>Prior to April 2020, the most common malware caused by Word documents associated with Shathak/TA551 was Ursnif.</li>
<li>Since April 2020, the most common malware distributed by these Word documents has been Valak. <a href="https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-June-SHA256-hashes-of-Valak-DLL-files-from-Shathak-TA551-distribution.txt">Appendix C</a> lists a series of Valak DLL examples from June 2020.</li>
<li>Since May 2020, passwords used for the ZIP attachments appear to be unique to each recipient.</li>
</ul>
<p>To get an idea of traffic patterns associated with Shathak/TA551, recent examples of URLs generated by the associated Word macros follow (Read: Date &#8211; URL).</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">2020-05-26 &#8211; hxxp://c1j4xptyujjpyt8[.]com/gg88wyaftcxr7gu/wo0zz.php?l=sfzs9.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-05-27 &#8211; hxxp://ft23fpcu5yabw2[.]com/alfh/xzrn.php?l=lfahe9.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-06-03 &#8211; hxxp://awh93dhkylps5ulnq-be[.]com/czwih/fxla.php?l=gap1.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-06-09 &#8211; hxxp://a4zy33hbmhxx70w9q[.]com/hdil/kzex.php?l=soub12.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-06-10 &#8211; hxxp://kzex9vp0jfw6a8up1[.]com/hdil/kzex.php?l=phin1.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-06-22 &#8211; hxxp://5u2mr[.]com/unbbmevd/d76.php?l=oev1.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-06-23 &#8211; hxxp://fepz41[.]com/unbbmevd/d76.php?l=ynetz11.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-06-24 &#8211; hxxp://mbzrrt[.]com/unbbmevd/d76.php?l=ftywl4.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-06-26 &#8211; hxxp://ofxvp[.]com/unbbmevd/d76.php?l=wozmbl9.cab</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2020-07-06 &#8211; hxxp://eto9ve1[.]com/iz5/yaca.php?l=tze7.cab</span></li>
</ul>
<p>As noted previously, <a href="https://www.virustotal.com/gui/file/0f0d870fcad3e935d191e4076bfdc3812c278c3bdb6ec2233d71d9cf14a04a17/">Appendix B</a> provides more examples of these URLs generated by Word macros associated with Shathak/TA551.</p>
<p>Figures 22-30 provide screenshots with selected examples of malspam and the extracted Word documents associated with Shathak/TA551. These images illustrate how the Shathak/TA551 distribution has evolved since February 2019.</p>
<figure id="attachment_108143" aria-describedby="caption-attachment-108143" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108143" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-21.jpeg" alt="Screenshot reads: &quot;Good Morning, Please see the attached proposal!&quot; It continues by offering a zip password and closeout. The extracted document, request 11, opens with a message attempting to trick the user into enabling macros. " width="900" height="551" /><figcaption id="caption-attachment-108143" class="wp-caption-text">Figure 22. Shathak/TA551 malspam to an English-speaking recipient from February 4, 2019.</figcaption></figure>
<figure id="attachment_108145" aria-describedby="caption-attachment-108145" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108145" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-22.jpeg" alt="Screenshot reads: &quot;Buongiorno, Vedi allegato e di confermare.&quot; It continues by offering a zip password and closeout. The extracted document, doc_02.04, opens with a message attempting to trick the user into enabling macros. " width="900" height="556" /><figcaption id="caption-attachment-108145" class="wp-caption-text">Figure 23. Shathak/TA551 malspam to an Italian-speaking recipient from April 2, 2019.</figcaption></figure>
<figure id="attachment_108147" aria-describedby="caption-attachment-108147" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108147" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-23.jpeg" alt="Screenshot reads: &quot;Good morning, Please see attached and confirm.&quot; It continues by offering a zip password and closeout. The extracted document, info_07.22, opens with a message attempting to trick the user into enabling macros. " width="900" height="555" /><figcaption id="caption-attachment-108147" class="wp-caption-text">Figure 24. Shathak/TA551 malspam to an English-speaking recipient from July 22, 2019.</figcaption></figure>
<p>&nbsp;</p>
<figure id="attachment_108149" aria-describedby="caption-attachment-108149" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108149" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-24.jpeg" alt="Screenshot reads: &quot;Guten Morgen, siehe Anhang.&quot; It continues by offering a zip password and closeout. The extracted document, info_10.30, opens with a message attempting to trick the user into enabling macros. " width="900" height="554" /><figcaption id="caption-attachment-108149" class="wp-caption-text">Figure 25. Shathak/TA551 malspam to a German-speaking recipient from October 30, 2019.</figcaption></figure>
<p>&nbsp;</p>
<figure id="attachment_108151" aria-describedby="caption-attachment-108151" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108151" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-25.jpeg" alt="Screenshot includes a Japanese-language greeting. It continues by offering a zip password and closeout. The extracted document, info_12_18, opens with a message attempting to trick the user into enabling macros. " width="900" height="610" /><figcaption id="caption-attachment-108151" class="wp-caption-text">Figure 26. Shathak/TA551 malspam to a Japanese-speaking recipient from December 17, 2019.</figcaption></figure>
<figure id="attachment_108153" aria-describedby="caption-attachment-108153" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108153" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-26.jpeg" alt="Screenshot reads: &quot;Guten Morgen, Siehen Sie bitte die beigefugle Datei.&quot; It continues by offering a zip password and closeout. The extracted document, information_03.26, opens with a message attempting to trick the user into enabling macros. " width="900" height="571" /><figcaption id="caption-attachment-108153" class="wp-caption-text">Figure 27. Shathak/TA551 malspam to a German-speaking recipient from March 26, 2020.</figcaption></figure>
<figure id="attachment_108155" aria-describedby="caption-attachment-108155" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108155" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-27.jpeg" alt="Screenshot reads: &quot;Please see the attached document.&quot; It continues by offering a zip password and closeout. The Zip archive includes many documents, which when extracted, open with a message attempting to trick the user into enabling macros. " width="900" height="574" /><figcaption id="caption-attachment-108155" class="wp-caption-text">Figure 28. Shathak/TA551 malspam to an English-speaking recipient from April 28, 2020.</figcaption></figure>
<figure id="attachment_108157" aria-describedby="caption-attachment-108157" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108157" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-28.jpeg" alt="Screenshot reads: &quot;Good Morning, Please see the attached document.&quot; It continues by offering a zip password and closeout. The Zip archive includes many documents, which when extracted, open with a message attempting to trick the user into enabling macros. " width="900" height="571" /><figcaption id="caption-attachment-108157" class="wp-caption-text">Figure 29. Shathak/TA551 malspam to an English-speaking recipient from May 22, 2020.</figcaption></figure>
<figure id="attachment_108159" aria-describedby="caption-attachment-108159" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-108159" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/07/word-image-29.jpeg" alt="Figure 30. Shathak/TA551 malspam to a German-speaking recipient from May 26, 2020." width="900" height="573" /><figcaption id="caption-attachment-108159" class="wp-caption-text">Figure 30. Shathak/TA551 malspam to a German-speaking recipient from May 26, 2020.</figcaption></figure>
<p>This distribution network has generally pushed Ursnif in previous years, but since late April 2020, we’ve most often seen Valak from Shathak/TA551. In some cases, we still see Ursnif from this distribution, which recently happened on June 10, 2020, and July 7, 2020.</p>
<h2><strong>Conclusion</strong></h2>
<p>As we enter the second half of 2020, Valak shows no signs of slowing down. We expect to see further waves of malspam from Shathak/TA551 distribution pushing Word documents with macros for Valak.</p>
<p>Due to its complex infection process that relies in part on registry updates with malware code, Valak can easily infect an unprotected Windows host. With ADS used to hide follow-up malware from a Valak infection, the risk is greatly increased.</p>
<p>However, security best practices like running fully patched and up-to-date versions of Microsoft Windows will hinder or prevent Valak infections. Palo Alto Networks customers are further protected from Valak by our Threat Prevention subscription for the Next-Generation Firewall. <a href="https://www.paloaltonetworks.com/cortex/autofocus">AutoFocus</a> users can search for Valak activity by using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Valak">Valak</a> tag.</p>
<p>Appendix A</p>
<p>Examples of SHA256 file hashes along with the associated file names for Word documents from Shathak/TA551 distribution during June 2020. Information available at: <a href="https://github.com/pan-unit42/iocs/blob/master/Valak/2020-June-SHA256-hashes-of-Word-docs-from-Shathak-TA551-distribution.txt">https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-June-SHA256-hashes-of-Word-docs-from-Shathak-TA551-distribution.txt</a></p>
<p>Appendix B</p>
<p>Examples of URLs generated by Word documents associated with Shathak/TA551. Information available at: <a href="https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-03-23-to-2020-07-07-TA551-traffic-pattern-history-since-Valak.txt">https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-03-23-to-2020-07-07-TA551-traffic-pattern-history-since-Valak.txt</a></p>
<p>Appendix C</p>
<p>Examples of SHA256 file hashes for Valak DLL files seen from Shathak/TA551 distribution during June 2020. Information available at: <a href="https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-June-SHA256-hashes-of-Valak-DLL-files-from-Shathak-TA551-distribution.txt">https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-June-SHA256-hashes-of-Valak-DLL-files-from-Shathak-TA551-distribution.txt</a></p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
