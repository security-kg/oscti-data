
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/" />

	<!-- This site is optimized with the Yoast SEO plugin v15.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777</title>
	<meta name="description" content="Vatet, PyXie and Defray777 are all associated with a financially motivated threat group. We aim to get these malware families on the radar." />
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/" />
	<link rel="next" href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/2/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777" />
	<meta property="og:description" content="Vatet, PyXie and Defray777 are all associated with a financially motivated threat group. We aim to get these malware families on the radar." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/" />
	<meta property="og:site_name" content="Unit42" />
	<meta property="article:published_time" content="2020-11-07T02:15:46+00:00" />
	<meta property="article:modified_time" content="2020-11-07T02:09:05+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/Ransomware-r3d3.png" />
	<meta property="og:image:width" content="2001" />
	<meta property="og:image:height" content="1001" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Erica Naone">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="40 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://unit42.paloaltonetworks.com/#website","url":"https://unit42.paloaltonetworks.com/","name":"Unit42","description":"Palo Alto Networks","potentialAction":[{"@type":"SearchAction","target":"https://unit42.paloaltonetworks.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/#primaryimage","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/Ransomware-r3d3.png","width":2001,"height":1001,"caption":"The image illustrates the concept of ransomware, such as used by the threat group behind the Vatet loader, the PyXie remote access tool and the Defray777 ransomware"},{"@type":"WebPage","@id":"https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/#webpage","url":"https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/","name":"When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777","isPartOf":{"@id":"https://unit42.paloaltonetworks.com/#website"},"primaryImageOfPage":{"@id":"https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/#primaryimage"},"datePublished":"2020-11-07T02:15:46+00:00","dateModified":"2020-11-07T02:09:05+00:00","author":{"@id":"https://unit42.paloaltonetworks.com/#/schema/person/487a0dfe3f7c86cdd7998e353de30032"},"description":"Vatet, PyXie and Defray777 are all associated with a financially motivated threat group. We aim to get these malware families on the radar.","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/"]}]},{"@type":"Person","@id":"https://unit42.paloaltonetworks.com/#/schema/person/487a0dfe3f7c86cdd7998e353de30032","name":"Erica Naone","image":{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/#personlogo","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg","caption":"Erica Naone"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777 Comments Feed" href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/feed/" />
<meta property="og:likes" content="7"/>
<meta property="og:readtime" content="26"/>
<meta property="og:views" content="1,354"/>
<meta property="og:date_created" content="November 6, 2020 at 6:15 PM"/>
<meta property="og:post_length" content="9993"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Ryan Tracey"/>
<meta property="og:author" content="Drew Schmitt"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/Ransomware-r3d3.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777","name":"When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777","description":"Vatet, PyXie and Defray777 are all associated with a financially motivated threat group. We aim to get these malware families on the radar.  ","url":"https:\/\/unit42.paloaltonetworks.com\/vatet-pyxie-defray777\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/vatet-pyxie-defray777\/","datePublished":"November 6, 2020","articleBody":"Executive Summary\r\nAs security practitioners, we spend a lot of time focusing on the threat actors and malware families that leverage the most impactful exploits or affect the highest number of victims. But what happens when a threat actor goes \u201clow and slow\u201d to fly under the radar? One could argue that, in that situation, the threat actor may end up having more impact than some of the more prolific threat groups.\r\n\r\nWe first noticed that there may be a relationship between the Vatet loader, PyXie Remote Access Tool (RAT) and Defray777 ransomware when there were remnants and\/or detections of all three in various Incident Response and Managed Threat Hunting engagements. After digging deep into each malware family, it became apparent that Vatet, PyXie and Defray777 are all associated with the same financially motivated threat group that has been operating since as early as 2018.\r\n\r\nThat threat group, sometimes referred to as PyXie by BlackBerry Cylance and GOLD DUPONT by SecureWorks, has been actively conducting successful ransomware operations that have impacted organizations in a number of sectors including healthcare, education, government and technology while remaining under the radar. This blog aims to shed light on this threat group and to disrupt their operations through awareness of their malware families and operating methodologies. In essence, we want to get them on the radar.\r\n\r\nDuring our research, we discovered that this threat group has developed and maintained the Vatet loader. This loader has evolved as this threat group has taken advantage of multiple open source tools by altering the original application to execute payloads such as PyXie and\/or Cobalt Strike. Next, the threat group uses a tailored version of PyXie, which we call PyXie Lite, to conduct reconnaissance and to find and exfiltrate files that are likely sensitive to the victim organization. In a number of incidents we investigated, the actors established an initial foothold into the victim's network through common banking trojans such as IcedID or Trickbot. From there, they deployed Vatet, PyXie and Cobalt Strike before executing Defray777 ransomware entirely in memory. This results in encrypted files on local drives and file shares before exiting. Additionally, the ransomware leaves no evidence of execution except for the encrypted files and ransom notes. In regard to Defray777, the group behind this malware has also ported their ransomware from Windows to Linux, something that, before Defray777, has yet to be seen in the targeted ransomware space. Before this discovery, ransomware that had the ability to impact both Windows and Linux systems was limited to cross-functional ransomware written in Java or scripting languages such as Python. With the port to Linux, Defray777 ransomware has become the first ransomware variant to have standalone executables for Windows and Linux.\r\n\r\nWith three different malware families to cover, we realize there is a lot of content to digest. We have a lot of great details on each of these, but we also realize that you may be interested in one malware family over the others, or you may just prefer to choose your own adventure. If desired, use the links below to skip to the malware family that interests you most, or to get right to the IOCs that will get you hunting for, and detecting, this threat group in action.\r\n\r\nTable of Contents\r\n\r\n \tFirst Up: Vatet Loader\r\n \tNext Up: PyXie Lite\r\n \tLast, but Not Least: Defray777\r\n \tLinking Vatet, PyXie and Defray777\r\n \tIndicators of Compromise (IOCs)\r\n\r\nFirst Up: Vatet Loader\r\nVatet is a custom loader that executes XOR encoded shellcode from the local disk or a network share. The loaders are typically open source applications found on GitHub, or other repositories, that the actors modify to load their shellcode. In most cases, the payload winds up being Cobalt Strike beacons and\/or stagers, but some of the more recent payloads have been an updated version of the PyXie RAT. Vatet is often a precursor to enterprise-wide ransomware attacks.\r\n\r\nMicrosoft wrote about the Vatet loader in April 2020 and said the loader had been in use as early as November 2018 for the purpose of loading Cobalt Strike into memory for execution. This loader continues to be seen in the wild using multiple versions of open source applications to load shellcode including:\r\n\r\n\r\n\r\nVersion\r\nFirst Seen\r\n\r\n\r\nRecompiled Tetris game\r\n2019-06-28\r\n\r\n\r\nRecompiled Notepad\r\n2020-05-03\r\n\r\n\r\nRecompiled desktop customization app, Rainmeter\r\n2020-06-24\r\n\r\n\r\nRecompiled Notepad++\r\n2020-09-24\r\n\r\n\r\n\r\nTable 1. Vatet versions. \r\nIn our research, we have seen Vatet samples with compile times as early as 2019, although this variant has implemented several variations since then.\r\n\r\nIn the earliest versions of Vatet that we analyzed, the malicious payload was loaded via a network share using a path with the following format: \\\\{IP}\\{EPOCHTIME}\\{PAYLOAD}.dat. However, in the latest samples analyzed, the malicious payload was loaded locally from disk. Additionally, we have seen variations in the XOR keys used to decode the payload during execution time. Our research also determined that the Vatet loader has expanded its payload capabilities to load PyXie in addition to the previously seen Cobalt Strike beacons and stagers. Finally, the Vatet loaders we analyzed have evolved and begun taking steps to improve their anti-forensics capabilities by deleting malicious payloads after they have been loaded into memory for execution.\r\n\r\n[caption id=\"attachment_109460\" align=\"aligncenter\" width=\"876\"] Figure 1. Vatet execution flow.[\/caption]\r\n\r\nLet\u2019s take a deeper look at Vatet using a malicious version of Rainmeter.\r\nInner Workings of the Vatet Loader: A Rainmeter Review\r\nRainmeter is a desktop customization tool that allows users to customize their desktops through the use of \u201cskins.\u201d During a legitimate installation, Rainmeter creates an executable, rainmeter.exe, and a corresponding DLL, rainmeter.dll. Under normal conditions, rainmeter.dll is responsible for reading configuration files and facilitating a customized desktop. Under the observed circumstances, a signed, legitimate version of rainmeter.exe and a malicious version of rainmeter.dll could be simply copied onto the victim system, then used to load and execute a Cobalt Strike beacon in memory under the context of a signed, legitimate executable.\r\nTaking a Look at the Static Properties\r\nWe first reviewed the suspicious rainmeter.exe and rainmeter.dll files and compared them to versions that would be installed on a system through the official September 2019 release of the Rainmeter installer, which can be found on its public GitHub page.\r\n\r\nReviewing rainmeter.exe did not produce many interesting findings. Examining both executables in PEStudio confirmed that the sample recovered during a ransomware scenario was the same executable generated by the standard Rainmeter installer, based on the SHA256 hash. We also verified that both executables had the same valid digital signature.\r\n\r\n[caption id=\"attachment_109462\" align=\"aligncenter\" width=\"900\"] Figure 2. Initial comparison of static properties of \u201crainmeter.exe\u201d.[\/caption]\r\n\r\nComparing the rainmeter.dll samples provided more interesting findings. Initially, it was obvious that the two samples were not the same, since the hashes did not line up. The sizes of the files were significantly different from one another and the compile dates were also quite different. Additionally, there was some variability in the imports, exports, strings and other properties. Further, the suspected malicious DLL was not digitally signed and had additional sections not present in the legitimate Rainmeter DLL.\r\n\r\n[caption id=\"attachment_109464\" align=\"aligncenter\" width=\"900\"] Figure 3. Comparing the two versions of \u201crainmeter.dll\u201d.[\/caption]\r\n\r\n[caption id=\"attachment_109466\" align=\"aligncenter\" width=\"900\"] Figure 4. Comparing sections between \u201crainmeter.dll\u201d samples.[\/caption]\r\n\r\nIt is important to note that the code base for Rainmeter is publicly available on GitHub under the GNU General Public License v2.0. This would have allowed the threat actor to openly review\/modify the existing rainmeter.dll file contents and compile it into the suspected malicious DLL we saw during our investigation.\r\n\r\nAfter completing these comparisons to confirm that the Rainmeter DLL was likely malicious, it was time for a deeper and more focused look at the samples using a debugger for dynamic analysis.\r\nDynamic Analysis of the Malicious Rainmeter Sample\r\nNow that we had identified samples for deeper inspection, we stopped the comparisons to the legitimate Rainmeter application and focused on the analysis of the suspicious samples recovered. We placed the samples of rainmeter.exe and rainmeter.dll recovered from the investigation into our analysis environment and began debugging Rainmeter. Shortly after starting analysis, rainmeter.exe loaded rainmeter.dll as expected, and subsequently called its ordinal 1 exported function. Continuing the execution, there were calls to CreateFileA, where the sample was looking for the hardcoded path C:\\Windows\\help\\options.dat.\r\n\r\n[caption id=\"attachment_109468\" align=\"aligncenter\" width=\"900\"] Figure 5. Call to \u201cCreateFileA\u201d for a hardcoded path.[\/caption]\r\n\r\nAfter the call to CreateFileA, there is a comparison of the result of the call to CreateFileA to FFFFFFFF to determine if it has a valid handle to the file or not. If there is no valid handle, the program exits.\r\n\r\nOriginally it was not obvious that options.dat was necessary for the analysis of the malicious Rainmeter sample as .dat files are not part of the normal Rainmeter application. However, a version of options.dat was recovered in order to continue analysis. Once the \u201cdat\u201d file was placed in the expected location, the program then allocated space on the heap and read the contents of options.dat into memory. After the contents of options.dat were read into memory, the sample performed a first-level decoding of the contents by XOR-ing the contents with the value FE.\r\n\r\n[caption id=\"attachment_109470\" align=\"aligncenter\" width=\"900\"] Figure 6. Initial XOR decoding loop.[\/caption]\r\n\r\nOnce the first decoding routine is completed, the malicious Rainmeter application closes the handle to options.dat. When the program closes the handle to options.dat, it is removed from the file system. This is a built-in anti-analysis technique employed to hinder recovery of the .dat file for analysis. At this point, the data read into the program was still a blob of unrecognizable code. However, at the end of the XOR decoding routine, there is a CALL EBX instruction that transfers execution to the recently decoded data. Following EBX in the disassembled view shows that this is valid code. At this stage of analysis, Rainmeter has decoded its options.dat payload, loaded it into memory and executed it. Future analysis confirmed that this was the end of the Vatet loader routine, and execution was passed to the Cobalt Strike shellcode loader.\r\n\r\n[caption id=\"attachment_109472\" align=\"aligncenter\" width=\"900\"] Figure 7. Transfer of execution to valid code after XOR decoding.[\/caption]\r\n\r\nBy this point, we realized that the Vatet loading mechanism was completed, but we wanted to validate the identity of the final payload, so we pressed on. Further along in the execution, there is a second decoding routine where an additional dynamic XOR loop is used to decode and rewrite the contents of the executable code. If this routine looks familiar, it\u2019s probably because you are noticing the Cobalt Strike decoding mechanism. This routine begins by obtaining a pointer to the first four bytes of the imported executable code and setting it as the starting XOR key. The code then executes a loop acting on four bytes at a time, XORing the imported code with the starting XOR key. Next, the loop writes the XOR\u2019d value back into the data segment, followed by setting a new XOR key. The new XOR key is determined by XOR\u2019ing the current XOR key with the value decoded by the current key. Once this loop is finished, the sample then uses JMP ECX to transfer execution to the recently decoded executable contents.\r\n\r\n[caption id=\"attachment_109474\" align=\"aligncenter\" width=\"830\"] Figure 8. Entering into the second decoding loop. Note the memory space in Dump 1.[\/caption]\r\n\r\n[caption id=\"attachment_109476\" align=\"aligncenter\" width=\"900\"] Figure 9. After the completion of the second decoding routine, note the executable contents now decoded in Dump 2.[\/caption]\r\n\r\nAt this stage of analysis, we confirmed the content included in options.dat was shellcode that was later decoded via a dynamic XOR routine to create executable code in Rainmeter\u2019s process memory.\r\n\r\nNow that we had the executable contents of the XOR\u2019d executable code from options.dat available in memory, we dumped the contents from the memory map section in x64bdg for additional analysis to determine this code\u2019s potential functionality.\r\n\r\nMoving to our dumped sample of the executable code, we conducted an analysis of the strings to determine if there was anything obvious to correlate dynamic analysis findings. In doing this, we identified a reference to beacon.dll, which is most often associated with the DLL version of Cobalt Strike\u2019s beacon. Additionally, loading the isolated PE into PeStudio showed the following references to an exported function _ReflectiveLoader@4, which is a known exported function of Cobalt Strike.\r\n\r\n[caption id=\"attachment_109478\" align=\"aligncenter\" width=\"900\"] Figure 10. Extracted PE analysis in PeStudio.[\/caption]\r\n\r\nTo confirm whether the extracted payload was a Cobalt Strike beacon or not, we utilized a Cobalt Strike beacon parser, which dumped the beacon\u2019s decoded configuration.\r\n\r\n[caption id=\"attachment_109480\" align=\"aligncenter\" width=\"900\"] Figure 11. Cobalt Strike beacon configuration.[\/caption]\r\n\r\nThe confirmed Cobalt Strike beacon shows a typical implementation of Cobalt Strike\u2019s HTTPS beacon using malleable C2 profiles. Specifically, the Amazon browsing traffic profile created by harmjoy was used in this beacon.\r\n\r\nContinue reading: Next Up: \"PyXie Lite\"\r\n\r\n\r\n\r\nNext Up: \u201cPyXie Lite\u201d\r\nAn earlier version of PyXie was previously covered in-depth by BlackBerry Cylance in December 2019. We will be primarily covering an updated variant and some notable changes we have observed.\r\n\r\nSome of these changes include:\r\n\r\n \tHardened interpreter.\r\n \tNew remapped opcode table.\r\n \tRepurposed as a data theft and reconnaissance tool.\r\n \tExfiltration through internal servers.\r\n\r\nWe call this variant PyXie Lite because of the significantly smaller code base, but don\u2019t let the name fool you. It still packs a punch.\r\nLoader\r\nThe recent variant we analyzed was loaded by Vatet rather than the Goopdate.dll and LMIGuardianDll.dll side loaders seen with earlier versions of PyXie.\r\n\r\nThe decrypted Vatet payload contains the first stage of PyXie prepended by a shellcode loader responsible for mapping the first stage into memory and executing it.\r\n\r\nThe shellcode loader utilizes MurmurHash3 hashing to locate APIs needed during this process at runtime.\r\n\r\n\r\n\r\nDLL\r\nFunction\r\nAPI Hash\r\n\r\n\r\nKernel32.dll\r\nGetProcAddress\r\n0x261C88ED\r\n\r\n\r\nKernel32.dll\r\nVirtualAlloc\r\n0xC17E7EB2\r\n\r\n\r\nKernel32.dll\r\nLoadLibraryExA\r\n0x4B9B30B9\r\n\r\n\r\n\r\nTable 2. MurmurHash3 API hashes.\r\n\r\nStage 1\r\nThe purpose of the first stage is to decrypt the second stage payload and execute it in memory.\r\nMutex\r\nA mutex is created to prevent multiple instances from running at the same time. The following logic is used:\r\n\r\n \tRetrieve computer name with a call to GetComputerNameA. If that fails, fall back to DEFAULTCOMPNAME.\r\n \tCompute MD5 Hash of the computer name.\r\n \tXOR computed hash with 0x2.\r\n \tConvert the result to a string with StringFromGUID2.\r\n \tCreate mutex using the string with a call to CreateMutexW.\r\n\r\nString encryption\r\nSignificant strings are encrypted by a routine that increments each byte of the ciphertext by its index, masks the result with 0x7F (highest value in the ASCII character set) and XORs it against a key of equal length.\r\n\r\n\r\nTable 3. String decryption example.\r\n\r\nDecrypted Strings\r\n\r\n\r\n\r\nuiAccess=true\"\r\n\r\n-q -s {%S} -p %u\r\n\r\nwerfault.exe\r\n\r\nvsjitdebugger.exe\r\n\r\ndvdplay.exe\r\n\r\nonedrivesetup.exe\r\n\r\nopenwith.exe\r\n\r\n%windir%\\syswow64\\\r\n\r\n%windir%\\system32\\\r\n\r\nkernel32.dll\r\n\r\nKiUserExceptionDispatcher\r\n\r\nRtlCreateUser\r\n\r\nIsWow64Process\r\n\r\n\\StringFileInfo\\%04x%04x\\ProductName\r\n\r\n\r\n\r\nTable 4. Decrypted first stage strings.\r\n\r\nPayload Decryption\r\nThe next stage payload is stored in an encrypted 7z archive located in the .gfids section of the binary. It is decrypted with the modified RC4 algorithm previously discussed in the BlackBerry Cylance write-up using the hard-coded key: 2C01443389BDFC7330A3386981C43E154AE8B60EC6646D916F93D18137A53544\r\n\r\n[caption id=\"attachment_109482\" align=\"aligncenter\" width=\"617\"] Figure 12. Decrypted 7z archive.[\/caption]\r\nPayload Execution\r\nOpenProcessToken and GetTokenInformation are called to determine if the process is running under the LocalSystem account. This is used to determine how the next stage payload is executed.\r\n\r\nIf it is determined to be running as LocalSystem, the payload is injected into a newly spawned process chosen from the Windows directory. The command line for this process follows this format and can be used as an indicator:\r\n-q -s {{GUID}} -p NUMBER\r\n\r\n[caption id=\"attachment_109484\" align=\"aligncenter\" width=\"900\"] Figure 13. Command line argument.[\/caption]\r\n\r\nIf not found to be running as LocalSystem, the payload will execute in the memory space of the current process.\r\nStage 2\r\nThe second stage payload is a custom-compiled Python interpreter very similar to ones seen used with earlier variants of PyXie.\r\nConfiguration\r\nThe configuration is stored in a zlib compressed json blob and is located in the .gfids section of the interpreter. Unlike previous versions of PyXie, it is not encrypted this time around. The variable sys.builtin_json_cfg is created with a call to PySys_SetObject and the compressed configuration blob is stored in it for later use by the final stage Python component.\r\n\r\n[caption id=\"attachment_109486\" align=\"aligncenter\" width=\"859\"] Figure 14. sys.builtin_json_cfg variable is created.[\/caption]\r\nDecrypted Strings\r\nThe second stage uses the same string encryption that was noted in the previous stage.\r\n\r\n\r\n\r\nkernel32.dll\r\n\r\nopenwith.exe\r\n\r\nonedrivesetup.exe\r\n\r\ndvdplay.exe\r\n\r\nvsjitdebugger.exe\r\n\r\nwerfault.exe\r\n\r\n-q -s {%S} -p %u\r\n\r\noleout32.dll\r\n\r\nVariantClear\r\n\r\nMozilla\\Firefox\r\n\r\nMozilla\\Firefox\\profiles.ini\r\n\r\nSOFTWARE\\Clients\\StartMenuInternet\\firefox.exe\\shell\\open\\command\r\n\r\nI_CryptUIProtect\r\n\r\ncryptui.dll\r\n\r\nRtlCreateUserThread\r\n\r\nimport core.modules.winapi_stubs as winapi_stubs\r\n\r\nimport core.zip_logs as zip_logs\r\n\r\nimport os\r\n\r\nzip_logs.send_zip_log(winapi_stubs.get_self_executable_path(), os.getpid(), 'CERTS', r'%s')\r\n\r\nKiUserExceptionDispatcher\r\n\r\nuiAccess=\"true\"\r\n\r\n\\StringFileInfo\\%04x%04x\\ProductName\r\n\r\n\\VarFileInfo\\Translation\r\n\r\n\\\\?\\globalroot\\systemroot\\system32\\drivers\\null.sys\r\n\r\nSystemDrive\r\n\r\nIsWow64Process\r\n\r\ncore.entry_point\r\n\r\nzipimporter\r\n\r\nmemzipimport\r\n\r\nlibs_zip_ctx\r\n\r\nstart_bind_port\r\n\r\n\r\n\r\nTable 5. Decrypted second stage strings.\r\n\r\nFinal Stage: Libs.zip\r\nThe final stage of PyXie bytecode is contained in an encrypted ZIP file embedded within the interpreter binary. As with the earlier version of PyXie, the memzipimport library is used to import the bytecode from memory.\r\n\r\nPyXie Lite\r\nThe \u201ccore\u201d modules in this variant consist of 41 files versus the 79 seen in the previous version of PyXie analyzed by BlackBerry Cylance. The discrepancy is due to a shift in functionality that we will cover in the next section.\r\n\r\n[caption id=\"attachment_109488\" align=\"aligncenter\" width=\"899\"] Figure 15. Bytecode listing.[\/caption]\r\n\r\nInterpreter hardening\r\nCursory analysis of the bytecode revealed that the headers had been stripped as with previous earlier versions of PyXie. Additionally, we found that the opcode table had once again been modified and the opcodes recovered from previous versions of PyXie could no longer be used to decompile this bytecode.\r\n\r\n[caption id=\"attachment_109490\" align=\"aligncenter\" width=\"847\"] Figure 16. Attempts to decompile bytecode with previously recovered PyXie opcodes resulted in an error.[\/caption]\r\n\r\nKnowing this, we attempted to force the interpreter to import DeDrop's all.py with hopes of generating bytecode that could be used for opcode recovery. To our dismay, we found that simply importing a script would no longer cause the interpreter to output bytecode.\r\n\r\nA closer look at the interpreter found that the sys.dont_write_bytecode variable had been set to true. This has the effect of preventing bytecode from being written to disk when modules are imported. Likely, this is something the developers intentionally enabled to hinder analysis efforts.\r\n\r\n[caption id=\"attachment_109492\" align=\"aligncenter\" width=\"900\"] Figure 17. sys.dont_write_bytecode is set to True.[\/caption]\r\nHijacking the interpreter with a search order vulnerability\r\nDuring our analysis of the interpreter, we found that it attempted to load a number of modules from the current working directory and was vulnerable to search order hijacking.\r\n\r\n[caption id=\"attachment_109494\" align=\"aligncenter\" width=\"900\"] Figure 18. PyXie attempting to load libraries from the current working directory.[\/caption]\r\n\r\nWe were able use this to our advantage by dropping a simple Python shell into one of the modules it attempted to import. This gave us unfettered access to the interpreter, which enabled us to overwrite the sys.dont_write_bytecode variable, generate opcodes for modules on demand and even dump PyXie\u2019s configuration.\r\n\r\n[caption id=\"attachment_109496\" align=\"aligncenter\" width=\"900\"] Figure 19. Search order vulnerability being used to gain control of the interpreter.[\/caption]\r\n\r\nOnce we were able to output bytecode for modules of our choosing, it was trivial to recover the remapped opcodes and decompile PyXie. A copy of the opcodes for this variant can be found in the appendix.\r\nFunctionality\r\nAs we previously mentioned, PyXie Lite has been repurposed to focus on the automated collection and exfiltration of data.\r\n\r\nUpon execution, it creates a staging directory whose name is based on the output of the tempfile.NamedTemporaryFile() command.\r\n\r\n\r\n\r\n%temp%\\tmp1rjvhglo\r\n\r\n\r\n\r\nTable 6. Example staging directory name.\r\nNext, it collects data from the system by running a combination of routines that are dictated by the user account PyXie is found to be running under. Table 7 breaks down each of these routines and the types of account they will run under.\r\n\r\n\r\n\r\nRoutine\r\nUser type\r\nDescription\r\n\r\n\r\n_mimi_redirector\r\nAll\r\nRuns Mimikatz in memory. Injects into a newly spawned process from this list: write.exe, notepad.exe, explorer.exe\r\n\r\n\r\n_main_routine\r\nAll\r\n\r\n\r\n \tCollects basic details about the system\r\n \tInventories software\r\n \tCollects cookies\r\n \tCollects LogMeIn data\r\n \tCollects Citrix data\r\n \tCollects KeePass safes\r\n\r\n\r\n\r\n\r\n_save_sysinfo\r\nAll\r\nCollects uninstall list from registry\r\n\r\n\r\n_get_passwords\r\nAll\r\nCollects passwords with Lazagne\r\n\r\n\r\n_find_files\r\nSystem\r\nSearches for and collects files and directories based on keywords, directories and extensions specified in the configuration\r\n\r\n\r\n_scan_network\r\nSystem\r\nRuns network scans\r\n\r\n\r\n_run_shell_cmds\r\nSystem\r\nRuns a series of commands to gather details about the system\r\n\r\n\r\n_get_desktop_files\r\nUser\r\nSimilar to find_files but only searches the current user\u2019s Desktop\r\n\r\n\r\n_take_screenshot\r\nUser\r\nTakes a screenshot\r\n\r\n\r\n_get_ps_history\r\nUser\r\nCollects Powershell history\r\n\r\n\r\n\r\nTable 7. PyXie routines.\r\nThe list of keywords and directories from configuration provides us some insight into the type of data the attackers are interested in:\r\n\r\n\r\n\r\npassw\r\nlogins\r\nwallet\r\nprivate\r\n\r\n\r\nconfidential\r\nusername\r\nwire\r\naccess\r\n\r\n\r\ntreason\r\nvault\r\noperation\r\nbribery\r\n\r\n\r\ncontraband\r\ncensored\r\ninstruction\r\ncredent\r\n\r\n\r\ncardholder\r\nsecret\r\nexplosive\r\nsuspect\r\n\r\n\r\npersonal\r\ncyber\r\nrestricted\r\nbalance\r\n\r\n\r\npassport\r\nvictim\r\nsubmarine\r\nchecking\r\n\r\n\r\nsaving\r\nrouting\r\nesxi\r\nvsphere\r\n\r\n\r\nspy\r\nadmin\r\nnewswire\r\nbitcoin\r\n\r\n\r\nethereum\r\nn-csr\r\n10-sb\r\n10-q\r\n\r\n\r\nconvict\r\ntactical\r\nengeneering\r\nmilitary\r\n\r\n\r\ndisclosure\r\nattack\r\ninfrastruct\r\nmarketwired\r\n\r\n\r\nagreement\r\nillegal\r\nnda\r\nhidden\r\n\r\n\r\nprivacy\r\nfraud\r\nstatement\r\nfinance\r\n\r\n\r\nmarketwired\r\nclandestine\r\ncompromate\r\nconcealed\r\n\r\n\r\ninvestigation\r\nsecurity\r\n\r\n\r\n\r\n\r\n\r\nTable 8. Keywords from PyXie Lite configuration (including misspellings).\r\nAs part of the data gathering routines, a number of commands are executed to collect details about the system.\r\n\r\n\r\n\r\nnetstat -an\r\n\r\nnet user\r\n\r\nnet use\r\n\r\nnet view \/all\r\n\r\nnet view \/all \/domain\r\n\r\nnet share\r\n\r\nnet config workstation\r\n\r\nnet group \"Domain Admins\"\r\n\r\nnet group \"Enterprise Admins\"\r\n\r\nroute print\r\n\r\nnet localgroup\r\n\r\nipconfig \/all\r\n\r\ntasklist \/V\r\n\r\nwmic process\r\n\r\narp -a\r\n\r\ngpresult \/z\r\n\r\ncmdkey \/list\r\n\r\nnet config workstation\r\n\r\nnslookup -type=any %userdnsdomain%\r\n\r\nvssadmin List Shadows\r\n\r\nwmic qfe list\r\n\r\nklist\r\n\r\nmanage-bde -status\r\n\r\nnltest \/domain_trusts\r\n\r\nnltest \/domain_trusts \/all_trusts\r\n\r\nqwinsta\r\n\r\nipconfig \/displaydns\r\n\r\nsysteminfo\r\n\r\ndclist\r\n\r\nnet group \"domain admins\" \/domain\r\n\r\nnet localgroup \"administrators\"\r\n\r\nwmic path win32_VideoController get name\r\n\r\nwmic cpu get name\r\n\r\nreg.exe save hklm\\security %LOCALAPPDATA%\\temp\\[RANDOM]\r\n\r\nreg.exe save hklm\\system %LOCALAPPDATA%\\temp\\[RANDOM]\r\n\r\nreg.exe save hklm\\sam %LOCALAPPDATA%\\temp\\[RANDOM]\r\n\r\n\r\n\r\nTable 9. Executed commands.\r\n\r\n\r\n[caption id=\"attachment_109498\" align=\"aligncenter\" width=\"900\"] Figure 20. Data collected from the routines in a staging directory prior to exfil.[\/caption]\r\nExfiltration\r\nThe staging directory containing the collected data is added to a compressed ZIP archive and encrypted before being sent to the server specified in the gates section of the config. The archive is encrypted with AES in CBC mode and THIS_KEY_IS_FOR_INTERNAL_USE_ONLY is used as the key. A random 16-byte initialization vector (IV) is used and is prepended to the encrypted archive. The exfil servers we have seen in samples to date have typically been compromised internal servers on the victim\u2019s networks listening on ports 31337, 900 and 8443. Although we did not have visibility into how the attackers moved data off the victim network, in at least one incident the exfil server was running Cobalt Strike.\r\n\r\nContinue reading: Last, but Not Least: Defray777\r\n\r\n\r\nLast, but Not Least: Defray777\r\nDefray777 is an elusive family of ransomware also known as Ransom X and RansomExx. Although it has recently been covered in the news as a new family, it has been in use since at least 2018 and is responsible for a number of high-profile ransomware incidents -- as detailed in the articles we linked to.\r\n\r\nDefray777 runs entirely in memory, which is why there have been so few publicly discussed samples to date. In several recent incidents, Defray777 was loaded into memory and executed by Cobalt Strike, which was delivered by the Vatet loader.\r\n\r\nDuring our research, we discovered multiple decryptors for this ransomware family, going back as early as 2018. Reviewing decryptors from 2018 until present shows that there has been consistency in the ransomware\u2019s encryption and decryption methodology, as well as the use of Themida for packing their decryptors. Table 10 shows a list of Defray777 decryptors discovered in AutoFocus, with a list of organizations that suffered ransomware attacks. This shows that Defray777 has been consistently active since 2018.\r\n\r\n\r\n\r\nDate\r\nVictim \r\n\r\n\r\n12\/7\/2018\r\nEducation Organization\r\n\r\n\r\n2\/4\/2019\r\nHealthcare Organization\r\n\r\n\r\n3\/1\/2019\r\nTechnology Organization\r\n\r\n\r\n3\/15\/2019\r\nEducation Organization\r\n\r\n\r\n8\/8\/2019\r\nHealthcare Organization\r\n\r\n\r\n8\/25\/2019\r\nEducation Organization\r\n\r\n\r\n8\/28\/2019\r\nTransportation and Logistics Organization\r\n\r\n\r\n9\/3\/2019\r\nLegal Organization\r\n\r\n\r\n9\/6\/2019\r\nEducation Organization\r\n\r\n\r\n9\/26\/2019\r\nHealthcare Organization\r\n\r\n\r\n10\/30\/2019\r\nGovernment Organization\r\n\r\n\r\n11\/1\/2019\r\nHealthcare Organization\r\n\r\n\r\n2\/4\/2020\r\nTechnology Organization\r\n\r\n\r\n2\/10\/2020\r\nGovernment Organization\r\n\r\n\r\n3\/16\/2020\r\nFood Organization\r\n\r\n\r\n10\/17\/2020\r\nFinance Organization\r\n\r\n\r\n\r\nTable 10. Defray777 ransomware attacks listed by date and victim.\r\n\r\n\r\n[caption id=\"attachment_109500\" align=\"aligncenter\" width=\"900\"] Figure 21. Defray777 decryptor.[\/caption]\r\n\r\nWe have examined several recent Defray777 samples, including one sample that was obtained directly from memory during a recent incident. Our in-depth analysis resulted in the findings outlined below.\r\nDecrypted Strings\r\nThe string decryption process is the same as we saw with PyXie. The following strings were decrypted from a recent Defray777 sample:\r\n\r\n\r\n\r\nAlready active [%s]\r\n\r\n+%u (%u) files done [%s] [%u KB\/s]\r\n\r\nStarted (PID: %u; Workers: %u; AES-%s) [%s]\r\n\r\nComplete (+%u (%u) files done) [%s]\r\n\r\nWork time: %d:%02d:%02d\r\n\r\nUnable to get computer name\r\n\r\nCryptoGuard\r\n\r\nkernel32.dll\r\n\r\nConvertStringSecurityDescriptorToSecurityDescriptorW\r\n\r\nadvapi32.dll\r\n\r\nIsWow64Process\r\n\r\nSystemDrive\r\n\r\nKiUserExceptionDispatcher\r\n\r\n\r\n\r\nTable 11. Defray777 encrypted strings.\r\n\r\nPrioritizing Defray777 on the Impacted System \r\nWhile deep diving on a recovered Defray777 sample, we found that Defray777 exhibits the following notable characteristics regarding the prioritization of threads and processes:\r\n\r\n \tDuring execution, the ransomware uses SetProcessPriorityBoost to prioritize the threads of the Defray777 process.\r\n \tDefray777 additionally focuses on creating and prioritizing threads for encryption by calling SetThreadAffinityMask and SetThreadPriorityBoost.\r\n \tDefray777 uses multithreading to improve ransomware performance.\r\n\r\n[caption id=\"attachment_109502\" align=\"aligncenter\" width=\"826\"] Figure 22. Prioritization of Defray777 threads during execution.[\/caption]\r\nKilling \u201cUndesirable\u201d Processes \r\nAs part of the execution workflow, Defray777 creates threads that will be responsible for the killing of processes that the threat actors deem to be \u201cundesirable.\u201d The execution continues by getting a listing of processes using CreateToolhelp32Snapshot before iterating through all active processes (with the exception of itself) and killing all \u201cundesirable\u201d processes. Defray777 specifically targets process that can be opened with the desired access of SYNCHRONIZE | PROCESS_QUERY_INFORMATION | PROCESS_VM_WRITE | PROCESS_VM_READ | PROCESS_VM_OPERATION | PROCESS_CREATE_THREAD.\r\n\r\nDefray777 excludes all processes that contain the system file path in their full image path. Additionally, the ransomware will exclude the following processes from being killed during execution:\r\n\r\n\r\n\r\npowershell.exe\r\nrundll32.exe\r\n\r\n\r\nwefault.exe\r\nexplorer.exe\r\n\r\n\r\nvmnat.exe\r\n\r\n\r\n\r\n\r\nTable 12. Excluded processes.\r\n\r\nStopping System Services\r\nDuring execution, Defray777 stops the following services from running:\r\n\r\n\r\n\r\nAcronis VSS Provider\r\nMSExchangeADTopology\r\nMSSQLSERVER\r\nSQLAgent$PRACTTICEMGT\r\n\r\n\r\nAcronisAgent\r\nMSExchangeAntispamUpdate\r\nMSSQLServerADHelper\r\nSQLAgent$PROD\r\n\r\n\r\nAcronixAgent\r\nMSExchangeEdgeSync\r\nMSSQLServerADHelper100\r\nSQLAgent$PROFXENGAGEMENT\r\n\r\n\r\nAcrSch2Svc\r\nMSExchangeES\r\nMSSQLServerOLAPService\r\nSQLAgent$SBSMONITORING\r\n\r\n\r\nAntivirus\r\nMSExchangeFBA\r\nMySQL57\r\nSQLAgent$SHAREPOINT\r\n\r\n\r\nARSM\r\nMSExchangeFDS\r\nMySQL80\r\nSQLAgent$SOPHOS\r\n\r\n\r\nAVP\r\nMSExchangeIS\r\nNetMsmqActivator\r\nSQLAgent$SQL_2008\r\n\r\n\r\nBackupExecAgentAccelerator\r\nMSExchangeMailboxAssistants\r\nnginx\r\nSQLAgent$SQLEXPRESS\r\n\r\n\r\nBackupExecAgentBrowser\r\nMSExchangeMailboxReplication\r\nntrtscan\r\nSQLAgent$SYSTEM_BGC\r\n\r\n\r\nBackupExecDeviceMediaService\r\nMSExchangeMailSubmission\r\nOracleClientCache80\r\nSQLAgent$TPS\r\n\r\n\r\nBackupExecJobEngine\r\nMSExchangeMGMT\r\nOracleServiceXE\r\nSQLAgent$TPSAMA\r\n\r\n\r\nBackupExecManagementService\r\nMSExchangeMTA\r\nOracleXETNSListener\r\nSQLAgent$VEEAMSQL2008R2\r\n\r\n\r\nBackupExecRPCService\r\nMSExchangeProtectedServiceHost\r\nPDVFSService\r\nSQLAgent$VEEAMSQL2012\r\n\r\n\r\nBackupExecVSSProvider\r\nMSExchangeRepl\r\nPOP3Svc\r\nSQLBrowser\r\n\r\n\r\nbedbg\r\nMSExchangeRPC\r\nReportServer\r\nSQLsafe Backup Service\r\n\r\n\r\nDbxSvc\r\nMSExchangeSA\r\nReportServer$SQL_2008\r\nSQLsafe Filter Service\r\n\r\n\r\nDCAgent\r\nMSExchangeSearch\r\nReportServer$SYSTEM_BGC\r\nSQLSafeOLRService\r\n\r\n\r\nEhttpSrv\r\nMSExchangeServiceHost\r\nReportServer$TPS\r\nSQLSERVERAGENT\r\n\r\n\r\nekrn\r\nMSExchangeSRS\r\nReportServer$TPSAMA\r\nSQLTELEMETRY\r\n\r\n\r\nEnterprise Client Service\r\nMSExchangeThrottling\r\nRESvc\r\nSQLTELEMETRY$ECWDB2\r\n\r\n\r\nEPSecurityService\r\nMSExchangeTransport\r\nsacsvr\r\nSQLWriter\r\n\r\n\r\nEPUpdateService\r\nMSExchangeTransportLogSearch\r\nSamSs\r\nSstpSvc\r\n\r\n\r\nEraserSvc11710\r\nmsftesql$PROD\r\nSAVAdminService\r\nsvcGenericHost\r\n\r\n\r\nEsgShKernel\r\nMSOLAP$SQL_2008\r\nSAVService\r\nswi_filter\r\n\r\n\r\nESHASRV\r\nMSOLAP$SYSTEM_BGC\r\nSDRSVC\r\nswi_service\r\n\r\n\r\nFA_Scheduler\r\nMSOLAP$TPS\r\nSepMasterService\r\nswi_update\r\n\r\n\r\nIISAdmin\r\nMSOLAP$TPSAMA\r\nShMonitor\r\nswi_update_64\r\n\r\n\r\nIMAP4Svc\r\nMSSQL$BKUPEXEC\r\nSmcinst\r\nSymantec System Recovery\r\n\r\n\r\nKAVFS\r\nMSSQL$ECWDB2\r\nSmcService\r\nTmCCSF\r\n\r\n\r\nKAVFSGT\r\nMSSQL$PRACTICEMGT\r\nSMTPSvc\r\ntmlisten\r\n\r\n\r\nkavfsslp\r\nMSSQL$PRACTTICEBGC\r\nSNAC\r\nTrueKey\r\n\r\n\r\nklnagent\r\nMSSQL$PROD\r\nSntpService\r\nTrueKeyScheduler\r\n\r\n\r\nmacmnsvc\r\nMSSQL$PROFXENGAGEMENT\r\nSophos Agent\r\nTrueKeyServiceHelper\r\n\r\n\r\nmasvc\r\nMSSQL$SBSMONITORING\r\nSophos AutoUpdate Service\r\nUI0Detect\r\n\r\n\r\nMBAMService\r\nMSSQL$SHAREPOINT\r\nSophos Clean Service\r\nVeeam Backup Catalog Data Service\r\n\r\n\r\nMBEndpointAgent\r\nMSSQL$SOPHOS\r\nSophos Device Control Service\r\nVeeamBackupSvc\r\n\r\n\r\nMcAfeeEngineService\r\nMSSQL$SQL_2008\r\nSophos File Scanner Service\r\nVeeamBrokerSvc\r\n\r\n\r\nMcAfeeFramework\r\nMSSQL$SQLEXPRESS\r\nSophos Health Service\r\nVeeamCatalogSvc\r\n\r\n\r\nMcAfeeFrameworkMcAfeeFramework\r\nMSSQL$SYSTEM_BGC\r\nSophos MCS Agent\r\nVeeamCloudSvc\r\n\r\n\r\nMcShield\r\nMSSQL$TPS\r\nSophos MCS Client\r\nVeeamDeploymentService\r\n\r\n\r\nMcTaskManager\r\nMSSQL$TPSAMA\r\nSophos Message Router\r\nVeeamDeploySvc\r\n\r\n\r\nmfefire\r\nMSSQL$VEEAMSQL2008R2\r\nSophos Safestore Service\r\nVeeamEnterpriseManagerSvc\r\n\r\n\r\nmfemms\r\nMSSQL$VEEAMSQL2012\r\nSophos System Protection Service\r\nVeeamHvIntegrationSvc\r\n\r\n\r\nmfevtp\r\nMSSQLFDLauncher\r\nSophos Web Control Service\r\nVeeamMountSvc\r\n\r\n\r\nMMS\r\nMSSQLFDLauncher$PROFXENGAGEMENT\r\nsophossps\r\nVeeamNFSSvc\r\n\r\n\r\nMongoDB\r\nMSSQLFDLauncher$SBSMONITORING\r\nSQL Backups\r\nVeeamRESTSvc\r\n\r\n\r\nmozyprobackup\r\nMSSQLFDLauncher$SHAREPOINT\r\nSQLAgent$BKUPEXEC\r\nVeeamTransportSvc\r\n\r\n\r\nMsDtsServer\r\nMSSQLFDLauncher$SQL_2008\r\nSQLAgent$CITRIX_METAFRAME\r\nW3Svc\r\n\r\n\r\nMsDtsServer100\r\nMSSQLFDLauncher$SYSTEM_BGC\r\nSQLAgent$CXDB\r\nwbengine\r\n\r\n\r\nMsDtsServer110\r\nMSSQLFDLauncher$TPS\r\nSQLAgent$ECWDB2\r\nWRSVC\r\n\r\n\r\nMSExchangeAB\r\nMSSQLFDLauncher$TPSAMA\r\nSQLAgent$PRACTTICEBGC\r\nZoolz 2 Service\r\n\r\n\r\n\r\nTable 13. Services stopped by Defray777.\r\n\r\nFile Encryption\r\nBased on a recent Defray777 sample recovered from memory, the ransomware will get a listing of all logical drives on the system using a call to GetLogicalDriveStringsW before iterating through each drive to encrypt files using the following process:\r\n\r\n \tTo begin, Defray777 checks for whether the processor feature PF_XMMI64_INSTRUCTIONS_AVAILABLE is present on the impacted system.\r\n\r\n \tIf enabled, Defray777 knows that SSE2 is supported and more complex mathematical operations are possible.\r\n\r\n\r\n \tDefray777 will also determine if the processor is capable of using AES-NI for improved encryption performance.\r\n \tAs encryption begins, a ransom note will be created in each directory where files will be encrypted.\r\n\r\n \tThe name of the ransom note will vary. However, from our research, the ransom notes most commonly contain a combination of exclamation points, the string \u201cREADME,\u201d and a reference to the victim name.\r\n \tExample: !!!_IMPACTED_Client_README_!!!.txt\r\n\r\n\r\n \tThe file contents will be encrypted using an on-the-fly generated AES key that gets encrypted with RSA-4096 and stored in the file footer in a 512-byte block.\r\n \tThe encrypted file will be renamed by appending an extension that consists of a unique victim identifier and a randomized eight-digit hexadecimal number.\r\n\r\n \tExample: .v1ct1m-1bc461ac\r\n\r\n\r\n\r\n[caption id=\"attachment_109504\" align=\"aligncenter\" width=\"743\"] Figure 23. Recent example of a Defray777 ransom note.[\/caption]\r\n\r\nSpecifically, the encryption mechanism consists of the following steps:\r\n\r\n \tDynamically generate a 32-byte AES key.\r\n \tEncrypt the file with AES-256 in ECB mode using 16-byte blocks.\r\n \tEncrypt the AES key with RSA-4096 and append the 0x200 byte cipher text to the end of the encrypted file.\r\n\r\nEncryption Exclusions\r\nDuring the encryption process, Defray777 aims to encrypt as many files as possible without impacting the system\u2019s core functionality. To accomplish this, Defray777 uses a set of excluded folders, files and file extensions that will not be encrypted during execution.\r\n\r\nExcluded Folders:\r\n\r\n\r\n\r\n\\windows\\system32\\\r\n\\windows\\syswow64\\\r\n\\windows\\system\\\r\n\r\n\r\n\\windows\\winsxs\\\r\n\\appdata\\roaming\\\r\n\\appdata\\local\\\r\n\r\n\r\n\\appdata\\locallow\\\r\n\\all users\\microsoft\\\r\n\\inetpub\\logs\\\r\n\r\n\r\n:\\boot\\\r\n:\\perflogs\\\r\n:\\programdata\\\r\n\r\n\r\n:\\drivers\\\r\n:\\wsus\\\r\n:\\efstmpwp\\\r\n\r\n\r\n:\\$recycle.bin\\\r\n:\\EFSTMPWP\\\r\ncrypt_detect\r\n\r\n\r\ncryptolocker\r\nransomware\r\n\r\n\r\n\r\n\r\nTable 14. Folders excluded from encryption by Defray777.\r\nExcluded files:\r\n\r\n\r\n\r\niconcache.db\r\nthumbs.db\r\nransomware\r\nransom\r\n\r\n\r\ndebug.txt\r\nboot.ini\r\ndesktop.ini\r\nautorun.inf\r\n\r\n\r\nntuser.dat\r\nntldr\r\nntdetect.com\r\nbootfont.bin\r\n\r\n\r\nbootsect.bak\r\n\r\n\r\n\r\n\r\n\r\n\r\nTable 15. Files excluded from encryption by Defray777.\r\nIt is also important to note that Defray777 adds the name of the ransom note into the excluded files list.\r\n\r\nExcluded extensions:\r\n\r\n\r\n\r\n.ani\r\n.cab\r\n.cpl\r\n.cur\r\n.diagcab\r\n\r\n\r\n.diagpkg\r\n.dll\r\n.drv\r\n.hlp\r\n.icl\r\n\r\n\r\n.icns\r\n.ico\r\n.iso\r\n.ics\r\n.lnk\r\n\r\n\r\n.idx\r\n.mod\r\n.mpa\r\n.msc\r\n.msp\r\n\r\n\r\n.msstyles\r\n.msu\r\n.nomedia\r\n.ocx\r\n.prf\r\n\r\n\r\n.rtp\r\n.scr\r\n.shs\r\n.spl\r\n.sys\r\n\r\n\r\n.theme\r\n.themepack\r\n.exe\r\n.bat\r\n.cmd\r\n\r\n\r\n.url\r\n.mui\r\n\r\n\r\n\r\n\r\n\r\n\r\nTable 16. Extensions excluded from encryption by Defray777.\r\n\r\nSearching for Unmapped File Shares\r\nDuring execution, Defray777 uses WNetOpenEnumW and WNetEnumResourceW to search for file shares that may contain files that could be encrypted. This tactic has been seen amongst other ransomware variants in the wild to encrypt files that are accessible via unmapped file shares.\r\n\r\n[caption id=\"attachment_109506\" align=\"aligncenter\" width=\"737\"] Figure 24. Defray777 enumerating network resources.[\/caption]\r\nAnti-Forensic Measures\r\nAfter all files are encrypted on the system, Defray777, like many other ransomware variants, implements common anti-forensics measures to remove as much evidence of the intrusion as possible and make it extremely difficult for the system to be recovered without a backup. Although these commands are common amongst other ransomware variants, Defray777 runs commands post-encryption, which means that when security tools alert or take action against Defray777, the files have already been encrypted.\r\n\r\nCommands executed by Defray777:\r\n\r\n\r\n\r\ncipher.exe \/w:[DRIVE]\r\nfsutil.exe usn deletejournal \/D [DRIVE]\r\nwbadmin.exe delete catalog -quiet\r\nbcdedit.exe \/set {default} recoveryenabled no\r\nbcdedit.exe \/set {default} bootstatuspolicy ignoreallfailures\r\nschtasks.exe \/Change \/TN \"\\Microsoft\\Windows\\SystemRestore\\SR\" \/disable\r\nwevtutil.exe cl Application\r\nwevtutil.exe cl System\r\nwevtutil.exe cl Setup\r\nwevtutil.exe cl Security\r\nwevtutil.exe sl Security \/e:false\r\n\r\n\r\n\r\nTable 17. Anti-forensic commands executed by Defray777.\r\nRegistry keys modified:\r\n\r\n\r\n\r\n\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore\\DisableConfig\r\n\r\n\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore\\DisableSR\r\n\r\n\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\SystemRestore\\DisableSR\r\n\r\n\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\SystemRestore\\DisableConfig\r\n\r\n\r\n\r\nTable 18. Registry Keys Modified by Defray777.\r\n\r\nDefray777\u2019s Port to Linux\r\nDuring the course of our research, we found that Defray777 ransomware has been ported over to Linux. Before Defray777, ransomware that impacted both Windows and Linux operating systems was limited to being written in Java or scripting languages such as Python. These ransomware variants would be considered cross-functional since they were written in a single language that must be installed and supported by both operating systems. Defray777\u2019s port to Linux ensures that the ransomware has standalone executables for each platform with no external dependencies.\r\n\r\nA ZIP archive was uploaded to a public malware repository on Oct. 17, 2020 that contained a Windows executable that was identified as a Defray777 decryptor. Additionally included in this ZIP archive was an ELF binary named decryptor64. Analysis of this binary determined it to be another Defray777 decryptor that had been ported to Linux.\r\n\r\nArmed with the idea that there may be Linux versions of Defray777 in the wild, we began hunting in AutoFocus and quickly uncovered an ELF version of the ransomware encryptor.\r\n\r\nReviewing this sample further indicated that it was uploaded in August 2020. As of early October 2020, there appear to be zero detections by antivirus (AV) in VirusTotal for the Linux version of Defray777.\r\n\r\nA deeper review of the Linux and Windows variants of Defray777 determined that the encryption and decryption processes used were nearly identical. In fact, by generating our own RSA key pair and modifying the binaries, we were able to confirm that the encryptors and decryptors for both operating systems were interchangeable.\r\n\r\nUnlike the Windows versions, the developers didn\u2019t seem to put any effort into protecting the Linux samples. To our surprise, the binaries we analyzed still had their symbols intact, which made reversing them quite a bit easier.\r\n\r\n[caption id=\"attachment_109508\" align=\"aligncenter\" width=\"600\"] Figure 25. Named functions listing from ELF version of Defray777.[\/caption]\r\n\r\nOne of the biggest differences between the Windows and Linux variants is the logic that determines which files to encrypt. The Windows version will recurse the file system and encrypt anything that isn\u2019t explicitly excluded. In contrast, the Linux variant will only encrypt directories specified in a command line argument.\r\n\r\nContinue reading: Linking Vatet, PyXie and Defray777\r\n\r\nLinking Vatet, PyXie and Defray777\r\nWhile researching these malware families, we found that there were several consistencies between Vatet, PyXie and Defray777 that strongly suggest that all three malware families were created, and are currently maintained by, the same financially motivated threat group.\r\nPDB Path Reuse \r\nAs we saw with the Defray777 decryptors, there are numerous victims that have been impacted by Defray777. However, these decryptors also show some overlap with PyXie. One of the decryptors we analyzed shares a common path with earlier versions of PyXie and its Cobalt Mode downloader.\r\n\r\n\r\n\r\nDefray777 Decryptor\r\nZ:\\coding\\pyproject\\compiled\\ransom\\ransom.pdb\r\n\r\n\r\nPyXie\r\nz:\\coding\\pyproject\\python_static_2.7.15\\\r\n\r\n\r\nCobalt Mode\r\nZ:\\coding\\pyproject\\compiled\\cobalt_mode\\cobalt_mode.pdb\r\n\r\n\r\n\r\nTable 19. PDB paths shared between Defray777, PyXie and Cobalt Mode.\r\nAdditionally, some of the variants of Vatet we observed also have overlapping PDB paths.\r\n\r\n\r\n\r\nTetris\r\nC:\\Users\\1\\Downloads\\tetris-game-master\\Release\\TetrisGame_zjy.pdb\r\n\r\n\r\nNotepad\r\nC:\\Users\\1\\Downloads\\notepad-master\\Debug\\notepad.pdb\r\n\r\n\r\nRainmeter\r\nC:\\Users\\1\\Downloads\\rainmeter-master\\x32-Release\\Obj\\Library\\Rainmeter.pdb\r\n\r\n\r\nRainmeter\r\nC:\\Users\\1\\Downloads\\rainmeter-master\\x32-Release\\Obj\\Application\\Rainmeter.pdb\r\n\r\n\r\nNotepad++\r\nC:\\Users\\1\\Downloads\\notepad-plus-plus-master\\PowerEditor\\bin\\npp.pdb\r\n\r\n\r\n\r\nTable 20. PDB paths shared between Vatet variants.\r\n\r\nString Encryption \r\nDuring our research, we observed that the method of string encryption in each of the variants was consistent. Defray777 uses the same string encryption that was used in PyXie. Additionally, the same string encryption methodology was observed in the Tetris variant of Vatet loader.\r\n\r\n[caption id=\"attachment_109510\" align=\"aligncenter\" width=\"707\"] Figure 26. Defray777 string decryption example.[\/caption]\r\nCreating Mutexes\r\nDefray777 uses the same Mutex routine as the updated PyXie sample we analyzed, including the DEFAULTCOMPNAME fallback. One thing Defray777 does differently is that it omits the step where the computed MD5 hash is XOR\u2019d with 0x2.\r\n\r\n[caption id=\"attachment_109512\" align=\"aligncenter\" width=\"794\"] Figure 27. The Defray777 mutex creation process.[\/caption]\r\nConclusion\r\nSince 2018, a financially-motivated threat group has been using a combination of Vatet loader, PyXie RAT and Defray777 ransomware to target organizations in the healthcare, education, government and technology industries without drawing attention to themselves. They\u2019ve only been a blip on the radar.\r\n\r\nWe have exposed this group\u2019s desire to use open source tools as a means for the Vatet loader. We have shown how PyXie is used to conduct reconnaissance and find and exfiltrate data. We have also uncovered how this group uses Cobalt Strike to deliver Defray777 into memory to encrypt files, causing catastrophic damage to their victims.\r\n\r\nWe hope that by shining more light on this group of threat actors, we can help disrupt their ability to conduct ransomware operations. Now that they are on the radar, we must aim to keep them there.\r\n\r\nPalo Alto Networks customers are protected from this threat in the following ways:\r\n\r\n \tAll samples in this report have a malicious verdict in WildFire.\r\n \tCortex XDR detects these threats.\r\n \tCommand and Control infrastructure has been classified as malicious in URL Filtering.\r\n \tAutoFocus tags are available for additional context:\r\n\r\n \tPyXie\r\n \tRansomX (also known as Defray777)\r\n \tVatet\r\n\r\n\r\n\r\nContinue reading: Indicators of Compromise\r\n\r\n\r\nIndicators of Compromise\r\nCobalt Strike C2\r\n192.169.7[.]160\r\n\r\n51.79.42[.]156\r\n\r\n5.135.230[.]132\r\n\r\n162.216.240[.]7\r\n\r\n172.245.21[.]224\r\n\r\n192.169.6[.]180\r\n\r\ncloud[.]falconoasisdubai[.]com\r\n\r\nsyvansoft[.]com\r\n\r\ngue[.]life\r\n\r\nm33[.]bar\r\n\r\nj3qq4[.]club\r\nPyXie C2\r\nsarymar[.]com\r\n\r\nbenreat[.]com\r\n\r\nplanlamaison[.]com\r\n\r\nteamchuan[.]com\r\n\r\ntedxns[.]com\r\n\r\nmustome[.]com\r\n\r\nhekutn[.]com\r\n\r\nsafealyzer[.]com\r\n\r\nbookrah[.]com\r\n\r\nc1oudflare[.]com\r\nDefray777 SHA256\r\n4cae449450c07b7aa74314173c7b00d409eabfe22b86859f3b3acedd66010458\r\nDefray777 Linux SHA256\r\n78147d3be7dc8cf7f631de59ab7797679aba167f82655bcae2c1b70f1fafc13d\r\n\r\ncb408d45762a628872fa782109e8fcfc3a5bf456074b007de21e9331bb3c5849\r\nPyXie Lite SHA256\r\n5d26300ad2fc008fe278f17f98f173236c8bd7eeb6382062d677d1d6fd37c5b5\r\n\r\n82a2149aa09b2b59ee7c97e05d7200d4ccbcd8444182aca2f8c4913f1f59a42c\r\n\r\n0ad10472f7aedfd241ecb65a53d5cafdeb94672d92883d161cb37f769e60f013\r\n\r\n61b9b7e1329eb540dd751d1db6c00cc45d91b6f58db75ab0212976d4ec4c848e\r\n\r\n84428ece8efcb6298435b15d3c4ea281592accf0990cc840ef3a7a0644191061\r\n\r\n4d0176e2d6e30e31352f420a4dec79d26cb00f1e6c789b31e84cd05eb4d50956\r\n\r\n5e90a331bafd98e41bcf36419c44bd7ff8296ac18cce652e944ae22db15a5366\r\n\r\nfe564fb38a99dbb94cc8a66d8955b0b7f8e67bf0a5eb820c4a5d0c3efb96c1e5\r\n\r\nb2b3a199291c3651b1d7413c7dba92566a893010a50e770e1802f173f1c2c7a4\r\n\r\n5736e167e234e06b33e8d8d6bb80e13b1bacca8d7cd3271695220cdec2e4a79e\r\n\r\na7affc0d93e27165ce44c55ae28189e8b55967443f9e464232f230ab4ba175ca\r\n\r\nb3c6f365819864340a8a8fe3076fb326c1debfdbbc826384cb2978aea82edc48\r\n\r\nc7ddbc24a57d1353d73533c47a65e5e3a74e3b666c1fed685fc90de1f089c72b\r\n\r\n510cf6e1c55a190490e93d222ea606ed888d222ecedda18bfb2f32bb73f33cab\r\n\r\nf80bcc60e79b387f63edfe0f1fc66492af4ff201ad5eb8080b1249ca43f6f30f\r\n\r\n6485bec374f255831b7ddbfed9925e988dcd7e893f610842809dd7cd1988cffc\r\n\r\nc58f5b3f7300a13fd9a0a61757e20399fc5e86544befdafae15e8809a02c2db0\r\n\r\n9847cea40cec394c947de06010ad1f3033316903b5c822ba16f9574acb30f0cd\r\nPyXie Lite Command Line Argument\r\n-q -s {{&lt;GUID&gt;}} -p &lt;NUMBER&gt;\r\nPyxie Lite Exfil Staging Paths\r\n%temp%\\tmp&lt;Random&gt;\\wifi_info.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\software.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\screen.jpg\r\n\r\n%temp%\\tmp&lt;Random&gt;\\pwds.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\general.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\disks_info.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\desk_files.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\cpu_ram.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\arp_a.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\cmdkey_list.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\cpu_ram.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\disks_info.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\files.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\general.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\gpresult_z.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\ipconfig_all.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\ipconfig_displaydns.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\mimi.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_config_workstation.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_group_domain_admins_domain.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_group_domain_admins.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_group_enterprise_admins.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_localgroup_administrators.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_localgroup.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_share.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_use.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_user.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_view_all_domain.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\net_view_all.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\netstat_an.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\nslookup_typeany_userdnsdomain.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\portscan.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\pwds.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\route_print.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\soft.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\software.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\systeminfo.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\tasklist_v.txt\r\n\r\n%temp%\\tmp&lt;Random&gt;\\wmic_process.txt\r\nPyXie SHA256\r\n70dfa6b21f5eea28ccb77ddac876cf6eac58b2ac55ab7b9ee52d79b1b5f3734d\r\n\r\n8d2b3b0cbb32618b86ec362acd142177f5890917ae384cb58bd64f61255e9c7f\r\n\r\n260be87cd75f304272094d3bef02eff6ef6b605f01ffe2983361e6e2f6116769\r\n\r\n09bb81e5a6c716f14c625ff36beb3b184d0089ed29252af10635b604b69f22ef\r\n\r\n70dfa6b21f5eea28ccb77ddac876cf6eac58b2ac55ab7b9ee52d79b1b5f3734d\r\n\r\n744d0c4b89e1b2ddd70d614b4dc009afa8f3a528c821c371cf72e60cc3367f19\r\n\r\n37268f0ade3050fa2008b546920c4f2052732c092de04a6e108257f5de22ff48\r\n\r\n80bd15267756343f028cbe77afe810068b0e6a36ce32f52be63f620ef5b5ed89\r\n\r\ne2d4aa8662b3db2f3857dbacada1ff0da0ceaf75bbba579bc5ef1a555c065206\r\n\r\naed5b487e13e920835b0ba5ca964e25a815f8a10011d8e1eb29278ae254771d9\r\n\r\nf9da4d61344457c3d68ef0525139c2cf6ee28d3f09220168ba2be601b5c54d6f\r\n\r\ne03680e0af40a6fa1a12bed2f701c6137335d28b3d222579552658e951cbd13c\r\n\r\ne2faf6586f8ac70cd98e4ec648f79435bfabaf84d440044aedce0c5c59b662e8\r\n\r\n814357417aa8a57e43d50cb3347c9d287b99955b0b8aee4e53e12b463f7441a0\r\n\r\nde44656b4a3dde6e0acdc6f59f73114ce6bb6342bec0dcd45da8676d78b0042e\r\n\r\n78471db16d7bd484932c8eb72f7001db510f4643b3449d71d637567911ca363b\r\n\r\ne0f22863c84ee634b2650b322e6def6e5bb74460952f72556715272c6c18fe8e\r\n\r\n563dd5a95f439bc2b4170a74c8be565a1af076e6cbebd1d018b2809a1e8bc908\r\n\r\n411eb20988f57317c177ea64c8bb4c059cc39da6e91eb1e7b9b8da96775d93d5\r\n\r\ned675db1e7c93526141d40ba969bdc5bbdfd013932aaf1e644c66db66ff008e0\r\n\r\nf9290cd938d134a480b41d99ac2c5513a964de001602ed34c6383dfeb577b8f7\r\n\r\nd271569d5557087aecc340bb570179b73265b29bed2e774d9a2403546c7dd5ff\r\n\r\n3a47e59c37dce42304b345a16ba6a3d78fc44b21c4d0e3a0332eee21f1d13845\r\n\r\n92a8b74cafa5eda3851cc494f26db70e5ef0259bc7926133902013e5d73fd285\r\n\r\nea27862bd01ee8882817067f19df1e61edca7364ce649ae4d09e1a1cae14f7cc\r\n\r\nc3b3f46a5c850971e1269d09870db755391dcbe575dc7976f90ccb1f3812d5ea\r\n\r\nedd1480fe3d83dc4dc59992fc8436bc1f33bc065504dccf4b14670e9e2c57a89\r\n\r\n3aa746bb94acee94c86a34cb0b355317de8404c91de3f00b40e8257b80c64741\r\n\r\n1d970f2e7af9962ae6786c35fcd6bc48bb860e2c8ca74d3b81899c0d3a978b2b\r\n\r\n56e96ce15ebd90c197a1638a91e8634dbc5b0b4d8ef28891dcf470ca28d08078\r\n\r\n5937746fc1a511d9a8404294b0caa2aedae2f86b5b5be8159385b6c7a4d6fb40\r\n\r\n0da9e149ba324f20a390140e9d7913b13ababa07f5b65e4d25e3555c1119e768\r\n\r\na765df03fffa343aa7a420a0a57d4b5c64366392ab6162c3561ff9f7b0ad5623\r\n\r\n7330fa1ca4e40cdfea9492134636ef06cd999efb71f510074d185840ac16675d\r\n\r\nc9400b2fff71c401fe752aba967fa8e7009b64114c9c431e9e91ac39e8f79497\r\nPyXie Command Line Argument\r\n%SYSTEMROOT%\\system32\\worker.exe\r\nVatet SHA256\r\nbacc02fd23c4f95da0fbc5c490b1278d327fea0878734ea9a55f108ef9f4312e\r\n\r\n5e0062def3e1d2ac206aa43854a60e23b0d1158fa982e99e0ba8190e77290dbf\r\n\r\n4421720e0321ac8b3820f8178eb8a5ff684388438b62c85f93df9743a1d9fdb9\r\n\r\n915e660ec51abea9ffd5716fb2c9b8593643adc5e9ea0834a88d8ea4016899f0\r\n\r\n0b42bf15b77cfe9f9e693f2776691647e78a91be27f5bdb8d1a366be510a773f\r\n\r\n57eea67e3eebde707c3fb3473a858e7f895ae12aad37cc664f9c0512c0382e6a\r\n\r\n2f149a79f721bb78eb956f70183b531fb6a1b233ceb4a3d6385759a0b0c16fd3\r\n\r\n6ac07424e5c9b87d76645aa041772ac8af12e30dc670be8adf1cf9f48e32944b\r\n\r\n382d9bf5da142d44de5fda544de4fffe2915a3ffc67964b993f3c051aa8c2989\r\n\r\nef7e21d874a387f07a9f74f01f2779a280ff06dff3dae0d41906d21e02f9c975\r\n\r\ne5ce1c1b69bd12640c604971be311f9544adb3797df15199bd754d3aefe0a955\r\n\r\n37e8d3ae4c34441b30098d7711df8ef0bcc12c395f265106b825221744b956bc\r\n\r\n10c4067908181cebb72202d92ff7a054b19ef3aada939bf76178e35be9506525\r\n\r\nb159fadb829a206c9a59ec547aa9e2a3ee83e8a3cc1441de04f58fd02a43c760\r\n\r\n6c1b17c8d8eca38b9926b40637cb793d0997a6183156d9e6353b53d7b3955f20\r\n\r\n375afe90771e63dbec77de439625267d723dc6bbb37cc5e94cf4d281d16c2ca8\r\n\r\n4d39782ccdb902e8e5348b8b3ce92f0834c713c565cca82be67a0a8eb6468df6\r\n\r\n6497d14f6dd14c39c037cb7da24b51d90b7040af64c245aaab6c6cc80cde7f3b\r\n\r\n95e5e83b10df32f06080bd6f8428592d81febbf55e72ec5f843dd6188bef25da\r\n\r\n01a2404fcf56027be610c65bbfb0f2dda9cfaf67385cb7f93f0b586e3aa6803a\r\n\r\nb7fbbbdf7e8795022a41f4e6a94be1de432ae1911e49625f73555e01a5fdc719\r\n\r\nd7bcb52f027f66c988e595dc29a343e27af7599e3659901f85a92c26440a5e1f\r\n\r\nd353eeb623e96b32c086a9b64991dfedbc8d31254aec2c3cda51042ceb07ee82\r\n\r\n66c2038c6d86333cbc51726bc54d3b8a00162493b2c92ca7f839b50435eaa314\r\n\r\n47d6cc0a05218d0c1078dabf8d0ca7b7b424cdd73eaf3bf6261fa1b42f92fe0b\r\n\r\n5dc7f70a0d20f97c30c25bd927235deec713cde5d1c41916e23dd0c3431ffacd\r\n\r\n7ad92c9d63bd9ed305acbe217c40f9945deb98ed5ecced8b92b93332dc27d3c6\r\n\r\nd46f72b8598ff80de5661205f6cac0b47831778f70b5edd7525e23418706cc1a\r\n\r\nccc162d3a3d6136a9c472d7d2d07acbae47f88a9a7d9b2c9b97b331e7ab7605d\r\n\r\n3cd581621d9a16ebe724e9ba7445aa82162307ff6b2a31be572e87dbce2aa8ad\r\n\r\ne1653fe62e8d90153557324ffe4470d9c9262fe3bddad2bf555680b6078cf66a\r\n\r\n75728bc96c934c1521ae08e03ec916e20628e000b056c55b6ee04ccc18c602f6\r\n\r\na50a25a312adb9103e52e94018013ebdb6dbfe792a34122cacd53cfa3bbb26ac\r\n\r\n87210d6f1773473d28b51de21ed55ecfb6a9bd34f56d2d37f483ed05a1d7efd8\r\n\r\nd7d28af8af5be22ecca267bdc7e142667f584550cf8a3bbebdb1368725bb6469\r\n\r\nd7641089fd5d0474b835a633d6d852028b3481c18b3574023b021bfa1e3c1cc1\r\n\r\n5aec2fa9e954473d9c6b5233512f833e63541965e2d2e4af2419a457676c440d\r\n\r\nfcdd72fd2e03badfac13eed5e2d17054bbdcea7c1743179095ce109bf40a7f0f\r\n\r\n350926c6bb7419330e55e687c9f00520a560c41f6013528cbb9ea42faeeb3201\r\n\r\n8eef012c2eecb7f8a776464f52e12f62c466cfc85adf4eef0d2bc270e7a19212\r\n\r\n3928bd8f2fd2db4891b320fa85b37c2598706d27283818ad33a0eeac16d59192\r\n\r\n8373be56ddab97188a8606eb5f529187bfb819f5cb5a50c56f6a7878c94c7f86\r\n\r\na098b5455fd1e9d0dea067405cd891b94cc42a0067cbd21d385f9c1254c21fdd\r\n\r\n2b13dae3c35eb3958253dbf945f6609e59978c2aedbd163608f03920d7d3623b\r\n\r\n01011bb45dec3b520ea09e5d9d3c9fb4acce74de72261f68ff1011f9ea6ccebb\r\n\r\n80c9d6cf4e8119dc2d0e263f3f4d5c3bf4221715117505d9d6a02e3671337bf8\r\n\r\nbec5a3cfd7332241e3a7463d951b8f9a9e771d4f436d7776a426074a82d19a7d\r\n\r\nc7f96f8b15c324bd6bf1aa16f6697d6d407f91ad2d7628a14d70f146334d34be\r\n\r\nc5ca45581da0bbb3e4d0c6e51d602512fa52833cd16eebed351397a9a0326518\r\n\r\n6f1e8f91773609087a417cb34887f292a0be5c246dab667195854f979a45349a\r\n\r\ne07dd37c92d24ac20b94a183e1f0a22a4eec0f950f441761c065faf0afd2abdd\r\n\r\n0d14a1b5574dc12f6286d37d0a624232fb63079416b98c2e1cb5c61f8c2b66ff\r\n\r\ne5fede5eb43732c7f098acf7b68b1350c6524962215b476de571819b6e5a71fc\r\n\r\necf3f4ba8dd16551908488cfbf2afd18a55584dbf81c28623026a29b9fa4a62d\r\n\r\nedecfdd2a26b4579ecacf453b9dff073233fb66d53c498632464bca8b3084dc5\r\n\r\n1309b052618c6301901ec75cf552e7b49f93d66fb47d4de59b82d37d6ac39039\r\n\r\n2ceb5de547ad250140c7eb3c3d73e4331c94cf5a472e2806f93bf0d9df09d886\r\n\r\n3259dd0efed1d28a149d4e8c4f980a19199d9bead951ee1231e3a26521185f2f\r\n\r\n3a3b7b198769de3e5d81a92aa166f783b611a39a7fcea1b5ec762b54295dbc8d\r\n\r\n56934547dcf0d7ecf61868ae2f620f60e94c094dbd5c3b5aaf3d3a904d20a693\r\n\r\n608f34a79e5566593b284ef0d24f48ea89bc007e5654ae0969e6d9f92ec87d32\r\n\r\n625c22b21277c8a7e1b701da9c1c21b64bfa02baef5d7a530a38f6d70a7a16d0\r\n\r\n73609f8ebd14c6970d9162ec8d7786f5264e910573dff73881f85b03163bd40e\r\n\r\n840985b782648d57de302936257ba3d537d21616cb81f9dce000eaf1f76a56c8\r\n\r\n88565b4c707230eac34d4528205056264cd70d797b6b4eb7d891821b00187a69\r\n\r\n91c62841844bde653e0357193a881a42c0bc9fcc798a69f451511c6e4c46fd18\r\n\r\na50b58e24eb261157c4f85d02412d80911abe8501b011493c7b393c1905fc234\r\n\r\nb1f54b88c9b7680877981f6bebde6aea9effbc38a0a8b27a565fb35331094680\r\n\r\nbd7da341a28a19618b53e649a27740dfeac13444ce0e0d505704b56335cc55bd\r\n\r\ncb2619b7aab52d612012386d88a0d983c270d9346169b75d2a55010564efc55c\r\n\r\nce0936366976f07ea24e86733888e97e421393829ecfd0fde66bd943d4b992ab\r\n\r\nd50f28cf5012e1ffde1cd28655e07519dadcf94218b15c701c526ab0f6acb915\r\n\r\nd612144c1f6d4a063530ba5bfae7ef4e4ae134bc55dcf067439471934b841b00\r\n\r\nddf83c02effea8ae9ec2c833bf40187bed23ec33c6b828af49632ef98004ea82\r\n\r\ne48e88542ec4cd6f1aa794abc846f336822b1104557c0dfe67cff63e5231c367\r\nVatet Payload SHA256\r\na512e5ffd33da906fdf896c536bf64adc59599ec2227f60dace4a4ef23d3d21a\r\n\r\n56f6084d84bd6371918c3ae7b555099474cdb6665bed0d969f6b5762b8cf5cc9\r\n\r\n2f1e047e840620460bdf7371e62e966919f25f763a53248357f890a4ff11791f\r\n\r\n6812190b1dec8c2a4c5d2b327d1bdbe72974fc017d86d2337ea06e9d3337959e\r\n\r\n77f2df32060e5125c6d4a3ab2a2a0c862eb44bc44614d494d23f4690a45d08a3\r\n\r\n309af51a8d86e031e25c2c928101b9afc9bcd1dcadbf4ef27ed3c0e8d7da0c98\r\n\r\nc2861e5626c5ba40d28ec6c7d4ac32edc972a969d2454e74dc50829d02b5de2a\r\n\r\n8a7dc1c39321d972a21bf4fdd24f6f2ef3a03e4ea95c49f383ba03902010210c\r\n\r\n0e7824dfb7668af175a2b887e592773517f17213555c3b9af4f98d54278621d5\r\n\r\nd389e2fc1515b8a2d8d365d072c201a308f776c873fdb185f826a35fde6fbf2b\r\n\r\nbde87df68407fafc3ebd95665838eb5476cb854b338fb97252d153a2250f28b8\r\n\r\nab432a84b05de381c2f96a000c318ec78c98e39abfa7eea3210840c85b0cbee7\r\nVatet Payload Path\r\n\\\\&lt;IP&gt;\\&lt;EPOCHTIME&gt;\\settings.dat\r\n\r\n\\\\&lt;IP&gt;\\&lt;EPOCHTIME&gt;\\upgrade.dat\r\n\r\n\\\\&lt;IP&gt;\\&lt;EPOCHTIME&gt;\\vodafone.dat\r\n\r\n\\\\&lt;IP&gt;\\&lt;EPOCHTIME&gt;\\winint2.sto\r\n\r\nc:\\windows\\INF\\Rainmeter.dat\r\n\r\nc:\\windows\\INF\\notepad.dat\r\n\r\nc:\\windows\\INF\\options.dat\r\n\r\nc:\\windows\\debug\\Rainmeter.dat\r\n\r\nc:\\windows\\debug\\config.dat\r\n\r\nc:\\windows\\debug\\notepad.dat\r\n\r\nc:\\windows\\debug\\options.dat\r\n\r\nc:\\windows\\help\\Rainmeter.dat\r\n\r\nc:\\windows\\help\\notepad.dat\r\n\r\nc:\\windows\\help\\options.dat\r\n\r\nc:\\windows\\media\\notepad.dat\r\n\r\nc:\\windows\\notepad.dat\r\n\r\nc:\\windows\\options.dat\r\n\r\nc:\\windows\\system\\options.dat\r\n\r\nc:\\windows\\temp\\options.dat\r\nPDB Paths\r\nC:\\Users\\1\\Downloads\\notepad-plus-plus-master\\PowerEditor\\bin\\npp.pdb\r\n\r\nC:\\Users\\1\\Downloads\\rainmeter-master\\x32-Release\\Obj\\Library\\Rainmeter.pdb\r\n\r\nC:\\Users\\1\\Downloads\\rainmeter-master\\x32-Release\\Obj\\Application\\Rainmeter.pdb\r\n\r\nC:\\Users\\1\\Downloads\\notepad-master\\Debug\\notepad.pdb\r\n\r\nC:\\Users\\1\\Downloads\\tetris-game-master\\Release\\TetrisGame_zjy.pdb\r\n\r\nZ:\\coding\\pyproject\\compiled\\cobalt_mode\\cobalt_mode.pdb\r\n\r\nZ:\\coding\\pyproject\\compiled\\ransom\\ransom.pdb\r\nPyXie Lite Config\r\n\r\n\r\n\r\n{\r\n\r\n\"logs\": {\r\n\r\n\"gates\": [\r\n\r\n\"&lt;REDACTED&gt;:8443\/data\"\r\n\r\n],\r\n\r\n\"aes_key\": \"THIS_KEY_IS_FOR_INTERNAL_USE_ONLY\",\r\n\r\n\"send_attempts\": 10,\r\n\r\n\"send_attempts_timeout\": 5\r\n\r\n},\r\n\r\n\"dirs_keys\": [\"actifio\",\r\n\r\n\"aldelo\",\r\n\r\n\"altaro\",\r\n\r\n\"avamar\",\r\n\r\n\"avs\",\r\n\r\n\"back-up\",\r\n\r\n\"backup\",\r\n\r\n\"bank\",\r\n\r\n\"bitmessage\",\r\n\r\n\"client\",\r\n\r\n\"cobaltstrike\",\r\n\r\n\"coin\",\r\n\r\n\"diebold\",\r\n\r\n\"filemaker\",\r\n\r\n\"htape\",\r\n\r\n\"magtek\",\r\n\r\n\"ncr\",\r\n\r\n\"passw\",\r\n\r\n\"payment\",\r\n\r\n\"rapid7\",\r\n\r\n\"replication\",\r\n\r\n\"screenconnect\",\r\n\r\n\"swift\",\r\n\r\n\"tivoli\",\r\n\r\n\"unitrends\",\r\n\r\n\"vault\",\r\n\r\n\"veeam\",\r\n\r\n\"vranger\",\r\n\r\n\"wallet\",\r\n\r\n\"wincor\"],\r\n\r\n\"shell_cmds\": [\"arp -a\",\r\n\r\n\"cmdkey \/list\",\r\n\r\n\"dclist\",\r\n\r\n\"gpresult \/z\",\r\n\r\n\"ipconfig \/all\",\r\n\r\n\"ipconfig \/displaydns\",\r\n\r\n\"klist\",\r\n\r\n\"manage-bde -status\",\r\n\r\n\"net config workstation\",\r\n\r\n\"net group \\\"domain admins\\\" \/domain\",\r\n\r\n\"net group \\\"Domain Admins\\\"\",\r\n\r\n\"net group \\\"Enterprise Admins\\\"\",\r\n\r\n\"net localgroup \\\"administrators\\\"\",\r\n\r\n\"net localgroup\",\r\n\r\n\"net share\",\r\n\r\n\"net use\",\r\n\r\n\"net user\",\r\n\r\n\"net view \/all \/domain\",\r\n\r\n\"net view \/all\",\r\n\r\n\"netstat -an\",\r\n\r\n\"nltest \/domain_trusts \/all_trusts\",\r\n\r\n\"nltest \/domain_trusts\",\r\n\r\n\"nslookup -type=any %userdnsdomain%\",\r\n\r\n\"qwinsta\",\r\n\r\n\"route print\",\r\n\r\n\"systeminfo\",\r\n\r\n\"tasklist \/V\",\r\n\r\n\"vssadmin List Shadows\",\r\n\r\n\"wmic process\",\r\n\r\n\"wmic qfe list\"],\r\n\r\n\"dirs\": [\"%ALLDRIVESROOTS%\\\\Alliance\",\r\n\r\n\"%APPDATA%\\\\Agama\",\r\n\r\n\"%APPDATA%\\\\Armory\",\r\n\r\n\"%APPDATA%\\\\B3-CoinV2\",\r\n\r\n\"%APPDATA%\\\\BeerMoney\",\r\n\r\n\"%APPDATA%\\\\Bitcloud\",\r\n\r\n\"%APPDATA%\\\\Bitcoin\",\r\n\r\n\"%APPDATA%\\\\BitcoinZ\",\r\n\r\n\"%APPDATA%\\\\bitconnect\",\r\n\r\n\"%APPDATA%\\\\Bither\",\r\n\r\n\"%APPDATA%\\\\bitmonero\",\r\n\r\n\"%APPDATA%\\\\BlocknetDX\",\r\n\r\n\"%APPDATA%\\\\Cybroscoin\",\r\n\r\n\"%APPDATA%\\\\Daedalus\",\r\n\r\n\"%APPDATA%\\\\DashCore\",\r\n\r\n\"%APPDATA%\\\\DeepOnion\",\r\n\r\n\"%APPDATA%\\\\DigiByte\",\r\n\r\n\"%APPDATA%\\\\Dogecoin\",\r\n\r\n\"%APPDATA%\\\\ElectronCash\",\r\n\r\n\"%APPDATA%\\\\Electrum\",\r\n\r\n\"%APPDATA%\\\\Electrum-LTC\",\r\n\r\n\"%APPDATA%\\\\Ember\",\r\n\r\n\"%APPDATA%\\\\EmeraldWallet\",\r\n\r\n\"%APPDATA%\\\\Ethereum Wallet\",\r\n\r\n\"%APPDATA%\\\\Exodus\",\r\n\r\n\"%APPDATA%\\\\FairCoin\",\r\n\r\n\"%APPDATA%\\\\faircoin2\",\r\n\r\n\"%APPDATA%\\\\Florincoin\",\r\n\r\n\"%APPDATA%\\\\FORT\",\r\n\r\n\"%APPDATA%\\\\GambitCoin\",\r\n\r\n\"%APPDATA%\\\\GeyserCoin\",\r\n\r\n\"%APPDATA%\\\\GreenCoinV2\",\r\n\r\n\"%APPDATA%\\\\GridcoinResearch\",\r\n\r\n\"%APPDATA%\\\\Gulden\",\r\n\r\n\"%APPDATA%\\\\Hush\",\r\n\r\n\"%APPDATA%\\\\IOTA Wallet\",\r\n\r\n\"%APPDATA%\\\\Komodo\",\r\n\r\n\"%APPDATA%\\\\Learncoin\",\r\n\r\n\"%APPDATA%\\\\lisk-nano\",\r\n\r\n\"%APPDATA%\\\\Litecoin\",\r\n\r\n\"%APPDATA%\\\\Minexcoin\",\r\n\r\n\"%APPDATA%\\\\mSIGNA_Bitcoin\",\r\n\r\n\"%APPDATA%\\\\MultiBitHD\",\r\n\r\n\"%APPDATA%\\\\MultiDoge\",\r\n\r\n\"%APPDATA%\\\\Neon\",\r\n\r\n\"%APPDATA%\\\\NXT\",\r\n\r\n\"%APPDATA%\\\\Parity\",\r\n\r\n\"%APPDATA%\\\\Particl\",\r\n\r\n\"%APPDATA%\\\\Peercoin\",\r\n\r\n\"%APPDATA%\\\\pink2\",\r\n\r\n\"%APPDATA%\\\\PPCoin\",\r\n\r\n\"%APPDATA%\\\\Qtum\",\r\n\r\n\"%APPDATA%\\\\RainbowGoldCoin\",\r\n\r\n\"%APPDATA%\\\\RoboForm\",\r\n\r\n\"%APPDATA%\\\\StartCOIN-v2\",\r\n\r\n\"%APPDATA%\\\\straks\",\r\n\r\n\"%APPDATA%\\\\Stratis\",\r\n\r\n\"%APPDATA%\\\\StratisNode\",\r\n\r\n\"%APPDATA%\\\\TREZOR Bridge\",\r\n\r\n\"%APPDATA%\\\\TrumpCoinV2\",\r\n\r\n\"%APPDATA%\\\\VeriCoin\",\r\n\r\n\"%APPDATA%\\\\Verium\",\r\n\r\n\"%APPDATA%\\\\Viacoin\",\r\n\r\n\"%APPDATA%\\\\VivoCore\",\r\n\r\n\"%APPDATA%\\\\Xeth\",\r\n\r\n\"%APPDATA%\\\\Zcash\",\r\n\r\n\"%APPDATA%\\\\ZcashParams\",\r\n\r\n\"%APPDATA%\\\\Zetacoin\",\r\n\r\n\"%LOCALAPPDATA%\\\\bisq\",\r\n\r\n\"%LOCALAPPDATA%\\\\copay\",\r\n\r\n\"%LOCALAPPDATA%\\\\programs\\\\zap-desktop\",\r\n\r\n\"%LOCALAPPDATA%\\\\RippleAdminConsole\",\r\n\r\n\"%LOCALAPPDATA%\\\\StellarWallet\",\r\n\r\n\"%PROGRAMDATA%\\\\bitmonero\",\r\n\r\n\"%PROGRAMDATA%\\\\electroneum\",\r\n\r\n\"%PROGRAMDATA%\\\\Tiger Technology\",\r\n\r\n\"%PROGRAMDATA%\\\\tivoli\"],\r\n\r\n\"file_find\": {\r\n\r\n\"enabled\": 1,\r\n\r\n\"patterns\": [\"10-q\",\r\n\r\n\"10-sb\",\r\n\r\n\"access\",\r\n\r\n\"avamar\",\r\n\r\n\"admin\",\r\n\r\n\"attack\",\r\n\r\n\"aws\",\r\n\r\n\"amazon\",\r\n\r\n\"backup\",\r\n\r\n\"balance\",\r\n\r\n\"bitcoin\",\r\n\r\n\"bitlocker\",\r\n\r\n\"bribery\",\r\n\r\n\"cardholder\",\r\n\r\n\"censored\",\r\n\r\n\"checking\",\r\n\r\n\"clandestine\",\r\n\r\n\"compromate\",\r\n\r\n\"concealed\",\r\n\r\n\"confidential\",\r\n\r\n\"contraband\",\r\n\r\n\"convict\",\r\n\r\n\"credent\",\r\n\r\n\"cyber\",\r\n\r\n\"disclosure\",\r\n\r\n\"engineering\",\r\n\r\n\"esxi\",\r\n\r\n\"ethereum\",\r\n\r\n\"explosive\",\r\n\r\n\"finance\",\r\n\r\n\"fraud\",\r\n\r\n\"hidden\",\r\n\r\n\"illegal\",\r\n\r\n\"infrastruct\",\r\n\r\n\"instruction\",\r\n\r\n\"investigation\",\r\n\r\n\"logins\",\r\n\r\n\"marketwired\",\r\n\r\n\"military\",\r\n\r\n\"n-csr\",\r\n\r\n\"nasdaq\",\r\n\r\n\"nda\",\r\n\r\n\"newswire\",\r\n\r\n\"operation\",\r\n\r\n\"passport\",\r\n\r\n\"passw\",\r\n\r\n\"personal\",\r\n\r\n\"privacy\",\r\n\r\n\"private\",\r\n\r\n\"restricted\",\r\n\r\n\"routing\",\r\n\r\n\"saving\",\r\n\r\n\"secret\",\r\n\r\n\"security\",\r\n\r\n\"spy\",\r\n\r\n\"statement\",\r\n\r\n\"storage\",\r\n\r\n\"submarine\",\r\n\r\n\"suspect\",\r\n\r\n\"tactical\",\r\n\r\n\"treason\",\r\n\r\n\"username\",\r\n\r\n\"vault\",\r\n\r\n\"victim\",\r\n\r\n\"vsphere\",\r\n\r\n\"wallet\",\r\n\r\n\"wasabi\",\r\n\r\n\"wire\"\r\n\r\n],\r\n\r\n\"extentions\": [\".doc\",\r\n\r\n\".docx\",\r\n\r\n\".xls\",\r\n\r\n\".xlsx\",\r\n\r\n\".pdf\",\r\n\r\n\".txt\",\r\n\r\n\".rtf\"],\r\n\r\n\"gold_masks\": [\"*.rdp\",\r\n\r\n\"*.kdbx\",\r\n\r\n\"*.vnc\",\r\n\r\n\"*.cpp\",\r\n\r\n\"*.c\",\r\n\r\n\"*.sln\",\r\n\r\n\"*.vcproj\",\r\n\r\n\"*.h\",\r\n\r\n\"*.asm\",\r\n\r\n\"*cobaltstrike*\",\r\n\r\n\"*.ovpn\",\r\n\r\n\"*.pcf\",\r\n\r\n\"*.conf\"],\r\n\r\n\"black_files\": [\"Default.rdp\",\r\n\r\n\"Microsoft June\",\r\n\r\n\"Release_Note\",\r\n\r\n\"Release Note\",\r\n\r\n\"desktop.ini\",\r\n\r\n\"Microsoft Silverlight\",\r\n\r\n\"localhost_access_log\",\r\n\r\n\"dd_clwireg.txt\"],\r\n\r\n\"black_dirs\": [\"\\\\microsoft\\\\windows\",\r\n\r\n\"\\\\gfi\\\\languard\",\r\n\r\n\"\\\\microsoft\\\\windows\\\\cookies\",\r\n\r\n\"\\\\vmware\\\\vcenterserver\",\r\n\r\n\"\\\\autoupdate\\\\cache\",\r\n\r\n\"\\\\microsoft office\\\\root\"],\r\n\r\n\"max_size\": 5242880\r\n\r\n},\r\n\r\n\"software\": [\" OPOS\",\r\n\r\n\"Aldelo\",\r\n\r\n\"Actifio\",\r\n\r\n\"Alliance WebStation\",\r\n\r\n\"Alliance Workstation\",\r\n\r\n\"Altaro\",\r\n\r\n\"Back-up\",\r\n\r\n\"Rapid7\",\r\n\r\n\"Backup\",\r\n\r\n\"Bank\",\r\n\r\n\"Blockchain\",\r\n\r\n\"Boot Camp\",\r\n\r\n\"Box Sync\",\r\n\r\n\"BridgeHead\",\r\n\r\n\"CAM Commerce Solutions\",\r\n\r\n\"Card Processing\",\r\n\r\n\"Cash\",\r\n\r\n\"Cisco\",\r\n\r\n\"Citrix\",\r\n\r\n\"Cloud\",\r\n\r\n\"Coin\",\r\n\r\n\"Dashlane\",\r\n\r\n\"Diskeeper\",\r\n\r\n\"Double-Take\",\r\n\r\n\"Dropbox\",\r\n\r\n\"Elcomsoft\",\r\n\r\n\"FileZilla Server\",\r\n\r\n\"FortiClient\",\r\n\r\n\"Fund\",\r\n\r\n\"iDrive\",\r\n\r\n\"Ledger\",\r\n\r\n\"LexisNexis\",\r\n\r\n\"LogMeIn\",\r\n\r\n\"M262x\",\r\n\r\n\"Microsoft Dynamics RMS Store Operations\",\r\n\r\n\"Microsoft POS\",\r\n\r\n\"vRanger\",\r\n\r\n\"Money\",\r\n\r\n\"mRemoteNG\",\r\n\r\n\"MSR\",\r\n\r\n\"Password\",\r\n\r\n\"Payment\",\r\n\r\n\"Private\",\r\n\r\n\"Protect\",\r\n\r\n\"PuTTY\",\r\n\r\n\"QuickBooks\",\r\n\r\n\"Replication\",\r\n\r\n\"ScreenConnect\",\r\n\r\n\"Shadow\",\r\n\r\n\"SII RP-D10\",\r\n\r\n\"Storage\",\r\n\r\n\"SWIFT\",\r\n\r\n\"TeamViewer\",\r\n\r\n\"Token\",\r\n\r\n\"Trade\",\r\n\r\n\"Treasury\",\r\n\r\n\"Trezor\",\r\n\r\n\"Vault\",\r\n\r\n\"Unitrends\",\r\n\r\n\"VIP Access\",\r\n\r\n\"VMware\",\r\n\r\n\"Vnc\",\r\n\r\n\"VPN\",\r\n\r\n\"Wallet\",\r\n\r\n\"Withdraw\"],\r\n\r\n\"registry\": [\"SOFTWARE\\\\Ammyy\",\r\n\r\n\"SOFTWARE\\\\Cppcheck\",\r\n\r\n\"SOFTWARE\\\\DASH\",\r\n\r\n\"SOFTWARE\\\\Dash\",\r\n\r\n\"SOFTWARE\\\\DeterministicNetworks\",\r\n\r\n\"SOFTWARE\\\\GitForWindows\",\r\n\r\n\"SOFTWARE\\\\GlavSoft LLC.\",\r\n\r\n\"SOFTWARE\\\\GnuPG\",\r\n\r\n\"SOFTWARE\\\\Hex-Rays\",\r\n\r\n\"SOFTWARE\\\\Hex-Rays SA\",\r\n\r\n\"SOFTWARE\\\\HexaD\",\r\n\r\n\"SOFTWARE\\\\ITarian\",\r\n\r\n\"SOFTWARE\\\\LogMeIn Ignition\",\r\n\r\n\"SOFTWARE\\\\LogMeIn\",\r\n\r\n\"SOFTWARE\\\\MetaQuotes Software\",\r\n\r\n\"SOFTWARE\\\\Microsoft\\\\ResKit\\\\Robocopy\",\r\n\r\n\"SOFTWARE\\\\Nmap\",\r\n\r\n\"SOFTWARE\\\\Pulse Secure\",\r\n\r\n\"SOFTWARE\\\\PyBitmessage\",\r\n\r\n\"SOFTWARE\\\\PyBitmessage\",\r\n\r\n\"SOFTWARE\\\\S.W.I.F.T.\",\r\n\r\n\"SOFTWARE\\\\ShrewSoft\",\r\n\r\n\"SOFTWARE\\\\SimonTatham\",\r\n\r\n\"SOFTWARE\\\\SonicWall\",\r\n\r\n\"SOFTWARE\\\\TortoiseSVN\",\r\n\r\n\"SOFTWARE\\\\Veeam\",\r\n\r\n\"SOFTWARE\\\\VisualSVN\",\r\n\r\n\"SOFTWARE\\\\Whole Tomato\",\r\n\r\n\"SOFTWARE\\\\WinLicense\"],\r\n\r\n\"portscan\": {\"Bitcoin\": [8332,8333],\r\n\r\n\"DNS\": [53],\r\n\r\n\"Elasticsearch\": [9200,9300],\r\n\r\n\"FTP\": [21],\r\n\r\n\"Horizon Agent\": [22443,4172,9427,32111],\r\n\r\n\"HTTP\": [80,5000,9043],\r\n\r\n\"HTTPS\": [443,8443,1311,5001,8200],\r\n\r\n\"JAVA-RMI\": [34571,1099,1090,1098,1099,4444,11099,47001,47002,10999],\r\n\r\n\"MongoDB\": [27017],\r\n\r\n\"MSSQL\": [1433],\r\n\r\n\"MySQL\": [3306],\r\n\r\n\"neo4j\": [7687],\r\n\r\n\"NetBackup\": [5637],\r\n\r\n\"NETBIOS\": [139],\r\n\r\n\"Oracle\": [1521],\r\n\r\n\"POP3\": [110],\r\n\r\n\"POP3s\": [995],\r\n\r\n\"PostgreSQL\": [5432],\r\n\r\n\"PPTP\": [1723],\r\n\r\n\"RADMIN\": [4899],\r\n\r\n\"RDP\": [3389],\r\n\r\n\"SMTP\": [25],\r\n\r\n\"SonicWall-VPN\": [4433],\r\n\r\n\"SSH\": [22],\r\n\r\n\"Telnet\": [23],\r\n\r\n\"Tivoli\": [1500,1581],\r\n\r\n\"TOR\": [9050],\r\n\r\n\"AcronixBackup\": [9877],\r\n\r\n\"vCenter\": [22024,902,903,10080,10443],\r\n\r\n\"Veeam\": [9392,9393,9394,9397,9398,9399],\r\n\r\n\"VNC\": [5900, 5800],\r\n\r\n\"WinRM\": [5985,5986],\r\n\r\n\"Zabbix\": [10050,10051],\r\n\r\n\"JDWP\": [45000,45001],\r\n\r\n\"JMX\": [8686,9012,50500],\r\n\r\n\"jBoss\": [11111,4444,4445],\r\n\r\n\"Cisco Smart Install\": [4786],\r\n\r\n\"HP Data Protector\": [5555,5556],\r\n\r\n\"GlassFish\": [4848]\r\n\r\n}\r\n\r\n}\r\n\r\n\r\n\r\nPyXie Lite Remapped Opcodes\r\n\r\n\r\n\r\ndef_op('PRINT_ITEM', 78)\r\n\r\ndef_op('PRINT_NEWLINE', 63)\r\n\r\ndef_op('POP_TOP', 85)\r\n\r\ndef_op('RETURN_VALUE', 88)\r\n\r\ndef_op('ROT_TWO', 29)\r\n\r\ndef_op('ROT_THREE', 9)\r\n\r\ndef_op('STORE_MAP', 55)\r\n\r\ndef_op('INPLACE_ADD', 28)\r\n\r\ndef_op('ROT_FOUR', 72)\r\n\r\ndef_op('UNARY_POSITIVE', 12)\r\n\r\ndef_op('UNARY_NEGATIVE', 64)\r\n\r\ndef_op('UNARY_NOT', 66)\r\n\r\ndef_op('UNARY_CONVERT', 20)\r\n\r\ndef_op('UNARY_INVERT', 65)\r\n\r\ndef_op('GET_ITER', 83)\r\n\r\ndef_op('BINARY_MULTIPLY', 80)\r\n\r\ndef_op('BINARY_POWER', 79)\r\n\r\ndef_op('BINARY_DIVIDE', 15)\r\n\r\ndef_op('BINARY_MODULO', 76)\r\n\r\ndef_op('BINARY_ADD', 84)\r\n\r\ndef_op('BINARY_SUBTRACT', 89)\r\n\r\ndef_op('BINARY_SUBSCR', 57)\r\n\r\ndef_op('BINARY_FLOOR_DIVIDE', 68)\r\n\r\ndef_op('INPLACE_FLOOR_DIVIDE', 24)\r\n\r\ndef_op('INPLACE_DIVIDE', 82)\r\n\r\ndef_op('INPLACE_SUBTRACT', 22)\r\n\r\ndef_op('INPLACE_MULTIPLY', 13)\r\n\r\ndef_op('INPLACE_MODULO', 70)\r\n\r\ndef_op('STORE_SUBSCR', 54)\r\n\r\ndef_op('DELETE_SUBSCR', 77)\r\n\r\ndef_op('BINARY_LSHIFT', 60)\r\n\r\ndef_op('BINARY_RSHIFT', 21)\r\n\r\ndef_op('BINARY_AND', 3)\r\n\r\ndef_op('BINARY_XOR', 73)\r\n\r\ndef_op('BINARY_OR', 56)\r\n\r\ndef_op('INPLACE_POWER', 23)\r\n\r\ndef_op('POP_BLOCK', 2)\r\n\r\ndef_op('DUP_TOP', 75)\r\n\r\ndef_op('PRINT_ITEM_TO', 5)\r\n\r\ndef_op('PRINT_NEWLINE_TO', 11)\r\n\r\ndef_op('INPLACE_LSHIFT', 59)\r\n\r\ndef_op('INPLACE_RSHIFT', 74)\r\n\r\ndef_op('INPLACE_AND', 61)\r\n\r\ndef_op('INPLACE_XOR', 27)\r\n\r\ndef_op('INPLACE_OR', 71)\r\n\r\ndef_op('BREAK_LOOP', 58)\r\n\r\ndef_op('WITH_CLEANUP', 19)\r\n\r\ndef_op('END_FINALLY', 4)\r\n\r\ndef_op('BUILD_CLASS', 87)\r\n\r\ndef_op('EXEC_STMT', 10)\r\n\r\ndef_op('LOAD_LOCALS', 67)\r\n\r\ndef_op('IMPORT_STAR', 26)\r\n\r\ndef_op('YIELD_VALUE', 25)\r\n\r\n\r\n\r\n&nbsp;\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2020\/11\/Ransomware-r3d3.png","width":150,"height":75},"author":[{"@type":"Person","name":"Ryan Tracey"},{"@type":"Person","name":"Drew Schmitt"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.2.4' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='application/json' id="wpp-json">
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":109455,"token":"0f2151bdd2","lang":0,"debug":0}
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp.min.js?ver=5.2.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.4.3'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=109455' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvatet-pyxie-defray777%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvatet-pyxie-defray777%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.4.3 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-109455 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-109455 entry-meta">
				
				
				<span class="post-views-count">1,354</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'109455','like')"><i class="ui ui-2"></i><span class="ml-5">7</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 26</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvatet-pyxie-defray777%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvatet-pyxie-defray777%2F+-+When+Threat+Actors+Fly+Under+the+Radar%3A+Vatet%2C+PyXie+and+Defray777" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fvatet-pyxie-defray777%2F&title=When+Threat+Actors+Fly+Under+the+Radar%3A+Vatet%2C+PyXie+and+Defray777&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/ryan-tracey/" title="Posts by Ryan Tracey" class="author url fn" rel="author">Ryan Tracey</a> and <a href="https://unit42.paloaltonetworks.com/author/drew-schmitt/" title="Posts by Drew Schmitt" class="author url fn" rel="author">Drew Schmitt</a>        </p>
        <p><time datetime="2020-11-07T02:15:46+00:00">November 6, 2020 at 6:15 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/defray777/" rel="tag">Defray777</a>, <a href="https://unit42.paloaltonetworks.com/tag/malware/" rel="tag">malware</a>, <a href="https://unit42.paloaltonetworks.com/tag/pyxie/" rel="tag">PyXie</a>, <a href="https://unit42.paloaltonetworks.com/tag/ransomware/" rel="tag">ransomware</a>, <a href="https://unit42.paloaltonetworks.com/tag/vatet/" rel="tag">Vatet</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/Ransomware-r3d3.png" class="attachment-single size-single" alt="The image illustrates the concept of ransomware, such as used by the threat group behind the Vatet loader, the PyXie remote access tool and the Defray777 ransomware" />            </figure>
                    <h2><a id="post-109455-_5m80mbl9rwrq"></a>Executive Summary</h2>
<p>As security practitioners, we spend a lot of time focusing on the threat actors and malware families that leverage the most impactful exploits or affect the highest number of victims. But what happens when a threat actor goes low and slow to fly under the radar? One could argue that, in that situation, the threat actor may end up having more impact than some of the more prolific threat groups.</p>
<p>We first noticed that there may be a relationship between the Vatet loader, PyXie Remote Access Tool (RAT) and Defray777 ransomware when there were remnants and/or detections of all three in various <a href="https://www.crypsisgroup.com/">Incident Response</a> and <a href="https://www.paloaltonetworks.com/cortex/managed-threat-hunting">Managed Threat Hunting</a> engagements. After digging deep into each malware family, it became apparent that Vatet, PyXie and Defray777 are all associated with the same financially motivated threat group that has been operating since as early as 2018.</p>
<p>That threat group, sometimes referred to as PyXie by <a href="https://blogs.blackberry.com/en/2019/12/meet-pyxie-a-nefarious-new-python-rat">BlackBerry Cylance</a> and <a href="https://www.secureworks.com/research/threat-profiles/gold-dupont">GOLD DUPONT</a> by SecureWorks, has been actively conducting successful ransomware operations that have impacted organizations in a number of sectors including healthcare, education, government and technology while remaining under the radar. This blog aims to shed light on this threat group and to disrupt their operations through awareness of their malware families and operating methodologies. In essence, we want to get them <em>on</em> the radar.</p>
<p>During our research, we discovered that this threat group has developed and maintained the Vatet loader. This loader has evolved as this threat group has taken advantage of multiple open source tools by altering the original application to execute payloads such as PyXie and/or Cobalt Strike. Next, the threat group uses a tailored version of PyXie, which we call PyXie Lite, to conduct reconnaissance and to find and exfiltrate files that are likely sensitive to the victim organization. In a number of incidents we investigated, the actors established an initial foothold into the victim&#8217;s network through common banking trojans such as IcedID or <a href="https://unit42.paloaltonetworks.com/tag/trickbot/">Trickbot</a>. From there, they deployed Vatet, PyXie and Cobalt Strike before executing Defray777 ransomware entirely in memory. This results in encrypted files on local drives and file shares before exiting. Additionally, the ransomware leaves no evidence of execution except for the encrypted files and ransom notes. In regard to Defray777, the group behind this malware has also ported their ransomware from Windows to Linux, something that, before Defray777, has yet to be seen in the targeted ransomware space. Before this discovery, ransomware that had the ability to impact both Windows and Linux systems was limited to cross-functional ransomware written in Java or scripting languages such as Python. With the port to Linux, Defray777 ransomware has become the first ransomware variant to have standalone executables for Windows and Linux.</p>
<p>With three different malware families to cover, we realize there is a lot of content to digest. We have a lot of great details on each of these, but we also realize that you may be interested in one malware family over the others, or you may just prefer to choose your own adventure. If desired, use the links below to skip to the malware family that interests you most, or to get right to the IOCs that will get you hunting for, and detecting, this threat group in action.</p>
<p>Table of Contents</p>
<ul>
<li>First Up: Vatet Loader</li>
<li><a href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/2">Next Up: PyXie Lite</a></li>
<li><a href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/3">Last, but Not Least: Defray777</a></li>
<li><a href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/4">Linking Vatet, PyXie and Defray777</a></li>
<li><a href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/5">Indicators of Compromise (IOCs)</a></li>
</ul>
<h2><a id="post-109455-_4drsj28ju9ok"></a>First Up: Vatet Loader</h2>
<p>Vatet is a custom loader that executes XOR encoded shellcode from the local disk or a network share. The loaders are typically open source applications found on GitHub, or other repositories, that the actors modify to load their shellcode. In most cases, the payload winds up being Cobalt Strike beacons and/or stagers, but some of the more recent payloads have been an updated version of the PyXie RAT. Vatet is often a precursor to enterprise-wide ransomware attacks.</p>
<p><a href="https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/">Microsoft wrote about the Vatet loader in April 2020</a> and said the loader had been in use as early as November 2018 for the purpose of loading Cobalt Strike into memory for execution. This loader continues to be seen in the wild using multiple versions of open source applications to load shellcode including:</p>
<table style="width: 101.849%;">
<tbody>
<tr>
<td style="width: 78.97%;">Version</td>
<td style="width: 267.811%;">First Seen</td>
</tr>
<tr>
<td style="width: 78.97%;">Recompiled <a href="https://github.com/VincentJYZhang/tetris-game">Tetris game</a></td>
<td style="width: 267.811%;">2019-06-28</td>
</tr>
<tr>
<td style="width: 78.97%;">Recompiled <a href="https://github.com/wine-mirror/wine/tree/master/programs/notepad">Notepad</a></td>
<td style="width: 267.811%;">2020-05-03</td>
</tr>
<tr>
<td style="width: 78.97%;">Recompiled desktop customization app, <a href="https://github.com/rainmeter/rainmeter">Rainmeter</a></td>
<td style="width: 267.811%;">2020-06-24</td>
</tr>
<tr>
<td style="width: 78.97%;">Recompiled Notepad++</td>
<td style="width: 267.811%;">2020-09-24</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Table 1. Vatet versions. </em></p>
<p>In our research, we have seen Vatet samples with compile times as early as 2019, although this variant has implemented several variations since then.</p>
<p>In the earliest versions of Vatet that we analyzed, the malicious payload was loaded via a network share using a path with the following format: <span style="font-family: 'courier new', courier, monospace;">\\<strong>{IP}</strong>\<strong>{EPOCHTIME}</strong>\<strong>{PAYLOAD}</strong>.dat</span>. However, in the latest samples analyzed, the malicious payload was loaded locally from disk. Additionally, we have seen variations in the XOR keys used to decode the payload during execution time. Our research also determined that the Vatet loader has expanded its payload capabilities to load PyXie in addition to the previously seen Cobalt Strike beacons and stagers. Finally, the Vatet loaders we analyzed have evolved and begun taking steps to improve their anti-forensics capabilities by deleting malicious payloads after they have been loaded into memory for execution.</p>
<figure id="attachment_109460" aria-describedby="caption-attachment-109460" style="width: 876px" class="wp-caption aligncenter"><img class="wp-image-109460" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-14.png" alt="The Vatet execution flow stems from the Vatet loader, which can load PyXie Lite or Cobalt Strike and then Defray777" width="876" height="465" /><figcaption id="caption-attachment-109460" class="wp-caption-text">Figure 1. Vatet execution flow.</figcaption></figure>
<p>Lets take a deeper look at Vatet using a malicious version of Rainmeter.</p>
<h4><a id="post-109455-_75pitfxdps3w"></a><strong>Inner Workings of the Vatet Loader: A Rainmeter Review</strong></h4>
<p>Rainmeter is a desktop customization tool that allows users to customize their desktops through the use of skins. During a legitimate installation, Rainmeter creates an executable, <span style="font-family: 'courier new', courier, monospace;">rainmeter.exe</span>, and a corresponding DLL, <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span>. Under normal conditions, <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span> is responsible for reading configuration files and facilitating a customized desktop. Under the observed circumstances, a signed, legitimate version of <span style="font-family: 'courier new', courier, monospace;">rainmeter.exe</span> and a malicious version of <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span> could be simply copied onto the victim system, then used to load and execute a Cobalt Strike beacon in memory under the context of a signed, legitimate executable.</p>
<h4><a id="post-109455-_yg6gdl9chfsr"></a><strong>Taking a Look at the Static Properties</strong></h4>
<p>We first reviewed the suspicious <span style="font-family: 'courier new', courier, monospace;">rainmeter.exe</span> and <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span> files and compared them to versions that would be installed on a system through the official September 2019 release of the Rainmeter installer, which can be found on its <a href="https://github.com/rainmeter/rainmeter">public GitHub page</a>.</p>
<p>Reviewing <span style="font-family: 'courier new', courier, monospace;">rainmeter.exe</span> did not produce many interesting findings. Examining both executables in <a href="https://www.winitor.com/">PEStudio</a> confirmed that the sample recovered during a ransomware scenario was the same executable generated by the standard Rainmeter installer, based on the SHA256 hash. We also verified that both executables had the same valid digital signature.</p>
<figure id="attachment_109462" aria-describedby="caption-attachment-109462" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109462" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-15.png" alt="The screenshot shows an initial comparison of static properties of &quot;Rainmeter.exe.&quot; Both executables had the same valid digital signature. " width="900" height="304" /><figcaption id="caption-attachment-109462" class="wp-caption-text">Figure 2. Initial comparison of static properties of rainmeter.exe.</figcaption></figure>
<p>Comparing the <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span> samples provided more interesting findings. Initially, it was obvious that the two samples were not the same, since the hashes did not line up. The sizes of the files were significantly different from one another and the compile dates were also quite different. Additionally, there was some variability in the imports, exports, strings and other properties. Further, the suspected malicious DLL was not digitally signed and had additional sections not present in the legitimate Rainmeter DLL.</p>
<figure id="attachment_109464" aria-describedby="caption-attachment-109464" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109464" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-16.png" alt="Comparing the rainmeter.dll samples, as shown here, provided more interesting findings. The suspected malicious DLL was not digitally signed and had additional sections not present in the legitimate Rainmeter DLL. " width="900" height="310" /><figcaption id="caption-attachment-109464" class="wp-caption-text">Figure 3. Comparing the two versions of rainmeter.dll.</figcaption></figure>
<figure id="attachment_109466" aria-describedby="caption-attachment-109466" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109466" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-17.png" alt="This shows a closer view of the comparison of sections between rainmeter.dll samples. The suspect malicious DLL had additional sections not present in the legitimate Rainmeter DLL" width="900" height="382" /><figcaption id="caption-attachment-109466" class="wp-caption-text">Figure 4. Comparing sections between rainmeter.dll samples.</figcaption></figure>
<p>It is important to note that the <a href="https://github.com/rainmeter/rainmeter">code base for Rainmeter</a> is publicly available on GitHub under the GNU General Public License v2.0. This would have allowed the threat actor to openly review/modify the existing <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span> file contents and compile it into the suspected malicious DLL we saw during our investigation.</p>
<p>After completing these comparisons to confirm that the Rainmeter DLL was likely malicious, it was time for a deeper and more focused look at the samples using a debugger for dynamic analysis.</p>
<h4><a id="post-109455-_jwg560r37r5b"></a><strong>Dynamic Analysis of the Malicious Rainmeter Sample</strong></h4>
<p>Now that we had identified samples for deeper inspection, we stopped the comparisons to the legitimate Rainmeter application and focused on the analysis of the suspicious samples recovered. We placed the samples of <span style="font-family: 'courier new', courier, monospace;">rainmeter.exe</span> and <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span> recovered from the investigation into our analysis environment and began debugging Rainmeter. Shortly after starting analysis, <span style="font-family: 'courier new', courier, monospace;">rainmeter.exe</span> loaded <span style="font-family: 'courier new', courier, monospace;">rainmeter.dll</span> as expected, and subsequently called its ordinal 1 exported function. Continuing the execution, there were calls to <span style="font-family: 'courier new', courier, monospace;">CreateFileA</span>, where the sample was looking for the hardcoded path <span style="font-family: 'courier new', courier, monospace;">C:\Windows\help\options.dat</span>.</p>
<figure id="attachment_109468" aria-describedby="caption-attachment-109468" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109468" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-18.png" alt="With calls to CreateFileA, the sample was looking for the hardcoded path: C:\Windows\help\options.dat" width="900" height="50" /><figcaption id="caption-attachment-109468" class="wp-caption-text">Figure 5. Call to CreateFileA for a hardcoded path.</figcaption></figure>
<p>After the call to <span style="font-family: 'courier new', courier, monospace;">CreateFileA</span>, there is a comparison of the result of the call to <span style="font-family: 'courier new', courier, monospace;">CreateFileA</span> to <span style="font-family: 'courier new', courier, monospace;">FFFFFFFF</span> to determine if it has a valid handle to the file or not. If there is no valid handle, the program exits.</p>
<p>Originally it was not obvious that <span style="font-family: 'courier new', courier, monospace;">options.dat</span> was necessary for the analysis of the malicious Rainmeter sample as <span style="font-family: 'courier new', courier, monospace;">.dat</span> files are not part of the normal Rainmeter application. However, a version of <span style="font-family: 'courier new', courier, monospace;">options.dat</span> was recovered in order to continue analysis. Once the dat file was placed in the expected location, the program then allocated space on the heap and read the contents of <span style="font-family: 'courier new', courier, monospace;">options.dat</span> into memory. After the contents of <span style="font-family: 'courier new', courier, monospace;">options.dat</span> were read into memory, the sample performed a first-level decoding of the contents by XOR-ing the contents with the value <span style="font-family: 'courier new', courier, monospace;">FE</span>.</p>
<figure id="attachment_109470" aria-describedby="caption-attachment-109470" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109470" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-19.png" alt="After the contents of options.dat were read into memory, the sample performed a first-level decoding of the contents by XOR-ing the contents with the value FE. " width="900" height="259" /><figcaption id="caption-attachment-109470" class="wp-caption-text">Figure 6. Initial XOR decoding loop.</figcaption></figure>
<p>Once the first decoding routine is completed, the malicious Rainmeter application closes the handle to <span style="font-family: 'courier new', courier, monospace;">options.dat</span>. When the program closes the handle to <span style="font-family: 'courier new', courier, monospace;">options.dat</span>, it is removed from the file system. This is a built-in anti-analysis technique employed to hinder recovery of the <span style="font-family: 'courier new', courier, monospace;">.dat</span> file for analysis. At this point, the data read into the program was still a blob of unrecognizable code. However, at the end of the XOR decoding routine, there is a <span style="font-family: 'courier new', courier, monospace;">CALL EBX</span> instruction that transfers execution to the recently decoded data. Following <span style="font-family: 'courier new', courier, monospace;">EBX</span> in the disassembled view shows that this is valid code. At this stage of analysis, Rainmeter has decoded its <span style="font-family: 'courier new', courier, monospace;">options.dat</span> payload, loaded it into memory and executed it. Future analysis confirmed that this was the end of the Vatet loader routine, and execution was passed to the Cobalt Strike shellcode loader.</p>
<figure id="attachment_109472" aria-describedby="caption-attachment-109472" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109472" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-20.png" alt="At the end of the XOR decoding routine, a CALL EBX instruction transfers execution to the recently decoded data. This is valid code. Future analysis confirmed that this was the end of the Vatet loader routine. " width="900" height="149" /><figcaption id="caption-attachment-109472" class="wp-caption-text">Figure 7. Transfer of execution to valid code after XOR decoding.</figcaption></figure>
<p>By this point, we realized that the Vatet loading mechanism was completed, but we wanted to validate the identity of the final payload, so we pressed on. Further along in the execution, there is a second decoding routine where an additional dynamic XOR loop is used to decode and rewrite the contents of the executable code. If this routine looks familiar, its probably because you are noticing the Cobalt Strike decoding mechanism. This routine begins by obtaining a pointer to the first four bytes of the imported executable code and setting it as the starting XOR key. The code then executes a loop acting on four bytes at a time, XORing the imported code with the starting XOR key. Next, the loop writes the XORd value back into the data segment, followed by setting a new XOR key. The new XOR key is determined by XORing the current XOR key with the value decoded by the current key. Once this loop is finished, the sample then uses <span style="font-family: 'courier new', courier, monospace;">JMP ECX</span> to transfer execution to the recently decoded executable contents.</p>
<figure id="attachment_109474" aria-describedby="caption-attachment-109474" style="width: 830px" class="wp-caption aligncenter"><img class="wp-image-109474" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-21.png" alt="In a second decoding routine in the Vatet loader, an additional dynamic XOR loop is used to decode and rewrite the contents of the executable code. " width="830" height="835" /><figcaption id="caption-attachment-109474" class="wp-caption-text">Figure 8. Entering into the second decoding loop. Note the memory space in Dump 1.</figcaption></figure>
<figure id="attachment_109476" aria-describedby="caption-attachment-109476" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109476" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-22.png" alt="After the completion of the Vatet loader's second decoding routine, note the executable contents now decoded in Dump 2." width="900" height="759" /><figcaption id="caption-attachment-109476" class="wp-caption-text">Figure 9. After the completion of the second decoding routine, note the executable contents now decoded in Dump 2.</figcaption></figure>
<p>At this stage of analysis, we confirmed the content included in <span style="font-family: 'courier new', courier, monospace;">options.dat</span> was shellcode that was later decoded via a dynamic XOR routine to create executable code in Rainmeters process memory.</p>
<p>Now that we had the executable contents of the XORd executable code from <span style="font-family: 'courier new', courier, monospace;">options.dat</span> available in memory, we dumped the contents from the memory map section in <a href="https://x64dbg.com/#start">x64bdg</a> for additional analysis to determine this codes potential functionality.</p>
<p>Moving to our dumped sample of the executable code, we conducted an analysis of the strings to determine if there was anything obvious to correlate dynamic analysis findings. In doing this, we identified a reference to <span style="font-family: 'courier new', courier, monospace;">beacon.dll</span>, which is most often associated with the DLL version of Cobalt Strikes beacon. Additionally, loading the isolated PE into PeStudio showed the following references to an exported function <span style="font-family: 'courier new', courier, monospace;">_ReflectiveLoader@4</span>, which is a known exported function of Cobalt Strike.</p>
<figure id="attachment_109478" aria-describedby="caption-attachment-109478" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109478" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-23.png" alt="Loading the isolated PE into PeStudio showed these references to an exported function _ReflectiveLoader@4, which is a known exported function of Cobalt Strike. " width="900" height="617" /><figcaption id="caption-attachment-109478" class="wp-caption-text">Figure 10. Extracted PE analysis in PeStudio.</figcaption></figure>
<p>To confirm whether the extracted payload was a Cobalt Strike beacon or not, we utilized a Cobalt Strike beacon parser, which dumped the beacons decoded configuration.</p>
<figure id="attachment_109480" aria-describedby="caption-attachment-109480" style="width: 900px" class="wp-caption aligncenter"><img class="wp-image-109480" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/11/word-image-24.png" alt="Once decoded and confirmed, the Cobalt Strike beacon shows a typical implementation of Cobalt Strike's HTTPS beacon using malleable C2 profiles. " width="900" height="588" /><figcaption id="caption-attachment-109480" class="wp-caption-text">Figure 11. Cobalt Strike beacon configuration.</figcaption></figure>
<p>The confirmed Cobalt Strike beacon shows a typical implementation of Cobalt Strikes HTTPS beacon using malleable C2 profiles. Specifically, the <a href="https://raw.githubusercontent.com/rsmudge/Malleable-C2-Profiles/master/normal/amazon.profile">Amazon browsing traffic profile</a> created by harmjoy was used in this beacon.</p>
<p>Continue reading: <a href="https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/2">Next Up: &#8220;PyXie Lite&#8221;</a></p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<div class="ignite20promo">
    <div class="container">
    <div class="ignite20text">
        <div>
            <div class="orange-bar-sm"></div><br/>
        <span class="promo-heading">Secure Today,<br/>for a Better<br/>Tomorrow</span>
        </div>
        <div class="promo-subtext"><span>Join us at IGNITE20</span>
            <a href="https://ignitereg.paloaltonetworks.com/flow/paloaltonetworks/ignite20/regsc/login?source=unit42" onclick="return false;">
                <svg width="17" height="12" viewBox="0 0 17 12" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M1.41089 6L15.3143 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10.1006 1L15.3144 6L10.1006 11" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
        </div>
        </div>
    </div> 
</div>
<script type="text/javascript">
    $('.ignite20promo').click(function(){
        window.open("https://ignitereg.paloaltonetworks.com/flow/paloaltonetworks/ignite20/regsc/login?source=unit42", "_blank"); 
    });
</script>    
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","enable_video_popuping":"enable","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
