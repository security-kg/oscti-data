
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>New Python-Based Payload MechaFlounder Used by Chafer</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/new-python-based-payload-mechaflounder-used-by-chafer/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/new-python-based-payload-mechaflounder-used-by-chafer/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/new-python-based-payload-mechaflounder-used-by-chafer/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="New Python-Based Payload MechaFlounder Used by Chafer" />
<meta property="og:description" content="In November 2018 the Chafer threat group targeted a Turkish government entity reusing infrastructure that they used in campaigns reported earlier in 2018. Unit 42 has observed Chafer activity since 2016, however, Chafer has been active since at least 2015. This new secondary payload is Python-based and compiled into executable form using the PyInstaller utility. We’ve also identified code overlap with OilRig’s Clayside VBScript but at this time track Chafer and OilRig as separate threat groups. We have named this payload MechaFlounder for tracking purposes." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/new-python-based-payload-mechaflounder-used-by-chafer/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Chafer" />
<meta property="article:tag" content="MechaFlounder" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2019-03-04T14:00:56+00:00" />
<meta property="article:modified_time" content="2019-03-14T19:09:50+00:00" />
<meta property="og:updated_time" content="2019-03-14T19:09:50+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-2.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-2.png" />
<meta property="og:image:width" content="1158" />
<meta property="og:image:height" content="617" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="In November 2018 the Chafer threat group targeted a Turkish government entity reusing infrastructure that they used in campaigns reported earlier in 2018. Unit 42 has observed Chafer activity since 2016, however, Chafer has been active since at least 2015. This new secondary payload is Python-based and compiled into executable form using the PyInstaller utility. We’ve also identified code overlap with OilRig’s Clayside VBScript but at this time track Chafer and OilRig as separate threat groups. We have named this payload MechaFlounder for tracking purposes." />
<meta name="twitter:title" content="New Python-Based Payload MechaFlounder Used by Chafer" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-2.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; New Python-Based Payload MechaFlounder Used by Chafer Comments Feed" href="https://unit42.paloaltonetworks.com/new-python-based-payload-mechaflounder-used-by-chafer/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="8"/>
<meta property="og:views" content="30,206"/>
<meta property="og:date_created" content="March 4, 2019 at 6:00 AM"/>
<meta property="og:post_length" content="2256"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:author" content="Brittany Barbehenn"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/brittany-ash/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1-380x184.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"New Python-Based Payload MechaFlounder Used by Chafer","name":"New Python-Based Payload MechaFlounder Used by Chafer","description":"In November 2018 the Chafer threat group targeted a Turkish government entity reusing infrastructure that they used in campaigns reported earlier in 2018. Unit 42 has observed Chafer activity since 2016, however, Chafer has been active since at least 2015. This new secondary payload is Python-based and compiled into executable form using the PyInstaller utility. We\u2019ve also identified code overlap with OilRig\u2019s Clayside VBScript but at this time track Chafer and OilRig as separate threat groups. We have named this payload MechaFlounder for tracking purposes.","url":"https:\/\/unit42.paloaltonetworks.com\/new-python-based-payload-mechaflounder-used-by-chafer\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/new-python-based-payload-mechaflounder-used-by-chafer\/","datePublished":"March 4, 2019","articleBody":"In November 2018 the Chafer threat group targeted a Turkish government entity reusing infrastructure that they used in campaigns reported earlier in 2018 by Clearsky, specifically, the domain win10-update[.]com. While we lack visibility into the initial delivery mechanism of this attack, we did observe a secondary payload hosted on 185.177.59[.]70, the IP address to which this domain resolved at the time of the activity.\r\n\r\nUnit 42 has observed Chafer activity since 2016, however, Chafer has been active since at least 2015. This new secondary payload is Python-based and compiled into executable form using the PyInstaller utility. This is the first instance where Unit 42 has identified a Python-based payload used by these operators. We\u2019ve also identified code overlap with OilRig\u2019s Clayside VBScript but at this time track Chafer and OilRig as separate threat groups. We have named this payload MechaFlounder for tracking purposes and discuss details below.\r\nTurkish Government Targeting\r\nOur visibility into this Chafer activity involves the identification of a malicious executable \u00a0downloaded from the IP address 185.177.59[.]70. How the attackers are targeting victims and causing them to download this file are currently not known.\r\n\r\nThe file named \u2018lsass.exe\u2019 was downloaded from win10-update[.]com via an HTTP request. The win10-update[.]com domain has been noted in open source as an indicator associated with Chafer threat operations. The lsass.exe file downloaded from this domain is a previously unreported python-based payload that we are currently tracking as MechaFlounder. We believe Chafer uses MechaFlounder as a secondary payload that the group downloads from a first-stage payload to carry out its post-exploitation activities on the compromised host. Based on our telemetry, the first-stage payload was not observed in this activity.\r\n\r\nIn February 2018, IP address 134.119.217[.]87 resolved to win10-update[.]com and several other domains likely associated with Chafer activity. Of interest, the domain turkiyeburslari[.]tk, which mirrors the legitimate Turkish Scholarship government domain turkiyeburslari[.]gov[.]tr, also resolved to this IP and may likely have been used in other Chafer collection operations. The domains associated with this IP address are included within the Appendix and displayed in Figure 1 below.\r\n\r\n\r\nFigure 1. Infrastructure associated with 134.119.217[.]87\r\n\r\nThe MechaFlounder Payload\r\nThe python-based payload, \u2018lsass.exe\u2019 was retrieved from a command and control (C2) server via an HTTP request to the following URL:\r\n\r\nwin10-update[.]com\/update.php?req=&lt;redacted&gt;&amp;m=d\r\n\r\nThis payload, (SHA256: 0282b7705f13f9d9811b722f8d7ef8fef907bee2ef00bf8ec89df5e7d96d81ff), which we are tracking as MechaFlounder, was developed in Python and bundled as a portable executable using the PyInstaller tool. This secondary payload acts as a backdoor allowing the operator to upload and download files, as well as run additional commands and applications on the compromised system.\r\n\r\nMechaFlounder begins by entering a loop that will continuously attempt to communicate with its C2 server. The Trojan will use HTTP to send an outbound beacon to its C2 server that contains the user's account name and hostname in the URL. The code, seen in Figure 2, builds the URL by concatenating the username and hostname with two dashes \"--\" between the two strings. The code then creates the URL string by using the username and hostname string twice with the back-slash \"\\\" character between the two and by appending the string \"-sample.html\".\r\n\r\n\r\nFigure 2. Trojan code used to build anomalous HTTP request\r\nDuring this analysis, the code in Figure 2 generated anomalous HTTP requests for its beacons, as shown in Figure 3 below. One might notice that the GET request in Figure 3 does not start with a forward-slash \"\/\" character and includes a back-slash character \"\\\" in the URL. This causes a legitimate web server, such as nginx used in our test environment, to respond with a '400 Bad Request' error message. This may suggest that even though the code in Figure 2 uses the HTTPConnection class from the httplib module to generate the anomalous HTTP beacon, it is likely that the threat actors created a custom server to handle this C2 channel instead of relying on a standard web server.\r\n\r\nAdditionally, Figure 2 shows that the malware author used the variable name 'cmd' to build the string used for the HTTP method and path and checks the HTTP method portion of the string for the word 'exit'. We are unsure of the purpose of this check, as the HTTP method in this string would never be 'exit' and therefore would never be true. We believe this is an artifact likely derived from a previous version of the script that the author forgot to remove.\r\n\r\n\r\nFigure 3. Example HTTP request issued by Trojan in test environment\r\nIf the C2 server were to accept the beacon in Figure 3, it would respond with HTML that contains a command intended for the Trojan to parse and execute. The Trojan begins by converting the HTML in the response to text using the code seen in Figure 4 below. The HTML to text code in Figure 4 is available in several locations on the Internet, but it appears to have possibly originated from a discussion at Stack Overflow titled Extracting text from HTML file using Python, which may be where the malware author obtained this code.\r\n\r\n\r\nFigure 4. HTML to text code in Trojan possibly obtained from Stack Overflow discussion\r\nAfter converting the HTML to text, the Trojan discards the first 10 characters of the response and treats the remainder of the string as a command. The C2 can also provide the string \"yes \" in this command string, which instructs the Trojan to decode the command as a base16 encoded string with the \"yes \" substring removed. The Trojan subjects the command supplied by the C2 to a handler that determines the activities the Trojan will perform. Table 1 shows a list of commands available within the Trojan's command handler and the corresponding activities. The commands in the command handler provides the necessary functionality for Chafer to interact with the remote system.\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\nTerminate\r\nTerminates the connection\r\n\r\n\r\ndownload\r\nDownloads provided &lt;filename&gt; that it will obtain from http:\/\/&lt;c2 server&gt;\/&lt;filename&gt; and saves it to C:\\Users\\Public\\&lt;filename&gt;.\r\n\r\n\r\nruntime\r\nSets the sleep interval between beacons.\r\n\r\n\r\nupload\r\nUploads provided &lt;filename&gt; to http:\/\/&lt;c2 server&gt; via HTTP POST.\r\n\r\n\r\ncd\r\nChanges the current working directory\r\n\r\n\r\nempty\r\nDoes nothing, likely an Idle command.\r\n\r\n\r\n&lt;anything else&gt;\r\nAttempts to run the supplied data as a command on the command line.\r\n\r\n\r\n\r\nTable 1. Commands available in Trojan\u2019s command handler\r\n\r\nWe gained more insight into the custom C2 server application by analyzing the activities that MechaFlounder carries out if it receives the \u2018upload\u2019 command. To upload a specified file from the compromised system to the C2 server, the Trojan uses the Browser class in the mechanize module (partial basis of the MechaFlounder name) to submit the file to an HTML form on the C2 server. This suggests that in addition to being able to handle the anomalous HTTP GET requests previously mentioned, the custom C2 server application must also be able to:\r\n\r\n \tServe HTML that contains a form to receive uploaded files,\r\n \tHandle legitimate HTTP POST requests generated by the mechanize module, and\r\n \tSave files uploaded with the HTTP POST request.\r\n\r\nAfter carrying out the activities for the command, the Trojan will encode the results or output message of the command using the 'base64.b16encode' method. Each command has an output message for both a successful and failed execution of the command with the exception of \u2018empty\u2019 and \u2018terminate\u2019. Table 2 below shows the success and failure messages associated with each command.\r\n\r\n\r\n\r\nCommand\r\nMessage type\r\nOutput message structure\r\n\r\n\r\ndownload\r\nSuccess\r\n&lt;username&gt;--&lt;hostname&gt;||download &lt;filename&gt;**download success\\n\r\n\r\n\r\nFail\r\n&lt;exception message&gt;||&lt;username&gt;--&lt;hostname&gt;**download failed, download &lt;filename&gt; \\n\r\n\r\n\r\nupload\r\nSuccess\r\n&lt;username&gt;--&lt;hostname&gt;||upload &lt;filename&gt;**upload success \\n\r\n\r\n\r\nFail (no file)\r\n&lt;username&gt;--&lt;hostname &gt;||&lt;command issued&gt;**no such file\\n\r\n\r\n\r\nFail (exception)\r\n&lt;exception message&gt;||&lt;username&gt;--&lt;hostname&gt;**upload failed,upload &lt;filename&gt; \\n\r\n\r\n\r\nruntime\r\nSuccess\r\n&lt;interval&gt;||&lt;username&gt;--&lt;hostname&gt;**runtime changed to &lt;command issued&gt;\r\n\r\n\r\nFail\r\n&lt;username&gt;--&lt;hostname&gt;||&lt;command issued&gt;**runtime change failed because of large mount\r\n\r\n\r\ncd\r\nSuccess\r\n&lt;username&gt;--&lt;hostname&gt;||&lt;command issued&gt;**directory changed success to &lt;directory&gt;\r\n\r\n\r\nFail\r\n&lt;username&gt;--&lt;hostname&gt;||&lt;command issued&gt;**Couldn\"t change directory\r\n\r\n\r\n&lt;anything else&gt; (command execution)\r\nSuccess\r\n&lt;username&gt;--&lt;hostname&gt;||&lt;command issued&gt;**&lt;command stdout&gt;\r\n\r\n\r\nFail\r\n&lt;username&gt;--&lt;hostname&gt;||&lt;command issued&gt;**&lt;command stderr&gt;\r\n\r\n\r\n\r\nTable 2. Success and failure messages associated with commands\r\n\r\nUnlike the initial beacon that uses the anomalous HTTP GET request, the Trojan will send the encoded results to the C2 server using the same socket as the initial HTTP beacon. The use of the same socket and the anomalous portions of the HTTP beacon further suggests that the threat actor likely created a custom C2 server to handle this network traffic.\r\n\r\nTo show these network communications, we patched the Trojan to issue beacons that use legitimate HTTP GET requests that the HTTP server (nginx) in our test environment could support. The patches involved changing the paths within the HTTP request, specifically setting the path to start with a forward-slash \u201c\/\u201d and have the forward-slash \u201c\/\u201d instead of a back-splash \u201c\\\u201d within the URL path itself. In our test environment, we added the string \u201c0123456789runtime 5\u201d to the file \u2018rob--rob-virtual-machine-service.html\u2019 in the \u2018rob--rob-virtual-machine\u2019 folder.\r\n\r\nWhen the Trojan issues the beacon, the HTTP server responds with contents of the \u2018rob--rob-virtual-machine-service.html\u2019 file, which effectively issues a command to the Trojan. The Trojan responds to the command \u2018runtime 5\u2019 with the message \"5||rob--rob-virtual-machine**runtime changed to runtime 5\" that it encodes in base16. It then sends this to the C2 server without any HTTP headers using the same socket as the initial HTTP request.\r\n\r\nFigure 5 shows the TCP session showing the initial beacon sent from the patched Trojan, the HTTP server responding with a command, and the Trojan responding to the command all in the same TCP session.\r\n\r\n\r\nFigure 5. Single TCP Session used by the Trojan to receive commands and send command results to the C2\r\n\r\nAnd one more thing...\r\nIf you think you\u2019ve seen the \u201c&amp;m=d\u201d parameter before, you\u2019d be correct. The \u201c&amp;m=d\u201d parameter seen in the initial download URL of the MechaFlounder payload appears in many URLs related to both Chafer and OilRig threat groups. This parameter has been seen in VBScript downloader payloads installed by delivery documents associated with both Oilrig and Chafer. We have also seen this parameter used in URLs generated by Chafer\u2019s AutoIT payload. The VBScript and AutoIT payloads also share common variable names and the same overall functionality, which suggests there may be some code sharing occurring between the two threat groups. \u00a0Figure 6 below shows a VBScript run by an OilRig delivery document (SHA256: 1b2fee00d28782076178a63e669d2306c37ba0c417708d4dc1f751765c3f94e1) on the left compared to a Chafer AutoIT script (SHA256: 332fab21cb0f2f50774fccf94fc7ae905a21b37fe66010dcef6b71c140bb7fa1) on the right, which have colored boxes surrounding code overlaps.\r\n\r\nUnfortunately, we are unable to ascertain the specifics between the code sharing between OilRig and Chafer. At this time, we are not combining the two threat groups together based on these code overlaps.\r\n\r\n\r\nFigure 6. Oilrig Clayside VBS | Chafer AutoIT\r\n\r\nConclusion\r\nThe Chafer threat group has been active since at least 2015 focused on both private and public sector entities within the Middle East. Unit 42 has specifically observed the targeting of Turkish government entities since at least 2016; however, this is the first instance where Unit 42 has observed Chafer using a Python-based payload. This payload, now known as MechaFlounder was created by Chafer using a combination of actor developed code and code snippets freely available online in development communities. The MechaFlounder Trojan contains enough functionality for the Chafer actors to carry out the necessary activities needed to accomplish their goals, specifically by supporting file upload and download, as well as command execution functionality.\r\n\r\nThe overlap in Oilrig\u2019s Clayside VBScript and Chafer\u2019s AutoIT payloads does not come as a complete surprise. Oilrig and Chafer have for quite some time appeared very similar operationally and potentially having access to the same code or resources for payload development makes sense. Unit 42 has taken reference to the various overlaps in the two sets of activities and continues to track these operations separately.\r\n\r\nPalo Alto Networks customers are protected against this threat in the following ways:\r\n\r\n \tWildFire detects MechaFlounder with a malicious verdict\r\n \tDomains identified as command and control servers are flagged as malicious\r\n \tAutoFocus tags:\u00a0https:\/\/autofocus.paloaltonetworks.com\/#\/tag\/Unit42.Mechaflounder\r\n\r\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit cyberthreatalliance.org.\r\nAppendix\r\nMechaFlounder Sample\r\nlsass.exe\r\n\r\n0282b7705f13f9d9811b722f8d7ef8fef907bee2ef00bf8ec89df5e7d96d81ff\r\nInfrastructure referenced in this report\r\n\r\n \twin10-update[.]com\r\n \t185.177.59[.]70\r\n \t134.119.217[.]87\r\n \twin7-update[.]com\r\n \tturkiyeburslari[.]tk\r\n \txn--mgbfv9eh74d[.]com (\u062a\u0644\u06af\u0631\u0627\u0645[.]com)\r\n \tytb[.]services\r\n \teseses[.]tk\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2019\/03\/MechaFlounder-2-150x150.png","width":150,"height":150},"author":[{"@type":"Person","name":"Robert Falcone"},{"@type":"Person","name":"Brittany Barbehenn"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"96367","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=96367' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-python-based-payload-mechaflounder-used-by-chafer%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-python-based-payload-mechaflounder-used-by-chafer%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-96367 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">New Python-Based Payload MechaFlounder Used by Chafer</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-96367 entry-meta">
			
			
			<span class="post-views-count">30,206</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'96367','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-python-based-payload-mechaflounder-used-by-chafer%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-python-based-payload-mechaflounder-used-by-chafer%2F+-+New+Python-Based+Payload+MechaFlounder+Used+by+Chafer" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-python-based-payload-mechaflounder-used-by-chafer%2F&title=New+Python-Based+Payload+MechaFlounder+Used+by+Chafer&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/new-python-based-payload-mechaflounder-used-by-chafer/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a> and <a href="https://unit42.paloaltonetworks.com/author/brittany-ash/" title="Posts by Brittany Barbehenn" class="author url fn" rel="author">Brittany Barbehenn</a>        </p>
        <p><time datetime="2019-03-04T14:00:56+00:00">March 4, 2019 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/chafer/" rel="tag">Chafer</a>, <a href="https://unit42.paloaltonetworks.com/tag/mechaflounder/" rel="tag">MechaFlounder</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="480" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1-900x480.png" class="attachment-single size-single" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1-900x480.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1-300x160.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1-768x409.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1-1024x546.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1-370x197.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/MechaFlounder-1.png 1158w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/new-python-based-payload-mechaflounder-used-by-chafer/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>In November 2018 the <a href="https://www.symantec.com/blogs/threat-intelligence/chafer-latest-attacks-reveal-heightened-ambitions" target="_blank" rel="noopener">Chafer</a> threat group targeted a Turkish government entity reusing infrastructure that they used in campaigns reported earlier in 2018 by <a href="//twitter.com/clearskysec/status/976170940722708480" target="_blank" rel="noopener">Clearsky</a>, specifically, the domain win10-update[.]com. While we lack visibility into the initial delivery mechanism of this attack, we did observe a secondary payload hosted on 185.177.59[.]70, the IP address to which this domain resolved at the time of the activity.</p>
<p>Unit 42 has observed Chafer activity since 2016, however, Chafer has been active since at least <a href="https://www.symantec.com/connect/blogs/iran-based-attackers-use-back-door-threats-spy-middle-eastern-targets" target="_blank" rel="noopener">2015</a>. This new secondary payload is Python-based and compiled into executable form using the PyInstaller utility. This is the first instance where Unit 42 has identified a Python-based payload used by these operators. We’ve also identified code overlap with OilRig’s Clayside VBScript but at this time track Chafer and OilRig as separate threat groups. We have named this payload MechaFlounder for tracking purposes and discuss details below.</p>
<h2>Turkish Government Targeting</h2>
<p>Our visibility into this Chafer activity involves the identification of a malicious executable  downloaded from the IP address 185.177.59[.]70. How the attackers are targeting victims and causing them to download this file are currently not known.</p>
<p>The file named ‘lsass.exe’ was downloaded from win10-update[.]com via an HTTP request. The win10-update[.]com domain has been noted in <a href="https://twitter.com/clearskysec/status/976170940722708480" target="_blank" rel="noopener">open source</a> as an indicator associated with Chafer threat operations. The lsass.exe file downloaded from this domain is a previously unreported python-based payload that we are currently tracking as MechaFlounder. We believe Chafer uses MechaFlounder as a secondary payload that the group downloads from a first-stage payload to carry out its post-exploitation activities on the compromised host. Based on our telemetry, the first-stage payload was not observed in this activity.</p>
<p>In February 2018, IP address 134.119.217[.]87 resolved to win10-update[.]com and several other domains likely associated with Chafer activity. Of interest, the domain turkiyeburslari[.]tk, which mirrors the legitimate Turkish Scholarship government domain turkiyeburslari[.]gov[.]tr, also resolved to this IP and may likely have been used in other Chafer collection operations. The domains associated with this IP address are included within the Appendix and displayed in Figure 1 below.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1.-Infrastructure-associated-with-134.119.217.87.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1.-Infrastructure-associated-with-134.119.217.87.png" alt="" width="796" height="683" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1.-Infrastructure-associated-with-134.119.217.87.png 796w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1.-Infrastructure-associated-with-134.119.217.87-300x257.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1.-Infrastructure-associated-with-134.119.217.87-768x659.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-1.-Infrastructure-associated-with-134.119.217.87-370x317.png 370w" sizes="(max-width: 796px) 100vw, 796px" /></a></p>
<p style="text-align: center;">Figure 1. Infrastructure associated with 134.119.217[.]87</p>
<h2>The MechaFlounder Payload</h2>
<p>The python-based payload, ‘lsass.exe’ was retrieved from a command and control (C2) server via an HTTP request to the following URL:</p>
<p><span style="font-family: 'courier new', courier, monospace;">win10-update[.]com/update.php?req=&lt;redacted&gt;&amp;m=d</span></p>
<p>This payload, (SHA256: 0282b7705f13f9d9811b722f8d7ef8fef907bee2ef00bf8ec89df5e7d96d81ff), which we are tracking as MechaFlounder, was developed in Python and bundled as a portable executable using the PyInstaller tool. This secondary payload acts as a backdoor allowing the operator to upload and download files, as well as run additional commands and applications on the compromised system.</p>
<p>MechaFlounder begins by entering a loop that will continuously attempt to communicate with its C2 server. The Trojan will use HTTP to send an outbound beacon to its C2 server that contains the user&#8217;s account name and hostname in the URL. The code, seen in Figure 2, builds the URL by concatenating the username and hostname with two dashes &#8220;&#8211;&#8221; between the two strings. The code then creates the URL string by using the username and hostname string twice with the back-slash &#8220;\&#8221; character between the two and by appending the string &#8220;-sample.html&#8221;.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2.-Trojan-code-used-to-build-anomalous-HTTP-request.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96369" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2.-Trojan-code-used-to-build-anomalous-HTTP-request.png" alt="" width="527" height="115" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2.-Trojan-code-used-to-build-anomalous-HTTP-request.png 527w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2.-Trojan-code-used-to-build-anomalous-HTTP-request-300x65.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-2.-Trojan-code-used-to-build-anomalous-HTTP-request-370x81.png 370w" sizes="(max-width: 527px) 100vw, 527px" /></a></p>
<p style="text-align: center;">Figure 2. Trojan code used to build anomalous HTTP request</p>
<p>During this analysis, the code in Figure 2 generated anomalous HTTP requests for its beacons, as shown in Figure 3 below. One might notice that the GET request in Figure 3 does not start with a forward-slash &#8220;/&#8221; character and includes a back-slash character &#8220;\&#8221; in the URL. This causes a legitimate web server, such as nginx used in our test environment, to respond with a &#8216;400 Bad Request&#8217; error message. This may suggest that even though the code in Figure 2 uses the HTTPConnection class from the httplib module to generate the anomalous HTTP beacon, it is likely that the threat actors created a custom server to handle this C2 channel instead of relying on a standard web server.</p>
<p>Additionally, Figure 2 shows that the malware author used the variable name &#8216;cmd&#8217; to build the string used for the HTTP method and path and checks the HTTP method portion of the string for the word &#8216;exit&#8217;. We are unsure of the purpose of this check, as the HTTP method in this string would never be &#8216;exit&#8217; and therefore would never be true. We believe this is an artifact likely derived from a previous version of the script that the author forgot to remove.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-3.-Example-HTTP-request-issued-by-Trojan-in-test-environment.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96370" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-3.-Example-HTTP-request-issued-by-Trojan-in-test-environment.png" alt="" width="623" height="201" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-3.-Example-HTTP-request-issued-by-Trojan-in-test-environment.png 623w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-3.-Example-HTTP-request-issued-by-Trojan-in-test-environment-300x97.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-3.-Example-HTTP-request-issued-by-Trojan-in-test-environment-370x119.png 370w" sizes="(max-width: 623px) 100vw, 623px" /></a></p>
<p style="text-align: center;">Figure 3. Example HTTP request issued by Trojan in test environment</p>
<p>If the C2 server were to accept the beacon in Figure 3, it would respond with HTML that contains a command intended for the Trojan to parse and execute. The Trojan begins by converting the HTML in the response to text using the code seen in Figure 4 below. The HTML to text code in Figure 4 is available in several locations on the Internet, but it appears to have possibly originated from a discussion at Stack Overflow titled <a href="https://stackoverflow.com/a/3987802" target="_blank" rel="noopener">Extracting text from HTML file using Python</a>, which may be where the malware author obtained this code.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-4.-HTML-to-text-code-in-Trojan-possibly-obtained-from-Stack-Overflow-discussion.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96371" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-4.-HTML-to-text-code-in-Trojan-possibly-obtained-from-Stack-Overflow-discussion.png" alt="" width="344" height="514" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-4.-HTML-to-text-code-in-Trojan-possibly-obtained-from-Stack-Overflow-discussion.png 344w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-4.-HTML-to-text-code-in-Trojan-possibly-obtained-from-Stack-Overflow-discussion-201x300.png 201w" sizes="(max-width: 344px) 100vw, 344px" /></a></p>
<p style="text-align: center;">Figure 4. HTML to text code in Trojan possibly obtained from Stack Overflow discussion</p>
<p>After converting the HTML to text, the Trojan discards the first 10 characters of the response and treats the remainder of the string as a command. The C2 can also provide the string &#8220;yes &#8221; in this command string, which instructs the Trojan to decode the command as a base16 encoded string with the &#8220;yes &#8221; substring removed. The Trojan subjects the command supplied by the C2 to a handler that determines the activities the Trojan will perform. Table 1 shows a list of commands available within the Trojan&#8217;s command handler and the corresponding activities. The commands in the command handler provides the necessary functionality for Chafer to interact with the remote system.</p>
<table>
<tbody>
<tr>
<td width="312"><strong>Command</strong></td>
<td width="312"><strong>Description</strong></td>
</tr>
<tr>
<td width="312">Terminate</td>
<td width="312">Terminates the connection</td>
</tr>
<tr>
<td width="312">download</td>
<td width="312">Downloads provided &lt;filename&gt; that it will obtain from http://&lt;c2 server&gt;/&lt;filename&gt; and saves it to C:\Users\Public\&lt;filename&gt;.</td>
</tr>
<tr>
<td width="312">runtime</td>
<td width="312">Sets the sleep interval between beacons.</td>
</tr>
<tr>
<td width="312">upload</td>
<td width="312">Uploads provided &lt;filename&gt; to http://&lt;c2 server&gt; via HTTP POST.</td>
</tr>
<tr>
<td width="312">cd</td>
<td width="312">Changes the current working directory</td>
</tr>
<tr>
<td width="312">empty</td>
<td width="312">Does nothing, likely an Idle command.</td>
</tr>
<tr>
<td width="312">&lt;anything else&gt;</td>
<td width="312">Attempts to run the supplied data as a command on the command line.</td>
</tr>
</tbody>
</table>
<p><em>Table 1. Commands available in Trojan’s command handler</em></p>
<p>We gained more insight into the custom C2 server application by analyzing the activities that MechaFlounder carries out if it receives the ‘upload’ command. To upload a specified file from the compromised system to the C2 server, the Trojan uses the Browser class in the mechanize module (partial basis of the MechaFlounder name) to submit the file to an HTML form on the C2 server. This suggests that in addition to being able to handle the anomalous HTTP GET requests previously mentioned, the custom C2 server application must also be able to:</p>
<ol>
<li>Serve HTML that contains a form to receive uploaded files,</li>
<li>Handle legitimate HTTP POST requests generated by the mechanize module, and</li>
<li>Save files uploaded with the HTTP POST request.</li>
</ol>
<p>After carrying out the activities for the command, the Trojan will encode the results or output message of the command using the &#8216;base64.b16encode&#8217; method. Each command has an output message for both a successful and failed execution of the command with the exception of ‘empty’ and ‘terminate’. Table 2 below shows the success and failure messages associated with each command.</p>
<table>
<tbody>
<tr>
<td width="204"><strong>Command</strong></td>
<td width="164"><strong>Message type</strong></td>
<td width="255"><strong>Output message structure</strong></td>
</tr>
<tr>
<td rowspan="2" width="204">download</td>
<td width="164">Success</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname&gt;||download &lt;filename&gt;**download success\n</td>
</tr>
<tr>
<td width="164">Fail</td>
<td width="255">&lt;exception message&gt;||&lt;username&gt;&#8211;&lt;hostname&gt;**download failed, download &lt;filename&gt; \n</td>
</tr>
<tr>
<td rowspan="3" width="204">upload</td>
<td width="164">Success</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname&gt;||upload &lt;filename&gt;**upload success \n</td>
</tr>
<tr>
<td width="164">Fail (no file)</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname &gt;||&lt;command issued&gt;**no such file\n</td>
</tr>
<tr>
<td width="164">Fail (exception)</td>
<td width="255">&lt;exception message&gt;||&lt;username&gt;&#8211;&lt;hostname&gt;**upload failed,upload &lt;filename&gt; \n</td>
</tr>
<tr>
<td rowspan="2" width="204">runtime</td>
<td width="164">Success</td>
<td width="255">&lt;interval&gt;||&lt;username&gt;&#8211;&lt;hostname&gt;**runtime changed to &lt;command issued&gt;</td>
</tr>
<tr>
<td width="164">Fail</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname&gt;||&lt;command issued&gt;**runtime change failed because of large mount</td>
</tr>
<tr>
<td rowspan="2" width="204">cd</td>
<td width="164">Success</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname&gt;||&lt;command issued&gt;**directory changed success to &lt;directory&gt;</td>
</tr>
<tr>
<td width="164">Fail</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname&gt;||&lt;command issued&gt;**Couldn&#8221;t change directory</td>
</tr>
<tr>
<td rowspan="2" width="204">&lt;anything else&gt; (command execution)</td>
<td width="164">Success</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname&gt;||&lt;command issued&gt;**&lt;command stdout&gt;</td>
</tr>
<tr>
<td width="164">Fail</td>
<td width="255">&lt;username&gt;&#8211;&lt;hostname&gt;||&lt;command issued&gt;**&lt;command stderr&gt;</td>
</tr>
</tbody>
</table>
<p>Table 2. Success and failure messages associated with commands</p>
<p>Unlike the initial beacon that uses the anomalous HTTP GET request, the Trojan will send the encoded results to the C2 server using the same socket as the initial HTTP beacon. The use of the same socket and the anomalous portions of the HTTP beacon further suggests that the threat actor likely created a custom C2 server to handle this network traffic.</p>
<p>To show these network communications, we patched the Trojan to issue beacons that use legitimate HTTP GET requests that the HTTP server (nginx) in our test environment could support. The patches involved changing the paths within the HTTP request, specifically setting the path to start with a forward-slash “/” and have the forward-slash “/” instead of a back-splash “\” within the URL path itself. In our test environment, we added the string “0123456789runtime 5” to the file ‘rob&#8211;rob-virtual-machine-service.html’ in the ‘rob&#8211;rob-virtual-machine’ folder.</p>
<p>When the Trojan issues the beacon, the HTTP server responds with contents of the ‘rob&#8211;rob-virtual-machine-service.html’ file, which effectively issues a command to the Trojan. The Trojan responds to the command ‘runtime 5’ with the message &#8220;5||rob&#8211;rob-virtual-machine**runtime changed to runtime 5&#8221; that it encodes in base16. It then sends this to the C2 server without any HTTP headers using the same socket as the initial HTTP request.</p>
<p>Figure 5 shows the TCP session showing the initial beacon sent from the patched Trojan, the HTTP server responding with a command, and the Trojan responding to the command all in the same TCP session.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-5.-Single-TCP-Session-used-by-the-Trojan-to-receive-commands-and-send-command-results-to-the-C2.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96372" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-5.-Single-TCP-Session-used-by-the-Trojan-to-receive-commands-and-send-command-results-to-the-C2.png" alt="" width="736" height="429" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-5.-Single-TCP-Session-used-by-the-Trojan-to-receive-commands-and-send-command-results-to-the-C2.png 736w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-5.-Single-TCP-Session-used-by-the-Trojan-to-receive-commands-and-send-command-results-to-the-C2-300x175.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-5.-Single-TCP-Session-used-by-the-Trojan-to-receive-commands-and-send-command-results-to-the-C2-370x216.png 370w" sizes="(max-width: 736px) 100vw, 736px" /></a></p>
<p style="text-align: center;">Figure 5. Single TCP Session used by the Trojan to receive commands and send command results to the C2</p>
<h2>And one more thing&#8230;</h2>
<p>If you think you’ve seen the “&amp;m=d” parameter before, you’d be correct. The “&amp;m=d” parameter seen in the initial download URL of the MechaFlounder payload appears in many URLs related to both Chafer and OilRig threat groups. This parameter has been seen in VBScript downloader payloads installed by delivery documents associated with both Oilrig and Chafer. We have also seen this parameter used in URLs generated by Chafer’s AutoIT payload. The VBScript and AutoIT payloads also share common variable names and the same overall functionality, which suggests there may be some code sharing occurring between the two threat groups.  Figure 6 below shows a VBScript run by an OilRig delivery document (SHA256: 1b2fee00d28782076178a63e669d2306c37ba0c417708d4dc1f751765c3f94e1) on the left compared to a Chafer AutoIT script (SHA256: 332fab21cb0f2f50774fccf94fc7ae905a21b37fe66010dcef6b71c140bb7fa1) on the right, which have colored boxes surrounding code overlaps.</p>
<p>Unfortunately, we are unable to ascertain the specifics between the code sharing between OilRig and Chafer. At this time, we are not combining the two threat groups together based on these code overlaps.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-96373" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT.png" alt="" width="1099" height="371" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT.png 1099w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT-900x304.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT-300x101.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT-768x259.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT-1024x346.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2019/03/Figure-6.-Oilrig-Clayside-VBS-Chafer-AutoIT-370x125.png 370w" sizes="(max-width: 1099px) 100vw, 1099px" /></a></p>
<p style="text-align: center;"><em>Figure 6. Oilrig Clayside VBS | Chafer AutoIT</em></p>
<h2>Conclusion</h2>
<p>The Chafer threat group has been active since at least 2015 focused on both private and public sector entities within the Middle East. Unit 42 has specifically observed the targeting of Turkish government entities since at least 2016; however, this is the first instance where Unit 42 has observed Chafer using a Python-based payload. This payload, now known as MechaFlounder was created by Chafer using a combination of actor developed code and code snippets freely available online in development communities. The MechaFlounder Trojan contains enough functionality for the Chafer actors to carry out the necessary activities needed to accomplish their goals, specifically by supporting file upload and download, as well as command execution functionality.</p>
<p>The overlap in Oilrig’s Clayside VBScript and Chafer’s AutoIT payloads does not come as a complete surprise. Oilrig and Chafer have for quite some time appeared very similar operationally and potentially having access to the same code or resources for payload development makes sense. Unit 42 has taken reference to the various overlaps in the two sets of activities and continues to track these operations separately.</p>
<p>Palo Alto Networks customers are protected against this threat in the following ways:</p>
<ul>
<li>WildFire detects MechaFlounder with a malicious verdict</li>
<li>Domains identified as command and control servers are flagged as malicious</li>
<li>AutoFocus tags: <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Mechaflounder" target="_blank" rel="noopener">https://autofocus.paloaltonetworks.com/#/tag/Unit42.Mechaflounder</a></li>
</ul>
<p>Palo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit cyberthreatalliance.org.</p>
<h2>Appendix</h2>
<h3>MechaFlounder Sample</h3>
<p><span style="font-family: 'courier new', courier, monospace;">lsass.exe</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">0282b7705f13f9d9811b722f8d7ef8fef907bee2ef00bf8ec89df5e7d96d81ff</span></p>
<h3>Infrastructure referenced in this report</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">win10-update[.]com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">185.177.59[.]70</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">134.119.217[.]87</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">win7-update[.]com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">turkiyeburslari[.]tk</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">xn--mgbfv9eh74d[.]com (تلگرام[.]com)</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">ytb[.]services</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">eseses[.]tk</span></li>
</ul>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
