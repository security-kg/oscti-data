
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>A Look Into Fysbis: Sofacy’s Linux Backdoor</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/a-look-into-fysbis-sofacys-linux-backdoor/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 takes a look into Fysbis: Sofacy’s Linux backdoor."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/a-look-into-fysbis-sofacys-linux-backdoor/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="A Look Into Fysbis: Sofacy’s Linux Backdoor" />
<meta property="og:description" content="Unit 42 takes a look into Fysbis: Sofacy’s Linux backdoor." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/a-look-into-fysbis-sofacys-linux-backdoor/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Fysbis" />
<meta property="article:tag" content="Linux" />
<meta property="article:tag" content="Sofacy" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2016-02-12T13:00:10+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:05:08+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:05:08+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy-500x172.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 takes a look into Fysbis: Sofacy’s Linux backdoor." />
<meta name="twitter:title" content="A Look Into Fysbis: Sofacy’s Linux Backdoor" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy-500x172.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; A Look Into Fysbis: Sofacy’s Linux Backdoor Comments Feed" href="https://unit42.paloaltonetworks.com/a-look-into-fysbis-sofacys-linux-backdoor/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="8"/>
<meta property="og:views" content="19,875"/>
<meta property="og:date_created" content="February 12, 2016 at 3:00 PM"/>
<meta property="og:post_length" content="1994"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Bryan Lee"/>
<meta property="og:author" content="Rob Downs"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bryanlee/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/rob-downs/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"A Look Into Fysbis: Sofacy\u2019s Linux Backdoor","name":"A Look Into Fysbis: Sofacy\u2019s Linux Backdoor","description":"Introduction The Sofacy group, also known as APT28 and Sednit, is a fairly well known cyber espionage group believed to have ties to Russia. Their targets have spanned all across the world, with a focus on government, defense organizations and various Eastern European governments. There have been numerous reports on their activities, to the extent...","url":"https:\/\/unit42.paloaltonetworks.com\/a-look-into-fysbis-sofacys-linux-backdoor\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/a-look-into-fysbis-sofacys-linux-backdoor\/","datePublished":"February 12, 2016","articleBody":"Introduction\nThe Sofacy group, also known as APT28 and Sednit, is a fairly well known cyber espionage group believed to have ties to Russia. Their targets have spanned all across the world, with a focus on government, defense organizations and various Eastern European governments. There have been numerous reports on their activities, to the extent that a Wikipedia entry has even been created for them.\n\nFrom these reports, we know that the group uses an abundance of tools and tactics, ranging across zero-day exploits targeting common applications such as Java or Microsoft Office, heavy use of spear-phishing attacks, compromising legitimate websites to stage watering-hole attacks, and targeting over a variety of operating systems \u2013 Windows, OSX, Linux, even mobile iOS.\n\nThe Linux malware Fysbis is a preferred tool of Sofacy, and though it is not particularly sophisticated, Linux security in general is still a maturing area, especially in regards to malware. In short, it is entirely plausible that this tool has contributed to the success of associated attacks by this group. This blog post focuses specifically on this Linux tool preferred by Sofacy and describes considerations and implications when it comes to Linux malware.\nMalware Assessment\nFysbis is a modular Linux trojan \/ backdoor that implements plug-in and controller modules as distinct classes. For reference, some vendors categorize this malware under the Sednit attacker group naming designation. This malware includes both 32-bit and 64-bit versions of Executable and Linking Format (ELF) binaries. Additionally, Fysbis can install itself to a victim system with or without root privileges. This increases the options available to an adversary when it comes to selecting accounts for installation.\n\nSummary information for the three binaries we analyzed follows:\n\n&nbsp;\n\n\n\nMD5\n364ff454dcf00420cff13a57bcb78467\n\n\nSHA-256\n8bca0031f3b691421cb15f9c6e71ce19335\n5d2d8cf2b190438b6962761d0c6bb\n\n\nssdeep\n3072:n+1R4tREtGN4qyGCXdHPYK9l0H786\nO26BmMAwyWMn\/qwwiHNl:n+1R43QcIL\nXdF0w6IBmMAwwCwwi\n\n\nSize\n141.2 KB (144560 bytes)\n\n\nType\nELF 64-bit (stripped)\n\n\nInstall as root\n\/bin\/rsyncd\n\n\nRoot install desc\nsynchronize and backup service\n\n\nInstall as non-root\n~\/.config\/dbus-notifier\/dbus-inotifier\n\n\nNon-root install desc\nsystem service d-bus notifier\n\n\nC2\nazureon-line[.]com (TCP\/80)\n\n\nUsage Timeframe\nLate 2014\n\n\n\nTable 1: Sample 1 - Late 2014 Sofacy 64-bit Fysbis\n\n\n\n\n\n\nMD5\n075b6695ab63f36af65f7ffd45cccd39\n\n\nSHA-256\n02c7cf55fd5c5809ce2dce56085ba43795f2\n480423a4256537bfdfda0df85592\n\n\nssdeep\n3072:9ZAxHANuat3WWFY9nqjwbuZf454U\nNqRpROIDLHaSeWb3LGmPTrIW33HxIajF:\n9ZAxHANJAvbuZf454UN+rv eQLZPTrV3Z\n\n\nSize\n175.9 KB (180148 bytes)\n\n\nType\nELF 32-bit (stripped)\n\n\nInstall as root\n\/bin\/ksysdefd\n\n\nRoot install desc\nsystem kernel service defender\n\n\nInstall as non-root\n~\/.config\/ksysdef\/ksysdefd\n\n\nNon-root install desc\nsystem kernel service defender\n\n\nC2\n198.105.125[.]74 (TCP\/80)\n\n\nUsage Timeframe\nEarly 2015\n\n\n\nTable 2: Sample 2 - Early 2015 Sofacy 32-bit Fysbis\n\n\n\n\n\n\nMD5\ne107c5c84ded6cd9391aede7f04d64c8\n\n\nSHA-256\nfd8b2ea9a2e8a67e4cb3904b49c789d57ed\n9b1ce5bebfe54fe3d98214d6a0f61\n\n\nssdeep\n6144:W\/D5tpLWtr91gmaVy+mdckn6BCUd\nc4mLc2B9:4D5Lqgkcj+\n\n\nSize\n314.4 KB (321902 bytes)\n\n\nType\nELF 64-bit (not stripped)\n\n\nInstall as root\n\/bin\/ksysdefd\n\n\nRoot install desc\nsystem kernel service defender\n\n\nInstall as non-root\n~\/.config\/ksysdef\/ksysdefd\n\n\nNon-root install desc\nsystem kernel service defender\n\n\nC2\nmozilla-plugins[.]com (TCP\/80)\n\n\nUsage Timeframe\nLate 2015\n\n\n\nTable 3: Sample 3 - Late 2015 Sofacy 64-bit Fysbis\n\n\nOverall, these binaries are assessed as low sophistication, but effective. They epitomize the grudging reality that Advanced Persistent Threat (APT) actors often don\u2019t require advanced means to affect their objectives. Rather, these actors more often than not hold their advanced malware and zero day exploits in reserve and employ just enough resources to meet their goals. It is only fair that defenders use any shortcuts or tricks at their disposal to shorten the amount of time it takes to assess threats. In other words, defenders should always look for ways to work smarter before they have to work harder.\nGetting the Most Out of Strings\nBinary strings alone revealed a good amount about these files, increasing the efficacy of activities such as static analysis categorization (e.g., Yara). One example of this is Fysbis installation and platform targeting information for the samples in Table 1 and Table 2.\n\n\nFigure 1: Sofacy Fysbis installation and platform targeting found in strings\nIn this case, we can see the binary installation path and local reconnaissance to determine which flavor of Linux the malware is running. This is followed by a number of Linux shell command style commands related to the malware establishing persistence.\n\nAnother example of easily obtained information from these samples is capability based.\n\n\nFigure 2: Sofacy Fysbis capability related leakage through strings\nFigure 2 shows interactive status \/ feedback strings that can give a defender an initial profile of capabilities. In addition to contributing to static analysis detections, this can be useful as a starting point for further incident response prioritization and qualification of the threat.\nSymbolic Information Can Shorten Analysis Time\nInterestingly, the most recent ELF 64-bit binary we analyzed (Table 3) was not stripped prior to delivery, which offered additional context in the form of symbolic information. Defenders more familiar with Windows Portable Executable (PE) binaries can equate this with compilation of a Debug version versus a Release version. For comparison, if we were to inspect Fysbis \u201cRemoteShell\u201d associated strings in one of the stripped variants, we would only see the following:\n\n\nFigure 3: Sofacy Fysbis stripped binary string references to RemoteShell capability\nCompare this with what is available from the non-stripped variant:\n\n\nFigure 4: Sofacy Fysbis non-stripped binary strings referenes to RemoteShell capability\nLittle static analysis gifts like these can help to speed defender enumeration of capabilities and \u2013 more importantly \u2013 further contribute to correlation and detection across related samples.\n\nAdditionally, this latest sample demonstrated minor evolution of the threat, most notably in terms of obfuscation. Specifically, both samples in Table 1 and Table 2 leaked installation information in the clear within binary strings. This was not the case with the sample in Table 3. Taking a closer look at this non-stripped binary using a disassembler, the following corresponds to decoding malware installation information for a root-privilege account.\n\n\nFigure 5: Assembly code view of Sample 3 installation decoding\nIn this case, the symbolic information hints at the method used for decoding, with references to mask, path, name, and info byte arrays.\n\n\nFigure 6: Assembly view of Sample 3 root installation related byte arrays\nAs it turns out, the referenced byte mask is applied to the other byte arrays using a rolling double-XOR algorithm to construct malware installation paths, filenames, and descriptions for a Linux root account. Corresponding INSTALLUSER byte arrays exist, which facilitate the non-root installation for the trojan. The same masking method is also used by the binary to decode malware configuration C2 information, further showcasing how a little symbolic information can go a long way towards completeness and higher confidence in assessment of a malware sample.\n\nIf you would like to learn more about how Fysbis works, the samples analyzed remain fairly consistent with the sample analysis found here.\nInfrastructure Analysis\nAs Unit 42 has discussed in depth in other blog articles, we have observed that adversaries in general are seemingly hesitant in changing their infrastructure. This may be due to not wanting to commit additional resources, or simply a matter of retaining familiarity for the sake of timeliness. In either case, we see the same type of behavior here with the Fysbis samples in use by Sofacy.\n\nThe oldest sample (Table 1), was found to beacon to the domain azureon-line[.]com, which had already been widely publicized as a known command and control domain for the Sofacy group. Using passive DNS, we can see that two of the original IPs this domain resolved to, 193.169.244[.]190 and 111.90.148[.]148 also mapped to a number of other domains that had been in use by the Sofacy group during that time period.\n\n\nFigure 7: Sample 1 C2 resolutions\nThe first of the newer samples (Table 2), continues the trend and beacons to an IP also widely associated with the Sofacy group, 198.105.125[.]74. This IP has been mostly associated with the tool specifically known as CHOPSTICK, which can be read about here.\n\n\nFigure 8: Sample 2 C2 resolutions\nThe newest sample (Table 3), introduces a previously unknown command and control beacon to mozilla-plugins[.]com. This activity aligns with the previously observed Sofacy group tactic of integrating legitimate company references into their infrastructure naming convention. Neither this new domain nor the IP it resolves to have been observed in the past, indicating that the sample in Table 3 may be associated with a newer campaign. Comparing this sample\u2019s binary with the other two however, shows there are significant similarities on the code level as well as in terms of shared behavior.\n\n\nFigure 9: Sample 3 C2 resolutions\n\nConclusion\nLinux is used across business and home environments and appears in a variety of form factors. It is a preferred platform within data centers and the cloud for businesses, as well as an ongoing favorite when it comes to a majority of Internet-facing web and application servers. Linux is also at the foundation of Android devices and a number of other embedded systems. The value proposition of Linux \u2013 especially when it comes to its use in the enterprise \u2013 can be broken out into three perceived benefits: lower total cost of ownership (TCO), security, and feature set. While numbers and comparison alone can contribute to measurement of TCO and feature set, security requires further qualification. Expertise in the Linux platform is highly sought after across all industries for multiple disciplines, from system administration to big data analytics to incident response.\n\nThe majority of businesses still maintain Windows-heavy user environments where certain core infrastructure components also operate under Windows servers (e.g., Active Directory, SharePoint, etc.). This means, from a practical perspective, most of a business\u2019s focus remains on supporting and protecting Windows assets. Linux remains a mystery to a number of enterprise IT specialists \u2013most critically for network defenders. Identifying and qualifying potential incidents requires a familiarity with what constitutes normal operation in order to isolate anomalies. The same is true for any other asset in an environment, normal operation is entirely dependent on a given asset\u2019s role \/ function in the enterprise.\n\nLack of expertise and visibility into non-Windows platforms combine in some environments to present significant risks against an organization\u2019s security posture. As a recent caution, the Linux vulnerability described under CVE-2016-0728 further demonstrates the potential breadth of real-world risks to associated platforms. A natural extension of this exposure is increased targeting by both dedicated and opportunistic attackers across various malicious actor motivations. Despite the lingering belief (and false sense of security) that Linux inherently yields higher degrees of protection from malicious actors, Linux malware and vulnerabilities do exist and are in use by advanced adversaries. To mitigate associated risks requires tailored integration of the people, processes, and technology in support of prevention, monitoring, and detection within an environment.\n\nLinux malware detection and prevention is not prevalent at this time, but Palo Alto Networks customers are protected through our next-generation security platform:\n\n\tIPS signature 14917 deployed to identify and prevent command and control activity\n\tThe C2 domains and files mentioned in this report are blocked in our Threat Prevention product.\n\nIndicators\n\n\n\nType\nValue\n\n\nMD5\n364ff454dcf00420cff13a57bcb78467\n\n\nSHA256\n8bca0031f3b691421cb15f9c6e71ce193\n355d2d8cf2b190438b6962761d0c6bb\n\n\nssdeep\n3072:n+1R4tREtGN4qyGCXdHPYK9l\n0H786O26BmMAwyWMn\/qwwiHNl:n\n+1R43QcILXdF0w6IBmMAwwCwwi\n\n\nMD5\n075b6695ab63f36af65f7ffd45cccd39\n\n\nSHA-256\n02c7cf55fd5c5809ce2dce56085ba437\n95f2480423a4256537bfdfda0df85592\n\n\nssdeep\n3072:9ZAxHANuat3WWFY9nqjwbuZf\n454UNqRpROIDLHaSeWb3LGmPTrI\nW33HxIajF:9ZAxHANJAvbuZf454UN\n+rv eQLZPTrV3Z\n\n\nMD5\ne107c5c84ded6cd9391aede7f04d64c8\n\n\nSHA-256\nfd8b2ea9a2e8a67e4cb3904b49c789d\n57ed9b1ce5bebfe54fe3d98214d6a0f61\n\n\nssdeep\n6144:W\/D5tpLWtr91gmaVy+mdckn6\nBCUdc4mLc2B9:4D5Lqgkcj+\n\n\nPath\n\/bin\/rsyncd\n\n\nPath Desc\nsynchronize and backup service\n\n\nPath\n~\/.config\/dbus-notifier\/dbus-inotifier\n\n\nPath Desc\nsystem service d-bus notifier\n\n\nPath\n\/bin\/ksysdefd\n\n\nPath\n~\/.config\/ksysdef\/ksysdefd\n\n\nPath Desc\nsystem kernel service defender\n\n\nC2\nazureon-line[.]com\n\n\nC2\n198.105.125[.]74\n\n\nC2\nmozilla-plugins[.]com\n\n\nC2\nMozillaplagins[.]com\n\n\n\n&nbsp;\n\n&nbsp;\n\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Bryan Lee"},{"@type":"Person","name":"Rob Downs"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"12157","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=12157' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fa-look-into-fysbis-sofacys-linux-backdoor%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fa-look-into-fysbis-sofacys-linux-backdoor%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-12157 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">A Look Into Fysbis: Sofacy’s Linux Backdoor</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-12157 entry-meta">
			
			
			<span class="post-views-count">19,875</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'12157','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fa-look-into-fysbis-sofacys-linux-backdoor%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fa-look-into-fysbis-sofacys-linux-backdoor%2F+-+A+Look+Into+Fysbis%3A+Sofacy%E2%80%99s+Linux+Backdoor" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fa-look-into-fysbis-sofacys-linux-backdoor%2F&title=A+Look+Into+Fysbis%3A+Sofacy%E2%80%99s+Linux+Backdoor&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/a-look-into-fysbis-sofacys-linux-backdoor/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/bryanlee/" title="Posts by Bryan Lee" class="author url fn" rel="author">Bryan Lee</a> and <a href="https://unit42.paloaltonetworks.com/author/rob-downs/" title="Posts by Rob Downs" class="author url fn" rel="author">Rob Downs</a>        </p>
        <p><time datetime="2016-02-12T13:00:10+00:00">February 12, 2016 at 3:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/fysbis/" rel="tag">Fysbis</a>, <a href="https://unit42.paloaltonetworks.com/tag/linux/" rel="tag">Linux</a>, <a href="https://unit42.paloaltonetworks.com/tag/sofacy/" rel="tag">Sofacy</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <h3>Introduction</h3>
<p>The Sofacy group, also known as APT28 and Sednit, is a fairly well known cyber espionage group believed to have ties to Russia. Their targets have spanned all across the world, with a focus on government, defense organizations and various Eastern European governments. There have been numerous reports on their activities, to the extent that a <a href="https://en.wikipedia.org/wiki/Sofacy_Group" target="_blank">Wikipedia</a> entry has even been created for them.</p>
<p>From these reports, we know that the group uses an abundance of tools and tactics, ranging across zero-day exploits targeting common applications such as Java or Microsoft Office, heavy use of spear-phishing attacks, compromising legitimate websites to stage watering-hole attacks, and targeting over a variety of operating systems – Windows, OSX, Linux, even mobile iOS.<span id="more-12157"></span></p>
<p>The Linux malware Fysbis is a preferred tool of Sofacy, and though it is not particularly sophisticated, Linux security in general is still a maturing area, especially in regards to malware. In short, it is entirely plausible that this tool has contributed to the success of associated attacks by this group. This blog post focuses specifically on this Linux tool preferred by Sofacy and describes considerations and implications when it comes to Linux malware.</p>
<h3>Malware Assessment</h3>
<p>Fysbis is a modular Linux trojan / backdoor that implements plug-in and controller modules as distinct classes. For reference, some vendors categorize this malware under the Sednit attacker group naming designation. This malware includes both 32-bit and 64-bit versions of <a href="http://www.linuxjournal.com/article/1059" target="_blank">Executable and Linking Format (ELF)</a> binaries. Additionally, Fysbis can install itself to a victim system with or without root privileges. This increases the options available to an adversary when it comes to selecting accounts for installation.</p>
<p>Summary information for the three binaries we analyzed follows:</p>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<td width="109">MD5</td>
<td width="198">364ff454dcf00420cff13a57bcb78467</td>
</tr>
<tr>
<td width="109">SHA-256</td>
<td width="198">8bca0031f3b691421cb15f9c6e71ce19335<br />
5d2d8cf2b190438b6962761d0c6bb</td>
</tr>
<tr>
<td width="109">ssdeep</td>
<td width="198">3072:n+1R4tREtGN4qyGCXdHPYK9l0H786<br />
O26BmMAwyWMn/qwwiHNl:n+1R43QcIL<br />
XdF0w6IBmMAwwCwwi</td>
</tr>
<tr>
<td width="109">Size</td>
<td width="198">141.2 KB (144560 bytes)</td>
</tr>
<tr>
<td width="109">Type</td>
<td width="198">ELF 64-bit (stripped)</td>
</tr>
<tr>
<td width="109">Install as root</td>
<td width="198">/bin/rsyncd</td>
</tr>
<tr>
<td width="109">Root install desc</td>
<td width="198">synchronize and backup service</td>
</tr>
<tr>
<td width="109">Install as non-root</td>
<td width="198">~/.config/dbus-notifier/dbus-inotifier</td>
</tr>
<tr>
<td width="109">Non-root install desc</td>
<td width="198">system service d-bus notifier</td>
</tr>
<tr>
<td width="109">C2</td>
<td width="198">azureon-line[.]com (TCP/80)</td>
</tr>
<tr>
<td width="109">Usage Timeframe</td>
<td width="198">Late 2014</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 1: Sample 1 &#8211; Late 2014 Sofacy 64-bit Fysbis</p>
<table>
<tbody>
<tr>
<td width="109">MD5</td>
<td width="198">075b6695ab63f36af65f7ffd45cccd39</td>
</tr>
<tr>
<td width="109">SHA-256</td>
<td width="198">02c7cf55fd5c5809ce2dce56085ba43795f2<br />
480423a4256537bfdfda0df85592</td>
</tr>
<tr>
<td width="109">ssdeep</td>
<td width="198">3072:9ZAxHANuat3WWFY9nqjwbuZf454U<br />
NqRpROIDLHaSeWb3LGmPTrIW33HxIajF:<br />
9ZAxHANJAvbuZf454UN+rv eQLZPTrV3Z</td>
</tr>
<tr>
<td width="109">Size</td>
<td width="198">175.9 KB (180148 bytes)</td>
</tr>
<tr>
<td width="109">Type</td>
<td width="198">ELF 32-bit (stripped)</td>
</tr>
<tr>
<td width="109">Install as root</td>
<td width="198">/bin/ksysdefd</td>
</tr>
<tr>
<td width="109">Root install desc</td>
<td width="198">system kernel service defender</td>
</tr>
<tr>
<td width="109">Install as non-root</td>
<td width="198">~/.config/ksysdef/ksysdefd</td>
</tr>
<tr>
<td width="109">Non-root install desc</td>
<td width="198">system kernel service defender</td>
</tr>
<tr>
<td width="109">C2</td>
<td width="198">198.105.125[.]74 (TCP/80)</td>
</tr>
<tr>
<td width="109">Usage Timeframe</td>
<td width="198">Early 2015</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 2: Sample 2 &#8211; Early 2015 Sofacy 32-bit Fysbis</p>
<table>
<tbody>
<tr>
<td width="109">MD5</td>
<td width="198">e107c5c84ded6cd9391aede7f04d64c8</td>
</tr>
<tr>
<td width="109">SHA-256</td>
<td width="198">fd8b2ea9a2e8a67e4cb3904b49c789d57ed<br />
9b1ce5bebfe54fe3d98214d6a0f61</td>
</tr>
<tr>
<td width="109">ssdeep</td>
<td width="198">6144:W/D5tpLWtr91gmaVy+mdckn6BCUd<br />
c4mLc2B9:4D5Lqgkcj+</td>
</tr>
<tr>
<td width="109">Size</td>
<td width="198">314.4 KB (321902 bytes)</td>
</tr>
<tr>
<td width="109">Type</td>
<td width="198">ELF 64-bit (not stripped)</td>
</tr>
<tr>
<td width="109">Install as root</td>
<td width="198">/bin/ksysdefd</td>
</tr>
<tr>
<td width="109">Root install desc</td>
<td width="198">system kernel service defender</td>
</tr>
<tr>
<td width="109">Install as non-root</td>
<td width="198">~/.config/ksysdef/ksysdefd</td>
</tr>
<tr>
<td width="109">Non-root install desc</td>
<td width="198">system kernel service defender</td>
</tr>
<tr>
<td width="109">C2</td>
<td width="198">mozilla-plugins[.]com (TCP/80)</td>
</tr>
<tr>
<td width="109">Usage Timeframe</td>
<td width="198">Late 2015</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 3: Sample 3 &#8211; Late 2015 Sofacy 64-bit Fysbis</p>
<p>Overall, these binaries are assessed as low sophistication, but effective. They epitomize the grudging reality that Advanced Persistent Threat (APT) actors often don’t require advanced means to affect their objectives. Rather, these actors more often than not hold their advanced malware and zero day exploits in reserve and employ just enough resources to meet their goals. It is only fair that defenders use any shortcuts or tricks at their disposal to shorten the amount of time it takes to assess threats. In other words, defenders should always look for ways to work smarter before they have to work harder.</p>
<h4>Getting the Most Out of Strings</h4>
<p>Binary strings alone revealed a good amount about these files, increasing the efficacy of activities such as static analysis categorization (e.g., <a href="https://plusvic.github.io/yara/">Yara</a>). One example of this is Fysbis installation and platform targeting information for the samples in Table 1 and Table 2.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12158" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy-500x172.png" alt="sofacy" width="500" height="172" /></a></p>
<p style="text-align: center;">Figure 1: Sofacy Fysbis installation and platform targeting found in strings</p>
<p>In this case, we can see the binary installation path and local reconnaissance to determine which flavor of Linux the malware is running. This is followed by a number of Linux shell command style commands related to the malware establishing persistence.</p>
<p>Another example of easily obtained information from these samples is capability based.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy2.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12159" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy2-500x543.png" alt="sofacy2" width="500" height="543" /></a></p>
<p style="text-align: center;">Figure 2: Sofacy Fysbis capability related leakage through strings</p>
<p>Figure 2 shows interactive status / feedback strings that can give a defender an initial profile of capabilities. In addition to contributing to static analysis detections, this can be useful as a starting point for further incident response prioritization and qualification of the threat.</p>
<h4>Symbolic Information Can Shorten Analysis Time</h4>
<p>Interestingly, the most recent ELF 64-bit binary we analyzed (Table 3) was not stripped prior to delivery, which offered additional context in the form of symbolic information. Defenders more familiar with Windows <a href="https://msdn.microsoft.com/en-us/library/ms809762.aspx">Portable Executable (PE)</a> binaries can equate this with compilation of a Debug version versus a Release version. For comparison, if we were to inspect Fysbis “RemoteShell” associated strings in one of the stripped variants, we would only see the following:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy3.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12160" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy3-500x24.png" alt="sofacy3" width="500" height="24" /></a></p>
<p style="text-align: center;">Figure 3: Sofacy Fysbis stripped binary string references to RemoteShell capability</p>
<p>Compare this with what is available from the non-stripped variant:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy4.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12161" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy4-500x222.png" alt="sofacy4" width="500" height="222" /></a></p>
<p style="text-align: center;">Figure 4: Sofacy Fysbis non-stripped binary strings referenes to RemoteShell capability</p>
<p>Little static analysis gifts like these can help to speed defender enumeration of capabilities and – more importantly – further contribute to correlation and detection across related samples.</p>
<p>Additionally, this latest sample demonstrated minor evolution of the threat, most notably in terms of obfuscation. Specifically, both samples in Table 1 and Table 2 leaked installation information in the clear within binary strings. This was not the case with the sample in Table 3. Taking a closer look at this non-stripped binary using a disassembler, the following corresponds to decoding malware installation information for a root-privilege account.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy5.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12162" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy5-500x114.png" alt="sofacy5" width="500" height="114" /></a></p>
<p style="text-align: center;">Figure 5: Assembly code view of Sample 3 installation decoding</p>
<p>In this case, the symbolic information hints at the method used for decoding, with references to mask, path, name, and info byte arrays.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy6.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12163" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy6-500x378.png" alt="sofacy6" width="500" height="378" /></a></p>
<p style="text-align: center;">Figure 6: Assembly view of Sample 3 root installation related byte arrays</p>
<p>As it turns out, the referenced byte mask is applied to the other byte arrays using a rolling double-XOR algorithm to construct malware installation paths, filenames, and descriptions for a Linux root account. Corresponding INSTALLUSER byte arrays exist, which facilitate the non-root installation for the trojan. The same masking method is also used by the binary to decode malware configuration C2 information, further showcasing how a little symbolic information can go a long way towards completeness and higher confidence in assessment of a malware sample.</p>
<p>If you would like to learn more about how Fysbis works, the samples analyzed remain fairly consistent with the sample analysis found <a href="http://vms.drweb.com/virus/?i=4276269">here</a>.</p>
<h3>Infrastructure Analysis</h3>
<p>As Unit 42 has discussed in depth in other blog articles, we have observed that adversaries in general are seemingly hesitant in changing their infrastructure. This may be due to not wanting to commit additional resources, or simply a matter of retaining familiarity for the sake of timeliness. In either case, we see the same type of behavior here with the Fysbis samples in use by Sofacy.</p>
<p>The oldest sample (Table 1), was found to beacon to the domain azureon-line[.]com, which had already been widely publicized as a known command and control domain for the Sofacy group. Using passive DNS, we can see that two of the original IPs this domain resolved to, 193.169.244[.]190 and 111.90.148[.]148 also mapped to a number of other domains that had been in use by the Sofacy group during that time period.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy7.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12164" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy7-500x549.png" alt="sofacy7" width="500" height="549" /></a></p>
<p style="text-align: center;">Figure 7: Sample 1 C2 resolutions</p>
<p>The first of the newer samples (Table 2), continues the trend and beacons to an IP also widely associated with the Sofacy group, 198.105.125[.]74. This IP has been mostly associated with the tool specifically known as CHOPSTICK, which can be read about <a href="https://www2.fireeye.com/rs/fireye/images/rpt-apt28.pdf">here</a>.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy8.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12165" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy8-500x221.png" alt="sofacy8" width="500" height="221" /></a></p>
<p style="text-align: center;">Figure 8: Sample 2 C2 resolutions</p>
<p>The newest sample (Table 3), introduces a previously unknown command and control beacon to mozilla-plugins[.]com. This activity aligns with the previously observed Sofacy group tactic of integrating legitimate company references into their infrastructure naming convention. Neither this new domain nor the IP it resolves to have been observed in the past, indicating that the sample in Table 3 may be associated with a newer campaign. Comparing this sample’s binary with the other two however, shows there are significant similarities on the code level as well as in terms of shared behavior.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy9.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-12166" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/02/sofacy9-500x418.png" alt="sofacy9" width="500" height="418" /></a></p>
<p style="text-align: center;">Figure 9: Sample 3 C2 resolutions</p>
<h3>Conclusion</h3>
<p>Linux is used across business and home environments and appears in a variety of form factors. It is a preferred platform within data centers and the cloud for businesses, as well as an ongoing favorite when it comes to a majority of Internet-facing web and application servers. Linux is also at the foundation of Android devices and a number of other embedded systems. The value proposition of Linux – especially when it comes to its use in the enterprise – can be broken out into three perceived benefits: lower total cost of ownership (TCO), security, and feature set. While numbers and comparison alone can contribute to measurement of TCO and feature set, security requires further qualification. Expertise in the Linux platform is highly sought after across all industries for multiple disciplines, from system administration to big data analytics to incident response.</p>
<p>The majority of businesses still maintain Windows-heavy user environments where certain core infrastructure components also operate under Windows servers (e.g., Active Directory, SharePoint, etc.). This means, from a practical perspective, most of a business’s focus remains on supporting and protecting Windows assets. Linux remains a mystery to a number of enterprise IT specialists –most critically for network defenders. Identifying and qualifying potential incidents requires a familiarity with what constitutes normal operation in order to isolate anomalies. The same is true for any other asset in an environment, normal operation is entirely dependent on a given asset’s role / function in the enterprise.</p>
<p>Lack of expertise and visibility into non-Windows platforms combine in some environments to present significant risks against an organization’s security posture. As a recent caution, the Linux vulnerability described under <a href="http://www.pcworld.com/article/3023870/security/linux-kernel-flaw-endangers-millions-of-pcs-servers-and-android-devices.html">CVE-2016-0728</a> further demonstrates the potential breadth of real-world risks to associated platforms. A natural extension of this exposure is increased targeting by both dedicated and opportunistic attackers across various malicious actor motivations. Despite the lingering belief (and false sense of security) that Linux inherently yields higher degrees of protection from malicious actors, Linux malware and vulnerabilities do exist and are in use by advanced adversaries. To mitigate associated risks requires tailored integration of the people, processes, and technology in support of prevention, monitoring, and detection within an environment.</p>
<p>Linux malware detection and prevention is not prevalent at this time, but Palo Alto Networks customers are protected through our next-generation security platform:</p>
<ul>
<li>IPS signature 14917 deployed to identify and prevent command and control activity</li>
<li>The C2 domains and files mentioned in this report are blocked in our Threat Prevention product.</li>
</ul>
<h3>Indicators</h3>
<table width="441">
<tbody>
<tr>
<td width="86"><strong>Type</strong></td>
<td width="356"><strong>Value</strong></td>
</tr>
<tr>
<td width="86">MD5</td>
<td width="356">364ff454dcf00420cff13a57bcb78467</td>
</tr>
<tr>
<td width="86">SHA256</td>
<td width="356">8bca0031f3b691421cb15f9c6e71ce193<br />
355d2d8cf2b190438b6962761d0c6bb</td>
</tr>
<tr>
<td width="86">ssdeep</td>
<td width="356">3072:n+1R4tREtGN4qyGCXdHPYK9l<br />
0H786O26BmMAwyWMn/qwwiHNl:n<br />
+1R43QcILXdF0w6IBmMAwwCwwi</td>
</tr>
<tr>
<td width="86">MD5</td>
<td width="356">075b6695ab63f36af65f7ffd45cccd39</td>
</tr>
<tr>
<td width="86">SHA-256</td>
<td width="356">02c7cf55fd5c5809ce2dce56085ba437<br />
95f2480423a4256537bfdfda0df85592</td>
</tr>
<tr>
<td width="86">ssdeep</td>
<td width="356">3072:9ZAxHANuat3WWFY9nqjwbuZf<br />
454UNqRpROIDLHaSeWb3LGmPTrI<br />
W33HxIajF:9ZAxHANJAvbuZf454UN<br />
+rv eQLZPTrV3Z</td>
</tr>
<tr>
<td width="86">MD5</td>
<td width="356">e107c5c84ded6cd9391aede7f04d64c8</td>
</tr>
<tr>
<td width="86">SHA-256</td>
<td width="356">fd8b2ea9a2e8a67e4cb3904b49c789d<br />
57ed9b1ce5bebfe54fe3d98214d6a0f61</td>
</tr>
<tr>
<td width="86">ssdeep</td>
<td width="356">6144:W/D5tpLWtr91gmaVy+mdckn6<br />
BCUdc4mLc2B9:4D5Lqgkcj+</td>
</tr>
<tr>
<td width="86">Path</td>
<td width="356">/bin/rsyncd</td>
</tr>
<tr>
<td width="86">Path Desc</td>
<td width="356">synchronize and backup service</td>
</tr>
<tr>
<td width="86">Path</td>
<td width="356">~/.config/dbus-notifier/dbus-inotifier</td>
</tr>
<tr>
<td width="86">Path Desc</td>
<td width="356">system service d-bus notifier</td>
</tr>
<tr>
<td width="86">Path</td>
<td width="356">/bin/ksysdefd</td>
</tr>
<tr>
<td width="86">Path</td>
<td width="356">~/.config/ksysdef/ksysdefd</td>
</tr>
<tr>
<td width="86">Path Desc</td>
<td width="356">system kernel service defender</td>
</tr>
<tr>
<td width="86">C2</td>
<td width="356">azureon-line[.]com</td>
</tr>
<tr>
<td width="86">C2</td>
<td width="356">198.105.125[.]74</td>
</tr>
<tr>
<td width="86">C2</td>
<td width="356">mozilla-plugins[.]com</td>
</tr>
<tr>
<td width="86">C2</td>
<td width="356">Mozillaplagins[.]com</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
