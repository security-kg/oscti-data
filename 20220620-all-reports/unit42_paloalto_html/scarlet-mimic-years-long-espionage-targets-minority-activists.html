
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/scarlet-mimic-years-long-espionage-targets-minority-activists/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/scarlet-mimic-years-long-espionage-targets-minority-activists/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Over the past seven months, Unit 42 has been investigating a series of attacks attributed to an espionage group they code named “Scarlet Mimic.”"/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/scarlet-mimic-years-long-espionage-targets-minority-activists/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists" />
<meta property="og:description" content="Over the past seven months, Unit 42 has been investigating a series of attacks attributed to an espionage group they code named “Scarlet Mimic.”" />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/scarlet-mimic-years-long-espionage-targets-minority-activists/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Android" />
<meta property="article:tag" content="Apple" />
<meta property="article:tag" content="AutoFocus" />
<meta property="article:tag" content="BrutishCommand" />
<meta property="article:tag" content="CallMe" />
<meta property="article:tag" content="cyber espionage" />
<meta property="article:tag" content="Cyber Threat Alliance" />
<meta property="article:tag" content="cybersecurity" />
<meta property="article:tag" content="Espionage" />
<meta property="article:tag" content="FakeM" />
<meta property="article:tag" content="Mac OS X" />
<meta property="article:tag" content="microsoft" />
<meta property="article:tag" content="MobileOrder" />
<meta property="article:tag" content="Psylo" />
<meta property="article:tag" content="Scarlet Mimic" />
<meta property="article:tag" content="SkiBoot Loader" />
<meta property="article:tag" content="SubtractThis" />
<meta property="article:tag" content="Trojans" />
<meta property="article:tag" content="WildFire" />
<meta property="article:section" content="Reports" />
<meta property="article:published_time" content="2016-01-24T15:00:14+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:03:20+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:03:20+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet1-500x296.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Over the past seven months, Unit 42 has been investigating a series of attacks attributed to an espionage group they code named “Scarlet Mimic.”" />
<meta name="twitter:title" content="Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet1-500x296.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists Comments Feed" href="https://unit42.paloaltonetworks.com/scarlet-mimic-years-long-espionage-targets-minority-activists/feed/" />
<meta property="og:likes" content="2"/>
<meta property="og:readtime" content="27"/>
<meta property="og:views" content="38,761"/>
<meta property="og:date_created" content="January 24, 2016 at 5:00 PM"/>
<meta property="og:post_length" content="8848"/>
<meta property="og:category" content="Reports"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/reports/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:author" content="Jen Miller-Osborn"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists","name":"Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)Executive Summary Over the past seven months, Unit 42 has been investigating a series of attacks we attribute to a group we have code named \u201cScarlet Mimic.\u201d The attacks began over four years ago and their targeting pattern suggests that this adversary\u2019s primary mission is to gather information...","url":"https:\/\/unit42.paloaltonetworks.com\/scarlet-mimic-years-long-espionage-targets-minority-activists\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/scarlet-mimic-years-long-espionage-targets-minority-activists\/","datePublished":"January 24, 2016","articleBody":"Executive Summary\r\nOver the past seven months, Unit 42 has been investigating a series of attacks we attribute to a group we have code named \u201cScarlet Mimic.\u201d The attacks began over four years ago and their targeting pattern suggests that this adversary\u2019s primary mission is to gather information about minority rights activists. We do not have evidence directly linking these attacks to a government source, but the information derived from these activities supports an assessment that a group or groups with motivations similar to the stated position of the Chinese government in relation to these targets is involved.\r\n\r\nThe goal of this report is to expose the tools, tactics and infrastructure deployed by Scarlet Mimic in order to increase awareness of this threat and decrease its operational success through deployment of prevention and detection countermeasures. From our vantage point, we are not able to identify which attacks have been successful against which organizations.\u00a0But\u00a0the fact that the tools Scarlet Mimic deploys have been under development for years\u00a0suggests\u00a0an active adversary\u00a0that has been successful in some percentage\u00a0of\u00a0its\u00a0operations.\u00a0Based on our analysis, we are also seeing Scarlet Mimic start to expand\u00a0its\u00a0espionage efforts from PCs to mobile devices, marking an evolution in\u00a0its\u00a0tactics.\r\n\r\nIndividuals and groups of all different types may become the target of cyber espionage campaigns. The most well known victims of cyber espionage are typically government organizations or high-tech companies, but it\u2019s important to recognize that espionage-focused adversaries are tasked to collect information from many sources.\r\n\r\nThe attacks we attribute to Scarlet Mimic have primarily targeted Uyghur and Tibetan activists as well as those who are interested in their causes. Both the Tibetan community and the Uyghurs, a Turkic Muslim minority residing primarily in northwest China,\u00a0have been targets of multiple sophisticated attacks in the past decade. Both also have history of strained relationships with the government of the People\u2019s Republic of China (PRC), though we do not have evidence that links Scarlet Mimic attacks to the PRC.\r\n\r\nScarlet Mimic attacks have also been identified\u00a0against government organizations in Russia and India, who are responsible for tracking activist and terrorist activities. While we do not know the precise target of each of the Scarlet Mimic attacks, many of them align to the patterns described above.\r\n\r\nThe Scarlet Mimic attacks primarily center around the use of a Windows backdoor named \u201cFakeM.\u201d It was first described by Trend Micro in 2013 and was named FakeM because its primary command and control traffic mimicked Windows Messenger and Yahoo! Messenger network traffic to evade detection. We have identified two subsequent variants of the FakeM family, which has undergone significant changes since it was exposed in 2013. We have also identified nine distinct \u201cloader\u201d malware families, which Scarlet Mimic appears to use to avoid detection when infecting a system.\r\n\r\nIn addition to the FakeM variants, Scarlet Mimic has deployed Trojans that target the Mac OS X and Android operating systems. We have linked these attacks to Scarlet Mimic through analysis of their command and control (C2) infrastructure.\r\n\r\nTo infect individuals with access to the data the actors desire, Scarlet Mimic deploys both spear-phishing and watering hole (strategic web compromise) attacks. Using these tactics they can directly target previously identified individuals (spear phishing) as well as unidentified individuals who are interested in a specific subject (watering hole). In their spear phishing attacks, Scarlet Mimic has exploited five separate vulnerabilities. However, in many cases they chose to forgo exploiting a software vulnerability and used self-extracting (SFX) RAR archives that use the Right-to-Left Override character to mask the true file extension, tricking victims into opening executable files.\r\n\r\nAs with many other attackers who use spear-phishing to infect victims, Scarlet Mimic makes heavy use of \u201cdecoy\u201d files. These are legitimate documents that contain content relevant to the subject of the spear phishing e-mail. After the system is infected, the malware displays the decoy document to trick the user into believing nothing harmful has occurred. These decoy documents allow us to identify the theme of the spear phishing e-mail and in some cases the target of the attack.\r\n\r\nThe most recent Scarlet Mimic attacks we have identified were conducted in 2015 and suggest the group has a significant interest in both Muslim activists and those interested in critiques of the Russian government and Russian President Vladimir Putin. Based on their previous targets we suspect these individuals may be targeted based on the information they posses on activist groups.\r\n\r\nThe primary source of data used in this analysis is Palo Alto Networks WildFire, which analyzes malware used in attacks across the world. The system also analyzes malware samples collected through a sharing partnership with other security vendors, including our partners in the Cyber Threat Alliance. To connect attacks to each other based on malware behavior and command and control infrastructure, we relied on AutoFocus threat intelligence. AutoFocus users can view all of the files related to Scarlet Mimic and the malware associated with the group using the following links:\r\n\r\n\tScarletMimic\r\n\tFakeM\r\n\tPsylo\r\n\tMobileOrder\r\n\r\nIntroduction\r\nThe better we can understand the threats to our networks and systems, the more effective we will be at preventing those threats. The goal of this report is to help network defenders better understand attacks from a group we have named Scarlet Mimic. This group has been conducting attacks for at least four years using a backdoor Trojan that has been under active development. The group primarily deploys spear-phishing e-mails to infect its targets, but was also responsible for a watering hole (strategic web compromise) attack in 2013.\r\n\r\nAttacks from this group have been reported publicly in the past, but mostly as disparate, unconnected incidents. Based on analysis of the data and malware samples we have collected, Unit 42 believes the attacks described herein are the work of a group or set of cooperating groups who have a single mission, collecting information on minority groups who reside in and around northwestern China. In the past, Scarlet Mimic has primarily targeted individuals who belong to these minority groups as well as their supporters, but we\u2019ve recently found evidence to indicate the group also targets individuals working inside government anti-terrorist organizations. We suspect these targets are selected based on their access to information about the targeted minority groups.\r\n\r\nIn the following sections we will describe selected attacks we have identified and who their likely targets are. We will also provide detailed analysis of the latest variants of the malware they deploy (known as FakeM) as well as other associated tools that allow Scarlet Mimic to target Android and OS X devices.\r\n\r\nAttacks launched by this group were publicly exposed on 2013 in a Trend Micro report about the FakeM Trojan. Since that reports release, Scarlet Mimic has deployed two additional versions of the malware. They have also deployed nine separate \u201cloader\u201d Trojans they use to infect systems with their backdoor.\r\nAttack Details\r\nThe majority of attacks we associate with Scarlet Mimic follow the pattern shown in Figure 1.\r\n\r\nFigure 1: \u201cSpear Phishing with Decoy\u201d Attack Pattern Deployed by Scarlet Mimic\r\nThe attacker sends a spear-phishing e-mail with a subject and body content that appeal to the targeted user. This e-mail carries an attachment, which is typically a document that exploits a Microsoft Office vulnerability. The attachment uses a file name that is related to the e-mail content to trick the user into opening it. If the user opens the file and the exploitation is successful, a backdoor Trojan is installed on the system that gives the attacker access and a decoy document is displayed to the victim. Decoy documents are typically non-malicious versions of the content the user expected to see when opening the attachment.\r\n\r\nMany of the targets and spoofed or compromised sending e-mail addresses have contact information on the Internet. The apparent sender email usually appears to be someone associated with the accompanying text, when appropriate, while the target emails are usually also available online tied to target organizations. A small subset of the decoys could not be found online and may be from previous compromises by Scarlet Mimic.\r\n\r\nMany attackers deploy this particular pattern, as it is often successful at infecting a user without alerting the user of the infection. This is the exact same pattern, for example, deployed by the attackers in Operation Lotus Blossom.\r\n\r\nWe have identified spear phishing documents from Scarlet Mimic exploiting the following vulnerabilities.\r\n\r\n\tCVE-2012-0158\r\n\tCVE-2010-3333\r\n\tCVE-2010-2883\r\n\tCVE-2010-2572\r\n\tCVE-2009-3129\r\n\r\nWe also know Scarlet Mimic uses a number of toolkits to create documents that contain exploit code to install the FakeM payload on a compromised system. Unit 42 tracks the toolkits delivering FakeM under the names MNKit, WingD and Tran Duy Linh. These kits appear to be used by many attack groups, and they alone are not a good indication of Scarlet Mimic activity.\r\n\r\nAdditionally, in many cases these threat actors did not use an exploit document at all, rather they sent self-extracting (SFX) RAR archives that use the Right-to-Left Override character to mask the true file extension. For example, the following two filenames of SFX archives used to deliver FakeM contain the RLO character (bolded):\r\n\r\nUpdate about the status of Tenzin Delek Rinpoche'ashes%E2%80%AEcod.scr\r\ntepsiliy mezmun.\\xe2\\x80\\xaetxt.scr\r\n\r\nEven when no software vulnerability is exploited, the attacks still typically include a decoy document. The content of most of the decoy documents appear to be available on the open Internet, and the attackers typically made small modifications to them.\r\n\r\nMany of the targets and spoofed or compromised sending accounts have contact information on the Internet. The apparent sender email usually appears to be someone associated with the accompanying text, when appropriate, while the target emails are usually also available online tied to target organizations. A small subset of the decoys could not be found online and may be from previous compromises by Scarlet Mimic. The overarching decoy themes were Uyghur-related, anti-Putin, or Al-Qaeda-related. The decoys are often copied from think tanks or reputable news sources the targets would likely frequent.\r\n\r\nIn one instance, the threat actors used content from a New York Times article (Figure 2) on the same day it was published.\r\n\r\n\r\nFigure 2: Decoy Text Extracted from the New York Times article\r\nFigure 3 shows one of the more common themes used to target Uyghurs and those interested in their cause. Multiple attacks used press releases or other content related to the World Uyghur Congress.\r\n\r\n\r\nFigure 3: Decoy using World Uyghur Congress Press Release\r\nIn July of 2015, we identified a full e-mail uploaded to an antivirus scanning service that carried a Scarlet Mimic exploit document. In this case (Figure 4) the recipient of the e-mail was an individual working for the Russian Federal Security Service (fsb.ru). The e-mail body requests help dealing with threatening phone calls from an international gang.\r\n\r\nFigure 4: Phishing E-mail send to FSB E-mail Address\r\nAnother attack, sent to an unknown target carried a decoy image (Figure 5) that compared Russian President Vladimir Putin to Adolf Hitler.\r\n\r\nFigure 5: Anti-Putin image used as a decoy document\r\nIn yet another case, the threat actors used a conference notification from one organization (Figure 6a) and modified it to appear as thought it was for an \u201cIslamic Country Muslim Religion Conference\u201d (Figure 6b). This document was particularly poorly altered, as the registration form still contained multiple hints to indicate the document was fraudulent (Figure 6c).\r\n\r\nFigure 6a: Original document used as a Psylo decoy\r\n\r\nFigure 6b: Modified header and contact email in the decoy\r\n\r\nFigure 6c: Bottom of the decoy document with replaced email and non-altered date -- a\u00a0quick search online shows this to be fraudulent\r\nIn total we have collected over 40 individual decoy documents used in these attacks, far more than we can detail here.\r\n\r\nWe are aware of one case where Scarlet Mimic broke from the spear-phishing pattern described above. In 2013, the group deployed a watering hole attack, also known as a strategic web compromise to infect victims with their backdoor. The watering hole is an attack vector that involves compromising a website that targeted victims are likely to visit in order to infect and gain access to their systems. According to a blog by Websense, threat actors compromised the Tibetan Alliance of Chicago\u2019s website to host malicious code that exploited a vulnerability in Internet Explorer (CVE-2012-4969.) Microsoft patched this vulnerability in September 2012, suggesting that this watering hole attack used an older vulnerability, which aligns with the threat groups continued use of older vulnerabilities in their spear-phishing efforts.\r\nMalware Overview\r\nFirst discussed in January 2013 in a Trend Micro whitepaper, FakeM is a Trojan that uses separate modules to perform its functionality. FakeM\u2019s functional code is shellcode-based and requires another Trojan to load it into memory and execute it. There are a variety of different Trojans used to load FakeM, some of which are more interesting than others. In this section, we will explore the loader Trojans followed by an analysis of the evolution of FakeM itself. We end this section with a discussion on tools related to FakeM and used by Scarlet Mimic.\r\nLoader Trojans\r\nFakeM is shellcode-based and therefore requires another Trojan to load FakeM into memory and execute its functional code. Threat actors have developed many different loading Trojans to load FakeM, some of which are fairly straightforward while others use very clever techniques to avoid detection. Unit 42 tracks the following list of loader Trojans that Scarlet Mimic has used to execute FakeM:\r\n\r\n\tCrypticConvo\r\n\tSkiBoot\r\n\tRaidBase\r\n\tFakeHighFive\r\n\tPiggyBack\r\n\tFullThrottle\r\n\tFakeFish\r\n\tBrutishCommand\r\n\tSubtractThis\r\n\r\nIt appears that the threat actors include the loader Trojans in some sort of builder application that allows actors to quickly create, configure and deploy payloads to execute FakeM. We believe this because many samples that execute FakeM have the same exact compilation time but different C2 servers, as seen in the example in Table 1. This suggests the actors compile a single sample and use a builder tool to configure individual samples on demand.\r\nWe used the loader Trojans to provide a general timeline for the development of FakeM samples, as FakeM is shellcode-based and does not contain any usable timestamps. The timestamps in the loader Trojans does not necessarily correspond to the usage of FakeM, but plotting the compile times of the loaders on a timeline shows an interesting trend. The scatter plot timeline in Figure 7 shows the known compilation times of the loader Trojans and the FakeM variant that it executed.\r\n\r\n\r\n\r\n\r\nSHA256\r\nCompiled\r\nLoader Trojan\r\nC2 Domains\r\n\r\n\r\n5182dc8667432d76a\r\n276dc4f864cdfcef3e4\r\n81783ebaf46d3b139\r\n7080b798f4a\r\n2013-09-13 08:02:58\r\nCrypticConvo\r\nopero.spdns[.]org, firefox.spdns[.]de\r\n\r\n\r\n5dade00db195087aa\r\n336ce190b5fd1c2299\r\n2c49556c623b42a9f7\r\n42d73241a7f\r\n2013-09-13 08:02:58\r\nCrypticConvo\r\nintersecurity.firewall-gateway[.]com\r\n\r\n\r\n\r\nTable 1: Two samples sharing a compile time yet contain different C2 domains in their configurations\r\n\r\nFigure 7: Timeline of compilation of loader Trojans associated with FakeM\r\nBased on the timeline, it appears that the actors were actively developing several of the loaders at the same time from 2009 until the early months of 2014. After the first quarter of 2014, it appears that the actors abandoned development of the older loaders in favor of FakeFish, BrutishCommand and SubtractThis. This does not mean that actors will not continue to use the older loaders, but it does suggest that the actors will continue including the newer or freshly developed loaders in updated builder applications.\r\nThe timeline also presents the possibility that the FakeM developers reacted to the release of Trend Micro\u2019s FakeM blog and whitepaper. Trend Micro published their analysis of the FakeM Trojan on January 17, 2013 (marked in Figure 7 by a red line) that discussed the original variant of FakeM. Shortly after, the original variant of FakeM drops off the timeline in favor of the SSL and Custom SSL variants. It is possible that the FakeM developers saw their tool was exposed and adapted it to avoid detection for continued use as a payload in attacks. We cannot be certain if the developers reacted specifically to Trend Micro\u2019s content, as it is possible that they were reacting to the increased antivirus detection rate of their tool that resulted from the exposure of the tool. Regardless of the specific stimulus, the reaction shows that the FakeM threat actors evolved to avoid detection\/attribution and to continue their attack campaigns.\r\nThe timeline does have one noticeable outlier, specifically the FakeHighFive sample compiled in September 2009 that loaded a FakeM SSL sample. We believe this compile time is incorrect, as the C2 domain for this sample, specifically press.ufoneconference[.]com, was registered by the threat actor in February 2013. The registration of the C2 domain in February 2013 aligns with other compilation times of FakeM SSL, which leads us to the conclusion that the September 2009 compilation timestamp was modified and\/or inaccurate.\r\nMost of the related loader Trojans, such as CrypticConvo, PiggyBack, FullThrottle, FakeHighFive, FakeFish and RaidBase do little more than load encrypted FakeM shellcode (either from a PE resource or embedded data), decrypt it, and execute the resulting shellcode. Other related loading Trojans, such as SubtractThis, BrutishCommand and SkiBoot employ clever techniques worth discussing.\r\n\r\nSubtractThis\r\nThe SubtractThis loader displays a technique that is quite clever. This loader received its name based on a technique it uses to delay before carrying out its main functionality, specifically by requiring the user to hit the minus (\u201c-\u201c) key. SubtractThis carries out this technique through the following steps:\r\n\r\n\r\n\tCalls LoadAcceleratorsA function to load the virtual key for the minus character \u201c-\u201c. Example: LoadAcceleratorsA(hInstance, VK_SUBTRACT);\r\n\tCalls SetTimer function to set up a callback function that will be called in the event that the LB_FINDSTRING Windows message. Example: SetTimer(0, LB_FINDSTRING_, 10000u, TimerFunc);\r\n\tCreates a continuous loop that starts by calling GetMessageA to obtain Windows messages\r\n\tCalls TranslateAcceleratorA to check Windows message received is VK_SUBTRACT \"-\".\r\n\tCalls the callback function set up in the SetTimer function if the user enters the minus \u201c-\u201c key.\r\n\r\nThis technique requires user interaction, which makes analysis in sandboxes more difficult.\r\nBrutishCommand\r\nThe BrutishCommand loader uses a very interesting method to decrypt the FakeM functional code. The main function in this loader checks the command line arguments passed to it, and if there are none present it will obtain a random number between 0-9 and create a new process using the same executable with this random number as a command line argument.\r\n\r\nIf the executable has a command line argument, the Trojan subjects the value to a hashing algorithm and compares the hash to 0x20E3EEBA. If the value matches the static hash, the executable will subject the command line argument to a second algorithm that will produce a value that the Trojan will use as the decryption key to decrypt the embedded FakeM shellcode. It essentially brute forces its own decryption key by rerunning itself over and over until it runs with the correct value is provided on the command line. Unit 42 had not seen this technique used by other malware families and it introduces a challenging hurdle when attempting to analyze or debug the loader Trojan.\r\nSkiBoot Loader\r\nSkiBoot reads the master boot record (MBR) of the system to determine the XOR key that it will use to decrypt the FakeM shellcode. It carries out this functionality by calling the ReadFile function to read 512-bytes from \u201c\\\\.\\PHYSICALDRIVE0\u201d and specifically uses the last byte of the MBR as the encryption key. The last byte of the MBR is \u201c\\xAA\u201d, or the second byte of \u201c\\x55\\xAA\u201d, which is the boot signature portion of the MBR.\r\n\r\nInstead of using ReadFile, one variant of this loader reads the MBR using DeviceIOControl using the ID_CMD control code, and accesses a specific offset to obtain the value that it will rotate each byte in the ciphertext within the decryption algorithm. The significance of using DeviceIOControl is that the VMware hypervisor responds to this API call with a blank buffer instead of the MBR, whereas the Virtualbox hypervisor returns the MBR correctly. It appears that this loader is specifically using the DeviceIOControl API function as a VMware detection technique, suggesting that the developers are well versed in the nuances of the VMware hypervisor and virtual machine evasion.\r\nEvolving FakeM: Variants\r\nSince being originally exposed in 2013, authors of FakeM have continuously made changes to the FakeM codebase, resulting in multiple variants. Before elaborating on the different variants of FakeM, there are many similarities that remain throughout the various iterations. The architecture has not changed during the evolution of FakeM, as a modular framework exists in each variant, as seen in Figure 8. The FakeM main module is responsible for launching embedded modules, such as a keylogger or for gathering sensitive files. The main module is also responsible for communicating with its C2 servers and handling commands issued by the C2 server.\r\n\r\nFigure 8: FakeM Architecture\r\nAll FakeM variants initiate communications with its C2 server and check the C2\u2019s response for a command. Also, all FakeM variants share a common command handler with the same capabilities, as seen in Table 2. The limited command set suggests that FakeM\u2019s functionality is obtained by additional assembly code provided by the C2 server with the 0x211 command. According to Trend Micro\u2019s initial analysis on FakeM, threat actors delivered and ran additional code that provided further capabilities to the Trojan, such as the ability to run shell commands, steal passwords, capture the screen and upload files.\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\n0x211\r\nRun assembly code directly from the C2.\r\n\r\n\r\n0x212\r\nIdle. Attempts to receive another command immediately instead of sleeping for 30 seconds.\r\n\r\n\r\n0x213\r\nSets a flag to end the session with the C2. This will force the Trojan to reestablish a session with the C2.\r\n\r\n\r\n0x214\r\nExit process.\r\n\r\n\r\n\r\nTable 2: Command handler within all variants of FakeM\r\n\r\nNow that we have covered the commonalities between FakeM variants, the following sections will dive into the specific variants of FakeM. Unit 42 categorizes the different variations of FakeM based on the method used to communicate with the C2 server, which has changed dramatically over the years.\r\nOriginal FakeM\r\nThe original variant of FakeM generates network beacons to its C2 server that begin with a 32-byte header that in most cases is meant to blend into network traffic generated by legitimate applications. Following this 32-byte header, the original variant of FakeM includes data encrypted using a custom encryption cipher that uses an XOR key of \u201cYHCRA\u201d and bit rotation between each XOR operation.\r\n\r\nThe original variant includes the FakeM discovered and published by Trend Micro in 2013, in which the authors of FakeM first attempted to evade detection of its C2 communications by pretending to be generated by legitimate messenger applications, such as MSN and Yahoo! messengers. Figures 9 and 10 show FakeM attempting to resemble MSN or Yahoo! Messenger traffic, as the first 32-bytes contain data that resemble legitimate traffic generated by these chat programs.\r\n\r\n\r\nFigure 9: FakeM using fake MSN messenger traffic for C2 communication\r\n\r\nFigure 10: FakeM using fake Yahoo! Messenger for C2 communication\r\nIn addition to emulating chat programs, FakeM has also included HTML code within the 32-byte header. As you can see in Figure 11, the overall structure of the beacon did not change, rather the only differences is the data in the header contains HTML tags. The HTML data in the header led Unit 42 to a whitepaper published by Malware.lu that suggested the MSN, Yahoo, and HTML versions of the original variant of FakeM all share a common server application that the threat actors use to build samples and control infected systems.\r\n\r\nFigure 11: FakeM HTML tags in C2 header\r\nIn October 2013, FireEye published a blog about a sample of FakeM that did not use fake messenger or HTML data in the first 32 bytes of the C2 traffic, but instead used four repeating bytes to fill this portion of the packet, as seen in Figure 12. Unit 42 tracks this under the original variant, as it uses the same algorithm to encrypt the data and otherwise shares a common structure to the MSN, Yahoo, and HTML versions with the exception of the modification to the first 32 bytes.\r\n\r\n\r\nFigure 12: FakeM C2 beacon with four repeating bytes\r\n\r\nFakeM SSL\r\nWhile performing infrastructure analysis on FakeM original variants, we came across shared infrastructure with domains that hosted C2 servers for malware samples that did not match the known FakeM communication protocols. Palo Alto Networks WildFire had analyzed many samples associated with these related C2 domains, all of which communicated with the C2 server using secure sockets layer (SSL). To determine the malware family that was generating this traffic, Unit 42 analyzed these samples and found that the functional code was the same as the original FakeM variant.\r\n\r\nThis discovery indicates the authors of FakeM introduced new code to the Trojan in order to use SSL to communicate with its C2 server. The drastic change in C2 channel warranted a new variant name, and we dubbed it \u201cFakeM SSL\u201d. During the analysis of these samples we did not find any operational C2 servers to complete a handshake to establish a SSL session. During the handshake, the FakeM SSL samples will tell the server it supports 36 different cipher suites even though the samples appear to only support one. Unit 42 believes the cipher suite within the FakeM SSL variants uses Diffie-Hellman for key exchange and the RC4 cipher to encrypt the C2 communications.\r\nFakeM Custom SSL\r\nIn July 2015, Scarlet Mimic delivered a spear-phishing email to a branch of the Russian government with intentions of installing a payload that was undetected by any antivirus vendors on VirusTotal. The high profile target and the lack of antivirus detection prompted Unit 42 to perform an in-depth analysis and found that it is yet another new variant of the FakeM Trojan. We also named this variant after it\u2019s communication protocol (FakeM Custom SSL.)\r\n\r\nThis new variant of FakeM shared the same functional code as its predecessors, but again the communications with the C2 dramatically differed from the other variants. Communications between this variant and the C2 server leverage what Unit 42 believes is modified SSL code, as the code is very similar to the FakeM SSL variant. The code appears to use Diffie-Hellman for key exchange and the RC4 algorithm like FakeM SSL; however, the initial packet sent to the C2 server did not contain a \u201cclient hello\u201d message, which is required to initiate an SSL handshake. Instead, the initial packet sent data as seen in Figure 13.\r\n\r\n\r\nFigure 13: Hexdump of FakeM custom SSL variant\r\nThis variant of FakeM skips the traditional SSL handshake, which involves an agreement on a cipher suite to use to encrypt communications. The FakeM code only supports one cipher suite, which makes the cipher suite agreement portion of the SSL handshake irrelevant. Instead, FakeM creates a session with its C2 server by exchanging keys. The lack of a valid handshake makes detection of this C2 stream difficult, as the packets sent between the Trojan and the C2 to establish this session contain random binary data. Network devices will also be unable to perform any SSL decryption due to the lack of detection and the inability to determine the cipher suite used to encrypt the data. Figure 14 below provides a visual depiction of the handshake procedure and the subsequent beacon and command messages.\r\n\r\nFigure 14: Communications between system and C2 server, including the key exchange\r\nThe handshake starts with a key exchange, which the Trojan initiates by creating a 2048-byte buffer that it will store its key (128-bytes, followed by null values as seen in Figure 13) and sending its key to the C2 server. The C2 will respond with its own key (also 128-bytes, followed by null values) that the Trojan will store and use to encrypt future communications.\r\n\r\nOnce this key exchange is complete, the Trojan acknowledges the receipt of the server\u2019s key by sending another 2048-byte packet to the server. To build the acknowledgement packet, the Trojan creates a 2048-byte buffer filled with null values and copies the string \u201cws32.dll\u201d to offset 8 and encrypts the buffer with the server\u2019s key.\r\n\r\nAfter sending the acknowledgement packet, the Trojan will gather local system information and include it in a beacon to the C2 server. Like the packets sent in the key exchange, the beacon sent by the Trojan to the C2 server is 2048-bytes in length; however, the system information gathered by the Trojan is only 296 bytes followed by 1752 are null values to fill the 2048 byte buffer. The system information follows the 296-byte structure seen below:\r\nstruct beaconToC2 {\r\n DWORD static_value_130h;\r\n CHAR username[128];\r\n CHAR computername[128];\r\n DWORD static_value_70000h;\r\n DWORD os_codepage;\r\n DWORD campaign_code_1;\r\n DWORD campaign_code_2;\r\n};\r\n\r\nThe Trojan will encrypt this data using the key provided by the C2 and send it to the server. The Trojan will then wait for the C2 to respond, which it will decrypt and parse for FakeM commands. Unit 42 has been unable extract any plug-ins from C2 network traffic; however, several FakeM custom SSL samples contain embedded plug-ins that run without interaction with the C2 server. Also, Unit 42 was able to extract several modules from the original FakeM server application, as seen in Table 3. All of these modules are shellcode-based plug-ins that would work with the custom SSL variant of FakeM with little to no modification.\r\n\r\n\r\n\r\n\r\nMD5\r\nSize (bytes)\r\nDescription\r\n\r\n\r\n7a1410b2eceb99ec268b50e9371e74c1\r\n3724\r\nProcess Plug-ins\r\n\r\n\r\n092085e76512f071cab12f76ed09b348\r\n2412\r\nShell Plug-ins\r\n\r\n\r\n8f4cbb78356cb672bf2566e44315eb96\r\n1768\r\nFile Plug-ins\r\n\r\n\r\n16ab40f84fc47bab2c7874bb3164c5b4\r\n2268\r\nScreen Plug-ins\r\n\r\n\r\n30337e99631a174d822dd3ea00a5f6cf\r\n2204\r\nRegedit Plug-ins\r\n\r\n\r\n1f3fbb789bcbe9186a50c4f4db269736\r\n1996\r\nService Plug-ins\r\n\r\n\r\n4313d9d5fc6a090e2abc41633cb2c1fd\r\n3196\r\nHostInfo Plug-ins\r\n\r\n\r\nfe75dff8b86dd8989d2ca00df19d51be\r\n2220\r\nKeyBoard Plug-ins\r\n\r\n\r\n3e184a7af74905f3d3acbec913252f72\r\n1884\r\nShell Plug-ins\r\n\r\n\r\nb59e8751b9f61bd4f4b9b62de8242751\r\n3896\r\nOE Pwd Plug-ins\r\n\r\n\r\n83ec457cba27e470404c942eb9242eeb\r\n2156\r\nU-Files Plug-ins\r\n\r\n\r\n\r\nTable 3: Modules extracted from the original FakeM variant's server application\r\n\r\nRelated to FakeM Original: CallMe\r\nCallMe is a Trojan designed to run on the Apple OSX operating system. This Trojan was delivered in targeted attacks on Uyghur activists in 2013 and used infrastructure associated with FakeM.\r\nIn February 2013, AlienVault performed analysis on the CallMe Trojan and found that it is based on a tool called Tiny SHell, an OSX shell tool whose source code is available on the Internet. The Trojan uses AES to encrypt the communication channel its C2 server, which will provide one of three commands to carry out activities on the compromised system, as seen in Table 4.\r\n\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\n1\r\nGet a file from the system and upload it to the C2 server.\r\n\r\n\r\n2\r\nPut a file on the system from the C2 server. File is saved to a specified filename in &lt;HOME directory&gt;\/downloads\/.\r\n\r\n\r\n3\r\nCreate a reverse shell to interact with the compromised system.\r\n\r\n\r\n\r\nTable 4: Commands Available in the CallMe OSX Malware\r\nThe infrastructure overlap between FakeM and CallMe involves the fully qualified domain name (FDQN) of \"googmail.org\", which was used by both FakeM and CallMe samples. This suggests that not only do these threat actors have the ability to compromise victims running the Microsoft Windows operating system, but they can also target individuals running Apple's OSX as well.\r\nRelated to FakeM Custom SSL: Psylo\r\nDuring infrastructure analysis of FakeM Custom SSL variants, Unit 42 found infrastructure overlaps between FakeM and another new, previously unreported Trojan that we named \u201cPsylo\u201d. Psylo is a tool that allows threat actors to upload and download files to and from a compromised system, as well as execute commands and applications on the system. The name Psylo is an anagram from the mutex created when initially running this payload, which is 'hnxlopsyxt'.\r\n\r\nPsylo is similar to FakeM in that they are both shellcode-based, and they have similar configurations and C2 communication channels. As you can see from the following two configuration structures, Psylo and FakeM have similar configurations with only the array length of the C2 locations being different.\r\n\r\n\r\n\r\nstruct psylo_c2_config {char[60] c2_host_1;char[60] c2_host_2;char[60] c2_host_3;DWORD c2_port_1;DWORD c2_port_2;DWORD c2_port_3;};\r\nstruct fakem_customssl_c2_config {char[64] c2_host_1;char[64] c2_host_2;char[64] c2_host_3;DWORD c2_port_1;DWORD c2_port_2;DWORD c2_port_3;};\r\n\r\n\r\n\r\nFigure 15: Comparison between Psylo and FakeM custom SSL configurations\r\nBoth use SSL to communicate with their C2 servers, and it appears they share common code to carry out the Diffie Hellman key exchange. We compared the Diffie Hellman code from Psylo with FakeM custom SSL variant and found that they were very similar, but the FakeM samples had some of the functionality within sub-functions, which rendered binary diffing between the two Trojans impossible.\r\n\r\nAnother slight difference involves how Psylo and FakeM generate random numbers for SSL. FakeM uses QueryPerformanceCounter to create a random number, whereas Psylo uses CryptGenRandom, both of which generate random numbers 68 bytes long. Interesting enough is that CryptGenRandom calls RtlGenRandom, which uses QueryPerformanceCounter along with other system attributes to generate a random number.\r\n\r\nWhen communicating with its C2 server, Psylo will use HTTPS with a unique user-agent of (notice the lack of a space between \"5.0\" and \"(Windows\"):\r\n\r\nMozilla\/5.0(Windows NT 6.1; WOW64; rv:24.0) Gecko\/20100101 Firefox\/24.0\r\n\r\nUnit 42 does not consider Psylo another variant of FakeM because Psylo has a command handler that differs dramatically from FakeM. Table 5 shows the Psylo command handler, which suggests it is less modular and supports more embedded functionality when compared to FakeM. It is possible that the threat actors created this Trojan as a standalone alternative to FakeM.\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\n0\r\nIdles for 10 seconds.\r\n\r\n\r\n2\r\nEnumerate all storage devices.\r\n\r\n\r\n3\r\nFind all files that starts with a particular string (%s*.*).\r\n\r\n\r\n5\r\nCreates a file to write to, deleting it if it already exists. Combined with 'E' command to download a file to the system.\r\n\r\n\r\nE\r\nWrites data from C2 to a file opened using the '5' command. Combined with '5' command to download a file to the system.\r\n\r\n\r\n6\r\nReads a file, which effectively uploads the file to the C2.\r\n\r\n\r\n7\r\nDelete a specified file.\r\n\r\n\r\n8\r\nExecute a command using WinExec. Responds to C2 with 's' if successful or 'r' if unsuccessful.\r\n\r\n\r\n9\r\nTimestomps. Sets a specified file's timestamps to match that of a system file in the System32 directory.\r\n\r\n\r\n\r\nTable 5: Command handler in Psylo that differs dramatically from FakeM\r\n\r\nMobileOrder: Mobile Devices the Next Frontier\r\nAnother discovery we made while researching this blog is an overlap between Psylo infrastructure and a Trojan focused on compromising Android mobile devices. Unit 42 tracks this mobile Trojan as MobileOrder, as the authors specifically refer to commands within the app as orders. The connection between FakeM, Psylo, and MobileOrder suggest that Scarlet Mimic is now expanding their espionage efforts from PCs to mobile devices, which marks a major shift in tactics.\r\n\r\nMobileOrder starts by registering itself as device administrator so that a normal user cannot uninstall it by simply clicking \u201cuninstall\u201d in settings. It will copy an embedded PDF file from \u201cres\/raw\/rd.pdf\u201d to SD card \"\/android\/9074ca3f18e201c204ec1d852264bb5432644ba46f54f361a146957.pdf\" and launches the mobile device\u2019s default PDF viewer to display this PDF file, which acts as a decoy document. After displaying the decoy document, the malicious code runs in background. The malicious code consists of the following parts:\r\n\r\n\tAn Android geographical location SDK provided by AMAP.\r\n\tActor developed code that carries out Trojan\u2019s functionality.\r\n\r\nThe malware uses the AMAP SDK to get accurate location of infected devices by GPS, mobile network (such as base stations), WiFi and other information. MobileOrder acts on instructions provided by its C2 server, which it communicates with over TCP port 3728. All C2 communications are encrypted with the AES algorithm using a key generated by computing five MD5 hashes starting with the key \"1qazxcvbnm\", and adding a salt value of \u201c.)1\/\u201d in each iteration.\r\n\r\nThe C2 server will respond to requests from MobileOrder with commands that the Trojan refers to as \u201corders\u201d. MobileOrder contains a command handler with functionality that provides a fairly robust set of commands, as seen in Table 6. The first byte of data provided by the C2 server is order number, which is followed by the encrypted data that needed to carry out the specific order.\r\n\r\n\r\n\r\nOrder #\r\nOrder Name\r\nBehaviors\r\n\r\n\r\n18\r\nOrder_Folder_List\r\nUpload names and attributes of files under specified path\r\n\r\n\r\n20\r\nOrder_Process_List\r\nUpload all running processes information\r\n\r\n\r\n24\r\nOrder_HostInfo\r\nUpload device information including IMEI, IMSI, SIM card serial number, phone number, Android version, device manufacturer, device model, SD card size, network type, device locking status, country, carrier, time zone, language, install app list, browser bookmarks, etc.\r\n\r\n\r\n26\r\nOrder_FileDelete\r\nDelete specified file\r\n\r\n\r\n27\r\nOrder_DownLoad\r\nDownload specified file to SD card\u2019s Android\/data\/tmp\/ directory.\r\n\r\n\r\n28\r\nOrder_UpFile\r\nUpload specified file to C2 server\r\n\r\n\r\n51\r\nOrder_Sms\r\nUpload all received and sent SMS addresses, content, date, time to C2 server\r\n\r\n\r\n52\r\nOrder_Contact\r\nUpload all contacts\u2019 information to C2 server\r\n\r\n\r\n53\r\nOrder_Call\r\nUpload all phone calling history information\r\n\r\n\r\n54\r\nOrder_Camera_front_photo\r\nTake a picture by device\u2019s front camera\r\n\r\n\r\n56\r\nOrder_SetSleepTime\r\nSet sleep time interval\r\n\r\n\r\n57\r\nOrder_SetOnline\r\nStop sleep\r\n\r\n\r\n58\r\nOrder_SetMediaRecorder\r\nStart audio recorder in specified time\r\n\r\n\r\n59\r\nOrder_GetLoc\r\nUpload information about network operator, MCC, MNC, network type, GSM cell location, CID, LAS, BSSS, etc. This information can be used to locate the device.\r\n\r\n\r\n60\r\nOrder_GetGps\r\nUpload GPS location by AMAP SDK.\r\n\r\n\r\n61\r\nOrder_SetTelRecorderOn\r\nActivate phone calling recording\r\n\r\n\r\n62\r\nOrder_SetTelRecorderOff\r\nDeactivate phone calling recording\r\n\r\n\r\n81\r\nOrder_Install\r\nInstall specified APK file. May install silently or install to system app according to C2 command data\r\n\r\n\r\n82\r\nOrder_Uninstall\r\nUninstall specified app\r\n\r\n\r\n84\r\nOrder_StartApp\r\nLaunch specified app\r\n\r\n\r\n85\r\nOrder_SendBroadcast\r\nSend specified Android broadcast to launch other apps\r\n\r\n\r\n86\r\nOrder_Shell\r\nExecute specified shell commands\r\n\r\n\r\n87\r\nOrder_OpenTrack\r\nStart geolocation tracking in AMAP SDK\r\n\r\n\r\n88\r\nOrder_CloseTrack\r\nStop geolocation tracking in AMAP SDK\r\n\r\n\r\n90\r\nOrder_CheckScreen\r\nCheck whether phone screen is on (or said whether the phone is used by its owner)\r\n\r\n\r\n\r\nTable 6: MobileOrder command handler\r\n\r\nInfrastructure Overlap and Related Tools\r\nThere is some infrastructure overlap in the C2 servers used by almost all of the FakeM variants, as well other Trojans such as MobileOrder, Psylo, and CallMe. There are also infrastructure ties between some FakeM variants and older activity using Trojans such as Elirks, Poison Ivy, and BiFrost, which were used in attacks as old as 2009. The domain names used to host C2 servers are a mix of actor-registered and Dynamic DNS (DDNS,) though most are DDNS. The DDNS domains in turn are linked to a small grouping of ASNs, with one ASN often largely tied to one FakeM variant. Most of the FakeM MSN C2s resolve to IP addresses associated with ASN 22781 (RBLHST - Reliablehosting.com). However, we found one MSN sample that shared infrastructure with some FakeM Custom SSL variants.\r\n\r\nThere is a similar overlap between FakeM MSN, FakeM HTML, and FakeM SSL. The registrant email xsldmt@xj163[.]cn was used to register several domains used as C2s: yourturbe[.]org, websurprisemail[.]com and googmail[.]org. One of these domains was also used in the 2013 CallMe activity at the same time it was being used for FakeM MSN samples. The targeting and decoy style also matches with the FakeM activity.\r\n\r\nThere is PE resource overlap between some FakeM MSN samples and some samples of the BiFrost and Poison Ivy Trojan. This may indicate that the same developer who created the particular BiFrost and Poison Ivy samples was also involved in developing FakeM MSN. Unit 42 found an overlap between the RT_VERSION resources, which contains the version information of a Portable Executable (PE) file, shared amongst the three different Trojans. The shared RT_VERSION resource (MD5: 55b7a118203a831cc69b37b785015c54) contained the following information:\r\nComments: Release\r\nCompanyName: Develop Team\r\nFileDescription: Utility Application\r\nFileVersion: 4.0\r\nInternalName: Utility\r\nLegalCopyright: Copyright (C) 2008\r\nLegalTrademarks: DT.Inc\r\nOriginalFilename: Utility.EXE\r\nPrivateBuild: 4.0b\r\nProductName: Utility Application\r\nProductVersion: 4.0\r\nThe overlap between Elirks, FakeM SSL, Psylo, and MobileOrder exists entirely in their command and control infrastructure, through domain names and\/or IP resolution. Samples of these three used some of the same C2 domains, notably lenovositegroup[.]com, ufoneconference[.]com, and websurprisemail[.]com, while some resolution overlap includes 118.193.212[.]12, 210.206.219[.]241, and 59.188.239[.]117. Similarly, some FakeM Yahoo C2 domains and FakeM Custom SSL C2 domains also have overlapping IP resolutions, notably 95.154.204[.]198.\r\n\r\nScarlet Mimic also uses the infamous HTRAN tool on at least some of their C2 servers. HTRAN is a proxying tool that allows actors to conceal the true location of their C2 server. Actors will run HTRAN on a server and configure their malware to interact with that server; however, the actor will configure HTRAN to forward traffic to another server where the actual C2 server exists. For example, the FakeM C2 domain of \u201cmuslim.islamhood[.]net\u201d[1] resolved to the IP address 59.188.239.117 during analysis, but the server responded with the following error message:\r\n\r\n[SERVER]connection to 68.71.35.135:8081 error\r\n\r\nThis error message suggests that the HTRAN application running on 59.188.239.117 was unable to connect to the real C2 server hosted at 68.71.35.135.\r\nPrior Publications\r\nThroughout this report, we have referenced multiple previous blogs and white papers, from Unit 42 and others, that have documented elements of this threat in the past. In addition to those documents readers may also find the following publications interesting.\r\n\r\nIn 2014, Citizen Lab released a paper on threats against civil society that referenced some of these attacks as the \u201cDomain Name Family\u201d or DNF.\r\n\r\nKaspersky Lab has produced excellent research on attacks against Uyghur and Tibetan activists. In 2013, they identified an Android Trojan that was also targeting these groups. Our analysis indicates this malware is different from the MobileOrder Trojan described above, but they serve very similar purposes.\r\nOn January 12, 2016, Cylance published a blog linking an exploit document to the group Mandiant refers to as APT2 and CrowdStrike as \u201cPutter Panda.\u201d While there does appear to be a small overlap between IP addresses used in attacks from this group and those of Scarlet Mimic, our team has not concluded that these groups are one in the same.\r\n\r\nConclusion\r\nThe information discovered by Unit 42 and shared here indicates Scarlet Mimic is likely a well-funded and skillfully resourced cyber adversary. Scarlet Mimic has carried out attacks using both spear-phishing and watering holes since at least 2009 with increasingly advanced malware, and has deployed malware to attack multiple operating systems and platforms. Despite the apparent technical acumen, their decoy documents are typically not well crafted regardless of the use of the target\u2019s language, though they do use timely subject lures.\r\n\r\nThe primary source of data used in this analysis is Palo Alto Networks WildFire, which analyzes malware used in attacks from around the globe. The system is also fed with malware samples collected through sharing partnership with other security vendors, including our partners in the Cyber Threat Alliance. To connect attacks to each other based on malware behavior and command and control infrastructure, we relied on Palo Alto Networks AutoFocus threat intelligence. AutoFocus users can view all of the files related to Scarlet Mimic and the malware associated with the group using the following links:\r\n\r\n\tScarletMimic\r\n\tFakeM\r\n\tPsylo\r\n\tMobileOrder\r\n\r\nPalo Alto Networks customers are protected from Scarlet Mimic attacks through many components of our platform.\r\n\r\n\tThreat Prevention signatures for the software vulnerabilities listed in this report are available to detect the exploit files during delivery.\r\n\tTraps, our advanced endpoint solution, can prevent the software vulnerabilities listed in this report from being exploited on a Windows host.\r\n\tWildFire classified all of the Android and Windows malware described in this report as malicious.\r\n\tWe have released anti-malware signatures for the files listed in this report.\r\n\tThe domain names used for command and control have been classified as malicious in PANDB.\r\n\r\nScarlet Mimic Indicator Data\r\nFakeM Custom SSL Samples\r\n12dedcdda853da9846014186e6b4a5d6a82ba0cf61d7fa4cbe444a010f682b5d\r\n33e50c44804d4838dba6627b08210029ff9106fa7fd16cd7255271e153f58b05\r\n3d9bd26f5bd5401efa17690357f40054a3d7b438ce8c91367dbf469f0d9bd520\r\n5182dc8667432d76a276dc4f864cdfcef3e481783ebaf46d3b1397080b798f4a\r\n523ad50b498bfb5ab688d9b1958c8058f905b634befc65e96f9f947e40893e5b\r\n5dade00db195087aa336ce190b5fd1c22992c49556c623b42a9f742d73241a7f\r\n7156f6416e7116e52f9c67f4e716b1dbea17387e61009c7f2825debbbb4dcb73\r\n79aca57905cca1e56b0cedf48a4d81812639c333ee6532d90a074d64b3852d6f\r\n879edf0417c4a9759040b51bf83b2fc918a6644a7c29a52252003a63036aea5c\r\n9b77bbb620f50632fae17c40c7469fc93ffdbc4136a6d893a9a10a44bc435da5\r\na1b7fe2acdb7a5b0c52b7c1960cfad531a7ca85b602fc90044c57a2b2531699f\r\na268cc4931781d1d8094a4f8f596c2de3d662f2581c735b0810ff0ecefe3f859\r\na4abbcfdbf4a6c52349a843eac0396e6d8abb05f1324223980d824629a42ef7a\r\na569f3b02a4be99e0b4a9f1cff43115da803f0660dd4df114b624316f3f63dc6\r\nb4c1e9c99f861a4dd7654dcc3548ab5ddc15ee5feb9690b9f716c4849714b20d\r\nbbdedcfe789641e7f244700e8c028ef51094b66508f503876eb0d6aa16df6aa8\r\nc7b9e6b5ab07e6da404af9894c8422d9a0c9586334ddc0a3c1ea6bf23ef97fb2\r\ncaeace73a17e220634525d2a4117525fd60cb86a06873c86571e89d156f8d72d\r\ncaf76e19a2681dd000c96d8389afc749e774c083aef09f023d4f42fbc49d4d3d\r\ne96097826179a66cc3061be0f99f7b55cc9692a6378b5c4364699327823098ab\r\nf511b13341c9fb4ec9ecfcfe5a5813b964c362d7c709c402ead4e010d857bf6c\r\nfa08a498da0b31e77669d51a28dff166d84983fa6af693063c08f312fdce93e3\r\ndf9872d1dc1dbb101bf83c7e7d689d2d6df09966481a365f92cd451ef55f047d\r\nFakeM SSL Samples\r\n0aab09bf0db30a4be28d19475082fd5e7f75879bf9029fdd8dfc3a1e1f072b0c\r\n2e1472a65a8df43c8bc9b0aff954fbc1a093c4214f6a718a08e1321db83ca683\r\n3209ab95ca7ee7d8c0140f95bdb61a37d69810a7a23d90d63ecc69cc8c51db90\r\n41948c73b776b673f954f497e09cc469d55f27e7b6e19acb41b77f7e64c50a33\r\n4a4dfffae6fc8be77ac9b2c67da547f0d57ffae59e0687a356f5105fdddc88a3\r\n5154511a439bb367b7dd56232eb15281cb6dc4d64ea3a06e7fbbe6b176e385d4\r\n5fae5750797ebe7e7a6a6919a7d66deffb141ec28737bd72a1f7da8edd330b60\r\naa8a302a53bd39b2d2a6e3d8497575e2a5f9757b248e34c8e0821ce9eee5cc32\r\nb3c9bb22fa1bc358dc23a1a4bdaf85ad1add4d812b107b7ab887affbf689933a\r\ncd506679fd32dab16dee6fbf1cfdfe0836e092a4f5669418a199d99c9cd33abd\r\nd1dd4469c7b5c462e5ff2dcef5d22775250e9ebf395f65da624f18ea7144e173\r\nd698008e417da867d02e2f5cdcc80ff92af753dd585fada42fc611c2d7332c3a\r\nFakeM Original Samples\r\n53af257a42a8f182e97dcbb8d22227c27d654bea756d7f34a80cc7982b70aa60\r\n9adda3d95535c6cf83a1ba08fe83f718f5c722e06d0caff8eab4a564185971c5\r\n53cecc0d0f6924eacd23c49d0d95a6381834360fbbe2356778feb8dd396d723e\r\n631fc66e57acd52284aba2608e6f31ba19e2807367e33d8704f572f6af6bd9c3\r\n7bfbf49aa71b8235a16792ef721b7e4195df11cb75371f651595b37690d108c8\r\n7c9421a4605decfa1b3e22addbca98d86ea757dcd8ff8e075d13228c99618637\r\n202975d10ba417cf441e8f9986d2496807fe39e057d3226ec3b2713f0c218cd8\r\n22e7517d8996e92998eb996416f9d8ef06b3b1c220c1a5d29ccd5aaef7b10c72\r\n435df30d139ccbe5ce4e5ca6fe072e42e96d5ea1efd5317deebce462ecccc7ab\r\n47d9ba5f7bf70c5d2b7a832e070957cc7ebdcfd0a6ee75851df16dc45971ce8a\r\n4a3d0df9fa198a7ebe45db5239d22067e74924b1aace52029b3acc9b51af691e\r\n4d539f638ed476ca08da838cdfbf710dae82b582256d60a009e9d304f6822e65\r\nbe0e8da7e261ec7d08eaa78e79ceb1be47c324b8e142097bf6569f9471c98a4e\r\nc30d03750458bb5f2b03d6bd399ffca6d378a3adb5a74bee3b6ba4b982dbf273\r\ncc7db456825e266849090b6fa95a94ad8c4c717712b610b0d39077af5222f4be\r\nd6d2a77f8ed2fe9fed9ee6dcb4cc0b339ba47a575c717c35815243c752d8f60c\r\ndb8338e6b883fdceaa02c10ad683547a26ae32e0d4641cc24c7bd3b45154abb0\r\ne8e5ecf525c5259651bfbdf1923215729ec67658225eca1b02519f5f6279eacb\r\nec4deb761b09ddc706804ef669836cf4b199f1d74b14ad623a6f6cc2f38190b8\r\n669ce0975c133d54e414dbf1de546aed742e76fe3e60568e2bd4747b7e0f8b70\r\n0d77f5f1d4c0f02fb88ac33fa365b17d28d1521cea59329ca4b3dd0b7031a60e\r\n363d9557861fab2d83d04847b967996361e670e571b335c7a535bc6278cba149\r\n7fb2c37431fd7b05414b134732ba0b29cd7dad17fc176627ee0815aac60c1ab9\r\n77e4ef9e08f1095487b4fa27492b4c9b8e833f29598f99a0d10f7c85b4254761\r\na4ffca5f1c3d9c21629fa98a1e91121d954ab9347e86ac3c9613dae61bf30393\r\n428121c421bf81a0d689014cf21ec7951b0c32add86198e06f7d636981f68755\r\na195f564aa2fb66db119e2fbec93e319a973e5cf50fbf9fc08bd81f9b7ee8af8\r\nc1e8ff8ebe3754bc7d14509ef3678edf7551d876d3fa847d07d469c09bceae91\r\n53238f67ac7e4cc27264efbacc8712bd97a5775feaf633c63adaa0785d038e8a\r\n508a7cab0f2a69ba66e92e86817a49ecd1b9c8ae11a995147944995fc868dfad\r\nfb60d14de4dba022f11437845d465a661d0c78d3d097a38770816f06992bf0af\r\n8da2f9afd914a4318a97f4d74809c0c383f8ebf0d3d6e3d3715efbd71a66a52f\r\n6fe33c672fd30bba9bbc89dc7d88993d8783382c9f9c510677b1bb068a5f1e51\r\n6a1c7999b4ba92899d3364fc729d0f052680be5a71dd0f13cbabdb19b82bf858\r\n5db51f2f7c31de7d165ec4892ae7dcedaa036caedeef718b57953d7935582f04\r\n27167a9d63f5ddc68a12decb1a1e0a2a29c72fe0681dca2c4f3d169f048a9d38\r\n6f10c892133b5dac6c40cfe77ca32b42572bc56909481b236080dfc143ef9afd\r\nde12cd8d11478d17342c60239837c1afcc9fee72df6ffdf9943802640d43f77a\r\n0f2db64b8283b76d49c9bb272beafab8323f941b6dc3888b42ff02f08634d016\r\nPsylo Samples\r\n19bbee954ac1a21595e63cb86d1a596236aed353804aec5cb8adfa62e70280d3\r\na9f0bddc3d3516af8355e8ac17309528cd018347e5f56a347c14da0a83b0028a\r\n00bb399c429e0f1f7de751103fe92b5f820d1686d01662a08583b7a94aaed94e\r\nMobileOrder Sample\r\n03004ccc23033a09532bea7dfa08c8dfa85814a15f5e3aedb924a028bcd6f908\r\nCallMe Samples\r\n071c34b9701dd84f9590ba899a8af3eeec228a928f2d98a80dbc780e396ee01a\r\nd1f0658bbb15ab2bccc210d7e1f21b96e14ae22de8494ca95b12e182f3d0f693\r\n9ff687a813a5cb5ff10374c86f852534c1aa3e5a221123214bf52b2ff455a5da\r\n8c423506c0c7ebe1e61071374ecf0806463a02a2100b5daa1bd942129ff8a235\r\n91e36e720477146f1a0c050d3bc74bc6683a03e7631317ded3c598a10465dcc8\r\nc981db20d588ba2d0f437b4e5459e7c6763f52a97841450c94591ca28a9a2d69\r\n95dba004f949e44cb447246f3d2420b01db4541d0e4fa7b00d798f38a3d251e4\r\nFakeM Custom SSL C2 Servers\r\naaa123.spdns[.]de\r\nadmin.spdns[.]org\r\ndetail43.myfirewall[.]org\r\neconomy.spdns[.]de\r\nfirefox.spdns[.]de\r\nfirewallupdate.firewall-gateway[.]net\r\nintersecurity.firewall-gateway[.]com\r\nkaspersky.firewall-gateway[.]net\r\nkasperskysecurity.firewall-gateway[.]com\r\nkissecurity.firewall-gateway[.]net\r\nmail.firewall-gateway[.]com\r\nnews.firewall-gateway[.]com\r\nopero.spdns[.]org\r\nsys.firewall-gateway[.]net\r\nFakeM SSL C2 Servers\r\naccount.websurprisemail[.]com\r\naddi.apple.cloudns[.]org\r\nbailee.alanna.cloudns[.]biz\r\nbee.aoto.cloudns[.]org\r\nbook.websurprisemail[.]com\r\ndesk.websurprisemail[.]com\r\ndolat.diyarpakzimin[.]com\r\ndolat.websurprisemail[.]com\r\ndolet.websurprisemail[.]com\r\ngithub.ignorelist[.]com\r\nislam.youtubesitegroup[.]com\r\nmareva.catherine.cloudns[.]us\r\nmuslim.islamhood[.]net\r\np.klark.cloudns[.]in\r\nppcc.vasilevich.cloudns[.]info\r\npress.ufoneconference[.]com\r\nvip.yahoo.cloudns[.]info\r\nFakeM Original C2 Servers\r\n207.204.225[.]117\r\naccounts.yourturbe[.]org\r\naddnow.zapto[.]org\r\nbits.githubs[.]net\r\nclean.popqueen.cloudns[.]org\r\neconomy.spdns[.]eu\r\neemete.freetcp[.]com\r\nemail.googmail[.]org\r\nfish.seafood.cloudns[.]org\r\nfreeavg.sytes[.]net\r\nfreeonline.3d-game[.]com\r\nibmcorp.slyip[.]com\r\nlemondtree.freetcp[.]com\r\nliumingzhen.myftp[.]org\r\nliumingzhen.zapto[.]org\r\nn.popqueen.cloudns[.]org\r\nnews.googmail[.]org\r\noic-oci.3-a[.]net\r\npolat.googmail[.]org\r\nqq.ufoneconference[.]com\r\nqq.yourturbe[.]org\r\nsisiow.slyip[.]com\r\nupdate.googmail[.]org\r\nuprnd.flnet[.]org\r\nvideo.googmail[.]org\r\nwebmail.yourturbe[.]org\r\nworldwildlife.effers[.]com\r\nwww.angleegg.ddns[.]us\r\nwww.angleegg.xxxy[.]info\r\nwww.googmail[.]org\r\nyouturbe.co[.]cc\r\nyycc.mrbonus[.]com\r\nzjhao.dtdns[.]net\r\nPsylo C2 Servers\r\napple.lenovositegroup[.]com\r\nmm.lenovositegroup[.]com\r\nftp112.lenta.cloudns[.]pw\r\nwww.gorlan.cloudns[.]pro\r\notcgk.border.cloudns[.]pw\r\nMobileOrder C2 Servers\r\nziba.lenovositegroup[.]com\r\nCallMe C2 Servers\r\napple12.crabdance[.]com\r\nupdate.googmail[.]org\r\napple12.crabdance[.]com\r\nalma.apple.cloudns[.]org\r\n\r\n\u00a0","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Robert Falcone"},{"@type":"Person","name":"Jen Miller-Osborn"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"11904","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=11904' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fscarlet-mimic-years-long-espionage-targets-minority-activists%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fscarlet-mimic-years-long-espionage-targets-minority-activists%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-11904 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-11904 entry-meta">
			
			
			<span class="post-views-count">38,761</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'11904','like')"><i class="ui ui-2"></i><span class="ml-5">2</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 27</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fscarlet-mimic-years-long-espionage-targets-minority-activists%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fscarlet-mimic-years-long-espionage-targets-minority-activists%2F+-+Scarlet+Mimic%3A+Years-Long+Espionage+Campaign+Targets+Minority+Activists" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fscarlet-mimic-years-long-espionage-targets-minority-activists%2F&title=Scarlet+Mimic%3A+Years-Long+Espionage+Campaign+Targets+Minority+Activists&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/scarlet-mimic-years-long-espionage-targets-minority-activists/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a> and <a href="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/" title="Posts by Jen Miller-Osborn" class="author url fn" rel="author">Jen Miller-Osborn</a>        </p>
        <p><time datetime="2016-01-24T15:00:14+00:00">January 24, 2016 at 5:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/reports/" rel="category tag">Reports</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/android/" rel="tag">Android</a>, <a href="https://unit42.paloaltonetworks.com/tag/apple/" rel="tag">Apple</a>, <a href="https://unit42.paloaltonetworks.com/tag/autofocus/" rel="tag">AutoFocus</a>, <a href="https://unit42.paloaltonetworks.com/tag/brutishcommand/" rel="tag">BrutishCommand</a>, <a href="https://unit42.paloaltonetworks.com/tag/callme/" rel="tag">CallMe</a>, <a href="https://unit42.paloaltonetworks.com/tag/cyber-espionage/" rel="tag">cyber espionage</a>, <a href="https://unit42.paloaltonetworks.com/tag/cyber-threat-alliance/" rel="tag">Cyber Threat Alliance</a>, <a href="https://unit42.paloaltonetworks.com/tag/cybersecurity/" rel="tag">cybersecurity</a>, <a href="https://unit42.paloaltonetworks.com/tag/espionage/" rel="tag">Espionage</a>, <a href="https://unit42.paloaltonetworks.com/tag/fakem/" rel="tag">FakeM</a>, <a href="https://unit42.paloaltonetworks.com/tag/mac-os-x/" rel="tag">Mac OS X</a>, <a href="https://unit42.paloaltonetworks.com/tag/microsoft/" rel="tag">microsoft</a>, <a href="https://unit42.paloaltonetworks.com/tag/mobileorder/" rel="tag">MobileOrder</a>, <a href="https://unit42.paloaltonetworks.com/tag/psylo/" rel="tag">Psylo</a>, <a href="https://unit42.paloaltonetworks.com/tag/scarlet-mimic/" rel="tag">Scarlet Mimic</a>, <a href="https://unit42.paloaltonetworks.com/tag/skiboot-loader/" rel="tag">SkiBoot Loader</a>, <a href="https://unit42.paloaltonetworks.com/tag/subtractthis/" rel="tag">SubtractThis</a>, <a href="https://unit42.paloaltonetworks.com/tag/trojans/" rel="tag">Trojans</a>, <a href="https://unit42.paloaltonetworks.com/tag/wildfire/" rel="tag">WildFire</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/scarlet-mimic-years-long-espionage-targets-minority-activists/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2>Executive Summary</h2>
<p>Over the past seven months, Unit 42 has been investigating a series of attacks we attribute to a group we have code named “Scarlet Mimic.” The attacks began over four years ago and their targeting pattern suggests that this adversary’s primary mission is to gather information about minority rights activists. We do not have evidence directly linking these attacks to a government source, but the information derived from these activities supports an assessment that a group or groups with motivations similar to the stated position of the Chinese government in relation to these targets is involved.<span id="more-11904"></span></p>
<p>The goal of this report is to expose the tools, tactics and infrastructure deployed by Scarlet Mimic in order to increase awareness of this threat and decrease its operational success through deployment of prevention and detection countermeasures. From our vantage point, we are not able to identify which attacks have been successful against which organizations. But the fact that the tools Scarlet Mimic deploys have been under development for years suggests an active adversary that has been successful in some percentage of its operations. Based on our analysis, we are also seeing Scarlet Mimic start to expand its espionage efforts from PCs to mobile devices, marking an evolution in its tactics.</p>
<p>Individuals and groups of all different types may become the target of cyber espionage campaigns. The most well known victims of cyber espionage are typically government organizations or high-tech companies, but it’s important to recognize that espionage-focused adversaries are tasked to collect information from many sources.</p>
<p>The attacks we attribute to Scarlet Mimic have primarily targeted Uyghur and Tibetan activists as well as those who are interested in their causes. Both the Tibetan community and the Uyghurs, a Turkic Muslim minority residing primarily in northwest China, have been targets of multiple sophisticated attacks in the past decade. Both also have history of strained relationships with the government of the People’s Republic of China (PRC), though we do not have evidence that links Scarlet Mimic attacks to the PRC.</p>
<p>Scarlet Mimic attacks have also been identified against government organizations in Russia and India, who are responsible for tracking activist and terrorist activities. While we do not know the precise target of each of the Scarlet Mimic attacks, many of them align to the patterns described above.</p>
<p>The Scarlet Mimic attacks primarily center around the use of a Windows backdoor named “FakeM.” It was first described by Trend Micro in 2013 and was named FakeM because its primary command and control traffic mimicked Windows Messenger and Yahoo! Messenger network traffic to evade detection. We have identified two subsequent variants of the FakeM family, which has undergone significant changes since it was exposed in 2013. We have also identified nine distinct “loader” malware families, which Scarlet Mimic appears to use to avoid detection when infecting a system.</p>
<p>In addition to the FakeM variants, Scarlet Mimic has deployed Trojans that target the Mac OS X and Android operating systems. We have linked these attacks to Scarlet Mimic through analysis of their command and control (C2) infrastructure.</p>
<p>To infect individuals with access to the data the actors desire, Scarlet Mimic deploys both spear-phishing and watering hole (strategic web compromise) attacks. Using these tactics they can directly target previously identified individuals (spear phishing) as well as unidentified individuals who are interested in a specific subject (watering hole). In their spear phishing attacks, Scarlet Mimic has exploited five separate vulnerabilities. However, in many cases they chose to forgo exploiting a software vulnerability and used self-extracting (SFX) RAR archives that use the Right-to-Left Override character to mask the true file extension, tricking victims into opening executable files.</p>
<p>As with many other attackers who use spear-phishing to infect victims, Scarlet Mimic makes heavy use of “decoy” files. These are legitimate documents that contain content relevant to the subject of the spear phishing e-mail. After the system is infected, the malware displays the decoy document to trick the user into believing nothing harmful has occurred. These decoy documents allow us to identify the theme of the spear phishing e-mail and in some cases the target of the attack.</p>
<p>The most recent Scarlet Mimic attacks we have identified were conducted in 2015 and suggest the group has a significant interest in both Muslim activists and those interested in critiques of the Russian government and Russian President Vladimir Putin. Based on their previous targets we suspect these individuals may be targeted based on the information they posses on activist groups.</p>
<p>The primary source of data used in this analysis is Palo Alto Networks <a href="https://www.paloaltonetworks.com/products/technologies/wildfire.html" target="_blank">WildFire</a>, which analyzes malware used in attacks across the world. The system also analyzes malware samples collected through a sharing partnership with other security vendors, including our partners in the <a href="http://cyberthreatalliance.org/">Cyber Threat Alliance</a>. To connect attacks to each other based on malware behavior and command and control infrastructure, we relied on <a href="https://www.paloaltonetworks.com/products/platforms/subscriptions/autofocus.html">AutoFocus</a> threat intelligence. AutoFocus users can view all of the files related to Scarlet Mimic and the malware associated with the group using the following links:</p>
<ul>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.PaloAlto-ScarletMimic" target="_blank">ScarletMimic</a></li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.FakeM" target="_blank">FakeM</a></li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Psylo" target="_blank">Psylo</a></li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.MobileOrder" target="_blank">MobileOrder</a></li>
</ul>
<h2>Introduction</h2>
<p>The better we can understand the threats to our networks and systems, the more effective we will be at preventing those threats. The goal of this report is to help network defenders better understand attacks from a group we have named Scarlet Mimic. This group has been conducting attacks for at least four years using a backdoor Trojan that has been under active development. The group primarily deploys spear-phishing e-mails to infect its targets, but was also responsible for a watering hole (strategic web compromise) attack in 2013.</p>
<p>Attacks from this group have been reported publicly in the past, but mostly as disparate, unconnected incidents. Based on analysis of the data and malware samples we have collected, Unit 42 believes the attacks described herein are the work of a group or set of cooperating groups who have a single mission, collecting information on minority groups who reside in and around northwestern China. In the past, Scarlet Mimic has primarily targeted individuals who belong to these minority groups as well as their supporters, but we’ve recently found evidence to indicate the group also targets individuals working inside government anti-terrorist organizations. We suspect these targets are selected based on their access to information about the targeted minority groups.</p>
<p>In the following sections we will describe selected attacks we have identified and who their likely targets are. We will also provide detailed analysis of the latest variants of the malware they deploy (known as FakeM) as well as other associated tools that allow Scarlet Mimic to target Android and OS X devices.</p>
<p>Attacks launched by this group were publicly exposed on 2013 in a Trend Micro report about the FakeM Trojan. Since that reports release, Scarlet Mimic has deployed two additional versions of the malware. They have also deployed nine separate “loader” Trojans they use to infect systems with their backdoor.</p>
<h2>Attack Details</h2>
<p class="normal">The majority of attacks we associate with Scarlet Mimic follow the pattern shown in Figure 1.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet1.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11905" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet1-500x296.png" alt="scarlet1" width="500" height="296" /></a></p>
<p style="text-align: center;">Figure 1: “Spear Phishing with Decoy” Attack Pattern Deployed by Scarlet Mimic</p>
<p>The attacker sends a spear-phishing e-mail with a subject and body content that appeal to the targeted user. This e-mail carries an attachment, which is typically a document that exploits a Microsoft Office vulnerability. The attachment uses a file name that is related to the e-mail content to trick the user into opening it. If the user opens the file and the exploitation is successful, a backdoor Trojan is installed on the system that gives the attacker access and a decoy document is displayed to the victim. Decoy documents are typically non-malicious versions of the content the user expected to see when opening the attachment.</p>
<p>Many of the targets and spoofed or compromised sending e-mail addresses have contact information on the Internet. The apparent sender email usually appears to be someone associated with the accompanying text, when appropriate, while the target emails are usually also available online tied to target organizations. A small subset of the decoys could not be found online and may be from previous compromises by Scarlet Mimic.</p>
<p>Many attackers deploy this particular pattern, as it is often successful at infecting a user without alerting the user of the infection. This is the exact same pattern, for example, deployed by the attackers in <a href="http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/" target="_blank">Operation Lotus Blossom</a>.</p>
<p>We have identified spear phishing documents from Scarlet Mimic exploiting the following vulnerabilities.</p>
<ul>
<li>CVE-2012-0158</li>
<li>CVE-2010-3333</li>
<li>CVE-2010-2883</li>
<li>CVE-2010-2572</li>
<li>CVE-2009-3129</li>
</ul>
<p>We also know Scarlet Mimic uses a number of toolkits to create documents that contain exploit code to install the FakeM payload on a compromised system. Unit 42 tracks the toolkits delivering FakeM under the names <a href="http://researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin/">MNKit</a>, WingD and Tran Duy Linh. These kits appear to be used by many attack groups, and they alone are not a good indication of Scarlet Mimic activity.</p>
<p>Additionally, in many cases these threat actors did not use an exploit document at all, rather they sent self-extracting (SFX) RAR archives that use the Right-to-Left Override character to mask the true file extension. For example, the following two filenames of SFX archives used to deliver FakeM contain the RLO character (bolded):</p>
<p><em>Update about the status of Tenzin Delek Rinpoche&#8217;ashes<strong>%E2%80%AE</strong>cod.scr</em><br />
<em>tepsiliy mezmun.<strong>\xe2\x80\xae</strong>txt.scr</em></p>
<p>Even when no software vulnerability is exploited, the attacks still typically include a decoy document. The content of most of the decoy documents appear to be available on the open Internet, and the attackers typically made small modifications to them.</p>
<p>Many of the targets and spoofed or compromised sending accounts have contact information on the Internet. The apparent sender email usually appears to be someone associated with the accompanying text, when appropriate, while the target emails are usually also available online tied to target organizations. A small subset of the decoys could not be found online and may be from previous compromises by Scarlet Mimic. The overarching decoy themes were Uyghur-related, anti-Putin, or Al-Qaeda-related. The decoys are often copied from think tanks or reputable news sources the targets would likely frequent.</p>
<p>In one instance, the threat actors used content from a <a href="http://www.nytimes.com/2015/07/22/world/asia/chinese-police-are-said-to-seize-ashes-of-tibetan-monk-tenzin-delek-rinpoche.html?_r=0" target="_blank"><em>New York Times</em> article</a> (Figure 2) on the same day it was published.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet2.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11906" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet2-500x237.png" alt="scarlet2" width="500" height="237" /></a></p>
<p style="text-align: center;">Figure 2: Decoy Text Extracted from the New York Times article</p>
<p>Figure 3 shows one of the more common themes used to target Uyghurs and those interested in their cause. Multiple attacks used press releases or other content related to the World Uyghur Congress.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet3.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11907" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet3-500x245.png" alt="scarlet3" width="500" height="245" /></a></p>
<p class="normal" style="text-align: center;" align="center">Figure 3: Decoy using World Uyghur Congress Press Release</p>
<p class="normal">In July of 2015, we identified a full e-mail uploaded to an antivirus scanning service that carried a Scarlet Mimic exploit document. In this case (Figure 4) the recipient of the e-mail was an individual working for the Russian Federal Security Service (fsb.ru). The e-mail body requests help dealing with threatening phone calls from an international gang.</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet4.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11908" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet4-500x279.png" alt="scarlet4" width="500" height="279" /></a></p>
<p class="normal" style="text-align: center;" align="center">Figure 4: Phishing E-mail send to FSB E-mail Address</p>
<p class="normal">Another attack, sent to an unknown target carried a decoy image (Figure 5) that compared Russian President Vladimir Putin to Adolf Hitler.</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet5.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11909" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet5-500x492.png" alt="scarlet5" width="500" height="492" /></a></p>
<p class="normal" style="text-align: center;" align="center">Figure 5: Anti-Putin image used as a decoy document</p>
<p class="normal">In yet another case, the threat actors used a conference notification from one organization (Figure 6a) and modified it to appear as thought it was for an “Islamic Country Muslim Religion Conference” (Figure 6b). This document was particularly poorly altered, as the registration form still contained multiple hints to indicate the document was fraudulent (Figure 6c).</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet6a.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11910" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet6a-500x135.png" alt="scarlet6a" width="500" height="135" /></a></p>
<p style="text-align: center;">Figure 6a: Original document used as a Psylo decoy</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet6b.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11911" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet6b-500x131.png" alt="scarlet6b" width="500" height="131" /></a></p>
<p style="text-align: center;">Figure 6b: Modified header and contact email in the decoy</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet6c.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11912" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet6c-500x219.png" alt="scarlet6c" width="500" height="219" /></a></p>
<p style="text-align: center;">Figure 6c: Bottom of the decoy document with replaced email and non-altered date &#8212; a quick search online shows this to be fraudulent</p>
<p>In total we have collected over 40 individual decoy documents used in these attacks, far more than we can detail here.</p>
<p>We are aware of one case where Scarlet Mimic broke from the spear-phishing pattern described above. In 2013, the group deployed a watering hole attack, also known as a strategic web compromise to infect victims with their backdoor. The watering hole is an attack vector that involves compromising a website that targeted victims are likely to visit in order to infect and gain access to their systems. According to a blog by <a href="http://community.websense.com/blogs/securitylabs/archive/2013/08/16/tibetan-compromise.aspx">Websense</a>, threat actors compromised the Tibetan Alliance of Chicago’s website to host malicious code that exploited a vulnerability in Internet Explorer (CVE-2012-4969.) Microsoft patched this vulnerability in September 2012, suggesting that this watering hole attack used an older vulnerability, which aligns with the threat groups continued use of older vulnerabilities in their spear-phishing efforts.</p>
<h2>Malware Overview</h2>
<p>First discussed in January 2013 in a Trend Micro <a href="http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-fakem-rat.pdf" target="_blank">whitepaper</a>, FakeM is a Trojan that uses separate modules to perform its functionality. FakeM’s functional code is shellcode-based and requires another Trojan to load it into memory and execute it. There are a variety of different Trojans used to load FakeM, some of which are more interesting than others. In this section, we will explore the loader Trojans followed by an analysis of the evolution of FakeM itself. We end this section with a discussion on tools related to FakeM and used by Scarlet Mimic.</p>
<h4>Loader Trojans</h4>
<p>FakeM is shellcode-based and therefore requires another Trojan to load FakeM into memory and execute its functional code. Threat actors have developed many different loading Trojans to load FakeM, some of which are fairly straightforward while others use very clever techniques to avoid detection. Unit 42 tracks the following list of loader Trojans that Scarlet Mimic has used to execute FakeM:</p>
<ul>
<li>CrypticConvo</li>
<li>SkiBoot</li>
<li>RaidBase</li>
<li>FakeHighFive</li>
<li>PiggyBack</li>
<li>FullThrottle</li>
<li>FakeFish</li>
<li>BrutishCommand</li>
<li>SubtractThis</li>
</ul>
<p>It appears that the threat actors include the loader Trojans in some sort of builder application that allows actors to quickly create, configure and deploy payloads to execute FakeM. We believe this because many samples that execute FakeM have the same exact compilation time but different C2 servers, as seen in the example in Table 1. This suggests the actors compile a single sample and use a builder tool to configure individual samples on demand.</p>
<p style="text-align: center;">We used the loader Trojans to provide a general timeline for the development of FakeM samples, as FakeM is shellcode-based and does not contain any usable timestamps. The timestamps in the loader Trojans does not necessarily correspond to the usage of FakeM, but plotting the compile times of the loaders on a timeline shows an interesting trend. The scatter plot timeline in Figure 7 shows the known compilation times of the loader Trojans and the FakeM variant that it executed.</p>
<table width="468">
<tbody>
<tr>
<td width="117"><strong>SHA256</strong></td>
<td width="117"><strong>Compiled</strong></td>
<td width="117"><strong>Loader Trojan</strong></td>
<td width="117"><strong>C2 Domains</strong></td>
</tr>
<tr>
<td width="117">5182dc8667432d76a<br />
276dc4f864cdfcef3e4<br />
81783ebaf46d3b139<br />
7080b798f4a</td>
<td width="117">2013-09-13 08:02:58</td>
<td width="117">CrypticConvo</td>
<td width="117">opero.spdns[.]org, firefox.spdns[.]de</td>
</tr>
<tr>
<td width="117">5dade00db195087aa<br />
336ce190b5fd1c2299<br />
2c49556c623b42a9f7<br />
42d73241a7f</td>
<td width="117">2013-09-13 08:02:58</td>
<td width="117">CrypticConvo</td>
<td width="117">intersecurity.firewall-gateway[.]com</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 1: Two samples sharing a compile time yet contain different C2 domains in their configurations</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-7.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11921" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-7-500x373.png" alt="scarlet 7" width="500" height="373" /></a></p>
<p style="text-align: center;">Figure 7: Timeline of compilation of loader Trojans associated with FakeM</p>
<p class="normal">Based on the timeline, it appears that the actors were actively developing several of the loaders at the same time from 2009 until the early months of 2014. After the first quarter of 2014, it appears that the actors abandoned development of the older loaders in favor of FakeFish, BrutishCommand and SubtractThis. This does not mean that actors will not continue to use the older loaders, but it does suggest that the actors will continue including the newer or freshly developed loaders in updated builder applications.</p>
<p class="normal">The timeline also presents the possibility that the FakeM developers reacted to the release of Trend Micro’s FakeM <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/hiding-in-plain-sight-the-fakem-remote-access-trojan/" target="_blank">blog</a> and <a href="http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-fakem-rat.pdf" target="_blank">whitepaper</a>. Trend Micro published their analysis of the FakeM Trojan on January 17, 2013 (marked in Figure 7 by a red line) that discussed the original variant of FakeM. Shortly after, the original variant of FakeM drops off the timeline in favor of the SSL and Custom SSL variants. It is possible that the FakeM developers saw their tool was exposed and adapted it to avoid detection for continued use as a payload in attacks. We cannot be certain if the developers reacted specifically to Trend Micro’s content, as it is possible that they were reacting to the increased antivirus detection rate of their tool that resulted from the exposure of the tool. Regardless of the specific stimulus, the reaction shows that the FakeM threat actors evolved to avoid detection/attribution and to continue their attack campaigns.</p>
<p class="normal">The timeline does have one noticeable outlier, specifically the FakeHighFive sample compiled in September 2009 that loaded a FakeM SSL sample. We believe this compile time is incorrect, as the C2 domain for this sample, specifically press.ufoneconference[.]com, was registered by the threat actor in February 2013. The registration of the C2 domain in February 2013 aligns with other compilation times of FakeM SSL, which leads us to the conclusion that the September 2009 compilation timestamp was modified and/or inaccurate.</p>
<p class="normal">Most of the related loader Trojans, such as CrypticConvo, PiggyBack, FullThrottle, FakeHighFive, FakeFish and RaidBase do little more than load encrypted FakeM shellcode (either from a PE resource or embedded data), decrypt it, and execute the resulting shellcode. Other related loading Trojans, such as SubtractThis, BrutishCommand and SkiBoot employ clever techniques worth discussing.</p>
<h4>SubtractThis</h4>
<p class="normal">The SubtractThis loader displays a technique that is quite clever. This loader received its name based on a technique it uses to delay before carrying out its main functionality, specifically by requiring the user to hit the minus (“-“) key. SubtractThis carries out this technique through the following steps:</p>
<ol>
<li>Calls LoadAcceleratorsA function to load the virtual key for the minus character “-“. Example: LoadAcceleratorsA(hInstance, VK_SUBTRACT);</li>
<li>Calls SetTimer function to set up a callback function that will be called in the event that the LB_FINDSTRING Windows message. Example: SetTimer(0, LB_FINDSTRING_, 10000u, TimerFunc);</li>
<li>Creates a continuous loop that starts by calling GetMessageA to obtain Windows messages</li>
<li>Calls TranslateAcceleratorA to check Windows message received is VK_SUBTRACT &#8220;-&#8220;.</li>
<li>Calls the callback function set up in the SetTimer function if the user enters the minus “-“ key.</li>
</ol>
<p>This technique requires user interaction, which makes analysis in sandboxes more difficult.</p>
<h4>BrutishCommand</h4>
<p>The BrutishCommand loader uses a very interesting method to decrypt the FakeM functional code. The main function in this loader checks the command line arguments passed to it, and if there are none present it will obtain a random number between 0-9 and create a new process using the same executable with this random number as a command line argument.</p>
<p>If the executable has a command line argument, the Trojan subjects the value to a hashing algorithm and compares the hash to 0x20E3EEBA. If the value matches the static hash, the executable will subject the command line argument to a second algorithm that will produce a value that the Trojan will use as the decryption key to decrypt the embedded FakeM shellcode. It essentially brute forces its own decryption key by rerunning itself over and over until it runs with the correct value is provided on the command line. Unit 42 had not seen this technique used by other malware families and it introduces a challenging hurdle when attempting to analyze or debug the loader Trojan.</p>
<h4>SkiBoot Loader</h4>
<p>SkiBoot reads the master boot record (MBR) of the system to determine the XOR key that it will use to decrypt the FakeM shellcode. It carries out this functionality by calling the ReadFile function to read 512-bytes from “\\.\PHYSICALDRIVE0” and specifically uses the last byte of the MBR as the encryption key. The last byte of the MBR is “\xAA”, or the second byte of “\x55\xAA”, which is the boot signature portion of the MBR.</p>
<p>Instead of using ReadFile, one variant of this loader reads the MBR using DeviceIOControl using the ID_CMD control code, and accesses a specific offset to obtain the value that it will rotate each byte in the ciphertext within the decryption algorithm. The significance of using DeviceIOControl is that the VMware hypervisor responds to this API call with a blank buffer instead of the MBR, whereas the Virtualbox hypervisor returns the MBR correctly. It appears that this loader is specifically using the DeviceIOControl API function as a VMware detection technique, suggesting that the developers are well versed in the nuances of the VMware hypervisor and virtual machine evasion.</p>
<h3>Evolving FakeM: Variants</h3>
<p class="normal">Since being originally exposed in 2013, authors of FakeM have continuously made changes to the FakeM codebase, resulting in multiple variants. Before elaborating on the different variants of FakeM, there are many similarities that remain throughout the various iterations. The architecture has not changed during the evolution of FakeM, as a modular framework exists in each variant, as seen in Figure 8. The FakeM main module is responsible for launching embedded modules, such as a keylogger or for gathering sensitive files. The main module is also responsible for communicating with its C2 servers and handling commands issued by the C2 server.</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-8.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11922" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-8-500x221.png" alt="scarlet 8" width="500" height="221" /></a></p>
<p style="text-align: center;">Figure 8: FakeM Architecture</p>
<p>All FakeM variants initiate communications with its C2 server and check the C2’s response for a command. Also, all FakeM variants share a common command handler with the same capabilities, as seen in Table 2. The limited command set suggests that FakeM’s functionality is obtained by additional assembly code provided by the C2 server with the 0x211 command. According to Trend Micro’s initial analysis on FakeM, threat actors delivered and ran additional code that provided further capabilities to the Trojan, such as the ability to run shell commands, steal passwords, capture the screen and upload files.</p>
<table width="444">
<tbody>
<tr>
<td width="84"><strong>Command</strong></td>
<td width="360"><strong>Description</strong></td>
</tr>
<tr>
<td width="84">0x211</td>
<td width="360">Run assembly code directly from the C2.</td>
</tr>
<tr>
<td width="84">0x212</td>
<td width="360">Idle. Attempts to receive another command immediately instead of sleeping for 30 seconds.</td>
</tr>
<tr>
<td width="84">0x213</td>
<td width="360">Sets a flag to end the session with the C2. This will force the Trojan to reestablish a session with the C2.</td>
</tr>
<tr>
<td width="84">0x214</td>
<td width="360">Exit process.</td>
</tr>
</tbody>
</table>
<p>Table 2: Command handler within all variants of FakeM</p>
<p>Now that we have covered the commonalities between FakeM variants, the following sections will dive into the specific variants of FakeM. Unit 42 categorizes the different variations of FakeM based on the method used to communicate with the C2 server, which has changed dramatically over the years.</p>
<h4>Original FakeM</h4>
<p>The original variant of FakeM generates network beacons to its C2 server that begin with a 32-byte header that in most cases is meant to blend into network traffic generated by legitimate applications. Following this 32-byte header, the original variant of FakeM includes data encrypted using a custom encryption cipher that uses an XOR key of “YHCRA” and bit rotation between each XOR operation.</p>
<p>The original variant includes the FakeM discovered and published by Trend Micro in 2013, in which the authors of FakeM first attempted to evade detection of its C2 communications by pretending to be generated by legitimate messenger applications, such as MSN and Yahoo! messengers. Figures 9 and 10 show FakeM attempting to resemble MSN or Yahoo! Messenger traffic, as the first 32-bytes contain data that resemble legitimate traffic generated by these chat programs.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-9.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11923" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-9-500x141.png" alt="scarlet 9" width="500" height="141" /></a></p>
<p style="text-align: center;">Figure 9: FakeM using fake MSN messenger traffic for C2 communication</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-10.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11924" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-10-500x142.png" alt="scarlet 10" width="500" height="142" /></a></p>
<p style="text-align: center;">Figure 10: FakeM using fake Yahoo! Messenger for C2 communication</p>
<p class="normal">In addition to emulating chat programs, FakeM has also included HTML code within the 32-byte header. As you can see in Figure 11, the overall structure of the beacon did not change, rather the only differences is the data in the header contains HTML tags. The HTML data in the header led Unit 42 to a <a href="https://malware.lu/assets/files/articles/RAP002_APT1_Technical_backstage.1.0.pdf" target="_blank">whitepaper</a> published by Malware.lu that suggested the MSN, Yahoo, and HTML versions of the original variant of FakeM all share a common server application that the threat actors use to build samples and control infected systems.</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-11.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11925" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-11-500x139.png" alt="scarlet 11" width="500" height="139" /></a></p>
<p style="text-align: center;">Figure 11: FakeM HTML tags in C2 header</p>
<p>In October 2013, FireEye published a <a href="http://www.fireeye.com/blog/threat-research/2013/10/evasive-tactics-terminator-rat.html" target="_blank">blog</a> about a sample of FakeM that did not use fake messenger or HTML data in the first 32 bytes of the C2 traffic, but instead used four repeating bytes to fill this portion of the packet, as seen in Figure 12. Unit 42 tracks this under the original variant, as it uses the same algorithm to encrypt the data and otherwise shares a common structure to the MSN, Yahoo, and HTML versions with the exception of the modification to the first 32 bytes.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-12.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11926" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-12-500x139.png" alt="scarlet 12" width="500" height="139" /></a></p>
<p style="text-align: center;">Figure 12: FakeM C2 beacon with four repeating bytes</p>
<h4>FakeM SSL</h4>
<p>While performing infrastructure analysis on FakeM original variants, we came across shared infrastructure with domains that hosted C2 servers for malware samples that did not match the known FakeM communication protocols. Palo Alto Networks WildFire had analyzed many samples associated with these related C2 domains, all of which communicated with the C2 server using secure sockets layer (SSL). To determine the malware family that was generating this traffic, Unit 42 analyzed these samples and found that the functional code was the same as the original FakeM variant.</p>
<p>This discovery indicates the authors of FakeM introduced new code to the Trojan in order to use SSL to communicate with its C2 server. The drastic change in C2 channel warranted a new variant name, and we dubbed it “FakeM SSL”. During the analysis of these samples we did not find any operational C2 servers to complete a handshake to establish a SSL session. During the handshake, the FakeM SSL samples will tell the server it supports 36 different cipher suites even though the samples appear to only support one. Unit 42 believes the cipher suite within the FakeM SSL variants uses Diffie-Hellman for key exchange and the RC4 cipher to encrypt the C2 communications.</p>
<h4>FakeM Custom SSL</h4>
<p>In July 2015, Scarlet Mimic delivered a spear-phishing email to a branch of the Russian government with intentions of installing a payload that was undetected by any antivirus vendors on VirusTotal. The high profile target and the lack of antivirus detection prompted Unit 42 to perform an in-depth analysis and found that it is yet another new variant of the FakeM Trojan. We also named this variant after it’s communication protocol (FakeM Custom SSL.)</p>
<p>This new variant of FakeM shared the same functional code as its predecessors, but again the communications with the C2 dramatically differed from the other variants. Communications between this variant and the C2 server leverage what Unit 42 believes is modified SSL code, as the code is very similar to the FakeM SSL variant. The code appears to use Diffie-Hellman for key exchange and the RC4 algorithm like FakeM SSL; however, the initial packet sent to the C2 server did not contain a “client hello” message, which is required to initiate an SSL handshake. Instead, the initial packet sent data as seen in Figure 13.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-13.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11927" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-13-500x139.png" alt="scarlet 13" width="500" height="139" /></a></p>
<p style="text-align: center;">Figure 13: Hexdump of FakeM custom SSL variant</p>
<p class="normal">This variant of FakeM skips the traditional SSL handshake, which involves an agreement on a cipher suite to use to encrypt communications. The FakeM code only supports one cipher suite, which makes the cipher suite agreement portion of the SSL handshake irrelevant. Instead, FakeM creates a session with its C2 server by exchanging keys. The lack of a valid handshake makes detection of this C2 stream difficult, as the packets sent between the Trojan and the C2 to establish this session contain random binary data. Network devices will also be unable to perform any SSL decryption due to the lack of detection and the inability to determine the cipher suite used to encrypt the data. Figure 14 below provides a visual depiction of the handshake procedure and the subsequent beacon and command messages.</p>
<p class="normal"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-14.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-11928" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/01/scarlet-14-500x356.png" alt="scarlet 14" width="500" height="356" /></a></p>
<p style="text-align: center;">Figure 14: Communications between system and C2 server, including the key exchange</p>
<p>The handshake starts with a key exchange, which the Trojan initiates by creating a 2048-byte buffer that it will store its key (128-bytes, followed by null values as seen in Figure 13) and sending its key to the C2 server. The C2 will respond with its own key (also 128-bytes, followed by null values) that the Trojan will store and use to encrypt future communications.</p>
<p>Once this key exchange is complete, the Trojan acknowledges the receipt of the server’s key by sending another 2048-byte packet to the server. To build the acknowledgement packet, the Trojan creates a 2048-byte buffer filled with null values and copies the string “ws32.dll” to offset 8 and encrypts the buffer with the server’s key.</p>
<p>After sending the acknowledgement packet, the Trojan will gather local system information and include it in a beacon to the C2 server. Like the packets sent in the key exchange, the beacon sent by the Trojan to the C2 server is 2048-bytes in length; however, the system information gathered by the Trojan is only 296 bytes followed by 1752 are null values to fill the 2048 byte buffer. The system information follows the 296-byte structure seen below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f6928683219d961897308" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
struct beaconToC2 {
 DWORD static_value_130h;
 CHAR username[128];
 CHAR computername[128];
 DWORD static_value_70000h;
 DWORD os_codepage;
 DWORD campaign_code_1;
 DWORD campaign_code_2;
};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f6928683219d961897308-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928683219d961897308-2">2</div><div class="crayon-num" data-line="crayon-5f6928683219d961897308-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928683219d961897308-4">4</div><div class="crayon-num" data-line="crayon-5f6928683219d961897308-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928683219d961897308-6">6</div><div class="crayon-num" data-line="crayon-5f6928683219d961897308-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f6928683219d961897308-8">8</div><div class="crayon-num" data-line="crayon-5f6928683219d961897308-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f6928683219d961897308-1"><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">beaconToC2</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928683219d961897308-2"><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-v">static_value_130h</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928683219d961897308-3"><span class="crayon-h"> </span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-v">username</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928683219d961897308-4"><span class="crayon-h"> </span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-v">computername</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928683219d961897308-5"><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-v">static_value_70000h</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928683219d961897308-6"><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-v">os_codepage</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928683219d961897308-7"><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-v">campaign_code_1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f6928683219d961897308-8"><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-v">campaign_code_2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f6928683219d961897308-9"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p class="normal">The Trojan will encrypt this data using the key provided by the C2 and send it to the server. The Trojan will then wait for the C2 to respond, which it will decrypt and parse for FakeM commands. Unit 42 has been unable extract any plug-ins from C2 network traffic; however, several FakeM custom SSL samples contain embedded plug-ins that run without interaction with the C2 server. Also, Unit 42 was able to extract several modules from the original FakeM server application, as seen in Table 3. All of these modules are shellcode-based plug-ins that would work with the custom SSL variant of FakeM with little to no modification.</p>
<table width="429">
<tbody>
<tr>
<td width="216"><strong>MD5</strong></td>
<td width="92"><strong>Size (bytes)</strong></td>
<td width="122"><strong>Description</strong></td>
</tr>
<tr>
<td width="216">7a1410b2eceb99ec268b50e9371e74c1</td>
<td width="92">3724</td>
<td width="122">Process Plug-ins</td>
</tr>
<tr>
<td width="216">092085e76512f071cab12f76ed09b348</td>
<td width="92">2412</td>
<td width="122">Shell Plug-ins</td>
</tr>
<tr>
<td width="216">8f4cbb78356cb672bf2566e44315eb96</td>
<td width="92">1768</td>
<td width="122">File Plug-ins</td>
</tr>
<tr>
<td width="216">16ab40f84fc47bab2c7874bb3164c5b4</td>
<td width="92">2268</td>
<td width="122">Screen Plug-ins</td>
</tr>
<tr>
<td width="216">30337e99631a174d822dd3ea00a5f6cf</td>
<td width="92">2204</td>
<td width="122">Regedit Plug-ins</td>
</tr>
<tr>
<td width="216">1f3fbb789bcbe9186a50c4f4db269736</td>
<td width="92">1996</td>
<td width="122">Service Plug-ins</td>
</tr>
<tr>
<td width="216">4313d9d5fc6a090e2abc41633cb2c1fd</td>
<td width="92">3196</td>
<td width="122">HostInfo Plug-ins</td>
</tr>
<tr>
<td width="216">fe75dff8b86dd8989d2ca00df19d51be</td>
<td width="92">2220</td>
<td width="122">KeyBoard Plug-ins</td>
</tr>
<tr>
<td width="216">3e184a7af74905f3d3acbec913252f72</td>
<td width="92">1884</td>
<td width="122">Shell Plug-ins</td>
</tr>
<tr>
<td width="216">b59e8751b9f61bd4f4b9b62de8242751</td>
<td width="92">3896</td>
<td width="122">OE Pwd Plug-ins</td>
</tr>
<tr>
<td width="216">83ec457cba27e470404c942eb9242eeb</td>
<td width="92">2156</td>
<td width="122">U-Files Plug-ins</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 3: Modules extracted from the original FakeM variant&#8217;s server application</p>
<h4>Related to FakeM Original: CallMe</h4>
<p class="normal">CallMe is a Trojan designed to run on the Apple OSX operating system. This Trojan was delivered in targeted attacks on Uyghur activists in 2013 and used infrastructure associated with FakeM.</p>
<p class="normal">In February 2013, <a href="https://www.alienvault.com/open-threat-exchange/blog/cyber-espionage-campaign-against-the-uyghur-community-targeting-macosx-syst">AlienVault performed analysis</a> on the CallMe Trojan and found that it is based on a tool called Tiny SHell, an OSX shell tool whose source code is available on the Internet. The Trojan uses AES to encrypt the communication channel its C2 server, which will provide one of three commands to carry out activities on the compromised system, as seen in Table 4.</p>
<table>
<tbody>
<tr>
<td width="70">Command</td>
<td width="368">Description</td>
</tr>
<tr>
<td width="70">1</td>
<td width="368">Get a file from the system and upload it to the C2 server.</td>
</tr>
<tr>
<td width="70">2</td>
<td width="368">Put a file on the system from the C2 server. File is saved to a specified filename in &lt;HOME directory&gt;/downloads/.</td>
</tr>
<tr>
<td width="70">3</td>
<td width="368">Create a reverse shell to interact with the compromised system.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 4: Commands Available in the CallMe OSX Malware</p>
<p>The infrastructure overlap between FakeM and CallMe involves the fully qualified domain name (FDQN) of &#8220;googmail.org&#8221;, which was used by both FakeM and CallMe samples. This suggests that not only do these threat actors have the ability to compromise victims running the Microsoft Windows operating system, but they can also target individuals running Apple&#8217;s OSX as well.</p>
<h4>Related to FakeM Custom SSL: Psylo</h4>
<p>During infrastructure analysis of FakeM Custom SSL variants, Unit 42 found infrastructure overlaps between FakeM and another new, previously unreported Trojan that we named “Psylo”. Psylo is a tool that allows threat actors to upload and download files to and from a compromised system, as well as execute commands and applications on the system. The name Psylo is an anagram from the mutex created when initially running this payload, which is &#8216;hnxlopsyxt&#8217;.</p>
<p>Psylo is similar to FakeM in that they are both shellcode-based, and they have similar configurations and C2 communication channels. As you can see from the following two configuration structures, Psylo and FakeM have similar configurations with only the array length of the C2 locations being different.</p>
<table width="444">
<tbody>
<tr>
<td width="219">struct psylo_c2_config {char[60] c2_host_1;char[60] c2_host_2;char[60] c2_host_3;DWORD c2_port_1;DWORD c2_port_2;DWORD c2_port_3;};</td>
<td width="225">struct fakem_customssl_c2_config {char[64] c2_host_1;char[64] c2_host_2;char[64] c2_host_3;DWORD c2_port_1;DWORD c2_port_2;DWORD c2_port_3;};</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Figure 15: Comparison between Psylo and FakeM custom SSL configurations</p>
<p>Both use SSL to communicate with their C2 servers, and it appears they share common code to carry out the Diffie Hellman key exchange. We compared the Diffie Hellman code from Psylo with FakeM custom SSL variant and found that they were very similar, but the FakeM samples had some of the functionality within sub-functions, which rendered binary diffing between the two Trojans impossible.</p>
<p>Another slight difference involves how Psylo and FakeM generate random numbers for SSL. FakeM uses QueryPerformanceCounter to create a random number, whereas Psylo uses CryptGenRandom, both of which generate random numbers 68 bytes long. Interesting enough is that CryptGenRandom calls RtlGenRandom, which uses QueryPerformanceCounter along with other system attributes to generate a random number.</p>
<p>When communicating with its C2 server, Psylo will use HTTPS with a unique user-agent of (notice the lack of a space between &#8220;5.0&#8221; and &#8220;(Windows&#8221;):</p>
<p><em>Mozilla/5.0(Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0</em></p>
<p>Unit 42 does not consider Psylo another variant of FakeM because Psylo has a command handler that differs dramatically from FakeM. Table 5 shows the Psylo command handler, which suggests it is less modular and supports more embedded functionality when compared to FakeM. It is possible that the threat actors created this Trojan as a standalone alternative to FakeM.</p>
<table width="444">
<tbody>
<tr>
<td width="84"><strong>Command</strong></td>
<td width="360"><strong>Description</strong></td>
</tr>
<tr>
<td width="84">0</td>
<td width="360">Idles for 10 seconds.</td>
</tr>
<tr>
<td width="84">2</td>
<td width="360">Enumerate all storage devices.</td>
</tr>
<tr>
<td width="84">3</td>
<td width="360">Find all files that starts with a particular string (%s*.*).</td>
</tr>
<tr>
<td width="84">5</td>
<td width="360">Creates a file to write to, deleting it if it already exists. Combined with &#8216;E&#8217; command to download a file to the system.</td>
</tr>
<tr>
<td width="84">E</td>
<td width="360">Writes data from C2 to a file opened using the &#8216;5&#8217; command. Combined with &#8216;5&#8217; command to download a file to the system.</td>
</tr>
<tr>
<td width="84">6</td>
<td width="360">Reads a file, which effectively uploads the file to the C2.</td>
</tr>
<tr>
<td width="84">7</td>
<td width="360">Delete a specified file.</td>
</tr>
<tr>
<td width="84">8</td>
<td width="360">Execute a command using WinExec. Responds to C2 with &#8216;s&#8217; if successful or &#8216;r&#8217; if unsuccessful.</td>
</tr>
<tr>
<td width="84">9</td>
<td width="360">Timestomps. Sets a specified file&#8217;s timestamps to match that of a system file in the System32 directory.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 5: Command handler in Psylo that differs dramatically from FakeM</p>
<h3>MobileOrder: Mobile Devices the Next Frontier</h3>
<p>Another discovery we made while researching this blog is an overlap between Psylo infrastructure and a Trojan focused on compromising Android mobile devices. Unit 42 tracks this mobile Trojan as MobileOrder, as the authors specifically refer to commands within the app as orders. The connection between FakeM, Psylo, and MobileOrder suggest that Scarlet Mimic is now expanding their espionage efforts from PCs to mobile devices, which marks a major shift in tactics.</p>
<p>MobileOrder starts by registering itself as device administrator so that a normal user cannot uninstall it by simply clicking “uninstall” in settings. It will copy an embedded PDF file from “res/raw/rd.pdf” to SD card &#8220;/android/9074ca3f18e201c204ec1d852264bb5432644ba46f54f361a146957.pdf&#8221; and launches the mobile device’s default PDF viewer to display this PDF file, which acts as a decoy document. After displaying the decoy document, the malicious code runs in background. The malicious code consists of the following parts:</p>
<ol>
<li>An Android geographical location SDK provided by <a href="http://lbs.amap.com/" target="_blank">AMAP</a>.</li>
<li>Actor developed code that carries out Trojan’s functionality.</li>
</ol>
<p>The malware uses the AMAP SDK to get accurate location of infected devices by GPS, mobile network (such as base stations), WiFi and other information. MobileOrder acts on instructions provided by its C2 server, which it communicates with over TCP port 3728. All C2 communications are encrypted with the AES algorithm using a key generated by computing five MD5 hashes starting with the key &#8220;1qazxcvbnm&#8221;, and adding a salt value of “.)1/” in each iteration.</p>
<p>The C2 server will respond to requests from MobileOrder with commands that the Trojan refers to as “orders”. MobileOrder contains a command handler with functionality that provides a fairly robust set of commands, as seen in Table 6. The first byte of data provided by the C2 server is order number, which is followed by the encrypted data that needed to carry out the specific order.</p>
<table width="461">
<tbody>
<tr>
<td width="62"><strong>Order #</strong></td>
<td width="165"><strong>Order Name</strong></td>
<td width="234"><strong>Behaviors</strong></td>
</tr>
<tr>
<td width="62">18</td>
<td width="165">Order_Folder_List</td>
<td width="234">Upload names and attributes of files under specified path</td>
</tr>
<tr>
<td width="62">20</td>
<td width="165">Order_Process_List</td>
<td width="234">Upload all running processes information</td>
</tr>
<tr>
<td width="62">24</td>
<td width="165">Order_HostInfo</td>
<td width="234">Upload device information including IMEI, IMSI, SIM card serial number, phone number, Android version, device manufacturer, device model, SD card size, network type, device locking status, country, carrier, time zone, language, install app list, browser bookmarks, etc.</td>
</tr>
<tr>
<td width="62">26</td>
<td width="165">Order_FileDelete</td>
<td width="234">Delete specified file</td>
</tr>
<tr>
<td width="62">27</td>
<td width="165">Order_DownLoad</td>
<td width="234">Download specified file to SD card’s Android/data/tmp/ directory.</td>
</tr>
<tr>
<td width="62">28</td>
<td width="165">Order_UpFile</td>
<td width="234">Upload specified file to C2 server</td>
</tr>
<tr>
<td width="62">51</td>
<td width="165">Order_Sms</td>
<td width="234">Upload all received and sent SMS addresses, content, date, time to C2 server</td>
</tr>
<tr>
<td width="62">52</td>
<td width="165">Order_Contact</td>
<td width="234">Upload all contacts’ information to C2 server</td>
</tr>
<tr>
<td width="62">53</td>
<td width="165">Order_Call</td>
<td width="234">Upload all phone calling history information</td>
</tr>
<tr>
<td width="62">54</td>
<td width="165">Order_Camera_front_photo</td>
<td width="234">Take a picture by device’s front camera</td>
</tr>
<tr>
<td width="62">56</td>
<td width="165">Order_SetSleepTime</td>
<td width="234">Set sleep time interval</td>
</tr>
<tr>
<td width="62">57</td>
<td width="165">Order_SetOnline</td>
<td width="234">Stop sleep</td>
</tr>
<tr>
<td width="62">58</td>
<td width="165">Order_SetMediaRecorder</td>
<td width="234">Start audio recorder in specified time</td>
</tr>
<tr>
<td width="62">59</td>
<td width="165">Order_GetLoc</td>
<td width="234">Upload information about network operator, MCC, MNC, network type, GSM cell location, CID, LAS, BSSS, etc. This information can be used to locate the device.</td>
</tr>
<tr>
<td width="62">60</td>
<td width="165">Order_GetGps</td>
<td width="234">Upload GPS location by AMAP SDK.</td>
</tr>
<tr>
<td width="62">61</td>
<td width="165">Order_SetTelRecorderOn</td>
<td width="234">Activate phone calling recording</td>
</tr>
<tr>
<td width="62">62</td>
<td width="165">Order_SetTelRecorderOff</td>
<td width="234">Deactivate phone calling recording</td>
</tr>
<tr>
<td width="62">81</td>
<td width="165">Order_Install</td>
<td width="234">Install specified APK file. May install silently or install to system app according to C2 command data</td>
</tr>
<tr>
<td width="62">82</td>
<td width="165">Order_Uninstall</td>
<td width="234">Uninstall specified app</td>
</tr>
<tr>
<td width="62">84</td>
<td width="165">Order_StartApp</td>
<td width="234">Launch specified app</td>
</tr>
<tr>
<td width="62">85</td>
<td width="165">Order_SendBroadcast</td>
<td width="234">Send specified Android broadcast to launch other apps</td>
</tr>
<tr>
<td width="62">86</td>
<td width="165">Order_Shell</td>
<td width="234">Execute specified shell commands</td>
</tr>
<tr>
<td width="62">87</td>
<td width="165">Order_OpenTrack</td>
<td width="234">Start geolocation tracking in AMAP SDK</td>
</tr>
<tr>
<td width="62">88</td>
<td width="165">Order_CloseTrack</td>
<td width="234">Stop geolocation tracking in AMAP SDK</td>
</tr>
<tr>
<td width="62">90</td>
<td width="165">Order_CheckScreen</td>
<td width="234">Check whether phone screen is on (or said whether the phone is used by its owner)</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 6: MobileOrder command handler</p>
<h3>Infrastructure Overlap and Related Tools</h3>
<p>There is some infrastructure overlap in the C2 servers used by almost all of the FakeM variants, as well other Trojans such as MobileOrder, Psylo, and CallMe. There are also infrastructure ties between some FakeM variants and older activity using Trojans such as Elirks, Poison Ivy, and BiFrost, which were used in attacks as old as 2009. The domain names used to host C2 servers are a mix of actor-registered and Dynamic DNS (DDNS,) though most are DDNS. The DDNS domains in turn are linked to a small grouping of ASNs, with one ASN often largely tied to one FakeM variant. Most of the FakeM MSN C2s resolve to IP addresses associated with ASN 22781 (RBLHST &#8211; Reliablehosting.com). However, we found one MSN sample that shared infrastructure with some FakeM Custom SSL variants.</p>
<p>There is a similar overlap between FakeM MSN, FakeM HTML, and FakeM SSL. The registrant email xsldmt@xj163[.]cn was used to register several domains used as C2s: yourturbe[.]org, websurprisemail[.]com and googmail[.]org. One of these domains was also used in the 2013 CallMe activity at the same time it was being used for FakeM MSN samples. The targeting and decoy style also matches with the FakeM activity.</p>
<p>There is PE resource overlap between some FakeM MSN samples and some samples of the BiFrost and Poison Ivy Trojan. This may indicate that the same developer who created the particular BiFrost and Poison Ivy samples was also involved in developing FakeM MSN. Unit 42 found an overlap between the RT_VERSION resources, which contains the version information of a Portable Executable (PE) file, shared amongst the three different Trojans. The shared RT_VERSION resource (MD5: 55b7a118203a831cc69b37b785015c54) contained the following information:</p>
<p class="normal"><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">Comments: Release<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">CompanyName: Develop Team<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">FileDescription: Utility Application<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">FileVersion: 4.0<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">InternalName: Utility<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">LegalCopyright: Copyright (C) 2008<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">LegalTrademarks: DT.Inc<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">OriginalFilename: Utility.EXE<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">PrivateBuild: 4.0b<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">ProductName: Utility Application<br />
</span><span style="font-size: 10.0pt; line-height: 115%; font-family: 'Courier New';">ProductVersion: 4.0</span></p>
<p>The overlap between Elirks, FakeM SSL, Psylo, and MobileOrder exists entirely in their command and control infrastructure, through domain names and/or IP resolution. Samples of these three used some of the same C2 domains, notably lenovositegroup[.]com, ufoneconference[.]com, and websurprisemail[.]com, while some resolution overlap includes 118.193.212[.]12, 210.206.219[.]241, and 59.188.239[.]117. Similarly, some FakeM Yahoo C2 domains and FakeM Custom SSL C2 domains also have overlapping IP resolutions, notably 95.154.204[.]198.</p>
<p>Scarlet Mimic also uses the infamous HTRAN tool on at least some of their C2 servers. HTRAN is a proxying tool that allows actors to conceal the true location of their C2 server. Actors will run HTRAN on a server and configure their malware to interact with that server; however, the actor will configure HTRAN to forward traffic to another server where the actual C2 server exists. For example, the FakeM C2 domain of “muslim.islamhood[.]net”<a href="#_ftn1" name="_ftnref1"><sup><sup>[1]</sup></sup></a> resolved to the IP address 59.188.239.117 during analysis, but the server responded with the following error message:</p>
<p><em>[SERVER]connection to 68.71.35.135:8081 error</em></p>
<p>This error message suggests that the HTRAN application running on 59.188.239.117 was unable to connect to the real C2 server hosted at 68.71.35.135.</p>
<h2>Prior Publications</h2>
<p>Throughout this report, we have referenced multiple previous blogs and white papers, from Unit 42 and others, that have documented elements of this threat in the past. In addition to those documents readers may also find the following publications interesting.</p>
<p>In 2014, Citizen Lab <a href="https://targetedthreats.net/media/2.2%20Extended%20Analysis-Cluster.pdf">released a paper</a> on threats against civil society that referenced some of these attacks as the “Domain Name Family” or DNF.</p>
<p>Kaspersky Lab has produced excellent research on attacks against Uyghur and Tibetan activists. In 2013, they identified an <a href="https://securelist.com/blog/incidents/35552/android-trojan-found-in-targeted-attack-58/">Android Trojan</a> that was also targeting these groups. Our analysis indicates this malware is different from the MobileOrder Trojan described above, but they serve very similar purposes.</p>
<p class="normal">On January 12, 2016, Cylance published a <a href="https://blog.cylance.com/puttering-into-the-future">blog</a> linking an exploit document to the group Mandiant refers to as APT2 and CrowdStrike as “Putter Panda.” While there does appear to be a small overlap between IP addresses used in attacks from this group and those of Scarlet Mimic, our team has not concluded that these groups are one in the same.</p>
<h2>Conclusion</h2>
<p>The information discovered by Unit 42 and shared here indicates Scarlet Mimic is likely a well-funded and skillfully resourced cyber adversary. Scarlet Mimic has carried out attacks using both spear-phishing and watering holes since at least 2009 with increasingly advanced malware, and has deployed malware to attack multiple operating systems and platforms. Despite the apparent technical acumen, their decoy documents are typically not well crafted regardless of the use of the target’s language, though they do use timely subject lures.</p>
<p>The primary source of data used in this analysis is Palo Alto Networks <a href="https://www.paloaltonetworks.com/products/technologies/wildfire.html">WildFire</a>, which analyzes malware used in attacks from around the globe. The system is also fed with malware samples collected through sharing partnership with other security vendors, including our partners in the <a href="http://cyberthreatalliance.org/">Cyber Threat Alliance</a>. To connect attacks to each other based on malware behavior and command and control infrastructure, we relied on Palo Alto Networks <a href="https://www.paloaltonetworks.com/products/platforms/subscriptions/autofocus.html">AutoFocus</a> threat intelligence. AutoFocus users can view all of the files related to Scarlet Mimic and the malware associated with the group using the following links:</p>
<ul>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.PaloAlto-ScarletMimic" target="_blank">ScarletMimic</a></li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.FakeM" target="_blank">FakeM</a></li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Psylo" target="_blank">Psylo</a></li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.MobileOrder" target="_blank">MobileOrder</a></li>
</ul>
<p>Palo Alto Networks customers are protected from Scarlet Mimic attacks through many components of our platform.</p>
<ul>
<li>Threat Prevention signatures for the software vulnerabilities listed in this report are available to detect the exploit files during delivery.</li>
<li>Traps, our advanced endpoint solution, can prevent the software vulnerabilities listed in this report from being exploited on a Windows host.</li>
<li>WildFire classified all of the Android and Windows malware described in this report as malicious.</li>
<li>We have released anti-malware signatures for the files listed in this report.</li>
<li>The domain names used for command and control have been classified as malicious in PANDB.</li>
</ul>
<h2>Scarlet Mimic Indicator Data</h2>
<h3>FakeM Custom SSL Samples</h3>
<p>12dedcdda853da9846014186e6b4a5d6a82ba0cf61d7fa4cbe444a010f682b5d<br />
33e50c44804d4838dba6627b08210029ff9106fa7fd16cd7255271e153f58b05<br />
3d9bd26f5bd5401efa17690357f40054a3d7b438ce8c91367dbf469f0d9bd520<br />
5182dc8667432d76a276dc4f864cdfcef3e481783ebaf46d3b1397080b798f4a<br />
523ad50b498bfb5ab688d9b1958c8058f905b634befc65e96f9f947e40893e5b<br />
5dade00db195087aa336ce190b5fd1c22992c49556c623b42a9f742d73241a7f<br />
7156f6416e7116e52f9c67f4e716b1dbea17387e61009c7f2825debbbb4dcb73<br />
79aca57905cca1e56b0cedf48a4d81812639c333ee6532d90a074d64b3852d6f<br />
879edf0417c4a9759040b51bf83b2fc918a6644a7c29a52252003a63036aea5c<br />
9b77bbb620f50632fae17c40c7469fc93ffdbc4136a6d893a9a10a44bc435da5<br />
a1b7fe2acdb7a5b0c52b7c1960cfad531a7ca85b602fc90044c57a2b2531699f<br />
a268cc4931781d1d8094a4f8f596c2de3d662f2581c735b0810ff0ecefe3f859<br />
a4abbcfdbf4a6c52349a843eac0396e6d8abb05f1324223980d824629a42ef7a<br />
a569f3b02a4be99e0b4a9f1cff43115da803f0660dd4df114b624316f3f63dc6<br />
b4c1e9c99f861a4dd7654dcc3548ab5ddc15ee5feb9690b9f716c4849714b20d<br />
bbdedcfe789641e7f244700e8c028ef51094b66508f503876eb0d6aa16df6aa8<br />
c7b9e6b5ab07e6da404af9894c8422d9a0c9586334ddc0a3c1ea6bf23ef97fb2<br />
caeace73a17e220634525d2a4117525fd60cb86a06873c86571e89d156f8d72d<br />
caf76e19a2681dd000c96d8389afc749e774c083aef09f023d4f42fbc49d4d3d<br />
e96097826179a66cc3061be0f99f7b55cc9692a6378b5c4364699327823098ab<br />
f511b13341c9fb4ec9ecfcfe5a5813b964c362d7c709c402ead4e010d857bf6c<br />
fa08a498da0b31e77669d51a28dff166d84983fa6af693063c08f312fdce93e3<br />
df9872d1dc1dbb101bf83c7e7d689d2d6df09966481a365f92cd451ef55f047d</p>
<h3>FakeM SSL Samples</h3>
<p>0aab09bf0db30a4be28d19475082fd5e7f75879bf9029fdd8dfc3a1e1f072b0c<br />
2e1472a65a8df43c8bc9b0aff954fbc1a093c4214f6a718a08e1321db83ca683<br />
3209ab95ca7ee7d8c0140f95bdb61a37d69810a7a23d90d63ecc69cc8c51db90<br />
41948c73b776b673f954f497e09cc469d55f27e7b6e19acb41b77f7e64c50a33<br />
4a4dfffae6fc8be77ac9b2c67da547f0d57ffae59e0687a356f5105fdddc88a3<br />
5154511a439bb367b7dd56232eb15281cb6dc4d64ea3a06e7fbbe6b176e385d4<br />
5fae5750797ebe7e7a6a6919a7d66deffb141ec28737bd72a1f7da8edd330b60<br />
aa8a302a53bd39b2d2a6e3d8497575e2a5f9757b248e34c8e0821ce9eee5cc32<br />
b3c9bb22fa1bc358dc23a1a4bdaf85ad1add4d812b107b7ab887affbf689933a<br />
cd506679fd32dab16dee6fbf1cfdfe0836e092a4f5669418a199d99c9cd33abd<br />
d1dd4469c7b5c462e5ff2dcef5d22775250e9ebf395f65da624f18ea7144e173<br />
d698008e417da867d02e2f5cdcc80ff92af753dd585fada42fc611c2d7332c3a</p>
<h3>FakeM Original Samples</h3>
<p>53af257a42a8f182e97dcbb8d22227c27d654bea756d7f34a80cc7982b70aa60<br />
9adda3d95535c6cf83a1ba08fe83f718f5c722e06d0caff8eab4a564185971c5<br />
53cecc0d0f6924eacd23c49d0d95a6381834360fbbe2356778feb8dd396d723e<br />
631fc66e57acd52284aba2608e6f31ba19e2807367e33d8704f572f6af6bd9c3<br />
7bfbf49aa71b8235a16792ef721b7e4195df11cb75371f651595b37690d108c8<br />
7c9421a4605decfa1b3e22addbca98d86ea757dcd8ff8e075d13228c99618637<br />
202975d10ba417cf441e8f9986d2496807fe39e057d3226ec3b2713f0c218cd8<br />
22e7517d8996e92998eb996416f9d8ef06b3b1c220c1a5d29ccd5aaef7b10c72<br />
435df30d139ccbe5ce4e5ca6fe072e42e96d5ea1efd5317deebce462ecccc7ab<br />
47d9ba5f7bf70c5d2b7a832e070957cc7ebdcfd0a6ee75851df16dc45971ce8a<br />
4a3d0df9fa198a7ebe45db5239d22067e74924b1aace52029b3acc9b51af691e<br />
4d539f638ed476ca08da838cdfbf710dae82b582256d60a009e9d304f6822e65<br />
be0e8da7e261ec7d08eaa78e79ceb1be47c324b8e142097bf6569f9471c98a4e<br />
c30d03750458bb5f2b03d6bd399ffca6d378a3adb5a74bee3b6ba4b982dbf273<br />
cc7db456825e266849090b6fa95a94ad8c4c717712b610b0d39077af5222f4be<br />
d6d2a77f8ed2fe9fed9ee6dcb4cc0b339ba47a575c717c35815243c752d8f60c<br />
db8338e6b883fdceaa02c10ad683547a26ae32e0d4641cc24c7bd3b45154abb0<br />
e8e5ecf525c5259651bfbdf1923215729ec67658225eca1b02519f5f6279eacb<br />
ec4deb761b09ddc706804ef669836cf4b199f1d74b14ad623a6f6cc2f38190b8<br />
669ce0975c133d54e414dbf1de546aed742e76fe3e60568e2bd4747b7e0f8b70<br />
0d77f5f1d4c0f02fb88ac33fa365b17d28d1521cea59329ca4b3dd0b7031a60e<br />
363d9557861fab2d83d04847b967996361e670e571b335c7a535bc6278cba149<br />
7fb2c37431fd7b05414b134732ba0b29cd7dad17fc176627ee0815aac60c1ab9<br />
77e4ef9e08f1095487b4fa27492b4c9b8e833f29598f99a0d10f7c85b4254761<br />
a4ffca5f1c3d9c21629fa98a1e91121d954ab9347e86ac3c9613dae61bf30393<br />
428121c421bf81a0d689014cf21ec7951b0c32add86198e06f7d636981f68755<br />
a195f564aa2fb66db119e2fbec93e319a973e5cf50fbf9fc08bd81f9b7ee8af8<br />
c1e8ff8ebe3754bc7d14509ef3678edf7551d876d3fa847d07d469c09bceae91<br />
53238f67ac7e4cc27264efbacc8712bd97a5775feaf633c63adaa0785d038e8a<br />
508a7cab0f2a69ba66e92e86817a49ecd1b9c8ae11a995147944995fc868dfad<br />
fb60d14de4dba022f11437845d465a661d0c78d3d097a38770816f06992bf0af<br />
8da2f9afd914a4318a97f4d74809c0c383f8ebf0d3d6e3d3715efbd71a66a52f<br />
6fe33c672fd30bba9bbc89dc7d88993d8783382c9f9c510677b1bb068a5f1e51<br />
6a1c7999b4ba92899d3364fc729d0f052680be5a71dd0f13cbabdb19b82bf858<br />
5db51f2f7c31de7d165ec4892ae7dcedaa036caedeef718b57953d7935582f04<br />
27167a9d63f5ddc68a12decb1a1e0a2a29c72fe0681dca2c4f3d169f048a9d38<br />
6f10c892133b5dac6c40cfe77ca32b42572bc56909481b236080dfc143ef9afd<br />
de12cd8d11478d17342c60239837c1afcc9fee72df6ffdf9943802640d43f77a<br />
0f2db64b8283b76d49c9bb272beafab8323f941b6dc3888b42ff02f08634d016</p>
<h3>Psylo Samples</h3>
<p>19bbee954ac1a21595e63cb86d1a596236aed353804aec5cb8adfa62e70280d3<br />
a9f0bddc3d3516af8355e8ac17309528cd018347e5f56a347c14da0a83b0028a<br />
00bb399c429e0f1f7de751103fe92b5f820d1686d01662a08583b7a94aaed94e</p>
<h3>MobileOrder Sample</h3>
<p>03004ccc23033a09532bea7dfa08c8dfa85814a15f5e3aedb924a028bcd6f908</p>
<h3>CallMe Samples</h3>
<p>071c34b9701dd84f9590ba899a8af3eeec228a928f2d98a80dbc780e396ee01a<br />
d1f0658bbb15ab2bccc210d7e1f21b96e14ae22de8494ca95b12e182f3d0f693<br />
9ff687a813a5cb5ff10374c86f852534c1aa3e5a221123214bf52b2ff455a5da<br />
8c423506c0c7ebe1e61071374ecf0806463a02a2100b5daa1bd942129ff8a235<br />
91e36e720477146f1a0c050d3bc74bc6683a03e7631317ded3c598a10465dcc8<br />
c981db20d588ba2d0f437b4e5459e7c6763f52a97841450c94591ca28a9a2d69<br />
95dba004f949e44cb447246f3d2420b01db4541d0e4fa7b00d798f38a3d251e4</p>
<h3>FakeM Custom SSL C2 Servers</h3>
<p>aaa123.spdns[.]de<br />
admin.spdns[.]org<br />
detail43.myfirewall[.]org<br />
economy.spdns[.]de<br />
firefox.spdns[.]de<br />
firewallupdate.firewall-gateway[.]net<br />
intersecurity.firewall-gateway[.]com<br />
kaspersky.firewall-gateway[.]net<br />
kasperskysecurity.firewall-gateway[.]com<br />
kissecurity.firewall-gateway[.]net<br />
mail.firewall-gateway[.]com<br />
news.firewall-gateway[.]com<br />
opero.spdns[.]org<br />
sys.firewall-gateway[.]net</p>
<h3>FakeM SSL C2 Servers</h3>
<p>account.websurprisemail[.]com<br />
addi.apple.cloudns[.]org<br />
bailee.alanna.cloudns[.]biz<br />
bee.aoto.cloudns[.]org<br />
book.websurprisemail[.]com<br />
desk.websurprisemail[.]com<br />
dolat.diyarpakzimin[.]com<br />
dolat.websurprisemail[.]com<br />
dolet.websurprisemail[.]com<br />
github.ignorelist[.]com<br />
islam.youtubesitegroup[.]com<br />
mareva.catherine.cloudns[.]us<br />
muslim.islamhood[.]net<br />
p.klark.cloudns[.]in<br />
ppcc.vasilevich.cloudns[.]info<br />
press.ufoneconference[.]com<br />
vip.yahoo.cloudns[.]info</p>
<h3>FakeM Original C2 Servers</h3>
<p>207.204.225[.]117<br />
accounts.yourturbe[.]org<br />
addnow.zapto[.]org<br />
bits.githubs[.]net<br />
clean.popqueen.cloudns[.]org<br />
economy.spdns[.]eu<br />
eemete.freetcp[.]com<br />
email.googmail[.]org<br />
fish.seafood.cloudns[.]org<br />
freeavg.sytes[.]net<br />
freeonline.3d-game[.]com<br />
ibmcorp.slyip[.]com<br />
lemondtree.freetcp[.]com<br />
liumingzhen.myftp[.]org<br />
liumingzhen.zapto[.]org<br />
n.popqueen.cloudns[.]org<br />
news.googmail[.]org<br />
oic-oci.3-a[.]net<br />
polat.googmail[.]org<br />
qq.ufoneconference[.]com<br />
qq.yourturbe[.]org<br />
sisiow.slyip[.]com<br />
update.googmail[.]org<br />
uprnd.flnet[.]org<br />
video.googmail[.]org<br />
webmail.yourturbe[.]org<br />
worldwildlife.effers[.]com<br />
www.angleegg.ddns[.]us<br />
www.angleegg.xxxy[.]info<br />
www.googmail[.]org<br />
youturbe.co[.]cc<br />
yycc.mrbonus[.]com<br />
zjhao.dtdns[.]net</p>
<h3>Psylo C2 Servers</h3>
<p>apple.lenovositegroup[.]com<br />
mm.lenovositegroup[.]com<br />
ftp112.lenta.cloudns[.]pw<br />
www.gorlan.cloudns[.]pro<br />
otcgk.border.cloudns[.]pw</p>
<h3>MobileOrder C2 Servers</h3>
<p>ziba.lenovositegroup[.]com</p>
<h3>CallMe C2 Servers</h3>
<p>apple12.crabdance[.]com<br />
update.googmail[.]org<br />
apple12.crabdance[.]com<br />
alma.apple.cloudns[.]org</p>
<p><strong> </strong></p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
