
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Threat Actors Target Government of Belarus Using CMSTAR Trojan</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 identifies phishing emails using CMSTAR Trojan to target members of the Belarusian government."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Threat Actors Target Government of Belarus Using CMSTAR Trojan" />
<meta property="og:description" content="Unit 42 identifies phishing emails using CMSTAR Trojan to target members of the Belarusian government." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="BYEBY" />
<meta property="article:tag" content="cmstar" />
<meta property="article:tag" content="PYLOT" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-09-28T10:00:44+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:55:33+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:55:33+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1.gif" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1.gif" />
<meta property="og:image:width" content="973" />
<meta property="og:image:height" content="532" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 identifies phishing emails using CMSTAR Trojan to target members of the Belarusian government." />
<meta name="twitter:title" content="Threat Actors Target Government of Belarus Using CMSTAR Trojan" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1.gif" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Threat Actors Target Government of Belarus Using CMSTAR Trojan Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="36,573"/>
<meta property="og:date_created" content="September 28, 2017 at 1:00 PM"/>
<meta property="og:post_length" content="3783"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/joshgruznweig/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Threat Actors Target Government of Belarus Using CMSTAR Trojan","name":"Threat Actors Target Government of Belarus Using CMSTAR Trojan","description":"Unit 42 identifies phishing emails using CMSTAR Trojan to target members of the Belarusian government. ","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-threat-actors-target-government-belarus-using-cmstar-trojan\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-threat-actors-target-government-belarus-using-cmstar-trojan\/","datePublished":"September 28, 2017","articleBody":"Palo Alto Networks Unit 42 has identified a series of phishing emails containing updated versions of the previously discussed CMSTAR malware family targeting various government entities in the country of Belarus.\n\nWe first reported on CMSTAR in spear phishing attacks in spring of 2015 and later in 2016.\n\nIn this latest campaign, we observed a total of 20 unique emails between June and August of this year that included two new variants of the CMSTAR Downloader. We also discovered two previously unknown payloads. These payloads contained backdoors that we have named BYEBY and PYLOT respectively.\n\n\n\nFigure 1 Diagram of the attack sequence\nPhishing Emails\nBetween June and August of this year, we observed a total of 20 unique emails being sent to the following email addresses:\n\n\n\nEmail Address\nDescription\n\n\npress@mod.mil[.]by\nPress Service of the Ministry of Defense of the Republic of Belarus\n\n\nbaranovichi_eu@mod.mil[.]by\nBaranovichi Operational Management of the Armed Forces\n\n\nmodmail@mod.mil[.]by\nMinistry of Defense of the Republic of Belarus\n\n\nadmin@mod.mil[.]by\nMinistry of Defense of the Republic of Belarus\n\n\nitsc@mod.mil[.]by\nUnknown. Likely used by Ministry of Defense of the Republic of Belarus\n\n\nmineuvs@mod.mil[.]by\nMinsk Operational Administration of the Armed Forces\n\n\ninform@mod.mil[.]by\nUnknown. Likely used by Ministry of Defense of the Republic of Belarus\n\n\nuporov_milcoop@mod.mil[.]by\nUnknown. Likely used by Ministry of Defense of the Republic of Belarus\n\n\nvideo@gpk.gov[.]by\nState Border Committee of the Republic of Belarus\n\n\narmscontrol@mfa.gov[.]by\nInternational Security and Arms Control Department, Ministry of Foreign Affairs\n\n\nablameiko@mia[.]by\nUnknown. Likely used by the Ministry of Internal Affairs of the Republic of Belarus\n\n\n\n&nbsp;\n\nThese emails contained a series of subject lines, primarily revolving around the topic of \u0417\u0430\u043f\u0430\u0434-2017 (\u2018West-2017\u2019), also known in English as Zapad 2017. Zapad 2017 was a series of joint military exercises conducted by the Armed Forces of the Russian Federation and the Republic of Belarus, held from September 14th to 20th in 2017.\n\nThe full list of subject lines is as follows:\n\n \tFwd:\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043a \u0417\u0430\u043f\u0430\u0434-2017 [Translation: Fwd:Preparing for the West-2017]\n \t\u0432\u044b\u043f\u0443\u0441\u043a \u0432\u043e\u0441\u043f\u0438\u0442\u0430\u043d\u043d\u0438\u043a\u043e\u0432 [Translation: graduation]\n \t\u041a \u0417\u0430\u043f\u0430\u0434-2017 [Translation: To West-2017]\n \t\u0417\u0430\u043f\u0430\u0434-2017 [Translation: West-2017]\n\nAn example of some of the previously mentioned emails may be seen below.\n\n\n\nFigure 2 Phishing email sent to Belarus government (1\/2)\n\n\n\nFigure 3 Phishing email sent to Belarus government (2\/2)\nDecoy Documents\nWe observed that the attachments used in these emails contained a mixture of file types. RTF documents, Microsoft Word documents, and a RAR archive. The RAR archive contained a series of images, a decoy document, and a Microsoft Windows executable within it. The executable has a .scr file extension, and is designed to look like a Windows folder, as seen below:\n\n\n\nFigure 4 Payload disguising itself as a Microsoft Windows folder\n\nThe rough translation of the folder and file names above are \u2018Preparations for large-scale West-2017 exercises in this format are being held for the first time.\u2019 Within the actual folder, there are a series of JPG images, as well as a decoy document with a title that is translated to \u2018Thousands of Russian and Belarusian military are involved in the training of the rear services.\u2019\n\n\n\nFigure 5 Embedded images and decoy document within RAR\n\nThe decoy document contains the following content:\n\n\n\nFigure 6 Decoy document within RAR\n\nThe other RTF and Word documents used additional decoy documents, which can be seen below.\n\n\n\nFigure 7 Decoy document with translation (1\/2)\n\n\n\nFigure 8 Decoy document with translation (2\/2)\n\nWhile we observed different techniques being used for delivery, all attachments executed a variant of the CMSTAR malware family. We observed minor changes between variants, which we discuss in the CMSTAR Variations and Payloads section of the blog post.\n\nThe Word documents, which we track as Werow, employ malicious macros for their delivery. More information about these macros may be found in the Appendix of the blog post. Additionally, we have included a script that extracts these embedded payloads that can also be found in the Appendix.\n\nThe RTF documents made use of CVE-2015-1641. This vulnerability, patched in 2015, allows attackers to execute malicious code when these specially crafted documents are opened within vulnerable instances of Microsoft Word. The payload for these samples is embedded within them and obfuscated using a 4-byte XOR key of 0xCAFEBABE. We have included a script that can be used to extract the underlying payload of these RTFs statically that can be found in the Appendix.\n\nThe SCR file mentioned previously drops a CMSTAR DLL and runs it via an external call to rundll32.exe.\nCMSTAR Variations and Payloads\nIn total, we observed three variations of CMSTAR in these recent attacks against Belarusian targets. The biggest change observed between them looks to be minor modifications made to the string obfuscation routine. A very simple modification to the digit used in subtraction was modified between the variants, as shown below:\n\n\n\nFigure 9 String obfuscation modifications between CMSTAR variants\n\nThe older variation, named CMSTAR.A, was discussed in a previous blog post entitled, \u201cDigital Quartermaster Scenario Demonstrated in Attacks Against the Mongolian Government.\u201d\n\nThe CMSTAR.B variant was witnessed using both a different mutex from CMSTAR.A, as well as a slightly modified string obfuscation routine. The mutexes used by CMSTAR ensure that only one instance of the malware runs at a time. The CMSTAR.C variant used the same mutex as CMSTAR.B, however, again used another slightly modified string obfuscation routine. We found all CMSTAR variants using the same obfuscation routine when I payload was downloaded from a remote server. We have included a tool to extract mutex and C2 information from all three CMSTAR variants, as well as a tool to decode the downloaded payload: both may be found in the Scripts section.\n\nAn example of CMSTAR downloading its payload may be found below:\n\n\n\nFigure 10 Example HTTP download by CMSTAR\n\nWhen expanding the research to identify additional CMSTAR.B and CMSTAR.C variants, we identified a total of 31 samples. Of these 31 samples, we found two unique payloads served from three of the C2 URLS\u2014One of which was downloaded from a sample found in the phishing attacks previously described. Both payloads contained previously unknown malware families. We have named the payload found in the email campaign PYLOT, and the malware downloaded from the additional CMSTAR samples BYEBY.\n\nBoth malware families acted as backdoors, allowing the attackers to execute commands on the victim machine, as well as a series of other functions. More information about these individual malware families may be found in the appendix.\nConclusion\nDuring the course of this research, we identified a phishing campaign consisting of 20 unique emails targeting the government of Belarus. The ploys used in these email and decoy documents revolved around a joint strategic military exercise of the Armed Forces of the Russian Federation and the Republic of Belarus, which took place between September 14th and September 20th of this year. While looking at the emails in question, we observed two new variants of the CMSTAR malware family. Between the samples identified and others we found while expanding our research scope, we identified two previously unknown malware families.\n\nPalo Alto customers are protected from this threat in the following ways:\n\n \tTags have been created in AutoFocus to track CMSTAR, BYEBY, and PYLOT\n \tAll observed samples are identified as malicious in WildFire\n \tDomains observed to act as C2s have been flagged as malicious\n \tTraps 4.1 identifies and blocks the CVE-2015-1641 exploit used in these documents\n \tTraps 4.1 blocks the macros used in the malicious Word documents\n\nA special thanks to Tom Lancaster for his assistance on this research.\nAppendix\nWerow Macro Analysis\nThe attacker used the same macro dropper all of the observed Microsoft Word documents we analyzed for this campaign. It begins by building the following path strings:\n\n \t%APPDATA%\\d.doc\n \t%APPDATA%\\Microsoft\\Office\\WinCred.acl\n\nThe \u2018d.doc\u2019 path will be used to store a copy of the Word document, while the \u2018WinCred.acl\u2019 will contain the dropped payload, which is expected to be a DLL.\n\n\n\nFigure 11 Macro used to drop CMSTAR\n\nWerow uses rudimentary obfuscation to hide and re-assemble the following strings:\n\n \tHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\WinCred\n \trundll32 %APPDATA%\\Microsof\\Office\\WinCred.acl ,WinCred\n\nThese strings will be used at the end of the macro\u2019s execution to ensure persistence via the Run registry key.\n\nThe malware proceeds to read an included overlay within the original Word document from a given offset. This data is decoded using and XOR operation, as well as an addition operation. It can be represented in Python as follows:\ndef decrypt_xor(data, key, key_offset):\n  output = \"\"\n  seed = ord(key)\n  for d in data:\n    ord_d = ord(d)\n    if ord_d != 0 and ord_d != seed:\n      nvalue = ord_d ^ seed\n      seed = (seed + key_offset) % 0x100\n      output += chr(nvalue)\n    else:\n      output += d\n  return output\nOnce this overlay is decoded, it is written to the \u2018WinCred.acl\u2019 file and loaded with the \u2018WinCred\u2019 export. A script has been provided in the Scripts section that, in conjunction with oletools, can statically extract the embedded DLL payload from these documents.\nRTF Shellcode Analysis\nThe RTF documents delivered in this attack campaign appear to be created by the same builder. All of the RTF files attempt to exploit CVE-2015-1641 to execute shellcode on the targeted system. Please reference https:\/\/technet.microsoft.com\/en-us\/library\/security\/ms15-033.aspx for more information.\n\nThe shellcode executed after successful exploitation begins by resolving the API functions it requires by enumerating the API functions within loaded modules in the current process. It then builds the following list of values:\n\n\n\nThe shellcode then enumerates the API functions, subjects them to a ROR7 hashing routine and XORs the resulting hash with 0x10ADBEEF. It uses the result of this arithmetic to compare with the list of values above to find the API functions it requires to carry out its functionality.\n\n\n\nROR7\nROR7^0x10ADBEEF\nAPI Func\n\n\n1a22f51\n110f91be\nWinExec\n\n\n741f8dc4\n64b2332b\nWriteFile\n\n\n94e43293\n84498c7c\nCreateFileA\n\n\ndaa7fe52\nca0a40bd\nUnmapViewOfFile\n\n\ndbacbe43\ncb0100ac\nSetFilePointer\n\n\nec496a9e\nfce4d471\nGetEnvironmentVariableA\n\n\nff0d6657\nefa0d8b8\nCloseHandle\n\n\n\n&nbsp;\n\nAfter resolving the API functions, the shellcode then begins searching for the embedded payload and decoy within the initial RTF file. It does so by searching the RTF file for three delimiters, specifically 0xBABABABABABA, 0xBBBBBBBB and 0xBCBCBCBC, which the shellcode uses to find the encrypted payload and decoy. The shellcode then decrypts the payload by XOR'ing four bytes at at time with the key 0xCAFEBABE, and decrypts the decoy by XOR'ing four bytes at a time using the key 0xBAADF00D. Here is a visual representation of the delimiters and embedded files:\n\n\n\nAfter decrypting the payload, it saves the file to the following location:\n\n%APPDATA%\\Microsoft\\Office\\OutL12.pip\n\nThe shellcode then creates the following registry key to automatically run the payload each time the system starts:\n\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run : Microsoft\n\nThe shellcode saves the following command to this autorun key, which will execute the OutL12.pip payload, specifically calling its 'WinCred' exported function:\n\nrundll32.exe\n\"%APPDATA\\Roaming\\Microsoft\\Office\\OutL12.pip\",WinCred\n\nThe shellcode will then overwrite the original delivery document with the decrypted decoy contents and open the new document.\nPYLOT Analysis\nThis malware family was named via a combination of the DLLs original name of \u2018pilot.dll\u2019, along with the fact it downloads files with a Python (.py) file extension.\n\nPYLOT begins by being loaded as a DLL with the ServiceMain export. It proceeds to create the following two folders within the %TEMP% path:\n\n \tKB287640\n \tKB887209\n\nPYLOT continues to load and decode an embedded resource file. This file contains configuration information that is used by the malware throughout its execution. The following script, written in Python, may be used to decode this embedded resource object:\nimport sys\nimport hexdump\n\nfile = sys.argv[1]\nfh = open(file, 'rb')\nfdata = list(fh.read())\nfh.close()\n\nfdata_len = len(fdata)\nc = fdata_len-1\n\noutput = \"\"\nwhile c &gt; 1:\n\tfdata[c] = chr( ord(fdata[c]) ^ ord(fdata[c-2]) )\n\tc -= 1\n\nfdata = ''.join(fdata)\nhexdump.hexdump(fdata)\nLooking at the decoded data, we see the following:\n\n\n\nFigure 12 Decoded embedded configuration information\n\nThe malware continues to collect the following information from the victim computer:\n\n \tComputer name\n \tIP addresses present on the machine\n \tMAC addresses\n \tMicrosoft Windows version information\n \tWindows code page identifier information\n\nThis information is used to generate a unique hash for the victim machine. PYLOT then begins entering its C2 handler routine, where it will use HTTP for communication with the remote host.\n\nData sent to the remote C2 server is encrypted using RC4 with the previously shown key of \u2018BBidRotnqQpHfpRTi8cR.\u2019 It is then further obfuscated by base64-encoding this encrypted string. An example of this HTTP request containing this data can be seen below.\n\n&nbsp;\n\n\n\nFigure 13 HTTP request made by PYLOT to remote server\n\nThe decrypted data sent in the request above is as follows. Note that all of this custom data format has not been fully identified, however, we\u2019re able to see various strings, including the embedded configuration string of \u2018fGAka0001\u2019, as well as the victim hash of \u2018100048048.\u2019\n\n\n\nFigure 14 Decrypted data sent by PYLOT to remote server\n\nThe base64-encoded string at the end of the data contains the collected victim machine information from earlier, separated by a \u2018|\u2019 delimiter.\n\nThe remote C2 server responds using the same data format. An example response can be seen below.\n\n\n\nFigure 15 Response from remote C2 server\n\nThe decoded data at the end of the response contains various URIs to be used by the malware to receive commands, as well as other information that has yet to be fully researched.\n\/duakzu\/furs.py|\/ugvrf\/pvoi.py|\/tydfw\/pld.py|\/bpnij\/syau.py|\/plugin\/plugin.py|eycHhHKVQUnuAwtNchvYjScGYMtVMzMqYmxBmCEwieQpKgsokpvrxknPQRvnkOHDywCImVZxHxRdvlePjgnbPXsyTzreBEckVVFbuUHHcvLPGmqxHUNWondMIntBiVVO|CgpQxWOeTAbOLpOCdWtesymHSqjeSUYPQFBeUnbhXElorlcjqldwEMVucaDwJRhuzZjprKkZEPvLEWUbkEQxFUqzqIRQwyuTaBmOZSOpfJRByRvyTHjSVdVeihtkbcnG|GqPfDIAHOik\/\n\nA number of commands have been identified within PYLOT, including the following:\n\u2022 Download batch script\n\u2022 Run batch script\n\u2022 Delete file\n\u2022 Rename file\n\u2022 Execute file\n\u2022 Download file\n\u2022 Upload file\nBYEBY Analysis\nBYEBY was named based on a string within the malware itself. Most strings found within this malware are concatenated to 6 characters. One such example was an instance where a debug string contained \u2018BYE BY\u2019, which was likely a concatenated form of the phrase \u2018BYE BYE\u2019.\n\nThis malware is loaded as a DLL, with an export name of ServiceMain. When the malware is initially loaded, it begins by checking to see if it is running within either of the following paths:\n\n \t[SYSTEM32]\\svchost.exe\n \t[SYSTEM32]\\rundll32.exe\n\nIf it finds itself not running in either location, it will immediately exit. This is likely a technique used to bypass various sandboxing systems. Should it find itself running as svchost.exe, it will write the current timestamp and a value of \u2018V09SS010\u2019 (Base64 Decoded: \u2018WORKMN\u2019) to a file named \u2018vmunisvc.cab\u2019 within the user\u2019s local %TEMP% folder. This file acts as a lot file and is written to frequently throughout the malware\u2019s execution.\n\nWhen the malware runs within the context of svchost.exe, it bypasses the installation routines and immediately enters the C2 handler.\n\nWhen BYEBY is run within the context of rundll32.exe, it expects itself to be running for the first time. As such, it will register itself as a service with a name of \u2018VideoSrv.\u2019 After this service is created, BYEBY proceeds to enter it\u2019s C2 handler function in a new thread.\n\nBYEBY uses TLS for network communication, connecting to the following host on port 443:\n\n \toeiowidfla22[.]com\n\nAfter the initial connection is established, BYEBY will collect the following system information and upload it to the remote C2:\n\n \tHostname\n \tIP Address\n \tEmbedded String of 'WinVideo'\n \tMajor Windows Version\n \tMinor Windows Version\n \tEmbedded String of '6.1.7603.16000'\n\nThe malware is configured to accept a number of commands. These appear to be Base64-encoded strings that, when decoded, provide their true meaning. Only the beginning of the commands are checked. The Base64-decoded strings have been included for the benefit of the reader.\n\n \taGVsbG8h [Decoded: hello!]\n \tR09PREJZ [Decoded: GOODBY]\n \tTElTVCBE [Decoded: LIST D]\n \tU1RBUlRD [Decoded: STARTC]\n \tQ09NTUFO [Decoded: COMMAN]\n \tVFJBTlNG [Decoded: TRANSF]\n \tRVhFQ1VU [Decoded: EXECUT]\n\nA mapping of commands and their descriptions has been provided:\n\n\n\nCommand\nDescription\n\n\naGVsbG8h\nAuthenticate with the remote C2 server.\n\n\nR09PREJZ\nClose socket connection with remote server.\n\n\nTElTVCBE\nList drives on the victim machine.\n\n\nU1RBUlRD\nStart an interactive shell on the victim machine.\n\n\nQ09NTUFO\nExecute a command in the interactive shell\n\n\nVFJBTlNG\nUpload or download files to the victim machine.\n\n\nRVhFQ1VU\nExecute command in a new process.\n\n\n\nScripts\nWe created multiple scripts during the course of our research. We are sharing them here to assist other researchers or defenders that encounter this malware.\n\nextract_cmstar_doc.py \u2013 Script to extract the embedded CMSTAR payload from Word documents.\n\nextract_cmstar_rtf.py\u2013 Script to extract the embedded CMSTAR payload from RTFs.\n\nextract_cmstar_strings.py \u2013 Script to identify possible mutex and C2 strings from CMSTAR variants.\n\ndecode_cmstar_payload.py \u2013 Script to decode a payload downloaded by CMSTAR.\nIndicators of Compromise\nCMSTAR Variants Identified in Phishing Campaign\n65d5ef9aa617e7060779bc217a42372e99d59dc88f8ea2f3b9f45aacf3ba7209\n\n2a0169c72c84e6d3fa49af701fd46ee7aaf1d1d9e107798d93a6ca8df5d25957\n\n4da6ce5921b0dfff9045ada7e775c1755e6ea44eab55da7ccc362f2a70ce26a6\n\n2008ec82cec0b62bdb4d2cea64ff5a159a4327a058dfd867f877536389a72fb6\n\ncecd72851c265f885ff02c60cbc3e6cbf1a40b298274761f623dfa44782a01f8\n\nd8c0f8ecdeceba83396c98370f8f458ea7f7a935aabbcc3d41b80d4e85746357\n\n2c8267192b196bf8a92c8b72d52096e46e307fa4d4dafdc030d3e0f5b4145e9e\n\n2debf12b1cb1291cbd096b24897856948734fa62fd61a1f24d379b4224bda212\n\n79b30634075896084135b9891c42fca8a59db1c0c731e445940671efab9a0b61\n\nb0065fc16ae785834908f024fb3ddd4d9d62b29675859a8e737e3b949e85327a\n\n16697c95db5add6c1c23b2591b9d8eec5ed96074d057b9411f0b57a54af298d5\n\n6843d183b41b6b22976fc8d85e448dcc4d2e0bd2c159e6d966bfd4afa1cd9221\n\n3c3efa89d1dd39e1112558af38ba656e048be842a3bedb7933cdd4210025f791\n\nb2bebb381bc3722304ab1a21a21e082583bf6b88b84e7f65c4fdda48971c20a2\n\n09890dc8898b99647cdc1cceb97e764b6a88d55b5a520c8d0ea3bfd8f75ed83b\n\nfd22973451b88a4d10d9f485baef7f5e7a6f2cb9ce0826953571bd8f5d866c2a\nCMSTAR Download Locations in Phishing Campaign\nhttp:\/\/45.77.60[.]138\/YXza9HkKWzqtXlt.dat\nhttp:\/\/45.77.60[.]138\/mePVDjnAZsYCw5j.dat\nhttp:\/\/45.77.60[.]138\/UScHrzGWbXb01gv.dat\nhttp:\/\/45.76.80[.]32\/tYD7jzfVNZqMfye.dat\nhttp:\/\/45.77.60[.]138\/liW0ecpxEWCfIgU.dat\nhttp:\/\/45.77.60[.]138\/ezD19AweVIj5NaH.dat\nhttp:\/\/45.77.60[.]138\/jVJlw3wp379neaJ.dat\nhttp:\/\/108.61.175[.]110\/tlhXVFeBvT64LC9.dat\nhttp:\/\/45.77.60[.]138\/HJDBvnJ7wc4S5qZ.dat\nhttp:\/\/45.77.60[.]138\/JUmoT4Pbw6U2xcj.dat\nhttp:\/\/108.61.175[.]110\/oiUfxZfej29MAbF.dat\nhttp:\/\/45.77.60[.]138\/cw1PlY308OpfVeZ.dat\nhttp:\/\/45.77.60[.]138\/VFdSKlgCAZD7mmp.dat\nhttp:\/\/45.77.60[.]138\/c2KoCT5OHcVwGi7.dat\nhttp:\/\/45.77.60[.]138\/3kK24dXFYRgM6Ac.dat\nhttp:\/\/45.77.60[.]138\/WsEeRyHEhLO1kUm.dat\nPYLOT SHA256\n7e2c9e4acd05bc8ca45263b196e80e919ff60890a872bdc0576735a566369c46\nPYLOT C2\nwait.waisttoomuchmind[.]com\nBYEBY SHA256\n383a2d8f421ad2f243cbc142e9715c78f867a114b037626c2097cb3e070f67d6\nBYEBY C2\noeiowidfla22[.]com\nCMSTAR.B SHA256\n8609360b43498e296e14237d318c96c58dce3e91b7a1c608cd146496703a7fac\n\nf0f2215457200bb3003eecb277bf7e3888d16edcf132d88203b27966407c7dc3\n\naecf53a3a52662b441703e56555d06c9d3c61bddf4d3b23d9da02abbe390c609\n\n960a17797738dc0bc5623c74b6f8a5d74375f6d18d20ba18775f26a43898bae6\n\ne37c045418259ecdc07874b85e7b688ba53f5a7dc989db19d7e8c440300bd574\n\n75ea6e8dfaf56fb35f35cb043bd77aef9e2c7d46f3e2a0454dff0952a09c134f\n\na65e01412610e5ed8fde12cb78e6265a18ef78d2fd3c8c14ed8a3d1cef17c91d\n\n7170b104367530ae837daed466035a8be719fdb17423fc01da9c0ded74ca6ad1\n\n13acddf9b7c2daafd815cbfa75fbb778a7074a6f90277e858040275ae61a252b\n\n625ed818a25c63d8b2c264d0f5bd96ba5ad1c702702d8ffaa4e0e93e5f411fac\n\na56cd758608034c90e81e4d4f1fe383982247d6aeffd74a1dd98d84e9b56afdf\n\na4b969b93f7882ed2d15fd10970c4720961e42f3ae3fced501c0a1ffa3896ff5\n\ne833bbb79ca8ea1dbeb408520b97fb5a1b691d5a5f9c4f9deabecb3787b47f73\n\n8e9136d6dc7419469c959241bc8745af7ba51c7b02a12d04fec0bc4d3f7dcdf0\nCMSTAR.B Download Locations\nhttp:\/\/108.61.175[.]110\/tlhXVFeBvT64LC9.dat\nhttp:\/\/104.238.188[.]211\/gl7xljvn3fqGt3u.dat\nhttp:\/\/45.77.60[.]138\/c2KoCT5OHcVwGi7.dat\nhttp:\/\/108.61.175[.]110\/gkMmqVvZ7gGGxpY.dat\nhttp:\/\/108.61.175[.]110\/z_gaDZyeZXvScQ6.dat\nhttp:\/\/108.61.175[.]110\/bDtzGVtqgiJU9PI.dat\nhttp:\/\/45.77.60[.]138\/liW0ecpxEWCfIgU.dat\nhttp:\/\/45.77.60[.]138\/JUmoT4Pbw6U2xcj.dat\nhttp:\/\/108.61.175[.]110\/oiUfxZfej29MAbF.dat\nhttp:\/\/108.61.103[.]123\/jvZfZ0gdTWtr46y.dat\nhttp:\/\/108.61.103[.]123\/06JcD5jz5dSHVAy.dat\nhttp:\/\/108.61.103[.]123\/nj3dsMMpyQQDBF3.dat\nhttp:\/\/108.61.103[.]123\/fHZvWtBGlFvs2Nr.dat\nhttp:\/\/45.77.60[.]138\/w57E8dktKb9UQyV.dat\nCMSTAR.C SHA256\n85e06a2beaa4469f13ca58d5d09fec672d3d8962a7adad3c3cb74f3f9ef1fed4\n\nb8ef93227b59e6c8d3a1494b4860d15be819fae17b57fd56bfff9a51b7972ff0\n\n9e6fdbbc2371ac8bc6db3b878475ed0b0af8950d50a4652df688e778beb87397\n\n4e38e627ae21f1a85aa963ca990a66cf75789b450605fdca2f31ee6f0f8ab8f2\n\nf4ff0ca7f2ea2a011a2a4615d9b488b7806ff5dd61577a9e3a9860f2980e7fc0\n\n8de3fa2614b1767cfd12936c5adf4423ef25ea60800fa170752266e0ca063274\n\n38197abde967326568e101b65203c2efa75500e5f3c084b6dd08fd1ba1430726\n\n726df91a395827d11dc433854b3f19b3e28eac4feff329e0bdad93890b03af84\n\n5703565ec64d72eb693b9fafcba5951e937c8ee38829948e9518b7d226f81c10\n\nd0544a3e6d1b34b8b4e976c7fc62d4500f28f617e2f549d9a3e590b71b1f9cc5\n\n2a8e5551b9905e907da7268aba50fcbc526cfd0549ff2e352f9f4d1d71bf32a7\n\nd7cd6f367a84f6d5cf5ffb3c2537dd3f48297bd45a8f5a4c50190f683b7c9e90\n\n8f7294072a470b886791a7a32eedf0f0505aaecec154626c6334d986957086e4\n\n6419255d017b217fe984d3439694eb96806d06c7ea41a422298650969028c08c\nCMSTAR.C Download Locations\nhttp:\/\/45.77.58[.]49\/54xfapkezW64xDE.dat\nhttp:\/\/45.77.58[.]49\/54xfapkezW64xDE.dat\nhttp:\/\/45.77.62[.]181\/naIXl13kqeV7Y2j.dat\nhttp:\/\/45.77.58[.]160\/9EkCWYA3OtDbz1l.dat\nhttp:\/\/45.77.58[.]160\/8h5NPYB5fAn301E.dat\nhttp:\/\/45.77.58[.]160\/9EkCWYA3OtDbz1l.dat\nhttp:\/\/45.77.60[.]138\/3kK24dXFYRgM6Ac.dat\nhttp:\/\/45.77.60[.]138\/ezD19AweVIj5NaH.dat\nhttp:\/\/45.77.60[.]138\/VFdSKlgCAZD7mmp.dat\nhttp:\/\/45.77.60[.]138\/HJDBvnJ7wc4S5qZ.dat\nhttp:\/\/45.77.60[.]138\/jVJlw3wp379neaJ.dat\nhttp:\/\/45.77.60[.]138\/YXza9HkKWzqtXlt.dat\nhttp:\/\/45.77.60[.]138\/UScHrzGWbXb01gv.dat\nhttp:\/\/45.77.60[.]138\/WsEeRyHEhLO1kUm.dat","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2017\/09\/Picture1-150x150.gif","width":150,"height":150},"author":[{"@type":"Person","name":"Josh Grunzweig"},{"@type":"Person","name":"Robert Falcone"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"43929","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=43929' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-threat-actors-target-government-belarus-using-cmstar-trojan%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-threat-actors-target-government-belarus-using-cmstar-trojan%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-43929 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Threat Actors Target Government of Belarus Using CMSTAR Trojan</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-43929 entry-meta">
			
			
			<span class="post-views-count">36,573</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'43929','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-threat-actors-target-government-belarus-using-cmstar-trojan%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-threat-actors-target-government-belarus-using-cmstar-trojan%2F+-+Threat+Actors+Target+Government+of+Belarus+Using+CMSTAR+Trojan" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-threat-actors-target-government-belarus-using-cmstar-trojan%2F&title=Threat+Actors+Target+Government+of+Belarus+Using+CMSTAR+Trojan&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/joshgruznweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a> and <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a>        </p>
        <p><time datetime="2017-09-28T10:00:44+00:00">September 28, 2017 at 1:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/byeby/" rel="tag">BYEBY</a>, <a href="https://unit42.paloaltonetworks.com/tag/cmstar/" rel="tag">cmstar</a>, <a href="https://unit42.paloaltonetworks.com/tag/pylot/" rel="tag">PYLOT</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="492" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1-900x492.gif" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1-900x492.gif 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1-300x164.gif 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1-768x420.gif 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/Picture1-370x202.gif 370w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p>Palo Alto Networks Unit 42 has identified a series of phishing emails containing updated versions of the previously discussed <a href="https://researchcenter.paloaltonetworks.com/tag/cmstar/">CMSTAR malware family</a> targeting various government entities in the country of Belarus.</p>
<p>We first reported on CMSTAR in <a href="https://researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin/">spear phishing attacks in spring of 2015</a> and later <a href="https://researchcenter.paloaltonetworks.com/2016/03/digital-quartermaster-scenario-demonstrated-in-attacks-against-the-mongolian-government/">in 2016</a>.</p>
<p>In this latest campaign, we observed a total of 20 unique emails between June and August of this year that included two new variants of the CMSTAR Downloader. We also discovered two previously unknown payloads. These payloads contained backdoors that we have named BYEBY and PYLOT respectively.</p>
<p><img class="alignnone size-full wp-image-44292" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_1.png" alt="CMSTAR_1" width="973" height="532" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_1.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_1-900x492.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_1-300x164.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_1-768x420.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_1-370x202.png 370w" sizes="(max-width: 973px) 100vw, 973px" /></p>
<p><em>Figure 1 Diagram of the attack sequence</em></p>
<h2><strong>Phishing Emails</strong></h2>
<p>Between June and August of this year, we observed a total of 20 unique emails being sent to the following email addresses:</p>
<table style="height: 632px;" width="602">
<tbody>
<tr>
<td width="234"><strong>Email Address</strong></td>
<td width="234"><strong>Description</strong></td>
</tr>
<tr>
<td width="234">press@mod.mil[.]by</td>
<td width="234">Press Service of the Ministry of Defense of the Republic of Belarus</td>
</tr>
<tr>
<td width="234">baranovichi_eu@mod.mil[.]by</td>
<td width="234">Baranovichi Operational Management of the Armed Forces</td>
</tr>
<tr>
<td width="234">modmail@mod.mil[.]by</td>
<td width="234">Ministry of Defense of the Republic of Belarus</td>
</tr>
<tr>
<td width="234">admin@mod.mil[.]by</td>
<td width="234">Ministry of Defense of the Republic of Belarus</td>
</tr>
<tr>
<td width="234">itsc@mod.mil[.]by</td>
<td width="234">Unknown. Likely used by Ministry of Defense of the Republic of Belarus</td>
</tr>
<tr>
<td width="234">mineuvs@mod.mil[.]by</td>
<td width="234">Minsk Operational Administration of the Armed Forces</td>
</tr>
<tr>
<td width="234">inform@mod.mil[.]by</td>
<td width="234">Unknown. Likely used by Ministry of Defense of the Republic of Belarus</td>
</tr>
<tr>
<td width="234">uporov_milcoop@mod.mil[.]by</td>
<td width="234">Unknown. Likely used by Ministry of Defense of the Republic of Belarus</td>
</tr>
<tr>
<td width="234">video@gpk.gov[.]by</td>
<td width="234">State Border Committee of the Republic of Belarus</td>
</tr>
<tr>
<td width="234">armscontrol@mfa.gov[.]by</td>
<td width="234">International Security and Arms Control Department, Ministry of Foreign Affairs</td>
</tr>
<tr>
<td width="234">ablameiko@mia[.]by</td>
<td width="234">Unknown. Likely used by the Ministry of Internal Affairs of the Republic of Belarus</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>These emails contained a series of subject lines, primarily revolving around the topic of -2017 (<a href="https://ru.wikipedia.org/wiki/%D0%97%D0%B0%D0%BF%D0%B0%D0%B4-2017">West-2017</a>), also known in English as <a href="https://en.wikipedia.org/wiki/Zapad_2017_exercise">Zapad 2017</a>. Zapad 2017 was a series of joint military exercises conducted by the Armed Forces of the Russian Federation and the Republic of Belarus, held from September 14th to 20th in 2017.</p>
<p>The full list of subject lines is as follows:</p>
<ul>
<li>Fwd:  -2017 [Translation: Fwd:Preparing for the West-2017]</li>
<li>  [Translation: graduation]</li>
<li> -2017 [Translation: To West-2017]</li>
<li>-2017 [Translation: West-2017]</li>
</ul>
<p>An example of some of the previously mentioned emails may be seen below.</p>
<p><img class="alignnone size-full wp-image-44268" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_2.png" alt="CMSTAR_2" width="1013" height="634" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_2.png 1013w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_2-900x563.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_2-300x188.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_2-768x481.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_2-370x232.png 370w" sizes="(max-width: 1013px) 100vw, 1013px" /></p>
<p><em>Figure 2 Phishing email sent to Belarus government (1/2)</em></p>
<p><img class="alignnone size-full wp-image-44244" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_3.png" alt="CMSTAR_3" width="1011" height="632" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_3.png 1011w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_3-900x563.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_3-300x188.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_3-768x480.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_3-370x231.png 370w" sizes="(max-width: 1011px) 100vw, 1011px" /></p>
<p><em>Figure 3 Phishing email sent to Belarus government (2/2)</em></p>
<h2><strong>Decoy Documents</strong></h2>
<p>We observed that the attachments used in these emails contained a mixture of file types. RTF documents, Microsoft Word documents, and a RAR archive. The RAR archive contained a series of images, a decoy document, and a Microsoft Windows executable within it. The executable has a .scr file extension, and is designed to look like a Windows folder, as seen below:</p>
<p><img class="alignnone size-full wp-image-44220" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_4.png" alt="CMSTAR_4" width="975" height="246" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_4.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_4-900x227.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_4-300x76.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_4-768x194.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_4-370x93.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 4 Payload disguising itself as a Microsoft Windows folder</em></p>
<p>The rough translation of the folder and file names above are Preparations for large-scale West-2017 exercises in this format are being held for the first time. Within the actual folder, there are a series of JPG images, as well as a decoy document with a title that is translated to Thousands of Russian and Belarusian military are involved in the training of the rear services.</p>
<p><img class="alignnone size-full wp-image-44196" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_5.png" alt="CMSTAR_5" width="973" height="800" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_5.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_5-900x740.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_5-300x247.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_5-768x631.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_5-370x304.png 370w" sizes="(max-width: 973px) 100vw, 973px" /></p>
<p><em>Figure 5 Embedded images and decoy document within RAR</em></p>
<p>The decoy document contains the following content:</p>
<p><img class="alignnone size-full wp-image-44172" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_6.png" alt="CMSTAR_6" width="975" height="569" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_6.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_6-900x525.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_6-300x175.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_6-768x448.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_6-370x216.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 6 Decoy document within RAR</em></p>
<p>The other RTF and Word documents used additional decoy documents, which can be seen below.</p>
<p><img class="alignnone size-full wp-image-44148" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_7.png" alt="CMSTAR_7" width="973" height="498" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_7.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_7-900x461.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_7-300x154.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_7-768x393.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_7-370x189.png 370w" sizes="(max-width: 973px) 100vw, 973px" /></p>
<p><em>Figure 7 Decoy document with translation (1/2)</em></p>
<p><img class="alignnone size-full wp-image-44124" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_8.png" alt="CMSTAR_8" width="973" height="567" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_8.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_8-900x524.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_8-300x175.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_8-768x448.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_8-370x216.png 370w" sizes="(max-width: 973px) 100vw, 973px" /></p>
<p><em>Figure 8 Decoy document with translation (2/2)</em></p>
<p>While we observed different techniques being used for delivery, all attachments executed a variant of the CMSTAR malware family. We observed minor changes between variants, which we discuss in the CMSTAR Variations and Payloads section of the blog post.</p>
<p>The Word documents, which we track as Werow, employ malicious macros for their delivery. More information about these macros may be found in the <a href="#Appendix">Appendix</a> of the blog post. Additionally, we have included a script that extracts these embedded payloads that can also be found in the Appendix.</p>
<p>The RTF documents made use of <a href="https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1641">CVE-2015-1641</a>. This vulnerability, patched in 2015, allows attackers to execute malicious code when these specially crafted documents are opened within vulnerable instances of Microsoft Word. The payload for these samples is embedded within them and obfuscated using a 4-byte XOR key of 0xCAFEBABE. We have included a script that can be used to extract the underlying payload of these RTFs statically that can be found in the Appendix.</p>
<p>The SCR file mentioned previously drops a CMSTAR DLL and runs it via an external call to rundll32.exe.</p>
<h2><strong>CMSTAR Variations and Payloads</strong></h2>
<p>In total, we observed three variations of CMSTAR in these recent attacks against Belarusian targets. The biggest change observed between them looks to be minor modifications made to the string obfuscation routine. A very simple modification to the digit used in subtraction was modified between the variants, as shown below:</p>
<p><img class="alignnone size-full wp-image-44100" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_9.png" alt="CMSTAR_9" width="975" height="304" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_9.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_9-900x281.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_9-300x94.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_9-768x239.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_9-370x115.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 9 String obfuscation modifications between CMSTAR variants</em></p>
<p>The older variation, named CMSTAR.A, was discussed in a previous blog post entitled, <a href="https://researchcenter.paloaltonetworks.com/2016/03/digital-quartermaster-scenario-demonstrated-in-attacks-against-the-mongolian-government/">Digital Quartermaster Scenario Demonstrated in Attacks Against the Mongolian Government</a>.</p>
<p>The CMSTAR.B variant was witnessed using both a different mutex from CMSTAR.A, as well as a slightly modified string obfuscation routine. The mutexes used by CMSTAR ensure that only one instance of the malware runs at a time. The CMSTAR.C variant used the same mutex as CMSTAR.B, however, again used another slightly modified string obfuscation routine. We found all CMSTAR variants using the same obfuscation routine when I payload was downloaded from a remote server. We have included a tool to extract mutex and C2 information from all three CMSTAR variants, as well as a tool to decode the downloaded payload: both may be found in the Scripts section.</p>
<p>An example of CMSTAR downloading its payload may be found below:</p>
<p><img class="alignnone size-full wp-image-44076" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_10.png" alt="CMSTAR_10" width="975" height="158" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_10.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_10-900x146.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_10-300x49.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_10-768x124.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_10-370x60.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 10 Example HTTP download by CMSTAR</em></p>
<p>When expanding the research to identify additional CMSTAR.B and CMSTAR.C variants, we identified a total of 31 samples. Of these 31 samples, we found two unique payloads served from three of the C2 URLSOne of which was downloaded from a sample found in the phishing attacks previously described. Both payloads contained previously unknown malware families. We have named the payload found in the email campaign PYLOT, and the malware downloaded from the additional CMSTAR samples BYEBY.</p>
<p>Both malware families acted as backdoors, allowing the attackers to execute commands on the victim machine, as well as a series of other functions. More information about these individual malware families may be found in the appendix.</p>
<h2><strong>Conclusion</strong></h2>
<p>During the course of this research, we identified a phishing campaign consisting of 20 unique emails targeting the government of Belarus. The ploys used in these email and decoy documents revolved around a joint strategic military exercise of the Armed Forces of the Russian Federation and the Republic of Belarus, which took place between September 14<sup>th</sup> and September 20<sup>th</sup> of this year. While looking at the emails in question, we observed two new variants of the CMSTAR malware family. Between the samples identified and others we found while expanding our research scope, we identified two previously unknown malware families.</p>
<p>Palo Alto customers are protected from this threat in the following ways:</p>
<ul>
<li>Tags have been created in AutoFocus to track <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Cmstar">CMSTAR</a>, <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.BYEBY">BYEBY</a>, and <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.PYLOT">PYLOT</a></li>
<li>All observed samples are identified as malicious in WildFire</li>
<li>Domains observed to act as C2s have been flagged as malicious</li>
<li>Traps 4.1 identifies and blocks the CVE-2015-1641 exploit used in these documents</li>
<li>Traps 4.1 blocks the macros used in the malicious Word documents</li>
</ul>
<p>A special thanks to Tom Lancaster for his assistance on this research.</p>
<h2><strong>Appendix</strong></h2>
<h3><strong>Werow Macro Analysis</strong></h3>
<p>The attacker used the same macro dropper all of the observed Microsoft Word documents we analyzed for this campaign. It begins by building the following path strings:</p>
<ul>
<li>%APPDATA%\d.doc</li>
<li>%APPDATA%\Microsoft\Office\WinCred.acl</li>
</ul>
<p>The d.doc path will be used to store a copy of the Word document, while the WinCred.acl will contain the dropped payload, which is expected to be a DLL.</p>
<p><img class="alignnone size-full wp-image-44052" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_11.png" alt="CMSTAR_11" width="942" height="1348" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_11.png 942w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_11-900x1288.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_11-210x300.png 210w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_11-768x1099.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_11-716x1024.png 716w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_11-370x529.png 370w" sizes="(max-width: 942px) 100vw, 942px" /></p>
<p><em>Figure 11 Macro used to drop CMSTAR</em></p>
<p>Werow uses rudimentary obfuscation to hide and re-assemble the following strings:</p>
<ul>
<li>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\WinCred</li>
<li>rundll32 %APPDATA%\Microsof\Office\WinCred.acl ,WinCred</li>
</ul>
<p>These strings will be used at the end of the macros execution to ensure persistence via the Run registry key.</p>
<p>The malware proceeds to read an included overlay within the original Word document from a given offset. This data is decoded using and XOR operation, as well as an addition operation. It can be represented in Python as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69287fa8a32755591204" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt_xor(data, key, key_offset):
  output = ""
  seed = ord(key)
  for d in data:
    ord_d = ord(d)
    if ord_d != 0 and ord_d != seed:
      nvalue = ord_d ^ seed
      seed = (seed + key_offset) % 0x100
      output += chr(nvalue)
    else:
      output += d
  return output</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69287fa8a32755591204-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a32755591204-2">2</div><div class="crayon-num" data-line="crayon-5f69287fa8a32755591204-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a32755591204-4">4</div><div class="crayon-num" data-line="crayon-5f69287fa8a32755591204-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a32755591204-6">6</div><div class="crayon-num" data-line="crayon-5f69287fa8a32755591204-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a32755591204-8">8</div><div class="crayon-num" data-line="crayon-5f69287fa8a32755591204-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a32755591204-10">10</div><div class="crayon-num" data-line="crayon-5f69287fa8a32755591204-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a32755591204-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69287fa8a32755591204-1"><span class="crayon-e">def </span><span class="crayon-e">decrypt_xor</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key_offset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a32755591204-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f69287fa8a32755591204-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a32755591204-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f69287fa8a32755591204-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ord_d</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a32755591204-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">ord_d</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">ord_d</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-v">seed</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f69287fa8a32755591204-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">nvalue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ord_d</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">seed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a32755591204-8"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">key_offset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span></div><div class="crayon-line" id="crayon-5f69287fa8a32755591204-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">nvalue</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a32755591204-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f69287fa8a32755591204-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-i">d</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a32755591204-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">output</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Once this overlay is decoded, it is written to the WinCred.acl file and loaded with the WinCred export. A script has been provided in the Scripts section that, in conjunction with oletools, can statically extract the embedded DLL payload from these documents.</p>
<h3><strong>RTF Shellcode Analysis</strong></h3>
<p>The RTF documents delivered in this attack campaign appear to be created by the same builder. All of the RTF files attempt to exploit CVE-2015-1641 to execute shellcode on the targeted system. Please reference https://technet.microsoft.com/en-us/library/security/ms15-033.aspx for more information.</p>
<p>The shellcode executed after successful exploitation begins by resolving the API functions it requires by enumerating the API functions within loaded modules in the current process. It then builds the following list of values:</p>
<p><img class="alignnone size-full wp-image-44028" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_12.png" alt="CMSTAR_12" width="777" height="173" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_12.png 777w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_12-300x67.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_12-768x171.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_12-370x82.png 370w" sizes="(max-width: 777px) 100vw, 777px" /></p>
<p>The shellcode then enumerates the API functions, subjects them to a ROR7 hashing routine and XORs the resulting hash with 0x10ADBEEF. It uses the result of this arithmetic to compare with the list of values above to find the API functions it requires to carry out its functionality.</p>
<table>
<tbody>
<tr>
<td width="156"><strong>ROR7</strong></td>
<td width="156"><strong>ROR7^0x10ADBEEF</strong></td>
<td width="156"><strong>API Func</strong></td>
</tr>
<tr>
<td width="156">1a22f51</td>
<td width="156">110f91be</td>
<td width="156">WinExec</td>
</tr>
<tr>
<td width="156">741f8dc4</td>
<td width="156">64b2332b</td>
<td width="156">WriteFile</td>
</tr>
<tr>
<td width="156">94e43293</td>
<td width="156">84498c7c</td>
<td width="156">CreateFileA</td>
</tr>
<tr>
<td width="156">daa7fe52</td>
<td width="156">ca0a40bd</td>
<td width="156">UnmapViewOfFile</td>
</tr>
<tr>
<td width="156">dbacbe43</td>
<td width="156">cb0100ac</td>
<td width="156">SetFilePointer</td>
</tr>
<tr>
<td width="156">ec496a9e</td>
<td width="156">fce4d471</td>
<td width="156">GetEnvironmentVariableA</td>
</tr>
<tr>
<td width="156">ff0d6657</td>
<td width="156">efa0d8b8</td>
<td width="156">CloseHandle</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>After resolving the API functions, the shellcode then begins searching for the embedded payload and decoy within the initial RTF file. It does so by searching the RTF file for three delimiters, specifically 0xBABABABABABA, 0xBBBBBBBB and 0xBCBCBCBC, which the shellcode uses to find the encrypted payload and decoy. The shellcode then decrypts the payload by XOR&#8217;ing four bytes at at time with the key 0xCAFEBABE, and decrypts the decoy by XOR&#8217;ing four bytes at a time using the key 0xBAADF00D. Here is a visual representation of the delimiters and embedded files:</p>
<p><img class="alignnone wp-image-44430" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/screenshot-4-1.png" alt="CMSTAR_delimiters" width="600" height="203" /></p>
<p>After decrypting the payload, it saves the file to the following location:</p>
<p>%APPDATA%\Microsoft\Office\OutL12.pip</p>
<p>The shellcode then creates the following registry key to automatically run the payload each time the system starts:</p>
<p>Software\Microsoft\Windows\CurrentVersion\Run : Microsoft</p>
<p>The shellcode saves the following command to this autorun key, which will execute the OutL12.pip payload, specifically calling its &#8216;WinCred&#8217; exported function:</p>
<p>rundll32.exe<br />
&#8220;%APPDATA\Roaming\Microsoft\Office\OutL12.pip&#8221;,WinCred</p>
<p>The shellcode will then overwrite the original delivery document with the decrypted decoy contents and open the new document.</p>
<h3><strong>PYLOT Analysis</strong></h3>
<p>This malware family was named via a combination of the DLLs original name of pilot.dll, along with the fact it downloads files with a Python (.py) file extension.</p>
<p>PYLOT begins by being loaded as a DLL with the ServiceMain export. It proceeds to create the following two folders within the %TEMP% path:</p>
<ul>
<li>KB287640</li>
<li>KB887209</li>
</ul>
<p>PYLOT continues to load and decode an embedded resource file. This file contains configuration information that is used by the malware throughout its execution. The following script, written in Python, may be used to decode this embedded resource object:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69287fa8a4d945834912" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import sys
import hexdump

file = sys.argv[1]
fh = open(file, 'rb')
fdata = list(fh.read())
fh.close()

fdata_len = len(fdata)
c = fdata_len-1

output = ""
while c &amp;gt; 1:
	fdata[c] = chr( ord(fdata[c]) ^ ord(fdata[c-2]) )
	c -= 1

fdata = ''.join(fdata)
hexdump.hexdump(fdata)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-2">2</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-4">4</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-6">6</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-8">8</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-10">10</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-12">12</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-14">14</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-16">16</div><div class="crayon-num" data-line="crayon-5f69287fa8a4d945834912-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f69287fa8a4d945834912-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-1"><span class="crayon-e">import </span><span class="crayon-e">sys</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-2"><span class="crayon-e">import </span><span class="crayon-e">hexdump</span></div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-4"><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-5"><span class="crayon-v">fh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-6"><span class="crayon-v">fdata</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">fh</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-7"><span class="crayon-v">fh</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-8">&nbsp;</div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-9"><span class="crayon-v">fdata_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fdata</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-10"><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fdata_len</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-12"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-13"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-14"><span class="crayon-h">	</span><span class="crayon-v">fdata</span><span class="crayon-sy">[</span><span class="crayon-v">c</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">fdata</span><span class="crayon-sy">[</span><span class="crayon-v">c</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">fdata</span><span class="crayon-sy">[</span><span class="crayon-v">c</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-15"><span class="crayon-h">	</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-16">&nbsp;</div><div class="crayon-line" id="crayon-5f69287fa8a4d945834912-17"><span class="crayon-v">fdata</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">fdata</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f69287fa8a4d945834912-18"><span class="crayon-v">hexdump</span><span class="crayon-sy">.</span><span class="crayon-e">hexdump</span><span class="crayon-sy">(</span><span class="crayon-v">fdata</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Looking at the decoded data, we see the following:</p>
<p><img class="alignnone size-full wp-image-44004" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_13.png" alt="CMSTAR_13" width="975" height="1002" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_13.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_13-900x925.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_13-292x300.png 292w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_13-768x789.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_13-370x380.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 12 Decoded embedded configuration information</em></p>
<p>The malware continues to collect the following information from the victim computer:</p>
<ul>
<li>Computer name</li>
<li>IP addresses present on the machine</li>
<li>MAC addresses</li>
<li>Microsoft Windows version information</li>
<li>Windows code page identifier information</li>
</ul>
<p>This information is used to generate a unique hash for the victim machine. PYLOT then begins entering its C2 handler routine, where it will use HTTP for communication with the remote host.</p>
<p>Data sent to the remote C2 server is encrypted using RC4 with the previously shown key of BBidRotnqQpHfpRTi8cR. It is then further obfuscated by base64-encoding this encrypted string. An example of this HTTP request containing this data can be seen below.</p>
<p>&nbsp;</p>
<p><img class="alignnone size-full wp-image-44379" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_14-1.png" alt="CMSTAR_14" width="975" height="267" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_14-1.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_14-1-900x246.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_14-1-300x82.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_14-1-768x210.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_14-1-370x101.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 13 HTTP request made by PYLOT to remote server</em></p>
<p>The decrypted data sent in the request above is as follows. Note that all of this custom data format has not been fully identified, however, were able to see various strings, including the embedded configuration string of fGAka0001, as well as the victim hash of 100048048.</p>
<p><img class="alignnone size-full wp-image-43956" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_15.png" alt="CMSTAR_15" width="975" height="508" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_15.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_15-900x469.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_15-300x156.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_15-768x400.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_15-370x193.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 14 Decrypted data sent by PYLOT to remote server</em></p>
<p>The base64-encoded string at the end of the data contains the collected victim machine information from earlier, separated by a | delimiter.</p>
<p>The remote C2 server responds using the same data format. An example response can be seen below.</p>
<p><img class="alignnone size-full wp-image-43932" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_16.png" alt="CMSTAR_16" width="975" height="283" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_16.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_16-900x261.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_16-300x87.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_16-768x223.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/09/CMSTAR_16-370x107.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 15 Response from remote C2 server</em></p>
<p>The decoded data at the end of the response contains various URIs to be used by the malware to receive commands, as well as other information that has yet to be fully researched.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f69287fa8a52097340766" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/duakzu/furs.py|/ugvrf/pvoi.py|/tydfw/pld.py|/bpnij/syau.py|/plugin/plugin.py|eycHhHKVQUnuAwtNchvYjScGYMtVMzMqYmxBmCEwieQpKgsokpvrxknPQRvnkOHDywCImVZxHxRdvlePjgnbPXsyTzreBEckVVFbuUHHcvLPGmqxHUNWondMIntBiVVO|CgpQxWOeTAbOLpOCdWtesymHSqjeSUYPQFBeUnbhXElorlcjqldwEMVucaDwJRhuzZjprKkZEPvLEWUbkEQxFUqzqIRQwyuTaBmOZSOpfJRByRvyTHjSVdVeihtkbcnG|GqPfDIAHOik/</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f69287fa8a52097340766-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f69287fa8a52097340766-1"><span class="crayon-o">/</span><span class="crayon-v">duakzu</span><span class="crayon-o">/</span><span class="crayon-v">furs</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">|</span><span class="crayon-o">/</span><span class="crayon-v">ugvrf</span><span class="crayon-o">/</span><span class="crayon-v">pvoi</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">|</span><span class="crayon-o">/</span><span class="crayon-v">tydfw</span><span class="crayon-o">/</span><span class="crayon-v">pld</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">|</span><span class="crayon-o">/</span><span class="crayon-v">bpnij</span><span class="crayon-o">/</span><span class="crayon-v">syau</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">|</span><span class="crayon-o">/</span><span class="crayon-v">plugin</span><span class="crayon-o">/</span><span class="crayon-v">plugin</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">|</span><span class="crayon-v">eycHhHKVQUnuAwtNchvYjScGYMtVMzMqYmxBmCEwieQpKgsokpvrxknPQRvnkOHDywCImVZxHxRdvlePjgnbPXsyTzreBEckVVFbuUHHcvLPGmqxHUNWondMIntBiVVO</span><span class="crayon-o">|</span><span class="crayon-v">CgpQxWOeTAbOLpOCdWtesymHSqjeSUYPQFBeUnbhXElorlcjqldwEMVucaDwJRhuzZjprKkZEPvLEWUbkEQxFUqzqIRQwyuTaBmOZSOpfJRByRvyTHjSVdVeihtkbcnG</span><span class="crayon-o">|</span><span class="crayon-v">GqPfDIAHOik</span><span class="crayon-o">/</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>A number of commands have been identified within PYLOT, including the following:<br />
 Download batch script<br />
 Run batch script<br />
 Delete file<br />
 Rename file<br />
 Execute file<br />
 Download file<br />
 Upload file</p>
<h3><strong>BYEBY Analysis</strong></h3>
<p>BYEBY was named based on a string within the malware itself. Most strings found within this malware are concatenated to 6 characters. One such example was an instance where a debug string contained BYE BY, which was likely a concatenated form of the phrase BYE BYE.</p>
<p>This malware is loaded as a DLL, with an export name of ServiceMain. When the malware is initially loaded, it begins by checking to see if it is running within either of the following paths:</p>
<ul>
<li>[SYSTEM32]\svchost.exe</li>
<li>[SYSTEM32]\rundll32.exe</li>
</ul>
<p>If it finds itself not running in either location, it will immediately exit. This is likely a technique used to bypass various sandboxing systems. Should it find itself running as svchost.exe, it will write the current timestamp and a value of V09SS010 (Base64 Decoded: WORKMN) to a file named vmunisvc.cab within the users local %TEMP% folder. This file acts as a lot file and is written to frequently throughout the malwares execution.</p>
<p>When the malware runs within the context of svchost.exe, it bypasses the installation routines and immediately enters the C2 handler.</p>
<p>When BYEBY is run within the context of rundll32.exe, it expects itself to be running for the first time. As such, it will register itself as a service with a name of VideoSrv. After this service is created, BYEBY proceeds to enter its C2 handler function in a new thread.</p>
<p>BYEBY uses TLS for network communication, connecting to the following host on port 443:</p>
<ul>
<li>oeiowidfla22[.]com</li>
</ul>
<p>After the initial connection is established, BYEBY will collect the following system information and upload it to the remote C2:</p>
<ul>
<li>Hostname</li>
<li>IP Address</li>
<li>Embedded String of &#8216;WinVideo&#8217;</li>
<li>Major Windows Version</li>
<li>Minor Windows Version</li>
<li>Embedded String of &#8216;6.1.7603.16000&#8217;</li>
</ul>
<p>The malware is configured to accept a number of commands. These appear to be Base64-encoded strings that, when decoded, provide their true meaning. Only the beginning of the commands are checked. The Base64-decoded strings have been included for the benefit of the reader.</p>
<ul>
<li>aGVsbG8h [Decoded: hello!]</li>
<li>R09PREJZ [Decoded: GOODBY]</li>
<li>TElTVCBE [Decoded: LIST D]</li>
<li>U1RBUlRD [Decoded: STARTC]</li>
<li>Q09NTUFO [Decoded: COMMAN]</li>
<li>VFJBTlNG [Decoded: TRANSF]</li>
<li>RVhFQ1VU [Decoded: EXECUT]</li>
</ul>
<p>A mapping of commands and their descriptions has been provided:</p>
<table>
<tbody>
<tr>
<td width="99"><strong>Command</strong></td>
<td width="369"><strong>Description</strong></td>
</tr>
<tr>
<td width="99">aGVsbG8h</td>
<td width="369">Authenticate with the remote C2 server.</td>
</tr>
<tr>
<td width="99">R09PREJZ</td>
<td width="369">Close socket connection with remote server.</td>
</tr>
<tr>
<td width="99">TElTVCBE</td>
<td width="369">List drives on the victim machine.</td>
</tr>
<tr>
<td width="99">U1RBUlRD</td>
<td width="369">Start an interactive shell on the victim machine.</td>
</tr>
<tr>
<td width="99">Q09NTUFO</td>
<td width="369">Execute a command in the interactive shell</td>
</tr>
<tr>
<td width="99">VFJBTlNG</td>
<td width="369">Upload or download files to the victim machine.</td>
</tr>
<tr>
<td width="99">RVhFQ1VU</td>
<td width="369">Execute command in a new process.</td>
</tr>
</tbody>
</table>
<h3><strong>Scripts</strong></h3>
<p>We created multiple scripts during the course of our research. We are sharing them here to assist other researchers or defenders that encounter this malware.</p>
<p><a href="https://github.com/pan-unit42/public_tools/blob/master/cmstar/extract_cmstar_doc.py">extract_cmstar_doc.py</a>  Script to extract the embedded CMSTAR payload from Word documents.</p>
<p><a href="https://github.com/pan-unit42/public_tools/blob/master/cmstar/extract_cmstar_rtf.py">extract_cmstar_rtf.py</a> Script to extract the embedded CMSTAR payload from RTFs.</p>
<p><a href="https://github.com/pan-unit42/public_tools/blob/master/cmstar/extract_cmstar_strings.py">extract_cmstar_strings.py</a>  Script to identify possible mutex and C2 strings from CMSTAR variants.</p>
<p><a href="https://github.com/pan-unit42/public_tools/blob/master/cmstar/decode_cmstar_payload.py">decode_cmstar_payload.py</a>  Script to decode a payload downloaded by CMSTAR.</p>
<h2><strong>Indicators of Compromise</strong></h2>
<h3><strong>CMSTAR Variants Identified in Phishing Campaign</strong></h3>
<p>65d5ef9aa617e7060779bc217a42372e99d59dc88f8ea2f3b9f45aacf3ba7209</p>
<p>2a0169c72c84e6d3fa49af701fd46ee7aaf1d1d9e107798d93a6ca8df5d25957</p>
<p>4da6ce5921b0dfff9045ada7e775c1755e6ea44eab55da7ccc362f2a70ce26a6</p>
<p>2008ec82cec0b62bdb4d2cea64ff5a159a4327a058dfd867f877536389a72fb6</p>
<p>cecd72851c265f885ff02c60cbc3e6cbf1a40b298274761f623dfa44782a01f8</p>
<p>d8c0f8ecdeceba83396c98370f8f458ea7f7a935aabbcc3d41b80d4e85746357</p>
<p>2c8267192b196bf8a92c8b72d52096e46e307fa4d4dafdc030d3e0f5b4145e9e</p>
<p>2debf12b1cb1291cbd096b24897856948734fa62fd61a1f24d379b4224bda212</p>
<p>79b30634075896084135b9891c42fca8a59db1c0c731e445940671efab9a0b61</p>
<p>b0065fc16ae785834908f024fb3ddd4d9d62b29675859a8e737e3b949e85327a</p>
<p>16697c95db5add6c1c23b2591b9d8eec5ed96074d057b9411f0b57a54af298d5</p>
<p>6843d183b41b6b22976fc8d85e448dcc4d2e0bd2c159e6d966bfd4afa1cd9221</p>
<p>3c3efa89d1dd39e1112558af38ba656e048be842a3bedb7933cdd4210025f791</p>
<p>b2bebb381bc3722304ab1a21a21e082583bf6b88b84e7f65c4fdda48971c20a2</p>
<p>09890dc8898b99647cdc1cceb97e764b6a88d55b5a520c8d0ea3bfd8f75ed83b</p>
<p>fd22973451b88a4d10d9f485baef7f5e7a6f2cb9ce0826953571bd8f5d866c2a</p>
<h3><strong>CMSTAR Download Locations in Phishing Campaign</strong></h3>
<p>http://45.77.60[.]138/YXza9HkKWzqtXlt.dat<br />
http://45.77.60[.]138/mePVDjnAZsYCw5j.dat<br />
http://45.77.60[.]138/UScHrzGWbXb01gv.dat<br />
http://45.76.80[.]32/tYD7jzfVNZqMfye.dat<br />
http://45.77.60[.]138/liW0ecpxEWCfIgU.dat<br />
http://45.77.60[.]138/ezD19AweVIj5NaH.dat<br />
http://45.77.60[.]138/jVJlw3wp379neaJ.dat<br />
http://108.61.175[.]110/tlhXVFeBvT64LC9.dat<br />
http://45.77.60[.]138/HJDBvnJ7wc4S5qZ.dat<br />
http://45.77.60[.]138/JUmoT4Pbw6U2xcj.dat<br />
http://108.61.175[.]110/oiUfxZfej29MAbF.dat<br />
http://45.77.60[.]138/cw1PlY308OpfVeZ.dat<br />
http://45.77.60[.]138/VFdSKlgCAZD7mmp.dat<br />
http://45.77.60[.]138/c2KoCT5OHcVwGi7.dat<br />
http://45.77.60[.]138/3kK24dXFYRgM6Ac.dat<br />
http://45.77.60[.]138/WsEeRyHEhLO1kUm.dat</p>
<h3><strong>PYLOT SHA256</strong></h3>
<p>7e2c9e4acd05bc8ca45263b196e80e919ff60890a872bdc0576735a566369c46</p>
<h3><strong>PYLOT C2</strong></h3>
<p>wait.waisttoomuchmind[.]com</p>
<h3><strong>BYEBY SHA256</strong></h3>
<p>383a2d8f421ad2f243cbc142e9715c78f867a114b037626c2097cb3e070f67d6</p>
<h3><strong>BYEBY C2</strong></h3>
<p>oeiowidfla22[.]com</p>
<h3><strong>CMSTAR.B SHA256</strong></h3>
<p>8609360b43498e296e14237d318c96c58dce3e91b7a1c608cd146496703a7fac</p>
<p>f0f2215457200bb3003eecb277bf7e3888d16edcf132d88203b27966407c7dc3</p>
<p>aecf53a3a52662b441703e56555d06c9d3c61bddf4d3b23d9da02abbe390c609</p>
<p>960a17797738dc0bc5623c74b6f8a5d74375f6d18d20ba18775f26a43898bae6</p>
<p>e37c045418259ecdc07874b85e7b688ba53f5a7dc989db19d7e8c440300bd574</p>
<p>75ea6e8dfaf56fb35f35cb043bd77aef9e2c7d46f3e2a0454dff0952a09c134f</p>
<p>a65e01412610e5ed8fde12cb78e6265a18ef78d2fd3c8c14ed8a3d1cef17c91d</p>
<p>7170b104367530ae837daed466035a8be719fdb17423fc01da9c0ded74ca6ad1</p>
<p>13acddf9b7c2daafd815cbfa75fbb778a7074a6f90277e858040275ae61a252b</p>
<p>625ed818a25c63d8b2c264d0f5bd96ba5ad1c702702d8ffaa4e0e93e5f411fac</p>
<p>a56cd758608034c90e81e4d4f1fe383982247d6aeffd74a1dd98d84e9b56afdf</p>
<p>a4b969b93f7882ed2d15fd10970c4720961e42f3ae3fced501c0a1ffa3896ff5</p>
<p>e833bbb79ca8ea1dbeb408520b97fb5a1b691d5a5f9c4f9deabecb3787b47f73</p>
<p>8e9136d6dc7419469c959241bc8745af7ba51c7b02a12d04fec0bc4d3f7dcdf0</p>
<h3><strong>CMSTAR.B Download Locations</strong></h3>
<p>http://108.61.175[.]110/tlhXVFeBvT64LC9.dat<br />
http://104.238.188[.]211/gl7xljvn3fqGt3u.dat<br />
http://45.77.60[.]138/c2KoCT5OHcVwGi7.dat<br />
http://108.61.175[.]110/gkMmqVvZ7gGGxpY.dat<br />
http://108.61.175[.]110/z_gaDZyeZXvScQ6.dat<br />
http://108.61.175[.]110/bDtzGVtqgiJU9PI.dat<br />
http://45.77.60[.]138/liW0ecpxEWCfIgU.dat<br />
http://45.77.60[.]138/JUmoT4Pbw6U2xcj.dat<br />
http://108.61.175[.]110/oiUfxZfej29MAbF.dat<br />
http://108.61.103[.]123/jvZfZ0gdTWtr46y.dat<br />
http://108.61.103[.]123/06JcD5jz5dSHVAy.dat<br />
http://108.61.103[.]123/nj3dsMMpyQQDBF3.dat<br />
http://108.61.103[.]123/fHZvWtBGlFvs2Nr.dat<br />
http://45.77.60[.]138/w57E8dktKb9UQyV.dat</p>
<h3><strong>CMSTAR.C SHA256</strong></h3>
<p>85e06a2beaa4469f13ca58d5d09fec672d3d8962a7adad3c3cb74f3f9ef1fed4</p>
<p>b8ef93227b59e6c8d3a1494b4860d15be819fae17b57fd56bfff9a51b7972ff0</p>
<p>9e6fdbbc2371ac8bc6db3b878475ed0b0af8950d50a4652df688e778beb87397</p>
<p>4e38e627ae21f1a85aa963ca990a66cf75789b450605fdca2f31ee6f0f8ab8f2</p>
<p>f4ff0ca7f2ea2a011a2a4615d9b488b7806ff5dd61577a9e3a9860f2980e7fc0</p>
<p>8de3fa2614b1767cfd12936c5adf4423ef25ea60800fa170752266e0ca063274</p>
<p>38197abde967326568e101b65203c2efa75500e5f3c084b6dd08fd1ba1430726</p>
<p>726df91a395827d11dc433854b3f19b3e28eac4feff329e0bdad93890b03af84</p>
<p>5703565ec64d72eb693b9fafcba5951e937c8ee38829948e9518b7d226f81c10</p>
<p>d0544a3e6d1b34b8b4e976c7fc62d4500f28f617e2f549d9a3e590b71b1f9cc5</p>
<p>2a8e5551b9905e907da7268aba50fcbc526cfd0549ff2e352f9f4d1d71bf32a7</p>
<p>d7cd6f367a84f6d5cf5ffb3c2537dd3f48297bd45a8f5a4c50190f683b7c9e90</p>
<p>8f7294072a470b886791a7a32eedf0f0505aaecec154626c6334d986957086e4</p>
<p>6419255d017b217fe984d3439694eb96806d06c7ea41a422298650969028c08c</p>
<h3><strong>CMSTAR.C Download Locations</strong></h3>
<p>http://45.77.58[.]49/54xfapkezW64xDE.dat<br />
http://45.77.58[.]49/54xfapkezW64xDE.dat<br />
http://45.77.62[.]181/naIXl13kqeV7Y2j.dat<br />
http://45.77.58[.]160/9EkCWYA3OtDbz1l.dat<br />
http://45.77.58[.]160/8h5NPYB5fAn301E.dat<br />
http://45.77.58[.]160/9EkCWYA3OtDbz1l.dat<br />
http://45.77.60[.]138/3kK24dXFYRgM6Ac.dat<br />
http://45.77.60[.]138/ezD19AweVIj5NaH.dat<br />
http://45.77.60[.]138/VFdSKlgCAZD7mmp.dat<br />
http://45.77.60[.]138/HJDBvnJ7wc4S5qZ.dat<br />
http://45.77.60[.]138/jVJlw3wp379neaJ.dat<br />
http://45.77.60[.]138/YXza9HkKWzqtXlt.dat<br />
http://45.77.60[.]138/UScHrzGWbXb01gv.dat<br />
http://45.77.60[.]138/WsEeRyHEhLO1kUm.dat</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
