
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>New KONNI Malware attacking Eurasia and Southeast Asia</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-new-konni-malware-attacking-eurasia-southeast-asia/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-new-konni-malware-attacking-eurasia-southeast-asia/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-new-konni-malware-attacking-eurasia-southeast-asia/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="New KONNI Malware attacking Eurasia and Southeast Asia" />
<meta property="og:description" content="Unit 42 uncovers NOKKI, a type of malware with ties to the previously discovered KONNI malware family, used to attack Eurasia and Southeast Asia." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-new-konni-malware-attacking-eurasia-southeast-asia/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="KONNI" />
<meta property="article:tag" content="NOKKI" />
<meta property="article:tag" content="Targeted" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2018-09-27T05:00:04+00:00" />
<meta property="article:modified_time" content="2018-11-02T11:25:45+00:00" />
<meta property="og:updated_time" content="2018-11-02T11:25:45+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:width" content="600" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 uncovers NOKKI, a type of malware with ties to the previously discovered KONNI malware family, used to attack Eurasia and Southeast Asia." />
<meta name="twitter:title" content="New KONNI Malware attacking Eurasia and Southeast Asia" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; New KONNI Malware attacking Eurasia and Southeast Asia Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-new-konni-malware-attacking-eurasia-southeast-asia/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="15,821"/>
<meta property="og:date_created" content="September 27, 2018 at 8:00 AM"/>
<meta property="og:post_length" content="3341"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:author" content="Bryan Lee"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/joshgruznweig/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bryanlee/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"New KONNI Malware attacking Eurasia and Southeast Asia","name":"New KONNI Malware attacking Eurasia and Southeast Asia","description":"Unit 42 uncovers NOKKI, a type of malware with ties to the previously discovered KONNI malware family, used to attack Eurasia and Southeast Asia.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-new-konni-malware-attacking-eurasia-southeast-asia\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-new-konni-malware-attacking-eurasia-southeast-asia\/","datePublished":"September 27, 2018","articleBody":"Introduction\r\n\r\nBeginning in early 2018, Unit 42 observed a series of attacks using a previously unreported malware family, which we have named \u2018NOKKI\u2019. The malware in question has ties to a previously reported malware family named KONNI, however, after careful consideration, we believe enough differences are present to introduce a different malware family name. To reflect the close relationship with KONNI, we chose NOKKI, swapping KONNI\u2019s Ns and Ks.\r\n\r\nBecause of code overlap found within both malware families, as well as infrastructure overlap, we believe the threat actors responsible for KONNI are very likely also responsible for NOKKI. Previous reports stated it was likely KONNI had been in use for over three years in multiple campaigns with a heavy interest in the Korean peninsula and surrounding areas. As of this writing, it is not certain if the KONNI or NOKKI operators are related to known adversary groups operating in the regions of interest, although there is evidence of a tenuous relationship with a group known as Reaper.\r\n\r\nThe latest activity leveraging the NOKKI payload likely targets politically-motivated victims in Eurasia and possibly Southeast Asia. These attacks leverage compromised legitimate infrastructure for both delivery and command and control (C2). These compromised servers are largely located within South Korea. In total, we observed two waves of attacks spanning from early 2018 to at least July 2018 which we were able to cluster via the specific network protocol used for C2. In addition, the decoy documents themselves wer both created and last modified by an author named zeus. The zeus username is a recurring artifact witnessed in all of the discussed attacks in this report.\r\n\r\n&nbsp;\r\n\r\nJanuary 2018 Attack\r\n\r\nThe earliest observed attack delivering NOKKI took place in January 2018. This attack leverages a Microsoft Windows executable file using a PDF icon in an attempt to trick the victim into launching the file. The malware sample contains the properties seen in Table 1:\r\n\r\n\r\n\r\nMD5\r\n48f031f8120554a5f47259666fd0ee02\r\n\r\n\r\nSHA1\r\n02ee6302436250e1cee1e75cf452a127b397be8d\r\n\r\n\r\nSHA256\r\nb8120d5c9c2c889b37aa9e37514a3b4964c6e41296be216b327cdccd2e908311\r\n\r\n\r\nFile Type\r\nPE32 executable (GUI) Intel 80386, for MS Windows\r\n\r\n\r\nPDB String\r\nC:\\Users\\zeus\\Documents\\Visual Studio 2010\\Projects\\virus-dropper\\Release\\virus-dropper.pdb\r\n\r\n\r\nCompile Timestamp\r\n2018-01-26 00:14:31 UTC\r\n\r\n\r\nFirst Encountered\r\n2018-01-26 03:10:12 UTC\r\n\r\n\r\n\r\nTable 1 January NOKKI properties\r\nThe malware is capable of collecting information on the victim machine, dropping, and executing a payload, as well as dropping and opening a decoy document.\r\n\r\nThe malware will collect data from the victim machine and write this information to LOCALAPPDATA%\\MicroSoft Updatea\\uplog.tmp. The following information is collected from the victim:\r\n\r\n \tIP Address\r\n \tHostname\r\n \tUsername\r\n \tDrive Information\r\n \tOperating System Information\r\n \tInstalled Programs\r\n\r\nThis specific function shares significant code overlap with the KONNI tool first discovered by Talos.\r\n\r\nThe NOKKI payload is written to %LOCALAPPDATA%\\MicroSoft Updatea\\svServiceUpdate.exe prior being executed in a new process. Persistence is achieved by writing the file path to the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svstartup registry key.\r\n\r\nAfter being executed and establishing persistence, NOKKI then connects to \u00a0101.129.1[.]104 for C2 communication via FTP. This IP does not have a domain name resolution; however, WHOis shows the IP assigned to China Central Television.\r\n\r\nThe decoy document is written to the same file path as the initial dropper, however, the extension is renamed to .pdf and becomes a legitimate document.\r\n\r\nBased on the decoy document contents and language, the attack may target\r\n\r\nCambodian speakers with an interest in Cambodian political matters.\r\n\r\nFigure 1 shows the decoy document used for this sample:\r\n\r\n\r\nFigure 1 Decoy document for b8120d5c9c2c889b37aa9e37514a3b4964c6e41296be216b327cdccd2e908311\r\nApril 2018 Attack\r\n\r\nIn early April 2018, another attack was observed delivering the NOKKI payload. This attack leveraged a malicious executable with an .scr extension that had the original filename referring to the Russian Ministry of Foreign Affairs and its contents can be found online.\r\n\r\nThe file contains the properties as seen in Table 2:\r\n\r\n\r\n\r\nMD5\r\n42fbea771f3e0ff04ac0a1d09db2a45e\r\n\r\n\r\nSHA1\r\n2b6b6f24f58072a02f03fa04deaccce04b6bb43b\r\n\r\n\r\nSHA256\r\n9bf634ff0bc7c69ffceb75f9773c198944d907ba822c02c44c83e997b88eeabd\r\n\r\n\r\nFile Type\r\nPE32 executable (GUI) Intel 80386, for MS Windows\r\n\r\n\r\nPDB String\r\nC:\\Users\\zeus\\Documents\\Visual Studio 2010\\Projects\\virus-dropper\\Release\\virus-dropper.pdb\r\n\r\n\r\nCompile Timestamp\r\n2018-04-04 21:06:26 UTC\r\n\r\n\r\nFirst Encountered\r\n2018-04-04 12:55:38 UTC\r\n\r\n\r\n\r\nTable 2 April NOKKI Properties\r\nThis sample contained the same PDB string within it as sample from January 2018. Functionally, it was nearly identical in its behavior as the previous attack.\r\n\r\nUnlike the previously witnessed attack that possibly targeted Cambodian language speakers with an interest in Cambodian political matters, the decoy document used in this attack is written Cyrillic and contains content related to Russian political matters.\r\n\r\nOnce the .scr file is executed, the NOKKI payload is installed onto the victim host which then connects to the IP resolving to a likely compromised but legitimate South Korean science and technology university website.\r\n\r\n\r\nFigure 2 Decoy document for 9bf634ff0bc7c69ffceb75f9773c198944d907ba822c02c44c83e997b88eeabd\r\nThe content of the decoy document in Figure 2 is a publicly available. Google Translate roughly translates to the following:\r\n\r\nAbout the meeting of the State Secretary - Deputy Minister of Foreign Affairs of Russia GB Karasin and the Director of the Institute of Strategic and Interregional Studies under the President of Uzbekistan, VI Norov\r\n\r\nA second sample was discovered in April 2018, also written Cyrillic and containing content related to Russian political matters. This file had the following properties as seen in Table 3:\r\n\r\n\r\n\r\nMD5\r\n88587c43daff30cd3cc0c913a390e9df\r\n\r\n\r\nSHA1\r\n1cc8ceeef9a2ea4260fae03368a9d07d56e8331b\r\n\r\n\r\nSHA256\r\n07b90088ec02ef6757f6590a62e2a038ce769914139aff1a26b50399a31dcde9\r\n\r\n\r\nFile Type\r\nPE32 executable (GUI) Intel 80386, for MS Windows\r\n\r\n\r\nPDB String\r\nC:\\Users\\zeus\\Documents\\Visual Studio 2010\\Projects\\virus-dropper\\Release\\virus-dropper.pdb\r\n\r\n\r\nCompile Timestamp\r\n2018-04-24 16:42:03 UTC\r\n\r\n\r\nFirst Encountered\r\n\u00a02018-04-24 06:34:35 UTC\r\n\r\n&nbsp;\r\n\r\n\r\n\r\nTable 3 Second April NOKKI Properties\r\nAgain, we see consistency both in the embedded PDB string, as well as the functionality of the sample itself. This particular sample connects to an IP address to which a likely legitimate but compromised website of a research institute in South Korea resolves. This server has also likely been compromised and repurposed by the adversary.\r\n\r\n&nbsp;\r\n\r\nMay 2018 Attack\r\n\r\nIn May 2018, Unit 42 observed an attack using malware with a filename of briefinglist.exe being downloaded from the somewhat redacted following URL. Again, it is a likely compromised but legitimate South Korean website and the contents written Cyrillic and containing content related to Russian political matters.\r\n\r\nhttp:\/\/mail.[removed].co[.]kr\/de\/de_includes\/mail\/yandex.ru\/download.php\r\n\r\nThis sample has the following properties as seen in Table 4:\r\n\r\n\r\n\r\nMD5\r\nae27e617f4197cd30cc09fe784453cd4\r\n\r\n\r\nSHA1\r\ndc739ca07585eab7394843bc4dba2faca8e5bfe0\r\n\r\n\r\nSHA256\r\n9b1a21d352ededd057ee3a965907126dd11d13474028a429d91e2349b1f00e10\r\n\r\n\r\nFile Type\r\nPE32 executable (GUI) Intel 80386, for MS Windows\r\n\r\n\r\nPDB String\r\nC:\\Users\\zeus\\Documents\\Visual Studio 2010\\Projects\\virus-dropper\\Release\\virus-dropper.pdb\r\n\r\n\r\nCompile Timestamp\r\n2018-04-30 17:48:08 UTC\r\n\r\n\r\n\r\nTable 4. Third May NOKKI Properties\r\nThis sample remains consistent with previous samples of NOKKI in terms of functionality and the embedded PDB string.\r\n\r\nThe payload communicates with 145.14.145[.]32, which resolves to files.000webhost[.]com. This same host was witnessed in previously reported KONNI malware activity.\r\n\r\n&nbsp;\r\n\r\nJuly 2018 Attack\r\n\r\nIn July 2018, a South Korean engineering organization was identified as compromised and hosting malware and C2 infrastructure on their webserver since at least May 2018. Again, a file in Cyrillic with a name referring to the Russian\u00a0political matters was being distributed from the http:\/\/mail.[removed].co[.]kr\/common URL.\r\n\r\nUnlike attacks leading up to this point, an executable file was not used as the initial malware file. Instead, this attack used a Microsoft Word document leveraging malicious macros to deliver the payload to the victim. Upon opening the file and enabling macros, the document downloaded both the payload and displayed a decoy document referencing political matters.\r\n\r\n&nbsp;\r\n\r\nNOKKI Malware Family\r\n\r\nFrom the samples discussed in this blog, we were able to identify two distinct variants of NOKKI. The earlier variant witnessed in attacks between January 2018 to May 2018 made use of FTP for C2 communications. Alternatively, the newer variant witnessed since June 2018 made use of HTTP. While both variants used different network protocols for communication, they both used the same file path structure on the remote C2 server.\r\n\r\nThe older variant begins by looking for the presence of the following file:\r\n\r\n%TEMP%\\ID56SD.tmp\r\n\r\nIf this file does not exist, the malware will generate a random string of 10 upper-case alphabetic characters. This string will ultimately be used as the victim\u2019s identifier. It will also create the %TEMP%\\stass file and write the value of a to it.\r\n\r\nThe malware continues to spawn a new thread that is responsible for network communication. Within an infinite loop, this malware will continue connecting to its C2 server via FTP.\r\n\r\nAfter successful connection to the C2, it will write the previously written stass file to the server\u2019s public_html folder. It will also upload the previously created uplog.tmp file to the remote server. After the upload is completed, NOKKI will then delete the local copy on the infected host. Finally, NOKKI will check for the presence of the [id]-down file on the C2 server, where [id] is the 10 character alphabetic string created prior. Should this file exist, it will be downloaded and written to %TEMP%\\svchostav.exe prior to being executed in a new process. After it is executed, the malware deletes the file on the C2 server. The malware will then sleep for 15 minutes between loops.\r\n\r\nThe newer variant operates in a slightly different manner.\r\n\r\nIn this case, NOKKI begins by extracting and dropping an embedded DLL to the\u00a0 %LOCALAPPDATA%\\MicroSoft UpdateServices\\Services.dll path. One of two DLLs may be dropped, either a 32-bit or a 64-bit compiled options. The appropriate DLL will be dropped based on the victim host\u2019s CPU architecture.\r\n\r\nWhile these DLLs are different architectures, they perform the same functions. After the DLL is written, the malware loads it via the following command-line:\r\n\r\nrundll32.exe [%LOCALAPPDATA%\\MicroSoft UpdateServices\\Services.dll] install\r\n\r\nFinally, the malware will write the following registry key to ensure persistence on the victim host:\r\n\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\qivService - C:\\\\Windows\\\\System32\\\\rundll32.exe \"[%LOCALAPPDATA%\\MicroSoft UpdateServices\\Services.dll]\"\u00a0 install\r\n\r\nThe payload\u2019s install function makes a call to SetWindowsHookEx with a thread ID of 0, resulting in the function being injected into every GUI process running on the victim machine. This particular process is referenced in this forum post.\r\n\r\nThe DllMain function of this payload begins by comparing the process executable name, seeking out the explorer.exe process. In the event it is not loaded in the context of this process, nothing occurs. If the malware is running within explorer.exe, it will load its own HTTPStart exported function, which performs the malicious actions.\r\n\r\nIt begins by writing the ID56SD.tmp file in its current working directory (CWD). A unique randomly chosen 10-byte alphabetic string is written to this file, which will be used as an identifier for the victim. A file named stass is also written in the CWD, with a single byte of a.\r\n\r\nThe payload proceeds to enter an infinite loop, with a 15 minute delay between iterations. The loop begins by reading in the previously written stass file and uploading it to its embedded C2 server via HTTP.\r\n\r\nThe data is encoded with base64 and uploaded via a POST parameter of data. Additionally, the victim\u2019s identifier and the current timestamp is uploaded via a POST parameter of subject.\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 3 HTTP request made by NOKKI payload\r\nAfter this upload request is made, the malware looks for the presence of a file named uplog.tmp. In the event this file exists, it is uploaded via the same method as previously noted. After this file is uploaded via HTTP, the local file is deleted. While this file is not present originally in this malware sample, in other NOKKI variants, it has been observed containing the victim\u2019s system information.\r\n\r\nThe malware then looks for the presence of the upfile.tmp file. Again, if this file exists, it is uploaded to the remote server and the local file is deleted.\r\n\r\nFinally, the malware will look for the presence of the following remote files, where [id] is the victim identifier:\r\n\r\n \thttp:\/\/mail.[removed].co[.]kr\/.\/pds\/down\r\n \thttp:\/\/mail.[removed].co[.]kr\/.\/pds\/data\/[id]-down\r\n\r\nIf the down file is available, it is written to %TEMP%\\wirbiry2jsq3454.exe and executed. If the [id]-down file is available, it is written to %TEMP%\\weewyesqsf4.exe and executed.\r\n\r\nDuring execution, a remote module was downloaded from the down URL:\r\n\r\nThis module is responsible for collecting the following information and writing it to the %LOCALAPPDATA%\\MicroSoft UpdateServices\\uplog.tmp file:\r\n\r\n \tIP Address\r\n \tHostname\r\n \tUsername\r\n \tDrive Information\r\n \tOperating System Information\r\n \tInstalled Programs\r\n\r\nThis module acted in an identical way as the information collection function witnessed in the older variant of NOKKI.\r\n\r\n&nbsp;\r\n\r\nComparison to KONNI\r\n\r\nThe NOKKI malware family differs from KONNI in a number of ways. Unlike KONNI, NOKKI is modular in nature, with multiple steps taken between the initial infection and the final payload(s) being delivered. Early versions of NOKKI observed between January 2018 to May 2018 used a remote FTP server to ultimately accept commands and download additional modules. While newer versions of NOKKI starting in June 2018 use HTTP, the communication is quite different from the previously reported KONNI malware, both in the URI structure and data being sent. In addition, while the KONNI samples used C2 infrastructure set up specifically by the adversary, NOKKI mostly leveraged what appeared to be likely compromised legitimate servers for their infrastructure.\r\n\r\n&nbsp;\r\n\r\n\r\n\r\nNOKKI URIs\r\nPreviously Reported KONNI URIs\r\n\r\n\r\n\/.\/pds\/data\/upload.php\r\n\/login.php\r\n\r\n\r\n\/.\/pds\/data\/[victim_id]-down\r\n\/upload.php\r\n\r\n\r\n\/.\/pds\/down\r\n\/download.php\r\n\r\n\r\n\/common\/exe\r\n\/weget\/uploadtm.php\r\n\r\n\r\n\/common\/doc\r\n\/weget\/upload.php\r\n\r\n\r\n\r\nTable 5. URI differences between NOKKI and KONNI\r\nWhile we consider these malware families to be separate, we identified some similarities with KONNI. In addition to overlapping infrastructure between KONNI and NOKKI, a NOKKI module used to collect victim information was observed exhibiting very similar characteristics to the KONNI victim information collection function as seen in Figure 4. This same function was also observed in early instances of the dropper used to deploy NOKKI between January 2018 and May 2018.\r\n\r\nFigure 4 Similarities between KONNI malware family and NOKKI module\r\nBased on the similarities witnessed, we think it is highly probable there is some amount of code sharing and likely a single adversary group involved.\r\nConclusion\r\n\r\nThe adversary operating the NOKKI malware family appears to have begun using NOKKI in January 2018 and has continued their activity through 2018. At this time, we can only speculate who these series of attacks may be attributed to based on tenuous relationships. However, there is significant evidence from our attack telemetry and victimology indicating the operator has a strong interest in specific regions of the world such as Eurasia, the Korean Peninsula, and Southeast Asia. The general tactics used to deliver NOKKI are similar in nature to the actors behind a previously identified malware, KONNI. Additionally, there are overlaps both in code and some infrastructure with previously reported KONNI activity. Unlike KONNI, however, this particular malware family makes use of compromised servers for both hosting and C2 operations.\r\n\r\nThe NOKKI malware itself has been updated in the short period of time it has been observed, moving from FTP to HTTP for C2 operations. The malware is modular in nature, and based on analysis of the information gathering module, it is highly likely the NOKKI operators are the same as the KONNI operators. Unit 42 will continue to monitor this malware family and the threat actor responsible.\r\n\r\nPalo Alto Networks customers are protected by the following:\r\n\r\n \tAll known samples of NOKKI maintain a malware verdict in WildFire\r\n \tAutoFocus customers may learn more via the NOKKI tag\r\n\r\n&nbsp;\r\n\r\nAppendix\r\n\r\nIndicators of Compromise\r\n\r\n&nbsp;\r\n\r\nJuly 2018 Attack\r\n\r\n\r\n\r\nIndicator Type\r\nIndicator\r\n\r\n\r\nHash\r\nd92c94423ec3d01ad584a74a38a2e817449648a4da3f12d345c611edc5c4cdbd\r\n\r\n\r\nHash\r\ndce53e59b0c48e269dadc766a78667a14f11b72c49f57d95abde62c84ac8d7ae\r\n\r\n\r\nHash\r\n0657f788e89a437a1e6fe2630c19436736aa55dcf255540698864a7576192611\r\n\r\n\r\nHash\r\nd211815177ce4b9fd2d3c258d2fc6282c23b8458d71f8f6f0df06a9dda89c12f\r\n\r\n\r\nProcess\r\nrundll32.exe [%LOCALAPPDATA%\\MicroSoft UpdateServices\\Services.dll] install\r\n\r\n\r\nRegistry Key\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\qivService\r\n\r\n\r\nFile\r\nID56SD.tmp\r\n\r\n\r\nFile\r\nstass\r\n\r\n\r\nFile\r\n%LOCALAPPDATA%\\MicroSoft UpdateServices\\uplog.tmp\r\n\r\n\r\nFile\r\n%TEMP%\\wirbiry2jsq3454.exe\r\n\r\n\r\nFile\r\n%TEMP%\\weewyesqsf4.exe\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/.\/pds\/data\/upload.php\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/.\/pds\/down\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/.\/pds\/data\/[id]-down\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/common\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/common\/exe\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/common\/doc\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nJune 2018 Attack\r\n\r\n\r\n\r\nIndicator Type\r\nIndicator\r\n\r\n\r\nHash\r\n5137f6a59c2c7a54f1a5fc9a9650972b17d52dd0e203f5abefedf5c593c41ff0\r\n\r\n\r\nHash\r\nfd673703c502be907919a4ff2922b7b969d96d206abc572a5cb83e69ab32ca18\r\n\r\n\r\nHash\r\n4e84f97bb61c2d373a574676fa374131460839ecc7b53064f558ce7ce55528ad\r\n\r\n\r\nHash\r\nfd673703c502be907919a4ff2922b7b969d96d206abc572a5cb83e69ab32ca18\r\n\r\n\r\nHash\r\n74ddd56b1e33aa3752f143a77e5802a5803fd2c222f2cca77bfa5c740dfc8f5e\r\n\r\n\r\nProcess\r\nrundll32.exe [%LOCALAPPDATA%\\MicroSoft UpdateServices\\Services.dll] install\r\n\r\n\r\nRegistry Key\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\qivService\r\n\r\n\r\nFile\r\nID56SD.tmp\r\n\r\n\r\nFile\r\nstass\r\n\r\n\r\nFile\r\nuplog.tmp\r\n\r\n\r\nFile\r\n%TEMP%\\wirbiry2jsq3454.exe\r\n\r\n\r\nFile\r\n%TEMP%\\weewyesqsf4.exe\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/.\/pds\/data\/upload.php\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/.\/pds\/down\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/.\/pds\/data\/[id]-down\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/common\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nMay 2018 Attack\r\n\r\n\r\n\r\nIndicator Type\r\nIndicator\r\n\r\n\r\nHash\r\n9b1a21d352ededd057ee3a965907126dd11d13474028a429d91e2349b1f00e10\r\n\r\n\r\nHash\r\nc3172b403068aabc711b7cbe4d923ae1fa705ce11c4cc71271fde83ce751c21c\r\n\r\n\r\nFolder\r\n%LOCALAPPDATA\\MicroSoft Update1\r\n\r\n\r\nFile\r\n%LOCALAPPDATA\\MicroSoft Update1\\svServiceUpdate.exe\r\n\r\n\r\nFile\r\n%TEMP%\\uplog.tmp\r\n\r\n\r\nFile\r\n%STARTUP%\\Antdule.lnk\r\n\r\n\r\nFile\r\n%TEMP%\\ID56SD.tmp\r\n\r\n\r\nFile\r\n%TEMP%\\svchostav.exe\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/de\/de_includes\/mail\/yandex.ru\/download.php\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nApril 2018 Attack\r\n\r\n\r\n\r\nIndicator Type\r\nIndicator\r\n\r\n\r\nHash\r\n07b90088ec02ef6757f6590a62e2a038ce769914139aff1a26b50399a31dcde9\r\n\r\n\r\nHash\r\nd5fc0ef2d1ed037b5b6389882f9bb4ea15a6b41f21cdc0f5e90752f4e687445c\r\n\r\n\r\nFolder\r\n%LOCALAPPDATA\\MicroSoft Update1\r\n\r\n\r\nFile\r\n%LOCALAPPDATA\\MicroSoft Update1\\svServiceUpdate.exe\r\n\r\n\r\nFile\r\n%TEMP%\\uplog.tmp\r\n\r\n\r\nFile\r\n%STARTUP%\\Antdule.lnk\r\n\r\n\r\nFile\r\n%TEMP%\\ID56SD.tmp\r\n\r\n\r\nFile\r\n%TEMP%\\svchostav.exe\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/de\/de_includes\/mail\/yandex.ru\/download.php\r\n\r\n\r\nIP Address\r\n210.112.239[.]74\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nEarly April 2018 Attack\r\n\r\n\r\n\r\nIndicator Type\r\nIndicator\r\n\r\n\r\nHash\r\n9bf634ff0bc7c69ffceb75f9773c198944d907ba822c02c44c83e997b88eeabd\r\n\r\n\r\nHash\r\nc07bea0928a35b9292eebab32563378d01d95434d098e5c7c076e94866a14212\r\n\r\n\r\nFolder\r\n%LOCALAPPDATA\\MicroSoft Update1\r\n\r\n\r\nFile\r\n%LOCALAPPDATA\\MicroSoft Update1\\svServiceUpdate.exe\r\n\r\n\r\nFile\r\n%TEMP%\\uplog.tmp\r\n\r\n\r\nFile\r\n%STARTUP%\\Antdule.lnk\r\n\r\n\r\nFile\r\n%TEMP%\\ID56SD.tmp\r\n\r\n\r\nFile\r\n%TEMP%\\svchostav.exe\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/de\/de_includes\/mail\/yandex.ru\/download.php\r\n\r\n\r\nIP Address\r\n141.223.125[.]112\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nJanuary 2018 Attack\r\n\r\n\r\n\r\nIndicator Type\r\nIndicator\r\n\r\n\r\nHash\r\nb8120d5c9c2c889b37aa9e37514a3b4964c6e41296be216b327cdccd2e908311\r\n\r\n\r\nHash\r\n0d98ca35b29d2a9f7ca6908747c457ebdba999f0e83e182f770848e2335ade5b\r\n\r\n\r\nFolder\r\n%LOCALAPPDATA\\MicroSoft Update1\r\n\r\n\r\nFile\r\n%LOCALAPPDATA\\MicroSoft Update1\\svServiceUpdate.exe\r\n\r\n\r\nFile\r\n%TEMP%\\uplog.tmp\r\n\r\n\r\nFile\r\n%STARTUP%\\Antdule.lnk\r\n\r\n\r\nFile\r\n%TEMP%\\ID56SD.tmp\r\n\r\n\r\nFile\r\n%TEMP%\\svchostav.exe\r\n\r\n\r\nURL\r\nhxxp:\/\/mail.[removed].co[.]kr\/de\/de_includes\/mail\/yandex.ru\/download.php\r\n\r\n\r\nIP Address\r\n101.129.1[.]104\r\n\r\n\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2018\/04\/unit42-blog-600x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Josh Grunzweig"},{"@type":"Person","name":"Bryan Lee"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"91782","token":"b09d8c8c9d","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=91782' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-konni-malware-attacking-eurasia-southeast-asia%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-konni-malware-attacking-eurasia-southeast-asia%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-91782 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">New KONNI Malware attacking Eurasia and Southeast Asia</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-91782 entry-meta">
			
			
			<span class="post-views-count">15,821</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'91782','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-konni-malware-attacking-eurasia-southeast-asia%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-konni-malware-attacking-eurasia-southeast-asia%2F+-+New+KONNI+Malware+attacking+Eurasia+and+Southeast+Asia" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-konni-malware-attacking-eurasia-southeast-asia%2F&title=New+KONNI+Malware+attacking+Eurasia+and+Southeast+Asia&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-new-konni-malware-attacking-eurasia-southeast-asia/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/joshgruznweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a> and <a href="https://unit42.paloaltonetworks.com/author/bryanlee/" title="Posts by Bryan Lee" class="author url fn" rel="author">Bryan Lee</a>        </p>
        <p><time datetime="2018-09-27T05:00:04+00:00">September 27, 2018 at 8:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/konni/" rel="tag">KONNI</a>, <a href="https://unit42.paloaltonetworks.com/tag/nokki/" rel="tag">NOKKI</a>, <a href="https://unit42.paloaltonetworks.com/tag/targeted/" rel="tag">Targeted</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="600" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg 600w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-300x150.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-370x185.jpg 370w" sizes="(max-width: 600px) 100vw, 600px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-new-konni-malware-attacking-eurasia-southeast-asia/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja"></span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><span style="font-size: 18pt;">Introduction</span></p>
<p>Beginning in early 2018, Unit 42 observed a series of attacks using a previously unreported malware family, which we have named NOKKI. The malware in question has ties to a <a href="https://blog.talosintelligence.com/2017/05/konni-malware-under-radar-for-years.html">previously</a> <a href="https://www.fortinet.com/blog/threat-research/a-quick-look-at-a-new-konni-rat-variant.html">reported</a> malware family named KONNI, however, after careful consideration, we believe enough differences are present to introduce a different malware family name. To reflect the close relationship with KONNI, we chose NOKKI, swapping KONNIs Ns and Ks.</p>
<p>Because of code overlap found within both malware families, as well as infrastructure overlap, we believe the threat actors responsible for KONNI are very likely also responsible for NOKKI. Previous reports stated it was likely KONNI had been in use for over three years in multiple campaigns with a heavy interest in the Korean peninsula and surrounding areas. As of this writing, it is not certain if the KONNI or NOKKI operators are related to known adversary groups operating in the regions of interest, although there is evidence of a tenuous relationship with a group known as Reaper.</p>
<p>The latest activity leveraging the NOKKI payload likely targets politically-motivated victims in Eurasia and possibly Southeast Asia. These attacks leverage compromised legitimate infrastructure for both delivery and command and control (C2). These compromised servers are largely located within South Korea. In total, we observed two waves of attacks spanning from early 2018 to at least July 2018 which we were able to cluster via the specific network protocol used for C2. In addition, the decoy documents themselves wer both created and last modified by an author named zeus. The zeus username is a recurring artifact witnessed in all of the discussed attacks in this report.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">January 2018 Attack</span></p>
<p>The earliest observed attack delivering NOKKI took place in January 2018. This attack leverages a Microsoft Windows executable file using a PDF icon in an attempt to trick the victim into launching the file. The malware sample contains the properties seen in Table 1:</p>
<table align="center">
<tbody>
<tr>
<td width="192"><strong>MD5</strong></td>
<td width="144">48f031f8120554a5f47259666fd0ee02</td>
</tr>
<tr>
<td width="192"><strong>SHA1</strong></td>
<td width="144">02ee6302436250e1cee1e75cf452a127b397be8d</td>
</tr>
<tr>
<td width="192"><strong>SHA256</strong></td>
<td width="144">b8120d5c9c2c889b37aa9e37514a3b4964c6e41296be216b327cdccd2e908311</td>
</tr>
<tr>
<td width="192"><strong>File Type</strong></td>
<td width="144">PE32 executable (GUI) Intel 80386, for MS Windows</td>
</tr>
<tr>
<td width="192"><strong>PDB String</strong></td>
<td width="144">C:\Users\zeus\Documents\Visual Studio 2010\Projects\virus-dropper\Release\virus-dropper.pdb</td>
</tr>
<tr>
<td width="192"><strong>Compile Timestamp</strong></td>
<td width="144">2018-01-26 00:14:31 UTC</td>
</tr>
<tr>
<td width="192"><strong>First Encountered</strong></td>
<td width="144">2018-01-26 03:10:12 UTC</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Table 1 January NOKKI properties</em></p>
<p>The malware is capable of collecting information on the victim machine, dropping, and executing a payload, as well as dropping and opening a decoy document.</p>
<p>The malware will collect data from the victim machine and write this information to LOCALAPPDATA%\MicroSoft Updatea\uplog.tmp. The following information is collected from the victim:</p>
<ul>
<li>IP Address</li>
<li>Hostname</li>
<li>Username</li>
<li>Drive Information</li>
<li>Operating System Information</li>
<li>Installed Programs</li>
</ul>
<p>This specific function shares significant code overlap with the KONNI tool first discovered by <a href="https://blog.talosintelligence.com/2017/05/konni-malware-under-radar-for-years.html">Talos</a>.</p>
<p>The NOKKI payload is written to %LOCALAPPDATA%\MicroSoft Updatea\svServiceUpdate.exe prior being executed in a new process. Persistence is achieved by writing the file path to the HKCU\Software\Microsoft\Windows\CurrentVersion\Run\svstartup registry key.</p>
<p>After being executed and establishing persistence, NOKKI then connects to 101.129.1[.]104 for C2 communication via FTP. This IP does not have a domain name resolution; however, WHOis shows the IP assigned to China Central Television.</p>
<p>The decoy document is written to the same file path as the initial dropper, however, the extension is renamed to .pdf and becomes a legitimate document.</p>
<p>Based on the decoy document contents and language, the attack may target</p>
<p>Cambodian speakers with an interest in Cambodian political matters.</p>
<p>Figure 1 shows the decoy document used for this sample:</p>
<p><img class="aligncenter wp-image-91785" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_1.png" alt="Koni_1" width="600" height="836" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_1.png 791w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_1-215x300.png 215w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_1-768x1070.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_1-735x1024.png 735w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_1-370x515.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 1 Decoy document for b8120d5c9c2c889b37aa9e37514a3b4964c6e41296be216b327cdccd2e908311</em></p>
<p><span style="font-size: 18pt;">April 2018 Attack</span></p>
<p>In early April 2018, another attack was observed delivering the NOKKI payload. This attack leveraged a malicious executable with an .scr extension that had the original filename referring to the Russian Ministry of Foreign Affairs and its contents can be found online.</p>
<p>The file contains the properties as seen in Table 2:</p>
<table align="center">
<tbody>
<tr>
<td width="102"><strong>MD5</strong></td>
<td width="522">42fbea771f3e0ff04ac0a1d09db2a45e</td>
</tr>
<tr>
<td width="102"><strong>SHA1</strong></td>
<td width="522">2b6b6f24f58072a02f03fa04deaccce04b6bb43b</td>
</tr>
<tr>
<td width="102"><strong>SHA256</strong></td>
<td width="522">9bf634ff0bc7c69ffceb75f9773c198944d907ba822c02c44c83e997b88eeabd</td>
</tr>
<tr>
<td width="102"><strong>File Type</strong></td>
<td width="522">PE32 executable (GUI) Intel 80386, for MS Windows</td>
</tr>
<tr>
<td width="102"><strong>PDB String</strong></td>
<td width="522">C:\Users\zeus\Documents\Visual Studio 2010\Projects\virus-dropper\Release\virus-dropper.pdb</td>
</tr>
<tr>
<td width="102"><strong>Compile Timestamp</strong></td>
<td width="522">2018-04-04 21:06:26 UTC</td>
</tr>
<tr>
<td width="102"><strong>First Encountered</strong></td>
<td width="522">2018-04-04 12:55:38 UTC</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Table 2 April NOKKI Properties</em></p>
<p>This sample contained the same PDB string within it as sample from January 2018. Functionally, it was nearly identical in its behavior as the previous attack.</p>
<p>Unlike the previously witnessed attack that possibly targeted Cambodian language speakers with an interest in Cambodian political matters, the decoy document used in this attack is written Cyrillic and contains content related to Russian political matters.</p>
<p>Once the .scr file is executed, the NOKKI payload is installed onto the victim host which then connects to the IP resolving to a likely compromised but legitimate South Korean science and technology university website.</p>
<p><img class="aligncenter wp-image-91824" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_2.png" alt="Koni_2" width="600" height="858" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_2.png 585w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_2-210x300.png 210w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_2-370x529.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 2 Decoy document for 9bf634ff0bc7c69ffceb75f9773c198944d907ba822c02c44c83e997b88eeabd</em></p>
<p>The content of the decoy document in Figure 2 is a publicly available. Google Translate roughly translates to the following:</p>
<p>About the meeting of the State Secretary &#8211; Deputy Minister of Foreign Affairs of Russia GB Karasin and the Director of the Institute of Strategic and Interregional Studies under the President of Uzbekistan, VI Norov</p>
<p>A second sample was discovered in April 2018, also written Cyrillic and containing content related to Russian political matters. This file had the following properties as seen in Table 3:</p>
<table align="center">
<tbody>
<tr>
<td width="102"><strong>MD5</strong></td>
<td width="522">88587c43daff30cd3cc0c913a390e9df</td>
</tr>
<tr>
<td width="102"><strong>SHA1</strong></td>
<td width="522">1cc8ceeef9a2ea4260fae03368a9d07d56e8331b</td>
</tr>
<tr>
<td width="102"><strong>SHA256</strong></td>
<td width="522">07b90088ec02ef6757f6590a62e2a038ce769914139aff1a26b50399a31dcde9</td>
</tr>
<tr>
<td width="102"><strong>File Type</strong></td>
<td width="522">PE32 executable (GUI) Intel 80386, for MS Windows</td>
</tr>
<tr>
<td width="102"><strong>PDB String</strong></td>
<td width="522">C:\Users\zeus\Documents\Visual Studio 2010\Projects\virus-dropper\Release\virus-dropper.pdb</td>
</tr>
<tr>
<td width="102"><strong>Compile Timestamp</strong></td>
<td width="522">2018-04-24 16:42:03 UTC</td>
</tr>
<tr>
<td width="102"><strong>First Encountered</strong></td>
<td width="522">2018-04-24 06:34:35 UTC</p>
<p>&nbsp;</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Table 3 Second April NOKKI Properties</em></p>
<p>Again, we see consistency both in the embedded PDB string, as well as the functionality of the sample itself. This particular sample connects to an IP address to which a likely legitimate but compromised website of a research institute in South Korea resolves. This server has also likely been compromised and repurposed by the adversary.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">May 2018 Attack</span></p>
<p>In May 2018, Unit 42 observed an attack using malware with a filename of briefinglist.exe being downloaded from the somewhat redacted following URL. Again, it is a likely compromised but legitimate South Korean website and the contents written Cyrillic and containing content related to Russian political matters.</p>
<p>http://mail.[removed].co[.]kr/de/de_includes/mail/yandex.ru/download.php</p>
<p>This sample has the following properties as seen in Table 4:</p>
<table align="center">
<tbody>
<tr>
<td width="88"><strong>MD5</strong></td>
<td width="536">ae27e617f4197cd30cc09fe784453cd4</td>
</tr>
<tr>
<td width="88"><strong>SHA1</strong></td>
<td width="536">dc739ca07585eab7394843bc4dba2faca8e5bfe0</td>
</tr>
<tr>
<td width="88"><strong>SHA256</strong></td>
<td width="536">9b1a21d352ededd057ee3a965907126dd11d13474028a429d91e2349b1f00e10</td>
</tr>
<tr>
<td width="88"><strong>File Type</strong></td>
<td width="536">PE32 executable (GUI) Intel 80386, for MS Windows</td>
</tr>
<tr>
<td width="88"><strong>PDB String</strong></td>
<td width="536">C:\Users\zeus\Documents\Visual Studio 2010\Projects\virus-dropper\Release\virus-dropper.pdb</td>
</tr>
<tr>
<td width="88"><strong>Compile Timestamp</strong></td>
<td width="536">2018-04-30 17:48:08 UTC</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Table 4. Third May NOKKI Properties</em></p>
<p>This sample remains consistent with previous samples of NOKKI in terms of functionality and the embedded PDB string.</p>
<p>The payload communicates with 145.14.145[.]32, which resolves to files.000webhost[.]com. This same host was witnessed in previously reported KONNI malware activity.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">July 2018 Attack</span></p>
<p>In July 2018, a South Korean engineering organization was identified as compromised and hosting malware and C2 infrastructure on their webserver since at least May 2018. Again, a file in Cyrillic with a name referring to the Russianpolitical matters was being distributed from the http://mail.[removed].co[.]kr/common URL.</p>
<p>Unlike attacks leading up to this point, an executable file was not used as the initial malware file. Instead, this attack used a Microsoft Word document leveraging malicious macros to deliver the payload to the victim. Upon opening the file and enabling macros, the document downloaded both the payload and displayed a decoy document referencing political matters.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">NOKKI Malware Family</span></p>
<p>From the samples discussed in this blog, we were able to identify two distinct variants of NOKKI. The earlier variant witnessed in attacks between January 2018 to May 2018 made use of FTP for C2 communications. Alternatively, the newer variant witnessed since June 2018 made use of HTTP. While both variants used different network protocols for communication, they both used the same file path structure on the remote C2 server.</p>
<p>The older variant begins by looking for the presence of the following file:</p>
<p>%TEMP%\ID56SD.tmp</p>
<p>If this file does not exist, the malware will generate a random string of 10 upper-case alphabetic characters. This string will ultimately be used as the victims identifier. It will also create the %TEMP%\stass file and write the value of a to it.</p>
<p>The malware continues to spawn a new thread that is responsible for network communication. Within an infinite loop, this malware will continue connecting to its C2 server via FTP.</p>
<p>After successful connection to the C2, it will write the previously written stass file to the servers public_html folder. It will also upload the previously created uplog.tmp file to the remote server. After the upload is completed, NOKKI will then delete the local copy on the infected host. Finally, NOKKI will check for the presence of the [id]-down file on the C2 server, where [id] is the 10 character alphabetic string created prior. Should this file exist, it will be downloaded and written to %TEMP%\svchostav.exe prior to being executed in a new process. After it is executed, the malware deletes the file on the C2 server. The malware will then sleep for 15 minutes between loops.</p>
<p>The newer variant operates in a slightly different manner.</p>
<p>In this case, NOKKI begins by extracting and dropping an embedded DLL to the %LOCALAPPDATA%\MicroSoft UpdateServices\Services.dll path. One of two DLLs may be dropped, either a 32-bit or a 64-bit compiled options. The appropriate DLL will be dropped based on the victim hosts CPU architecture.</p>
<p>While these DLLs are different architectures, they perform the same functions. After the DLL is written, the malware loads it via the following command-line:</p>
<p>rundll32.exe [%LOCALAPPDATA%\MicroSoft UpdateServices\Services.dll] install</p>
<p>Finally, the malware will write the following registry key to ensure persistence on the victim host:</p>
<p>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\qivService &#8211; C:\\Windows\\System32\\rundll32.exe &#8220;[%LOCALAPPDATA%\MicroSoft UpdateServices\Services.dll]&#8221; install</p>
<p>The payloads install function makes a call to SetWindowsHookEx with a thread ID of 0, resulting in the function being injected into every GUI process running on the victim machine. This particular process is referenced in this <a href="http://www.rohitab.com/discuss/topic/40385-creating-global-api-hook-using-windows-hook/">forum post</a>.</p>
<p>The DllMain function of this payload begins by comparing the process executable name, seeking out the explorer.exe process. In the event it is not loaded in the context of this process, nothing occurs. If the malware is running within explorer.exe, it will load its own HTTPStart exported function, which performs the malicious actions.</p>
<p>It begins by writing the ID56SD.tmp file in its current working directory (CWD). A unique randomly chosen 10-byte alphabetic string is written to this file, which will be used as an identifier for the victim. A file named stass is also written in the CWD, with a single byte of a.</p>
<p>The payload proceeds to enter an infinite loop, with a 15 minute delay between iterations. The loop begins by reading in the previously written stass file and uploading it to its embedded C2 server via HTTP.</p>
<p>The data is encoded with base64 and uploaded via a POST parameter of data. Additionally, the victims identifier and the current timestamp is uploaded via a POST parameter of subject.</p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-91863" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_3.png" alt="Koni_3" width="600" height="300" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_3.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_3-900x450.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_3-300x150.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_3-768x384.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_3-370x185.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 3 HTTP request made by NOKKI payload</em></p>
<p>After this upload request is made, the malware looks for the presence of a file named uplog.tmp. In the event this file exists, it is uploaded via the same method as previously noted. After this file is uploaded via HTTP, the local file is deleted. While this file is not present originally in this malware sample, in other NOKKI variants, it has been observed containing the victims system information.</p>
<p>The malware then looks for the presence of the upfile.tmp file. Again, if this file exists, it is uploaded to the remote server and the local file is deleted.</p>
<p>Finally, the malware will look for the presence of the following remote files, where [id] is the victim identifier:</p>
<ul>
<li>http://mail.[removed].co[.]kr/./pds/down</li>
<li>http://mail.[removed].co[.]kr/./pds/data/[id]-down</li>
</ul>
<p>If the down file is available, it is written to %TEMP%\wirbiry2jsq3454.exe and executed. If the [id]-down file is available, it is written to %TEMP%\weewyesqsf4.exe and executed.</p>
<p>During execution, a remote module was downloaded from the down URL:</p>
<p>This module is responsible for collecting the following information and writing it to the %LOCALAPPDATA%\MicroSoft UpdateServices\uplog.tmp file:</p>
<ul>
<li>IP Address</li>
<li>Hostname</li>
<li>Username</li>
<li>Drive Information</li>
<li>Operating System Information</li>
<li>Installed Programs</li>
</ul>
<p>This module acted in an identical way as the information collection function witnessed in the older variant of NOKKI.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Comparison to KONNI</span></p>
<p>The NOKKI malware family differs from KONNI in a number of ways. Unlike KONNI, NOKKI is modular in nature, with multiple steps taken between the initial infection and the final payload(s) being delivered. Early versions of NOKKI observed between January 2018 to May 2018 used a remote FTP server to ultimately accept commands and download additional modules. While newer versions of NOKKI starting in June 2018 use HTTP, the communication is quite different from the previously reported KONNI malware, both in the URI structure and data being sent. In addition, while the KONNI samples used C2 infrastructure set up specifically by the adversary, NOKKI mostly leveraged what appeared to be likely compromised legitimate servers for their infrastructure.</p>
<p>&nbsp;</p>
<table align="center">
<tbody>
<tr>
<td width="312"><strong>NOKKI URIs</strong></td>
<td width="312"><strong>Previously Reported KONNI URIs</strong></td>
</tr>
<tr>
<td width="312">/./pds/data/upload.php</td>
<td width="312">/login.php</td>
</tr>
<tr>
<td width="312">/./pds/data/[victim_id]-down</td>
<td width="312">/upload.php</td>
</tr>
<tr>
<td width="312">/./pds/down</td>
<td width="312">/download.php</td>
</tr>
<tr>
<td width="312">/common/exe</td>
<td width="312">/weget/uploadtm.php</td>
</tr>
<tr>
<td width="312">/common/doc</td>
<td width="312">/weget/upload.php</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Table 5. URI differences between NOKKI and KONNI</em></p>
<p style="text-align: left;">While we consider these malware families to be separate, we identified some similarities with KONNI. In addition to overlapping infrastructure between KONNI and NOKKI, a NOKKI module used to collect victim information was observed exhibiting very similar characteristics to the KONNI victim information collection function as seen in Figure 4. This same function was also observed in early instances of the dropper used to deploy NOKKI between January 2018 and May 2018.</p>
<p style="text-align: left;"><img class="aligncenter wp-image-91902" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_4.png" alt="Koni_4" width="600" height="606" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_4.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_4-900x908.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_4-297x300.png 297w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_4-768x775.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/Koni_4-370x373.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 4 Similarities between KONNI malware family and NOKKI module</em></p>
<p style="text-align: left;">Based on the similarities witnessed, we think it is highly probable there is some amount of code sharing and likely a single adversary group involved.</p>
<p><span style="font-size: 18pt;">Conclusion</span></p>
<p>The adversary operating the NOKKI malware family appears to have begun using NOKKI in January 2018 and has continued their activity through 2018. At this time, we can only speculate who these series of attacks may be attributed to based on tenuous relationships. However, there is significant evidence from our attack telemetry and victimology indicating the operator has a strong interest in specific regions of the world such as Eurasia, the Korean Peninsula, and Southeast Asia. The general tactics used to deliver NOKKI are similar in nature to the actors behind a previously identified malware, KONNI. Additionally, there are overlaps both in code and some infrastructure with previously reported KONNI activity. Unlike KONNI, however, this particular malware family makes use of compromised servers for both hosting and C2 operations.</p>
<p>The NOKKI malware itself has been updated in the short period of time it has been observed, moving from FTP to HTTP for C2 operations. The malware is modular in nature, and based on analysis of the information gathering module, it is highly likely the NOKKI operators are the same as the KONNI operators. Unit 42 will continue to monitor this malware family and the threat actor responsible.</p>
<p>Palo Alto Networks customers are protected by the following:</p>
<ul>
<li>All known samples of NOKKI maintain a malware verdict in WildFire</li>
<li>AutoFocus customers may learn more via the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.NOKKI">NOKKI</a> tag</li>
</ul>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Appendix</span></p>
<p><strong>Indicators of Compromise</strong></p>
<p>&nbsp;</p>
<p><strong>July 2018 Attack</strong></p>
<table>
<tbody>
<tr>
<td width="312"><strong>Indicator Type</strong></td>
<td width="312"><strong>Indicator</strong></td>
</tr>
<tr>
<td width="312">Hash</td>
<td width="312">d92c94423ec3d01ad584a74a38a2e817449648a4da3f12d345c611edc5c4cdbd</td>
</tr>
<tr>
<td width="312">Hash</td>
<td width="312">dce53e59b0c48e269dadc766a78667a14f11b72c49f57d95abde62c84ac8d7ae</td>
</tr>
<tr>
<td width="312">Hash</td>
<td width="312">0657f788e89a437a1e6fe2630c19436736aa55dcf255540698864a7576192611</td>
</tr>
<tr>
<td width="312">Hash</td>
<td width="312">d211815177ce4b9fd2d3c258d2fc6282c23b8458d71f8f6f0df06a9dda89c12f</td>
</tr>
<tr>
<td width="312">Process</td>
<td width="312">rundll32.exe [%LOCALAPPDATA%\MicroSoft UpdateServices\Services.dll] install</td>
</tr>
<tr>
<td width="312">Registry Key</td>
<td width="312">HKCU\Software\Microsoft\Windows\CurrentVersion\Run\qivService</td>
</tr>
<tr>
<td width="312">File</td>
<td width="312">ID56SD.tmp</td>
</tr>
<tr>
<td width="312">File</td>
<td width="312">stass</td>
</tr>
<tr>
<td width="312">File</td>
<td width="312">%LOCALAPPDATA%\MicroSoft UpdateServices\uplog.tmp</td>
</tr>
<tr>
<td width="312">File</td>
<td width="312">%TEMP%\wirbiry2jsq3454.exe</td>
</tr>
<tr>
<td width="312">File</td>
<td width="312">%TEMP%\weewyesqsf4.exe</td>
</tr>
<tr>
<td width="312">URL</td>
<td width="312">hxxp://mail.[removed].co[.]kr/./pds/data/upload.php</td>
</tr>
<tr>
<td width="312">URL</td>
<td width="312">hxxp://mail.[removed].co[.]kr/./pds/down</td>
</tr>
<tr>
<td width="312">URL</td>
<td width="312">hxxp://mail.[removed].co[.]kr/./pds/data/[id]-down</td>
</tr>
<tr>
<td width="312">URL</td>
<td width="312">hxxp://mail.[removed].co[.]kr/common</td>
</tr>
<tr>
<td width="312">URL</td>
<td width="312">hxxp://mail.[removed].co[.]kr/common/exe</td>
</tr>
<tr>
<td width="312">URL</td>
<td width="312">hxxp://mail.[removed].co[.]kr/common/doc</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>June 2018 Attack</strong></p>
<table>
<tbody>
<tr>
<td width="67"><strong>Indicator Type</strong></td>
<td width="556"><strong>Indicator</strong></td>
</tr>
<tr>
<td width="67">Hash</td>
<td width="556">5137f6a59c2c7a54f1a5fc9a9650972b17d52dd0e203f5abefedf5c593c41ff0</td>
</tr>
<tr>
<td width="67">Hash</td>
<td width="556">fd673703c502be907919a4ff2922b7b969d96d206abc572a5cb83e69ab32ca18</td>
</tr>
<tr>
<td width="67">Hash</td>
<td width="556">4e84f97bb61c2d373a574676fa374131460839ecc7b53064f558ce7ce55528ad</td>
</tr>
<tr>
<td width="67">Hash</td>
<td width="556">fd673703c502be907919a4ff2922b7b969d96d206abc572a5cb83e69ab32ca18</td>
</tr>
<tr>
<td width="67">Hash</td>
<td width="556">74ddd56b1e33aa3752f143a77e5802a5803fd2c222f2cca77bfa5c740dfc8f5e</td>
</tr>
<tr>
<td width="67">Process</td>
<td width="556">rundll32.exe [%LOCALAPPDATA%\MicroSoft UpdateServices\Services.dll] install</td>
</tr>
<tr>
<td width="67">Registry Key</td>
<td width="556">HKCU\Software\Microsoft\Windows\CurrentVersion\Run\qivService</td>
</tr>
<tr>
<td width="67">File</td>
<td width="556">ID56SD.tmp</td>
</tr>
<tr>
<td width="67">File</td>
<td width="556">stass</td>
</tr>
<tr>
<td width="67">File</td>
<td width="556">uplog.tmp</td>
</tr>
<tr>
<td width="67">File</td>
<td width="556">%TEMP%\wirbiry2jsq3454.exe</td>
</tr>
<tr>
<td width="67">File</td>
<td width="556">%TEMP%\weewyesqsf4.exe</td>
</tr>
<tr>
<td width="67">URL</td>
<td width="556">hxxp://mail.[removed].co[.]kr/./pds/data/upload.php</td>
</tr>
<tr>
<td width="67">URL</td>
<td width="556">hxxp://mail.[removed].co[.]kr/./pds/down</td>
</tr>
<tr>
<td width="67">URL</td>
<td width="556">hxxp://mail.[removed].co[.]kr/./pds/data/[id]-down</td>
</tr>
<tr>
<td width="67">URL</td>
<td width="556">hxxp://mail.[removed].co[.]kr/common</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>May 2018 Attack</strong></p>
<table>
<tbody>
<tr>
<td width="66"><strong>Indicator Type</strong></td>
<td width="558"><strong>Indicator</strong></td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">9b1a21d352ededd057ee3a965907126dd11d13474028a429d91e2349b1f00e10</td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">c3172b403068aabc711b7cbe4d923ae1fa705ce11c4cc71271fde83ce751c21c</td>
</tr>
<tr>
<td width="66">Folder</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1\svServiceUpdate.exe</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\uplog.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%STARTUP%\Antdule.lnk</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\ID56SD.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\svchostav.exe</td>
</tr>
<tr>
<td width="66">URL</td>
<td width="558">hxxp://mail.[removed].co[.]kr/de/de_includes/mail/yandex.ru/download.php</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>April 2018 Attack</strong></p>
<table>
<tbody>
<tr>
<td width="66"><strong>Indicator Type</strong></td>
<td width="558"><strong>Indicator</strong></td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">07b90088ec02ef6757f6590a62e2a038ce769914139aff1a26b50399a31dcde9</td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">d5fc0ef2d1ed037b5b6389882f9bb4ea15a6b41f21cdc0f5e90752f4e687445c</td>
</tr>
<tr>
<td width="66">Folder</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1\svServiceUpdate.exe</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\uplog.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%STARTUP%\Antdule.lnk</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\ID56SD.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\svchostav.exe</td>
</tr>
<tr>
<td width="66">URL</td>
<td width="558">hxxp://mail.[removed].co[.]kr/de/de_includes/mail/yandex.ru/download.php</td>
</tr>
<tr>
<td width="66">IP Address</td>
<td width="558">210.112.239[.]74</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>Early April 2018 Attack</strong></p>
<table>
<tbody>
<tr>
<td width="66"><strong>Indicator Type</strong></td>
<td width="558"><strong>Indicator</strong></td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">9bf634ff0bc7c69ffceb75f9773c198944d907ba822c02c44c83e997b88eeabd</td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">c07bea0928a35b9292eebab32563378d01d95434d098e5c7c076e94866a14212</td>
</tr>
<tr>
<td width="66">Folder</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1\svServiceUpdate.exe</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\uplog.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%STARTUP%\Antdule.lnk</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\ID56SD.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\svchostav.exe</td>
</tr>
<tr>
<td width="66">URL</td>
<td width="558">hxxp://mail.[removed].co[.]kr/de/de_includes/mail/yandex.ru/download.php</td>
</tr>
<tr>
<td width="66">IP Address</td>
<td width="558">141.223.125[.]112</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>January 2018 Attack</strong></p>
<table>
<tbody>
<tr>
<td width="66"><strong>Indicator Type</strong></td>
<td width="558"><strong>Indicator</strong></td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">b8120d5c9c2c889b37aa9e37514a3b4964c6e41296be216b327cdccd2e908311</td>
</tr>
<tr>
<td width="66">Hash</td>
<td width="558">0d98ca35b29d2a9f7ca6908747c457ebdba999f0e83e182f770848e2335ade5b</td>
</tr>
<tr>
<td width="66">Folder</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%LOCALAPPDATA\MicroSoft Update1\svServiceUpdate.exe</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\uplog.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%STARTUP%\Antdule.lnk</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\ID56SD.tmp</td>
</tr>
<tr>
<td width="66">File</td>
<td width="558">%TEMP%\svchostav.exe</td>
</tr>
<tr>
<td width="66">URL</td>
<td width="558">hxxp://mail.[removed].co[.]kr/de/de_includes/mail/yandex.ru/download.php</td>
</tr>
<tr>
<td width="66">IP Address</td>
<td width="558">101.129.1[.]104</td>
</tr>
</tbody>
</table>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
