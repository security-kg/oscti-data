
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>New Malware with Ties to SunOrcal Discovered</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-new-malware-with-ties-to-sunorcal-discovered/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit42 discovers Reaver, a new malware family with ties to attackers using SunOrcal malware."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-new-malware-with-ties-to-sunorcal-discovered/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="New Malware with Ties to SunOrcal Discovered" />
<meta property="og:description" content="Unit42 discovers Reaver, a new malware family with ties to attackers using SunOrcal malware." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-new-malware-with-ties-to-sunorcal-discovered/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Reaver" />
<meta property="article:tag" content="SunOrcal" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-11-10T11:00:44+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:57:33+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:57:33+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit42 discovers Reaver, a new malware family with ties to attackers using SunOrcal malware." />
<meta name="twitter:title" content="New Malware with Ties to SunOrcal Discovered" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; New Malware with Ties to SunOrcal Discovered Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-new-malware-with-ties-to-sunorcal-discovered/feed/" />
<meta property="og:likes" content="2"/>
<meta property="og:readtime" content="8"/>
<meta property="og:views" content="29,664"/>
<meta property="og:date_created" content="November 10, 2017 at 1:00 PM"/>
<meta property="og:post_length" content="2252"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:author" content="Jen Miller-Osborn"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/joshgruznweig/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"New Malware with Ties to SunOrcal Discovered","name":"New Malware with Ties to SunOrcal Discovered","description":"Unit42 discovers Reaver, a new malware family with ties to attackers using SunOrcal malware.\n","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-new-malware-with-ties-to-sunorcal-discovered\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-new-malware-with-ties-to-sunorcal-discovered\/","datePublished":"November 10, 2017","articleBody":"Summary\nUnit 42 has discovered a new malware family we\u2019ve named \u201cReaver\u201d with ties to attackers who use SunOrcal malware. SunOrcal activity has been documented to at least 2013, and based on metadata surrounding some of the C2s, may have been active as early as 2010. The new family appears to have been in the wild since late 2016 and to date we have only identified 10 unique samples, indicating it may be sparingly used. Reaver is also somewhat unique in the fact that its final payload is in the form of a Control panel item, or CPL file. To date, only 0.006% of all malware seen by Palo Alto Networks employs this technique, indicating that it is in fact fairly rare.\nWhile we don\u2019t have information on the intended targets in this case, previous reports on this activity have identified targeting primarily among the \u201cFive Poisons\u201d which are movements the Chinese government perceives as dangerous. They are:\n\n \tUyghurs, particularly those supporting East Turkestan independence\n \tTibetans, particularly those supportive of Tibetan independence\n \tFalun Gong practitioners\n \tSupporters of Taiwan independence\n \tSupporters of Chinese democracy\n\nThe attackers used both families concurrently from late last year through November 2017 and there is some C2 infrastructure overlap between the two families, as well as links to historical reporting.\u00a0 We explore those ties and provide an in-depth analysis of the new malware below.\n\nReaver Malware Analysis\nTo date, Palo Alto Networks Unit 42 has identified 10 unique samples and three distinct variants of a new malware family we have named \u201cReaver\u201d. As such, we identify each variant as Reaver.v1, Reaver.v2, and Reaver.v3.\nReaver.v1 has been observed delivering a payload that uses HTTP for network communication, while versions 2 and 3 use a payload that uses raw TCP connections for this communication.\nThe flow for Reaver is as shown:\n\nFigure 1 Reaver execution flow diagram\nReaver.v1\nThe earliest variant of Reaver begins by attempting to enable the SeDebugPrivilege privilege for the running process. In the event this is successful the malware will use the following path to store any dropped files:\n\n \t%COMMONPROGRAMFILES%\\services\\\n\nIn the event it is not successful, this alternative path will be used instead:\n\n \t%APPDATA%\\microsoft\\mmc\\\n\nIt proceeds to load and decrypt and embedded bitmap resource file. This decrypted data is written to the following location:\n\n \t%TEMP%\\WUpdate.~tmp\n\nThis \u2018WUpdate.~tmp\u2019 file is then copied to a filename of \u2018Applet.cpl\u2019, which is placed in the previously identified file path.\nThe malware proceeds to identify the file path of either the common startup folder, or the user\u2019s startup folder depending on if the SeDebugPrivilege privilege was obtained. In the event this privilege was obtained, the common startup folder is queried by reading the following registry key:\n\n \tHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\\Common Startup\n\nAlternatively, if the privilege was unable to be obtained, Reaver.v2 will obtain the user\u2019s startup folder by querying the following registry key:\n\n \tHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\\Startup\n\nReaver proceeds to write a shortcut file to \u2018%TEMP%\\~WUpdate.lnk\u2019. This file is then copied to a filename of \u2018Windows Update.lnk\u2019, which is placed in the startup path previously identified. This shortcut file points to the path of the previously written \u2018Applet.cpl\u2019 file. Finally, Reaver.v1 will execute the \u2018~WUpdate.lnk\u2019 file in a new process, thus loading the recently dropped malicious CPL file.\n&nbsp;\n Reaver.v2\nReaver.v2 begins by attempting to enable the SeDebugPrivilege privilege for the running process. In the event this is successful, the malware will use the following path to store any dropped files:\n\n \t%COMMONPROGRAMFILES%\\services\\\n\nIn the event it is not successful, this alternative path will be used instead:\n\n \t%APPDATA%\\microsoft\\mmc\\\n\nReaver.v2 proceeds to decrypt an embedded file using a simple XOR obfuscation routine. This file is written to the following file path:\n\n \t% TEMP%\\Update.~tmp\n\nAfter the file is written, it is then copied to a filename of \u2019winhelp.cpl\u2019 in the directory that was initially chosen. After this file is copied, the original \u2018Update.~tmp\u2019 file is deleted. At this stage the malware will identify the correct startup path using the same technique witnessed in earlier variants.\nA shortcut file is generated in the following path:\n\n \t%TEMP%\\~Update.lnk\n\nThis \u2018~Update.lnk\u2019 file is then copied to a filename of \u2018Windows help.lnk\u2019, which is placed in the startup path previously identified. This shortcut file points to the path of the previously written \u2018winhelp.cpl\u2019 file. It will specifically load this CPL file via a call to the built-in Microsoft Windows \u2018control.exe\u2019 utility. Finally, Reaver.v2 will execute the \u2018~Update.lnk\u2019 file in a new process, thus loading the recently dropped malicious CPL file.\n\nReaver.v3\nLike Reaver.v2, Reaver.v3 begins by attempting to enable the SeDebugPrivilege privilege for the running process. In the event this is successful, the malware will use the following path to store any dropped files:\n\n \t%COMMONPROGRAMFILES%\\services\\\n\nIn the event it is not successful, this alternative path will be used instead:\n\n \t%APPDATA%\\microsoft\\credentials\\\n\nReaver.v3 proceeds to write an embedded Microsoft Cabinet (CAB) file to the following location:\n\n \t%TEMP%\\winhelp.dat\n\nThis cabinet file is then extracted to the previously identified file path. The contents of this cabinet file consist of a Microsoft Control Panel item with a filename of \u2018winhelp.cpl\u2019.\nMuch like the previous version of Reaver, Reaver.v3 will query the necessary registry keys to determine the correct startup path to use. Again, a shortcut file is written to the %TEMP% path with a name of \u2018~Update.lnk\u2019, which is in turn copied to the identified startup path with a filename of \u2018Windows help.lnk\u2019. This shortcut file calls the built-in \u2018control.exe\u2019 utility to in turn load the previously dropped malicious CPL file of \u2018winhelp.cpl\u2019.\nFinally, the malware calls the \u2018winhelp.cpl\u2019 file in a new process via the following command:\n\n \tcontrol [path_previously_identified]\\winhelp.cpl\n\n\nReaver HTTP Payload\nThe malicious CPL payload of Reaver has the following two exported functions:\n\n \tCPlApplet\n \tDllEntryPoint\n\nWhen the CPlApplet function is loaded, Reaver will initially determine if the SeDebugPrivilege privilege is able to be obtained. The malware proceeds to decrypt and embedded configuration of 128 bytes using a simple XOR routine. The following example decrypted configuration is as follows:\n00000000: 77 77 77 2E 74 61 73 68  64 71 64 78 70 2E 63 6F  www.tashdqdxp.co\n00000010: 6D 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  m...............\n00000020: 38 30 00 00 00 00 00 00  00 00 00 00 00 00 00 00  80..............\n00000030: 33 30 00 00 00 00 00 00  00 00 00 00 00 00 00 00  30..............\n00000040: 57 69 6E 64 6F 77 73 20  55 70 64 61 74 65 00 00  Windows Update..\n00000050: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................\n00000060: 41 70 70 6C 65 74 00 00  00 00 00 00 00 00 00 00  Applet..........\n00000070: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................\n\nAs we can see, the following information is present within this configuration:\n\n \tRemote Command and Control (C2) server\n \tRemote port\n \tSleep timer\n\nReaver continues to collect various information from the victim machine, including the following:\n\n \tCPU speed\n \tComputer name\n \tUsername\n \tIP Address\n \tMicrosoft Windows version\n \tPhysical and virtual memory information\n\nThe malware proceeds to communicate with the remote server via HTTP GET and POST requests. Data that is sent is compressed and then base64-encoded before being included in the requests.\nWe have observed the following capabilities of this payload:\n\n \tGet drive information\n \tRead files\n \tWrite files\n \tDelete files\n \tMove files\n \tSpawn processes\n \tCreate directories\n\n\nReaver TCP Payload\nThe malicious CPL payload of Reaver has the following three exported functions:\n\n \tServiceMain\n \tCPlApplet\n \tDllEntryPoint\n\nWhen the malware is initially loaded, DllEntryPoint will be called, which in turn will call a function that is responsible for decompressing a blob of data. The decompressed data consists of various key\/value pairings that represent important strings used by Reaver. An example of this decompressed data can be seen below:\nRA@10001=ole32.dll\nRA@10002=CoCreateGuid\nRA@10003=Shlwapi.dll\nRA@10004=SHDeleteKeyA\nRA@10005=wininet.dll\nRA@10006=InternetOpenA\n[TRUNCATED]\nRA@10288=%s\\%s\nRA@10289=CMD.EXE\nRA@10290=%s=\nRA@10311=\\%sctr.dll\nRA@10312=\\uc.dat\nRA@10313=ChangeServiceConfig2A\nRA@10314=QueryServiceConfig2A\n\nWhen the malware wishes to retrieve one of these decoded strings, it will simply call a function with an integer argument that is responsible for providing it. For example, calling this function with an argument of \u201810001\u2019 would retrieve a string of \u2018ole32.dll\u2019.\nThe DllEntryPoint function proceeds to attempt to obtain the SeDebugPrivilege privilege, and also calls WSAStartup for future network activity.\nWhen the CPlApplet function is loaded, it will begin by decompressing an embedded configuration using the same compression algorithm used previously. An example of this decompressed configuration may be seen below:\n\nFigure 2 Decompressed Reaver configuration\nThis configuration contains multiple pieces of information, including the following:\n\n \tNetwork port\n \tSleep timer between network requests\n \tRemote Command and Control (C2)\n \tService Name\n \tService Description\n \tService Display Name\n \tHardcoded String. This may be either a campaign identifier, or perhaps a malware versioning string.\n\nThe malware proceeds to check to see if the original dropped malware file exists. In the event it does, Reaver will move this file to \u2018%TEMP%\\~FJIOW.tmp\u2019 and delete this new file. This simply acts as cleanup to ensure original file artifacts no longer reside on the infected machine. Reaver will then install itself as a service in the event it is running with SeDebugPrivilege privileges.\u00a0 The service is configured with a name, description, and display name that is provided within the configuration.\nReaver continues to collect various information from the victim machine, including the following:\n\n \tComputer name\n \tVolume serial number\n \tMicrosoft Windows version\n \tCPU speed\n \tANSI code page\n \tOEM code page identifier for the operating system\n \tPhysical and virtual memory information\n\nReaver encrypts this data using an incremental XOR key and uploads it to the configured remote server on the port specified. The following example Python code shows how this encryption takes place:\nc = 0\nout = \"\"\nfor d in data:\n  out += chr((ord(d) ^ ((c % 256) + 92)) &amp; 0xFF)\n  c += 1\n\nAfter this data is exfiltrated, the malware expects 8 bytes of data that contains two DWORDs. These DWORDs contain both a major command and a sub-command.\nThe following capabilities have been observed in this payload:\n\n \tGet drive information\n \tModify files\n \tModify directories\n \tModify registry\n \tSpawn process\n \tTerminate process\n \tModify services\n \tKill self\n\n\nTies to SunOrcal\nReaver was used concurrently with SunOrcal over the past year, to include two Reaver samples dropped from zip files hosted on a domain also being used as a SunOrcal C2 (www.fyoutside[.]com), and there is also passive DNS overlap amongst the C2s. Specifically, Reaver to date has used www.tashdqdxp[.]com for C2, which overlaps with www.weryhstui[.]com, another C2 used by SunOrcal samples during the same timeframe. Both domains have resolved to 98.126.156[.]210. Several of those same SunOrcal samples were also using www.fyoutside[.]com as an additional C2.\u00a0 This led to further C2 ties within SunOrcal samples, to include samples beaconing to www.olinaodi[.]com; all of this is shown below in Figure 3. The latter has been previously reported in activity targeting Hong Kong democracy activists and that activity is in turn tied to a report targeting Tibetan, Hong Kong, and Taiwanese activists, and another blog about targeting Taiwanese activists.\n\nFigure 3. Chart showing overlaps between Reaver and SunOrcal. All IOCs are in the appendix at the end of this blog.\nConclusion\nThe attackers behind SunOrcal, whose activity dates to at least 2013 and possibly 2010, remain active and are still developing new custom malware to use against their targets. The new malware, Reaver, appears to have been in the wild since late 2016 with less than a dozen known samples, among which there are three variants. It is also unique in the fact that its final payload is in a CPL file, a technique which Palo Alto Networks has seen with only 0.006% of all malware samples we have analyzed. The attackers used both families concurrently from late last year through November 2017 and there is some C2 infrastructure overlap between the two families, as well as links to historical reporting. We will continue to monitor these attackers for new activity and report as appropriate.\nPalo Alto Networks customers are protected by the following:\n\n \tWildfire and Traps identifies both malware families as malicious.\n \tThe C2 domains are blocked via Threat Prevention.\n \tAutoFocus customers can monitor activity using this malware with the following tags:\n\n \tReaver\n \tSunOrcal\n\n\n\n\nAppendix\nSHA2556 \u2013 Reaver.v1\nd560f44188fb56d3abb11d9508e1167329470de19b811163eb1167534722e666\n&nbsp;\nSHA2556 \u2013 Reaver.v2\n98eb5465c6330b9b49df2e7c9ad0b1164aa5b35423d9e80495a178eb510cdc1c\n05ddbd0506ec95fb460b3994e5b21cdb0418ba4aa406374ca1b91249349b7640\n&nbsp;\nSHA2556 \u2013 Reaver.v3\n18ac3b14300ecfeed4b64a844c16dccb06b0e3513d0954d6c6182f2ea14e4c92\nc0f8bb77284b96e07cab1c3fab8800b1bbd030720c74628c4ee5666694ef903d\n9213f70bce491991c4cbbbd7dc3e67d3a3d535b965d7064973b35c50f265e59b\n26c234c73e2c3448589c7d4a0cf17f615ad3666541a4e611e2d8b77637205bcf\nae9f158e4886cfdbfb4f1b3b25707d05f6fd873d0be9d8e7334a2c28741228ee\n1fcda755e8fa23d27329e4bc0443a82e1c1e9a6c1691639db256a187365e4db1\nc906250e0a4c457663e37119ebe1efa1e4b97eef1d975f383ac3243f9f09908c\n1813f10bcf74beb582c824c64fff63cb150d178bef93af81d875ca84214307a1\n&nbsp;\nSHA256 \u2013 SunOrcal\n799139b5278dc2ac24279cc6c3db44f4ef0ea78ee7b721b0ace38fd8018c51ac\n81d887fefdbb0219647991c2b7bddf45c2fede4dc6fc18408f1706e0279615b2\n58312fb742ce881e040e1b5b8555f00a402b8dd4fc886acaae2f862040b3bfc5\n38ea33dab0ba2edd16ecd98cba161c550d1036b253c8666c4110d198948329fb\ncb7c0cf1750baaa11783e93369230ee666b9f3da7298e4d1bb9a07af6a439f2f\n\nC2 domains and IP addresses\nwww.tashdqdxp[.]com\nwww.weryhstui[.]com\nwww.fyoutside[.]com\n&nbsp;\nwww.olinaodi[.]com\n104.148.70[.]217\n98.126.156[.]210\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Josh Grunzweig"},{"@type":"Person","name":"Jen Miller-Osborn"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"49044","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=49044' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-malware-with-ties-to-sunorcal-discovered%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-malware-with-ties-to-sunorcal-discovered%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-49044 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">New Malware with Ties to SunOrcal Discovered</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-49044 entry-meta">
			
			
			<span class="post-views-count">29,664</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'49044','like')"><i class="ui ui-2"></i><span class="ml-5">2</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-malware-with-ties-to-sunorcal-discovered%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-malware-with-ties-to-sunorcal-discovered%2F+-+New+Malware+with+Ties+to+SunOrcal+Discovered" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-malware-with-ties-to-sunorcal-discovered%2F&title=New+Malware+with+Ties+to+SunOrcal+Discovered&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-new-malware-with-ties-to-sunorcal-discovered/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/joshgruznweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a> and <a href="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/" title="Posts by Jen Miller-Osborn" class="author url fn" rel="author">Jen Miller-Osborn</a>        </p>
        <p><time datetime="2017-11-10T11:00:44+00:00">November 10, 2017 at 1:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/reaver/" rel="tag">Reaver</a>, <a href="https://unit42.paloaltonetworks.com/tag/sunorcal/" rel="tag">SunOrcal</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p><span style="font-size: 18pt;">Summary</span><br />
Unit 42 has discovered a new malware family we’ve named “Reaver” with ties to attackers who use SunOrcal malware. SunOrcal activity has been <a href="http://pwc.blogs.com/cyber_security_updates/2016/03/index.html">documented</a> to at least 2013, and based on metadata surrounding some of the C2s, may have been active as early as 2010. The new family appears to have been in the wild since late 2016 and to date we have only identified 10 unique samples, indicating it may be sparingly used. Reaver is also somewhat unique in the fact that its final payload is in the form of a Control panel item, or CPL file. To date, only 0.006% of all malware seen by Palo Alto Networks employs this technique, indicating that it is in fact fairly rare.<br />
While we don’t have information on the intended targets in this case, previous reports on this activity have identified targeting primarily among the “Five Poisons” which are movements the Chinese government perceives as dangerous. They are:</p>
<ul>
<li>Uyghurs, particularly those supporting East Turkestan independence</li>
<li>Tibetans, particularly those supportive of Tibetan independence</li>
<li>Falun Gong practitioners</li>
<li>Supporters of Taiwan independence</li>
<li>Supporters of Chinese democracy</li>
</ul>
<p>The attackers used both families concurrently from late last year through November 2017 and there is some C2 infrastructure overlap between the two families, as well as links to historical reporting.  We explore those ties and provide an in-depth analysis of the new malware below.<br />
<span style="font-size: 18pt;"><br />
Reaver Malware Analysis</span><br />
To date, Palo Alto Networks Unit 42 has identified 10 unique samples and three distinct variants of a new malware family we have named “Reaver”. As such, we identify each variant as Reaver.v1, Reaver.v2, and Reaver.v3.<br />
Reaver.v1 has been observed delivering a payload that uses HTTP for network communication, while versions 2 and 3 use a payload that uses raw TCP connections for this communication.<br />
The flow for Reaver is as shown:<br />
<img class="aligncenter wp-image-49047" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_1.png" alt="Sunorcal_1" width="600" height="498" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_1.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_1-900x746.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_1-300x249.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_1-768x637.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_1-370x307.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 1 Reaver execution flow diagram</em></p>
<p><span style="font-size: 18pt;">Reaver.v1</span><br />
The earliest variant of Reaver begins by attempting to enable the SeDebugPrivilege privilege for the running process. In the event this is successful the malware will use the following path to store any dropped files:</p>
<ul>
<li>%COMMONPROGRAMFILES%\services\</li>
</ul>
<p>In the event it is not successful, this alternative path will be used instead:</p>
<ul>
<li>%APPDATA%\microsoft\mmc\</li>
</ul>
<p>It proceeds to load and decrypt and embedded bitmap resource file. This decrypted data is written to the following location:</p>
<ul>
<li>%TEMP%\WUpdate.~tmp</li>
</ul>
<p>This ‘WUpdate.~tmp’ file is then copied to a filename of ‘Applet.cpl’, which is placed in the previously identified file path.<br />
The malware proceeds to identify the file path of either the common startup folder, or the user’s startup folder depending on if the SeDebugPrivilege privilege was obtained. In the event this privilege was obtained, the common startup folder is queried by reading the following registry key:</p>
<ul>
<li>HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Common Startup</li>
</ul>
<p>Alternatively, if the privilege was unable to be obtained, Reaver.v2 will obtain the user’s startup folder by querying the following registry key:</p>
<ul>
<li>HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Startup</li>
</ul>
<p>Reaver proceeds to write a shortcut file to ‘%TEMP%\~WUpdate.lnk’. This file is then copied to a filename of ‘Windows Update.lnk’, which is placed in the startup path previously identified. This shortcut file points to the path of the previously written ‘Applet.cpl’ file. Finally, Reaver.v1 will execute the ‘~WUpdate.lnk’ file in a new process, thus loading the recently dropped malicious CPL file.<br />
&nbsp;<br />
<span style="font-size: 18pt;"> Reaver.v2</span><br />
Reaver.v2 begins by attempting to enable the SeDebugPrivilege privilege for the running process. In the event this is successful, the malware will use the following path to store any dropped files:</p>
<ul>
<li>%COMMONPROGRAMFILES%\services\</li>
</ul>
<p>In the event it is not successful, this alternative path will be used instead:</p>
<ul>
<li>%APPDATA%\microsoft\mmc\</li>
</ul>
<p>Reaver.v2 proceeds to decrypt an embedded file using a simple XOR obfuscation routine. This file is written to the following file path:</p>
<ul>
<li>% TEMP%\Update.~tmp</li>
</ul>
<p>After the file is written, it is then copied to a filename of ’winhelp.cpl’ in the directory that was initially chosen. After this file is copied, the original ‘Update.~tmp’ file is deleted. At this stage the malware will identify the correct startup path using the same technique witnessed in earlier variants.<br />
A shortcut file is generated in the following path:</p>
<ul>
<li>%TEMP%\~Update.lnk</li>
</ul>
<p>This ‘~Update.lnk’ file is then copied to a filename of ‘Windows help.lnk’, which is placed in the startup path previously identified. This shortcut file points to the path of the previously written ‘winhelp.cpl’ file. It will specifically load this CPL file via a call to the built-in Microsoft Windows ‘control.exe’ utility. Finally, Reaver.v2 will execute the ‘~Update.lnk’ file in a new process, thus loading the recently dropped malicious CPL file.<br />
<span style="font-size: 18pt;"><br />
Reaver.v3</span><br />
Like Reaver.v2, Reaver.v3 begins by attempting to enable the SeDebugPrivilege privilege for the running process. In the event this is successful, the malware will use the following path to store any dropped files:</p>
<ul>
<li>%COMMONPROGRAMFILES%\services\</li>
</ul>
<p>In the event it is not successful, this alternative path will be used instead:</p>
<ul>
<li>%APPDATA%\microsoft\credentials\</li>
</ul>
<p>Reaver.v3 proceeds to write an embedded Microsoft Cabinet (CAB) file to the following location:</p>
<ul>
<li>%TEMP%\winhelp.dat</li>
</ul>
<p>This cabinet file is then extracted to the previously identified file path. The contents of this cabinet file consist of a Microsoft Control Panel item with a filename of ‘winhelp.cpl’.<br />
Much like the previous version of Reaver, Reaver.v3 will query the necessary registry keys to determine the correct startup path to use. Again, a shortcut file is written to the %TEMP% path with a name of ‘~Update.lnk’, which is in turn copied to the identified startup path with a filename of ‘Windows help.lnk’. This shortcut file calls the built-in ‘control.exe’ utility to in turn load the previously dropped malicious CPL file of ‘winhelp.cpl’.<br />
Finally, the malware calls the ‘winhelp.cpl’ file in a new process via the following command:</p>
<ul>
<li>control [path_previously_identified]\winhelp.cpl</li>
</ul>
<p><span style="font-size: 18pt;"><br />
Reaver HTTP Payload</span><br />
The malicious CPL payload of Reaver has the following two exported functions:</p>
<ul>
<li>CPlApplet</li>
<li>DllEntryPoint</li>
</ul>
<p>When the CPlApplet function is loaded, Reaver will initially determine if the SeDebugPrivilege privilege is able to be obtained. The malware proceeds to decrypt and embedded configuration of 128 bytes using a simple XOR routine. The following example decrypted configuration is as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc1a5637509178008" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
00000000: 77 77 77 2E 74 61 73 68  64 71 64 78 70 2E 63 6F  www.tashdqdxp.co
00000010: 6D 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  m...............
00000020: 38 30 00 00 00 00 00 00  00 00 00 00 00 00 00 00  80..............
00000030: 33 30 00 00 00 00 00 00  00 00 00 00 00 00 00 00  30..............
00000040: 57 69 6E 64 6F 77 73 20  55 70 64 61 74 65 00 00  Windows Update..
00000050: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000060: 41 70 70 6C 65 74 00 00  00 00 00 00 00 00 00 00  Applet..........
00000070: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc1a5637509178008-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5637509178008-2">2</div><div class="crayon-num" data-line="crayon-5f694cc1a5637509178008-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5637509178008-4">4</div><div class="crayon-num" data-line="crayon-5f694cc1a5637509178008-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5637509178008-6">6</div><div class="crayon-num" data-line="crayon-5f694cc1a5637509178008-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5637509178008-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc1a5637509178008-1"><span class="crayon-cn">00000000</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-h"> </span><span class="crayon-cn">2E</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">61</span><span class="crayon-h"> </span><span class="crayon-cn">73</span><span class="crayon-h"> </span><span class="crayon-cn">68</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-cn">71</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-cn">2E</span><span class="crayon-h"> </span><span class="crayon-cn">63</span><span class="crayon-h"> </span><span class="crayon-cn">6F</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">www</span><span class="crayon-sy">.</span><span class="crayon-v">tashdqdxp</span><span class="crayon-sy">.</span><span class="crayon-i">co</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5637509178008-2"><span class="crayon-cn">00000010</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">6D</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694cc1a5637509178008-3"><span class="crayon-cn">00000020</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">80..............</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5637509178008-4"><span class="crayon-cn">00000030</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">30..............</span></div><div class="crayon-line" id="crayon-5f694cc1a5637509178008-5"><span class="crayon-cn">00000040</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">57</span><span class="crayon-h"> </span><span class="crayon-cn">69</span><span class="crayon-h"> </span><span class="crayon-cn">6E</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-cn">6F</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-h"> </span><span class="crayon-cn">73</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">55</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-cn">61</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">Windows </span><span class="crayon-v">Update</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5637509178008-6"><span class="crayon-cn">00000050</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694cc1a5637509178008-7"><span class="crayon-cn">00000060</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-cn">6C</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Applet</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5637509178008-8"><span class="crayon-cn">00000070</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>As we can see, the following information is present within this configuration:</p>
<ul>
<li>Remote Command and Control (C2) server</li>
<li>Remote port</li>
<li>Sleep timer</li>
</ul>
<p>Reaver continues to collect various information from the victim machine, including the following:</p>
<ul>
<li>CPU speed</li>
<li>Computer name</li>
<li>Username</li>
<li>IP Address</li>
<li>Microsoft Windows version</li>
<li>Physical and virtual memory information</li>
</ul>
<p>The malware proceeds to communicate with the remote server via HTTP GET and POST requests. Data that is sent is compressed and then base64-encoded before being included in the requests.<br />
We have observed the following capabilities of this payload:</p>
<ul>
<li>Get drive information</li>
<li>Read files</li>
<li>Write files</li>
<li>Delete files</li>
<li>Move files</li>
<li>Spawn processes</li>
<li>Create directories</li>
</ul>
<p><span style="font-size: 18pt;"><br />
Reaver TCP Payload</span><br />
The malicious CPL payload of Reaver has the following three exported functions:</p>
<ul>
<li>ServiceMain</li>
<li>CPlApplet</li>
<li>DllEntryPoint</li>
</ul>
<p>When the malware is initially loaded, DllEntryPoint will be called, which in turn will call a function that is responsible for decompressing a blob of data. The decompressed data consists of various key/value pairings that represent important strings used by Reaver. An example of this decompressed data can be seen below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc1a5640944478797" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
RA@10001=ole32.dll
RA@10002=CoCreateGuid
RA@10003=Shlwapi.dll
RA@10004=SHDeleteKeyA
RA@10005=wininet.dll
RA@10006=InternetOpenA
[TRUNCATED]
RA@10288=%s\%s
RA@10289=CMD.EXE
RA@10290=%s=
RA@10311=\%sctr.dll
RA@10312=\uc.dat
RA@10313=ChangeServiceConfig2A
RA@10314=QueryServiceConfig2A</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc1a5640944478797-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5640944478797-2">2</div><div class="crayon-num" data-line="crayon-5f694cc1a5640944478797-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5640944478797-4">4</div><div class="crayon-num" data-line="crayon-5f694cc1a5640944478797-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5640944478797-6">6</div><div class="crayon-num" data-line="crayon-5f694cc1a5640944478797-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5640944478797-8">8</div><div class="crayon-num" data-line="crayon-5f694cc1a5640944478797-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5640944478797-10">10</div><div class="crayon-num" data-line="crayon-5f694cc1a5640944478797-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5640944478797-12">12</div><div class="crayon-num" data-line="crayon-5f694cc1a5640944478797-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5640944478797-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc1a5640944478797-1"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10001</span><span class="crayon-o">=</span><span class="crayon-v">ole32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5640944478797-2"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10002</span><span class="crayon-o">=</span><span class="crayon-e">CoCreateGuid</span></div><div class="crayon-line" id="crayon-5f694cc1a5640944478797-3"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10003</span><span class="crayon-o">=</span><span class="crayon-v">Shlwapi</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5640944478797-4"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10004</span><span class="crayon-o">=</span><span class="crayon-e">SHDeleteKeyA</span></div><div class="crayon-line" id="crayon-5f694cc1a5640944478797-5"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10005</span><span class="crayon-o">=</span><span class="crayon-v">wininet</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5640944478797-6"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10006</span><span class="crayon-o">=</span><span class="crayon-i">InternetOpenA</span></div><div class="crayon-line" id="crayon-5f694cc1a5640944478797-7"><span class="crayon-sy">[</span><span class="crayon-v">TRUNCATED</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5640944478797-8"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10288</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-v">s</span><span class="crayon-sy">\</span><span class="crayon-o">%</span><span class="crayon-i">s</span></div><div class="crayon-line" id="crayon-5f694cc1a5640944478797-9"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10289</span><span class="crayon-o">=</span><span class="crayon-v">CMD</span><span class="crayon-sy">.</span><span class="crayon-e">EXE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5640944478797-10"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10290</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-v">s</span><span class="crayon-o">=</span></div><div class="crayon-line" id="crayon-5f694cc1a5640944478797-11"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10311</span><span class="crayon-o">=</span><span class="crayon-sy">\</span><span class="crayon-o">%</span><span class="crayon-v">sctr</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5640944478797-12"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10312</span><span class="crayon-o">=</span><span class="crayon-sy">\</span><span class="crayon-v">uc</span><span class="crayon-sy">.</span><span class="crayon-e">dat</span></div><div class="crayon-line" id="crayon-5f694cc1a5640944478797-13"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10313</span><span class="crayon-o">=</span><span class="crayon-e">ChangeServiceConfig2A</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5640944478797-14"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10314</span><span class="crayon-o">=</span><span class="crayon-v">QueryServiceConfig2A</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>When the malware wishes to retrieve one of these decoded strings, it will simply call a function with an integer argument that is responsible for providing it. For example, calling this function with an argument of ‘10001’ would retrieve a string of ‘ole32.dll’.<br />
The DllEntryPoint function proceeds to attempt to obtain the SeDebugPrivilege privilege, and also calls WSAStartup for future network activity.<br />
When the CPlApplet function is loaded, it will begin by decompressing an embedded configuration using the same compression algorithm used previously. An example of this decompressed configuration may be seen below:<br />
<img class="aligncenter wp-image-49080" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_2.png" alt="Sunorcal_2" width="600" height="307" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_2.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_2-900x461.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_2-300x154.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_2-768x393.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_2-370x189.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 2 Decompressed Reaver configuration</em></p>
<p>This configuration contains multiple pieces of information, including the following:</p>
<ul>
<li>Network port</li>
<li>Sleep timer between network requests</li>
<li>Remote Command and Control (C2)</li>
<li>Service Name</li>
<li>Service Description</li>
<li>Service Display Name</li>
<li>Hardcoded String. This may be either a campaign identifier, or perhaps a malware versioning string.</li>
</ul>
<p>The malware proceeds to check to see if the original dropped malware file exists. In the event it does, Reaver will move this file to ‘%TEMP%\~FJIOW.tmp’ and delete this new file. This simply acts as cleanup to ensure original file artifacts no longer reside on the infected machine. Reaver will then install itself as a service in the event it is running with SeDebugPrivilege privileges.  The service is configured with a name, description, and display name that is provided within the configuration.<br />
Reaver continues to collect various information from the victim machine, including the following:</p>
<ul>
<li>Computer name</li>
<li>Volume serial number</li>
<li>Microsoft Windows version</li>
<li>CPU speed</li>
<li>ANSI code page</li>
<li>OEM code page identifier for the operating system</li>
<li>Physical and virtual memory information</li>
</ul>
<p>Reaver encrypts this data using an incremental XOR key and uploads it to the configured remote server on the port specified. The following example Python code shows how this encryption takes place:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc1a5643583599561" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c = 0
out = ""
for d in data:
  out += chr((ord(d) ^ ((c % 256) + 92)) &amp; 0xFF)
  c += 1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc1a5643583599561-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5643583599561-2">2</div><div class="crayon-num" data-line="crayon-5f694cc1a5643583599561-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc1a5643583599561-4">4</div><div class="crayon-num" data-line="crayon-5f694cc1a5643583599561-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc1a5643583599561-1"><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5643583599561-2"><span class="crayon-v">out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f694cc1a5643583599561-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc1a5643583599561-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">out</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">92</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc1a5643583599561-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>After this data is exfiltrated, the malware expects 8 bytes of data that contains two DWORDs. These DWORDs contain both a major command and a sub-command.<br />
The following capabilities have been observed in this payload:</p>
<ul>
<li>Get drive information</li>
<li>Modify files</li>
<li>Modify directories</li>
<li>Modify registry</li>
<li>Spawn process</li>
<li>Terminate process</li>
<li>Modify services</li>
<li>Kill self</li>
</ul>
<p><span style="font-size: 18pt;"><br />
Ties to SunOrcal</span><br />
Reaver was used concurrently with SunOrcal over the past year, to include two Reaver samples dropped from zip files hosted on a domain also being used as a SunOrcal C2 (www.fyoutside[.]com), and there is also passive DNS overlap amongst the C2s. Specifically, Reaver to date has used www.tashdqdxp[.]com for C2, which overlaps with www.weryhstui[.]com, another C2 used by SunOrcal samples during the same timeframe. Both domains have resolved to 98.126.156[.]210. Several of those same SunOrcal samples were also using www.fyoutside[.]com as an additional C2.  This led to further C2 ties within SunOrcal samples, to include samples beaconing to www.olinaodi[.]com; all of this is shown below in Figure 3. The latter has been <a href="https://citizenlab.ca/2016/04/between-hong-kong-and-burma/">previously reported</a> in activity targeting Hong Kong democracy activists and that activity is in turn tied to a <a href="https://www.arbornetworks.com/blog/asert/wp-content/uploads/2016/04/ASERT-Threat-Intelligence-Report-2016-03-The-Four-Element-Sword-Engagement.pdf">report</a> targeting Tibetan, Hong Kong, and Taiwanese activists, and another<a href="http://pwc.blogs.com/cyber_security_updates/2016/03/index.html"> blog</a> about targeting Taiwanese activists.<br />
<img class="aligncenter wp-image-49113" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_3.png" alt="Sunorcal_3" width="600" height="377" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_3.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_3-900x566.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_3-300x189.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_3-768x483.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Sunorcal_3-370x233.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 3. Chart showing overlaps between Reaver and SunOrcal. All IOCs are in the appendix at the end of this blog.</em></p>
<p><span style="font-size: 18pt;">Conclusion</span><br />
The attackers behind SunOrcal, whose activity dates to at least 2013 and possibly 2010, remain active and are still developing new custom malware to use against their targets. The new malware, Reaver, appears to have been in the wild since late 2016 with less than a dozen known samples, among which there are three variants. It is also unique in the fact that its final payload is in a CPL file, a technique which Palo Alto Networks has seen with only 0.006% of all malware samples we have analyzed. The attackers used both families concurrently from late last year through November 2017 and there is some C2 infrastructure overlap between the two families, as well as links to historical reporting. We will continue to monitor these attackers for new activity and report as appropriate.<br />
Palo Alto Networks customers are protected by the following:</p>
<ul>
<li>Wildfire and Traps identifies both malware families as malicious.</li>
<li>The C2 domains are blocked via Threat Prevention.</li>
<li>AutoFocus customers can monitor activity using this malware with the following tags:
<ul>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Reaver">Reaver</a></li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.SunOrcal">SunOrcal</a></li>
</ul>
</li>
</ul>
<p><span style="font-size: 18pt;"><strong><br />
Appendix</strong></span><br />
<strong>SHA2556 – Reaver.v1</strong><br />
d560f44188fb56d3abb11d9508e1167329470de19b811163eb1167534722e666<br />
&nbsp;<br />
<strong>SHA2556 – Reaver.v2</strong><br />
98eb5465c6330b9b49df2e7c9ad0b1164aa5b35423d9e80495a178eb510cdc1c<br />
05ddbd0506ec95fb460b3994e5b21cdb0418ba4aa406374ca1b91249349b7640<br />
&nbsp;<br />
<strong>SHA2556 – Reaver.v3</strong><br />
18ac3b14300ecfeed4b64a844c16dccb06b0e3513d0954d6c6182f2ea14e4c92<br />
c0f8bb77284b96e07cab1c3fab8800b1bbd030720c74628c4ee5666694ef903d<br />
9213f70bce491991c4cbbbd7dc3e67d3a3d535b965d7064973b35c50f265e59b<br />
26c234c73e2c3448589c7d4a0cf17f615ad3666541a4e611e2d8b77637205bcf<br />
ae9f158e4886cfdbfb4f1b3b25707d05f6fd873d0be9d8e7334a2c28741228ee<br />
1fcda755e8fa23d27329e4bc0443a82e1c1e9a6c1691639db256a187365e4db1<br />
c906250e0a4c457663e37119ebe1efa1e4b97eef1d975f383ac3243f9f09908c<br />
1813f10bcf74beb582c824c64fff63cb150d178bef93af81d875ca84214307a1<br />
&nbsp;<br />
<strong>SHA256 – SunOrcal</strong><br />
799139b5278dc2ac24279cc6c3db44f4ef0ea78ee7b721b0ace38fd8018c51ac<br />
81d887fefdbb0219647991c2b7bddf45c2fede4dc6fc18408f1706e0279615b2<br />
58312fb742ce881e040e1b5b8555f00a402b8dd4fc886acaae2f862040b3bfc5<br />
38ea33dab0ba2edd16ecd98cba161c550d1036b253c8666c4110d198948329fb<br />
cb7c0cf1750baaa11783e93369230ee666b9f3da7298e4d1bb9a07af6a439f2f<br />
<strong><span style="font-size: 12pt;"><br />
C2 domains and IP addresses</span></strong><br />
www.tashdqdxp[.]com<br />
www.weryhstui[.]com<br />
www.fyoutside[.]com<br />
&nbsp;<br />
www.olinaodi[.]com<br />
104.148.70[.]217<br />
98.126.156[.]210<br />
&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
