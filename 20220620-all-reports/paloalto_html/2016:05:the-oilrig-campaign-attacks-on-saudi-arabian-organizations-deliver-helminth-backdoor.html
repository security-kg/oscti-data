
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 observed The OilRig Campaign: targeted attacks focused on organizations within Saudi Arabia delivering Helminth backdoor."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor" />
<meta property="og:description" content="Unit 42 observed The OilRig Campaign: targeted attacks focused on organizations within Saudi Arabia delivering Helminth backdoor." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="AutoFocus" />
<meta property="article:tag" content="Helminth" />
<meta property="article:tag" content="OilRig" />
<meta property="article:tag" content="OilRig attacks" />
<meta property="article:tag" content="Powershell" />
<meta property="article:tag" content="Saudi Arabia" />
<meta property="article:tag" content="VBScript" />
<meta property="article:tag" content="WildFire" />
<meta property="article:tag" content="Windows" />
<meta property="article:section" content="Financial Services" />
<meta property="article:published_time" content="2016-05-26T11:05:54+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:15:43+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:15:43+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit-41_-Fig-1-500x107.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 observed The OilRig Campaign: targeted attacks focused on organizations within Saudi Arabia delivering Helminth backdoor." />
<meta name="twitter:title" content="The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit-41_-Fig-1-500x107.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<meta property="og:likes" content="3"/>
<meta property="og:readtime" content="15"/>
<meta property="og:views" content="30,564"/>
<meta property="og:date_created" content="May 26, 2016 at 2:05 PM"/>
<meta property="og:post_length" content="4128"/>
<meta property="og:category" content="Financial Services"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/financial-services/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:author" content="Bryan Lee"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bryanlee/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor","name":"The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)In May 2016, Unit 42 observed targeted attacks primarily focused on financial institutions and technology organizations within Saudi Arabia. Artifacts identified within the malware samples related to these attacks also suggest the targeting of the defense industry in Saudi Arabia, which appears to be related to an earlier...","url":"https:\/\/unit42.paloaltonetworks.com\/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor\/","datePublished":"May 26, 2016","articleBody":"In May 2016, Unit 42 observed targeted attacks primarily focused on financial institutions and technology organizations within Saudi Arabia. Artifacts identified within the malware samples related to these attacks also suggest the targeting of the defense industry in Saudi Arabia, which appears to be related to an earlier wave of attacks carried out in the fall of 2015. We have grouped these two waves of attacks into a campaign we have named \u2018OilRig\u2019.\n\nIn recent OilRig attacks, the threat actors purport to be legitimate service providers offering service and technical troubleshooting as a social engineering theme in their spear-phishing attacks. Earlier OilRig attacks appear to use fake job offers as a social engineering theme. The campaign appears highly targeted and delivers a backdoor we have called \u2018Helminth\u2019. Over the course of the attack campaign, we have observed two different variations of the Helminth backdoor, one written in VBScript and PowerShell that was delivered via a macro within Excel spreadsheets and the other a standalone Windows executable.\nClayslide: Excel Macros Install Helminth Script\nIn May 2016, Unit 42 began researching attacks that used spear-phishing emails with attachments, specifically malicious Excel spreadsheets sent to financial organizations within Saudi Arabia. We observed spear-phishing emails sent between May 4 and May 12 of this year that delivered these malicious Excel spreadsheets, which we are tracking as \u2018Clayslide\u2019. ClaySlide documents contain malicious macros that display decoy content within the spreadsheet and installs a variant of a Helminth backdoor. FireEye also reported on these attacks in a May 22 blog post.\n\nThe macro within Clayslide samples installs the Helminth script, which is composed of a VBScript called \u2018update.vbs\u2019 and a PowersShell script called \u2018dns.ps1\u2019. The purpose of the VBScript is to send network beacons to its command and control server using HTTP requests and will either download a file or run a batch script provided within the HTTP response. The VBScript also uploads the output of the provided batch scripts to the command and control (C2) server, which provides threat actors a functional remote shell to the system.\n\nThe PowerShell script has similar capabilities to the VBScript, but instead of using HTTP for communications it uses a series of DNS queries to send and receive data from the server. This communication channel relies on the C2 server responding to DNS queries with IP addresses that the PowerShell script will parse treat as data to construct a batch script to execute on the system. The script specifically looks for the IP address \u201c33.33.x.x\u201d to mark the beginning of the batch script transfer. The script will continue sending additional DNS requests and use the octets of the resolving IP addresses as characters to write to the batch script. The script continues to write data to the batch script until it receives the IP address \u201c35.35.35.35\u201d, which notifies the script to stop saving data to the file and to run the batch script.\n\nPlease reference the Appendix for more detailed information on the Clayslide delivery documents and the Helminth script variant.\nDiscovery of Executable Helminth Variant\nAdditional samples were discovered in WildFire exhibiting the same DNS-based C2 behavior as the script variant of Helminth; however, many of these samples were found to be Windows executable, instead of the previously observed VBScript and PowerShell combination. These samples were found to contain the same functionality as the previously mentioned Helminth samples. Figure 1 shows the code within the VBScript version of Helminth checking resolving IP addresses for the 35.35.35.35 IP address to stop appending data to a batch script before executing it, while Figure 2 shows the same functionality within the executable version of the Trojan.\n\nFigure 1 Helminth dns.ps1 PowerShell script looking for 35.35.35.35 IP address\nFigure 2 Helminth executable looking for the 35.35.35.35 IP address\nThis suggests that the threat actors developed the executable variant of Helminth as a standalone option whose installation does not rely on a macro within an Excel spreadsheet. This also suggests that the threat actors purposely used the same communication methods across both variants with the intention to use the same command and control server application. This variant of the Trojan is also where we obtained its name, as several of these payloads had the following debug symbol path that suggests the malware author called this project \u2018Helminth\u2019:\n\nE:\\Projects\\hlm updated\\Helminth\\Release\\Helminth.pdb\n\nPlease reference the Appendix for additional details on the Helminth executable variant.\nDelivery of Windows Executable Helminth Variant\nUnit 42 does not have detailed targeting information associated with attacks delivering the executable variant of the Helminth Trojan, however, we found a Zip archive created in August 2015 that may have been used by the threat actors to deliver the Helminth Trojan. This Zip file was hosted at the following location:\n\nhxxp:\/\/minfosecu.doosan[.]com\/data\/joboffer.zip\n\nThe Zip archive is encrypted with an unknown password, but we know it contains two files named joboffer.chm and thumb.db. The thumb.db file in the archive has the same name and file size (368128 bytes) as a dropper Trojan we track as \u2018HerHer\u2019 (SHA256: fb424443ad3e27ef535574cf7e67fbf9054949c48ec19be0b9ddfbfc733f9b07) that installs a known Helminth executable sample. The joboffer.chm file is a compiled HTML file that we believe loads and executes the \u2018thumb.db\u2019 file as a payload, but we cannot be absolutely sure as we do not have the password required to extract the files from the archive.\n\nThe decoy opened by the Helminth sample installed by \u2018thumb.db\u2019 (seen in Figure 3) is a dialog box associated with HTML help, which further strengthens our theory that the joboffer.chm ran the sample. This decoy suggests that the threat actors wanted to open the HTML help dialog after installing the Helminth Trojan, as the joboffer.chm file is effectively a standalone HTML file. We believe that the threat actors employed social engineering to underplay the situation and provide a different legitimate job offer if the victim responded with concerns of malicious activity.\n\n\nFigure 3 A Helminth sample displays this dialog box if provided 'w' on the command line\nThe executable variant of Helminth is installed with a dropper Trojan that we are tracking as the HerHer Trojan. This Trojan has two objectives: installing embedded Trojans and displaying either a fake error prompt or a fake \u201ctrubleshooting\" (the malware author misspelled this word in each sample) utility. Figure 4 is an example of the fake error prompt displayed by the HerHer Trojan.\n\nFigure 4 Fake Error Prompt Displayed by the HerHer Trojan\nThe Helminth executable variant is very similar in functionality to its script-based counterpart, as it also communicates with its C2 server using both HTTP and DNS queries. The major difference in capabilities between the two variants is that the executable version comes with a module that Helminth uses to log keystrokes and the clipboard contents to exfiltrate to the C2 server.\n\nHelminth executable samples send artifacts within network beacons to its C2 server that the Trojan refers to as a \u2018Group\u2019 and \u2018Name\u2019. We extracted the group and name values from the Helminth executable samples to determine their purpose. It appears that the group values hardcoded into the malware is associated with the targeted organization, as several are Saudi Arabian organizations within the telecommunications and defense industries. This suggests that the threat actors are not only focused on financial organizations, as their target set could include other industries as well.\n\nThe name values hardcoded into the Helminth samples are also interesting, as a majority of the names are related to famous philosophers, such as \u2018Plato\u2019 (Greek philosopher), \u2018Arasto\u2019 (Persian and Urdu for Greek philosopher Aristotle), and \u2018ALAfghani\u2019 (Jamal ad-Din al-Afghani, Islamic Philosopher). Other name values embedded in samples contain other Persian words, such as \u2018Nafti\u2019 (\u0646\u0641\u062a\u06cc) that translates to \u2018oily\u2019, which led us to name this campaign OilRig).\nHelminth Infrastructure\nExamining the known infrastructure of the collected sample set of Helminth provides several interesting findings in regards to the adversary\u2019s tactics. The variants leveraging malicious macros embedded in Excel documents all share the same command and control server of go0gie[.]com. The executable variants, on the other hand, used a variety of domains:\n\ncheckgoogle[.]org\nmydomain1110[.]com\nkernel[.]ws\nmydomain1607[.]com\nmydomain1609[.]com\n\n&nbsp;\n\n\nFigure 5 Helminth C2 Infrastructure\nEach sample of the weaponized Excel document variant used a unique command and control domain to retrieve a bot ID, using the following format:\n\n00000000&lt;base 36 of a random number smaller than 46655&gt;30.go0gie[.]com\n\nEach of these domains, however, resolved to the same IP address of 5.39.112.87. This IP is observed as the resolution for two domains in use by the portable executable variants, kernel[.]ws and mydomain1110[.]com. Judging by compile timestamps of the executables and last saved timestamps of the weaponized documents, it is likely the adversary is recycling a previously created C2 server at 5.39.112.87 for the newer macro based variant. The other C2 domains and IPs observed in use by the previous portable executable samples did not have shared infrastructure with the newer macro variants, although there is tactical overlap via the naming scheme of the domains.\n\nHistorical WHOIS data reveals additional findings, potentially alluding to an Iranian-based operator. From a timeline perspective, a new domain was registered almost in consecutive months, beginning in July 2015. Each of the domains's WHOIS data contained registrant information that was either reused, or was closely related to previously used information. For example, the domains mydomain1607[.]com and mydomain1609[.]com used the exact same registrant information. The email address edmundj@chmail[.]ir and the geolocation of Tehran, Iran, being of note. Kernel[.]ws and checkgoogle[.]org used very similar email addresses, andre_serkisian@yahoo[.]com and andre.serkisian@chmail[.]ir, respectively. The registrant information for kernel[.]ws also provided a geolocation of Tehran, IR and the email provider for the address used in checkgoogle[.]org was the same used for mydomain1607[.]com and mydomain1609[.]com, chmail.ir. The mydomain1110[.]com domain did not appear to reuse any of the previously observed WHOIS data artifacts, but did still give a geolocation of Tehran in addition to the use of an email address linked to other domains thematically similar to the know command and control domains and are potentially related.\n\nAlthough there is heavy use of Iranian-based artifacts within the WHOIS registrant information, it is important to remember that this data is easily falsified. At face value, however, taking into account the registrant information and the use of Persian language in the samples are compelling indicators that the operators may indeed be based out of Iran.\nConclusion\nWhile researching the OilRig campaign, we have seen two waves of targeted attacks on Saudi Arabian organizations in which a group of threat actors delivered the Helminth Trojan as a payload. The two waves of attacks used separate variants of the Helminth Trojan, specifically a script and executable variant of the Trojan.\n\nThe two variants of Helminth use almost identical command and control protocols, which allows the threat actors to maintain consistent infrastructure throughout the campaign to manage the compromised hosts, regardless of the Helminth variant used in the attack.\n\nThe two variants of Helminth do require different delivery methods, with the script variant relying on an Excel spreadsheet for delivery, while the executable variant is more traditional in the fact that it can be installed without a delivery document. We speculate that the executable variant involves threat actors socially engineering the victim into running the payload, rather than installing the payload as the result of successful exploitation of a vulnerability. The multiple delivery methods suggest this threat group is capable of adapting their procedures to suit the current operation in the overarching campaign.\n\nPalo Alto Networks customers are protected from the Helminth Trojan and can gather additional information using the following tools:\n\n \tWildFire detection of all known samples as malicious\n \tAll Helminth C2 domains have DNS signatures created and are identified as malicious in PAN-DB.\n \tAutoFocus tags Clayslide, Helminth and HerHerDropper.\n\nAppendix\nClayslide Delivery Documents\n\nAt first, Clayslide spreadsheets display a worksheet called \u201cIncompatible\u201d that contains instructions for the user to manually enable macros (as seen in Figure 6), as macros are disabled in Excel by default. This is an attempt to trick the user into running the embedded macro to install the Trojan, which does not require any vulnerability exploitation. Figure 6 shows the \u201cProtected View\u201d alert in Excel informing the user that there is an embedded macro that may cause harm to the system.\n\nFigure 6 Clayslide spreadsheet showing the Incompatible worksheet with instructions to enable macros and Excel displaying its Protected View alert message\nBefore the user can enable the macros in accordance with the instructions displayed in the spreadsheet, the user must click the red bar displayed by Protected View and click the \u201cEdit Anyway\u201d button, as seen in 7.\n\nFigure 7 Protected View further mentioning the potential danger with editing the spreadsheet in the ClaySlide sample\nAfter clicking the \u201cEdit Anyway\u201d button, Excel displays another security warning bar alerting that the spreadsheet contains macros, as seen in Figure 8. The \u201cEnable Content\u201d button mentioned within the instructions displayed within the Clayslide spreadsheet is now presented to the user.\n\n\nFigure 8 Excel security warning with the Enable Content button mentioned in Incompatible worksheet\nIf the user clicks the \u201cEnable Content\u201d button, the macro hides the \u201cIncompatible\u201d worksheet and makes hidden worksheets visible that displays decoy content to minimize the victim\u2019s suspicions of malicious behavior taking place. Figure 9 below shows the decoy content displayed by macros within a Clayslide sample, specifically showing the status of internal network IP addresses that fit with the service provider social engineering theme used throughout the attack campaign. Figure 9 also shows that the \u201cIncompatible\u201d worksheet is no longer visible, as the decoy content is displayed in a worksheet called \u201cSheet1\u201d.\n\nFigure 9 Decoy content displayed after enabling macros within a Clayslide sample\nAfter displaying the decoy content, the macro begins installing the script variant of the Helminth Trojan to the system. The process used by the macro to install this variant of Helminth begins with the creation of the following files and folders:\n\n&nbsp;\n\n%PUBLIC%\\Libraries\\update.vbs\n%PUBLIC%\\Libraries\\dns.ps1\n%PUBLIC%\\Libraries\\up\n%PUBLIC%\\Libraries\\dn\n%PUBLIC%\\Libraries\\tp\n\nThe malicious macro finishes the installation process by creating a scheduled task that is responsible for running the two scripts at regular intervals, as the scripts themselves do not have the ability to continually run after the initial execution. The following code snippet within the macro creates a scheduled task named \u201cGoogleUpdateTaskMachineUI\u201d that will run the update.vbs script every three minutes:\n\nwss.Run \"schtasks \/create \/F \/sc minute \/mo 3 \/tn \" &amp; Chr(34) &amp; \"GoogleUpdateTaskMachineUI\" &amp; Chr(34) &amp; \" \/tr \" &amp; wss.ExpandEnvironmentStrings(\"%PUBLIC%\") &amp; \"\\Libraries\\update.vbs\", 0\nHelminth Script Variant\nThe script variant of the Helminth Trojan consists of a VBScript and PowerShell script named update.vbs and dns.ps1. We aptly named this variant the script version, as we found another version of this Trojan that we will discuss later in this Appendix. The update.vbs script is responsible for reaching out to its command and control (C2) server using HTTP requests to the following two URLs:\n\nhxxp:\/\/go0gIe.com\/sysupdate.aspx?req=&lt;random number&gt;%5Cdwn&amp;m=d\nhxxp:\/\/go0gIe.com\/sysupdate.aspx?req=&lt;random number&gt;%5Cbat&amp;m=d\n\nThe C2 server will respond to the HTTP requests to the \u201cbat&amp;m=d\u201d URL with a batch script that update.vbs will save to the \u201cdn\u201d folder and execute. The output of the downloaded batch script is saved to a text file in the \u201cup\u201d folder and uploaded to the C2 server via an HTTP POST request to the following URL:\n\nhxxp:\/\/go0gIe.com\/sysupdate.aspx?req=&lt;random number&gt;%5Cupl&amp;m=u\n\nPalo Alto Networks WildFire observed commands provided by the C2 server for the known Helminth samples. The commands, as seen below, show that the threat actors are attempting to do initial information gathering on the system, including available user accounts, username, computer name, running tasks, services, network services and if remote desktop is enabled.\n\nwhoami &amp; hostname &amp; ipconfig \/all &amp; net user \/domain 2&gt;&amp;1 &amp; net group \/domain 2&gt;&amp;1 &amp; net group \"domain admins\" \/domain 2&gt;&amp;1 &amp; net group \"Exchange Trusted Subsystem\" \/domain 2&gt;&amp;1 &amp; net accounts \/domain 2&gt;&amp;1 &amp; net user 2&gt;&amp;1 &amp; net localgroup administrators 2&gt;&amp;1 &amp; netstat -an 2&gt;&amp;1 &amp; tasklist 2&gt;&amp;1 &amp; sc query 2&gt;&amp;1 &amp; systeminfo 2&gt;&amp;1 &amp; reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" 2&gt;&amp;1\n\nThe update.vbs concludes by running the dns.ps1 PowerShell script. The dns.ps1 script is also responsible for communicating with the C2 server, but it uses DNS queries to send data to the server. The DNS queries sent by this script are queries to subdomains on the same domain as the C2 server, which contains system information or the contents of files from the system. The subdomain of the DNS request that acts as the initial C2 beacon has the following structure:\n\n00000000&lt;base 36 of a random number smaller than 46655&gt;30\n\nThe dns.ps1 script checks the response to this DNS query and uses the first octet of the resolving IP address as an identifier for the compromised system. The script then uses this identifier in a follow up DNS request to a subdomain with the following structure:\n\n00&lt;identifier&gt;00000&lt;base36 of a random number smaller than 46655&gt;30\n\nThe C2 server will respond to these DNS queries with IP addresses that the script will parse and eventually treat as data to construct a batch script to execute on the system. The script specifically looks for the IP address \u201c33.33.x.x\u201d to mark the beginning of the batch script transfer. Upon receipt of this IP address, the script uses the last two octets of this IP address as a filename for the batch file that it saves to the \u201ctp\u201d folder that was initially created by the macro. Once the batch file name is obtained, the script will continue sending additional DNS requests and use the octets of the resolving IP addresses as characters to write to the batch script. The script continues writing characters to the batch script until it receives the IP address \u201c35.35.35.35\u201d that notifies the script to stop saving data to the file and to run the batch script.\n\nThe output of the downloaded batch file is saved to \u201c%PUBLIC%\\Libraries\\tp\\&lt;batch filename&gt;.txt\u201d. The script will then upload the output of this batch file by including the data in a sequence of DNS queries. The exfiltrates the output of the batch script by splitting up the data within the text file into chunks up to 23 bytes and sends the data within a series of DNS queries that have the following structure:\n\n00&lt;identifier&gt;&lt;filename of batch file without its extension&gt;&lt;base36 of sequence number&gt;&lt;base36 of a random number smaller than 46655&gt;&lt;up to 23 bytes of data from batch script output&gt;\n\nBoth the update.vbs and dns.ps1 both provide a fully functional remote shell to the actors, which allow the actor to carry out any activities on the compromised system they wish.\nHelminth Executable Variant\nThe executable variant of Helminth is installed with a Trojan that we are tracking as the HerHer Trojan. The HerHer Trojan saves several files to the file system upon execution to install the Helminth Trojan to the system.\n\n \t%APPDATA%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Certificate Managment.lnk\n \t%APPDATA%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Certificate.ico\n \t%APPDATA%\\Roaming\\Microsoft Temperary\\adbmanager.exe\n \t%APPDATA%\\Roaming\\Microsoft Temperary\\adbtray.exe\n \t%APPDATA%\\Local\\Temp\\acro\\Users\\config.txt\n \t%PUBLIC%\\Libraries\\~Windows\\wintrust.hlm\n\nThe \u201cCertificate Managment.lnk\u201d shortcut uses the \u201cCertificate.ico\u201d file for its icon, as seen in Figure 10.\n\n\nFigure 10 Icon file used\nAdditionally, it has a comment of \u2018herher\u2019, which is basis of the dropper\u2019s name. Helminth relies on the following shortcut for persistence, as it runs the Trojan each time the system starts using the following command line:\n\n\"C:\\Users\\Rick James\\AppData\\Roaming\\Microsoft Temperary\\adbmanager.exe\" q 1\n\nThe \u2018adbmanager.exe\u2019 and \u2018adbtray.exe\u2019 files are the actual Helminth Trojan, both of which are the same executable. The reason for two different filenames is currently unknown. The Helminth Trojan requires arguments on the command-line to execute properly (\u2018q\u2019 in the analyzed sample as seen in the \u2018Certificate Managment.lnk\u2019 shortcut), one of which will run the Trojan\u2019s functional code and the other can open a dialog box as a decoy.\n\nThe Helminth Trojan begins by creating a mutex named \u2018[username]ver4.1\u2019 and writes its embedded configuration as ciphertext to the following file:\n\n%APPDATA%\\Local\\Temp\\acro\\Users\\config.txt\n\nThe Trojan will later decrypt the contents of this file using the RC4 algorithm, using the MD5 hash of \u2018f246b23d-c2d6-45f2-b268-dec30d9adaad\u2019 as the key. We decrypted the configuration file dropped by Helminth and found the structure of the configuration file is \u2018IsAlive,[sleep interval]\\r\\n[C2 domain]\u2019. For example, one Helminth sample had the following data within the \u201cconfig.txt\u201d file:\n\nIsAlive,30\ncheckgoogle.org\n\nThe Helminth executable variant is able to run batch scripts provided by the C2 server, which is very similar to the script version of this Trojan. The executable variant has one additional capability that is not present in the script version, which involves the ability to log keystrokes via a supplemental keylogger module.\n\nHelminth loads its keylogger module of the Trojan by loading the wintrust.hlm file dropped by the HerHer Trojan as a DLL and calling its exported function named \u2018Initialize\u2019. The keylogger that creates a window named \u2018kk\u2019 to monitor both the clipboard and keystrokes and to save the data in cleartext to the file \u2018%TEMP%\/acro\/Users\/[GUID from CoCreateGuid]kk.tmp\u2019. The keylogger saves the keystrokes and the name of the Window visible while the keys were typed to this file in the following structure:\n\n####T####[Window Name]####ET####\n[logged keystrokes]\n\nThe wintrust.hlm keylogger logs the contents of the clipboard to the same file, but the clipboard contents do not follow a header that specifies the window name like the other logged keystrokes. The clipboard contents are logged to the file in the following format:\n\n&lt;&lt;&lt; Clipboard ---&gt; [contents of clipboard]&gt;&gt;&gt;\nHelminth Exe C2 Communications\nThe Helminth executable is able to communicate with its C2 server via HTTP and via DNS queries in very similar ways to the Helminth script variant. In fact, the DNS beacons follow the same structure and sequence as the script variant of Helminth discussed in the previous section. The main difference between the beacons sent from the two variants of Helminth is the data included within the beacon, as the script variant does not send any system information within the beacons, whereas the executable version sends system and malware specific information within both the HTTP and DNS beacons.\n\nHelminth executables include the system and malware information within HTTP beacons in the \u201cCookie\u201d field of the request. Helminth structures the beacon data as follows:\n\nFunction=F1; ID=[MD5 of Computer and Username]; Group=[Hardcoded in Malware]; Name=[Hardcoded in Malware]; Service=0;\n\nThe Trojan will encrypt this data using RC4 and the MD5 hash of \u201cf246b23d-c2d6-45f2-b268-dec30d9adaad\u201d as the key and encode the encrypted data using base64. Figure 11 shows a Helminth HTTP beacon with the Cookie field containing the base64 data.\n\n\nFigure 11 Helminth HTTP C2 beacon\nHelminth sends data within DNS beacons differently than the HTTP beacons and includes additional information as well. The data within the DNS beacons follows the structure:\n\n&lt;path of folder containing keylogger module&gt;\n&lt;path of folder containing key logs and batch script output files&gt;\n&lt;group name hardcoded in malware&gt;\n&lt;name hardcoded in malware&gt;\n&lt;computer name&gt;\n&lt;user name&gt;\n&lt;sleep interval&gt;\n&lt;C2 domain&gt;\n\nThe Trojan does not encrypt the data sent via DNS beacons, rather it converts the ASCII characters into their hexadecimal values and includes these values in cleartext. The DNS beacons sent from the Helminth executable have the following structure, which is very similar to the script version:\n\n00&lt;identifier&gt;01&lt;sequence number&gt;&lt;up to 24 hexadecimal values of the ASCII data&gt;\n\nFigure 12 shows an example of the DNS beacons sent from a Helminth executable.\n\n\nFigure 12 Helminth DNS C2 beacon\nThe encoded data within the DNS beacons displayed in Figure 12 decode to the following:\n\nC:\\Users\\Public\\Libraries\\~Windows\\\nC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Users\\\n[redacted company name]\nPlato\n[Computer Name redacted]\nAdministrator\n30\nkernel.ws","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Robert Falcone"},{"@type":"Person","name":"Bryan Lee"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"13971","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=13971' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fthe-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fthe-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-13971 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-13971 entry-meta">
			
			
			<span class="post-views-count">30,564</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'13971','like')"><i class="ui ui-2"></i><span class="ml-5">3</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 15</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fthe-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fthe-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor%2F+-+The+OilRig+Campaign%3A+Attacks+on+Saudi+Arabian+Organizations+Deliver+Helminth+Backdoor" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fthe-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor%2F&title=The+OilRig+Campaign%3A+Attacks+on+Saudi+Arabian+Organizations+Deliver+Helminth+Backdoor&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a> and <a href="https://unit42.paloaltonetworks.com/author/bryanlee/" title="Posts by Bryan Lee" class="author url fn" rel="author">Bryan Lee</a>        </p>
        <p><time datetime="2016-05-26T11:05:54+00:00">May 26, 2016 at 2:05 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/financial-services/" rel="category tag">Financial Services</a>, <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/autofocus/" rel="tag">AutoFocus</a>, <a href="https://unit42.paloaltonetworks.com/tag/helminth/" rel="tag">Helminth</a>, <a href="https://unit42.paloaltonetworks.com/tag/oilrig/" rel="tag">OilRig</a>, <a href="https://unit42.paloaltonetworks.com/tag/oilrig-attacks/" rel="tag">OilRig attacks</a>, <a href="https://unit42.paloaltonetworks.com/tag/powershell/" rel="tag">Powershell</a>, <a href="https://unit42.paloaltonetworks.com/tag/saudi-arabia/" rel="tag">Saudi Arabia</a>, <a href="https://unit42.paloaltonetworks.com/tag/vbscript/" rel="tag">VBScript</a>, <a href="https://unit42.paloaltonetworks.com/tag/wildfire/" rel="tag">WildFire</a>, <a href="https://unit42.paloaltonetworks.com/tag/windows/" rel="tag">Windows</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja"></span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>In May 2016, Unit 42 observed targeted attacks primarily focused on financial institutions and technology organizations within Saudi Arabia. Artifacts identified within the malware samples related to these attacks also suggest the targeting of the defense industry in Saudi Arabia, which appears to be related to an earlier wave of attacks carried out in the fall of 2015. We have grouped these two waves of attacks into a campaign we have named OilRig.</p>
<p>In recent OilRig attacks, the threat actors purport to be legitimate service providers offering service and technical troubleshooting as a social engineering theme in their spear-phishing attacks. Earlier OilRig attacks appear to use fake job offers as a social engineering theme. The campaign appears highly targeted and delivers a backdoor we have called Helminth. Over the course of the attack campaign, we have observed two different variations of the Helminth backdoor, one written in VBScript and PowerShell that was delivered via a macro within Excel spreadsheets and the other a standalone Windows executable.<span id="more-13971"></span></p>
<h3>Clayslide: Excel Macros Install Helminth Script</h3>
<p>In May 2016, Unit 42 began researching attacks that used spear-phishing emails with attachments, specifically malicious Excel spreadsheets sent to financial organizations within Saudi Arabia. We observed spear-phishing emails sent between May 4 and May 12 of this year that delivered these malicious Excel spreadsheets, which we are tracking as Clayslide. ClaySlide documents contain malicious macros that display decoy content within the spreadsheet and installs a variant of a Helminth backdoor. FireEye also reported on these attacks in a May 22 <a href="https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html" target="_blank">blog post</a>.</p>
<p>The macro within Clayslide samples installs the Helminth script, which is composed of a VBScript called update.vbs and a PowersShell script called dns.ps1. The purpose of the VBScript is to send network beacons to its command and control server using HTTP requests and will either download a file or run a batch script provided within the HTTP response. The VBScript also uploads the output of the provided batch scripts to the command and control (C2) server, which provides threat actors a functional remote shell to the system.</p>
<p>The PowerShell script has similar capabilities to the VBScript, but instead of using HTTP for communications it uses a series of DNS queries to send and receive data from the server. This communication channel relies on the C2 server responding to DNS queries with IP addresses that the PowerShell script will parse treat as data to construct a batch script to execute on the system. The script specifically looks for the IP address 33.33.x.x to mark the beginning of the batch script transfer. The script will continue sending additional DNS requests and use the octets of the resolving IP addresses as characters to write to the batch script. The script continues to write data to the batch script until it receives the IP address 35.35.35.35, which notifies the script to stop saving data to the file and to run the batch script.</p>
<p>Please reference the Appendix for more detailed information on the Clayslide delivery documents and the Helminth script variant.</p>
<h3>Discovery of Executable Helminth Variant</h3>
<p>Additional samples were discovered in WildFire exhibiting the same DNS-based C2 behavior as the script variant of Helminth; however, many of these samples were found to be Windows executable, instead of the previously observed VBScript and PowerShell combination. These samples were found to contain the same functionality as the previously mentioned Helminth samples. Figure 1 shows the code within the VBScript version of Helminth checking resolving IP addresses for the 35.35.35.35 IP address to stop appending data to a batch script before executing it, while Figure 2 shows the same functionality within the executable version of the Trojan.</p>
<p style="text-align: center;"><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit-41_-Fig-1.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-13974" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit-41_-Fig-1-500x107.png" alt="OilRig_Unit 41_ Fig 1" width="500" height="107" /></a></p>
<p style="text-align: center;"><em>Figure 1 Helminth dns.ps1 PowerShell script looking for 35.35.35.35 IP address</em></p>
<p style="text-align: center;"><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_unit-41_-figure-2.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-13977" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_unit-41_-figure-2.png" alt="OilRig_unit 41_ figure 2" width="392" height="553" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_unit-41_-figure-2.png 392w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_unit-41_-figure-2-213x300.png 213w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_unit-41_-figure-2-370x522.png 370w" sizes="(max-width: 392px) 100vw, 392px" /></a><em>Figure 2 Helminth executable looking for the 35.35.35.35 IP address</em></p>
<p>This suggests that the threat actors developed the executable variant of Helminth as a standalone option whose installation does not rely on a macro within an Excel spreadsheet. This also suggests that the threat actors purposely used the same communication methods across both variants with the intention to use the same command and control server application. This variant of the Trojan is also where we obtained its name, as several of these payloads had the following debug symbol path that suggests the malware author called this project Helminth:</p>
<p><em>E:\Projects\hlm updated\Helminth\Release\Helminth.pdb</em></p>
<p>Please reference the Appendix for additional details on the Helminth executable variant.</p>
<h3>Delivery of Windows Executable Helminth Variant</h3>
<p>Unit 42 does not have detailed targeting information associated with attacks delivering the executable variant of the Helminth Trojan, however, we found a Zip archive created in August 2015 that may have been used by the threat actors to deliver the Helminth Trojan. This Zip file was hosted at the following location:</p>
<p><em>hxxp://minfosecu.doosan[.]com/data/joboffer.zip</em></p>
<p>The Zip archive is encrypted with an unknown password, but we know it contains two files named joboffer.chm and thumb.db. The thumb.db file in the archive has the same name and file size (368128 bytes) as a dropper Trojan we track as HerHer (SHA256: fb424443ad3e27ef535574cf7e67fbf9054949c48ec19be0b9ddfbfc733f9b07) that installs a known Helminth executable sample. The joboffer.chm file is a compiled HTML file that we believe loads and executes the thumb.db file as a payload, but we cannot be absolutely sure as we do not have the password required to extract the files from the archive.</p>
<p>The decoy opened by the Helminth sample installed by thumb.db (seen in Figure 3) is a dialog box associated with HTML help, which further strengthens our theory that the joboffer.chm ran the sample. This decoy suggests that the threat actors wanted to open the HTML help dialog after installing the Helminth Trojan, as the joboffer.chm file is effectively a standalone HTML file. We believe that the threat actors employed social engineering to underplay the situation and provide a different legitimate job offer if the victim responded with concerns of malicious activity.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Uni41_Figure-3.png" rel="wpdevart_lightbox"><img class="size-large wp-image-13980 aligncenter" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Uni41_Figure-3-500x368.png" alt="OilRig_Uni41_Figure 3" width="500" height="368" /></a></p>
<p style="text-align: center;"><em>Figure 3 A Helminth sample displays this dialog box if provided &#8216;w&#8217; on the command line</em></p>
<p>The executable variant of Helminth is installed with a dropper Trojan that we are tracking as the HerHer Trojan. This Trojan has two objectives: installing embedded Trojans and displaying either a fake error prompt or a fake trubleshooting&#8221; (the malware author misspelled this word in each sample) utility. Figure 4 is an example of the fake error prompt displayed by the HerHer Trojan.</p>
<p style="text-align: center;"><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit42_Figure-4.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-14010" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit42_Figure-4-500x189.png" alt="OilRig_Unit42_Figure 4" width="500" height="189" /></a></p>
<p style="text-align: center;"><em>Figure 4 Fake Error Prompt Displayed by the HerHer Trojan</em></p>
<p>The Helminth executable variant is very similar in functionality to its script-based counterpart, as it also communicates with its C2 server using both HTTP and DNS queries. The major difference in capabilities between the two variants is that the executable version comes with a module that Helminth uses to log keystrokes and the clipboard contents to exfiltrate to the C2 server.</p>
<p>Helminth executable samples send artifacts within network beacons to its C2 server that the Trojan refers to as a Group and Name. We extracted the group and name values from the Helminth executable samples to determine their purpose. It appears that the group values hardcoded into the malware is associated with the targeted organization, as several are Saudi Arabian organizations within the telecommunications and defense industries. This suggests that the threat actors are not only focused on financial organizations, as their target set could include other industries as well.</p>
<p>The name values hardcoded into the Helminth samples are also interesting, as a majority of the names are related to famous philosophers, such as Plato (Greek philosopher), Arasto (Persian and Urdu for Greek philosopher Aristotle), and ALAfghani (Jamal ad-Din al-Afghani, Islamic Philosopher). Other name values embedded in samples contain other Persian words, such as Nafti () that translates to oily, which led us to name this campaign OilRig).</p>
<h3>Helminth Infrastructure</h3>
<p>Examining the known infrastructure of the collected sample set of Helminth provides several interesting findings in regards to the adversarys tactics. The variants leveraging malicious macros embedded in Excel documents all share the same command and control server of go0gie[.]com. The executable variants, on the other hand, used a variety of domains:</p>
<p><em>checkgoogle[.]org</em><br />
<em>mydomain1110[.]com</em><br />
<em>kernel[.]ws</em><br />
<em>mydomain1607[.]com</em><br />
<em>mydomain1609[.]com</em></p>
<p>&nbsp;</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit42_Figure-6.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-14004" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit42_Figure-6-500x544.png" alt="OilRig_Unit42_Figure 6" width="500" height="544" /></a></p>
<p style="text-align: center;"><em>Figure 5 Helminth C2 Infrastructure</em></p>
<p>Each sample of the weaponized Excel document variant used a unique command and control domain to retrieve a bot ID, using the following format:</p>
<p><em>00000000&lt;base 36 of a random number smaller than 46655&gt;30.go0gie[.]com</em></p>
<p>Each of these domains, however, resolved to the same IP address of 5.39.112.87. This IP is observed as the resolution for two domains in use by the portable executable variants, kernel[.]ws and mydomain1110[.]com. Judging by compile timestamps of the executables and last saved timestamps of the weaponized documents, it is likely the adversary is recycling a previously created C2 server at 5.39.112.87 for the newer macro based variant. The other C2 domains and IPs observed in use by the previous portable executable samples did not have shared infrastructure with the newer macro variants, although there is tactical overlap via the naming scheme of the domains.</p>
<p>Historical WHOIS data reveals additional findings, potentially alluding to an Iranian-based operator. From a timeline perspective, a new domain was registered almost in consecutive months, beginning in July 2015. Each of the domains&#8217;s WHOIS data contained registrant information that was either reused, or was closely related to previously used information. For example, the domains mydomain1607[.]com and mydomain1609[.]com used the exact same registrant information. The email address edmundj@chmail[.]ir and the geolocation of Tehran, Iran, being of note. Kernel[.]ws and checkgoogle[.]org used very similar email addresses, andre_serkisian@yahoo[.]com and andre.serkisian@chmail[.]ir, respectively. The registrant information for kernel[.]ws also provided a geolocation of Tehran, IR and the email provider for the address used in checkgoogle[.]org was the same used for mydomain1607[.]com and mydomain1609[.]com, chmail.ir. The mydomain1110[.]com domain did not appear to reuse any of the previously observed WHOIS data artifacts, but did still give a geolocation of Tehran in addition to the use of an email address linked to other domains thematically similar to the know command and control domains and are potentially related.</p>
<p>Although there is heavy use of Iranian-based artifacts within the WHOIS registrant information, it is important to remember that this data is easily falsified. At face value, however, taking into account the registrant information and the use of Persian language in the samples are compelling indicators that the operators may indeed be based out of Iran.</p>
<h3>Conclusion</h3>
<p>While researching the OilRig campaign, we have seen two waves of targeted attacks on Saudi Arabian organizations in which a group of threat actors delivered the Helminth Trojan as a payload. The two waves of attacks used separate variants of the Helminth Trojan, specifically a script and executable variant of the Trojan.</p>
<p>The two variants of Helminth use almost identical command and control protocols, which allows the threat actors to maintain consistent infrastructure throughout the campaign to manage the compromised hosts, regardless of the Helminth variant used in the attack.</p>
<p>The two variants of Helminth do require different delivery methods, with the script variant relying on an Excel spreadsheet for delivery, while the executable variant is more traditional in the fact that it can be installed without a delivery document. We speculate that the executable variant involves threat actors socially engineering the victim into running the payload, rather than installing the payload as the result of successful exploitation of a vulnerability. The multiple delivery methods suggest this threat group is capable of adapting their procedures to suit the current operation in the overarching campaign.</p>
<p>Palo Alto Networks customers are protected from the Helminth Trojan and can gather additional information using the following tools:</p>
<ul>
<li>WildFire detection of all known samples as malicious</li>
<li>All Helminth C2 domains have DNS signatures created and are identified as malicious in PAN-DB.</li>
<li>AutoFocus tags <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Clayslide" target="_blank">Clayslide</a>, <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Helminth" target="_blank">Helminth</a> and <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.HerHerDropper" target="_blank">HerHerDropper</a>.</li>
</ul>
<h3>Appendix</h3>
<p><strong>Clayslide Delivery Documents</strong></p>
<p>At first, Clayslide spreadsheets display a worksheet called Incompatible that contains instructions for the user to manually enable macros (as seen in Figure 6), as macros are disabled in Excel by default. This is an attempt to trick the user into running the embedded macro to install the Trojan, which does not require any vulnerability exploitation. Figure 6 shows the Protected View alert in Excel informing the user that there is an embedded macro that may cause harm to the system.</p>
<p style="text-align: center;"><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit42_Figure-7.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-14001" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit42_Figure-7-500x101.png" alt="OilRig_Unit42_Figure 7" width="500" height="101" /></a></p>
<p style="text-align: center;"><em>Figure 6 Clayslide spreadsheet showing the Incompatible worksheet with instructions to enable macros and Excel displaying its Protected View alert message</em></p>
<p>Before the user can enable the macros in accordance with the instructions displayed in the spreadsheet, the user must click the red bar displayed by Protected View and click the Edit Anyway button, as seen in 7.</p>
<p style="text-align: center;"><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit-42_-figure-8-.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-13998" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/OilRig_Unit-42_-figure-8--500x131.png" alt="OilRig_Unit 42_ figure 8" width="500" height="131" /></a></p>
<p style="text-align: center;"><em>Figure 7 Protected View further mentioning the potential danger with editing the spreadsheet in the ClaySlide sample</em></p>
<p>After clicking the Edit Anyway button, Excel displays another security warning bar alerting that the spreadsheet contains macros, as seen in Figure 8. The Enable Content button mentioned within the instructions displayed within the Clayslide spreadsheet is now presented to the user.</p>
<p><img class="aligncenter size-large wp-image-16960" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/8-500x76.png" alt="8" width="500" height="76" /></p>
<p style="text-align: center;"><em>Figure 8 Excel security warning with the Enable Content button mentioned in Incompatible worksheet</em></p>
<p>If the user clicks the Enable Content button, the macro hides the Incompatible worksheet and makes hidden worksheets visible that displays decoy content to minimize the victims suspicions of malicious behavior taking place. Figure 9 below shows the decoy content displayed by macros within a Clayslide sample, specifically showing the status of internal network IP addresses that fit with the service provider social engineering theme used throughout the attack campaign. Figure 9 also shows that the Incompatible worksheet is no longer visible, as the decoy content is displayed in a worksheet called Sheet1.</p>
<p style="text-align: center;"><img class="aligncenter size-medium wp-image-16963" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/9-230x484.png" alt="9" width="230" height="484" /></p>
<p style="text-align: center;"><em>Figure 9 Decoy content displayed after enabling macros within a Clayslide sample</em></p>
<p>After displaying the decoy content, the macro begins installing the script variant of the Helminth Trojan to the system. The process used by the macro to install this variant of Helminth begins with the creation of the following files and folders:</p>
<p>&nbsp;</p>
<p>%PUBLIC%\Libraries\update.vbs<br />
%PUBLIC%\Libraries\dns.ps1<br />
%PUBLIC%\Libraries\up<br />
%PUBLIC%\Libraries\dn<br />
%PUBLIC%\Libraries\tp</p>
<p>The malicious macro finishes the installation process by creating a scheduled task that is responsible for running the two scripts at regular intervals, as the scripts themselves do not have the ability to continually run after the initial execution. The following code snippet within the macro creates a scheduled task named GoogleUpdateTaskMachineUI that will run the update.vbs script every three minutes:</p>
<p>wss.Run &#8220;schtasks /create /F /sc minute /mo 3 /tn &#8221; &amp; Chr(34) &amp; &#8220;GoogleUpdateTaskMachineUI&#8221; &amp; Chr(34) &amp; &#8221; /tr &#8221; &amp; wss.ExpandEnvironmentStrings(&#8220;%PUBLIC%&#8221;) &amp; &#8220;\Libraries\update.vbs&#8221;, 0</p>
<h2>Helminth Script Variant</h2>
<p>The script variant of the Helminth Trojan consists of a VBScript and PowerShell script named update.vbs and dns.ps1. We aptly named this variant the script version, as we found another version of this Trojan that we will discuss later in this Appendix. The update.vbs script is responsible for reaching out to its command and control (C2) server using HTTP requests to the following two URLs:</p>
<p>hxxp://go0gIe.com/sysupdate.aspx?req=&lt;random number&gt;%5Cdwn&amp;m=d<br />
hxxp://go0gIe.com/sysupdate.aspx?req=&lt;random number&gt;%5Cbat&amp;m=d</p>
<p>The C2 server will respond to the HTTP requests to the bat&amp;m=d URL with a batch script that update.vbs will save to the dn folder and execute. The output of the downloaded batch script is saved to a text file in the up folder and uploaded to the C2 server via an HTTP POST request to the following URL:</p>
<p>hxxp://go0gIe.com/sysupdate.aspx?req=&lt;random number&gt;%5Cupl&amp;m=u</p>
<p>Palo Alto Networks WildFire observed commands provided by the C2 server for the known Helminth samples. The commands, as seen below, show that the threat actors are attempting to do initial information gathering on the system, including available user accounts, username, computer name, running tasks, services, network services and if remote desktop is enabled.</p>
<p>whoami &amp; hostname &amp; ipconfig /all &amp; net user /domain 2&gt;&amp;1 &amp; net group /domain 2&gt;&amp;1 &amp; net group &#8220;domain admins&#8221; /domain 2&gt;&amp;1 &amp; net group &#8220;Exchange Trusted Subsystem&#8221; /domain 2&gt;&amp;1 &amp; net accounts /domain 2&gt;&amp;1 &amp; net user 2&gt;&amp;1 &amp; net localgroup administrators 2&gt;&amp;1 &amp; netstat -an 2&gt;&amp;1 &amp; tasklist 2&gt;&amp;1 &amp; sc query 2&gt;&amp;1 &amp; systeminfo 2&gt;&amp;1 &amp; reg query &#8220;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default&#8221; 2&gt;&amp;1</p>
<p>The update.vbs concludes by running the dns.ps1 PowerShell script. The dns.ps1 script is also responsible for communicating with the C2 server, but it uses DNS queries to send data to the server. The DNS queries sent by this script are queries to subdomains on the same domain as the C2 server, which contains system information or the contents of files from the system. The subdomain of the DNS request that acts as the initial C2 beacon has the following structure:</p>
<p>00000000&lt;base 36 of a random number smaller than 46655&gt;30</p>
<p>The dns.ps1 script checks the response to this DNS query and uses the first octet of the resolving IP address as an identifier for the compromised system. The script then uses this identifier in a follow up DNS request to a subdomain with the following structure:</p>
<p>00&lt;identifier&gt;00000&lt;base36 of a random number smaller than 46655&gt;30</p>
<p>The C2 server will respond to these DNS queries with IP addresses that the script will parse and eventually treat as data to construct a batch script to execute on the system. The script specifically looks for the IP address 33.33.x.x to mark the beginning of the batch script transfer. Upon receipt of this IP address, the script uses the last two octets of this IP address as a filename for the batch file that it saves to the tp folder that was initially created by the macro. Once the batch file name is obtained, the script will continue sending additional DNS requests and use the octets of the resolving IP addresses as characters to write to the batch script. The script continues writing characters to the batch script until it receives the IP address 35.35.35.35 that notifies the script to stop saving data to the file and to run the batch script.</p>
<p>The output of the downloaded batch file is saved to %PUBLIC%\Libraries\tp\&lt;batch filename&gt;.txt. The script will then upload the output of this batch file by including the data in a sequence of DNS queries. The exfiltrates the output of the batch script by splitting up the data within the text file into chunks up to 23 bytes and sends the data within a series of DNS queries that have the following structure:</p>
<p>00&lt;identifier&gt;&lt;filename of batch file without its extension&gt;&lt;base36 of sequence number&gt;&lt;base36 of a random number smaller than 46655&gt;&lt;up to 23 bytes of data from batch script output&gt;</p>
<p>Both the update.vbs and dns.ps1 both provide a fully functional remote shell to the actors, which allow the actor to carry out any activities on the compromised system they wish.</p>
<h2>Helminth Executable Variant</h2>
<p>The executable variant of Helminth is installed with a Trojan that we are tracking as the HerHer Trojan. The HerHer Trojan saves several files to the file system upon execution to install the Helminth Trojan to the system.</p>
<ul>
<li>%APPDATA%\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\Certificate Managment.lnk</li>
<li>%APPDATA%\Roaming\Microsoft\Windows\Start Menu\Programs\Certificate.ico</li>
<li>%APPDATA%\Roaming\Microsoft Temperary\adbmanager.exe</li>
<li>%APPDATA%\Roaming\Microsoft Temperary\adbtray.exe</li>
<li>%APPDATA%\Local\Temp\acro\Users\config.txt</li>
<li>%PUBLIC%\Libraries\~Windows\wintrust.hlm</li>
</ul>
<p>The Certificate Managment.lnk shortcut uses the Certificate.ico file for its icon, as seen in Figure 10.</p>
<p><img class="aligncenter wp-image-17179 size-full" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/10-1.png" width="179" height="179" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/05/10-1.png 179w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/05/10-1-150x150.png 150w" sizes="(max-width: 179px) 100vw, 179px" /></p>
<p style="text-align: center;"><em>Figure 10 Icon file used</em></p>
<p>Additionally, it has a comment of herher, which is basis of the droppers name. Helminth relies on the following shortcut for persistence, as it runs the Trojan each time the system starts using the following command line:</p>
<p>&#8220;C:\Users\Rick James\AppData\Roaming\Microsoft Temperary\adbmanager.exe&#8221; q 1</p>
<p>The adbmanager.exe and adbtray.exe files are the actual Helminth Trojan, both of which are the same executable. The reason for two different filenames is currently unknown. The Helminth Trojan requires arguments on the command-line to execute properly (q in the analyzed sample as seen in the Certificate Managment.lnk shortcut), one of which will run the Trojans functional code and the other can open a dialog box as a decoy.</p>
<p>The Helminth Trojan begins by creating a mutex named [username]ver4.1 and writes its embedded configuration as ciphertext to the following file:</p>
<p>%APPDATA%\Local\Temp\acro\Users\config.txt</p>
<p>The Trojan will later decrypt the contents of this file using the RC4 algorithm, using the MD5 hash of f246b23d-c2d6-45f2-b268-dec30d9adaad as the key. We decrypted the configuration file dropped by Helminth and found the structure of the configuration file is IsAlive,[sleep interval]\r\n[C2 domain]. For example, one Helminth sample had the following data within the config.txt file:</p>
<p>IsAlive,30<br />
checkgoogle.org</p>
<p>The Helminth executable variant is able to run batch scripts provided by the C2 server, which is very similar to the script version of this Trojan. The executable variant has one additional capability that is not present in the script version, which involves the ability to log keystrokes via a supplemental keylogger module.</p>
<p>Helminth loads its keylogger module of the Trojan by loading the wintrust.hlm file dropped by the HerHer Trojan as a DLL and calling its exported function named Initialize. The keylogger that creates a window named kk to monitor both the clipboard and keystrokes and to save the data in cleartext to the file %TEMP%/acro/Users/[GUID from CoCreateGuid]kk.tmp. The keylogger saves the keystrokes and the name of the Window visible while the keys were typed to this file in the following structure:</p>
<p>####T####[Window Name]####ET####<br />
[logged keystrokes]</p>
<p>The wintrust.hlm keylogger logs the contents of the clipboard to the same file, but the clipboard contents do not follow a header that specifies the window name like the other logged keystrokes. The clipboard contents are logged to the file in the following format:</p>
<p>&lt;&lt;&lt; Clipboard &#8212;&gt; [contents of clipboard]&gt;&gt;&gt;</p>
<h2>Helminth Exe C2 Communications</h2>
<p>The Helminth executable is able to communicate with its C2 server via HTTP and via DNS queries in very similar ways to the Helminth script variant. In fact, the DNS beacons follow the same structure and sequence as the script variant of Helminth discussed in the previous section. The main difference between the beacons sent from the two variants of Helminth is the data included within the beacon, as the script variant does not send any system information within the beacons, whereas the executable version sends system and malware specific information within both the HTTP and DNS beacons.</p>
<p>Helminth executables include the system and malware information within HTTP beacons in the Cookie field of the request. Helminth structures the beacon data as follows:</p>
<p>Function=F1; ID=[MD5 of Computer and Username]; Group=[Hardcoded in Malware]; Name=[Hardcoded in Malware]; Service=0;</p>
<p>The Trojan will encrypt this data using RC4 and the MD5 hash of f246b23d-c2d6-45f2-b268-dec30d9adaad as the key and encode the encrypted data using base64. Figure 11 shows a Helminth HTTP beacon with the Cookie field containing the base64 data.</p>
<p><img class="aligncenter wp-image-17173 size-medium" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/11-1-230x62.png" width="230" height="62" /></p>
<p style="text-align: center;"><em>Figure 11 Helminth HTTP C2 beacon</em></p>
<p>Helminth sends data within DNS beacons differently than the HTTP beacons and includes additional information as well. The data within the DNS beacons follows the structure:</p>
<p>&lt;path of folder containing keylogger module&gt;<br />
&lt;path of folder containing key logs and batch script output files&gt;<br />
&lt;group name hardcoded in malware&gt;<br />
&lt;name hardcoded in malware&gt;<br />
&lt;computer name&gt;<br />
&lt;user name&gt;<br />
&lt;sleep interval&gt;<br />
&lt;C2 domain&gt;</p>
<p>The Trojan does not encrypt the data sent via DNS beacons, rather it converts the ASCII characters into their hexadecimal values and includes these values in cleartext. The DNS beacons sent from the Helminth executable have the following structure, which is very similar to the script version:</p>
<p>00&lt;identifier&gt;01&lt;sequence number&gt;&lt;up to 24 hexadecimal values of the ASCII data&gt;</p>
<p>Figure 12 shows an example of the DNS beacons sent from a Helminth executable.</p>
<p><img class="aligncenter wp-image-17182 size-medium" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/05/12-1-230x49.png" width="230" height="49" /></p>
<p style="text-align: center;"><em>Figure 12 Helminth DNS C2 beacon</em></p>
<p>The encoded data within the DNS beacons displayed in Figure 12 decode to the following:</p>
<p>C:\Users\Public\Libraries\~Windows\<br />
C:\Users\Administrator\AppData\Roaming\Microsoft\Internet Explorer\Users\<br />
[redacted company name]<br />
Plato<br />
[Computer Name redacted]<br />
Administrator<br />
30<br />
kernel.ws</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
