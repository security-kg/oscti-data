
<!doctype html>
<html lang="en-US">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preload" href="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/clearbit-autocomplete.css" as="style">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://usageanalytics.coveo.com">
  <link rel="preconnect" href="https://paloaltonetworks.tt.omtrdc.net">
  <link rel="preconnect" href="https://platform.cloud.coveo.com">
  <link rel="preconnect" href="https://assets.adobedtm.com">
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
  <!-- Adobe -->
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {opacity: 0 !important}", 3000));
</script>
<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<!-- End Adobe -->
  
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">

  <!-- Typekit -->
  <!--
  <script src="//use.typekit.net/itd3sep.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>-->
  <!-- End Typekit -->

 


    


<link rel="apple-touch-icon" sizes="57x57" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/manifest.json">
<link rel="mask-icon" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/safari-pinned-tab.svg" color="#8ad3de">
<link rel="shortcut icon" href="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/assets/images/icons/favicon.ico">
<meta name="msapplication-TileImage" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/mstile-144x144.png">
<meta name="msapplication-config" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/browserconfig.xml">
<meta name="msapplication-TileColor" content="#da532c">




  <!-- Start WP HEAD -->
  <link rel="alternate" hreflang="en" href="https://blog.paloaltonetworks.com/2013/08/parasites-android-malware-discovered-by-wildfire/" />

	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Parasites Android Malware Discovered by WildFire</title>
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://blog.paloaltonetworks.com/2013/08/parasites-android-malware-discovered-by-wildfire/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Parasites Android Malware Discovered by WildFire" />
	<meta property="og:description" content="On July 16, 2013, Palo Alto Networks WildFire detected a new kind of Android malware that we have named Parasites. We will use this post to provide some technical details around this &hellip;" />
	<meta property="og:url" content="https://blog.paloaltonetworks.com/2013/08/parasites-android-malware-discovered-by-wildfire/" />
	<meta property="og:site_name" content="Palo Alto Networks Blog" />
	<meta property="article:published_time" content="2013-08-27T22:29:57+00:00" />
	<meta property="article:modified_time" content="2013-08-28T16:23:15+00:00" />
	<meta property="og:image" content="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1-230x125.png" />
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Feed" href="https://blog.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Comments Feed" href="https://blog.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Parasites Android Malware Discovered by WildFire Comments Feed" href="https://blog.paloaltonetworks.com/2013/08/parasites-android-malware-discovered-by-wildfire/feed/" />
<meta property="og:date_created" content="August 27, 2013 at 3:29 PM"/>
<meta property="og:post_image" content=""/>
<meta property="og:post_id" content="3792"/>
<meta property="og:post_total_likes" content="0"/>
<meta property="og:post_length" content="2120"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category_link" content="https://blog.paloaltonetworks.com/category/malware-2/"/>
<meta property="og:author" content="Zhi Xu"/>
<meta property="og:authorloginname" content="Zhi Xu"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/zhi-xu/"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:section" content="Palo Alto Networks"/>
<meta property="og:recent_views" content="265"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Parasites Android Malware Discovered by WildFire","name":"Parasites Android Malware Discovered by WildFire","description":"On July 16, 2013, Palo Alto Networks WildFire detected a new kind of Android malware that we have named Parasites. We will use this post to provide some technical details around this &hellip;","url":"https:\/\/blog.paloaltonetworks.com\/2013\/08\/parasites-android-malware-discovered-by-wildfire\/","mainEntityOfPage":"https:\/\/blog.paloaltonetworks.com\/2013\/08\/parasites-android-malware-discovered-by-wildfire\/","datePublished":"August 27, 2013","articleBody":"On July 16, 2013, Palo Alto Networks WildFire detected a new kind of Android malware that we have named Parasites. We will use this post to provide some technical details around this family of malware to benefit our customers, the security industry and other malware researchers. The malware was detected as part of a repackaged app named \u201cSystemApp Remover\u201d and a legitimate version of this app is available for sale on the Google Play Store for $1.02. The package name of the detected malware sample is com.danesh.system.app.remover, and its package signer is \u201cAndroid\u201d.\r\nBased on analysis from WildFire, the malware sample seems to be distributed by a mobile advertising company in China, named WinAds. Since WinAds does not have its own app store, it is likely that this malware was promoted by WinAds and was pushed to the user.\r\nCompared with the legitimate app, we observed that the repackaged APK file includes two independent payload APK files hidden in the \/lib folder. The file names are \u201c\/lib\/ s.pcb\u201d and \u201c\/lib\/c.pcb\u201d. Unlike other Android malware families, the author did not intend to install these two APK files. Instead, the malware APK will dynamically load these two payload files when receiving certain system broadcast intents (e.g., when the user unlock the screen).\r\nThe s.pcb and c.pcb work independently. The file s.pcb specializes in SMS interception and sending SMS in the background, while c.pcb controls file download management, displaying ads, and tricking the user into installing downloaded APK files. That is the reason we named the malware Parasites, as the two payload APK files are attached to the \u201cvictim\u201d APK file through the added launcher codes.\r\nRepackaging technique\r\nThe Parasites sample shows a template to add or remove a payload APK. It also shows an interesting trend of Android malware. The attacker can easily attach a malicious APK file to a legitimate app APK. Further, the same launcher code can be reused to repackage other victim APK files without any changes. This capacity allows the attacker to generate a large number of malicious APK files very easily.\r\nIn Figure 1, we show a comparison of AndroidManifest.xml files of the legitimate APK file (on the left) and that of the repackaged APK file (on the right).\u00a0 The attacker simply appends the following contents after the original content:\r\n\r\n\r\n\tThe broadcast receiver \u201ccom.slcc.tls.cofer\u201d is used to start the service \u201ccom.slcc.tls.cfqws\u201d which will load the APK file c.pcb dynamically;\r\n\tThe broadcast receiver \u201ccom.slcm.hqa.snbgr\u201d is used to start the service \u201ccom.slcm.hqa.soiqs\u201d which will load the APK file s.pcb dynamically\r\n\tThe added permissions are permissions claimed by c.pcb and s.pcb ;\r\n\tCompared to the legitimate app, the malware author changes the app version code from \u201c42\u201d to \u201c42108\u201d\r\n\r\n\r\nFigure 1. The AndroidManifest.xml of legitimate app (on the left) v.s. the AndroidManifest.xml of Parasites sample (on the right). The red circled parts are changed by the malware author.\r\nIn Figure 2, we show the (reversed) source code of the legitimate APK file downloaded from Google Play (on the left) and the repackaged APK file (on the right). As shown in the figure, the source code of malware sample is highly obfuscated. However, the organization of Parasites is still neat and straightforward.\r\n\r\n\r\n\tThe package com.slcc.tls is the interface to start package com.clg.sc which acts as the interface to launch and control the APK file c.pcb.\r\n\tThe package com.slcm.hqa is the interface to start package com.cgm.sm which acts as the interface to launch and control the APK file s.pcb. The package com.slc.tools is used to start an instance of SManager defined in package com.cgm.sm.\r\n\r\n\r\nFigure 2. The comparison of source codes: the original APK file (on the left) v.s. the repackaged APK file (on the right)\r\nThe attack functions are provided by s.pcb and c.pcb. As these two APK files work independently, we discuss the technical details of both APK files separately.\r\nPayload APK s.pcb \u00a0(the SMSIntercept)\r\ns.pcb is an complete and independent APK file but it is not signed. By reversing the APK file, the package name is \u201ccom.lcq.sm\u201d. The s.pcb will be loaded when the user unlock the touchscreen (i.e. android.intent.action.USER_PRESENT), or when smartphone connects to a WiFi network (i.e., android.net.conn.CONNECTIVITY_CHANGE), or when a new app is installed on the smartphone (i.e., android.intent.action.PACKAGE_ADDED). The app name is \u201cSMSIntercept\u201d.\r\n\r\nFigure 3. AndroidManifest.xml of s.pcb.\r\nThe s.pcb APK has the following key functions:\r\n\r\n\r\n\tSend SMS with the infected device ID to a designated phone number controlled by remote attack website.\r\n\tBlock incoming SMS messages and log the intercepted SMS contents in a database file.\r\n\tMaintain a command and control channel with the attacker through the Internet\r\n\r\nSend SMS To Designated Phone Number \r\nAfter being loaded, s.pcb first communicates with the url http:\/\/sm1.wombin.com\/pages\/ExistsMobile.ashx to request the receiver phone number. The returned results are in the format of JSON object. Figure 4 shows an example of these results:\r\n[{ \"ErrorType\":\"E1\",\"PhoneNum\":\"13708333433;\",\"RequestTimes\":\"40;\",\"NextRequestTime\":\"123\"}]\r\nWith the received information, the APK will first save the received information in the file \u201c\/data\/data\/com.danesh.system.app.remover\/shared_prefs\/sm.xml\u201d, as shown in Figure 4.\r\n\r\nFigure 4. The sm.xml that contains the specifications for sending SMS messages and the Icon of s.pcb.\r\nThen, the malware APK composes a SMS message that includes the infected device\u2019s ID as content, and sends the SMS in the background to the number provided by the malicious URL. \u00a0Every time the s.pcb APK\u00a0 is loaded, it will attempt to send a SMS message.\r\nBlock incoming SMS and log the intercepted SMS contents in database files\r\ns.pcb monitors the intents broadcasted on the infected device. The SMS interceptor is implemented in class \u201ccom.lcq.sm.ISR\u201d. When the intent \u201candroid.provider.Telephony.SMS_RECEIVED\u201d is received, the s.pcb will first check the content of received SMS message with criteria stored in sm.db file. If there is a match, the s.pcb will log the received SMS in the database file sm.db, and then block the broadcast by calling the BroadcastReceiver.abortBroadcast() function, so that the user will never see the incoming SMS.\u00a0The structure of sm.db file is shown in Figure 5.\r\n\r\nFigure 5. Structure of sm.db\r\nCommand &amp; Control\r\ns.pcb implements its communication functions in the com.lcq.sm.k class. One interesting feature is that, the s.pcb not only uploads the phone\u2019s information to the attacker, it also uploads the host APK file information to the attacker (i.e. com.danesh.system.app.remover in this sample). We believe the attacker is attempting to build a botnet with different types of repackaged APK files. The host APK file information is used for management of different APK files.\r\nSpecifically, the communication functions include:\r\n\r\n\r\n\tDownload initial data, such as the phone number to send SMS\r\n\r\n\tURL connecting to : http:\/\/sm1.wombin.com\/pages\/ExistsMobile.ashx\r\n\r\n\r\n\tDownload instruction data\r\n\r\n\tURL connecting to : http:\/\/sm1.wombin.com\/pages\/MobileApply.ashx\r\n\r\n\r\n\tUpload phone information to remote server\r\n\r\n\tURL connecting to : http:\/\/smup1.wombin.com:9998\/smup.action\r\n\tUploaded information include:\r\n\r\n\tDevice id (i.e. imei in this sample)\r\n\tappkey: the \u201cSM_KEY\u201d embedded in the AndroidManifest.xml of Parasites APK file. Used to identify the host APK file this s.pcb lives in\r\n\thost app name: i.e. com.danesh.system.app.remover in this sample.\r\n\r\n\r\n\r\n\r\n\r\nPayload APK c.pcb (the DownloadManager)\r\nc.pcb is also an unsigned APK file. By reversing the APK file, its package name is \u201ccom.ulk.app\u201d. The intents are exactly the same as those seen in s.pcb. As such c.pcb is loaded when the user unlocks the touchscreen (i.e. android.intent.action.USER_PRESENT), or when the device connects to a WiFi network (i.e., android.net.conn.CONNECTIVITY_CHANGE), or when a new app is installed on the device (i.e., android.intent.action.PACKAGE_ADDED). The app name is \u201cTest App\u201d when we managed to install it separately.\r\n\r\nFigure 6. AndroidManifest.xml of c.pcb.\r\nThe c.pcb APK acts like aggressive adware, providing the following functions:\r\n\r\n\r\n\tFile download management\r\n\tPushing ads to phone\r\n\tTrick the user to install the downloaded APK files by sending notification messages.\r\n\tKeep a command and control channel with the attacker through Internet\r\n\r\nDownload Management\r\nc.pcb downloads files with a given address and saves the APK file on the SD card. Further, all the downloading records are saved in a database file located in \u201c\/data\/data\/com.danesh.system.app.remover\/databases\/LDownload.db\u201d file. The structure of this file is as shown in Figure 7.\r\n\r\nFigure 7. The LDownload.db file kept by c.pcb.\r\nPush Ads to Phone\r\nc.pcb allows the attacker to send promotions to the device and display the them via the notification service. In c.pcb, the promotion information is called \u201cad\u201d and each ad is uniquely identified by a gid. \u00a0The titles and images displayed in notification messages are also sent from the attacker. To keep track of these types of \u201cads\u201d, c.pcb maintains a database file in the \u201c\/data\/data\/com.danesh.system.app.remover\/databases\/lock.db\u201d file. In this file, detailed information is logged as shown in Figure 8.\r\n\r\nFigure 8. The lock.db file that keeps all the promotion information (the gid is the unique id of each entity)\r\nPush APK files to user by notifications\r\nc.pcb does not claim the permission to install the downloaded APK files directly. Instead, we observed that the malware attempts to trick the user by sending notifications. c.pcb provides two types of notifications, one is through the standard notifications bar on the top of screen, and the other is by popping up an AlertDialog. For example, class com.lsc.sc.f builds an AlertDialog object with the message in the Dialog as \u201cYou have downloaded apps that have not been installed yet\u201d.\u00a0 By default, when the user attempts to open a downloaded APK file, the Android OS will consider this action as \u201cattempting to install this file\u201d. The system app will handle the installation.\u00a0 This saves the APK installation task and the corresponding security permission for the c.pcb.\r\nCommand &amp; Control\r\nc.pcb communicates with wombin.com, and we observed the following actions:\r\n\r\n\r\n\tCheck if the local gids are still valid\r\n\r\n\tURL connecting to: http:\/\/toget1.wombin.com:6011\/ucheckvalid.do . The list of local gids will be uploaded for validation.\r\n\r\n\r\n\tUpload phone information to remote server\r\n\r\n\tURL connecting to : http:\/\/toreport1.wombin.com:6012\/upostdata.do\r\n\tUploaded information include:\r\n\r\n\tDevice ID (i.e. imei in this sample)\r\n\tappkey: the \u201cSM_KEY\u201d embedded in the AndroidManifest.xml of Parasites APK file. Used to identify the host APK file this s.pcb lives in\r\n\tHost app name: i.e. com.danesh.system.app.remover in this sample.\r\n\tCurrent Android OS model\r\n\r\n\r\n\r\n\r\n\tRegain information of a gid from remote website:\r\n\r\n\tURL connecting to : http:\/\/toget1.wombin.com:6011\/uregetad.do\r\n\tThe gid will be uploaded\r\n\r\n\r\n\tDebug purpose:\r\n\r\n\tURL connecting to : http:\/\/toget1.wombin.com:6011\/getadDebug.do\r\n\r\n\r\n\tUpload the local ads promotion statistic information:\r\n\r\n\tURL connection to: http:\/\/toupdate1.wombin.com:6013\/ukup.do\r\n\tThe uploaded information include:\r\n\r\n\tDevice ID\r\n\tAppkey\r\n\tpname: the intent used to launch the p.pcb.\r\n\tsvion : c.pcb version (value is 1 in the current sample)\r\n\tHost app name\r\n\tAndroid OS model,\r\n\tNetwork name (e.g. ChinaMobile)\r\n\tgids and their counts.\r\n\r\n\r\n\r\n\r\n\r\nDiscussion\r\nThe Parasites sample shows a good example about how to attach independent APK files to a host APK file. It allows the attacker to convert an existing benign app (e.g. a task management app) into an attack app, and then attach its APK file to any host APK file. The attached APK files will be loaded dynamically and run independently from the host APK file. This allows the attacker to make sophisticated repackaged APK files more easily and efficiently.\r\nTo this end, we show the organization of folder \/data\/data\/com.danesh.system.app.remover , which keeps all the information related to the attack. \u00a0The sc.dex and sc.jar correspond to c.pcb. The s.jar and s.dex correspond to s.pcb.\r\n\r\nFigure 9 The organization of local storage maintained by Parasites. \r\nMalware sample availability \r\nThe sha256 value of detected malware APK file is\r\nee46d769baaef9df06554ef140c7881de977eeb1701e24c54635c2815f668186.\r\nAs on Aug 21, 2013, the APK file URL is still valid at\r\nhttp:\/\/down.winads.cn\/winads\/ad\/adAPK\/130715203948.APK","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Zhi Xu"}]}</script>		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.paloaltonetworks.com\/wp-includes\/js\/wp-emoji-release.min.js"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/css/styles.css' type='text/css' media='all' />
<style id='contact-form-7-inline-css' type='text/css'>
.wpcf7 .wpcf7-recaptcha iframe {margin-bottom: 0;}.wpcf7 .wpcf7-recaptcha[data-align="center"] > div {margin: 0 auto;}.wpcf7 .wpcf7-recaptcha[data-align="right"] > div {margin: 0 0 0 auto;}
</style>
<link rel='stylesheet' id='dashicons-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dashicons.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-menu-item-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/menu-item/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='sage/css-css'  href='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/styles/main.css' type='text/css' media='all' />
<script>if (document.location.protocol != "https:") {document.location = document.URL.replace(/^http:/i, "https:");}</script><script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-3.5.1.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-migrate-1.4.1.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js'></script>
<link rel='https://api.w.org/' href='https://blog.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://blog.paloaltonetworks.com/?p=3792' />
<link rel="alternate" type="application/json+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2013%2F08%2Fparasites-android-malware-discovered-by-wildfire%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2013%2F08%2Fparasites-android-malware-discovered-by-wildfire%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:180,186,114,3,12,9,81,84,87,129,138,6,162;" />
  <script>var $ = jQuery;</script>
    <!-- Unit42 Scripts -->
  <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  <!-- End Unit42 Scripts -->
<meta name="google-site-verification" content="G1onsZ_PNprWXTYsKyATpZKzp8IAJ1jlbavSwUDN5Uo" />
</head>
  <body data-rsssl=1 data-results-per-page="9" class="post-template-default single single-post postid-3792 single-format-standard parasites-android-malware-discovered-by-wildfire sidebar-primary">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <input type="hidden" id="searching" value=""/><header class="container-fluid container-blog sticky-top">
     
      <div class="pan-page-alert pan-page-alert-light">
    		<div class="pan-page-alert-text"><a href="https://www.paloaltonetworks.com/our-response-to-covid-19" data-page-track-value=":en_us: title :covid19" data-page-track="true">See our response to COVID-19</a></div>
    		<button type="button" class="pan-page-alert-close" aria-label="page alert close">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 1L6 6M6 6L11 1M6 6L1 11M6 6L11 11" stroke="#727272" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </button>
		  </div>
    
	
      <div class="container-xl">
        <div class="row">
          <div class="col-logo">
            <a href="https://www.paloaltonetworks.com" class="nav-logo" nav-track="true" nav-track-breadcrumb="nav:logo" aria-label="paloaltonetworks">
              <svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M59.4806 4.69592C57.6725 4.69592 55.7941 5.18876 53.4694 6.43377L54.7609 9.62741C56.7798 8.50019 58.4474 8.00735 59.6687 8.00735C61.0542 8.00735 61.6648 8.52395 61.6648 9.20483V9.25133C61.6648 9.72143 61.2887 9.97974 60.3733 10.0738L58.777 10.238C54.7847 10.6606 53.1409 12.3985 53.1409 14.7934V14.9577C53.1409 17.2359 55.0192 19.0203 57.6725 19.0203C59.4197 19.0203 60.9374 18.2826 61.8601 16.9807L62.1577 18.7857H65.7739V10.5904C65.7739 6.71584 63.5432 4.69592 59.4806 4.69592ZM59.1283 15.8969C57.7903 15.8969 57.1559 15.3803 57.1559 14.5816V14.5351C57.1559 13.8305 57.5547 13.3139 59.0105 13.1031L59.6449 13.0091C60.5717 12.8799 61.141 12.7095 61.6648 12.3923V13.4317C61.6648 15.0052 60.6781 15.8969 59.1283 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M25.4785 4.78994L20.8529 0.164276L16.2272 4.78994L18.5281 7.09192L6.92834 18.6917L11.554 23.3174L16.1797 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M11.6001 0.164063L0 11.7642L4.62603 16.3902L16.2262 4.79009L11.6001 0.164063Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M27.7795 7.09215L16.1793 18.6923L20.8054 23.3183L32.4055 11.7182L27.7795 7.09215Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M72.2314 0H68.1223V18.7857H72.2314V0Z" fill="black" class="logo-text"></path>
                <path d="M46.2362 4.69592C44.3681 4.69592 42.8679 5.52249 42.0424 6.81709L41.7283 4.93046H38.1121V23.4806H42.2211V17.051C43.0033 18.2567 44.4828 19.0193 46.2362 19.0193C49.5238 19.0193 52.2009 16.1077 52.2009 12.0916V11.6215C52.2009 7.60853 49.5238 4.69592 46.2362 4.69592ZM47.974 11.9759C47.974 14.0888 46.8705 15.6159 45.0387 15.6159C43.2068 15.6159 42.1033 14.0898 42.1033 11.9759V11.7414C42.1033 9.62741 43.2068 8.10137 45.0387 8.10137C46.8705 8.10137 47.974 9.62741 47.974 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M138.709 5.54211V5.47185C138.709 5.07304 138.404 4.79097 137.864 4.79097H136.924V6.9514H137.371V6.22299H137.867L138.24 6.9514H138.733L138.274 6.09694C138.553 6.01119 138.709 5.80248 138.709 5.54211ZM137.37 5.18979H137.863C138.145 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.144 5.82418 137.863 5.82418H137.37V5.18979Z" fill="black" class="logo-text"></path>
                <path d="M137.77 3.63997C136.502 3.63997 135.539 4.60292 135.539 5.87066C135.539 7.1384 136.502 8.10135 137.77 8.10135C139.037 8.10135 140 7.1384 140 5.87066C140 4.60292 139.037 3.63997 137.77 3.63997ZM137.77 7.79552C136.666 7.79552 135.868 6.99685 135.868 5.86963C135.868 4.7424 136.666 3.94373 137.77 3.94373C138.873 3.94373 139.672 4.7424 139.672 5.86963C139.672 6.99685 138.873 7.79552 137.77 7.79552Z" fill="black" class="logo-text"></path>
                <path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="black" class="logo-text"></path>
                <path d="M116.518 15.6159C115.321 15.6159 114.875 15.029 114.875 13.7613V8.10136H119.712V4.93148H114.875V1.76057L110.766 2.3712V14.159C110.766 17.3764 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="black" class="logo-text"></path>
                <path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M81.2247 4.69592C77.0216 4.69592 74.0625 7.6075 74.0625 11.6236V12.0937C74.0625 16.1087 77.0216 19.0213 81.2247 19.0213C85.4278 19.0213 88.3869 16.1097 88.3869 12.0937V11.6236C88.3858 7.60853 85.4278 4.69592 81.2247 4.69592ZM84.159 11.9759C84.159 14.0888 83.0555 15.6159 81.2236 15.6159C79.3918 15.6159 78.2883 14.0898 78.2883 11.9759V11.7414C78.2883 9.62741 79.3918 8.10137 81.2236 8.10137C83.0555 8.10137 84.159 9.62741 84.159 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M98.0448 22.1168H99.0976L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0253 23.5312H99.0109V25.4964H98.0448V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M102.816 22.1168H105.771L105.81 22.9372H103.826V23.4011H105.385V24.1491H103.826V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="black" class="logo-text"></path>
                <path d="M110.943 22.1168H112.024L112.574 24.4632H112.628L113.342 22.1168H114.333L115.032 24.4632H115.086L115.626 22.1168H116.66L115.771 25.4964H114.443L113.826 23.4589H113.797L113.168 25.4964H111.836L110.943 22.1168Z" fill="black" class="logo-text"></path>
                <path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.258 23.8071C120.258 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.915 24.7391 120.258 24.3909 120.258 23.8071Z" fill="black" class="logo-text"></path>
                <path d="M122.364 22.1168H124.334C125.232 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.45 24.2369 125.015 24.4105L125.816 25.4974H124.668L124.045 24.6089H123.378V25.4974H122.364V22.1168ZM124.203 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.203 22.933H123.377V23.8164H124.203Z" fill="black" class="logo-text"></path>
                <path d="M126.989 22.1168H128.003V23.3628H128.418L129.408 22.1168H130.548L130.553 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.003V25.4964H126.989V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M131.402 25.2743V24.3475H131.407C131.972 24.6326 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3464 133.425 24.3031 132.701 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.913 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.387 22.84 132.952 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5405 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.953 25.5884C132.364 25.5884 131.895 25.4675 131.402 25.2743Z" fill="black" class="logo-text"></path>
              </svg>
            </a>
            <a href="https://blog.paloaltonetworks.com" class="nav-lockup active" >Blog</a>
          </div>
          <div class="col col-mobile">
            <button class="nav-toggle closed" id="nav-mobile-toggle">
              <svg class="menu-dashes open" width="21" height="16" viewBox="0 0 21 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="18.8125" y1="1.5" x2="1.5" y2="1.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="8" x2="1.5" y2="8" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="14.5" x2="1.5" y2="14.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
              <svg class="menu-x close" width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
                <span class="mobile-menu">Menu</span>
            </button>
          </div>
            <nav class="col col-navbar navbar" id="nav-mobile">
                <ul>
                    <li class="menu-item-home"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
                                            
                    <li class="menu-item-object-net_sec_post">
                        <a href="https://blog.paloaltonetworks.com/network-security/">Network Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sase_post">
                        <a href="https://blog.paloaltonetworks.com/sase/">SASE</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-cloud_sec_post">
                        <a href="https://blog.paloaltonetworks.com/prisma-cloud/">Cloud Native Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sec_ops_post">
                        <a href="https://blog.paloaltonetworks.com/security-operations/">Security Operations</a>
                    </li>
                    
                                        <li>
                <div class="search"  id="form-search">
                    <input type="text" name="search" autocomplete="off" id="postSearch1" placeholder="Search the Blog" />
                  
                    <button id="nav-search-open-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <path d="M8.66675 15.3335C12.3487 15.3335 15.3335 12.3487 15.3335 8.66675C15.3335 4.9848 12.3487 2 8.66675 2C4.9848 2 2 4.9848 2 8.66675C2 12.3487 4.9848 15.3335 8.66675 15.3335Z" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M18.0007 18.0001L13.3784 13.3778" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  
                  <button id="nav-search-close-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                      <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                    </svg>
                  </button>
                  
                </div>
              </li>
                </ul>
                        </nav>
          
            
        </div>
      </div>
    </header>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js"></script>-->
<script type="text/javascript">
    var main_nav_active_class = '';
    var main_nav_menu_item_name = 'menu-item-home';
    var str_subscription = '<div class="container-fluid container-newsletter-signup" >\
    <div class="container-lg">\
        <div class="row no-gutters row-newsletter-signup">\
            <div class="col-12 col-md-5 col-newsletter-signup-header">\
                <h2>Get updates!</h2>\
                <p class="lead">Sign up to receive the latest news</p>\
            </div>\
            <div class="col-12 col-md-7 col-newsletter-signup-form">\
                <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate="" class="subscribe-form clearfix" name="Unit42_Subscribe" id="subscribe_form1">\
                    <input type="hidden" value="subscribe-unit42" name="FormName">\
    <input id="field14" type="hidden" name="Qualifying_Campaign__c" value="70170000000lBnb">\
                         <input type="hidden" value="1086" name="formid">\
                         <input type="hidden" value="531-OCS-018" name="munchkinId">\
                         <input type="hidden" value="19887" name="lpId">\
                         <input type="hidden" value="1086" name="formVid">\
                         <input type="hidden" name="mkto_opt-in" value="true">\
                <div class="row no-gutters row-newsletter-signup-input">\
                    <div class="col-10 col-sm-11 col-newsletter-signup-input">\
                        <input type="email" name="Email" placeholder="Enter your email" id="input-newsletter-signup" class="subscribe-field rounded business_email" autocomplete="off">\
                    </div>\
                    <div class="col-2 col-sm-1 col-newsletter-signup-button">\
                        <button type="submit" value="Subscribe" disabled="disabled">\
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none">\
                            <path d="M1 6L14.3333 6" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            <path d="M9.33301 1L14.333 6L9.33301 11" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            </svg>\
                        </button>\
                    </div>\
                </div>\
                <div class="email_invalid_msg">Please enter a valid email.</div>\
                <div class="row row-legal-disclaimer">\
                    <div class="col-12 col-legal-disclaimer">\
                        <p class="legal-disclaimer">By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>\
                    </div>\
                </div>\
                <div class="row row-recatcha d-none" id="row-recatcha">\
                    <div class="col-12 col-recatcha text-sm-center">\
                        <div id="captcha_container" class="google-recapth"></div>\
                    </div>\
                </div>\
                </form>\
            </div>\
        </div>\
    </div>\
</div>';
</script>
<article class="container-feed-master " id="main-container">
   <!--<div class="container-fluid container-breadcrumb"  data-aos="fade-in">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
			          </ol>
        </nav>
    </div>-->
    
    <div class="container-fluid container-feed-article">
      <div class="container-lg">
        <div class="row row-feed-filters article-container container-inner" data-aos="fade-in" >
            <h1 class="blog-title">Parasites Android Malware Discovered by WildFire</h1>
              <div class="col-xs-12 col-sm-6 col-md-8 col-lg-8 col-xl-9 pad-0">
                   <div class="tags-item">
                    <a href="https://blog.paloaltonetworks.com/category/malware-2/">Malware</a>                    
                    <a href="https://blog.paloaltonetworks.com/tag/android/" rel="tag">Android</a><a href="https://blog.paloaltonetworks.com/tag/apk/" rel="tag">APK</a><a href="https://blog.paloaltonetworks.com/tag/wildfire/" rel="tag">WildFire</a>                  </div>
              </div>
              <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-3 pad-0 mobile-links">
                   <ol class="react-items">
                    <li>
				
				
				4,082
			 people reacted</li>
                    <li class="line"></li>
                    <li>
                      <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'3792','like')">
                          <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                          </svg>
                          <span>0</span>
                      </div>
                    </li>
                  </ol>
              </div>
              <div class="container-lg author-desc-row">
                <div class="col-8 author-desc">
                  <div class="metadata-thumbnail" >
                                          <div class="metadata-thumbnail-author" style="background-image: url('https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg')">
                                          </div>      
                  </div>
                  <div class="metadata-author" >
                    <span class="author-name">By <a href="https://blog.paloaltonetworks.com/author/zhi-xu/" title="Posts by Zhi Xu" class="author url fn" rel="author">Zhi Xu</a></span><br /> 
                      <time datetime="2013-08-27T22:29:57+00:00">August 27, 2013 at 3:29 PM</time><br />
                      11 min. read
                  </div>
                </div>
                <!--<div class="col-6 social-items">
                      <span class="links">
                        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                        </svg>
                      </span>
                      <span class="links">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </span>
                </div>-->
                <div class="col-4 social-items">
                  <div class="links">
                      <a href="http://feeds.feedburner.com/PaloAltoNetworks" target="_blank"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                    </svg>
                    </a>
                  </div>
                  <div class="links">
                    <div class="dropdown dropup">
                      <a href="#!" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </a>

                      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <div class="share-dropdown">
                          <p><strong>SHARE</strong></p>
                          <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.paloaltonetworks.com%2F2013%2F08%2Fparasites-android-malware-discovered-by-wildfire%2F" target="_blank">
                          <i class="fa fb-icon fa-facebook-official pop-up-icon" aria-hidden="true"></i></a>
                          
                          <a href="https://twitter.com/home?status=https%3A%2F%2Fblog.paloaltonetworks.com%2F2013%2F08%2Fparasites-android-malware-discovered-by-wildfire%2F+-+Parasites+Android+Malware+Discovered+by+WildFire" target="_blank"><i class="fa tw-icon fa-twitter pop-up-icon" aria-hidden="true"></i></a>
                          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2013%2F08%2Fparasites-android-malware-discovered-by-wildfire%2F&title=Parasites+Android+Malware+Discovered+by+WildFire&summary=&source=" target="_blank"><i class="fa lindn-icon fa-linkedin pop-up-icon" aria-hidden="true"></i></a>
                          <a href="//www.reddit.com/submit?url=https://blog.paloaltonetworks.com/2013/08/parasites-android-malware-discovered-by-wildfire/" target="_blank"><i class="fa blog-icon fa-stumbleupon-circle pop-up-icon" aria-hidden="true"></i></a>
                          
                          </div>                       
                        </div>
                      </div>
                    </div>
                </div>
              </div>
              <div class="entry-content article-description"><p style="text-align: left;" align="center">On July 16, 2013, Palo Alto Networks WildFire detected a new kind of Android malware that we have named <em>Parasites</em>. We will use this post to provide some technical details around this family of malware to benefit our customers, the security industry and other malware researchers. The malware was detected as part of a repackaged app named <i>SystemApp Remover</i> and a legitimate version of this app is available for sale on the Google Play Store for $1.02. The package name of the detected malware sample is <i>com.danesh.system.app.remover</i>, and its package signer is <i>Android</i>.</p>
<p style="text-align: left;">Based on analysis from WildFire, the malware sample seems to be distributed by a mobile advertising company in China, named WinAds. Since WinAds does not have its own app store, it is likely that this malware was promoted by WinAds and was pushed to the user.</p>
<p style="text-align: left;">Compared with the legitimate app, we observed that the repackaged APK file includes two independent payload APK files hidden in the /lib folder. The file names are /lib/ s.pcb and /lib/c.pcb. Unlike other Android malware families,<span id="more-3792"></span> the author did not intend to install these two APK files. Instead, the malware APK will dynamically load these two payload files when receiving certain system broadcast intents (e.g., when the user unlock the screen).</p>
<p style="text-align: left;">The <i>s.pcb</i> and <i>c.pcb</i> work independently. The file <i>s.pcb</i> specializes in SMS interception and sending SMS in the background, while <i>c.pcb</i> controls file download management, displaying ads, and tricking the user into installing downloaded APK files. That is the reason we named the malware <i>Parasites,</i> as the two payload APK files are attached to the victim APK file through the added launcher codes.</p>
<p style="text-align: left;"><b>Repackaging technique</b></p>
<p style="text-align: left;">The <i>Parasites</i> sample shows a template to add or remove a payload APK. It also shows an interesting trend of Android malware. The attacker can easily attach a malicious APK file to a legitimate app APK. Further, the same launcher code can be reused to repackage other victim APK files without any changes. This capacity allows the attacker to generate a large number of malicious APK files very easily.</p>
<p style="text-align: left;">In Figure 1, we show a comparison of <i>AndroidManifest.xml</i> files of the legitimate APK file (on the left) and that of the repackaged APK file (on the right). The attacker simply appends the following contents after the original content:</p>
<ul style="text-align: left;">
<li>The broadcast receiver com.slcc.tls.cofer is used to start the service com.slcc.tls.cfqws which will load the APK file <i>c.pcb</i> dynamically;</li>
<li>The broadcast receiver com.slcm.hqa.snbgr is used to start the service com.slcm.hqa.soiqs which will load the APK file <i>s.pcb</i> dynamically</li>
<li>The added permissions are permissions claimed by <i>c.pcb</i> and <i>s.pcb</i> ;</li>
<li>Compared to the legitimate app, the malware author changes the app version code from 42 to 42108</li>
</ul>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1.png"><img class="wp-image-3795 alignnone" alt="figure1" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1-230x125.png" width="230" height="125" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1-230x125.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1-500x273.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1-510x279.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1-73x40.png 73w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/figure1.png 1061w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 1. The AndroidManifest.xml of legitimate app (on the left) v.s. the AndroidManifest.xml of Parasites sample (on the right). The red circled parts are changed by the malware author.</em></p>
<p style="text-align: left;">In Figure 2, we show the (reversed) source code of the legitimate APK file downloaded from Google Play (on the left) and the repackaged APK file (on the right). As shown in the figure, the source code of malware sample is highly obfuscated. However, the organization of <i>Parasites</i> is still neat and straightforward.</p>
<ul style="text-align: left;">
<li>The package <i>com.slcc.tls</i> is the interface to start package <i>com.clg.sc</i> which acts as the interface to launch and control the APK file <i>c.pcb</i>.</li>
<li>The package <i>com.slcm.hqa</i> is the interface to start package <i>com.cgm.sm</i> which acts as the interface to launch and control the APK file <i>s.pcb</i>. The package <i>com.slc.tools</i> is used to start an instance of <i>SManager</i> defined in package <i>com.cgm.sm</i>.</li>
</ul>
<p style="text-align: left;"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure2.png"><img class="size-medium wp-image-3796 alignnone" alt="Figure2" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure2-230x93.png" width="230" height="93" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure2-230x93.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure2-500x202.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure2-510x206.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure2-98x40.png 98w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure2.png 727w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 2. The comparison of source codes: the original APK file (on the left) v.s. the repackaged APK file (on the right)</em></p>
<p style="text-align: left;">The attack functions are provided by s.pcb and c.pcb. As these two APK files work independently, we discuss the technical details of both APK files separately.</p>
<p style="text-align: left;"><b>Payload APK <i>s.pcb</i> (the <i>SMSIntercept</i>)</b></p>
<p style="text-align: left;">s<i>.pcb</i> is an complete and independent APK file but it is not signed. By reversing the APK file, the package name is <i>com.lcq.sm</i>. The s<i>.pcb</i> will be loaded when the user unlock the touchscreen (i.e. android.intent.action.USER_PRESENT), or when smartphone connects to a WiFi network (i.e., android.net.conn.CONNECTIVITY_CHANGE), or when a new app is installed on the smartphone (i.e., android.intent.action.PACKAGE_ADDED). The app name is SMSIntercept.</p>
<p style="text-align: left;"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure3.png"><img class="size-medium wp-image-3797 alignnone" alt="Figure3" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure3-230x97.png" width="230" height="97" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure3-230x97.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure3-500x212.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure3-510x216.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure3-94x40.png 94w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure3.png 1125w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 3. AndroidManifest.xml of s.pcb.</em></p>
<p style="text-align: left;">The s.pcb APK has the following key functions:</p>
<ul style="text-align: left;">
<li>Send SMS with the infected device ID to a designated phone number controlled by remote attack website.</li>
<li>Block incoming SMS messages and log the intercepted SMS contents in a database file.</li>
<li>Maintain a command and control channel with the attacker through the Internet</li>
</ul>
<p style="text-align: left;"><b>Send SMS To Designated Phone Number </b></p>
<p style="text-align: left;">After being loaded, s.pcb first communicates with the url <strong>http://sm1.wombin.com/pages/ExistsMobile.ashx</strong> to request the receiver phone number. The returned results are in the format of JSON object. Figure 4 shows an example of these results:</p>
<p style="text-align: left;" align="center"><i>[{ &#8220;ErrorType&#8221;:&#8221;E1&#8243;,&#8221;PhoneNum&#8221;:&#8221;13708333433;&#8221;,&#8221;RequestTimes&#8221;:&#8221;40;&#8221;,&#8221;NextRequestTime&#8221;:&#8221;123&#8243;}]</i></p>
<p style="text-align: left;">With the received information, the APK will first save the received information in the file /data/data/com.danesh.system.app.remover/shared_prefs/sm.xml, as shown in Figure 4.</p>
<p style="text-align: left;"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure4.png"><img class="size-medium wp-image-3798 alignnone" alt="Figure4" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure4-230x64.png" width="230" height="64" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure4-230x64.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure4-500x139.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure4-510x142.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure4-142x40.png 142w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure4.png 693w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 4. The sm.xml that contains the specifications for sending SMS messages and the Icon of s.pcb.</em></p>
<p style="text-align: left;">Then, the malware APK composes a SMS message that includes the infected devices ID as content, and sends the SMS in the background to the number provided by the malicious URL. Every time the <i>s.pcb</i> APK is loaded, it will attempt to send a SMS message.</p>
<p style="text-align: left;"><b>Block incoming SMS and log the intercepted SMS contents in database files</b></p>
<p style="text-align: left;"><i>s.pcb </i>monitors the intents broadcasted on the infected device. The SMS interceptor is implemented in class <i>com.lcq.sm.ISR</i>. When the intent <i>android.provider.Telephony.SMS_RECEIVED</i> is received, the <i>s.pcb</i> will first check the content of received SMS message with criteria stored in <i>sm.db</i> file. If there is a match, the s.pcb will log the received SMS in the database file <i>sm.db</i>, and then block the broadcast by calling the <i>BroadcastReceiver</i>.<i>abortBroadcast</i>() function, so that the user will never see the incoming SMS.The structure of <i>sm.db</i> file is shown in Figure 5.</p>
<p style="text-align: left;" align="center"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure5.png"><img class="size-medium wp-image-3799 alignnone" alt="Figure5" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure5-230x71.png" width="230" height="71" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure5-230x71.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure5-500x154.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure5-510x157.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure5-129x40.png 129w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure5.png 878w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;" align="center"><em>Figure 5. Structure of sm.db</em></p>
<p style="text-align: left;"><b>Command &amp; Control</b></p>
<p style="text-align: left;"><i>s.pcb</i> implements its communication functions in the <i>com.lcq.sm.k</i> class. One interesting feature is that, the s.pcb not only uploads the phones information to the attacker, it also uploads the host APK file information to the attacker (i.e. <i>com.danesh.system.app.remover</i> in this sample). We believe the attacker is attempting to build a botnet with different types of repackaged APK files. The host APK file information is used for management of different APK files.</p>
<p style="text-align: left;">Specifically, the communication functions include:</p>
<ul style="text-align: left;">
<li>Download initial data, such as the phone number to send SMS
<ul>
<li>URL connecting to : http://sm1.wombin.com/pages/ExistsMobile.ashx</li>
</ul>
</li>
<li>Download instruction data
<ul>
<li>URL connecting to : http://sm1.wombin.com/pages/MobileApply.ashx</li>
</ul>
</li>
<li>Upload phone information to remote server
<ul>
<li>URL connecting to : http://smup1.wombin.com:9998/smup.action</li>
<li>Uploaded information include:
<ul>
<li>Device id (i.e. imei in this sample)</li>
<li>appkey: the SM_KEY embedded in the AndroidManifest.xml of <i>Parasites</i> APK file. Used to identify the host APK file this s.pcb lives in</li>
<li>host app name: i.e. <i>com.danesh.system.app.remover</i> in this sample.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p style="text-align: left;"><b>Payload APK <i>c.pcb </i>(the <i>DownloadManager</i>)</b></p>
<p style="text-align: left;">c<i>.pcb</i> is also an unsigned APK file. By reversing the APK file, its package name is <i>com.ulk.app</i>. The intents are exactly the same as those seen in <i>s.pcb</i>. As such c<i>.pcb</i> is loaded when the user unlocks the touchscreen (i.e. android.intent.action.USER_PRESENT), or when the device connects to a WiFi network (i.e., android.net.conn.CONNECTIVITY_CHANGE), or when a new app is installed on the device (i.e., android.intent.action.PACKAGE_ADDED). The app name is Test App when we managed to install it separately.</p>
<p style="text-align: left;"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure6.png"><img class="size-medium wp-image-3800 alignnone" alt="Figure6" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure6-230x90.png" width="230" height="90" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure6-230x90.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure6-500x197.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure6-510x201.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure6-101x40.png 101w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure6.png 1125w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 6. AndroidManifest.xml of c.pcb.</em></p>
<p style="text-align: left;">The c.pcb APK acts like aggressive adware, providing the following functions:</p>
<ul style="text-align: left;">
<li>File download management</li>
<li>Pushing ads to phone</li>
<li>Trick the user to install the downloaded APK files by sending notification messages.</li>
<li>Keep a command and control channel with the attacker through Internet</li>
</ul>
<p style="text-align: left;"><b>Download Management</b></p>
<p style="text-align: left;"><i>c.pcb</i> downloads files with a given address and saves the APK file on the SD card. Further, all the downloading records are saved in a database file located in <i>/data/data/com.danesh.system.app.remover/databases/LDownload.db</i> file. The structure of this file is as shown in Figure 7.</p>
<p style="text-align: left;"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure7.png"><img class="size-medium wp-image-3801 alignnone" alt="Figure7" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure7-230x59.png" width="230" height="59" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure7-230x59.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure7-500x128.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure7-510x131.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure7-155x40.png 155w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure7.png 1125w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 7. The LDownload.db file kept by c.pcb.</em></p>
<p style="text-align: left;"><b>Push Ads to Phone</b></p>
<p style="text-align: left;"><i>c.pcb</i> allows the attacker to send promotions to the device and display the them via the notification service. In <i>c.pcb</i>, the promotion information is called <i>ad</i> and each <i>ad</i> is uniquely identified by a <i>gid</i>. The titles and images displayed in notification messages are also sent from the attacker. To keep track of these types of ads, <i>c.pcb</i> maintains a database file in the /data/data/com.danesh.system.app.remover/databases/lock.db file. In this file, detailed information is logged as shown in Figure 8.</p>
<p style="text-align: left;"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure8.png"><img class="size-medium wp-image-3802 alignnone" alt="Figure8" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure8-230x129.png" width="230" height="129" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure8-230x129.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure8-500x281.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure8-510x286.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure8-71x40.png 71w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure8.png 637w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 8. The lock.db file that keeps all the promotion information (the gid is the unique id of each entity)</em></p>
<p style="text-align: left;"><b>Push APK files to user by notifications</b></p>
<p style="text-align: left;"><i>c.pcb</i> does not claim the permission to install the downloaded APK files directly. Instead, we observed that the malware attempts to trick the user by sending notifications. <i>c.pcb</i> provides two types of notifications, one is through the standard notifications bar on the top of screen, and the other is by popping up an <i>AlertDialog</i>. For example, class <i>com.lsc.sc.f</i> builds an <i>AlertDialog</i> object with the message in the Dialog as <i>You have downloaded apps that have not been installed yet</i>. By default, when the user attempts to open a downloaded APK file, the Android OS will consider this action as attempting to install this file. The system app will handle the installation. This saves the APK installation task and the corresponding security permission for the <i>c.pcb</i>.</p>
<p style="text-align: left;"><b>Command &amp; Control</b></p>
<p style="text-align: left;"><i>c.pcb</i> communicates with <i>wombin.com</i>, and we observed the following actions:</p>
<ul style="text-align: left;">
<li>Check if the local <i>gids</i> are still valid
<ul>
<li>URL connecting to: <strong>http://toget1.wombin.com:6011/ucheckvalid.do</strong> . The list of local <i>gids</i> will be uploaded for validation.</li>
</ul>
</li>
<li>Upload phone information to remote server
<ul>
<li>URL connecting to : http://toreport1.wombin.com:6012/upostdata.do</li>
<li>Uploaded information include:
<ul>
<li>Device ID (i.e. imei in this sample)</li>
<li>appkey: the SM_KEY embedded in the AndroidManifest.xml of <i>Parasites</i> APK file. Used to identify the host APK file this s.pcb lives in</li>
<li>Host app name: i.e. <i>com.danesh.system.app.remover</i> in this sample.</li>
<li>Current Android OS model</li>
</ul>
</li>
</ul>
</li>
<li>Regain information of a <i>gid</i> from remote website:
<ul>
<li>URL connecting to : <strong>http://toget1.wombin.com:6011/uregetad.do</strong></li>
<li>The <i>gid</i> will be uploaded</li>
</ul>
</li>
<li>Debug purpose:
<ul>
<li>URL connecting to : <strong>http://toget1.wombin.com:6011/getadDebug.do</strong></li>
</ul>
</li>
<li>Upload the local ads promotion statistic information:
<ul>
<li>URL connection to: <strong>http://toupdate1.wombin.com:6013/ukup.do</strong></li>
<li>The uploaded information include:
<ul>
<li>Device ID</li>
<li>Appkey</li>
<li><i>pname</i>: the intent used to launch the p.pcb.</li>
<li><i>svion</i> : <i>c.pcb</i> version (value is 1 in the current sample)<i></i></li>
<li>Host app name</li>
<li>Android OS model,</li>
<li>Network name (e.g. ChinaMobile)</li>
<li><i>gids</i> and their counts.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p style="text-align: left;"><b>Discussion</b></p>
<p style="text-align: left;">The <i>Parasites</i> sample shows a good example about how to attach independent APK files to a host APK file. It allows the attacker to convert an existing benign app (e.g. a task management app) into an attack app, and then attach its APK file to any host APK file. The attached APK files will be loaded dynamically and run independently from the host APK file. This allows the attacker to make sophisticated repackaged APK files more easily and efficiently.</p>
<p style="text-align: left;">To this end, we show the organization of folder <i>/data/data/com.danesh.system.app.remover</i> , which keeps all the information related to the attack. The <i>sc.dex</i> and <i>sc.jar </i>correspond to <i>c.pcb</i>. The <i>s.jar</i> and <i>s.dex</i> correspond to <i>s.pcb</i>.</p>
<p style="text-align: left;"><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure9.png"><img class="size-medium wp-image-3803 alignnone" alt="Figure9" src="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure9-230x292.png" width="230" height="292" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure9-230x292.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure9-31x40.png 31w, https://blog.paloaltonetworks.com/wp-content/uploads/2013/08/Figure9.png 272w" sizes="(max-width: 230px) 100vw, 230px" /></a></p>
<p style="text-align: left;"><em>Figure 9 The organization of local storage maintained by Parasites<b>. </b></em></p>
<p style="text-align: left;"><b>Malware sample availability </b></p>
<p style="text-align: left;">The sha256 value of detected malware APK file is</p>
<p style="text-align: left;" align="center">ee46d769baaef9df06554ef140c7881de977eeb1701e24c54635c2815f668186.</p>
<p style="text-align: left;">As on Aug 21, 2013, the APK file URL is still valid at</p>
<p style="text-align: left;" align="center">http://down.winads.cn/winads/ad/adAPK/130715203948.APK</p>
</div>
            </div>

        </div>       
    </div>
  </article>


<script type="text/javascript">
    $('body').on('mouseover', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#FF2E00');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
      });
      $('body').on('mouseout', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#000000');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
      });
      
    $(document).ready(function(){
        //Moving single post page subscribe box one paragraph above from last
        var cont_width = $(".entry-content").width();
        cont_width = Math.round(cont_width/2);//
        var p_tag_found = false;
        var child_count = $( ".entry-content").children().length;
        var last_p_tag = ''; //2nd p tag 
        var p_tag_traverse_cnt = 0;
        var p_arr = [];
        var next_tag_is_image_container = false;
        for(var i = 0; i < child_count ; i++){
            var p_el = $('.entry-content').children().eq(i);
            /*
            var tag_name = $(p_el).prop('tagName');
            if(tag_name != 'UL' || tag_name == 'P'){
                continue
            }
            */
            
              var temp_text = $(p_el).html();
              temp_text = temp_text.trim();
              
              
              var found_in_child = $( p_el ).find( "img, iframe, video, figure" );
                
              if(temp_text == '&nbsp;' || temp_text == ''){
                 continue;
              }
              else{
                  p_arr.push(p_el);
              }
        }
        console.log(p_arr);
        

        $.each(p_arr, function (index,value) {
            
            if(next_tag_is_image_container){
                next_tag_is_image_container = false;
                return;
            }
            
            var found_img1 = $(p_arr[index]).find( "img, iframe, video, figure" );//finding any image
            var found_txt1 = $(p_arr[index]).text().trim();
            if(found_img1.length != 0 && found_txt1 == ''){//if image exists inside paragraph, with no sibling text
                return;
            }
                
                var p_el = value;
                var current_tag_name = $(p_el).prop('tagName');
                if(current_tag_name == 'IMG' || current_tag_name == 'IFRAME' || current_tag_name == 'VIDEO' || current_tag_name == 'FIGURE'){
                    return;
                }
              
              
                  p_tag_traverse_cnt++;
                  var next_of_p = p_arr[index+1];
                  var next_tag = $(next_of_p).prop('tagName');
                  
                  
                  if(p_tag_traverse_cnt == 3){
                      //If next element is UL, then add subscription box after UL
                      
                      //if next element is image or video, add the box after 3rd paragraph
                      
                      if(next_tag == 'IMG' || next_tag == 'IFRAME' || next_tag == 'VIDEO' || next_tag == 'FIGURE'){
                          //Check if image is not right aligned
                          var img_width = $(next_of_p).width();
                          
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                          
                      }
                      //Check if image or video exist as a child element
                      var found_in_child = $( next_of_p ).find( "img, iframe, video, figure" );
                      //console.log(found_in_child[0].width);
                      //console.log(found_in_child);
                      if(found_in_child.length != 0){
                             var img_width = found_in_child[0].width;
                             console.log(img_width+" "+cont_width);
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                      }
                      
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;    
                      }
                      else{
                          last_p_tag = p_el;
                          return false;    
                      }
                      
                  }    
                  if(p_tag_traverse_cnt > 3){
                       //If next element is UL, then add subscription box after UL
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;     
                      }
                      else{
                          last_p_tag = p_el;
                          return false;   
                      }
                  }
              
        });
        
        
        if(last_p_tag != ''){
            $( last_p_tag ).after('<div style="clear:both;"></div>',$('.subscribe-form-inner'));
        }
        // $( ".entry-content p:last-child" ).before($('.subscribe-form-inner'));
        
    });
    $('a').each(function() {
        if(this.id == 'share_btn'){
            return;
        }
        var a = new RegExp('/' + window.location.host + '/');
        if(!a.test(this.href)) {
            $(this).click(function(event) {
                event.preventDefault();
                event.stopPropagation();
                window.open(this.href, '_blank');
            });
        }
     });
     $('.comment-form-cookies-consent input[type=checkbox]').prop('checked','checked');
     //$('.form-submit input[type=submit]').after( '<img class="ajax-loader" style="display:none;" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/backgrounds/ajax-loader.gif" alt="Sending ...">' );
     //Hide manage subscription link
     
     if($('.subscribe-to-comments input[type=checkbox]').length == 0){
         $('.subscribe-to-comments').hide();
     }
     
          $('.form-submit input[type=submit]').attr('disabled',true);
          function enableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',false);
     }
     function disableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',true);
     }
    </script>
<div id="search-result-continer" style="display:none;min-height: 343px;">
    <!--<div id="search-result-heading" class="container-fluid container-breadcrumb"  data-aos="fade-in" style="display:none;">
       <div class="container-lg">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
              <li class="breadcrumb-item search-term"></li>
          </ol>
        </nav>
       </div>
    </div>-->
    <div class="container-fluid container-feed-cards">
        <div class="container-lg">
            <div class="row row-feed">
                <div class="col col-feed">
                    
                    <div id="ajax_loader" class="text-center pb-40 pt-40">
                  <span>Loading...</span>
			</div>
      <div id="notfound2" class="text-center pt-40 pb-40" style="display: none;">Sorry, no results were found.</div>
      
                    <div class="row row-feed articles_container CoveoResultList" data-layout="list" data-wait-animation="fade" data-fields-to-include="@articlecategory, @articleauthor, @articlepublishedtime, @articlecategory, @articleauthorlink, @articledescription, @articlepostimage, @articlepublishedtimestring, @articleauthorimagelink, @articlepostid, @articlepostlength, @articlecategorylink, @uri" data-result-container-selector='#test_id' id="test_id">
                        <script id="customTemplate" type="text/underscore" class="result-template">
            <% JSON.stringify(raw) %>
              <article data-article-id="<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>" class="feed-card h-100 pan-coveo-search-list">
                <%if (typeof raw.articlepostimage =='undefined') { 
                    raw.articlepostimage = 'https://blog.paloaltonetworks.com/wp-content/uploads/2016/11/blog-generic-banner-1.jpg';
                 } %>
                        
                <%if (typeof raw.articlepostimage !='undefined') { %> 
                <div onclick="location.href='<%= raw.uri %>'" class="feed-card-thumbnail" style="background-image: url(<%= raw.articlepostimage %>);">
                <% if(typeof raw.articlepostid !== "undefined") { %>
                <!--<div class="total_number_view left-bottom"><span class="people-reacted<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>">#</span> people reacted</div>-->
                <% } %>
                  
                </div>
                <% } %>

                <div class="feed-card-content">
                <p class="label">
                <%  _.each(raw.articlecategory,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %>  href="<% if(typeof raw.articleauthorimagelink !== "undefined"){ print(raw.articlecategorylink[key]); } else{ print("#");}  %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articlecategory.length) { %>,<%  } %><%  }); %>
                            </p>
                  <h3><a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> class="CoveoResultLink"><% var title_article = title.substr(0,75); print(title_article); var title_length = title.length; if(title_length > 75){print("...")} %></a></h3>
                  </div>
                  
                  <div class="feed-card-metadata">
			<div class="metadata-thumbnail">
			<div class="metadata-thumbnail-author">
	  		<img src="<% if(typeof raw.articleauthorimagelink !== "undefined"){ var image_link = raw.articleauthorimagelink[0]; if(image_link.indexOf("unit42.paloaltonetworks.com") != -1 ){ print("https://blog.paloaltonetworks.com/wp-content/themes/PaloAltoNetworksBlog/dist/images/unit42-logo1.jpg");} else{ print(image_link);} }else{ print("https://blog.paloaltonetworks.com/wp-content/uploads/2016/10/Social_BlogIcon_10.13.16.png"); } %>" width="75" height="75" alt="Avatar" class="avatar avatar-75 wp-user-avatar wp-user-avatar-75 photo avatar-default">			</div>
		</div>
		
		<div class="metadata-author">
                    <span class="author-name">
				By <%  _.each(raw.articleauthor,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> title="Posts by <%= item %>" href="<%= raw.articleauthorlink[key] %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articleauthor.length) { %><%if (key+1 == raw.articleauthor.length-1) { %> and <% } else { %>,<% } } %><%  }); %>                        <br>
                        <time datetime="<%= raw.articlepublishedtimestring %>"><%= raw.articlepublishedtimestring %></time>
                        <br>
                       <% if(typeof raw.articlepostlength !== "undefined"){ print(Math.ceil(raw.articlepostlength/200) + " min. read"); } %>
                    
                    </span>
		</div>
    <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked" onclick="<%  print("alter_ul_post_values(this,'"+ raw.articlepostid +"','like')"); %>">
        
        <svg class=" " width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#727272" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                                <span class="<%  print("article-like-id"+raw.articlepostid);  %>"></span></span>
        
    </div>
	
</div>
              </article>
          </script>
          
                </div>     
                      <div class="col">
	
          <div class="loadmore text-center loadmore_main" style="display: none;">
      <button type="button" class="btn  load_more_btn" data-firstres="0">Load more</button>
    </div>
                    </div>
                      <div class="container" style="display: none;">
  
               

    <!-- Each DOM element with a class starting with "coveo-" (lowercase) is for CSS or alignment purpose only. -->
    <div class='coveo-search-section'>
      <div class="coveo-results-column">
        <!--selected breadcrumb-->
        <div class="CoveoBreadcrumb">
          <div class="coveo-breadcrumb-clear-all" title="Clear All Filters" tabindex="0">
            <div class="coveo-icon coveo-breadcrumb-icon-clear-all"></div>
            <div>Clear </div>
          </div>
        </div>
        <span class="CoveoSort coveo-sort-selection" data-sort-criteria="@articlepublishedtime descending" data-caption="Date"></span>
        <div class="coveo-results-header">
          <div class="coveo-summary-section">
            <span class="CoveoQuerySummary"></span>
          </div>
        </div>
      </div>
    </div>
                      </div>
      
          
            </div>
        </div>            
    </div>
</div>
</div>

<script type="text/javascript">
    document.write(str_subscription);
</script>
<section class="pan-mega-footer">
    <div class="container">
        <div class="row pan-mega-footer-links">
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle1 title baseComponent parbase">
                    <p>Popular Resources</p>
                </div>
                <div class="footerList1 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Blog" href="https://blog.paloaltonetworks.com/">Blog</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Careers" href="https://jobs.paloaltonetworks.com/">Careers</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Communities" href="https://www.paloaltonetworks.com/communities">Communities</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Content Library" href="https://www.paloaltonetworks.com/resources">Content Library</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Cyberpedia" href="https://www.paloaltonetworks.com/cyberpedia">Cyberpedia</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Event Center" href="https://events.paloaltonetworks.com">Event Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Investors" href="https://investors.paloaltonetworks.com/investor-relations/overview/default.aspx">Investors</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Tech Docs" href="https://docs.paloaltonetworks.com/">Tech Docs</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Unit 42" href="https://unit42.paloaltonetworks.com/">Unit 42</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Sitemap" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle2 title baseComponent parbase">
                    <p>Legal Notices</p>
                </div>
                <div class="footerList2 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Privacy" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Trust Center" href="https://www.paloaltonetworks.com/legal-notices/trust-center">Trust Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Documents" href="https://www.paloaltonetworks.com/legal">Documents</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle3 title baseComponent parbase">
                    <p>Account</p>
                </div>
                <div class="footerList3 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Account:Manage Subscriptions" href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a>
                        </li>
                    </ul>
                </div>
                <div class="vulnerabilityHtml html baseComponent parbase">
                    <div style="margin-top: 30px">
                        <a href="https://www.paloaltonetworks.com/security-disclosure" style="color: #C63F24; font-family: Arial,sans-serif; font-size: 14px; font-style: normal; font-weight: normal; line-height: normal">Report a Vulnerability</a>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 footer-social-col">
                <div class="content">                
                    <ul class="list-inline">
                        <li class="list-inline-item">
                            <a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank"><img alt="Facebook" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank"><img alt="Linkedin" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://twitter.com/PaloAltoNtwks" target="_blank"><img alt="Twitter" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.youtube.com/user/paloaltonetworks" target="_blank"><img alt="Youtube" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg"></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
<footer class="pan-footer">
    <div class="container">
        <span><p>&copy; 2020 Palo Alto Networks, Inc. All rights reserved.<br></p>
        </span>
    </div>
</footer>
<div class="CoveoSearchbox" data-enable-search-as-you-type="false" data-enable-omnibox="true" data-omnibox-timeout="1000" data-placeholder="Search the blog" data-enable-query-suggest-addon="false" data-trigger-query-on-clear="true" id="pan-coveo-input" style="display: none;"></div>



<script type="text/javascript">
    jQuery('body').attr('data-pipeline', "New Research Center Pipeline");
    var timerIsCoveoDefined = '';
    var resultTotalCount;
    //var root = document.getElementById('coveo-container');
    var root = document.body;
    var isloadCoveoLibraryCalled = false;
    var screenwidth = window.screen.width;
    var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
    var topSearch = true;
    //Coveo code
    function loadCoveoLibrary() {
        if (isloadCoveoLibraryCalled) {
            return;
        }
        isloadCoveoLibraryCalled = true;
        $.getScript("https://static.cloud.coveo.com/searchui/v2.3679/js/CoveoJsSearch.Lazy.min.js");
        timerIsCoveoDefined = setInterval(isCoveoDefined, 1000);
    }
    function isCoveoDefined() {
        if (typeof Coveo !== 'undefined') {
            console.log("Coveo object is now defined.")
            executeCoveoSearch();
            clearInterval(timerIsCoveoDefined);
            $('#postSearch1, #postSearch2').attr('title', '');
            $('#postSearch1, #postSearch2').prop("readonly", false);
            $('.dropdown-menu a').css('pointer-events','auto');
        }
    }
    function executeCoveoSearch() {

        var settings = {
            "async": false,
            "url": "https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/coveosearch.getaccesstoken.php",
            //"url": "https://www.paloaltonetworks.com/apps/pan/public/coveosearch.getaccesstoken.json",
            "method": "GET",
        }


        jQuery.ajax(settings).done(function (response) {

            Coveo.SearchEndpoint.endpoints['default'] = new Coveo.SearchEndpoint({
                restUri: 'https://platform.cloud.coveo.com/rest/search',
                queryStringArguments: {
                    organizationId: 'paloaltonetworksintranet'                    
                },
                accessToken: response.token
            });
            Coveo.$$(root).on("querySuccess", function (e, data) {
                //console.log(data.query.q);
                if(!$('#searching').val()){
                    topSearch = false;
                }
                
                if(topSearch){
                    $([document.documentElement, document.body]).animate({
                        scrollTop: 0 
                    }, 1000);
                }
                
                if(topSearch){
                    $('nav.navbar li a.active').removeClass('active');
                }
                resultTotalCount = data.results.totalCount;
                //document.title = "Palo Alto Networks Blog";
                /*
                if(resultTotalCount > 0){
                    $('#search-result-heading .search-term').text(capitalizeFirstLetter(data.query.q));
                    $('#search-result-heading').show();
                }
                else{
                    $('#search-result-heading').hide();
                    $('#search-result-heading .search-term').text('');
                }
                */

            });
            Coveo.$$(root).on("newResultsDisplayed", function (e, args) {
                $('#ajax_loader').hide();
                $('#notfound2').hide();
                $('.load_more_btn').html('Load more');
                $('.load_more_btn').prop('disabled', false);
                $('.CoveoResult').addClass('col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 col-feed-card grid-item');
                var article_ids = new Array();
                jQuery.each(jQuery('.pan-coveo-search-list'), function (i) {
                    var article_id_tmp = $(this).data("article-id");
                    if (article_id_tmp != '' && !jQuery(this).hasClass('num-like-retrieved')) {
                        article_ids.push(article_id_tmp);
                    }
                    if (article_id_tmp != '') {
                        //If this article is liked, make the thumb icon to blue
                        var article_liked_list = [];
                        var like_found = $.inArray(article_id_tmp, article_liked_list);
                        if (like_found != -1) {
                            $(this).find('.ldc-ul_cont').find('svg').children('path').attr('stroke', '#FF2E00');
                            $(this).find('.ldc-ul_cont').removeClass('idc_ul_cont_not_liked');
                        }
                    }
                });
                if (article_ids.length > 0) {
                    var saveData = $.ajax({
                        type: 'POST',
                        url: wp_vars.ajax_url,
                        data: {action: 'fetch_total_article_likes', article_ids_arr: JSON.stringify(article_ids)},
                        dataType: "json",
                        success: function (resultData) {
                            //var article_likes = JSON.parse(resultData);
                            jQuery.each(article_ids, function (i, val) {
                                $('.article-like-id' + val).text(resultData[val][0]);
                                //$('.people-reacted'+val).text(resultData[val][1]);
                                $('.article-like-id' + val).closest(".pan-coveo-search-list").addClass('num-like-retrieved');
                            });
                        }
                    });
                }
                //console.log($('.CoveoResult').length +'|'+ resultTotalCount);
                //console.log(Coveo.state(root, 'first'));
                if ($('.CoveoResult').length >= resultTotalCount) {
                    $('.load_more_btn').hide();
                } else {
                    $('.load_more_btn').show();
                }
                if (resultTotalCount <= 0) {
                    $('#notfound2').show();
                } else {
                    $('#notfound2').hide();
                }
                
                if (jQuery('.magic-box-input input').val() || $('.CoveoResult').length >= 1) {
                    if(topSearch){
                        jQuery('#main-container').hide();
                        $('#inner_cards').show();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').removeAttr('style');
                        $('#search-result-continer .container-feed-cards .container-lg').removeAttr('style');
                    }
                    else{
                        jQuery('#main-container').show();
                        $('#inner_cards').hide();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').attr('style','padding-bottom: 0;');
                        $('#search-result-continer .container-feed-cards .container-lg').attr('style','padding-top: 0;');
                    }
                } else {
                    jQuery('#search-result-continer').hide();
                    jQuery('.loadmore_main').hide();
                    $('#inner_cards').show();
                    jQuery('#main-container').show();
                    jQuery('.loadmore_main2').show();
                }
            });
            //Coveo.state(root, 'numberOfResults',9);
            //Coveo.state(Coveo.$$(document).find(".magic-box-input input"), 'f:@articlecategory' , 'Secure the Cloud');
            Coveo.SearchInterface.options.autoTriggerQuery.defaultValue = false;
            Coveo.init(root);
        });
    }

    $('body').on('blur', '.magic-box-input input, #postSearch1', function (e) {
        var has_hash = false;
        if (window.location.hash.length) {
            has_hash = true;
        }
        var to_append = '';
        if (has_hash) {
            to_append = window.location.hash.replace('#', '');
            to_append = '#' + to_append;
        }
        window.history.replaceState(null, null, "?search_field=" + $(this).val() + to_append);
    });

    $('.load_more_btn').on('click', function () {
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        load_more_clicked = true;

        var this_btn = $(this);
        $(this).addClass('is-clicked');
        $(this).html('Loading...');
        $(this).prop('disabled', true);
        //jQuery('.articles_container').masonry('reloadItems').masonry();
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        //Coveo.state(root, 'firstResult',$('.CoveoResult').length - 1);
        Coveo.$('.CoveoResultList').coveo('displayMoreResults', 9);
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 9;
        setTimeout(function () {
            this_btn.removeClass('is-clicked');
        }, 1900);
    });
    var interval;
    var timer2;

    if (isIE11) {
        executeCoveoSearch();
    }




    var captcha_rendered = false;
    var subscribeSuccess = false;

    jQuery('body').on('change paste keyup', '.business_email_bot', function () {
        jQuery(this).closest('form').find('.google-recapth').removeClass('d-none');
    });

    $('body').on('mouseover', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#FF2E00');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
    });
    $('body').on('mouseout', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#727272');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
    });




    $(document).ready(function () {
        getSerializedTracking("Unit42_Subscribe");

    });
    $('body').click(function () {
        $('.CoveoDidYouMean').hide();
    });

    jQuery('body').on('change paste keyup', '.business_email', function () {
        //console.log($('#captcha_container2').children().length);
        if ($('#captcha_container').length == 1 && $('#captcha_container').children().length == 0) {
            console.log("cap1");
            var loadCaptcha = function () {
                captchaContainer = grecaptcha.render('captcha_container', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    },
                    'expired-callback' : function(){
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', true);
                        subscribeSuccess = false;
                    }
                });
            }
            loadCaptcha();
        }
        /*
        if ($('#captcha_container2').length == 1 && $('#captcha_container2').children().length == 0) {
            console.log("cap2");
            var loadCaptcha2 = function () {
                captchaContainer = grecaptcha.render('captcha_container2', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='contact_sales_modal'] input[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    }
                });
            }

            loadCaptcha2();
        }
        */
        setTimeout(function () {
            jQuery('#row-recatcha').removeClass('d-none');
            //jQuery('.articles_container').masonry('layout');
        }, 50);
    });


    jQuery('body').on('submit', 'form.subscribe-form', function () {
        var success = true;
        var form = jQuery(this);
        var mail = form.find('input[name="Email"]');
        if (mail.val() === '' || !isEmail(mail.val())) {
            mail.closest("form").addClass('has-error');
            success = false;
        } else {
            mail.closest("form").removeClass('has-error');
        }

        if (success && subscribeSuccess) {
            $.ajax({
                type: 'POST',
                url: form.attr('action'),
                data: form.serialize(),
                success: function (msg) {
                    form.html('<p style="color: #0c6;">You have been successfully subscribed</p>');
                    //masonry.masonry('layout');
                }
            });
        }
        return false;
    });


    function isEmail(email) {
        var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }


    $(document).ready(function () {
        //$('body').attr('data-results-per-page', '9');
        $("#dropdownMenuButton").click(function(){
            if (typeof Coveo === 'undefined') {
                //$(".dropdown-menu a").attr('disabled',"disabled");
                $('.dropdown-menu a').css('pointer-events','none');
                loadCoveoLibrary();
            }
        });
        
        $(".dropdown-menu a").click(function(e){
            $(this).parents(".dropdown").find('.btn').html($(this).text());
            $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
            topSearch = false;
            e.preventDefault(); 
        });
        
        /**
         $('img').each(function() {
         var path = $(this).attr('src');
         $(this).attr('src', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         });
         $('figure').each(function() {
         var path = $(this).attr('style');
         if (typeof path !== 'undefined'){
         $(this).attr('style', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         }
         });
         * 
         */
        
        $(".pan-page-alert-close").click(function(){
            $("#nav-mobile").css("top", "72px");
          });
          $("#feed-clear").click(function(){
              //$('#mostRecentTab').trigger('click');
            $('#postSearch2').val('');
            $('#sec-search-clear').hide();
            jQuery('#search-result-continer').hide();
            jQuery('.loadmore_main').hide();
            $('#inner_cards').show();
            jQuery('#main-container').show();
            jQuery('.loadmore_main2').show();
            $('#main-container .container-feed-cards .container-lg').removeAttr('style');
            
            
            $('.col-feed-filter #dropdownMenuButton').val("Most Recent");
            $('.col-feed-filter #dropdownMenuButton').html("Most Recent");
            $('#mostRecentTab').addClass('coveo-selected');
            $('#mostPopularTab').removeClass('coveo-selected');
         
            
          });
          

        $('#postSearch2').focus(function () {
            if (typeof Coveo === 'undefined') {
                //$('#postSearch1, #postSearch2').attr('title', 'Loading...please wait');
                $('#postSearch1, #postSearch2').prop("readonly", true);
                loadCoveoLibrary();
            }
        });
        $('body').on('keyup', '#postSearch1, #postSearch2', function (e) {
            //cur_search_txt = jQuery('.magic-box-input input').val(); 
            if(this.id == 'postSearch2'){
                topSearch = false;
            }
            else{
                topSearch = true;
            }
            var typed_text;
            if(topSearch){
                typed_text = $('#postSearch1').val();
            }
            else{
                typed_text = $('#postSearch2').val();
                if((typed_text.length > 0) ){
                    $('#sec-search-clear').show();
                    //$('#feed-search').prop('disabled', false);
                }
                else{
                    $('#sec-search-clear').hide();
                    //$('#feed-search').prop('disabled', true);
                }
            }
            
            
            $('.magic-box-input input').val(typed_text);
            if ((typed_text.length > 0) && e.keyCode === 13) {
                if(topSearch && !$('#searching').val()){
                    location.href='https://blog.paloaltonetworks.com?search_field='+typed_text;
                    return;
                }
                //enterKeyPressed = true;
                if (screenwidth < 992) {
                    if(topSearch){
                    mobileToggle();
                }
                }
                $('.CoveoSearchButton').click();
            }
        });
    });
</script>


    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://blog.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#FA582D');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/blog.paloaltonetworks.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/js/scripts.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/popper.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/bootstrap.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/aos.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wp_vars = {"ajax_url":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/masonry2.js?v2'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery.cookie.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-includes/js/wp-embed.min.js'></script>
  </body>
</html>

