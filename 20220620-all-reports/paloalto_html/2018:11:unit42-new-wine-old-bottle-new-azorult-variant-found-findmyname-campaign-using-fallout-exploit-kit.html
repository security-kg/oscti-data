
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit" />
<meta property="og:description" content="New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Azorult" />
<meta property="article:tag" content="Coins" />
<meta property="article:tag" content="Cryptocurrency" />
<meta property="article:tag" content="CVE-2018-8174" />
<meta property="article:tag" content="Electrum" />
<meta property="article:tag" content="Electrum-LTC" />
<meta property="article:tag" content="Ethereum" />
<meta property="article:tag" content="Exodus" />
<meta property="article:tag" content="Fallout Exploit Kit" />
<meta property="article:tag" content="FindMyName" />
<meta property="article:tag" content="Jaxx" />
<meta property="article:tag" content="MultiBitHD" />
<meta property="article:tag" content="Wallet" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2018-11-21T04:00:56+00:00" />
<meta property="article:modified_time" content="2018-12-11T14:41:12+00:00" />
<meta property="og:updated_time" content="2018-12-11T14:41:12+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<meta property="og:image:width" content="600" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit." />
<meta name="twitter:title" content="New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/feed/" />
<meta property="og:likes" content="3"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="19,705"/>
<meta property="og:date_created" content="November 21, 2018 at 6:00 AM"/>
<meta property="og:post_length" content="2938"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Tao Yan"/>
<meta property="og:author" content="Xingyu Jin"/>
<meta property="og:author" content="Bo Qu"/>
<meta property="og:author" content="Zhanglin He"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/tao-yan/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/xingyu-jin/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bo-qu/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/zhanglin-he/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit","name":"New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit","description":"New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit\/","datePublished":"November 21, 2018","articleBody":"Overview\n\nObserved in the wild as early as 2016, Azorult is a Trojan family which has been delivered in malicious macro-based documents via spam campaigns, or as a secondary payload in the RIG Exploit Kit campaigns.\u00a0 On October 20th, 2018 we discovered that new Azorult variants were being used as primary payloads in a new ongoing campaign using the Fallout Exploit Kit. We named this campaign \u2018FindMyName\u2019 because all of the final exploit pages land on the domain findmyname[.]pw. These new Azorult samples variants use advanced obfuscation techniques, such as API flooding and control flow flattening, to evade anti-virus products.\u00a0 Also, we discovered that Azorult has further evolved, the samples we captured support stealing sensitive information in more browsers, applications, and cryptocurrency wallets than previous versions.\n\nIn this blog we will cover the FindMyName campaign, the new Azorult malware, and the obfuscation techniques used.\n\nFirst stage of FindMyName Campaign\n\nOctober 20th is when we first observed the new campaign we are dubbing FindMyName. In the following 3 days, 5 different URL chains, listed in appendix 1, led to the delivery of the Fallout Exploit Kit. All 5 different URL chains redirected victims to one domain, findmyname[.]pw.\n\nThe steps in the first stage of FindMyName campaign are shown in Figure 1.\n\n\nFigure 1 Overview of the first stage of the attack\n&nbsp;\n\nAlthough the 5 final pages in findmyname[.]pw were different, the content of them were similar. An example of the Fallout Exploit Kit landing page is shown in Figure 2.\n\n\nFigure 2 obfuscated landing page\nThe Fallout Exploit Kit uses several html tags such as span, h3, and p to hide the real exploit code with highly obfuscated tag content. After decryption, the real VBScript code exploits an IE VBScript vulnerability CVE-2018-8174 which was patched in August.\n\n&nbsp;\n\n\nFigure 3 Exploit code snippet of CVE-2018-8174 in Fallout Exploit Kit\n&nbsp;\n\nAfter the exploit succeeds, this Fallout Exploit Kit downloads a \u201c.tmp\u201d file to the %Temp% directory and calls CreateProcess to execute it. Further analysis revealed that the \u201c.tmp\u201d file was the latest variant of Azorult malware. It was the first time we\u2019ve seen the new variant of Azorult malware used as primary payload for Fallout Exploit Kit.\n\n&nbsp;\n\nSecond stage of FindMyName Campaign\n\nIn this section, we focus on analyzing the latest variant of Azorult malware we captured.\n\n&nbsp;\n\nMalware Analysis Overview\n\nThe Azorult malware family is a commercial Trojan sold on underground forums. We observed 3 new variants of Azorult malware in the recent FindMyName campaign. When we discovered them, 2 of the 3 samples had not been seen in the wild yet. One of the new Azorult samples we captured and analyzed has the following malicious features (some of these features are explained in detail in the next section):\n\n \tEvades anti-virus emulator through API flooding.\n \tThwarts reverse engineering analysis through a control flow flattening technique.\n \tUses a process hollowing technique to build the new malware image.\n \tSteals credentials, cookies, histories and autofills for more browsers than previous versions.\n \tSteals more cryptocurrency wallets than previous versions.\n \tSteals skype, telegram, steam, FTP client, Email client credentials and chat history when applicable.\n \tHarvests victim\u2019s information via installed programs, screenshots, machine information, user name, OS version and running processes.\n \tCollects files from the user\u2019s Desktop.\n \tAnti-forensic component, cleans up all dropped files.\n \tExecutes specific file(s) initiated by C2 communication.\n\n\nAPI Flooding and Control Flow Flattening Obfuscation\n\nThe initial Azorult malware was written in Microsoft Visual C++ 7.0. First, the Azorult malware attempted to use control flow flattening obfuscation to thwart reverse engineering analysis as shown in Figure 4. Second, the sample used an API Flooding technique as shown in Figure 5. API Flooding is a malware technique to evade anti-virus emulators. For timely performance concerns, anti-virus emulators set a timer when emulating the executable file on the host machine. If the emulator emulates hundreds of time consuming functions, the emulator times out and marks the file as benign.\n\n\nFigure 4 control flow flatten\n\nFigure 5 API flooding\n&nbsp;\n\nProcess Hollowing\n\nAzorult uses a process hollowing technique to build the new malware image. First, the sample decrypts the payload in the memory. Then the sample creates a new suspended process of itself. The sample then injects a decrypted payload to the new process. Lastly, the sample resumes new process execution and\u00a0exhibits malicious behaviors. The overview of the sample execution is shown in Figure 6.\n\n\nFigure 6 Sample process hollowing\n&nbsp;\n\nC2 Communication\n\nThe new trojan file dumped from the process was coded in the Delphi language. When the sample executes, it immediately connects to a C2 server for further instructions. In order to evade Intrusion Prevention Systems (IPS), the C2 traffic is obfuscated. The data sent back to the C2 includes a unique victim ID for each victim\u2019s machine by encoding the machine GUID , Windows product name, user name and computer name with hash algorithm. \u00a0Then the malware decrypts a C2 address and sends a POST request to 51[.]15[.]196[.]30\/1\/index.php with the encrypted victim\u2019s ID. The C2 traffic is shown in Figure 7. The detailed example about hash algorithm and encryption is listed in Appendix 1.\n\n\nFigure 7 C2 request\n&nbsp;\n\nThe sample decrypts and validates the C2 response. The decrypted C2 content had three parts. The part contained inside the &lt;n&gt;&lt;\/n&gt; tags \u00a0contains 48 legit DLLs which are used for information stealing, described in the following sections. The part inside the &lt;d&gt;&lt;\/d&gt; tags contains application information for information stealing: application path, related registry and credential file names. The part in the &lt;c&gt;&lt;\/c&gt; tags contains a C2 configuration for the sample. The C2 configuration is shown in Figure 8. According to pcap analysis, we identified the following characters checked by this sample.\n\n \t\u201c+\u201d: enabling the specific malicious function.\n \t\u201c-\u201d: disabling the specific malicious function.\n \t\u201cI\u201d: collecting host IP info.\n \t\u201cL\u201d: downloading and executing file from remote server.\n\n\nFigure 8 C2 configuration\nMalicious functions specified by C2:\n\n \tSteal browser password credentials.\n \tSteal browser cookies, autofill credentials. Steal credentials from FTP client or Email client.\n \tSteal browser history.\n \tSteal bitcoin wallets.\n \tSteal skype chat message main.db.\n \tSteal telegram credentials.\n \tSteal steam credentials (ssfn) and game metadata (.vdf).\n \tTakes a screenshot that eventually is sent to the attacker.\n \tClean-up the temporary malware files.\n \tCollect files from Desktop.\n \tGet host IP information by sending GET request to ip-api[.]com\/json.\n \tDownload and execute file specified by C2.\n\n&nbsp;\n\nFigure 9 shows an example of C2 configuration for stealing sensitive information from Firefox and Thunderbird.\n\n\nFigure 9 C2 configuration for information stealing\n&nbsp;\n\nThe overview of C2 traffic is shown in Figure 10.\n\n&nbsp;\n\n\nFigure 10 C2 traffic overview\nInformation stealer\n\nThe sample stole credentials and user data from thirty-two browsers including Chrome, Firefox and Qihoo 360. The full list of browsers is in Appendix 2. To steal credentials from browsers, the sample downloaded 48 legitimate dll files from C2 response to %AppData%\\Local\\Temp\\2fda folder as shown in Figure 11.\n\n\nFigure 11 legit dll files\nThe purpose of this action is to load nss3.dll and load the following functions:\n\nsqlite3_open\n\nsqlite3_close\n\nsqlite3_prepare_v2\n\nsqlite3_step\n\nsqlite3_column_text\n\nsqlite3_finalize\n\nNSS_Init\n\nPK11_GetInternalKeySlot\n\nPK11_Authenticate\n\nPK11SDR_Decrypt\n\nNSS_Shutdown\n\nPK11_FreeSlot\n\nThese functions are used to dump sensitive browser information. For example, the malware tried to use sqlite3_* functions to get the Firefox browser history information as shown in figure 12.\n\n\nFigure 12 steal Firefox sensitive information using APIs in nss3.dll\n&nbsp;\n\nHere is another example of a user name and password being stolen, this time from saved Chrome data. The sample searched the path \u201c%LOCALAPPDATA%\\Google\\Chrome\\User Data\\\u201d for file \"Login Data\". If found, the sample copies the \"Login Data\" file to the %AppData%\\Local\\Temp directory and called sqlite3_prepare_v2 function from nss3.dll to exfiltrate credentials with SQL query: \"SELECT origin_url, username_value, password_value FROM logins\" as shown in Figure 13.\n\n\nFigure 13 select strings for stealing browser credentials\nThe malware also withdrawals cookies, bookmarks, and autofill information from the aforementioned browsers. Credential information is saved to PasswordsList.txt and cookies are saved to CookieList.txt.\n\nAdditionally, the sample steals the following cryptocurrency wallets:\n\n \tEthereum\n \tElectrum\n \tElectrum-LTC\n \tJaxx\n \tExodus\n \tMultiBitHD\n\nTh malware tries to find the specified file including sensitive information of cryptocurrency wallets. For example the sample tried to find and send \u201cmbhd.wallet.aes\u201d file located in \u201cCoins\\MultiBitHD\u201d as shown in Figure 14.\n\n\nFigure 14 steal cryptocurrency wallets\n&nbsp;\n\nThe \u00a0sample steals credentials and user data from popular applications including Thunderbird, FileZilla, Outlook, WinSCP, Skype, Telegram and Steam. It also steals files from the Desktop. For example, the sample tries to find \u201cD877F783D5*.map*\u201d file under \u201c%appdata%\\Telegram Desktop\\tdata\u201d directory to steal sensitive information from Telegram as shown in Figure 15.\n\n\nFigure 15 steal applications credentials\n&nbsp;\n\nThe sample collects the user information including current processes, installed software, system language and time zone. The harvested credentials and user information are then sent back to the C2. Here are some highlights about system information stealing.\n\n \tThe malware captures a screenshot of the victim\u2019s computer and saves it to an image file named scr.jpg as shown in Figure 16.\n\n\nFigure 16 capture screen\n\n\n \tMalware uploads files from path and driver type specified by C2 response.\n \tAcquires host IP information by sending GET request to ip-api[.]com\/json. It stores json response in ip.txt.\n \tCollects the following user information and saves it to system.txt.\n\n \tMachine GUID.\n \tWindows Product Name.\n \tUser Name.\n \tComputer Name.\n \tSystem Architecture.\n \tScreen height and width.\n \tSystem language.\n \tCurrent local time.\n \tTime zone.\n \tNumber of CPU cores.\n \tCurrent process lists by calling CreateToolhelp32Snapshot.\n \tDisplay version and name.\n \tInstalled software. (Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\).\n \tGet current account privilege.\n\n\n\nAll information gathered by the malware is shown in figure 17.\n\n\nFigure 17 information gathered by malware\n&nbsp;\n\nExecute File Specified by Malware\n\nThe attacker can remotely control the infected system to execute any file through Create Process or ShellExecute as shown in Figure 18. We also observed that it had the behavior of accessing a malicious URL to get the file: plugin-update[.]space\/download\/10.17.18.exe.\n\n\nFigure 18 call CreateProcess or ShellExecute to execute the file \nThis new variant of Azorult also has the capability to execute malware with local system privileges. It will check the current SID and token by following logic as shown in Figure 19:\n\n \tIf the current integrity level is local_system\n\n \tIt will call WTSQueryUserToken and CreateProcessAsUser to start a new process with system privilege as shown in Figure 20.\n\n\n\n&nbsp;\n\n\nFigure 19 Check SID and token\n&nbsp;\n\n\nFigure 20 create process as local system privilege\n&nbsp;\n\nErasing Hints and Deleting Files\n\nWe also found that the malware erases all of the files located in \u201c%temp%\\2fda\u201d and deletes files according to the C2\u2019s command as shown in Figure 21 and Figure 22.\n\n\nFigure 21 Erasing Hints of Infection\n&nbsp;\n\n\nFigure 22 delete files according C2 command\n&nbsp;\n\nConclusion\n\nA presumed new campaign surfaced in late October that caught our attention. In the span of 3 days, 5 Fallout Exploit Kit URL chains were observed, all landing on an exploit page hosted on domain findmyname[.]pw. There is a new variant of Azorult malware found to be used as a payload for Fallout Exploit Kit. It has updated features compared to the previous versions and supports stealing from more software and cryptocurrency wallets than ever before.\n\nOrganizations with up-to-date Windows hosts have a much lower risk of infection. Palo Alto Networks\u2019 customers are further protected from this threat. Our threat prevention platform detects both Fallout exploit kit and Azorult malware. AutoFocus users can track this activity using the AzoRult tag.\n\n&nbsp;\n\nIOCs\n\nURL Chains\n\nURL chain 1\n\nhxxp:\/\/sax[.]peakonspot[.]com\/dep.php?pid=6639&amp;format=POPUP&amp;subid=&amp;cid=M2018102013-11642b318a12196b7fae1559b32a45c2\n\nhxxps:\/\/gfobhk[.]peak-serving[.]com\/?&amp;id=15400452977053288308437914&amp;tid=6639&amp;sr=ep\n\nhxxp:\/\/sp[.]popcash[.]net\/go\/161339\/449201\n\nhxxp:\/\/sp[.]popcash[.]net\/sgo\/ad?p=161339&amp;w=449201&amp;t=33fd7220adb3c003&amp;r=&amp;vw=0&amp;vh=0\n\nhxxp:\/\/findmyname[.]pw\/1981_06_18\/spumier\/04_05_1952\/E4bI5EK9?FYpUsha=Hangmen-Avowedly-Political-montreal&amp;JAb1I5xAS=Reeled_chateaus_funduck_royalize_unconvert_Joysome&amp;Outdraft=Tr6mHo5&amp;VX1m7hhu=ugaritic_Shying_fleece_15919\n\n&nbsp;\n\nURL chain 2\n\nhxxp:\/\/tania[.]web[.]telrock[.]net\/\n\nhxxp:\/\/api[.]clickaine[.]com\/v1\/apop\/redirect\/zone\/15450\n\nhxxp:\/\/findmyname[.]pw\/M6rpEF\/lifted\/7013-Tiddley-toadyisms-11956-8965\/peevedly_Oversured_tungstic.cfml\n\n&nbsp;\n\nURL chain 3\n\nhxxp:\/\/manuela[.]w[.]telrock[.]org\/\n\nhxxp:\/\/api[.]clickaine[.]com\/v1\/apop\/redirect\/zone\/15450\n\nhxxp:\/\/findmyname[.]pw\/hoivSZVRX\/NV1uI\/vpLnq.shtml?nXslO=indult-Cadere&amp;sAoiIFu=Tirracke&amp;KaaM=Uncloak_Becloaked\n\n&nbsp;\n\nURL chain 4\n\nhxxp:\/\/sl[.]ivankatraff[.]com\/sl?vId\\=bmconv_20181024052548_bea8e890_2113_4ecc_951b_c90aeffde1e6&amp;publisherId\\=40152&amp;source\\=5348_8482&amp;ua\\=Mozilla%2F5.0+%28iPhone%3B+CPU+iPhone+OS+11_3+like+Mac+OS+X%29+AppleWebKit%2F605.1.15+%28KHTML%2C+like+Gecko%29+Mobile%2F15E302&amp;ip\\=124.35.82.126&amp;campaignI\n\nhxxp:\/\/damneddevastator[.]com\/l\/18358235b03f965b74d5?sub=&amp;source=&amp;code2=Y3RtATE1NDAzOTM4OTI1MDEAc3JjAWlvAHZlcgExOQBwbHQBV2luMzIAdGNoATEAaXcBNzkyAGloATUwNABhdwExNDQwAGFoATg1NgB0egE0ODAAYnVpZAEAY2tlATEAb3JudAEAdm5kAQBoc2ZjAXRydWUAZnJtAWZhbHNlAHVhAU1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgVHJpZGVudC83LjA7IFNMQ0MyOyAuTkVUIENMUiAyLjAuNTA3Mjc7IC5ORVQgQ0xSIDMuNS4zMDcyOTsgLk5FVCBDTFIgMy4wLjMwNzI5OyBNZWRpYSBDZW50ZXIgUEMgNi4wOyAuTkVUNC4wQzsgLk5FVDQuMEU7IHJ2OjExLjApIGxpa2UgR2Vja28AYTQzATEwMTEwMQBhNDQBMTEAc2YBMTExMABmZgExMTAAY2hkATAAZmx2AWZhbHNlAGNobQEwMDEAbG5nATExMTEAc3RyZwExMTEwMTAwAG9zY3B1AQBwcmRzdWIBAGV2bG4BMzkAcmVmAQByYmNjATEwMjUxMTUzAGNudHABdHJ1ZQB3bm0BAHdnbHYBMABjZGcBMDAwMDAwMDAwMDAwMDAwMDAxMTExMDAxMDEwMDAwMDAwMTAyMjEyMDAwMDAwMDIyMjIyMjIyMjIyMjIyMjIyMgB3dXQBdy5wYW53X2hhc190aW1lb3V0X3NldDt3LnBhbndfQWN0aXZlWE9iamVjdF9BcmdzX0FycmF5O3cubXNJbmRleGVkREI7dy5jbGlwYm9hcmREYXRhO3cubWF4Q29ubmVjdGlvbnNQZXJTZXJ2ZXI7dy5vbmZvY3VzaW47dy5vbmZvY3Vzb3V0O3cub25oZWxwO3cuYW5pbWF0aW9uU3RhcnRUaW1lO3cubXNBbmltYXRpb25TdGFydFRpbWU7dy5tc0NyeXB0bzt3Lm9ubXNnZXN0dXJlY2hhbmdlO3cub25tc2dlc3R1cmVkb3VibGV0YXA7dy5vbm1zZ2VzdHVyZWVuZDt3Lm9ubXNnZXN0dXJlaG9sZDt3Lm9ubXNnZXN0dXJlc3RhcnQ7dy5vbm1zZ2VzdHVyZXRhcDt3Lm9ubXNpbmVydGlhc3RhcnQ7dy5vbm1zcG9pbnRlcmNhbmNlbDt3Lm9ubXNwb2ludGVyZG93bjt3Lm9ubXNwb2ludGVyZW50ZXI7dy5vbm1zcG9pbnRlcmxlYXZlO3cub25tc3BvaW50ZXJtb3ZlO3cub25tc3BvaW50ZXJvdXQ7dy5vbm1zcG9pbnRlcm92ZXI7dy5vbm1zcG9pbnRlcnVwO3cub25yZWFkeXN0YXRlY2hhbmdlO3cuaXRlbTt3Lm1zV3JpdGVQcm9maWxlck1hcms7dy5uYXZpZ2F0ZTt3LnNob3dIZWxwO3cuc2hvd01vZGVsZXNzRGlhbG9nO3cudG9TdGF0aWNIVE1MO3cubXNDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7dy5tc0lzU3RhdGljSFRNTDt3Lm1zTWF0Y2hNZWRpYTt3Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lO3cudG9TdHJpbmc7dy5jbGVhckltbWVkaWF0ZTt3Lm1zQ2xlYXJJbW1lZGlhdGU7dy5tc1NldEltbWVkaWF0ZTt3LnNldEltbWVkaWF0ZQBrbG5nAWVuLVVTAHJ0dAEhAGxhbwEtMQBobHMBMA__\n\nhxxp:\/\/damneddevastator[.]com\/gw?sub=&amp;source=Unknown&amp;url=https%3A%2F%2Fsax.peakonspot.com%2Fdep.php%3Fpid%3D2457%26subid%3D2_Unknown%26cid%3Dbmconv_20181024091133_7532cd6e_41dc_445b_a538_a0f29d2af047%26ref%3D&amp;vId=bmconv_20181024091133_7532cd6e_41dc_445b_a538_a0f29d2af047&amp;hash=18358235b03f965b74d5&amp;ete=true\n\nhttps:\/\/sax.peakonspot.com\/dep.php?pid=2457&amp;subid=2_Unknown&amp;cid=bmconv_20181024091133_7532cd6e_41dc_445b_a538_a0f29d2af047&amp;ref=\n\nhxxp:\/\/findmyname[.]pw\/pysV15\/olt8uPj1\/1969_04_11\n\n&nbsp;\n\nURL chain 5\n\nhxxp:\/\/whitepages[.]review\/prpllr?cost=0.001850&amp;currency=USD&amp;external_id=76427570563780608&amp;ad_campaign_id=1382277&amp;source=PropellerAds&amp;sub_id_1=1774896\n\nhxxp:\/\/findmyname[.]pw\/cymbalo\/13345\/13231?potteries=icL8gc96\n\n&nbsp;\n\nBinary SHA256\n\nSample 1:\n\n3354a1d18aa861de2e17eeec65fc6545bc52deebe86c3ef12ccb372c312d8af8\n\n&nbsp;\n\nSample 2:\n\n7a99eb3e340f61f800ab3b8784f718bbe2e38159a883c2fc009af740df944431\n\n&nbsp;\n\nSample 3:\n\n0e27bbfa70b399182f030ee18531e100d4f6e8cb64e592276b02c18b7b5d69e6\n\n&nbsp;\n\nAppendix\n\nAppendix 1: hash algorithm and encryption.\u00a0\n\nHash algorithms and encryption for victim id that is sent to C2:\nfrom pwn import *\n\ndef hash_func(input):\n    x = 0\n    for i in input:\n        x += ord(i) ^ 0x6521458a\n        x &amp;= 0xFFFFFFFF\n        x -= ((x &lt;&lt; 0xD) &amp; 0xFFFFFFFF) | (x &gt;&gt; 0x13)\n        x &amp;= 0xFFFFFFFF\n\n    return format(x, 'X').rjust(8, '0')\n\ndef format_hash_str(hash_str):\n    y = len(hash_str)\n    format_hash = []\n    format_hash.append(hash_str[:7])\n\n    hash_str = hash_str[7:]\n    i = 0\n    while i &lt;= y:\n        if i % 8 == 0 and y - i &gt;= 16:\n            format_str = hash_str[i:i+8]\n            if y - i &lt; 24:\n                format_str = hash_str[i:]\n            format_hash.append(format_str)\n        i += 1\n    \n    return '-'.join(format_hash)\n\ndef obfuscate_hash_str(hash_str):\n    obfuscated_hash_str = ''\n    for i in hash_str:\n        t = (ord(i) - ord('A')) &amp; 0xFF\n        q = (ord(i) - ord('a')) &amp; 0xFF\n        if t &gt;= 0x1A and q &gt;= 0x1A:\n            obfuscated_hash_str += '%' + format(ord(i), 'X')\n        else:\n            obfuscated_hash_str += i\n    return obfuscated_hash_str\n\ndef xor_encrypt(hash_str):\n    key = (0xD, 0xA, 0xC8)\n    encrypted_str = ''\n    print hash_str\n    for i in range(len(hash_str)):\n        encrypted_str += chr(ord(hash_str[i]) ^ key[i % len(key)])\n\n    return encrypted_str\n\nWhen malware gets machine GUID, product name, user name and computer name, it uses the aforementioned hash algorithm and encryption algorithm to generate encrypted victim id.\nuser_info = ('8699cdcd-cd9c-49ca-a44a-6c7e984575dc', 'Windows 7 Professional', 'test',\n'WIN-GKIQOSL71B3')\n\nhash_str = ''\n\n\nfor i in user_info:\n    hash_str += hash_func(i)\n\nhash_str += hash_func(''.join(user_info)) # 344FB5D5343A2EC681928A0244CA6CE98647CCAA\nhash_str = format_hash_str(hash_str) # 344FB5D-5343A2EC-681928A0-244CA6CE-98647CCAA\n\nhash_str = 'G' + obfuscate_hash_str(hash_str) # G%33%34%34FB%35D%2D%35%33%34%33A%32EC%2D%36%38%31%39%32%38A%30%2D%32%34%34CA%36CE%2D%39%38%36%34%37CCAA\nencrypted_victim_id = xor_encrypt(hash_str)\n\nC2 address decryption:\n\n&nbsp;\n\nMalware uses xor key [0x09, 0xff, 0x20] to decrypt content in .data section and get string \u201caHR0cDovLzUxLjE1LjE5Ni4zMC8xL2luZGV4LnBocA\u201d. Then malware does base64 decoding to get the C2 address.\n\n&nbsp;\n\nAppendix 2: Targeted browser list\n\nGoogleChrome\n\nInternetMailRu\n\nYandexBrowser\n\nComodoDragon\n\nAmigo\n\nOrbitum\n\nBromium\n\nChromium\n\nNichrome\n\nRockMelt\n\n360Browser\n\nVivaldi\n\nOpera\n\nGoBrowser\n\nSputnik\n\nKometa\n\nUran\n\nQIPSurf\n\nEpic\n\nBrave\n\nCocCoc\n\nCentBrowser\n\n7Star\n\nElementsBrowser\n\nTorBro\n\nSuhba\n\nSaferBrowser\n\nMustang\n\nSuperbird\n\nChedot\n\nTorch\n\nInternet Explorer\n\nMicrosoft Edge","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2018\/04\/unit42-blog-600x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Tao Yan"},{"@type":"Person","name":"Xingyu Jin"},{"@type":"Person","name":"Bo Qu"},{"@type":"Person","name":"Zhanglin He"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"94760","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=94760' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-94760 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-94760 entry-meta">
			
			
			<span class="post-views-count">19,705</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'94760','like')"><i class="ui ui-2"></i><span class="ml-5">3</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit%2F+-+New+Wine+in+Old+Bottle%3A+New+Azorult+Variant+Found+in+FindMyName+Campaign+using+Fallout+Exploit+Kit" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit%2F&title=New+Wine+in+Old+Bottle%3A+New+Azorult+Variant+Found+in+FindMyName+Campaign+using+Fallout+Exploit+Kit&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/tao-yan/" title="Posts by Tao Yan" class="author url fn" rel="author">Tao Yan</a>, <a href="https://unit42.paloaltonetworks.com/author/xingyu-jin/" title="Posts by Xingyu Jin" class="author url fn" rel="author">Xingyu Jin</a>, <a href="https://unit42.paloaltonetworks.com/author/bo-qu/" title="Posts by Bo Qu" class="author url fn" rel="author">Bo Qu</a> and <a href="https://unit42.paloaltonetworks.com/author/zhanglin-he/" title="Posts by Zhanglin He" class="author url fn" rel="author">Zhanglin He</a>        </p>
        <p><time datetime="2018-11-21T04:00:56+00:00">November 21, 2018 at 6:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/azorult/" rel="tag">Azorult</a>, <a href="https://unit42.paloaltonetworks.com/tag/coins/" rel="tag">Coins</a>, <a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" rel="tag">Cryptocurrency</a>, <a href="https://unit42.paloaltonetworks.com/tag/cve-2018-8174/" rel="tag">CVE-2018-8174</a>, <a href="https://unit42.paloaltonetworks.com/tag/electrum/" rel="tag">Electrum</a>, <a href="https://unit42.paloaltonetworks.com/tag/electrum-ltc/" rel="tag">Electrum-LTC</a>, <a href="https://unit42.paloaltonetworks.com/tag/ethereum/" rel="tag">Ethereum</a>, <a href="https://unit42.paloaltonetworks.com/tag/exodus/" rel="tag">Exodus</a>, <a href="https://unit42.paloaltonetworks.com/tag/fallout-exploit-kit/" rel="tag">Fallout Exploit Kit</a>, <a href="https://unit42.paloaltonetworks.com/tag/findmyname/" rel="tag">FindMyName</a>, <a href="https://unit42.paloaltonetworks.com/tag/jaxx/" rel="tag">Jaxx</a>, <a href="https://unit42.paloaltonetworks.com/tag/multibithd/" rel="tag">MultiBitHD</a>, <a href="https://unit42.paloaltonetworks.com/tag/wallet/" rel="tag">Wallet</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="600" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg 600w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-300x150.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-370x185.jpg 370w" sizes="(max-width: 600px) 100vw, 600px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-new-wine-old-bottle-new-azorult-variant-found-findmyname-campaign-using-fallout-exploit-kit/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja"></span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><span style="font-size: 18pt;">Overview</span></p>
<p>Observed in the wild as early as <a href="https://www.proofpoint.com/us/threat-insight/post/new-version-azorult-stealer-improves-loading-features-spreads-alongside">2016,</a> Azorult is a Trojan family which has been delivered in malicious macro-based documents via spam campaigns, or as a secondary payload in the RIG Exploit Kit campaigns. On October 20<sup>th</sup>, 2018 we discovered that new Azorult variants were being used as primary payloads in a new ongoing campaign using the Fallout Exploit Kit. We named this campaign FindMyName because all of the final exploit pages land on the domain findmyname[.]pw. These new Azorult samples variants use advanced obfuscation techniques, such as API flooding and control flow flattening, to evade anti-virus products. Also, we discovered that Azorult has further evolved, the samples we captured support stealing sensitive information in more browsers, applications, and cryptocurrency wallets than previous versions.</p>
<p>In this blog we will cover the FindMyName campaign, the new Azorult malware, and the obfuscation techniques used.</p>
<p>First stage of FindMyName Campaign</p>
<p>October 20<sup>th</sup> is when we first observed the new campaign we are dubbing FindMyName. In the following 3 days, 5 different URL chains, listed in appendix 1, led to the delivery of the Fallout Exploit Kit. All 5 different URL chains redirected victims to one domain, findmyname[.]pw.</p>
<p>The steps in the first stage of FindMyName campaign are shown in Figure 1.</p>
<p><img class="aligncenter wp-image-95035" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_1.png" alt="" width="600" height="124" /></p>
<p style="text-align: center;"><em>Figure 1 Overview of the first stage of the attack</em></p>
<p>&nbsp;</p>
<p>Although the 5 final pages in findmyname[.]pw were different, the content of them were similar. An example of the Fallout Exploit Kit landing page is shown in Figure 2.</p>
<p><img class="aligncenter wp-image-95022" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_2.png" alt="" width="600" height="298" /></p>
<p style="text-align: center;"><em>Figure 2 obfuscated landing page</em></p>
<p>The Fallout Exploit Kit uses several html tags such as span, h3, and p to hide the real exploit code with highly obfuscated tag content. After decryption, the real VBScript code exploits an <a href="https://www.fireeye.com/blog/threat-research/2018/09/fallout-exploit-kit-used-in-malvertising-campaign-to-deliver-gandcrab-ransomware.html">IE VBScript vulnerability</a> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8174">CVE-2018-8174</a> which was patched in August.</p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-95009" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_3.png" alt="" width="600" height="447" /></p>
<p style="text-align: center;"><em>Figure 3 Exploit code snippet of CVE-2018-8174 in Fallout Exploit Kit</em></p>
<p>&nbsp;</p>
<p>After the exploit succeeds, this Fallout Exploit Kit downloads a .tmp file to the %Temp% directory and calls CreateProcess to execute it. Further analysis revealed that the .tmp file was the latest variant of Azorult malware. It was the first time weve seen the new variant of Azorult malware used as primary payload for Fallout Exploit Kit.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Second stage of FindMyName Campaign</span></p>
<p>In this section, we focus on analyzing the latest variant of Azorult malware we captured.</p>
<p>&nbsp;</p>
<p><strong>Malware Analysis Overview</strong></p>
<p>The Azorult malware family is a commercial Trojan sold on underground forums. We observed 3 new variants of Azorult malware in the recent FindMyName campaign. When we discovered them, 2 of the 3 samples had not been seen in the wild yet. One of the new Azorult samples we captured and analyzed has the following malicious features (some of these features are explained in detail in the next section):</p>
<ol>
<li>Evades anti-virus emulator through API flooding.</li>
<li>Thwarts reverse engineering analysis through a control flow flattening technique.</li>
<li>Uses a process hollowing technique to build the new malware image.</li>
<li>Steals credentials, cookies, histories and autofills for more browsers than previous versions.</li>
<li>Steals more cryptocurrency wallets than previous versions.</li>
<li>Steals skype, telegram, steam, FTP client, Email client credentials and chat history when applicable.</li>
<li>Harvests victims information via installed programs, screenshots, machine information, user name, OS version and running processes.</li>
<li>Collects files from the users Desktop.</li>
<li>Anti-forensic component, cleans up all dropped files.</li>
<li>Executes specific file(s) initiated by C2 communication.</li>
</ol>
<p><strong><br />
API Flooding and Control Flow Flattening Obfuscation</strong></p>
<p>The initial Azorult malware was written in Microsoft Visual C++ 7.0. First, the Azorult malware attempted to use <a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Control-Flow-Flattening">control flow flattening</a> obfuscation to thwart reverse engineering analysis as shown in Figure 4. Second, the sample used an API Flooding technique as shown in Figure 5. API Flooding is a malware technique to evade anti-virus emulators. For timely performance concerns, anti-virus emulators set a timer when emulating the executable file on the host machine. If the emulator emulates hundreds of time consuming functions, the emulator times out and marks the file as benign.</p>
<p><img class="aligncenter wp-image-94996" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_4.png" alt="" width="600" height="511" /></p>
<p style="text-align: center;"><em>Figure 4 control flow flatten</em></p>
<p><img class="aligncenter wp-image-94983" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_5.png" alt="" width="600" height="608" /></p>
<p style="text-align: center;"><em>Figure 5 API flooding</em></p>
<p>&nbsp;</p>
<p><strong>Process Hollowing</strong></p>
<p>Azorult uses a process hollowing technique to build the new malware image. First, the sample decrypts the payload in the memory. Then the sample creates a new suspended process of itself. The sample then injects a decrypted payload to the new process. Lastly, the sample resumes new process execution andexhibits malicious behaviors. The overview of the sample execution is shown in Figure 6.</p>
<p><img class="aligncenter wp-image-94970" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_6.png" alt="" width="600" height="238" /></p>
<p style="text-align: center;"><em>Figure 6 Sample process hollowing</em></p>
<p>&nbsp;</p>
<p><strong>C2 Communication</strong></p>
<p>The new trojan file dumped from the process was coded in the Delphi language. When the sample executes, it immediately connects to a C2 server for further instructions. In order to evade Intrusion Prevention Systems (IPS), the C2 traffic is obfuscated. The data sent back to the C2 includes a unique victim ID for each victims machine by encoding the machine GUID , Windows product name, user name and computer name with hash algorithm. Then the malware decrypts a C2 address and sends a POST request to 51[.]15[.]196[.]30/1/index.php with the encrypted victims ID. The C2 traffic is shown in Figure 7. The detailed example about hash algorithm and encryption is listed in Appendix 1.</p>
<p><img class="aligncenter wp-image-94957" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_7.png" alt="" width="600" height="218" /></p>
<p style="text-align: center;"><em>Figure 7 C2 request</em></p>
<p>&nbsp;</p>
<p>The sample decrypts and validates the C2 response. The decrypted C2 content had three parts. The part contained inside the &lt;n&gt;&lt;/n&gt; tags contains 48 legit DLLs which are used for information stealing, described in the following sections. The part inside the &lt;d&gt;&lt;/d&gt; tags contains application information for information stealing: application path, related registry and credential file names. The part in the &lt;c&gt;&lt;/c&gt; tags contains a C2 configuration for the sample. The C2 configuration is shown in Figure 8. According to pcap analysis, we identified the following characters checked by this sample.</p>
<ol>
<li>+: enabling the specific malicious function.</li>
<li>-: disabling the specific malicious function.</li>
<li>I: collecting host IP info.</li>
<li>L: downloading and executing file from remote server.</li>
</ol>
<p><img class="aligncenter wp-image-94944" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_8.png" alt="" width="600" height="75" /></p>
<p style="text-align: center;"><em>Figure 8 C2 configuration</em></p>
<p>Malicious functions specified by C2:</p>
<ol>
<li>Steal browser password credentials.</li>
<li>Steal browser cookies, autofill credentials. Steal credentials from FTP client or Email client.</li>
<li>Steal browser history.</li>
<li>Steal bitcoin wallets.</li>
<li>Steal skype chat message main.db.</li>
<li>Steal telegram credentials.</li>
<li>Steal steam credentials (ssfn) and game metadata (.vdf).</li>
<li>Takes a screenshot that eventually is sent to the attacker.</li>
<li>Clean-up the temporary malware files.</li>
<li>Collect files from Desktop.</li>
<li>Get host IP information by sending GET request to ip-api[.]com/json.</li>
<li>Download and execute file specified by C2.</li>
</ol>
<p>&nbsp;</p>
<p>Figure 9 shows an example of C2 configuration for stealing sensitive information from Firefox and Thunderbird.</p>
<p><img class="aligncenter wp-image-94931" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_9.png" alt="" width="600" height="180" /></p>
<p style="text-align: center;"><em>Figure 9 C2 configuration for information stealing</em></p>
<p>&nbsp;</p>
<p>The overview of C2 traffic is shown in Figure 10.</p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-94918" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_10.png" alt="" width="600" height="255" /></p>
<p style="text-align: center;"><em>Figure 10 C2 traffic overview</em></p>
<p><strong>Information stealer</strong></p>
<p>The sample stole credentials and user data from thirty-two browsers including Chrome, Firefox and Qihoo 360. The full list of browsers is in Appendix 2. To steal credentials from browsers, the sample downloaded 48 legitimate dll files from C2 response to %AppData%\Local\Temp\2fda folder as shown in Figure 11.</p>
<p><img class="size-full wp-image-94905 aligncenter" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_11.png" alt="" width="343" height="708" /></p>
<p style="text-align: center;"><em>Figure 11 legit dll files</em></p>
<p>The purpose of this action is to load nss3.dll and load the following functions:</p>
<p>sqlite3_open</p>
<p>sqlite3_close</p>
<p>sqlite3_prepare_v2</p>
<p>sqlite3_step</p>
<p>sqlite3_column_text</p>
<p>sqlite3_finalize</p>
<p>NSS_Init</p>
<p>PK11_GetInternalKeySlot</p>
<p>PK11_Authenticate</p>
<p>PK11SDR_Decrypt</p>
<p>NSS_Shutdown</p>
<p>PK11_FreeSlot</p>
<p>These functions are used to dump sensitive browser information. For example, the malware tried to use sqlite3_* functions to get the Firefox browser history information as shown in figure 12.</p>
<p><img class="aligncenter wp-image-94892" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_12.png" alt="" width="600" height="179" /></p>
<p style="text-align: center;"><em>Figure 12 steal Firefox sensitive information using APIs in nss3.dll</em></p>
<p>&nbsp;</p>
<p>Here is another example of a user name and password being stolen, this time from saved Chrome data. The sample searched the path %LOCALAPPDATA%\Google\Chrome\User Data\ for file &#8220;Login Data&#8221;. If found, the sample copies the &#8220;Login Data&#8221; file to the %AppData%\Local\Temp directory and called sqlite3_prepare_v2 function from nss3.dll to exfiltrate credentials with SQL query: &#8220;SELECT origin_url, username_value, password_value FROM logins&#8221; as shown in Figure 13.</p>
<p><img class="aligncenter wp-image-94879" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_13.png" alt="" width="600" height="294" /></p>
<p style="text-align: center;"><em>Figure 13 select strings for stealing browser credentials</em></p>
<p>The malware also withdrawals cookies, bookmarks, and autofill information from the aforementioned browsers. Credential information is saved to PasswordsList.txt and cookies are saved to CookieList.txt.</p>
<p>Additionally, the sample steals the following cryptocurrency wallets:</p>
<ul>
<li>Ethereum</li>
<li>Electrum</li>
<li>Electrum-LTC</li>
<li>Jaxx</li>
<li>Exodus</li>
<li>MultiBitHD</li>
</ul>
<p>Th malware tries to find the specified file including sensitive information of cryptocurrency wallets. For example the sample tried to find and send mbhd.wallet.aes file located in Coins\MultiBitHD as shown in Figure 14.</p>
<p><img class="aligncenter wp-image-94866" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_14.png" alt="" width="600" height="1011" /></p>
<p style="text-align: center;"><em>Figure 14 steal cryptocurrency wallets</em></p>
<p>&nbsp;</p>
<p>The sample steals credentials and user data from popular applications including Thunderbird, FileZilla, Outlook, WinSCP, Skype, Telegram and Steam. It also steals files from the Desktop. For example, the sample tries to find D877F783D5*.map* file under %appdata%\Telegram Desktop\tdata directory to steal sensitive information from Telegram as shown in Figure 15.</p>
<p><img class="aligncenter wp-image-94853" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_15.png" alt="" width="600" height="237" /></p>
<p style="text-align: center;"><em>Figure 15 steal applications credentials</em></p>
<p>&nbsp;</p>
<p>The sample collects the user information including current processes, installed software, system language and time zone. The harvested credentials and user information are then sent back to the C2. Here are some highlights about system information stealing.</p>
<ul>
<li>The malware captures a screenshot of the victims computer and saves it to an image file named scr.jpg as shown in Figure 16.</li>
</ul>
<p><img class="aligncenter wp-image-94840" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_16.png" alt="" width="600" height="114" /></p>
<p style="text-align: center;"><em>Figure 16 capture screen</em></p>
<ul>
<li>Malware uploads files from path and driver type specified by C2 response.</li>
<li>Acquires host IP information by sending GET request to ip-api[.]com/json. It stores json response in ip.txt.</li>
<li>Collects the following user information and saves it to system.txt.
<ul>
<li>Machine GUID.</li>
<li>Windows Product Name.</li>
<li>User Name.</li>
<li>Computer Name.</li>
<li>System Architecture.</li>
<li>Screen height and width.</li>
<li>System language.</li>
<li>Current local time.</li>
<li>Time zone.</li>
<li>Number of CPU cores.</li>
<li>Current process lists by calling CreateToolhelp32Snapshot.</li>
<li>Display version and name.</li>
<li>Installed software. (Software\Microsoft\Windows\CurrentVersion\Uninstall\).</li>
<li>Get current account privilege.</li>
</ul>
</li>
</ul>
<p>All information gathered by the malware is shown in figure 17.</p>
<p><img class="aligncenter wp-image-94827" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_17.png" alt="" width="600" height="345" /></p>
<p style="text-align: center;"><em>Figure 17 information gathered by malware</em></p>
<p>&nbsp;</p>
<p><strong>Execute File Specified by Malware</strong></p>
<p>The attacker can remotely control the infected system to execute any file through Create Process or ShellExecute as shown in Figure 18. We also observed that it had the behavior of accessing a malicious URL to get the file: plugin-update[.]space/download/10.17.18.exe.</p>
<p><img class="aligncenter wp-image-94814" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_18.png" alt="" width="600" height="444" /></p>
<p style="text-align: center;"><em>Figure 18 call CreateProcess or ShellExecute to execute the file </em></p>
<p>This new variant of Azorult also has the capability to execute malware with local system privileges. It will check the current SID and token by following logic as shown in Figure 19:</p>
<ul>
<li>If the current integrity level is local_system
<ul>
<li>It will call WTSQueryUserToken and CreateProcessAsUser to start a new process with system privilege as shown in Figure 20.</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-94801" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_19.png" alt="" width="600" height="223" /></p>
<p style="text-align: center;"><em>Figure 19 Check SID and token</em></p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-94788" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_20.png" alt="" width="600" height="273" /></p>
<p style="text-align: center;"><em>Figure 20 create process as local system privilege</em></p>
<p>&nbsp;</p>
<p><strong>Erasing Hints and Deleting Files</strong></p>
<p>We also found that the malware erases all of the files located in %temp%\2fda and deletes files according to the C2s command as shown in Figure 21 and Figure 22.</p>
<p><img class="aligncenter wp-image-94775" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_21.png" alt="" width="600" height="423" /></p>
<p style="text-align: center;"><em>Figure 21 Erasing Hints of Infection</em></p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-94762" src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/11/new-wine_22.png" alt="" width="600" height="417" /></p>
<p style="text-align: center;"><em>Figure 22 delete files according C2 command</em></p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Conclusion</span></p>
<p>A presumed new campaign surfaced in late October that caught our attention. In the span of 3 days, 5 Fallout Exploit Kit URL chains were observed, all landing on an exploit page hosted on domain findmyname[.]pw. There is a new variant of Azorult malware found to be used as a payload for Fallout Exploit Kit. It has updated features compared to the previous versions and supports stealing from more software and cryptocurrency wallets than ever before.</p>
<p>Organizations with up-to-date Windows hosts have a much lower risk of infection. Palo Alto Networks customers are further protected from this threat. Our threat prevention platform detects both Fallout exploit kit and Azorult malware. AutoFocus users can track this activity using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.AzoRult">AzoRult</a> tag.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">IOCs</span></p>
<p><span style="font-size: 18pt;">URL Chains</span></p>
<p><strong>URL chain 1</strong></p>
<p>hxxp://sax[.]peakonspot[.]com/dep.php?pid=6639&amp;format=POPUP&amp;subid=&amp;cid=M2018102013-11642b318a12196b7fae1559b32a45c2</p>
<p>hxxps://gfobhk[.]peak-serving[.]com/?&amp;id=15400452977053288308437914&amp;tid=6639&amp;sr=ep</p>
<p>hxxp://sp[.]popcash[.]net/go/161339/449201</p>
<p>hxxp://sp[.]popcash[.]net/sgo/ad?p=161339&amp;w=449201&amp;t=33fd7220adb3c003&amp;r=&amp;vw=0&amp;vh=0</p>
<p>hxxp://findmyname[.]pw/1981_06_18/spumier/04_05_1952/E4bI5EK9?FYpUsha=Hangmen-Avowedly-Political-montreal&amp;JAb1I5xAS=Reeled_chateaus_funduck_royalize_unconvert_Joysome&amp;Outdraft=Tr6mHo5&amp;VX1m7hhu=ugaritic_Shying_fleece_15919</p>
<p>&nbsp;</p>
<p><strong>URL chain 2</strong></p>
<p>hxxp://tania[.]web[.]telrock[.]net/</p>
<p>hxxp://api[.]clickaine[.]com/v1/apop/redirect/zone/15450</p>
<p>hxxp://findmyname[.]pw/M6rpEF/lifted/7013-Tiddley-toadyisms-11956-8965/peevedly_Oversured_tungstic.cfml</p>
<p>&nbsp;</p>
<p><strong>URL chain 3</strong></p>
<p>hxxp://manuela[.]w[.]telrock[.]org/</p>
<p>hxxp://api[.]clickaine[.]com/v1/apop/redirect/zone/15450</p>
<p>hxxp://findmyname[.]pw/hoivSZVRX/NV1uI/vpLnq.shtml?nXslO=indult-Cadere&amp;sAoiIFu=Tirracke&amp;KaaM=Uncloak_Becloaked</p>
<p>&nbsp;</p>
<p><strong>URL chain 4</strong></p>
<p>hxxp://sl[.]ivankatraff[.]com/sl?vId\=bmconv_20181024052548_bea8e890_2113_4ecc_951b_c90aeffde1e6&amp;publisherId\=40152&amp;source\=5348_8482&amp;ua\=Mozilla%2F5.0+%28iPhone%3B+CPU+iPhone+OS+11_3+like+Mac+OS+X%29+AppleWebKit%2F605.1.15+%28KHTML%2C+like+Gecko%29+Mobile%2F15E302&amp;ip\=124.35.82.126&amp;campaignI</p>
<p>hxxp://damneddevastator[.]com/l/18358235b03f965b74d5?sub=&amp;source=&amp;code2=Y3RtATE1NDAzOTM4OTI1MDEAc3JjAWlvAHZlcgExOQBwbHQBV2luMzIAdGNoATEAaXcBNzkyAGloATUwNABhdwExNDQwAGFoATg1NgB0egE0ODAAYnVpZAEAY2tlATEAb3JudAEAdm5kAQBoc2ZjAXRydWUAZnJtAWZhbHNlAHVhAU1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgVHJpZGVudC83LjA7IFNMQ0MyOyAuTkVUIENMUiAyLjAuNTA3Mjc7IC5ORVQgQ0xSIDMuNS4zMDcyOTsgLk5FVCBDTFIgMy4wLjMwNzI5OyBNZWRpYSBDZW50ZXIgUEMgNi4wOyAuTkVUNC4wQzsgLk5FVDQuMEU7IHJ2OjExLjApIGxpa2UgR2Vja28AYTQzATEwMTEwMQBhNDQBMTEAc2YBMTExMABmZgExMTAAY2hkATAAZmx2AWZhbHNlAGNobQEwMDEAbG5nATExMTEAc3RyZwExMTEwMTAwAG9zY3B1AQBwcmRzdWIBAGV2bG4BMzkAcmVmAQByYmNjATEwMjUxMTUzAGNudHABdHJ1ZQB3bm0BAHdnbHYBMABjZGcBMDAwMDAwMDAwMDAwMDAwMDAxMTExMDAxMDEwMDAwMDAwMTAyMjEyMDAwMDAwMDIyMjIyMjIyMjIyMjIyMjIyMgB3dXQBdy5wYW53X2hhc190aW1lb3V0X3NldDt3LnBhbndfQWN0aXZlWE9iamVjdF9BcmdzX0FycmF5O3cubXNJbmRleGVkREI7dy5jbGlwYm9hcmREYXRhO3cubWF4Q29ubmVjdGlvbnNQZXJTZXJ2ZXI7dy5vbmZvY3VzaW47dy5vbmZvY3Vzb3V0O3cub25oZWxwO3cuYW5pbWF0aW9uU3RhcnRUaW1lO3cubXNBbmltYXRpb25TdGFydFRpbWU7dy5tc0NyeXB0bzt3Lm9ubXNnZXN0dXJlY2hhbmdlO3cub25tc2dlc3R1cmVkb3VibGV0YXA7dy5vbm1zZ2VzdHVyZWVuZDt3Lm9ubXNnZXN0dXJlaG9sZDt3Lm9ubXNnZXN0dXJlc3RhcnQ7dy5vbm1zZ2VzdHVyZXRhcDt3Lm9ubXNpbmVydGlhc3RhcnQ7dy5vbm1zcG9pbnRlcmNhbmNlbDt3Lm9ubXNwb2ludGVyZG93bjt3Lm9ubXNwb2ludGVyZW50ZXI7dy5vbm1zcG9pbnRlcmxlYXZlO3cub25tc3BvaW50ZXJtb3ZlO3cub25tc3BvaW50ZXJvdXQ7dy5vbm1zcG9pbnRlcm92ZXI7dy5vbm1zcG9pbnRlcnVwO3cub25yZWFkeXN0YXRlY2hhbmdlO3cuaXRlbTt3Lm1zV3JpdGVQcm9maWxlck1hcms7dy5uYXZpZ2F0ZTt3LnNob3dIZWxwO3cuc2hvd01vZGVsZXNzRGlhbG9nO3cudG9TdGF0aWNIVE1MO3cubXNDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7dy5tc0lzU3RhdGljSFRNTDt3Lm1zTWF0Y2hNZWRpYTt3Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lO3cudG9TdHJpbmc7dy5jbGVhckltbWVkaWF0ZTt3Lm1zQ2xlYXJJbW1lZGlhdGU7dy5tc1NldEltbWVkaWF0ZTt3LnNldEltbWVkaWF0ZQBrbG5nAWVuLVVTAHJ0dAEhAGxhbwEtMQBobHMBMA__</p>
<p>hxxp://damneddevastator[.]com/gw?sub=&amp;source=Unknown&amp;url=https%3A%2F%2Fsax.peakonspot.com%2Fdep.php%3Fpid%3D2457%26subid%3D2_Unknown%26cid%3Dbmconv_20181024091133_7532cd6e_41dc_445b_a538_a0f29d2af047%26ref%3D&amp;vId=bmconv_20181024091133_7532cd6e_41dc_445b_a538_a0f29d2af047&amp;hash=18358235b03f965b74d5&amp;ete=true</p>
<p>https://sax.peakonspot.com/dep.php?pid=2457&#038;subid=2_Unknown&#038;cid=bmconv_20181024091133_7532cd6e_41dc_445b_a538_a0f29d2af047&#038;ref=</p>
<p>hxxp://findmyname[.]pw/pysV15/olt8uPj1/1969_04_11</p>
<p>&nbsp;</p>
<p><strong>URL chain 5</strong></p>
<p>hxxp://whitepages[.]review/prpllr?cost=0.001850&amp;currency=USD&amp;external_id=76427570563780608&amp;ad_campaign_id=1382277&amp;source=PropellerAds&amp;sub_id_1=1774896</p>
<p>hxxp://findmyname[.]pw/cymbalo/13345/13231?potteries=icL8gc96</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Binary SHA256</span></p>
<p><strong>Sample 1:</strong></p>
<p>3354a1d18aa861de2e17eeec65fc6545bc52deebe86c3ef12ccb372c312d8af8</p>
<p>&nbsp;</p>
<p><strong>Sample 2:</strong></p>
<p>7a99eb3e340f61f800ab3b8784f718bbe2e38159a883c2fc009af740df944431</p>
<p>&nbsp;</p>
<p><strong>Sample 3:</strong></p>
<p>0e27bbfa70b399182f030ee18531e100d4f6e8cb64e592276b02c18b7b5d69e6</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Appendix</span></p>
<p><strong>Appendix 1: hash algorithm and encryption.</strong></p>
<p>Hash algorithms and encryption for victim id that is sent to C2:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694d121f0a7288873510" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from pwn import *

def hash_func(input):
    x = 0
    for i in input:
        x += ord(i) ^ 0x6521458a
        x &amp;= 0xFFFFFFFF
        x -= ((x &lt;&lt; 0xD) &amp; 0xFFFFFFFF) | (x &gt;&gt; 0x13)
        x &amp;= 0xFFFFFFFF

    return format(x, 'X').rjust(8, '0')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694d121f0a7288873510-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0a7288873510-2">2</div><div class="crayon-num" data-line="crayon-5f694d121f0a7288873510-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0a7288873510-4">4</div><div class="crayon-num" data-line="crayon-5f694d121f0a7288873510-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0a7288873510-6">6</div><div class="crayon-num" data-line="crayon-5f694d121f0a7288873510-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0a7288873510-8">8</div><div class="crayon-num" data-line="crayon-5f694d121f0a7288873510-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0a7288873510-10">10</div><div class="crayon-num" data-line="crayon-5f694d121f0a7288873510-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694d121f0a7288873510-1"><span class="crayon-e">from </span><span class="crayon-e">pwn </span><span class="crayon-e ">import *</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0a7288873510-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694d121f0a7288873510-3"><span class="crayon-e">def </span><span class="crayon-e">hash_func</span><span class="crayon-sy">(</span><span class="crayon-v">input</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0a7288873510-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f694d121f0a7288873510-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">input</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0a7288873510-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0x6521458a</span></div><div class="crayon-line" id="crayon-5f694d121f0a7288873510-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&amp;=</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFFFFFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0a7288873510-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0xD</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFFFFFF</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0x13</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0a7288873510-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&amp;=</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFFFFFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0a7288873510-10">&nbsp;</div><div class="crayon-line" id="crayon-5f694d121f0a7288873510-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'X'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">rjust</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694d121f0b2535549572" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def format_hash_str(hash_str):
    y = len(hash_str)
    format_hash = []
    format_hash.append(hash_str[:7])

    hash_str = hash_str[7:]
    i = 0
    while i &lt;= y:
        if i % 8 == 0 and y - i &gt;= 16:
            format_str = hash_str[i:i+8]
            if y - i &lt; 24:
                format_str = hash_str[i:]
            format_hash.append(format_str)
        i += 1
    
    return '-'.join(format_hash)

def obfuscate_hash_str(hash_str):
    obfuscated_hash_str = ''
    for i in hash_str:
        t = (ord(i) - ord('A')) &amp; 0xFF
        q = (ord(i) - ord('a')) &amp; 0xFF
        if t &gt;= 0x1A and q &gt;= 0x1A:
            obfuscated_hash_str += '%' + format(ord(i), 'X')
        else:
            obfuscated_hash_str += i
    return obfuscated_hash_str

def xor_encrypt(hash_str):
    key = (0xD, 0xA, 0xC8)
    encrypted_str = ''
    print hash_str
    for i in range(len(hash_str)):
        encrypted_str += chr(ord(hash_str[i]) ^ key[i % len(key)])

    return encrypted_str</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-2">2</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-4">4</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-6">6</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-8">8</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-10">10</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-12">12</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-14">14</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-16">16</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-18">18</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-20">20</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-22">22</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-24">24</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-26">26</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-28">28</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-30">30</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-32">32</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-34">34</div><div class="crayon-num" data-line="crayon-5f694d121f0b2535549572-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b2535549572-36">36</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694d121f0b2535549572-1"><span class="crayon-e">def </span><span class="crayon-e">format_hash_str</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">format_hash</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">format_hash</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hash_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">hash_str</span><span class="crayon-sy">[</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">format_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">hash_str</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">24</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">format_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">hash_str</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">format_hash</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">format_str</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">format_hash</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-18"><span class="crayon-e">def </span><span class="crayon-e">obfuscate_hash_str</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">obfuscated_hash_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">hash_str</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-s">'A'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-s">'a'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0x1A</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0x1A</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">obfuscated_hash_str</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'%'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'X'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">obfuscated_hash_str</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">obfuscated_hash_str</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-28">&nbsp;</div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-29"><span class="crayon-e">def </span><span class="crayon-e">xor_encrypt</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0xD</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xA</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xC8</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">encrypted_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-e">hash_str</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-33"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">encrypted_str</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0b2535549572-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b2535549572-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">encrypted_str</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>When malware gets machine GUID, product name, user name and computer name, it uses the aforementioned hash algorithm and encryption algorithm to generate encrypted victim id.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694d121f0b4952976837" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
user_info = ('8699cdcd-cd9c-49ca-a44a-6c7e984575dc', 'Windows 7 Professional', 'test',</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694d121f0b4952976837-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694d121f0b4952976837-1"><span class="crayon-v">user_info</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'8699cdcd-cd9c-49ca-a44a-6c7e984575dc'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Windows 7 Professional'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span><span class="crayon-sy">,</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694d121f0b6890447349" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
'WIN-GKIQOSL71B3')

hash_str = ''</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694d121f0b6890447349-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b6890447349-2">2</div><div class="crayon-num" data-line="crayon-5f694d121f0b6890447349-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694d121f0b6890447349-1"><span class="crayon-s">'WIN-GKIQOSL71B3'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b6890447349-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694d121f0b6890447349-3"><span class="crayon-v">hash_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694d121f0b7529356137" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
for i in user_info:
    hash_str += hash_func(i)

hash_str += hash_func(''.join(user_info)) # 344FB5D5343A2EC681928A0244CA6CE98647CCAA
hash_str = format_hash_str(hash_str) # 344FB5D-5343A2EC-681928A0-244CA6CE-98647CCAA

hash_str = 'G' + obfuscate_hash_str(hash_str) # G%33%34%34FB%35D%2D%35%33%34%33A%32EC%2D%36%38%31%39%32%38A%30%2D%32%34%34CA%36CE%2D%39%38%36%34%37CCAA
encrypted_victim_id = xor_encrypt(hash_str)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694d121f0b7529356137-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b7529356137-2">2</div><div class="crayon-num" data-line="crayon-5f694d121f0b7529356137-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b7529356137-4">4</div><div class="crayon-num" data-line="crayon-5f694d121f0b7529356137-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b7529356137-6">6</div><div class="crayon-num" data-line="crayon-5f694d121f0b7529356137-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694d121f0b7529356137-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694d121f0b7529356137-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">user_info</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b7529356137-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hash_str</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">hash_func</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694d121f0b7529356137-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b7529356137-4"><span class="crayon-v">hash_str</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">hash_func</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">user_info</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># 344FB5D5343A2EC681928A0244CA6CE98647CCAA</span></div><div class="crayon-line" id="crayon-5f694d121f0b7529356137-5"><span class="crayon-v">hash_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">format_hash_str</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># 344FB5D-5343A2EC-681928A0-244CA6CE-98647CCAA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b7529356137-6">&nbsp;</div><div class="crayon-line" id="crayon-5f694d121f0b7529356137-7"><span class="crayon-v">hash_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'G'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">obfuscate_hash_str</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># G%33%34%34FB%35D%2D%35%33%34%33A%32EC%2D%36%38%31%39%32%38A%30%2D%32%34%34CA%36CE%2D%39%38%36%34%37CCAA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694d121f0b7529356137-8"><span class="crayon-v">encrypted_victim_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">xor_encrypt</span><span class="crayon-sy">(</span><span class="crayon-v">hash_str</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>C2 address decryption:</p>
<p>&nbsp;</p>
<p>Malware uses xor key [0x09, 0xff, 0x20] to decrypt content in .data section and get string aHR0cDovLzUxLjE1LjE5Ni4zMC8xL2luZGV4LnBocA. Then malware does base64 decoding to get the C2 address.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Appendix 2: Targeted browser list</span></p>
<p>GoogleChrome</p>
<p>InternetMailRu</p>
<p>YandexBrowser</p>
<p>ComodoDragon</p>
<p>Amigo</p>
<p>Orbitum</p>
<p>Bromium</p>
<p>Chromium</p>
<p>Nichrome</p>
<p>RockMelt</p>
<p>360Browser</p>
<p>Vivaldi</p>
<p>Opera</p>
<p>GoBrowser</p>
<p>Sputnik</p>
<p>Kometa</p>
<p>Uran</p>
<p>QIPSurf</p>
<p>Epic</p>
<p>Brave</p>
<p>CocCoc</p>
<p>CentBrowser</p>
<p>7Star</p>
<p>ElementsBrowser</p>
<p>TorBro</p>
<p>Suhba</p>
<p>SaferBrowser</p>
<p>Mustang</p>
<p>Superbird</p>
<p>Chedot</p>
<p>Torch</p>
<p>Internet Explorer</p>
<p>Microsoft Edge</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
