
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>OopsIE! OilRig uses ThreeDollars to Deliver New Trojan</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 details findings on the OilRig group&#039;s attempted delivery of a new Trojan that we are tracking as OopsIE"/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="OopsIE! OilRig uses ThreeDollars to Deliver New Trojan" />
<meta property="og:description" content="Unit 42 details findings on the OilRig group&#039;s attempted delivery of a new Trojan that we are tracking as OopsIE" />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="ConfuserEx" />
<meta property="article:tag" content="OilRig" />
<meta property="article:tag" content="OopsIE" />
<meta property="article:tag" content="SmartAssembly" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2018-02-23T03:00:19+00:00" />
<meta property="article:modified_time" content="2018-11-01T11:02:20+00:00" />
<meta property="og:updated_time" content="2018-11-01T11:02:20+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 details findings on the OilRig group&#039;s attempted delivery of a new Trojan that we are tracking as OopsIE" />
<meta name="twitter:title" content="OopsIE! OilRig uses ThreeDollars to Deliver New Trojan" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/feed/" />
<meta property="og:likes" content="5"/>
<meta property="og:readtime" content="11"/>
<meta property="og:views" content="29,958"/>
<meta property="og:date_created" content="February 23, 2018 at 5:00 AM"/>
<meta property="og:post_length" content="3062"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Bryan Lee"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bryanlee/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan","name":"OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan","description":"Unit 42 details findings on the OilRig group's attempted delivery of a new Trojan that we are tracking as OopsIE","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan\/","datePublished":"February 23, 2018","articleBody":"The OilRig group remains highly active in their attack campaigns while they continue to evolve their toolset. On January 8, 2018, Unit 42 observed the OilRig threat group carry out an attack on an insurance agency based in the Middle East. Just over a week later, on January 16, 2018, we observed an attack on a Middle Eastern financial institution. In both attacks, the OilRig group attempted to deliver a new Trojan that we are tracking as OopsIE.\nThe January 8 attack used a variant of the ThreeDollars delivery document, which we identified as part of the OilRig toolset based on attacks that occurred in August 2017.\nHowever, the attack on January 16 did not involve ThreeDollars at all. Instead, this attack involved delivering the OopsIE Trojan directly to the victim, most likely using a link in a spear phishing email. Interestingly, the targeted organization in the January 16 attack had already been targeted by the OilRig group a year ago on January 2017. This repeat attack may suggest that the adversaries have lost their foothold in the targeted organization, or that it may be considered a high value target.\n&nbsp;\nA New Attack\nOn January 8, 2018, the OilRig threat group sent an email with the subject Beirut Insurance Seminar Invitation to an insurance agency in the Middle East. The OilRig group sent two emails to two different email addresses at the same organization within a six minutes time span. The recipient email addresses suggest they may be the addresses used for specific regional branches of the targeted organization.\nBoth emails originated from the same address. The email address is associated with the Lebanese domain of a major global financial institution. However, based upon the captured session data, it is highly likely the source email address was spoofed. The email contained an attachment named Seminar-Invitation.doc, which is a malicious Microsoft Word document we track as ThreeDollars. Examining this sample of ThreeDollars reveals that it contains a new payload, which we have named OopsIE.\nIn the January 16, 2018 attack, we observed OilRig attacking an organization it previously targeted in January 2017. In this case, the ThreeDollars delivery document was not used and instead an attempt was made to deliver the OopsIE Trojan directly to the targeted organization, likely via a link within an email. The Trojan was directly downloaded from the command and control server for OopsIE, signifying that this server was also used for staging. This suggests that due to the January 2017 attack, the targeted organization may have taken actions to counter known OilRig TTPs, in this case delivering malicious macro documents, causing the OilRig operators to adopt a different delivery tactic.\nWe also identified another sample of ThreeDollars, created on January 15, 2017 with the file name strategy preparation.dot. While this sample was very similar to the Seminar-Invitation.doc sample it also had some significant differences. The primary difference was that this sample was encrypted and password protected, requiring the victim to enter in a password which was likely provided by the adversary to view the document. While this is not a new tactic, this is the first instance where we have observed the OilRig using it in their playbook. Typically, password protected documents is commonly used by adversaries as an evasion tactic to bypass automated analysis mechanisms due to the password requirement for successful execution. As we have observed throughout our tracking of the OilRig group, adopting proven tactics has been a common behavior over time.\n&nbsp;\nThreeDollars Document Analysis\nThe samples of ThreeDollars we collected in these attacks are structurally very similar to the first sample we analyzed in October 2017, down to the lure image used to trick the recipient into clicking the \u201cEnable Content\u201d button to execute the malicious macro. The images used in the January 2018 attacks were the exact same in each sample, verified by file hash.\nFigure 1 shows the lure image extracted from the newer attacks, and the lure image from the first sample we analyzed. While it is unsurprising that attacks originating from the same adversary group would use the same resource over time, we analyzed exactly how similar these lure images were.\n&nbsp;\n\nFigure 1 Side-by-side of the lure images within ThreeDollars in the October 2017 and the January 2018 attacks\n&nbsp;\nSuperficially, we can immediately see the images are quite similar, but with some glaring differences. The image from the August 2017 attack for example, is significantly larger, using an image resolution of 3508 pixels x 4961 pixels which is also the exact resolution for a sheet of A3 paper at 300 dpi. It also contains some additional artifacts in the image, such as the inclusion of the Microsoft logo as well as additional text, specifically \u201cagainst unauthorized use\u201d. In comparison, the newer lure image appears to be horizontally distorted due to it being resized to fit into the constraints of the document. In addition, the period after \u201cThis document is protected\u201d is misaligned.\nBy overlaying these two lure images and accounting for the newer image\u2019s distortion, we are able to clearly visualize that the newer image is highly likely to be a cropped and edited version of the August 2017 image.\n&nbsp;\n\n&nbsp;\nExamining the color code used in both images also shows they are the exact same, #da3b01. The dimensions of the newer image are roughly 40% of the older October image, suggesting that after cropping and editing the newer image, the creator is also likely to have resized the image. One peculiar artifact from the original image is the usage of the \u201cst\u201d (unicode \\uFB06) ligature in the word \u201cagainst\u201d. This is a highly uncommon glyph and is not generally available in standard keyboard layouts. This may suggest that the string was machine generated rather than directly inputted from a keyboard. The use of this glyph also may suggest that the actor is not a native English speaker.\n&nbsp;\nMalicious Macro Analysis\nWhen the victim opens the ThreeDollars document they are presented with the lure image and prompted to click on the \u201cEnable Content\u201d button. When button is clicked, a malicious macro is silently run which installs then executes a payload on a system. A decoy image is also displayed to the victim to lower suspicion of malicious activity. The decoy message that is eventually presented to the victim does not actually show the expected content of an insurance seminar invitation as presented in the delivery email. Instead, it displays a fake error message of NullRefrencedException! error has occurred in user32.dll by 0x32ef2121 within the Word document, as seen in Figure 2.\n&nbsp;\n\nFigure 2 Decoy message displayed by the malicious macro in ThreeDollars delivery document\n&nbsp;\nWhile the decoy in Figure 2 is displayed, the macro will search the document for the delimiter ###$$$ and write the base64 encoded text that follows this delimiter to the file %APPDATA%\\Base.txt. The macro then creates a scheduled task named SecurityAssist that runs after waiting one minute. The SecurityAssist task is responsible for running the following command line command that uses the Certutil application to decode the base64 encoded data in Base.txt and saves the decoded data to the file %PROGRAMDATA%\\IntelSecurityAssistManager.exe:\ncmd.exe \/c Certutil -decode %appdata%\\Base.txt %programdata%\\IntelSecurityAssistManager.exe &amp; SchTasks \/Delete \/F \/TN SecurityAssist\nThe macro also creates a second scheduled task named Conhost that waits two minutes and runs a VBScript %APPDATA%\\chkSrv.vbs. The macro saves the chkSrv.vbs script to the system, which is responsible for running the IntelSecurityAssistManager.exe payload (OopsIE Trojan) and cleaning up the installation by deleting the two scheduled tasks, the Base.txt file, the ThreeDollars document, and the chkSrv.vbs script.\n&nbsp;\nOopsIE Trojan Analysis\nThe OopsIE Trojan delivered in these attacks is packed with SmartAssembly and further obfuscated with ConfuserEx v1.0.0. To run persistently on the system, the Trojan will first create a VBScript file:\nSpecialFolder.CommonApplicationData\\srvResesponded.vbs\nthat contains:\nCreateObject(\"WScript.Shell\").Run(\"%app%\")\nThe Trojan replaces the %app% string in the above VBScript with the path to its executable. Finally, the Trojan creates a scheduled task to run itself every three minutes by running the following command on the command prompt after replacing the %path% string with the path to the srvResesponded.vbs VBScript:\nSchTasks \/Create \/SC MINUTE \/MO 3 \/TN \"InetlSecurityAssistManager\" \/TR \"wscript %path%\" \/f\nThe Trojan uses HTTP to communicate with its C2 server, specifically using the InternetExplorer application object within an embedded Microsoft .NET Framework assembly called Interop.SHDocVw. The Trojan extracts and loads this embedded assembly by concatenating the contents of two resources named S1 and S2 and decompresses the resulting data using the GZipSteam class. The resulting Interop.SHDocVw .NET assembly is packed with SmartAssembly and further obfuscated using Confuser v1.9.0.0. The concatenation of resources to construct embedded assemblies is not a new technique for the OilRig group, as they used the very same technique in October 2017 in their ISMInjector tool to construct its embedded libraries Joiner.dll and Inner.dll.\nBy using the InternetExplorer application object, all C2 related requests will look as if they came from the legitimate browser and therefore will not contain any anomalous fields within the request, such as custom User-Agents. The OopsIE Trojan is configured to use a C2 server hosted at:\nwww.msoffice365cdn[.]com\nThe Trojan will construct specific URLs to communicate with the C2 server and parses the C2 server's response looking for content within the tags &lt;pre&gt; and &lt;\/pre&gt;. The initial HTTP request acts as a beacon, as shown in the image below.\n&nbsp;\n\n&nbsp;\nAs seen in the above request, the Trojan will generate a URL for its beacon with the following structure:\nhttp:\/\/&lt;c2 domain&gt;\/chk?&lt;hex(Environment.UserName\/Environment.MachineName)&gt;\nThe Trojan will issue a request to this URL to check (hence the chk string in the URL) to see if the C2 server has a command for the Trojan to run. The C2 server will respond to the Trojan\u2019s request by echoing the value &lt;hex(Environment.UserName\/Environment.MachineName)&gt; if it wishes to provide additional commands. If the C2 server does not respond with the appropriate echoed data, the Trojan will create a file named srvCheckresponded.tmp in the SpecialFolder.CommonApplicationData folder and write nothing to it before exiting.\nIf the C2 server provides the appropriate echoed data in the response, the Trojan attempts to determine what\u00a0 commands the C2 wishes to run by issuing a request to the following URL:\nhttp:\/\/&lt;c2 domain&gt;\/what?&lt;hex(Environment.UserName\/Environment.MachineName)&gt;\nAfter issuing the what command, the Trojan will parse the C2's response for the string Oops, which the Trojan will treat as the C2 making a mistake and will exit. Otherwise, the Server will respond with a command followed by a set of parameters, split up by the delimiter &lt;&gt;:\n[command]&lt;&gt;[parameters for command in hexadecimal format]\nThe available commands are:\n\n\n\nCommand\nDescription\n\n\n1\nRun command\n\n\n2\nUpload a file\n\n\n3\nDownload a specified file\n\n\n\n&nbsp;\nThe parameters for each command are issued in hexadecimal format. For instance, the character A would be represented by the two characters 41, which is the hexadecimal representation of that character. This hexadecimal format is used extensively throughout this Trojan.\nThe run command (1) creates the process cmd.exe \/c with the command parameters appended and will write the output of the command in hexadecimal format to the file %APPDATA%\\tmpCa.vbs. The Trojan will then read the hexadecimal formatted contents of this file in 1500 byte blocks, sending each 1500 bytes of data from the file to the C2 server via an HTTP GET request to a URL with the following structure:\nhttp:\/\/&lt;c2 domain&gt;\/resp?&lt;hex(Environment.UserName\/Environment.MachineName)&gt;AAZ&lt;hex(command prompt output)&gt;\nThe upload command (2) writes data provided by the C2 to a specified file. The parameters supplied to this command include hexadecimal values for the binary data and the filename, which are split up by a delimiter of (!). The Trojan will respond to the C2 to notify it of a successful upload by sending a URL structured as follows:\nhttp:\/\/&lt;c2 domain&gt;\/resp?&lt;hex(Environment.UserName\/Environment.MachineName)&gt;AAZ&lt;hex(\"File Uploaded\")&gt;\nThe download command (3) reads the contents of a specified file and sends the data to the C2 server. If the file does not exist, the Trojan will send the C2 server a message &lt; File Not Found &gt; by sending the following URL:\nhttp:\/\/&lt;c2 domain&gt;\/resp?&lt;hex(Environment.UserName\/Environment.MachineName)&gt;AAZ&lt;hex(\"&lt; File Not Found &gt;\")&gt;\nIf the file exists, the Trojan will read the contents of the specified file and compresses the contents using the GZipStream class. The Trojan then gets the hexadecimal values of the compressed data and will replace the following hexadecimal values on each line with ASCII characters to further compressed the data:\n&nbsp;\n\n\n\nString of hexadecimal values\nCharacter replacement\n\n\n000000\nz\n\n\n00000\nx\n\n\n0000\ny\n\n\n000\ng\n\n\n00\nw\n\n\n01\nt\n\n\n\n&nbsp;\nThe Trojan then writes 1500 bytes of the hexadecimal formatted data, one per line to a temporary file in the SpecialFolder.CommonApplicationData folder named as:\n&lt;day&gt;&lt;hour&gt;&lt;second&gt;&lt;millisecond&gt;.tmp\nThe Trojan will then read each line from this temporary file and send them to the C2 server by issuing requests to a URL structured as follows:\nhttp:\/\/&lt;c2 domain&gt;\/resp?&lt;hex(Environment.UserName\/Environment.MachineName)&gt;ABZ&lt;hex(1500 characters of hexadecimal formatted file contents)&gt;\nOnce all of the lines of hexadecimal formatted data in the temporary file are sent to the C2 server, the Trojan will send a request to the C2 server to notify the data has been successfully transmitted via a URL structured as follows:\nhttp:\/\/&lt;c2 domain&gt;\/resp?&lt;hex(Environment.UserName\/Environment.MachineName)&gt;ABZFinish\n&nbsp;\nOverlaps with Previous OilRig Group Attacks\nSince May 2016, we have continued to monitor and uncover various attacks and tools associated with the OilRig group. As we discover new tools used by this group, we have consistently discovered overlapping artifacts with previously used tools and infrastructure. This type of commonality is unsurprising as we are assuming a single adversary, and is an excellent example of how adversaries will often times reuse certain tactics and techniques whether it is for efficiencies sake or sheer laziness.\nIn the attacks described above, we observed a new payload being delivered using a previously unknown command and control domain. However, as we continued to follow the trail of evidence, we found immediate links to past attacks and common artifacts from the OilRig group. The most obvious link is the reuse of the ThreeDollars delivery document, which we had previously observed delivering a different payload. However, we also found other connection to other OilRig group attacks starting with the command and control domain, msoffice365cdn[.]com.\nBeginning with the WHOIS record, we see that the domain was registered by emilia.jones@mail.ru. Examining additional domains registered to this email address reveals the domain office365-management[.]com, which we previously identified in October 2017 to be an OilRig C2. Continuing to examine the WHOIS records, we see that a fairly unique phone number is also used in the record. It is only found in one other WHOIS record, for the domain office365-technical[.]info, which is registered to leonard.horner@mail.ru. Based off the relational links and thematic similarity of the domain name, we have strong reason to believe this domain and registrant are also attributed to the OilRig group.\nMoving onto IP resolutions of the identified domains proves to be fruitful as well. Msoffice365cdn[.]com resolves to 80.82.79.221, which resides on the same class C network range as the IP resolution of office365-technical[.]info, which resolves to 80.82.79.240. In addition, we find that 80.82.79.221 shares an SSL certificate with a small number of other IP addresses, one of which is 185.162.235.29. This IP resolves to office365-management[.]com which was one of the domains registered by the emilia.jones@mail.ru entity. Inspecting the class C network for 185.162.235.0\/24 shows us that another IP on the same network resolves to an OilRig domain, msoffice-cdn[.]com which we identified in August 2017.\nLastly, we examine the delivery document itself. Although we have already identified the documents as a variant of the ThreeDollars tool and analyzed the lure image used in this document in comparison to the previously used lure image, additional artifacts also exist to further strengthen the relational link of this sample and the attack to previous OilRig attributed tools and attacks. In this case, one of the ThreeDollars samples we collected contained a unique author name of J-Win-7-32-Vm. We had previously observed this author name in use once before, in the very first ThreeDollars document we collected that we had reported on in August 2017.\n\n&nbsp;\n&nbsp;\n&nbsp;\nConclusion\nThe OilRig group continues to remain a highly active adversary in the Middle East region. This group has repeatedly shown evidence of a willingness to adapt and evolve their tactics, while also reusing certain aspects as well. We have now observed this adversary deploy a multitude of tools, with each appearing to be some form of iterative variation of something used in the past. However, although the tools themselves have morphed over time, the plays they have executed in their playbook largely remain the same when examined over the attack life cycle. We have added this play to the OilRig playbook, which can be viewed online via our Playbook Viewer.\nPalo Alto Networks customers are protected from this threat by:\n\n \tWildFire detects all ThreeDollars and OopsIE payloads with malicious verdicts.\n \tAutoFocus customers can track these tools with the ThreeDollars and OopsIE\n \tTraps blocks the ThreeDollars delivery documents and the OopsIE payload.\n \tPanAV detects the ThreeDollars samples as Virus\/Win32.WGeneric.pefia and the OopsIE payload as Virus\/Win32.WGeneric.pipwf\n\n&nbsp;\nIndicators of Compromise\nThreeDollars SHA256\nec3f55cac3e8257d6d48e5d543db758fed7d267f14f63a6a5d98ba7a0fab6870\n81eb43ad46ed39bd4b869c709e5e468a6fc714485da288aaa77c80291ce6db8c\n&nbsp;\nOopsIE SHA256\n9a040cdd7c9fcde337b2c3daa2a7208e225735747dd1366e6c0fcbc56815a07f\n231115a614c99e8ddade4cf4c88472bd3801c5c289595fc068e51b77c2c8563f\n&nbsp;\nOopsIE C2\nwww.msoffice365cdn[.]com\n&nbsp;\nRelated Infrastructure\noffice365-management[.]com\noffice365-technical[.]info\nmsoffice-cdn[.]com\n80.82.79.221\n80.82.79.240\n185.162.235.29","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Bryan Lee"},{"@type":"Person","name":"Robert Falcone"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"63718","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=63718' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-63718 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-63718 entry-meta">
			
			
			<span class="post-views-count">29,958</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'63718','like')"><i class="ui ui-2"></i><span class="ml-5">5</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 11</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan%2F+-+OopsIE%21+OilRig+Uses+ThreeDollars+to+Deliver+New+Trojan" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan%2F&title=OopsIE%21+OilRig+Uses+ThreeDollars+to+Deliver+New+Trojan&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/bryanlee/" title="Posts by Bryan Lee" class="author url fn" rel="author">Bryan Lee</a> and <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a>        </p>
        <p><time datetime="2018-02-23T03:00:19+00:00">February 23, 2018 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/confuserex/" rel="tag">ConfuserEx</a>, <a href="https://unit42.paloaltonetworks.com/tag/oilrig/" rel="tag">OilRig</a>, <a href="https://unit42.paloaltonetworks.com/tag/oopsie/" rel="tag">OopsIE</a>, <a href="https://unit42.paloaltonetworks.com/tag/smartassembly/" rel="tag">SmartAssembly</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>The <a href="https://researchcenter.paloaltonetworks.com/tag/oilrig/">OilRig</a> group remains highly active in their attack campaigns while they continue to evolve their toolset. On January 8, 2018, Unit 42 observed the OilRig threat group carry out an attack on an insurance agency based in the Middle East. Just over a week later, on January 16, 2018, we observed an attack on a Middle Eastern financial institution. In both attacks, the OilRig group attempted to deliver a new Trojan that we are tracking as OopsIE.<br />
The January 8 attack used a variant of the <a href="https://researchcenter.paloaltonetworks.com/tag/threedollars/">ThreeDollars delivery document</a>, which we identified as part of the OilRig toolset based on attacks that occurred in <a href="https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/">August 2017</a>.<br />
However, the attack on January 16 did not involve ThreeDollars at all. Instead, this attack involved delivering the OopsIE Trojan directly to the victim, most likely using a link in a spear phishing email. Interestingly, the targeted organization in the January 16 attack had already been targeted by the OilRig group a year ago on January 2017. This repeat attack may suggest that the adversaries have lost their foothold in the targeted organization, or that it may be considered a high value target.<br />
&nbsp;<br />
<span style="font-size: 18pt;">A New Attack</span><br />
On January 8, 2018, the OilRig threat group sent an email with the subject <span style="font-family: 'courier new', courier, monospace;">Beirut Insurance Seminar Invitation</span> to an insurance agency in the Middle East. The OilRig group sent two emails to two different email addresses at the same organization within a six minutes time span. The recipient email addresses suggest they may be the addresses used for specific regional branches of the targeted organization.<br />
Both emails originated from the same address. The email address is associated with the Lebanese domain of a major global financial institution. However, based upon the captured session data, it is highly likely the source email address was spoofed. The email contained an attachment named <span style="font-family: 'courier new', courier, monospace;">Seminar-Invitation.doc</span>, which is a malicious Microsoft Word document we track as ThreeDollars. Examining this sample of ThreeDollars reveals that it contains a new payload, which we have named OopsIE.<br />
In the January 16, 2018 attack, we observed OilRig attacking an organization it previously targeted in January 2017. In this case, the ThreeDollars delivery document was not used and instead an attempt was made to deliver the OopsIE Trojan directly to the targeted organization, likely via a link within an email. The Trojan was directly downloaded from the command and control server for OopsIE, signifying that this server was also used for staging. This suggests that due to the January 2017 attack, the targeted organization may have taken actions to counter known OilRig TTPs, in this case delivering malicious macro documents, causing the OilRig operators to adopt a different delivery tactic.<br />
We also identified another sample of ThreeDollars, created on January 15, 2017 with the file name <span style="font-family: 'courier new', courier, monospace;">strategy preparation.dot</span>. While this sample was very similar to the <span style="font-family: 'courier new', courier, monospace;">Seminar-Invitation.doc</span> sample it also had some significant differences. The primary difference was that this sample was encrypted and password protected, requiring the victim to enter in a password which was likely provided by the adversary to view the document. While this is not a new tactic, this is the first instance where we have observed the OilRig using it in their playbook. Typically, password protected documents is commonly used by adversaries as an evasion tactic to bypass automated analysis mechanisms due to the password requirement for successful execution. As we have observed throughout our tracking of the OilRig group, adopting proven tactics has been a common behavior over time.<br />
&nbsp;<br />
<span style="font-size: 18pt;">ThreeDollars Document Analysis</span><br />
The samples of ThreeDollars we collected in these attacks are structurally very similar to the first sample we <a href="https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan">analyzed in October 2017</a>, down to the lure image used to trick the recipient into clicking the “Enable Content” button to execute the malicious macro. The images used in the January 2018 attacks were the exact same in each sample, verified by file hash.<br />
Figure 1 shows the lure image extracted from the newer attacks, and the lure image from the first sample we analyzed. While it is unsurprising that attacks originating from the same adversary group would use the same resource over time, we analyzed exactly how similar these lure images were.<br />
&nbsp;<br />
<img class="aligncenter wp-image-63721" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar1.png" alt="ThreeDollar1" width="600" height="314" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar1.png 782w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar1-300x157.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar1-768x402.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar1-370x194.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 1 Side-by-side of the lure images within ThreeDollars in the October 2017 and the January 2018 attacks</em></p>
<p>&nbsp;<br />
Superficially, we can immediately see the images are quite similar, but with some glaring differences. The image from the August 2017 attack for example, is significantly larger, using an image resolution of 3508 pixels x 4961 pixels which is also the exact resolution for a sheet of A3 paper at 300 dpi. It also contains some additional artifacts in the image, such as the inclusion of the Microsoft logo as well as additional text, specifically “against unauthorized use”. In comparison, the newer lure image appears to be horizontally distorted due to it being resized to fit into the constraints of the document. In addition, the period after “This document is protected” is misaligned.<br />
By overlaying these two lure images and accounting for the newer image’s distortion, we are able to clearly visualize that the newer image is highly likely to be a cropped and edited version of the August 2017 image.<br />
&nbsp;<br />
<img class="aligncenter wp-image-63760" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/lure.gif" alt="lure" width="600" height="226" /><br />
&nbsp;<br />
Examining the color code used in both images also shows they are the exact same, #da3b01. The dimensions of the newer image are roughly 40% of the older October image, suggesting that after cropping and editing the newer image, the creator is also likely to have resized the image. One peculiar artifact from the original image is the usage of the “st” (unicode \uFB06) <a href="https://en.wikipedia.org/wiki/Typographic_ligature">ligature</a> in the word “against”. This is a highly uncommon glyph and is not generally available in standard keyboard layouts. This may suggest that the string was machine generated rather than directly inputted from a keyboard. The use of this glyph also may suggest that the actor is not a native English speaker.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Malicious Macro Analysis</span><br />
When the victim opens the ThreeDollars document they are presented with the lure image and prompted to click on the “Enable Content” button. When button is clicked, a malicious macro is silently run which installs then executes a payload on a system. A decoy image is also displayed to the victim to lower suspicion of malicious activity. The decoy message that is eventually presented to the victim does not actually show the expected content of an insurance seminar invitation as presented in the delivery email. Instead, it displays a fake error message of <span style="font-family: 'courier new', courier, monospace;">NullRefrencedException! error has occurred in user32.dll by 0x32ef2121</span> within the Word document, as seen in Figure 2.<br />
&nbsp;<br />
<img class="aligncenter wp-image-63805" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar2.png" alt="ThreeDollar2" width="600" height="126" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar2.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar2-900x189.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar2-300x63.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar2-768x161.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar2-370x77.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 2 Decoy message displayed by the malicious macro in ThreeDollars delivery document</em></p>
<p>&nbsp;<br />
While the decoy in Figure 2 is displayed, the macro will search the document for the delimiter <span style="font-family: 'courier new', courier, monospace;">###$$$</span> and write the base64 encoded text that follows this delimiter to the file <span style="font-family: 'courier new', courier, monospace;">%APPDATA%\Base.txt</span>. The macro then creates a scheduled task named <span style="font-family: 'courier new', courier, monospace;">SecurityAssist</span> that runs after waiting one minute. The <span style="font-family: 'courier new', courier, monospace;">SecurityAssist</span> task is responsible for running the following command line command that uses the <span style="font-family: 'courier new', courier, monospace;">Certutil</span> application to decode the base64 encoded data in <span style="font-family: 'courier new', courier, monospace;">Base.txt</span> and saves the decoded data to the file <span style="font-family: 'courier new', courier, monospace;">%PROGRAMDATA%\IntelSecurityAssistManager.exe:</span><br />
<span style="font-family: 'courier new', courier, monospace;">cmd.exe /c Certutil -decode %appdata%\Base.txt %programdata%\IntelSecurityAssistManager.exe &amp; SchTasks /Delete /F /TN SecurityAssist</span><br />
The macro also creates a second scheduled task named <span style="font-family: 'courier new', courier, monospace;">Conhost</span> that waits two minutes and runs a VBScript <span style="font-family: 'courier new', courier, monospace;">%APPDATA%\chkSrv.vbs</span>. The macro saves the <span style="font-family: 'courier new', courier, monospace;">chkSrv.vbs</span> script to the system, which is responsible for running the <span style="font-family: 'courier new', courier, monospace;">IntelSecurityAssistManager.exe</span> payload (OopsIE Trojan) and cleaning up the installation by deleting the two scheduled tasks, the <span style="font-family: 'courier new', courier, monospace;">Base.txt</span> file, the ThreeDollars document, and the <span style="font-family: 'courier new', courier, monospace;">chkSrv.vbs</span> script.<br />
&nbsp;<br />
<span style="font-size: 18pt;">OopsIE Trojan Analysis</span><br />
The OopsIE Trojan delivered in these attacks is packed with SmartAssembly and further obfuscated with ConfuserEx v1.0.0. To run persistently on the system, the Trojan will first create a VBScript file:<br />
<span style="font-family: 'courier new', courier, monospace;">SpecialFolder.CommonApplicationData\srvResesponded.vbs</span><br />
that contains:<br />
<span style="font-family: 'courier new', courier, monospace;">CreateObject(&#8220;WScript.Shell&#8221;).Run(&#8220;%app%&#8221;)</span><br />
The Trojan replaces the <span style="font-family: 'courier new', courier, monospace;">%app%</span> string in the above VBScript with the path to its executable. Finally, the Trojan creates a scheduled task to run itself every three minutes by running the following command on the command prompt after replacing the <span style="font-family: 'courier new', courier, monospace;">%path%</span> string with the path to the <span style="font-family: 'courier new', courier, monospace;">srvResesponded.vbs</span> VBScript:<br />
<span style="font-family: 'courier new', courier, monospace;">SchTasks /Create /SC MINUTE /MO 3 /TN &#8220;InetlSecurityAssistManager&#8221; /TR &#8220;wscript %path%&#8221; /f</span><br />
The Trojan uses HTTP to communicate with its C2 server, specifically using the <span style="font-family: 'courier new', courier, monospace;">InternetExplorer</span> application object within an embedded Microsoft .NET Framework assembly called <span style="font-family: 'courier new', courier, monospace;">Interop.SHDocVw</span>. The Trojan extracts and loads this embedded assembly by concatenating the contents of two resources named <span style="font-family: 'courier new', courier, monospace;">S1</span> and <span style="font-family: 'courier new', courier, monospace;">S2</span> and decompresses the resulting data using the <span style="font-family: 'courier new', courier, monospace;">GZipSteam</span> class. The resulting <span style="font-family: 'courier new', courier, monospace;">Interop.SHDocVw</span> .NET assembly is packed with SmartAssembly and further obfuscated using Confuser v1.9.0.0. The concatenation of resources to construct embedded assemblies is not a new technique for the OilRig group, as they used the very same technique in October 2017 in their <a href="https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/">ISMInjector</a> tool to construct its embedded libraries <span style="font-family: 'courier new', courier, monospace;">Joiner.dll</span> and <span style="font-family: 'courier new', courier, monospace;">Inner.dll</span>.<br />
By using the<span style="font-family: 'courier new', courier, monospace;"> InternetExplorer</span> application object, all C2 related requests will look as if they came from the legitimate browser and therefore will not contain any anomalous fields within the request, such as custom User-Agents. The OopsIE Trojan is configured to use a C2 server hosted at:<br />
<span style="font-family: 'courier new', courier, monospace;">www.msoffice365cdn[.]com</span><br />
The Trojan will construct specific URLs to communicate with the C2 server and parses the C2 server&#8217;s response looking for content within the tags <span style="font-family: 'courier new', courier, monospace;">&lt;pre&gt;</span> and <span style="font-family: 'courier new', courier, monospace;">&lt;/pre&gt;</span>. The initial HTTP request acts as a beacon, as shown in the image below.<br />
&nbsp;<br />
<img class="aligncenter wp-image-63844" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar3.png" alt="ThreeDollar3" width="600" height="153" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar3.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar3-900x230.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar3-300x77.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar3-768x196.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/ThreeDollar3-370x95.png 370w" sizes="(max-width: 600px) 100vw, 600px" /><br />
&nbsp;<br />
As seen in the above request, the Trojan will generate a URL for its beacon with the following structure:<br />
<span style="font-family: 'courier new', courier, monospace;">http://&lt;c2 domain&gt;/chk?&lt;hex(Environment.UserName/Environment.MachineName)&gt;</span><br />
The Trojan will issue a request to this URL to check (hence the chk string in the URL) to see if the C2 server has a command for the Trojan to run. The C2 server will respond to the Trojan’s request by echoing the value <span style="font-family: 'courier new', courier, monospace;">&lt;hex(Environment.UserName/Environment.MachineName)&gt;</span> if it wishes to provide additional commands. <span style="text-decoration: line-through;">I</span>f the C2 server does not respond with the appropriate echoed data, the Trojan will create a file named <span style="font-family: 'courier new', courier, monospace;">srvCheckresponded.tmp</span> in the <span style="font-family: 'courier new', courier, monospace;">SpecialFolder.CommonApplicationData</span> folder and write nothing to it before exiting.<br />
If the C2 server provides the appropriate echoed data in the response, the Trojan attempts to determine what  commands the C2 wishes to run by issuing a request to the following URL:<br />
<span style="font-family: 'courier new', courier, monospace;">http://&lt;c2 domain&gt;/what?&lt;hex(Environment.UserName/Environment.MachineName)&gt;</span><br />
After issuing the <span style="font-family: 'courier new', courier, monospace;">what</span> command, the Trojan will parse the C2&#8217;s response for the string Oops, which the Trojan will treat as the C2 making a mistake and will exit. Otherwise, the Server will respond with a command followed by a set of parameters, split up by the delimiter &lt;&gt;:<br />
<span style="font-family: 'courier new', courier, monospace;">[command]&lt;&gt;[parameters for command in hexadecimal format]</span><br />
The available commands are:</p>
<table align="center">
<tbody>
<tr>
<td width="91"><strong>Command</strong></td>
<td width="186"><strong>Description</strong></td>
</tr>
<tr>
<td width="91">1</td>
<td width="186">Run command</td>
</tr>
<tr>
<td width="91">2</td>
<td width="186">Upload a file</td>
</tr>
<tr>
<td width="91">3</td>
<td width="186">Download a specified file</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
The parameters for each command are issued in hexadecimal format. For instance, the character A would be represented by the two characters <span style="font-family: 'courier new', courier, monospace;">41</span>, which is the hexadecimal representation of that character. This hexadecimal format is used extensively throughout this Trojan.<br />
The run command (1) creates the process <span style="font-family: 'courier new', courier, monospace;">cmd.exe /c</span> with the command parameters appended and will write the output of the command in hexadecimal format to the file <span style="font-family: 'courier new', courier, monospace;">%APPDATA%\tmpCa.vbs.</span> The Trojan will then read the hexadecimal formatted contents of this file in 1500 byte blocks, sending each 1500 bytes of data from the file to the C2 server via an <span style="font-family: 'courier new', courier, monospace;">HTTP GET</span> request to a URL with the following structure:<br />
<span style="font-family: 'courier new', courier, monospace;">http://&lt;c2 domain&gt;/resp?&lt;hex(Environment.UserName/Environment.MachineName)&gt;AAZ&lt;hex(command prompt output)&gt;</span><br />
The upload command (2) writes data provided by the C2 to a specified file. The parameters supplied to this command include hexadecimal values for the binary data and the filename, which are split up by a delimiter of <span style="font-family: 'courier new', courier, monospace;">(!)</span>. The Trojan will respond to the C2 to notify it of a successful upload by sending a URL structured as follows:<br />
<span style="font-family: 'courier new', courier, monospace;">http://&lt;c2 domain&gt;/resp?&lt;hex(Environment.UserName/Environment.MachineName)&gt;AAZ&lt;hex(&#8220;File Uploaded&#8221;)&gt;</span><br />
The download command (3) reads the contents of a specified file and sends the data to the C2 server. If the file does not exist, the Trojan will send the C2 server a message <span style="font-family: 'courier new', courier, monospace;">&lt; File Not Found &gt;</span> by sending the following URL:<br />
<span style="font-family: 'courier new', courier, monospace;">http://&lt;c2 domain&gt;/resp?&lt;hex(Environment.UserName/Environment.MachineName)&gt;AAZ&lt;hex(&#8220;&lt; File Not Found &gt;&#8221;)&gt;</span><br />
If the file exists, the Trojan will read the contents of the specified file and compresses the contents using the <span style="font-family: 'courier new', courier, monospace;">GZipStream</span> class. The Trojan then gets the hexadecimal values of the compressed data and will replace the following hexadecimal values on each line with ASCII characters to further compressed the data:<br />
&nbsp;</p>
<table align="center">
<tbody>
<tr>
<td width="212"><strong>String of hexadecimal values</strong></td>
<td width="175"><strong>Character replacement</strong></td>
</tr>
<tr>
<td width="212">000000</td>
<td width="175">z</td>
</tr>
<tr>
<td width="212">00000</td>
<td width="175">x</td>
</tr>
<tr>
<td width="212">0000</td>
<td width="175">y</td>
</tr>
<tr>
<td width="212">000</td>
<td width="175">g</td>
</tr>
<tr>
<td width="212">00</td>
<td width="175">w</td>
</tr>
<tr>
<td width="212">01</td>
<td width="175">t</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
The Trojan then writes 1500 bytes of the hexadecimal formatted data, one per line to a temporary file in the <span style="font-family: 'courier new', courier, monospace;">SpecialFolder.CommonApplicationData</span> folder named as:<br />
<span style="font-family: 'courier new', courier, monospace;">&lt;day&gt;&lt;hour&gt;&lt;second&gt;&lt;millisecond&gt;.tmp</span><br />
The Trojan will then read each line from this temporary file and send them to the C2 server by issuing requests to a URL structured as follows:<br />
<span style="font-family: 'courier new', courier, monospace;">http://&lt;c2 domain&gt;/resp?&lt;hex(Environment.UserName/Environment.MachineName)&gt;ABZ&lt;hex(1500 characters of hexadecimal formatted file contents)&gt;</span><br />
Once all of the lines of hexadecimal formatted data in the temporary file are sent to the C2 server, the Trojan will send a request to the C2 server to notify the data has been successfully transmitted via a URL structured as follows:<br />
<span style="font-family: 'courier new', courier, monospace;">http://&lt;c2 domain&gt;/resp?&lt;hex(Environment.UserName/Environment.MachineName)&gt;ABZFinish</span><br />
&nbsp;<br />
<span style="font-size: 18pt;">Overlaps with Previous OilRig Group Attacks</span><br />
Since May 2016, we have continued to monitor and uncover various attacks and tools associated with the OilRig group. As we discover new tools used by this group, we have consistently discovered overlapping artifacts with previously used tools and infrastructure. This type of commonality is unsurprising as we are assuming a single adversary, and is an excellent example of how adversaries will often times reuse certain tactics and techniques whether it is for efficiencies sake or sheer laziness.<br />
In the attacks described above, we observed a new payload being delivered using a previously unknown command and control domain. However, as we continued to follow the trail of evidence, we found immediate links to past attacks and common artifacts from the OilRig group. The most obvious link is the reuse of the ThreeDollars delivery document, which we had previously observed delivering a different payload. However, we also found other connection to other OilRig group attacks starting with the command and control domain, <span style="font-family: 'courier new', courier, monospace;">msoffice365cdn[.]com</span>.<br />
Beginning with the WHOIS record, we see that the domain was registered by <span style="font-family: 'courier new', courier, monospace;">emilia.jones@mail.ru</span>. Examining additional domains registered to this email address reveals the domain <span style="font-family: 'courier new', courier, monospace;">office365-management[.]com</span>, which we previously identified in <a href="https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/">October 2017 to be an OilRig C2</a>. Continuing to examine the WHOIS records, we see that a fairly unique phone number is also used in the record. It is only found in one other WHOIS record, for the domain <span style="font-family: 'courier new', courier, monospace;">office365-technical[.]info</span>, which is registered to <span style="font-family: 'courier new', courier, monospace;">leonard.horner@mail.ru</span>. Based off the relational links and thematic similarity of the domain name, we have strong reason to believe this domain and registrant are also attributed to the OilRig group.<br />
Moving onto IP resolutions of the identified domains proves to be fruitful as well. <span style="font-family: 'courier new', courier, monospace;">Msoffice365cdn[.]com</span> resolves to <span style="font-family: 'courier new', courier, monospace;">80.82.79.221</span>, which resides on the same class C network range as the IP resolution of <span style="font-family: 'courier new', courier, monospace;">office365-technical[.]info</span>, which resolves to <span style="font-family: 'courier new', courier, monospace;">80.82.79.240</span>. In addition, we find that <span style="font-family: 'courier new', courier, monospace;">80.82.79.221</span> shares an SSL certificate with a small number of other IP addresses, one of which is <span style="font-family: 'courier new', courier, monospace;">185.162.235.29</span>. This IP resolves to <span style="font-family: 'courier new', courier, monospace;">office365-management[.]com</span> which was one of the domains registered by the <span style="font-family: 'courier new', courier, monospace;">emilia.jones@mail.ru</span> entity. Inspecting the class C network for <span style="font-family: 'courier new', courier, monospace;">185.162.235.0/24</span> shows us that another IP on the same network resolves to an OilRig domain, <span style="font-family: 'courier new', courier, monospace;">msoffice-cdn[.]com</span> which we identified in August 2017.<br />
Lastly, we examine the delivery document itself. Although we have already identified the documents as a variant of the ThreeDollars tool and analyzed the lure image used in this document in comparison to the previously used lure image, additional artifacts also exist to further strengthen the relational link of this sample and the attack to previous OilRig attributed tools and attacks. In this case, one of the ThreeDollars samples we collected contained a unique author name of <span style="font-family: 'courier new', courier, monospace;">J-Win-7-32-Vm.</span> We had previously observed this author name in use once before, in the very first ThreeDollars document we collected that we had reported on in August 2017.<br />
<a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/oopsiemaltego-1.png" rel="wpdevart_lightbox"><img class="aligncenter wp-image-64018" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/oopsiemaltego-1.png" alt="oopsiemaltego" width="800" height="395" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/oopsiemaltego-1.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/oopsiemaltego-1-900x445.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/oopsiemaltego-1-300x148.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/oopsiemaltego-1-768x380.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/02/oopsiemaltego-1-370x183.png 370w" sizes="(max-width: 800px) 100vw, 800px" /></a><br />
&nbsp;<br />
&nbsp;<br />
&nbsp;<br />
<span style="font-size: 18pt;">Conclusion</span><br />
The OilRig group continues to remain a highly active adversary in the Middle East region. This group has repeatedly shown evidence of a willingness to adapt and evolve their tactics, while also reusing certain aspects as well. We have now observed this adversary deploy a multitude of tools, with each appearing to be some form of iterative variation of something used in the past. However, although the tools themselves have morphed over time, the plays they have executed in their playbook largely remain the same when examined over the attack life cycle. We have added this play to the OilRig playbook, which can be viewed online via our <a href="https://pan-unit42.github.io/playbook_viewer/">Playbook Viewer</a>.<br />
Palo Alto Networks customers are protected from this threat by:</p>
<ol>
<li>WildFire detects all ThreeDollars and OopsIE payloads with malicious verdicts.</li>
<li>AutoFocus customers can track these tools with the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.ThreeDollars">ThreeDollars</a> and <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.OopsIE">OopsIE</a></li>
<li>Traps blocks the ThreeDollars delivery documents and the OopsIE payload.</li>
<li>PanAV detects the ThreeDollars samples as Virus/Win32.WGeneric.pefia and the OopsIE payload as Virus/Win32.WGeneric.pipwf</li>
</ol>
<p>&nbsp;<br />
<span style="font-size: 18pt;">Indicators of Compromise</span><br />
<strong><span style="font-size: 12pt;">ThreeDollars SHA256</span></strong><br />
<span style="font-family: 'courier new', courier, monospace;">ec3f55cac3e8257d6d48e5d543db758fed7d267f14f63a6a5d98ba7a0fab6870</span><br />
<span style="font-family: 'courier new', courier, monospace;">81eb43ad46ed39bd4b869c709e5e468a6fc714485da288aaa77c80291ce6db8c</span><br />
&nbsp;<br />
<strong><span style="font-size: 12pt;">OopsIE SHA256</span></strong><br />
<span style="font-family: 'courier new', courier, monospace;">9a040cdd7c9fcde337b2c3daa2a7208e225735747dd1366e6c0fcbc56815a07f</span><br />
<span style="font-family: 'courier new', courier, monospace;">231115a614c99e8ddade4cf4c88472bd3801c5c289595fc068e51b77c2c8563f</span><br />
&nbsp;<br />
<strong><span style="font-size: 12pt;">OopsIE C2</span></strong><br />
<span style="font-family: 'courier new', courier, monospace;">www.msoffice365cdn[.]com</span><br />
&nbsp;<br />
<strong><span style="font-size: 12pt;">Related Infrastructure</span></strong><br />
<span style="font-family: 'courier new', courier, monospace;">office365-management[.]com</span><br />
<span style="font-family: 'courier new', courier, monospace;">office365-technical[.]info</span><br />
<span style="font-family: 'courier new', courier, monospace;">msoffice-cdn[.]com</span><br />
<span style="font-family: 'courier new', courier, monospace;">80.82.79.221</span><br />
<span style="font-family: 'courier new', courier, monospace;">80.82.79.240</span><br />
<span style="font-family: 'courier new', courier, monospace;">185.162.235.29</span></p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
