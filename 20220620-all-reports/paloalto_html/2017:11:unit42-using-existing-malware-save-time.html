
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Using Existing Malware to Save You Time</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-using-existing-malware-save-time/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 demonstrates how using existing malware can enhance research efforts."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-using-existing-malware-save-time/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Using Existing Malware to Save You Time" />
<meta property="og:description" content="Unit 42 demonstrates how using existing malware can enhance research efforts." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-using-existing-malware-save-time/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="#howitsdone" />
<meta property="article:tag" content="Reaver" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-11-22T13:00:29+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 demonstrates how using existing malware can enhance research efforts." />
<meta name="twitter:title" content="Using Existing Malware to Save You Time" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Using Existing Malware to Save You Time Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-using-existing-malware-save-time/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="14"/>
<meta property="og:views" content="20,412"/>
<meta property="og:date_created" content="November 22, 2017 at 5:00 AM"/>
<meta property="og:post_length" content="3759"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Mike Harbison"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/mike-harbison/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Using Existing Malware to Save You Time","name":"Using Existing Malware to Save You Time","description":"Unit 42 demonstrates how using existing malware can enhance research efforts.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-using-existing-malware-save-time\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-using-existing-malware-save-time\/","datePublished":"November 22, 2017","articleBody":"As a malware analyst and reverse engineer, I am often faced with reversing some type of cryptography algorithm or decompression routine that can take hours, days, months, or even years to fully understand.\u00a0 I am often tasked with understanding:\u00a0 What is the blob of data that is used by the malware?\nAnswering the \u201cwhat\u201d is always the challenging part and I usually don\u2019t have a lot of time to fully reverse some crypto routine.\u00a0 I simply need to answer the question:\u00a0 This data is a configuration file that is used by the malware to do XYZ or I simply don\u2019t know what this data is (I don\u2019t like to give this answer, but it happens).\nThere are several different approaches one can take to decrypt\/decompress data from malware.\u00a0 You can run the malware and dump memory segments (dump strings on each sample afterwards), debug the malware in a debugger, place hooks on decryption\/decompression routines and dump return vales, static analysis, etc.\u00a0 While all these approaches are good and will provide you the desired answers they can be somewhat time consuming. What if you have several blobs of data you need decoded\/decompressed?\u00a0 Wouldn\u2019t it be great if you could take the assembly code directly from the malware\u2019s decompression\/decoding routine, put it in a compiler such as Visual Studio, compile it to a dynamic link library (DLL), and then call into it using your favorite scripting language such as Python?\u00a0 This blog will show a technique that can be used to achieve just this.\u00a0 A link to the finished tool hosted on Unit 42\u2019s public tools GitHub repository, which decompresses a data blob within Reaver used as a database lookup for API calls and strings can be found here.\n\nThe Scenario\nFor this example, I was tasked with trying to identify the compression algorithm used as part of our recent analysis into the Reaver malware family and determine if the strings within the malware could be decompressed from the binary without running it.\u00a0 The keyword here being \u201cwithout\u201d.\nDuring my analysis of the Reaver malware family, it appears to implement a modified Lempel-Ziv-Welch (LZW) compression algorithm.\u00a0 The decompression algorithm from the Reaver malware for this example was found at address:\u00a0 0x100010B2 and is approximately 200 lines of assembly.\u00a0 Decompressed routine example is in Figure 1, below:\n; void __thiscall decompress(_DWORD *this, int nstream, int output, int zero, int zero2, int zero3)\ndecompress      proc near               ; CODE XREF: decompressingData+5A\u2193p\nnstream         = dword ptr  8\noutput          = dword ptr  0Ch\nzero            = dword ptr  10h\nzero2           = dword ptr  14h\nzero3           = dword ptr  18h\n                 push    ebp\n                 mov     ebp, esp\n                 push    ebx\n                 push    esi\n                 push    edi\n                 mov     esi, ecx\n                 push    16512           ; unsigned int\n                 call    Malloc\n                 pop     ecx\n                 mov     edi, eax\n                 mov     ecx, 1020h\n                 xor     eax, eax\n                 mov     [esi], edi\n                 xor     ebx, ebx\n                 rep stosd\nFigure 1 Reaver decompression routine\nFor brevity the entire code from the malware function is not shown.\u00a0 The important parts to take aware from this are:\n\n \tCalling convention is __thiscall (indicates C++)\n \tFunction takes five arguments\n \tThe function is called once from the malware (number of cross references identified in IDA Pro)\n\nHere is what the function looks like when being called:\nxor     eax, eax\nmov     ecx, [ebp+v6]\npush    eax\npush    eax\npush    eax\nmovzx   eax, word ptr [ebx+24]\npush    dword ptr [edx] ; output\nlea     eax, [eax+ebx+26]\npush    eax\ncall    decompress\nFigure 2 Calling Reaver decompression routine\nHere\u2019s an overview of calling the decompressed function:\n\n \tClears EAX register, so EAX is zero\n \tPointer to the object is stored in ECX (Thiscall)\n \tThe three pushes of EAX indicate that the last three parameters to the decompressed routine are always zero.\n \tParameter two is a pointer to a destination buffer.\n \tParameter one is a pointer to the compressed data.\n\nThe compressed data is:\n08 00 A5 04 01 12 03 06  8C 18 36 7A 04 21 62 25   ..\u00a5.....\u0152.6z.!b%\n08 94 24 33 64 B8 20 C3  86 4D 03 05 02 09 1A 8C   .\u201d$3d\u00b8 \u00c3\u2020M.....\u0152\n71 A3 C7 91 32 74 AA CC  29 23 C7 49 98 36 65 82   q\u00a3\u00c7\u20182t\u00aa\u00cc)#\u00c7I\u02dc6e\u201a\n5C CC 58 F0 20 8E 1E 52  CA 9C 19 C2 E6 CD C8 25   \\\u00ccX\u00f0 \u017d.R\u00ca\u0153.\u00c2\u00e6\u00cd\u00c8%\n65 F2 AC 1C D8 32 46 0E  98 32 9F C0 29 E3 06 67   e\u00f2\u00ac.\u00d82F.\u02dc2\u0178\u00c0)\u00e3.g\n9E 22 78 54 62 E4 69 50  06 0C A0 33 E5 94 09 43   \u017e\"xTb\u00e4iP..\u00a03\u00e5\u201d.C\nA7 8C 51 A4 4A 59 36 8D  01 75 0A 48 2B 61 D8 D4   \u00a7\u0152Q\u00a4JY6..u.H+a\u00d8\u00d4\n29 83 75 A7 46 18 32 64  40 25 52 86 0D C8 32 60   )\u0192u\u00a7F.2d@%R\u2020.\u00c82`\nC5 A6 34 DB 52 C6 0C 85  64 D4 D4 99 43 87 CA 9B   \u00c5\u00a64\u00dbR\u00c6.\u2026d\u00d4\u00d4&#x2122;C\u2021\u00ca\u203a\n35 44 A1 C8 49 63 27 8D  DB 33 65 E6 D0 6D 4A A3   5D\u00a1\u00c8Ic'.\u00db3e\u00e6\u00d0mJ\u00a3\n07 93 37 7F EB C0 11 4C  D8 B0 4C B8 61 C7 66 65   .\u201c7.\u00eb\u00c0.L\u00d8\u00b0L\u00b8a\u00c7fe\n8A B6 46 0F A1 81 E5 BC  19 93 78 8E 5F C0 6E 16   \u0160\u00b6F.\u00a1.\u00e5\u00bc.\u201cx\u017d_\u00c0n.\nA3 4D 38 85 4E 18 39 74  BC CA 29 4C 7A F3 59 19   \u00a3M8\u2026N.9t\u00bc\u00ca)Lz\u00f3Y.\nFigure 3 Reaver compresed data\nFor brevity the entire contents of the compressed data are not shown.\u00a0 The entire size is:\u00a0 ~45,115 bytes.\nBytes 1-7 (08 00 A5 04 01 12 03) appear to be a magic header for the compression routine and was found in all Reaver malware variants.\nArmed with this knowledge we can now turn our focus to the inner working of the decompression routine.\nNote:\u00a0 From here one could simply monitor the return from the call and dump the contents of the destination buffer, which would contain the decompressed data, but this would require running the code from a debugger.\u00a0 Remember our goal is to not run the sample.\nAt this point we have enough general information that we can begin to create a DLL, so start up Visual Studio or any compiler that handles compiling assembly (NASM\/MASM).\u00a0 Create a new empty DLL project and add a new header file.\u00a0 For example, I created a header with the following information:\n#pragma once\n#ifndef _DEFINE_LZWDecompress_DLL\n#define _DEFINE_LZWDecompress_DLL\n\t#ifdef __cplusplus\n\textern \"C\" {\n\t#endif\n\t\t__declspec(dllexport) BOOL  Decompress(char *src, char *dst);\n\t#ifdef __cplusplus\n\t}\n\t#endif\n\tBOOL Decompress(char *src, char *dst);\n#endif\nFigure 4 C Header file\n\nThe above code creates a single export named \u201cDecompress\u201d and accepts two arguments.\u00a0 Why two and not five?\u00a0 Since the other three arguments will always be zero there is no need to define them.\u00a0 The return type for our function is a Boolean.\nFor your source file (.cpp or .c), take the assembly from IDA Pro or your debugger and add it to your source file. Here is what my source file looks like (after I fixed it up):\n#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n#include \"TestDLL.h\"\nBOOL Decompress(char *src, char *dst)\n{\n\t\/\/Use calloc vs malloc.  Temp buffer is for the dictionary\n\tvoid *pTmpbuff;\n\tpTmpbuff = (int*) calloc(0x4080u, sizeof(unsigned int));\n\tif (src &amp;&amp; dst)\n\t{\n\t\t__asm\n\t\t{\n\t\t\txor ebx, ebx;  \/\/Need to clear ebx register\n\t\t\tSUB ESP, 0x40; \/\/Need to subtract stack, so we don\u2019t overwrite some Ctypes return data\n\t\t\tMOV ESI, ESP;\n\t\t\tPUSH EAX;\n\t\t\tPOP EDI;\t\t\/\/Our Temp Buffer\n\t\t\tPUSH[EBP + 8];      \/\/Source Buffer\n\t\t\tPOP EAX;\n\t\t\tPUSH[EBP + 0xC];  \/\/Destination Buffer\n\t\t\tPOP EDX;\n\t\t\tLEA ECX, DWORD PTR DS : [EAX + 1]; \/\/Where we start.  Get the 1st DWORD of the compressed data appears to be magic value\n\t\t\tMOV DWORD PTR DS : [ESI], EDI;\/\/Temp buffer address\n\t\t\tMOV DWORD PTR DS : [ESI + 0x1C], EDX;\/\/Destination address\n\t\t\tMOV DWORD PTR DS : [ESI + 0x18], ECX;\/\/Compressed Data\n\t\t\tMOV BYTE PTR DS : [ESI + 0x20], BL;\/\/0\n\t\t\tMOV CL, BYTE PTR DS : [EAX];\/\/08\n\t\t\tPUSH 1;\n\t\t\tPOP EAX;\n\t\t\tMOV BYTE PTR DS : [ESI + 0x22], CL;\n\t\t\tSHL EAX, CL;\n\t\t\tMOV DWORD PTR DS : [ESI + 0x30], EBX;\n\t\t\tMOV WORD PTR DS : [ESI + 8], AX;\n\t\t\tINC EAX;\n\t\t\tMOV WORD PTR DS : [ESI + 0xA], AX;\n\t\t\tMOV EAX, DWORD PTR SS : [EBP + 0x10];\n\t\t\tMOV DWORD PTR DS : [ESI + 0x2C], EAX;\n\t\t\tLEA EAX, DWORD PTR DS : [EAX * 8 + 0x1F];\n\t\t\tSHR EAX, 5;\n\t\t\tSHL EAX, 2;\n\t\t\tCMP BYTE PTR SS : [EBP + 0x18], BL;\n\t\t\tMOV DWORD PTR DS : [ESI + 0x38], EAX;\n\t\t\tSETE AL;\n\t\t\tDEC EAX;\n\t\t\tAND AL, 1;\n\t\t\tADD EAX, 0x0FF;\n\t\t\tCMP AL, BL;\n\t\t\tMOV BYTE PTR DS : [ESI + 0xC], AL;\n\t\t\tJNZ SHORT check3;\n\t\t\tMOV EAX, DWORD PTR SS : [EBP + 0x14];\n\t\t\tMOV DWORD PTR DS : [ESI + 0x14], EDX;\n\t\t\tMOV DWORD PTR DS : [ESI + 0x28], EAX;\n\t\t\tMOV DWORD PTR DS : [ESI + 0x34], EBX;\ncheck3:\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check4;\ncheck26:\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check10;\n\t\t\tMOV EDI, EAX;\n\t\t\tCMP DI, WORD PTR DS : [ESI + 0xA];\n\t\t\tJE Finished;\n\t\t\tCMP DI, WORD PTR DS : [ESI + 8];\n\t\t\tJNZ SHORT check22;\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check4;\ncheck24:\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check10;\n\t\t\tMOV EDI, EAX\n\t\t\tCMP DI, WORD PTR DS : [ESI + 8]\n\t\t\tJNZ SHORT check23;\n\t\t\tJMP SHORT check24;\ncheck22:\n\t\t\tCMP DI, WORD PTR DS : [ESI + 0X24]\n\t\t\tJNB SHORT check25;\n\t\t\tPUSH EDI\n\t\t\tJMP SHORT check27;\ncheck25:\n\t\t\tPUSH EBX;\ncheck27:\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check28;\n\t\t\tMOVZX AX, AL;\n\t\t\tPUSH EAX;\n\t\t\tPUSH EBX;\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check31;\n\t\t\tPUSH EDI;\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check35;\n\t\t\tMOV EBX, EDI;\n\t\t\tJMP SHORT check26;\ncheck10:\n\t\t\tMOVZX EAX, BYTE PTR DS : [ECX + 0x20];\n\t\t\tPUSH EBX;\n\t\t\tPUSH ESI;\n\t\t\tPUSH EDI;\n\t\t\tMOVZX EDI, BYTE PTR DS : [ECX + 0x23];\n\t\t\tADD EAX, EDI;\n\t\t\tCMP EAX, 8;\n\t\t\tJA SHORT Check6;\n\t\t\tMOV EDX, DWORD PTR DS : [ECX + 0x18];\n\t\t\tMOVZX ESI, BYTE PTR DS : [EDX];\n\t\t\tJMP SHORT Check8;\n\t\tCheck6:\n\t\t\tMOV EDX, DWORD PTR DS : [ECX + 0x18];\n\t\t\tCMP EAX, 0x10;\n\t\t\tJA SHORT Check7;\n\t\t\tMOVZX ESI, WORD PTR DS : [EDX];\n\t\t\tJMP SHORT Check8;\n\t\tCheck7:\n\t\t\tMOVZX ESI, BYTE PTR DS : [EDX + 2];\n\t\t\tMOVZX EBX, WORD PTR DS : [EDX];\n\t\t\tSHL ESI, 0X10;\n\t\t\tOR ESI, EBX;\n\t\tCheck8:\n\t\t\tMOV EBX, EAX;\n\t\t\tPUSH 0x20;\n\t\t\tSHR EBX, 3;\n\t\t\tADD EBX, EDX;\n\t\t\tMOV DL, AL;\n\t\t\tAND DL, 7;\n\t\t\tMOV DWORD PTR DS : [ECX + 0X18], EBX;\n\t\t\tMOV BYTE PTR DS : [ECX + 0X20], DL;\n\t\t\tPOP ECX;\n\t\t\tSUB ECX, EAX;\n\t\t\tMOV EAX, ESI;\n\t\t\tPUSH 0x20;\n\t\t\tSHL EAX, CL;\n\t\t\tPOP ECX;\n\t\t\tSUB ECX, EDI;\n\t\t\tPOP EDI;\n\t\t\tPOP ESI;\n\t\t\tPOP EBX;\n\t\t\tSHR EAX, CL;\n\t\t\tRETN;\n\t\tcheck28:\n\t\t\tMOV EAX, DWORD PTR DS : [ECX];\n\t\t\tMOV EDX, DWORD PTR SS : [ESP + 4];\n\t\tcheck30:\n\t\t\tMOVZX ECX, DX;\n\t\t\tMOV CX, WORD PTR DS : [EAX + ECX * 4];\n\t\t\tCMP CX, 0x0FFFF;\n\t\t\tJE SHORT check29;\n\t\t\tMOV EDX, ECX;\n\t\t\tJMP SHORT check30;\n\t\tcheck29:\n\t\t\tMOVZX ECX, DX;\n\t\t\tMOV AL, BYTE PTR DS : [EAX + ECX * 4 + 2];\n\t\t\tRETN 4;\n\t\tcheck31:\n\t\t\tMOVZX EDX, WORD PTR DS : [ECX + 0x24];\n\t\t\tLEA EAX, DWORD PTR DS : [ECX + 0x24];\n\t\t\tPUSH ESI;\n\t\t\tMOV ESI, DWORD PTR DS : [ECX];\n\t\t\tPUSH EDI;\n\t\t\tMOV DI, WORD PTR SS : [ESP + 0xC];\n\t\t\tMOV WORD PTR DS : [ESI + EDX * 4], DI;\n\t\t\tMOV ESI, DWORD PTR DS : [ECX];\n\t\t\tMOVZX EDX, WORD PTR DS : [EAX];\n\t\t\tMOV DI, WORD PTR SS : [ESP + 0x10];\n\t\t\tMOV WORD PTR DS : [ESI + EDX * 4 + 2], DI;\n\t\t\tINC WORD PTR DS : [EAX];\n\t\t\tMOV AX, WORD PTR DS : [EAX];\n\t\t\tPOP EDI;\n\t\t\tCMP AX, 8;\n\t\t\tPOP ESI;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x10;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x20;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x40;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x80;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x100;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x200;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x400;\n\t\t\tJE SHORT check32;\n\t\t\tCMP AX, 0x800;\n\t\t\tJNZ SHORT check33;\n\t\tcheck32:\n\t\t\tINC BYTE PTR DS : [ECX + 0x23];\n\t\tcheck33:\n\t\t\tRETN 8;\n\t\tcheck4:\n\t\t\tMOV EDX, ECX;\n\t\t\tPUSH EDI;\n\t\t\tMOV ECX, 0x1000;\n\t\t\tOR EAX, 0xFFFFFFFF;\n\t\t\tMOV EDI, DWORD PTR DS : [EDX]\n\t\t\tREP STOS DWORD PTR ES : [EDI];\n\t\t\tXOR EAX, EAX;\n\t\t\tPOP EDI;\n\t\t\tCMP WORD PTR DS : [EDX + 8], AX;\n\t\t\tJBE SHORT check1;\n\t\t\tPUSH ESI;\n\t\t\tMOV ESI, DWORD PTR DS : [EDX];\n\t\tcheck2:\n\t\t\tMOVZX ECX, AX;\n\t\t\tMOV WORD PTR DS : [ESI + ECX * 4 + 2], AX;\n\t\t\tINC EAX;\n\t\t\tCMP AX, WORD PTR DS : [EDX + 8];\n\t\t\tJB SHORT check2;\n\t\t\tPOP ESI;\n\t\tcheck1:\n\t\t\tMOV AX, WORD PTR DS : [EDX + 0xA];\n\t\t\tINC AX;\n\t\t\tMOV WORD PTR DS : [EDX + 0x24], AX;\n\t\t\tMOV AL, BYTE PTR DS : [EDX + 0x22];\n\t\t\tINC AL;\n\t\t\tMOV BYTE PTR DS : [EDX + 0x23], AL;\n\t\t\tRETN;\n\t\tcheck23:\n\t\t\tPUSH EDI;\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check35;\n\t\t\tMOV EBX, EDI;\n\t\t\tJMP SHORT check26;\n\t\tcheck35:\n\t\t\tPUSH EBP;\n\t\t\tMOV EBP, ESP;\n\t\t\tPUSH ESI;\n\t\t\tPUSH EDI;\n\t\t\tMOV ESI, ECX;\n\t\t\tNOP;\n\t\t\tMOV AX, WORD PTR SS : [EBP + 8];\n\t\t\tCMP AX, WORD PTR DS : [ESI + 8];\n\t\t\tJNB SHORT check36;\n\t\t\tNOP;\n\t\t\tMOV ECX, DWORD PTR DS : [ESI];\n\t\t\tMOV EDX, DWORD PTR DS : [ESI + 0x1C];\n\t\t\tMOV EDI, DWORD PTR DS : [ESI + 0x30];\n\t\t\tMOVZX EAX, AX;\n\t\t\tMOV AL, BYTE PTR DS : [ECX + EAX * 4 + 2];\n\t\t\tMOV BYTE PTR DS : [EDX + EDI], AL;\n\t\t\tINC DWORD PTR DS : [ESI + 0x30];\n\t\t\tNOP;\n\t\t\tMOV EAX, DWORD PTR DS : [ESI + 0x30];\n\t\t\tCMP EAX, DWORD PTR DS : [ESI + 0x2C];\n\t\t\tJNZ SHORT FuncRetn;\n\t\t\tMOV ECX, ESI;\n\t\t\tCALL check37;\n\t\t\tNOP;\n\t\t\tJMP SHORT FuncRetn;\ncheck36:\n\t\t\tMOVZX EDI, AX;\n\t\t\tMOV EAX, DWORD PTR DS : [ESI];\n\t\t\tMOV ECX, ESI;\n\t\t\tSHL EDI, 2;\n\t\t\tMOV AX, WORD PTR DS : [EDI + EAX];\n\t\t\tPUSH EAX;\n\t\t\tCALL check35;\n\t\t\tNOP;\n\t\t\tMOV EAX, DWORD PTR DS : [ESI];\n\t\t\tMOV ECX, ESI;\n\t\t\tMOV AX, WORD PTR DS : [EDI + EAX + 2];\n\t\t\tPUSH EAX;\n\t\t\tCALL check35;\n\t\t\tNOP;\n\t\t\tNOP;\n\t\t\tPOP EDI;\n\t\t\tPOP ESI;\n\t\t\tPOP EBP;\n\t\t\tRETN 4;\n\t\tcheck38:\n\t\t\tMOVZX EDX, AL;\n\t\t\tMOVZX EDX, BYTE PTR DS : [EDX + ECX + 0xD];\n\t\t\tADD DWORD PTR DS : [ECX + 0x34], EDX;\n\t\t\tMOV EDX, DWORD PTR DS : [ECX + 0x34];\n\t\t\tCMP EDX, DWORD PTR DS : [ECX + 0x28];\n\t\t\tJB SHORT FuncRetrn2;\n\t\t\tINC AL;\n\t\t\tCMP AL, 4;\n\t\t\tMOV BYTE PTR DS : [ECX + 0xC], AL;\n\t\t\tJNB SHORT Frtn;\n\t\t\tMOVZX EAX, AL;\n\t\t\tMOVZX EAX, BYTE PTR DS : [EAX + ECX + 0xD];\n\t\t\tSHR EAX, 1;\n\t\t\tMOV DWORD PTR DS : [ECX + 0x34], EAX;\n\t\t\tFuncRetrn2:\n\t\t\tMOV EAX, DWORD PTR DS : [ECX + 0x38];\n\t\t\tMOV EDX, DWORD PTR DS : [ECX + 0x14];\n\t\t\tIMUL EAX, DWORD PTR DS : [ECX + 0x34];\n\t\t\tSUB EDX, EAX;\n\t\t\tMOV DWORD PTR DS : [ECX + 0x1C], EDX;\n\t\t\tFrtn:\n\t\t\tRETN;\nFuncRetn:\n\t\t\tNOP;\n\t\t\tPOP EDI;\n\t\t\tPOP ESI;\n\t\t\tPOP EBP;\n\t\t\tRETN 4;\n\t\tcheck37:\n\t\t\tMOV AL, BYTE PTR DS : [ECX + 0xC];\n\t\t\tAND DWORD PTR DS : [ECX + 0x30], 0;\n\t\t\tCMP AL, 0x0FF;\n\t\t\tJNZ SHORT check38;\n\t\t\tMOV EAX, DWORD PTR DS : [ECX + 0x38];\n\t\t\tSUB DWORD PTR DS : [ECX + 0x1C], EAX;\n\t\t\tRETN;\n\t\tFinished:\n\t\t\tMOV ESP,EBP;\n\t\t\tPOP EBP;\n\t\t\t\/\/Debug VS Release build have different stack sizes.  The following is needed for the return parameters and CTYPES\n#ifdef _DEBUG\n\t\t\tADD ESI, 0x120;\n#else\n\t\t\tADD ESI, 0x58; \/\/Need for Pythnon CTypes return parameters!\n#endif\n\t\t\tRETN;\n\t\t}\n\t}\n\treturn TRUE;\n}\nFigure 5 Our decompression routine\nTaking assembly from IDA Pro or a disassembler such as Immunity Debugger isn\u2019t one to one as it does require some work on your part.\u00a0 Unfortunately, you can\u2019t take the assembly and expect things to just magically work.\u00a0 One area that requires special attention are the function calls made within your code block.\u00a0 Each assembly call needs a name (label) and all the code needs to be arranged in the proper calling order, otherwise you will receive unexpected results or crash.\u00a0 Also, it\u2019s important that you copy the assembly for each function call that is made.\u00a0 In this sample, I used the word \u201ccheck\u201d to represent function names or jump locations, as I was quickly working my way through this.\nSince LZW encodes data using an index into a dictionary the first thing the decompression routine does is allocate a buffer of memory 16,512 bytes (0x4080) to create the dictionary.\u00a0 From the assembly, it uses the C++ API malloc to allocate the buffer and then sets the buffer to NULL (this is how malloc works).\u00a0 A simpler and more efficient way is to use calloc function which reduces the number of instructions and allocates the buffer for you.\nWe start by coding this in C++ and then switch to Visual Studio inline assembly using the __asm keyword.\u00a0 The code block within the __asm keyword is where you will place your assembly instructions and make the necessary adjustments; not only for the code to compile, but also to ensure that the stack is aligned properly.\u00a0 In studying the decompression routine, the following instructions were necessary before we can begin to start executing the decompression routine.\n\n \tSet EBX to zero.\n \tSubtract 64 bytes (0x40) from the stack. Necessary to prevent us from overwriting any stack data\n \tSave our stack pointer into ESI\n \tEDI needs to point to our dictionary buffer created via calloc\n \tEAX needs to point to our source data\n \tEDX needs to point to our destination buffer\n\nThe following nine lines were manually added in-order to satisfy the requirements for the decompression algorithm.\u00a0 The remaining code was copied directly from Immunity Debugger.\nxor ebx, ebx;          \/\/Need to clear ebx register\nSUB ESP, 0x40;    \/\/Need to subtract stack, so we don\u2019t overwrite some Ctypes return data\nMOV ESI, ESP;\nPUSH EAX;\nPOP EDI;\t\/\/Our Temp Buffer\nPUSH[EBP + 8];  \/\/Source Buffer\nPOP EAX;\nPUSH[EBP + 0xC];  \/\/Destination Buffer\nPOP EDX;\nFigure 6 Setting up decompression routine requirements\nAt this point, all it takes is to update the assembly calls and jumps with meaningful names and arrange them in the correct order.\u00a0 Now the code should compile and run, but when our routine is finished you must restore the stack back, so it returns to the proper caller in this case Python ctypes.\u00a0 The following code was added:\nFinished:\nMOV ESP,EBP;\nPOP EBP;\n\/\/Debug VS Release build have different stack sizes.  The following is needed for the return parameters and CTYPES\n#ifdef _DEBUG\nADD ESI, 0x120;\n#else\nADD ESI, 0x58; \/\/Need for CTypes return parameters!!!!\n#endif\nRETN;\n}\nFigure 7 Adjusting stack for return\nHere we are restoring the stack pointer and base pointer and adding 0x120 or 0x58 to ESI depending if the DLL is a VS debug build or release build.\nNow that we have a DLL we can begin to call into it and pass it data via Python and ctypes.\u00a0 The following Python script uses our DLL to decompresses Reaver data.\n#-------------------------------------------------------------------------------\n# Name:        LzwDecompression\n# Purpose:\n#\n# Author:      Mike Harbison Unit 42\n#\n# Created:     11\/11\/2017\n#-------------------------------------------------------------------------------\nfrom ctypes import *\nimport sys\nimport os.path\nimport argparse\nimport re,struct\nimport subprocess, random\n# MAP types to ctypes\nLPBYTE = POINTER(c_ubyte)\nLPCSTR = LPCTSTR = c_char_p\nBOOL = c_bool\nif os.name != 'nt':\n    print (\"Script can only be run from Windows\")\n    sys.exit(\"Sorry Windows only\")\ndef assert_success(success):\n    if not success:\n        raise AssertionError(FormatError())\ndef LzwDecompress(hdll,data):\n    inbuf = create_string_buffer(data)\n    outbuf= create_string_buffer(len(data))\n    success = hdll.Decompress(inbuf,outbuf)\n    assert_success(success)\n    return outbuf.raw\ndef CabExtract(match,pargs,data):\n    offset = match.start()\n    CabHeaderMagicValue = offset + 124\n    CabSizeStart = offset + 132\n    CabFileNameStart = offset + 184\n    CabFileNameEnd = data[CabFileNameStart:].find('\\0')\n    CabName = data[CabFileNameStart:CabFileNameStart+CabFileNameEnd]\n    CabSize = struct.unpack(\"L\",data[CabSizeStart:CabSizeStart+4])[0]\n    CabData = data[CabHeaderMagicValue:CabHeaderMagicValue+CabSize]\n    FileName=pargs.input_file\n    #Add magic value\n    Cab=\"4D534346\".decode('hex')+CabData[4:]\n    print \"Found our CAB Data at file offset--&gt;{}\".format(offset)\n    CabDir=os.path.splitext(FileName)[0]\n    if not os.path.exists(CabDir):\n        os.makedirs(CabDir)\n    else:\n        CabDir+='_'+str(random.randint(1111,9999))\n        os.makedirs(CabDir)\n    CabFile=os.path.basename(FileName).split('.')[0]+\".cab\"\n    with open(CabDir+\"\\\\\"+CabFile,\"wb\") as fp:\n        fp.write(Cab)\n    print \"Wrote CAB File--&gt;%s\"%CabDir+\"\\\\\"+CabFile\n    print \"Expanding CAB File %s\"%CabName\n    args = [\" -r \",CabDir + \"\\\\\" + CabFile,' ',CabDir]\n    result=subprocess.Popen(\"expand \"+\"\".join(args), stdout=subprocess.PIPE)\n    result.wait()\n    if \"Expanding Files Complete\" not in result.stdout.read():\n        print \"Error Expanding CAB file\"\n        sys.exit(1)\n    ExpandedFile = CabDir + \"\\\\\" + CabName\n    if not os.path.isfile(ExpandedFile):\n        print \"Did not find our expanded file %s\"%CabName\n        sys.exit(1)\n    print \"Check directory %s for expanded file %s\"%(CabDir,CabName)\n    return ExpandedFile\ndef DecompressRoutine(pargs,hlzw,data):\n    LzwCompPattern = \"\\x08\\x00\\xA5\\x04\\x01\\x12\\x03\"\n    regex = re.compile(LzwCompPattern)\n    for match in regex.finditer(data):\n        offset=match.start()\n        print \"Found our compression header at file offset--&gt;{}\".format(offset)\n        Deflated=LzwDecompress(hlzw,data[offset:])\n        if Deflated:\n            with open(pargs.out_file, \"wb\") as wp:\n                wp.write(Deflated)\n            print \"Wrote decompressed stream to file--&gt;%s\"%(pargs.out_file)\n            return True\n    return False\ndef Start(pargs,hlzw,data):\n    CabCompPattern = bytearray(\"46444944657374726F790000464449436F7079004644494973436162696E657400000000464449437265617465000000636162696E65742E646C6C004D6963726F736F6674\")\n    #Check For CAB file magic value first\n    found = False\n    regex = re.compile(CabCompPattern.decode('hex'))\n    for match in regex.finditer(data):\n        found = True\n        ExpandedFile=CabExtract(match,pargs,data)\n        if ExpandedFile:\n            with open(ExpandedFile,\"rb\") as fp:\n                ExpandedData=fp.read()\n                DecompressRoutine(pargs,hlzw,ExpandedData)\n            return True\n    if not found:\n        result=DecompressRoutine(pargs,hlzw,data)\n        if result:\n            return True\n        else:\n            return False\ndef main():\n    parser=argparse.ArgumentParser()\n    parser.add_argument(\"-i\", '--infile' , dest='input_file',help=\"Input file to process\",required=True)\n    parser.add_argument(\"-o\", '--outfile', dest='out_file',help=\"Optional Output file name\",required=False)\n    results = parser.parse_args()\n    if not results.out_file:\n        results.out_file=results.input_file + \"_dec.txt\"\n    lzwdll=\"LzwDecompress.dll\"\n    lzwdllpath = os.path.dirname(os.path.abspath(__file__)) + os.path.sep + lzwdll\n    if os.path.isfile(lzwdllpath):\n        lzw = windll.LoadLibrary(lzwdllpath)\n        lzw.Decompress.argtypes=(LPCSTR,LPCSTR)\n        lzw.Decompress.restypes=BOOL\n    else:\n        print (\"Missing LzwDecompress.DLL\")\n        sys.exit(1)\n    with open(results.input_file,\"rb\") as fp:\n        FileData=fp.read()\n        Success=Start(results,lzw,FileData)\n        if not Success:\n            print(\"Did not find CAB or Compression routine in file %s\")%(results.input_file)\nif __name__ == '__main__':\n    main()\nThe Python script was recently updated to support multiple Reaver variants.\u00a0 The newer Reaver variants use Microsoft CAB compression as a first layer followed by LZW modified decompression.\u00a0 The script does the following:\n\n \tLoads our DLL LzwDecompress.dll\n \tAttempts to locate the magic signature values for the modified LZW header or Microsoft CAB\n \tFor the LZW decompression routine creates two string buffers, which are pointers to a buffer. The source buffer is a pointer to the data that needs to be decompressed and the destination buffer is where we will store the decompressed data.\n \tCall the export named Decompress and pass it our two parameters\n \tWrites the data to a file\n\nThe following is an example of the script running:\n\nFigure 8 Script decompressing data\nThe first example is of an older version of Reaver that uses the LZW decompression routine.\u00a0 The decompressed data is written to a text file that contains the following:\nRA@10001=ole32.dll\nRA@10002=CoCreateGuid\nRA@10003=Shlwapi.dll\nRA@10004=SHDeleteKeyA\nRA@10005=wininet.dll\nRA@10006=InternetOpenA\nRA@10007=InternetOpenUrlA\nRA@10008=InternetCloseHandle\nRA@10009=HttpQueryInfoA\nRA@10010=InternetReadFile\n[TRUNCATED]\nRA@10276=image\/jpeg\nRA@10277=netsvcs\nRA@10282=Global\\%sEvt\nRA@10283=\\temp\\%sk.~tmp\nRA@10284=Global\\%skey\nRA@10285=%08x%s\nRA@10286=%s\\\nRA@10287=%s\\*.*\nRA@10288=%s\\%s\nRA@10289=CMD.EXE\nRA@10290=%s=\nRA@10311=\\%sctr.dll\nRA@10312=\\uc.dat\nRA@10313=ChangeServiceConfig2A\nRA@10314=QueryServiceConfig2A\nThe next example is of a newer Reaver sample that added a layer of compression using Microsoft CAB.\n\nFigure 9 Script expanding CAB file and decompressing data\nHere the script found the magic values for Microsoft CAB, expanded the file, read in the expanded file, found the magic value in that file for the decompression routine and wrote the same decompressed data to a text file.\n\nConclusion\nThis blog has shown you that by taking the existing Reaver decompression routine straight from assembly, placing it into Visual Studio, compiling it into a DLL, then calling into it via Python saves us a considerable amount of time.\u00a0 You no longer must reimplement the routine in C or Python as you simply call the routine and pass it the same data as the malware would.\u00a0 The tradeoff is understanding assembly, stacks and knowing what registers the routine requires. Once armed with that knowledge it\u2019s easy to implement and can be applied to any function within a binary.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Mike Harbison"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"51219","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=51219' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-using-existing-malware-save-time%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-using-existing-malware-save-time%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-51219 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Using Existing Malware to Save You Time</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-51219 entry-meta">
			
			
			<span class="post-views-count">20,412</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'51219','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 14</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-using-existing-malware-save-time%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-using-existing-malware-save-time%2F+-+Using+Existing+Malware+to+Save+You+Time" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-using-existing-malware-save-time%2F&title=Using+Existing+Malware+to+Save+You+Time&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-using-existing-malware-save-time/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/mike-harbison/" title="Posts by Mike Harbison" class="author url fn" rel="author">Mike Harbison</a>        </p>
        <p><time datetime="2017-11-22T13:00:29+00:00">November 22, 2017 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/howitsdone/" rel="tag">#howitsdone</a>, <a href="https://unit42.paloaltonetworks.com/tag/reaver/" rel="tag">Reaver</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p>As a malware analyst and reverse engineer, I am often faced with reversing some type of cryptography algorithm or decompression routine that can take hours, days, months, or even years to fully understand. I am often tasked with understanding: What is the blob of data that is used by the malware?<br />
Answering the what is always the challenging part and I usually dont have a lot of time to fully reverse some crypto routine. I simply need to answer the question: This data is a configuration file that is used by the malware to do XYZ or I simply dont know what this data is (I dont like to give this answer, but it happens).<br />
There are several different approaches one can take to decrypt/decompress data from malware. You can run the malware and dump memory segments (dump strings on each sample afterwards), debug the malware in a debugger, place hooks on decryption/decompression routines and dump return vales, static analysis, etc. While all these approaches are good and will provide you the desired answers they can be somewhat time consuming. What if you have several blobs of data you need decoded/decompressed? Wouldnt it be great if you could take the assembly code directly from the malwares decompression/decoding routine, put it in a compiler such as Visual Studio, compile it to a dynamic link library (DLL), and then call into it using your favorite scripting language such as Python? This blog will show a technique that can be used to achieve just this. A link to the finished tool hosted on Unit 42s public tools GitHub repository, which decompresses a data blob within Reaver used as a database lookup for API calls and strings can be found <a href="https://github.com/pan-unit42/public_tools/tree/master/Reaver_Decompression">here</a>.<br />
<span style="font-size: 18pt;"><br />
The Scenario</span><br />
For this example, I was tasked with trying to identify the compression algorithm used as part of our recent analysis into the <a href="https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered">Reaver</a> malware family and determine if the strings within the malware could be decompressed from the binary without running it. The keyword here being without.<br />
During my analysis of the Reaver malware family, it appears to implement a modified <a href="https://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Welch">Lempel-Ziv-Welch (LZW) compression algorithm</a>. The decompression algorithm from the Reaver malware for this example was found at address: 0x100010B2 and is approximately 200 lines of assembly. Decompressed routine example is in Figure 1, below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adaf3783337658" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
; void __thiscall decompress(_DWORD *this, int nstream, int output, int zero, int zero2, int zero3)
decompress      proc near               ; CODE XREF: decompressingData+5Ap
nstream         = dword ptr  8
output          = dword ptr  0Ch
zero            = dword ptr  10h
zero2           = dword ptr  14h
zero3           = dword ptr  18h
                 push    ebp
                 mov     ebp, esp
                 push    ebx
                 push    esi
                 push    edi
                 mov     esi, ecx
                 push    16512           ; unsigned int
                 call    Malloc
                 pop     ecx
                 mov     edi, eax
                 mov     ecx, 1020h
                 xor     eax, eax
                 mov     [esi], edi
                 xor     ebx, ebx
                 rep stosd</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-10">10</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-12">12</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-14">14</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-16">16</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-18">18</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-20">20</div><div class="crayon-num" data-line="crayon-5f694cc4adaf3783337658-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaf3783337658-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-1"><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">__thiscall </span><span class="crayon-e">decompress</span><span class="crayon-sy">(</span><span class="crayon-e ">_DWORD *</span><span class="crayon-r">this</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">nstream</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">zero</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">zero2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">zero3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-2"><span class="crayon-e">decompress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">proc </span><span class="crayon-i">near</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">CODE </span><span class="crayon-v">XREF</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">decompressingData</span><span class="crayon-o">+</span><span class="crayon-cn">5A</span><span class="crayon-i">p</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-3"><span class="crayon-v">nstream</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dword </span><span class="crayon-i">ptr</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-4"><span class="crayon-v">output</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dword </span><span class="crayon-i">ptr</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">0Ch</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-5"><span class="crayon-v">zero</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dword </span><span class="crayon-i">ptr</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">10h</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-6"><span class="crayon-v">zero2</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dword </span><span class="crayon-i">ptr</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">14h</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-7"><span class="crayon-v">zero3</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dword </span><span class="crayon-i">ptr</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">18h</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ebp</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-9"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ebp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">esp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-10"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ebx</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-11"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">esi</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-12"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">edi</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-13"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">esi</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ecx</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-14"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">push</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">16512</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">int</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">call&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Malloc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-16"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">pop&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ecx</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-17"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">edi</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">eax</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-18"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ecx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1020h</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">xor</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">eax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">eax</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-20"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">mov</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-v">esi</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">edi</span></div><div class="crayon-line" id="crayon-5f694cc4adaf3783337658-21"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">xor</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ebx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ebx</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaf3783337658-22"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">rep </span><span class="crayon-v">stosd</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure 1 Reaver decompression routine</em></p>
<p>For brevity the entire code from the malware function is not shown. The important parts to take aware from this are:</p>
<ul>
<li>Calling convention is __thiscall (indicates C++)</li>
<li>Function takes five arguments</li>
<li>The function is called once from the malware (number of cross references identified in IDA Pro)</li>
</ul>
<p>Here is what the function looks like when being called:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adafb113091656" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
xor     eax, eax
mov     ecx, [ebp+v6]
push    eax
push    eax
push    eax
movzx   eax, word ptr [ebx+24]
push    dword ptr [edx] ; output
lea     eax, [eax+ebx+26]
push    eax
call    decompress</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adafb113091656-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafb113091656-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adafb113091656-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafb113091656-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adafb113091656-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafb113091656-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adafb113091656-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafb113091656-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adafb113091656-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafb113091656-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adafb113091656-1"><span class="crayon-st">xor</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">eax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">eax</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafb113091656-2"><span class="crayon-e">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ecx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ebp</span><span class="crayon-o">+</span><span class="crayon-v">v6</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694cc4adafb113091656-3"><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">eax</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafb113091656-4"><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">eax</span></div><div class="crayon-line" id="crayon-5f694cc4adafb113091656-5"><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">eax</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafb113091656-6"><span class="crayon-e">movzx&nbsp;&nbsp; </span><span class="crayon-v">eax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-i">ptr</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ebx</span><span class="crayon-o">+</span><span class="crayon-cn">24</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694cc4adafb113091656-7"><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">dword </span><span class="crayon-i">ptr</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">edx</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafb113091656-8"><span class="crayon-e">lea&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">eax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">eax</span><span class="crayon-o">+</span><span class="crayon-v">ebx</span><span class="crayon-o">+</span><span class="crayon-cn">26</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694cc4adafb113091656-9"><span class="crayon-e">push&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">eax</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafb113091656-10"><span class="crayon-e">call&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">decompress</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure 2 Calling Reaver decompression routine</em></p>
<p>Heres an overview of calling the decompressed function:</p>
<ul>
<li>Clears EAX register, so EAX is zero</li>
<li>Pointer to the object is stored in ECX (Thiscall)</li>
<li>The three pushes of EAX indicate that the last three parameters to the decompressed routine are always zero.</li>
<li>Parameter two is a pointer to a destination buffer.</li>
<li>Parameter one is a pointer to the compressed data.</li>
</ul>
<p>The compressed data is:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adafd936507370" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
08 00 A5 04 01 12 03 06  8C 18 36 7A 04 21 62 25   ........6z.!b%
08 94 24 33 64 B8 20 C3  86 4D 03 05 02 09 1A 8C   .$3d M.....
71 A3 C7 91 32 74 AA CC  29 23 C7 49 98 36 65 82   q2t)#I6e
5C CC 58 F0 20 8E 1E 52  CA 9C 19 C2 E6 CD C8 25   \X .R.%
65 F2 AC 1C D8 32 46 0E  98 32 9F C0 29 E3 06 67   e.2F.2).g
9E 22 78 54 62 E4 69 50  06 0C A0 33 E5 94 09 43   "xTbiP..3.C
A7 8C 51 A4 4A 59 36 8D  01 75 0A 48 2B 61 D8 D4   QJY6..u.H+a
29 83 75 A7 46 18 32 64  40 25 52 86 0D C8 32 60   )uF.2d@%R.2`
C5 A6 34 DB 52 C6 0C 85  64 D4 D4 99 43 87 CA 9B   4R.dC
35 44 A1 C8 49 63 27 8D  DB 33 65 E6 D0 6D 4A A3   5DIc'.3emJ
07 93 37 7F EB C0 11 4C  D8 B0 4C B8 61 C7 66 65   .7..LLafe
8A B6 46 0F A1 81 E5 BC  19 93 78 8E 5F C0 6E 16   F...x_n.
A3 4D 38 85 4E 18 39 74  BC CA 29 4C 7A F3 59 19   M8N.9t)LzY.</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adafd936507370-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafd936507370-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adafd936507370-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafd936507370-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adafd936507370-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafd936507370-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adafd936507370-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafd936507370-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adafd936507370-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafd936507370-10">10</div><div class="crayon-num" data-line="crayon-5f694cc4adafd936507370-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adafd936507370-12">12</div><div class="crayon-num" data-line="crayon-5f694cc4adafd936507370-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adafd936507370-1"><span class="crayon-cn">08</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-h"> </span><span class="crayon-i">A5</span><span class="crayon-h"> </span><span class="crayon-cn">04</span><span class="crayon-h"> </span><span class="crayon-cn">01</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-h"> </span><span class="crayon-cn">03</span><span class="crayon-h"> </span><span class="crayon-cn">06</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">8C</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-h"> </span><span class="crayon-cn">7A</span><span class="crayon-h"> </span><span class="crayon-cn">04</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-cn">62</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-cn">6z.</span><span class="crayon-o">!</span><span class="crayon-v">b</span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafd936507370-2"><span class="crayon-cn">08</span><span class="crayon-h"> </span><span class="crayon-cn">94</span><span class="crayon-h"> </span><span class="crayon-cn">24</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-i">B8</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-i">C3</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">86</span><span class="crayon-h"> </span><span class="crayon-cn">4D</span><span class="crayon-h"> </span><span class="crayon-cn">03</span><span class="crayon-h"> </span><span class="crayon-cn">05</span><span class="crayon-h"> </span><span class="crayon-cn">02</span><span class="crayon-h"> </span><span class="crayon-cn">09</span><span class="crayon-h"> </span><span class="crayon-cn">1A</span><span class="crayon-h"> </span><span class="crayon-cn">8C</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-cn">3d</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694cc4adafd936507370-3"><span class="crayon-cn">71</span><span class="crayon-h"> </span><span class="crayon-e">A3 </span><span class="crayon-i">C7</span><span class="crayon-h"> </span><span class="crayon-cn">91</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-e">AA </span><span class="crayon-i">CC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-cn">23</span><span class="crayon-h"> </span><span class="crayon-i">C7</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-h"> </span><span class="crayon-cn">98</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-cn">82</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">q</span><span class="crayon-cn">2t</span><span class="crayon-sy">)</span><span class="crayon-p">#I6e</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafd936507370-4"><span class="crayon-cn">5C</span><span class="crayon-h"> </span><span class="crayon-i">CC</span><span class="crayon-h"> </span><span class="crayon-cn">58</span><span class="crayon-h"> </span><span class="crayon-i">F0</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">8E</span><span class="crayon-h"> </span><span class="crayon-cn">1E</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">CA</span><span class="crayon-h"> </span><span class="crayon-cn">9C</span><span class="crayon-h"> </span><span class="crayon-cn">19</span><span class="crayon-h"> </span><span class="crayon-e">C2 </span><span class="crayon-e">E6 </span><span class="crayon-e">CD </span><span class="crayon-i">C8</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">\</span><span class="crayon-i">X</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-i">R</span><span class="crayon-sy">.</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-5f694cc4adafd936507370-5"><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-e">F2 </span><span class="crayon-i">AC</span><span class="crayon-h"> </span><span class="crayon-cn">1C</span><span class="crayon-h"> </span><span class="crayon-i">D8</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-h"> </span><span class="crayon-cn">0E</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">98</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-cn">9F</span><span class="crayon-h"> </span><span class="crayon-i">C0</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-i">E3</span><span class="crayon-h"> </span><span class="crayon-cn">06</span><span class="crayon-h"> </span><span class="crayon-cn">67</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">e</span><span class="crayon-sy">.</span><span class="crayon-cn">2F.</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">g</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafd936507370-6"><span class="crayon-cn">9E</span><span class="crayon-h"> </span><span class="crayon-cn">22</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-h"> </span><span class="crayon-cn">62</span><span class="crayon-h"> </span><span class="crayon-i">E4</span><span class="crayon-h"> </span><span class="crayon-cn">69</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">06</span><span class="crayon-h"> </span><span class="crayon-cn">0C</span><span class="crayon-h"> </span><span class="crayon-i">A0</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-i">E5</span><span class="crayon-h"> </span><span class="crayon-cn">94</span><span class="crayon-h"> </span><span class="crayon-cn">09</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-h">&nbsp;&nbsp; </span>"<span class="crayon-i">xTb</span><span class="crayon-v">iP</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-cn">3</span><span class="crayon-sy">.</span><span class="crayon-i">C</span></div><div class="crayon-line" id="crayon-5f694cc4adafd936507370-7"><span class="crayon-i">A7</span><span class="crayon-h"> </span><span class="crayon-cn">8C</span><span class="crayon-h"> </span><span class="crayon-cn">51</span><span class="crayon-h"> </span><span class="crayon-i">A4</span><span class="crayon-h"> </span><span class="crayon-cn">4A</span><span class="crayon-h"> </span><span class="crayon-cn">59</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-h"> </span><span class="crayon-cn">8D</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">01</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-h"> </span><span class="crayon-cn">0A</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-cn">2B</span><span class="crayon-h"> </span><span class="crayon-cn">61</span><span class="crayon-h"> </span><span class="crayon-e">D8 </span><span class="crayon-i">D4</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">Q</span><span class="crayon-v">JY6</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">u</span><span class="crayon-sy">.</span><span class="crayon-v">H</span><span class="crayon-o">+</span><span class="crayon-i">a</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafd936507370-8"><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-cn">83</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-h"> </span><span class="crayon-i">A7</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-cn">86</span><span class="crayon-h"> </span><span class="crayon-cn">0D</span><span class="crayon-h"> </span><span class="crayon-i">C8</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">)</span><span class="crayon-i">u</span><span class="crayon-v">F</span><span class="crayon-sy">.</span><span class="crayon-cn">2d</span><span class="crayon-sy">@</span><span class="crayon-o">%</span><span class="crayon-i">R</span><span class="crayon-sy">.</span><span class="crayon-cn">2</span><span class="crayon-sy">`</span></div><div class="crayon-line" id="crayon-5f694cc4adafd936507370-9"><span class="crayon-e">C5 </span><span class="crayon-i">A6</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-h"> </span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-i">C6</span><span class="crayon-h"> </span><span class="crayon-cn">0C</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-e">D4 </span><span class="crayon-i">D4</span><span class="crayon-h"> </span><span class="crayon-cn">99</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-cn">87</span><span class="crayon-h"> </span><span class="crayon-i">CA</span><span class="crayon-h"> </span><span class="crayon-cn">9B</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">4</span><span class="crayon-i">R</span><span class="crayon-sy">.</span><span class="crayon-i">d</span><span class="crayon-i">C</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafd936507370-10"><span class="crayon-cn">35</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-e">A1 </span><span class="crayon-i">C8</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-h"> </span><span class="crayon-cn">63</span><span class="crayon-h"> </span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-cn">8D</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h"> </span><span class="crayon-e">E6 </span><span class="crayon-i">D0</span><span class="crayon-h"> </span><span class="crayon-cn">6D</span><span class="crayon-h"> </span><span class="crayon-cn">4A</span><span class="crayon-h"> </span><span class="crayon-i">A3</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">5D</span><span class="crayon-i">Ic</span>'<span class="crayon-sy">.</span><span class="crayon-cn">3e</span><span class="crayon-i">mJ</span></div><div class="crayon-line" id="crayon-5f694cc4adafd936507370-11"><span class="crayon-cn">07</span><span class="crayon-h"> </span><span class="crayon-cn">93</span><span class="crayon-h"> </span><span class="crayon-cn">37</span><span class="crayon-h"> </span><span class="crayon-cn">7F</span><span class="crayon-h"> </span><span class="crayon-e">EB </span><span class="crayon-i">C0</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-cn">4C</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">D8 </span><span class="crayon-i">B0</span><span class="crayon-h"> </span><span class="crayon-cn">4C</span><span class="crayon-h"> </span><span class="crayon-i">B8</span><span class="crayon-h"> </span><span class="crayon-cn">61</span><span class="crayon-h"> </span><span class="crayon-i">C7</span><span class="crayon-h"> </span><span class="crayon-cn">66</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">.</span><span class="crayon-cn">7.</span><span class="crayon-sy">.</span><span class="crayon-i">L</span><span class="crayon-i">L</span><span class="crayon-i">a</span><span class="crayon-i">fe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adafd936507370-12"><span class="crayon-cn">8A</span><span class="crayon-h"> </span><span class="crayon-i">B6</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-h"> </span><span class="crayon-cn">0F</span><span class="crayon-h"> </span><span class="crayon-i">A1</span><span class="crayon-h"> </span><span class="crayon-cn">81</span><span class="crayon-h"> </span><span class="crayon-e">E5 </span><span class="crayon-i">BC</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">19</span><span class="crayon-h"> </span><span class="crayon-cn">93</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-h"> </span><span class="crayon-cn">8E</span><span class="crayon-h"> </span><span class="crayon-cn">5F</span><span class="crayon-h"> </span><span class="crayon-i">C0</span><span class="crayon-h"> </span><span class="crayon-cn">6E</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">F</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-i">x</span><span class="crayon-i">_</span><span class="crayon-v">n</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694cc4adafd936507370-13"><span class="crayon-i">A3</span><span class="crayon-h"> </span><span class="crayon-cn">4D</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-h"> </span><span class="crayon-cn">4E</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">BC </span><span class="crayon-i">CA</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-cn">4C</span><span class="crayon-h"> </span><span class="crayon-cn">7A</span><span class="crayon-h"> </span><span class="crayon-i">F3</span><span class="crayon-h"> </span><span class="crayon-cn">59</span><span class="crayon-h"> </span><span class="crayon-cn">19</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">M8</span><span class="crayon-v">N</span><span class="crayon-sy">.</span><span class="crayon-cn">9t</span><span class="crayon-sy">)</span><span class="crayon-i">Lz</span><span class="crayon-v">Y</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure 3 Reaver compresed data</em></p>
<p>For brevity the entire contents of the compressed data are not shown. The entire size is: ~45,115 bytes.<br />
Bytes 1-7 (08 00 A5 04 01 12 03) appear to be a magic header for the compression routine and was found in all Reaver malware variants.<br />
Armed with this knowledge we can now turn our focus to the inner working of the decompression routine.</p>
<blockquote><p><strong>Note</strong>: From here one could simply monitor the return from the call and dump the contents of the destination buffer, which would contain the decompressed data, but this would require running the code from a debugger. Remember our goal is to not run the sample.</p></blockquote>
<p>At this point we have enough general information that we can begin to create a DLL, so start up Visual Studio or any compiler that handles compiling assembly (NASM/MASM). Create a new empty DLL project and add a new header file. For example, I created a header with the following information:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adaff076145643" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#pragma once
#ifndef _DEFINE_LZWDecompress_DLL
#define _DEFINE_LZWDecompress_DLL
	#ifdef __cplusplus
	extern "C" {
	#endif
		__declspec(dllexport) BOOL  Decompress(char *src, char *dst);
	#ifdef __cplusplus
	}
	#endif
	BOOL Decompress(char *src, char *dst);
#endif</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adaff076145643-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaff076145643-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adaff076145643-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaff076145643-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adaff076145643-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaff076145643-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adaff076145643-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaff076145643-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adaff076145643-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaff076145643-10">10</div><div class="crayon-num" data-line="crayon-5f694cc4adaff076145643-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adaff076145643-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adaff076145643-1"><span class="crayon-p">#pragma once</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaff076145643-2"><span class="crayon-p">#ifndef _DEFINE_LZWDecompress_DLL</span></div><div class="crayon-line" id="crayon-5f694cc4adaff076145643-3"><span class="crayon-p">#define _DEFINE_LZWDecompress_DLL</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaff076145643-4"><span class="crayon-h">	</span><span class="crayon-p">#ifdef __cplusplus</span></div><div class="crayon-line" id="crayon-5f694cc4adaff076145643-5"><span class="crayon-h">	</span><span class="crayon-i">extern</span><span class="crayon-h"> </span><span class="crayon-s">"C"</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaff076145643-6"><span class="crayon-h">	</span><span class="crayon-p">#endif</span></div><div class="crayon-line" id="crayon-5f694cc4adaff076145643-7"><span class="crayon-h">		</span><span class="crayon-e">__declspec</span><span class="crayon-sy">(</span><span class="crayon-v">dllexport</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-t">BOOL</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">Decompress</span><span class="crayon-sy">(</span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">src</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">dst</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaff076145643-8"><span class="crayon-h">	</span><span class="crayon-p">#ifdef __cplusplus</span></div><div class="crayon-line" id="crayon-5f694cc4adaff076145643-9"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaff076145643-10"><span class="crayon-h">	</span><span class="crayon-p">#endif</span></div><div class="crayon-line" id="crayon-5f694cc4adaff076145643-11"><span class="crayon-h">	</span><span class="crayon-t">BOOL</span><span class="crayon-h"> </span><span class="crayon-e">Decompress</span><span class="crayon-sy">(</span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">src</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">dst</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adaff076145643-12"><span class="crayon-p">#endif</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure 4 C Header file<br />
</em></p>
<p>The above code creates a single export named Decompress and accepts two arguments. Why two and not five? Since the other three arguments will always be zero there is no need to define them. The return type for our function is a Boolean.<br />
For your source file (.cpp or .c), take the assembly from IDA Pro or your debugger and add it to your source file. Here is what my source file looks like (after I fixed it up):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adb00907059603" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;
#include "TestDLL.h"
BOOL Decompress(char *src, char *dst)
{
	//Use calloc vs malloc.  Temp buffer is for the dictionary
	void *pTmpbuff;
	pTmpbuff = (int*) calloc(0x4080u, sizeof(unsigned int));
	if (src &amp;&amp; dst)
	{
		__asm
		{
			xor ebx, ebx;  //Need to clear ebx register
			SUB ESP, 0x40; //Need to subtract stack, so we dont overwrite some Ctypes return data
			MOV ESI, ESP;
			PUSH EAX;
			POP EDI;		//Our Temp Buffer
			PUSH[EBP + 8];      //Source Buffer
			POP EAX;
			PUSH[EBP + 0xC];  //Destination Buffer
			POP EDX;
			LEA ECX, DWORD PTR DS : [EAX + 1]; //Where we start.  Get the 1st DWORD of the compressed data appears to be magic value
			MOV DWORD PTR DS : [ESI], EDI;//Temp buffer address
			MOV DWORD PTR DS : [ESI + 0x1C], EDX;//Destination address
			MOV DWORD PTR DS : [ESI + 0x18], ECX;//Compressed Data
			MOV BYTE PTR DS : [ESI + 0x20], BL;//0
			MOV CL, BYTE PTR DS : [EAX];//08
			PUSH 1;
			POP EAX;
			MOV BYTE PTR DS : [ESI + 0x22], CL;
			SHL EAX, CL;
			MOV DWORD PTR DS : [ESI + 0x30], EBX;
			MOV WORD PTR DS : [ESI + 8], AX;
			INC EAX;
			MOV WORD PTR DS : [ESI + 0xA], AX;
			MOV EAX, DWORD PTR SS : [EBP + 0x10];
			MOV DWORD PTR DS : [ESI + 0x2C], EAX;
			LEA EAX, DWORD PTR DS : [EAX * 8 + 0x1F];
			SHR EAX, 5;
			SHL EAX, 2;
			CMP BYTE PTR SS : [EBP + 0x18], BL;
			MOV DWORD PTR DS : [ESI + 0x38], EAX;
			SETE AL;
			DEC EAX;
			AND AL, 1;
			ADD EAX, 0x0FF;
			CMP AL, BL;
			MOV BYTE PTR DS : [ESI + 0xC], AL;
			JNZ SHORT check3;
			MOV EAX, DWORD PTR SS : [EBP + 0x14];
			MOV DWORD PTR DS : [ESI + 0x14], EDX;
			MOV DWORD PTR DS : [ESI + 0x28], EAX;
			MOV DWORD PTR DS : [ESI + 0x34], EBX;
check3:
			MOV ECX, ESI;
			CALL check4;
check26:
			MOV ECX, ESI;
			CALL check10;
			MOV EDI, EAX;
			CMP DI, WORD PTR DS : [ESI + 0xA];
			JE Finished;
			CMP DI, WORD PTR DS : [ESI + 8];
			JNZ SHORT check22;
			MOV ECX, ESI;
			CALL check4;
check24:
			MOV ECX, ESI;
			CALL check10;
			MOV EDI, EAX
			CMP DI, WORD PTR DS : [ESI + 8]
			JNZ SHORT check23;
			JMP SHORT check24;
check22:
			CMP DI, WORD PTR DS : [ESI + 0X24]
			JNB SHORT check25;
			PUSH EDI
			JMP SHORT check27;
check25:
			PUSH EBX;
check27:
			MOV ECX, ESI;
			CALL check28;
			MOVZX AX, AL;
			PUSH EAX;
			PUSH EBX;
			MOV ECX, ESI;
			CALL check31;
			PUSH EDI;
			MOV ECX, ESI;
			CALL check35;
			MOV EBX, EDI;
			JMP SHORT check26;
check10:
			MOVZX EAX, BYTE PTR DS : [ECX + 0x20];
			PUSH EBX;
			PUSH ESI;
			PUSH EDI;
			MOVZX EDI, BYTE PTR DS : [ECX + 0x23];
			ADD EAX, EDI;
			CMP EAX, 8;
			JA SHORT Check6;
			MOV EDX, DWORD PTR DS : [ECX + 0x18];
			MOVZX ESI, BYTE PTR DS : [EDX];
			JMP SHORT Check8;
		Check6:
			MOV EDX, DWORD PTR DS : [ECX + 0x18];
			CMP EAX, 0x10;
			JA SHORT Check7;
			MOVZX ESI, WORD PTR DS : [EDX];
			JMP SHORT Check8;
		Check7:
			MOVZX ESI, BYTE PTR DS : [EDX + 2];
			MOVZX EBX, WORD PTR DS : [EDX];
			SHL ESI, 0X10;
			OR ESI, EBX;
		Check8:
			MOV EBX, EAX;
			PUSH 0x20;
			SHR EBX, 3;
			ADD EBX, EDX;
			MOV DL, AL;
			AND DL, 7;
			MOV DWORD PTR DS : [ECX + 0X18], EBX;
			MOV BYTE PTR DS : [ECX + 0X20], DL;
			POP ECX;
			SUB ECX, EAX;
			MOV EAX, ESI;
			PUSH 0x20;
			SHL EAX, CL;
			POP ECX;
			SUB ECX, EDI;
			POP EDI;
			POP ESI;
			POP EBX;
			SHR EAX, CL;
			RETN;
		check28:
			MOV EAX, DWORD PTR DS : [ECX];
			MOV EDX, DWORD PTR SS : [ESP + 4];
		check30:
			MOVZX ECX, DX;
			MOV CX, WORD PTR DS : [EAX + ECX * 4];
			CMP CX, 0x0FFFF;
			JE SHORT check29;
			MOV EDX, ECX;
			JMP SHORT check30;
		check29:
			MOVZX ECX, DX;
			MOV AL, BYTE PTR DS : [EAX + ECX * 4 + 2];
			RETN 4;
		check31:
			MOVZX EDX, WORD PTR DS : [ECX + 0x24];
			LEA EAX, DWORD PTR DS : [ECX + 0x24];
			PUSH ESI;
			MOV ESI, DWORD PTR DS : [ECX];
			PUSH EDI;
			MOV DI, WORD PTR SS : [ESP + 0xC];
			MOV WORD PTR DS : [ESI + EDX * 4], DI;
			MOV ESI, DWORD PTR DS : [ECX];
			MOVZX EDX, WORD PTR DS : [EAX];
			MOV DI, WORD PTR SS : [ESP + 0x10];
			MOV WORD PTR DS : [ESI + EDX * 4 + 2], DI;
			INC WORD PTR DS : [EAX];
			MOV AX, WORD PTR DS : [EAX];
			POP EDI;
			CMP AX, 8;
			POP ESI;
			JE SHORT check32;
			CMP AX, 0x10;
			JE SHORT check32;
			CMP AX, 0x20;
			JE SHORT check32;
			CMP AX, 0x40;
			JE SHORT check32;
			CMP AX, 0x80;
			JE SHORT check32;
			CMP AX, 0x100;
			JE SHORT check32;
			CMP AX, 0x200;
			JE SHORT check32;
			CMP AX, 0x400;
			JE SHORT check32;
			CMP AX, 0x800;
			JNZ SHORT check33;
		check32:
			INC BYTE PTR DS : [ECX + 0x23];
		check33:
			RETN 8;
		check4:
			MOV EDX, ECX;
			PUSH EDI;
			MOV ECX, 0x1000;
			OR EAX, 0xFFFFFFFF;
			MOV EDI, DWORD PTR DS : [EDX]
			REP STOS DWORD PTR ES : [EDI];
			XOR EAX, EAX;
			POP EDI;
			CMP WORD PTR DS : [EDX + 8], AX;
			JBE SHORT check1;
			PUSH ESI;
			MOV ESI, DWORD PTR DS : [EDX];
		check2:
			MOVZX ECX, AX;
			MOV WORD PTR DS : [ESI + ECX * 4 + 2], AX;
			INC EAX;
			CMP AX, WORD PTR DS : [EDX + 8];
			JB SHORT check2;
			POP ESI;
		check1:
			MOV AX, WORD PTR DS : [EDX + 0xA];
			INC AX;
			MOV WORD PTR DS : [EDX + 0x24], AX;
			MOV AL, BYTE PTR DS : [EDX + 0x22];
			INC AL;
			MOV BYTE PTR DS : [EDX + 0x23], AL;
			RETN;
		check23:
			PUSH EDI;
			MOV ECX, ESI;
			CALL check35;
			MOV EBX, EDI;
			JMP SHORT check26;
		check35:
			PUSH EBP;
			MOV EBP, ESP;
			PUSH ESI;
			PUSH EDI;
			MOV ESI, ECX;
			NOP;
			MOV AX, WORD PTR SS : [EBP + 8];
			CMP AX, WORD PTR DS : [ESI + 8];
			JNB SHORT check36;
			NOP;
			MOV ECX, DWORD PTR DS : [ESI];
			MOV EDX, DWORD PTR DS : [ESI + 0x1C];
			MOV EDI, DWORD PTR DS : [ESI + 0x30];
			MOVZX EAX, AX;
			MOV AL, BYTE PTR DS : [ECX + EAX * 4 + 2];
			MOV BYTE PTR DS : [EDX + EDI], AL;
			INC DWORD PTR DS : [ESI + 0x30];
			NOP;
			MOV EAX, DWORD PTR DS : [ESI + 0x30];
			CMP EAX, DWORD PTR DS : [ESI + 0x2C];
			JNZ SHORT FuncRetn;
			MOV ECX, ESI;
			CALL check37;
			NOP;
			JMP SHORT FuncRetn;
check36:
			MOVZX EDI, AX;
			MOV EAX, DWORD PTR DS : [ESI];
			MOV ECX, ESI;
			SHL EDI, 2;
			MOV AX, WORD PTR DS : [EDI + EAX];
			PUSH EAX;
			CALL check35;
			NOP;
			MOV EAX, DWORD PTR DS : [ESI];
			MOV ECX, ESI;
			MOV AX, WORD PTR DS : [EDI + EAX + 2];
			PUSH EAX;
			CALL check35;
			NOP;
			NOP;
			POP EDI;
			POP ESI;
			POP EBP;
			RETN 4;
		check38:
			MOVZX EDX, AL;
			MOVZX EDX, BYTE PTR DS : [EDX + ECX + 0xD];
			ADD DWORD PTR DS : [ECX + 0x34], EDX;
			MOV EDX, DWORD PTR DS : [ECX + 0x34];
			CMP EDX, DWORD PTR DS : [ECX + 0x28];
			JB SHORT FuncRetrn2;
			INC AL;
			CMP AL, 4;
			MOV BYTE PTR DS : [ECX + 0xC], AL;
			JNB SHORT Frtn;
			MOVZX EAX, AL;
			MOVZX EAX, BYTE PTR DS : [EAX + ECX + 0xD];
			SHR EAX, 1;
			MOV DWORD PTR DS : [ECX + 0x34], EAX;
			FuncRetrn2:
			MOV EAX, DWORD PTR DS : [ECX + 0x38];
			MOV EDX, DWORD PTR DS : [ECX + 0x14];
			IMUL EAX, DWORD PTR DS : [ECX + 0x34];
			SUB EDX, EAX;
			MOV DWORD PTR DS : [ECX + 0x1C], EDX;
			Frtn:
			RETN;
FuncRetn:
			NOP;
			POP EDI;
			POP ESI;
			POP EBP;
			RETN 4;
		check37:
			MOV AL, BYTE PTR DS : [ECX + 0xC];
			AND DWORD PTR DS : [ECX + 0x30], 0;
			CMP AL, 0x0FF;
			JNZ SHORT check38;
			MOV EAX, DWORD PTR DS : [ECX + 0x38];
			SUB DWORD PTR DS : [ECX + 0x1C], EAX;
			RETN;
		Finished:
			MOV ESP,EBP;
			POP EBP;
			//Debug VS Release build have different stack sizes.  The following is needed for the return parameters and CTYPES
#ifdef _DEBUG
			ADD ESI, 0x120;
#else
			ADD ESI, 0x58; //Need for Pythnon CTypes return parameters!
#endif
			RETN;
		}
	}
	return TRUE;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-10">10</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-12">12</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-14">14</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-16">16</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-18">18</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-20">20</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-22">22</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-24">24</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-26">26</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-28">28</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-30">30</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-32">32</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-34">34</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-36">36</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-38">38</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-40">40</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-42">42</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-44">44</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-46">46</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-48">48</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-50">50</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-52">52</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-54">54</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-56">56</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-58">58</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-60">60</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-62">62</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-64">64</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-66">66</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-68">68</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-70">70</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-72">72</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-74">74</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-76">76</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-78">78</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-80">80</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-82">82</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-84">84</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-86">86</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-88">88</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-90">90</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-92">92</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-94">94</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-96">96</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-98">98</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-100">100</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-102">102</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-104">104</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-106">106</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-108">108</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-110">110</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-112">112</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-114">114</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-116">116</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-118">118</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-120">120</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-122">122</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-124">124</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-126">126</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-128">128</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-130">130</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-132">132</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-134">134</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-136">136</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-138">138</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-140">140</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-142">142</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-144">144</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-146">146</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-148">148</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-150">150</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-152">152</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-154">154</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-156">156</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-158">158</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-160">160</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-162">162</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-164">164</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-166">166</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-168">168</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-170">170</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-172">172</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-174">174</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-176">176</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-178">178</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-180">180</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-182">182</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-184">184</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-186">186</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-188">188</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-190">190</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-192">192</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-194">194</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-196">196</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-198">198</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-200">200</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-202">202</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-204">204</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-206">206</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-208">208</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-210">210</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-212">212</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-214">214</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-215">215</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-216">216</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-217">217</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-218">218</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-219">219</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-220">220</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-221">221</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-222">222</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-223">223</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-224">224</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-225">225</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-226">226</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-227">227</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-228">228</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-229">229</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-230">230</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-231">231</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-232">232</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-233">233</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-234">234</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-235">235</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-236">236</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-237">237</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-238">238</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-239">239</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-240">240</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-241">241</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-242">242</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-243">243</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-244">244</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-245">245</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-246">246</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-247">247</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-248">248</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-249">249</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-250">250</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-251">251</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-252">252</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-253">253</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-254">254</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-255">255</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-256">256</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-257">257</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-258">258</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-259">259</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-260">260</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-261">261</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-262">262</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-263">263</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-264">264</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-265">265</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-266">266</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-267">267</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-268">268</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-269">269</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-270">270</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-271">271</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-272">272</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-273">273</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-274">274</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-275">275</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-276">276</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-277">277</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-278">278</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-279">279</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-280">280</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-281">281</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-282">282</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-283">283</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-284">284</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-285">285</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-286">286</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-287">287</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-288">288</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-289">289</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-290">290</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-291">291</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-292">292</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-293">293</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-294">294</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-295">295</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-296">296</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-297">297</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-298">298</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-299">299</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-300">300</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-301">301</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-302">302</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-303">303</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-304">304</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-305">305</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-306">306</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-307">307</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-308">308</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-309">309</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-310">310</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-311">311</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-312">312</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-313">313</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-314">314</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-315">315</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-316">316</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-317">317</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-318">318</div><div class="crayon-num" data-line="crayon-5f694cc4adb00907059603-319">319</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb00907059603-320">320</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adb00907059603-1"><span class="crayon-p">#include &lt;windows.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-2"><span class="crayon-p">#include &lt;stdio.h&gt;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-3"><span class="crayon-p">#include "TestDLL.h"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-4"><span class="crayon-t">BOOL</span><span class="crayon-h"> </span><span class="crayon-e">Decompress</span><span class="crayon-sy">(</span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">src</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">dst</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-5"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-6"><span class="crayon-h">	</span><span class="crayon-c">//Use calloc vs malloc.&nbsp;&nbsp;Temp buffer is for the dictionary</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-7"><span class="crayon-h">	</span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">pTmpbuff</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-8"><span class="crayon-h">	</span><span class="crayon-v">pTmpbuff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-o">*</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">calloc</span><span class="crayon-sy">(</span><span class="crayon-cn">0x4080u</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">sizeof</span><span class="crayon-sy">(</span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-9"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">src</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">dst</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-10"><span class="crayon-h">	</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-11"><span class="crayon-h">		</span><span class="crayon-e">__asm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-12"><span class="crayon-h">		</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-13"><span class="crayon-h">			</span><span class="crayon-st">xor</span><span class="crayon-h"> </span><span class="crayon-v">ebx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ebx</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//Need to clear ebx register</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-14"><span class="crayon-h">			</span><span class="crayon-e">SUB </span><span class="crayon-v">ESP</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x40</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//Need to subtract stack, so we dont overwrite some Ctypes return data</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-15"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESP</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-16"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-17"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span><span class="crayon-h">		</span><span class="crayon-c">//Our Temp Buffer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-18"><span class="crayon-h">			</span><span class="crayon-v">PUSH</span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Source Buffer</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-19"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-20"><span class="crayon-h">			</span><span class="crayon-v">PUSH</span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xC</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//Destination Buffer</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-21"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EDX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-22"><span class="crayon-h">			</span><span class="crayon-e">LEA </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//Where we start.&nbsp;&nbsp;Get the 1st DWORD of the compressed data appears to be magic value</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-23"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span><span class="crayon-c">//Temp buffer address</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-24"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x1C</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDX</span><span class="crayon-sy">;</span><span class="crayon-c">//Destination address</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-25"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x18</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ECX</span><span class="crayon-sy">;</span><span class="crayon-c">//Compressed Data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-26"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x20</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">BL</span><span class="crayon-sy">;</span><span class="crayon-c">//0</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-27"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">CL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-c">//08</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-28"><span class="crayon-h">			</span><span class="crayon-i">PUSH</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-29"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-30"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x22</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">CL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-31"><span class="crayon-h">			</span><span class="crayon-e">SHL </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">CL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-32"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x30</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-33"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-34"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-35"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xA</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-36"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">SS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x10</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-37"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x2C</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-38"><span class="crayon-h">			</span><span class="crayon-e">LEA </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e ">EAX *</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x1F</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-39"><span class="crayon-h">			</span><span class="crayon-e">SHR </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-40"><span class="crayon-h">			</span><span class="crayon-e">SHL </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-41"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">SS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x18</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">BL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-42"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x38</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-43"><span class="crayon-h">			</span><span class="crayon-e">SETE </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-44"><span class="crayon-h">			</span><span class="crayon-e">DEC </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-45"><span class="crayon-h">			</span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-46"><span class="crayon-h">			</span><span class="crayon-e">ADD </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x0FF</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-47"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">BL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-48"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xC</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-49"><span class="crayon-h">			</span><span class="crayon-e">JNZ </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check3</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-50"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">SS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x14</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-51"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x14</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-52"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x28</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-53"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x34</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-54"><span class="crayon-v">check3</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-55"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-56"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-57"><span class="crayon-v">check26</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-58"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-59"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check10</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-60"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-61"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">DI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xA</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-62"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-v">Finished</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-63"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">DI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-64"><span class="crayon-h">			</span><span class="crayon-e">JNZ </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check22</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-65"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-66"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-67"><span class="crayon-v">check24</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-68"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-69"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check10</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-70"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">EAX</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-71"><span class="crayon-e">			</span><span class="crayon-e">CMP </span><span class="crayon-v">DI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-72"><span class="crayon-h">			</span><span class="crayon-e">JNZ </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check23</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-73"><span class="crayon-h">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check24</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-74"><span class="crayon-v">check22</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-75"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">DI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0X24</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-76"><span class="crayon-h">			</span><span class="crayon-e">JNB </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check25</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-77"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-e">EDI</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-78"><span class="crayon-e">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check27</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-79"><span class="crayon-v">check25</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-80"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-81"><span class="crayon-v">check27</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-82"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-83"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check28</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-84"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-85"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-86"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-87"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-88"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check31</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-89"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-90"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-91"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check35</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-92"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EBX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-93"><span class="crayon-h">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check26</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-94"><span class="crayon-v">check10</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-95"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x20</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-96"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-97"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-98"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-99"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EDI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x23</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-100"><span class="crayon-h">			</span><span class="crayon-e">ADD </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-101"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-102"><span class="crayon-h">			</span><span class="crayon-e">JA </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">Check6</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-103"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x18</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-104"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-105"><span class="crayon-h">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">Check8</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-106"><span class="crayon-h">		</span><span class="crayon-v">Check6</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-107"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x18</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-108"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-109"><span class="crayon-h">			</span><span class="crayon-e">JA </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">Check7</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-110"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-111"><span class="crayon-h">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">Check8</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-112"><span class="crayon-h">		</span><span class="crayon-v">Check7</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-113"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-114"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EBX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-115"><span class="crayon-h">			</span><span class="crayon-e">SHL </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0X10</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-116"><span class="crayon-h">			</span><span class="crayon-st">OR</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-117"><span class="crayon-h">		</span><span class="crayon-v">Check8</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-118"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EBX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-119"><span class="crayon-h">			</span><span class="crayon-i">PUSH</span><span class="crayon-h"> </span><span class="crayon-cn">0x20</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-120"><span class="crayon-h">			</span><span class="crayon-e">SHR </span><span class="crayon-v">EBX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-121"><span class="crayon-h">			</span><span class="crayon-e">ADD </span><span class="crayon-v">EBX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-122"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">DL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-123"><span class="crayon-h">			</span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-v">DL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-124"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0X18</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-125"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0X20</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-126"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">ECX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-127"><span class="crayon-h">			</span><span class="crayon-e">SUB </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-128"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-129"><span class="crayon-h">			</span><span class="crayon-i">PUSH</span><span class="crayon-h"> </span><span class="crayon-cn">0x20</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-130"><span class="crayon-h">			</span><span class="crayon-e">SHL </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">CL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-131"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">ECX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-132"><span class="crayon-h">			</span><span class="crayon-e">SUB </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-133"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-134"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-135"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EBX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-136"><span class="crayon-h">			</span><span class="crayon-e">SHR </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">CL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-137"><span class="crayon-h">			</span><span class="crayon-v">RETN</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-138"><span class="crayon-h">		</span><span class="crayon-v">check28</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-139"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-140"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">SS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-141"><span class="crayon-h">		</span><span class="crayon-v">check30</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-142"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-143"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">CX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">ECX *</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-144"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">CX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x0FFFF</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-145"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check29</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-146"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ECX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-147"><span class="crayon-h">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check30</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-148"><span class="crayon-h">		</span><span class="crayon-v">check29</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-149"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-150"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">ECX *</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-151"><span class="crayon-h">			</span><span class="crayon-i">RETN</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-152"><span class="crayon-h">		</span><span class="crayon-v">check31</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-153"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x24</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-154"><span class="crayon-h">			</span><span class="crayon-e">LEA </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x24</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-155"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-156"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-157"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-158"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">DI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">SS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xC</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-159"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">EDX *</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-160"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-161"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-162"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">DI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">SS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x10</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-163"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">EDX *</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-164"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-165"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-166"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-167"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-168"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-169"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-170"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-171"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-172"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x20</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-173"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-174"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x40</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-175"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-176"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x80</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-177"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-178"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-179"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-180"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x200</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-181"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-182"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x400</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-183"><span class="crayon-h">			</span><span class="crayon-e">JE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check32</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-184"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x800</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-185"><span class="crayon-h">			</span><span class="crayon-e">JNZ </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check33</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-186"><span class="crayon-h">		</span><span class="crayon-v">check32</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-187"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x23</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-188"><span class="crayon-h">		</span><span class="crayon-v">check33</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-189"><span class="crayon-h">			</span><span class="crayon-i">RETN</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-190"><span class="crayon-h">		</span><span class="crayon-v">check4</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-191"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ECX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-192"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-193"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x1000</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-194"><span class="crayon-h">			</span><span class="crayon-st">OR</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFFFFFF</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-195"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-196"><span class="crayon-h">			</span><span class="crayon-e">REP </span><span class="crayon-e">STOS </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">ES</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDI</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-197"><span class="crayon-h">			</span><span class="crayon-st">XOR</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-198"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-199"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-200"><span class="crayon-h">			</span><span class="crayon-e">JBE </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-201"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-202"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-203"><span class="crayon-h">		</span><span class="crayon-v">check2</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-204"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-205"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">ECX *</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-206"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-207"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-208"><span class="crayon-h">			</span><span class="crayon-e">JB </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-209"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-210"><span class="crayon-h">		</span><span class="crayon-v">check1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-211"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xA</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-212"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-213"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x24</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-214"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x22</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-215"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-216"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x23</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-217"><span class="crayon-h">			</span><span class="crayon-v">RETN</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-218"><span class="crayon-h">		</span><span class="crayon-v">check23</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-219"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-220"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-221"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check35</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-222"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EBX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-223"><span class="crayon-h">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check26</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-224"><span class="crayon-h">		</span><span class="crayon-v">check35</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-225"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EBP</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-226"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EBP</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-227"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-228"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-229"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ECX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-230"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-231"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">SS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-232"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-233"><span class="crayon-h">			</span><span class="crayon-e">JNB </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check36</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-234"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-235"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-236"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x1C</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-237"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x30</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-238"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-239"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">EAX *</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-240"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">EDI</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-241"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x30</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-242"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-243"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x30</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-244"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x2C</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-245"><span class="crayon-h">			</span><span class="crayon-e">JNZ </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">FuncRetn</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-246"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-247"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check37</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-248"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-249"><span class="crayon-h">			</span><span class="crayon-e">JMP </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">FuncRetn</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-250"><span class="crayon-v">check36</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-251"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EDI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-252"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-253"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-254"><span class="crayon-h">			</span><span class="crayon-e">SHL </span><span class="crayon-v">EDI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-255"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-256"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-257"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check35</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-258"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-259"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ESI</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-260"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ECX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-261"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDI</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-262"><span class="crayon-h">			</span><span class="crayon-e">PUSH </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-263"><span class="crayon-h">			</span><span class="crayon-e">CALL </span><span class="crayon-v">check35</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-264"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-265"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-266"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-267"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-268"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EBP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-269"><span class="crayon-h">			</span><span class="crayon-i">RETN</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-270"><span class="crayon-h">		</span><span class="crayon-v">check38</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-271"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-272"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EDX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xD</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-273"><span class="crayon-h">			</span><span class="crayon-e">ADD </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x34</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-274"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x34</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-275"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x28</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-276"><span class="crayon-h">			</span><span class="crayon-e">JB </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">FuncRetrn2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-277"><span class="crayon-h">			</span><span class="crayon-e">INC </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-278"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-279"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xC</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-280"><span class="crayon-h">			</span><span class="crayon-e">JNB </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">Frtn</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-281"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AL</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-282"><span class="crayon-h">			</span><span class="crayon-e">MOVZX </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">EAX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xD</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-283"><span class="crayon-h">			</span><span class="crayon-e">SHR </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-284"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x34</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-285"><span class="crayon-h">			</span><span class="crayon-v">FuncRetrn2</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-286"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x38</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-287"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x14</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-288"><span class="crayon-h">			</span><span class="crayon-e">IMUL </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x34</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-289"><span class="crayon-h">			</span><span class="crayon-e">SUB </span><span class="crayon-v">EDX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-290"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x1C</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EDX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-291"><span class="crayon-h">			</span><span class="crayon-v">Frtn</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-292"><span class="crayon-h">			</span><span class="crayon-v">RETN</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-293"><span class="crayon-v">FuncRetn</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-294"><span class="crayon-h">			</span><span class="crayon-v">NOP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-295"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-296"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">ESI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-297"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EBP</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-298"><span class="crayon-h">			</span><span class="crayon-i">RETN</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-299"><span class="crayon-h">		</span><span class="crayon-v">check37</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-300"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">BYTE</span><span class="crayon-h"> </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xC</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-301"><span class="crayon-h">			</span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x30</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-302"><span class="crayon-h">			</span><span class="crayon-e">CMP </span><span class="crayon-v">AL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x0FF</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-303"><span class="crayon-h">			</span><span class="crayon-e">JNZ </span><span class="crayon-t">SHORT</span><span class="crayon-h"> </span><span class="crayon-v">check38</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-304"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">EAX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x38</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-305"><span class="crayon-h">			</span><span class="crayon-e">SUB </span><span class="crayon-e">DWORD </span><span class="crayon-e">PTR </span><span class="crayon-v">DS</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">ECX</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0x1C</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-306"><span class="crayon-h">			</span><span class="crayon-v">RETN</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-307"><span class="crayon-h">		</span><span class="crayon-v">Finished</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-308"><span class="crayon-h">			</span><span class="crayon-e">MOV </span><span class="crayon-v">ESP</span><span class="crayon-sy">,</span><span class="crayon-v">EBP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-309"><span class="crayon-h">			</span><span class="crayon-e">POP </span><span class="crayon-v">EBP</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-310"><span class="crayon-h">			</span><span class="crayon-c">//Debug VS Release build have different stack sizes.&nbsp;&nbsp;The following is needed for the return parameters and CTYPES</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-311"><span class="crayon-p">#ifdef _DEBUG</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-312"><span class="crayon-h">			</span><span class="crayon-e">ADD </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x120</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-313"><span class="crayon-p">#else</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-314"><span class="crayon-h">			</span><span class="crayon-e">ADD </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x58</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//Need for Pythnon CTypes return parameters!</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-315"><span class="crayon-p">#endif</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-316"><span class="crayon-h">			</span><span class="crayon-v">RETN</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-317"><span class="crayon-h">		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-318"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694cc4adb00907059603-319"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb00907059603-320"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0161 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure 5 Our decompression routine</em></p>
<p>Taking assembly from IDA Pro or a disassembler such as Immunity Debugger isnt one to one as it does require some work on your part. Unfortunately, you cant take the assembly and expect things to just magically work. One area that requires special attention are the function calls made within your code block. Each assembly call needs a name (label) and all the code needs to be arranged in the proper calling order, otherwise you will receive unexpected results or crash. Also, its important that you copy the assembly for each function call that is made. In this sample, I used the word check to represent function names or jump locations, as I was quickly working my way through this.<br />
Since LZW encodes data using an index into a dictionary the first thing the decompression routine does is allocate a buffer of memory 16,512 bytes (0x4080) to create the dictionary. From the assembly, it uses the C++ API malloc to allocate the buffer and then sets the buffer to NULL (this is how malloc works). A simpler and more efficient way is to use calloc function which reduces the number of instructions and allocates the buffer for you.<br />
We start by coding this in C++ and then switch to Visual Studio inline assembly using the __asm keyword. The code block within the __asm keyword is where you will place your assembly instructions and make the necessary adjustments; not only for the code to compile, but also to ensure that the stack is aligned properly. In studying the decompression routine, the following instructions were necessary before we can begin to start executing the decompression routine.</p>
<ul>
<li>Set EBX to zero.</li>
<li>Subtract 64 bytes (0x40) from the stack. Necessary to prevent us from overwriting any stack data</li>
<li>Save our stack pointer into ESI</li>
<li>EDI needs to point to our dictionary buffer created via calloc</li>
<li>EAX needs to point to our source data</li>
<li>EDX needs to point to our destination buffer</li>
</ul>
<p>The following nine lines were manually added in-order to satisfy the requirements for the decompression algorithm. The remaining code was copied directly from Immunity Debugger.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adb09430400897" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
xor ebx, ebx;          //Need to clear ebx register
SUB ESP, 0x40;    //Need to subtract stack, so we dont overwrite some Ctypes return data
MOV ESI, ESP;
PUSH EAX;
POP EDI;	//Our Temp Buffer
PUSH[EBP + 8];  //Source Buffer
POP EAX;
PUSH[EBP + 0xC];  //Destination Buffer
POP EDX;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adb09430400897-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb09430400897-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adb09430400897-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb09430400897-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adb09430400897-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb09430400897-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adb09430400897-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb09430400897-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adb09430400897-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adb09430400897-1"><span class="crayon-st">xor</span><span class="crayon-h"> </span><span class="crayon-v">ebx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ebx</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Need to clear ebx register</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb09430400897-2"><span class="crayon-e">SUB </span><span class="crayon-v">ESP</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x40</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Need to subtract stack, so we dont overwrite some Ctypes return data</span></div><div class="crayon-line" id="crayon-5f694cc4adb09430400897-3"><span class="crayon-e">MOV </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ESP</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb09430400897-4"><span class="crayon-e">PUSH </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb09430400897-5"><span class="crayon-e">POP </span><span class="crayon-v">EDI</span><span class="crayon-sy">;</span><span class="crayon-h">	</span><span class="crayon-c">//Our Temp Buffer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb09430400897-6"><span class="crayon-v">PUSH</span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//Source Buffer</span></div><div class="crayon-line" id="crayon-5f694cc4adb09430400897-7"><span class="crayon-e">POP </span><span class="crayon-v">EAX</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb09430400897-8"><span class="crayon-v">PUSH</span><span class="crayon-sy">[</span><span class="crayon-v">EBP</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0xC</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//Destination Buffer</span></div><div class="crayon-line" id="crayon-5f694cc4adb09430400897-9"><span class="crayon-e">POP </span><span class="crayon-v">EDX</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure 6 Setting up decompression routine requirements</em></p>
<p>At this point, all it takes is to update the assembly calls and jumps with meaningful names and arrange them in the correct order. Now the code should compile and run, but when our routine is finished you must restore the stack back, so it returns to the proper caller in this case Python ctypes. The following code was added:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adb0b132526825" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Finished:
MOV ESP,EBP;
POP EBP;
//Debug VS Release build have different stack sizes.  The following is needed for the return parameters and CTYPES
#ifdef _DEBUG
ADD ESI, 0x120;
#else
ADD ESI, 0x58; //Need for CTypes return parameters!!!!
#endif
RETN;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adb0b132526825-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0b132526825-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adb0b132526825-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0b132526825-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adb0b132526825-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0b132526825-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adb0b132526825-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0b132526825-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adb0b132526825-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0b132526825-10">10</div><div class="crayon-num" data-line="crayon-5f694cc4adb0b132526825-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adb0b132526825-1"><span class="crayon-v">Finished</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0b132526825-2"><span class="crayon-e">MOV </span><span class="crayon-v">ESP</span><span class="crayon-sy">,</span><span class="crayon-v">EBP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb0b132526825-3"><span class="crayon-e">POP </span><span class="crayon-v">EBP</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0b132526825-4"><span class="crayon-c">//Debug VS Release build have different stack sizes.&nbsp;&nbsp;The following is needed for the return parameters and CTYPES</span></div><div class="crayon-line" id="crayon-5f694cc4adb0b132526825-5"><span class="crayon-p">#ifdef _DEBUG</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0b132526825-6"><span class="crayon-e">ADD </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x120</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb0b132526825-7"><span class="crayon-p">#else</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0b132526825-8"><span class="crayon-e">ADD </span><span class="crayon-v">ESI</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x58</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//Need for CTypes return parameters!!!!</span></div><div class="crayon-line" id="crayon-5f694cc4adb0b132526825-9"><span class="crayon-p">#endif</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0b132526825-10"><span class="crayon-v">RETN</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694cc4adb0b132526825-11"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure 7 Adjusting stack for return</em></p>
<p>Here we are restoring the stack pointer and base pointer and adding 0x120 or 0x58 to ESI depending if the DLL is a VS debug build or release build.<br />
Now that we have a DLL we can begin to call into it and pass it data via Python and ctypes. The following Python script uses our DLL to decompresses Reaver data.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adb0c480047867" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#-------------------------------------------------------------------------------
# Name:        LzwDecompression
# Purpose:
#
# Author:      Mike Harbison Unit 42
#
# Created:     11/11/2017
#-------------------------------------------------------------------------------
from ctypes import *
import sys
import os.path
import argparse
import re,struct
import subprocess, random
# MAP types to ctypes
LPBYTE = POINTER(c_ubyte)
LPCSTR = LPCTSTR = c_char_p
BOOL = c_bool
if os.name != 'nt':
    print ("Script can only be run from Windows")
    sys.exit("Sorry Windows only")
def assert_success(success):
    if not success:
        raise AssertionError(FormatError())
def LzwDecompress(hdll,data):
    inbuf = create_string_buffer(data)
    outbuf= create_string_buffer(len(data))
    success = hdll.Decompress(inbuf,outbuf)
    assert_success(success)
    return outbuf.raw
def CabExtract(match,pargs,data):
    offset = match.start()
    CabHeaderMagicValue = offset + 124
    CabSizeStart = offset + 132
    CabFileNameStart = offset + 184
    CabFileNameEnd = data[CabFileNameStart:].find('\0')
    CabName = data[CabFileNameStart:CabFileNameStart+CabFileNameEnd]
    CabSize = struct.unpack("L",data[CabSizeStart:CabSizeStart+4])[0]
    CabData = data[CabHeaderMagicValue:CabHeaderMagicValue+CabSize]
    FileName=pargs.input_file
    #Add magic value
    Cab="4D534346".decode('hex')+CabData[4:]
    print "Found our CAB Data at file offset--&gt;{}".format(offset)
    CabDir=os.path.splitext(FileName)[0]
    if not os.path.exists(CabDir):
        os.makedirs(CabDir)
    else:
        CabDir+='_'+str(random.randint(1111,9999))
        os.makedirs(CabDir)
    CabFile=os.path.basename(FileName).split('.')[0]+".cab"
    with open(CabDir+"\\"+CabFile,"wb") as fp:
        fp.write(Cab)
    print "Wrote CAB File--&gt;%s"%CabDir+"\\"+CabFile
    print "Expanding CAB File %s"%CabName
    args = [" -r ",CabDir + "\\" + CabFile,' ',CabDir]
    result=subprocess.Popen("expand "+"".join(args), stdout=subprocess.PIPE)
    result.wait()
    if "Expanding Files Complete" not in result.stdout.read():
        print "Error Expanding CAB file"
        sys.exit(1)
    ExpandedFile = CabDir + "\\" + CabName
    if not os.path.isfile(ExpandedFile):
        print "Did not find our expanded file %s"%CabName
        sys.exit(1)
    print "Check directory %s for expanded file %s"%(CabDir,CabName)
    return ExpandedFile
def DecompressRoutine(pargs,hlzw,data):
    LzwCompPattern = "\x08\x00\xA5\x04\x01\x12\x03"
    regex = re.compile(LzwCompPattern)
    for match in regex.finditer(data):
        offset=match.start()
        print "Found our compression header at file offset--&gt;{}".format(offset)
        Deflated=LzwDecompress(hlzw,data[offset:])
        if Deflated:
            with open(pargs.out_file, "wb") as wp:
                wp.write(Deflated)
            print "Wrote decompressed stream to file--&gt;%s"%(pargs.out_file)
            return True
    return False
def Start(pargs,hlzw,data):
    CabCompPattern = bytearray("46444944657374726F790000464449436F7079004644494973436162696E657400000000464449437265617465000000636162696E65742E646C6C004D6963726F736F6674")
    #Check For CAB file magic value first
    found = False
    regex = re.compile(CabCompPattern.decode('hex'))
    for match in regex.finditer(data):
        found = True
        ExpandedFile=CabExtract(match,pargs,data)
        if ExpandedFile:
            with open(ExpandedFile,"rb") as fp:
                ExpandedData=fp.read()
                DecompressRoutine(pargs,hlzw,ExpandedData)
            return True
    if not found:
        result=DecompressRoutine(pargs,hlzw,data)
        if result:
            return True
        else:
            return False
def main():
    parser=argparse.ArgumentParser()
    parser.add_argument("-i", '--infile' , dest='input_file',help="Input file to process",required=True)
    parser.add_argument("-o", '--outfile', dest='out_file',help="Optional Output file name",required=False)
    results = parser.parse_args()
    if not results.out_file:
        results.out_file=results.input_file + "_dec.txt"
    lzwdll="LzwDecompress.dll"
    lzwdllpath = os.path.dirname(os.path.abspath(__file__)) + os.path.sep + lzwdll
    if os.path.isfile(lzwdllpath):
        lzw = windll.LoadLibrary(lzwdllpath)
        lzw.Decompress.argtypes=(LPCSTR,LPCSTR)
        lzw.Decompress.restypes=BOOL
    else:
        print ("Missing LzwDecompress.DLL")
        sys.exit(1)
    with open(results.input_file,"rb") as fp:
        FileData=fp.read()
        Success=Start(results,lzw,FileData)
        if not Success:
            print("Did not find CAB or Compression routine in file %s")%(results.input_file)
if __name__ == '__main__':
    main()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-10">10</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-12">12</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-14">14</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-16">16</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-18">18</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-20">20</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-22">22</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-24">24</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-26">26</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-28">28</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-30">30</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-32">32</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-34">34</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-36">36</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-38">38</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-40">40</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-42">42</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-44">44</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-46">46</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-48">48</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-50">50</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-52">52</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-54">54</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-56">56</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-58">58</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-60">60</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-62">62</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-64">64</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-66">66</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-68">68</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-70">70</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-72">72</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-74">74</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-76">76</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-78">78</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-80">80</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-82">82</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-84">84</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-86">86</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-88">88</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-90">90</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-92">92</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-94">94</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-96">96</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-98">98</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-100">100</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-102">102</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-104">104</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-106">106</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-108">108</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-110">110</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-112">112</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-114">114</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-116">116</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-118">118</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0c480047867-120">120</div><div class="crayon-num" data-line="crayon-5f694cc4adb0c480047867-121">121</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-1"><span class="crayon-p">#-------------------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-2"><span class="crayon-p"># Name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LzwDecompression</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-3"><span class="crayon-p"># Purpose:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-4"><span class="crayon-p">#</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-5"><span class="crayon-p"># Author:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mike Harbison Unit 42</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-6"><span class="crayon-p">#</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-7"><span class="crayon-p"># Created:&nbsp;&nbsp;&nbsp;&nbsp; 11/11/2017</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-8"><span class="crayon-p">#-------------------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-9"><span class="crayon-e">from </span><span class="crayon-e">ctypes </span><span class="crayon-e ">import *</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-10"><span class="crayon-e">import </span><span class="crayon-e">sys</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-11"><span class="crayon-e">import </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-e">path</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-12"><span class="crayon-e">import </span><span class="crayon-e">argparse</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-13"><span class="crayon-e">import </span><span class="crayon-v">re</span><span class="crayon-sy">,</span><span class="crayon-t">struct</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-14"><span class="crayon-e">import </span><span class="crayon-v">subprocess</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-15"><span class="crayon-p"># MAP types to ctypes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-16"><span class="crayon-v">LPBYTE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">POINTER</span><span class="crayon-sy">(</span><span class="crayon-v">c_ubyte</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-17"><span class="crayon-v">LPCSTR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">LPCTSTR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">c_char_p</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-18"><span class="crayon-t">BOOL</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">c_bool</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-19"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">'nt'</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"Script can only be run from Windows"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-s">"Sorry Windows only"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-22"><span class="crayon-e">def </span><span class="crayon-e">assert_success</span><span class="crayon-sy">(</span><span class="crayon-v">success</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">success</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">raise </span><span class="crayon-e">AssertionError</span><span class="crayon-sy">(</span><span class="crayon-e">FormatError</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-25"><span class="crayon-e">def </span><span class="crayon-e">LzwDecompress</span><span class="crayon-sy">(</span><span class="crayon-v">hdll</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inbuf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_string_buffer</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">outbuf</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_string_buffer</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">hdll</span><span class="crayon-sy">.</span><span class="crayon-e">Decompress</span><span class="crayon-sy">(</span><span class="crayon-v">inbuf</span><span class="crayon-sy">,</span><span class="crayon-v">outbuf</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">assert_success</span><span class="crayon-sy">(</span><span class="crayon-v">success</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outbuf</span><span class="crayon-sy">.</span><span class="crayon-e">raw</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-31"><span class="crayon-e">def </span><span class="crayon-e">CabExtract</span><span class="crayon-sy">(</span><span class="crayon-v">match</span><span class="crayon-sy">,</span><span class="crayon-v">pargs</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">offset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">match</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabHeaderMagicValue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">offset</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">124</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabSizeStart</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">offset</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">132</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabFileNameStart</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">offset</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">184</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabFileNameEnd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">CabFileNameStart</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-s">'\0'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabName</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">CabFileNameStart</span><span class="crayon-o">:</span><span class="crayon-v">CabFileNameStart</span><span class="crayon-o">+</span><span class="crayon-v">CabFileNameEnd</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabSize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-sy">.</span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">"L"</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">CabSizeStart</span><span class="crayon-o">:</span><span class="crayon-v">CabSizeStart</span><span class="crayon-o">+</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabData</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">CabHeaderMagicValue</span><span class="crayon-o">:</span><span class="crayon-v">CabHeaderMagicValue</span><span class="crayon-o">+</span><span class="crayon-v">CabSize</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">FileName</span><span class="crayon-o">=</span><span class="crayon-v">pargs</span><span class="crayon-sy">.</span><span class="crayon-v">input_file</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#Add magic value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Cab</span><span class="crayon-o">=</span><span class="crayon-s">"4D534346"</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'hex'</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">CabData</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Found our CAB Data at file offset--&gt;{}"</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">offset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabDir</span><span class="crayon-o">=</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">splitext</span><span class="crayon-sy">(</span><span class="crayon-v">FileName</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">exists</span><span class="crayon-sy">(</span><span class="crayon-v">CabDir</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-v">CabDir</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabDir</span><span class="crayon-o">+=</span><span class="crayon-s">'_'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">1111</span><span class="crayon-sy">,</span><span class="crayon-cn">9999</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-v">CabDir</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabFile</span><span class="crayon-o">=</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">basename</span><span class="crayon-sy">(</span><span class="crayon-v">FileName</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">'.'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-s">".cab"</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">CabDir</span><span class="crayon-o">+</span><span class="crayon-s">"\\"</span><span class="crayon-o">+</span><span class="crayon-v">CabFile</span><span class="crayon-sy">,</span><span class="crayon-s">"wb"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">Cab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Wrote CAB File--&gt;%s"</span><span class="crayon-o">%</span><span class="crayon-v">CabDir</span><span class="crayon-o">+</span><span class="crayon-s">"\\"</span><span class="crayon-o">+</span><span class="crayon-e">CabFile</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-54"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Expanding CAB File %s"</span><span class="crayon-o">%</span><span class="crayon-e">CabName</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-55"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">" -r "</span><span class="crayon-sy">,</span><span class="crayon-v">CabDir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"\\"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">CabFile</span><span class="crayon-sy">,</span><span class="crayon-s">' '</span><span class="crayon-sy">,</span><span class="crayon-v">CabDir</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">result</span><span class="crayon-o">=</span><span class="crayon-v">subprocess</span><span class="crayon-sy">.</span><span class="crayon-e">Popen</span><span class="crayon-sy">(</span><span class="crayon-s">"expand "</span><span class="crayon-o">+</span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdout</span><span class="crayon-o">=</span><span class="crayon-v">subprocess</span><span class="crayon-sy">.</span><span class="crayon-v">PIPE</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-e">wait</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-s">"Expanding Files Complete"</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-v">stdout</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Error Expanding CAB file"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ExpandedFile</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">CabDir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"\\"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">CabName</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-62"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">isfile</span><span class="crayon-sy">(</span><span class="crayon-v">ExpandedFile</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Did not find our expanded file %s"</span><span class="crayon-o">%</span><span class="crayon-e">CabName</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-64"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Check directory %s for expanded file %s"</span><span class="crayon-o">%</span><span class="crayon-sy">(</span><span class="crayon-v">CabDir</span><span class="crayon-sy">,</span><span class="crayon-v">CabName</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">ExpandedFile</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-67"><span class="crayon-e">def </span><span class="crayon-e">DecompressRoutine</span><span class="crayon-sy">(</span><span class="crayon-v">pargs</span><span class="crayon-sy">,</span><span class="crayon-v">hlzw</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LzwCompPattern</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"\x08\x00\xA5\x04\x01\x12\x03"</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">regex</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">re</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">LzwCompPattern</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">match </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">regex</span><span class="crayon-sy">.</span><span class="crayon-e">finditer</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">offset</span><span class="crayon-o">=</span><span class="crayon-v">match</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Found our compression header at file offset--&gt;{}"</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">offset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Deflated</span><span class="crayon-o">=</span><span class="crayon-e">LzwDecompress</span><span class="crayon-sy">(</span><span class="crayon-v">hlzw</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">offset</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">Deflated</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">pargs</span><span class="crayon-sy">.</span><span class="crayon-v">out_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"wb"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">wp</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">wp</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">Deflated</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Wrote decompressed stream to file--&gt;%s"</span><span class="crayon-o">%</span><span class="crayon-sy">(</span><span class="crayon-v">pargs</span><span class="crayon-sy">.</span><span class="crayon-v">out_file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-80"><span class="crayon-e">def </span><span class="crayon-e">Start</span><span class="crayon-sy">(</span><span class="crayon-v">pargs</span><span class="crayon-sy">,</span><span class="crayon-v">hlzw</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">CabCompPattern</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-sy">(</span><span class="crayon-s">"46444944657374726F790000464449436F7079004644494973436162696E657400000000464449437265617465000000636162696E65742E646C6C004D6963726F736F6674"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#Check For CAB file magic value first</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">found</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">regex</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">re</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">CabCompPattern</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'hex'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">match </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">regex</span><span class="crayon-sy">.</span><span class="crayon-e">finditer</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">found</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ExpandedFile</span><span class="crayon-o">=</span><span class="crayon-e">CabExtract</span><span class="crayon-sy">(</span><span class="crayon-v">match</span><span class="crayon-sy">,</span><span class="crayon-v">pargs</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">ExpandedFile</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">ExpandedFile</span><span class="crayon-sy">,</span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ExpandedData</span><span class="crayon-o">=</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DecompressRoutine</span><span class="crayon-sy">(</span><span class="crayon-v">pargs</span><span class="crayon-sy">,</span><span class="crayon-v">hlzw</span><span class="crayon-sy">,</span><span class="crayon-v">ExpandedData</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">result</span><span class="crayon-o">=</span><span class="crayon-e">DecompressRoutine</span><span class="crayon-sy">(</span><span class="crayon-v">pargs</span><span class="crayon-sy">,</span><span class="crayon-v">hlzw</span><span class="crayon-sy">,</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-97"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-98"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-99"><span class="crayon-e">def </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">parser</span><span class="crayon-o">=</span><span class="crayon-v">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-101"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">parser</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'--infile'</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dest</span><span class="crayon-o">=</span><span class="crayon-s">'input_file'</span><span class="crayon-sy">,</span><span class="crayon-v">help</span><span class="crayon-o">=</span><span class="crayon-s">"Input file to process"</span><span class="crayon-sy">,</span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-102"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">parser</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-o"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'--outfile'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dest</span><span class="crayon-o">=</span><span class="crayon-s">'out_file'</span><span class="crayon-sy">,</span><span class="crayon-v">help</span><span class="crayon-o">=</span><span class="crayon-s">"Optional Output file name"</span><span class="crayon-sy">,</span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-103"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parser</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-104"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-v">out_file</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-105"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-v">out_file</span><span class="crayon-o">=</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-v">input_file</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"_dec.txt"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lzwdll</span><span class="crayon-o">=</span><span class="crayon-s">"LzwDecompress.dll"</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-107"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lzwdllpath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">dirname</span><span class="crayon-sy">(</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">abspath</span><span class="crayon-sy">(</span><span class="crayon-v">__file__</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">lzwdll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-108"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">isfile</span><span class="crayon-sy">(</span><span class="crayon-v">lzwdllpath</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-109"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lzw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">windll</span><span class="crayon-sy">.</span><span class="crayon-e">LoadLibrary</span><span class="crayon-sy">(</span><span class="crayon-v">lzwdllpath</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-110"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lzw</span><span class="crayon-sy">.</span><span class="crayon-v">Decompress</span><span class="crayon-sy">.</span><span class="crayon-v">argtypes</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">LPCSTR</span><span class="crayon-sy">,</span><span class="crayon-v">LPCSTR</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-111"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lzw</span><span class="crayon-sy">.</span><span class="crayon-v">Decompress</span><span class="crayon-sy">.</span><span class="crayon-v">restypes</span><span class="crayon-o">=</span><span class="crayon-t">BOOL</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-112"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-113"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"Missing LzwDecompress.DLL"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-114"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-115"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-v">input_file</span><span class="crayon-sy">,</span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-116"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">FileData</span><span class="crayon-o">=</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-117"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Success</span><span class="crayon-o">=</span><span class="crayon-e">Start</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-v">lzw</span><span class="crayon-sy">,</span><span class="crayon-v">FileData</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-118"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">Success</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-119"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Did not find CAB or Compression routine in file %s"</span><span class="crayon-sy">)</span><span class="crayon-o">%</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-v">input_file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0c480047867-120"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'__main__'</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cc4adb0c480047867-121"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0066 seconds] -->
<p>The Python script was recently updated to support multiple Reaver variants. The newer Reaver variants use Microsoft CAB compression as a first layer followed by LZW modified decompression. The script does the following:</p>
<ul>
<li>Loads our DLL LzwDecompress.dll</li>
<li>Attempts to locate the magic signature values for the modified LZW header or Microsoft CAB</li>
<li>For the LZW decompression routine creates two string buffers, which are pointers to a buffer. The source buffer is a pointer to the data that needs to be decompressed and the destination buffer is where we will store the decompressed data.</li>
<li>Call the export named Decompress and pass it our two parameters</li>
<li>Writes the data to a file</li>
</ul>
<p>The following is an example of the script running:<br />
<img class="alignnone size-full wp-image-51225 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-Reversing.png" alt="Malware Reversing" width="975" height="56" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-Reversing.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-Reversing-900x52.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-Reversing-300x17.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-Reversing-768x44.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-Reversing-370x21.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p style="text-align: center;"><em>Figure 8 Script decompressing data</em></p>
<p>The first example is of an older version of Reaver that uses the LZW decompression routine. The decompressed data is written to a text file that contains the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cc4adb0f909078758" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
RA@10001=ole32.dll
RA@10002=CoCreateGuid
RA@10003=Shlwapi.dll
RA@10004=SHDeleteKeyA
RA@10005=wininet.dll
RA@10006=InternetOpenA
RA@10007=InternetOpenUrlA
RA@10008=InternetCloseHandle
RA@10009=HttpQueryInfoA
RA@10010=InternetReadFile
[TRUNCATED]
RA@10276=image/jpeg
RA@10277=netsvcs
RA@10282=Global\%sEvt
RA@10283=\temp\%sk.~tmp
RA@10284=Global\%skey
RA@10285=%08x%s
RA@10286=%s\
RA@10287=%s\*.*
RA@10288=%s\%s
RA@10289=CMD.EXE
RA@10290=%s=
RA@10311=\%sctr.dll
RA@10312=\uc.dat
RA@10313=ChangeServiceConfig2A
RA@10314=QueryServiceConfig2A</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-2">2</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-4">4</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-6">6</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-8">8</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-10">10</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-12">12</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-14">14</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-16">16</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-18">18</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-20">20</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-22">22</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-24">24</div><div class="crayon-num" data-line="crayon-5f694cc4adb0f909078758-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cc4adb0f909078758-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-1"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10001</span><span class="crayon-o">=</span><span class="crayon-v">ole32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-2"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10002</span><span class="crayon-o">=</span><span class="crayon-e">CoCreateGuid</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-3"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10003</span><span class="crayon-o">=</span><span class="crayon-v">Shlwapi</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-4"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10004</span><span class="crayon-o">=</span><span class="crayon-e">SHDeleteKeyA</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-5"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10005</span><span class="crayon-o">=</span><span class="crayon-v">wininet</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-6"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10006</span><span class="crayon-o">=</span><span class="crayon-e">InternetOpenA</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-7"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10007</span><span class="crayon-o">=</span><span class="crayon-e">InternetOpenUrlA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-8"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10008</span><span class="crayon-o">=</span><span class="crayon-e">InternetCloseHandle</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-9"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10009</span><span class="crayon-o">=</span><span class="crayon-e">HttpQueryInfoA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-10"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10010</span><span class="crayon-o">=</span><span class="crayon-i">InternetReadFile</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-11"><span class="crayon-sy">[</span><span class="crayon-v">TRUNCATED</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-12"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10276</span><span class="crayon-o">=</span><span class="crayon-v">image</span><span class="crayon-o">/</span><span class="crayon-e">jpeg</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-13"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10277</span><span class="crayon-o">=</span><span class="crayon-e">netsvcs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-14"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10282</span><span class="crayon-o">=</span><span class="crayon-m">Global</span><span class="crayon-sy">\</span><span class="crayon-o">%</span><span class="crayon-e">sEvt</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-15"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10283</span><span class="crayon-o">=</span><span class="crayon-sy">\</span><span class="crayon-v">temp</span><span class="crayon-sy">\</span><span class="crayon-o">%</span><span class="crayon-v">sk</span><span class="crayon-sy">.</span><span class="crayon-o">~</span><span class="crayon-e">tmp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-16"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10284</span><span class="crayon-o">=</span><span class="crayon-m">Global</span><span class="crayon-sy">\</span><span class="crayon-o">%</span><span class="crayon-e">skey</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-17"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10285</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-cn">08x</span><span class="crayon-o">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-18"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10286</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-v">s</span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-19"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10287</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-v">s</span><span class="crayon-sy">\</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-20"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10288</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-v">s</span><span class="crayon-sy">\</span><span class="crayon-o">%</span><span class="crayon-i">s</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-21"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10289</span><span class="crayon-o">=</span><span class="crayon-v">CMD</span><span class="crayon-sy">.</span><span class="crayon-e">EXE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-22"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10290</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-v">s</span><span class="crayon-o">=</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-23"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10311</span><span class="crayon-o">=</span><span class="crayon-sy">\</span><span class="crayon-o">%</span><span class="crayon-v">sctr</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-24"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10312</span><span class="crayon-o">=</span><span class="crayon-sy">\</span><span class="crayon-v">uc</span><span class="crayon-sy">.</span><span class="crayon-e">dat</span></div><div class="crayon-line" id="crayon-5f694cc4adb0f909078758-25"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10313</span><span class="crayon-o">=</span><span class="crayon-e">ChangeServiceConfig2A</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cc4adb0f909078758-26"><span class="crayon-v">RA</span><span class="crayon-sy">@</span><span class="crayon-cn">10314</span><span class="crayon-o">=</span><span class="crayon-v">QueryServiceConfig2A</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>The next example is of a newer Reaver sample that added a layer of compression using Microsoft CAB.<br />
<img class="alignnone size-full wp-image-51258 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-reversing_2.png" alt="Malware reversing_2" width="975" height="145" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-reversing_2.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-reversing_2-900x134.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-reversing_2-300x45.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-reversing_2-768x114.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/Malware-reversing_2-370x55.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p style="text-align: center;"><em>Figure 9 Script expanding CAB file and decompressing data</em></p>
<p>Here the script found the magic values for Microsoft CAB, expanded the file, read in the expanded file, found the magic value in that file for the decompression routine and wrote the same decompressed data to a text file.<br />
<span style="font-size: 18pt;"><br />
Conclusion</span><br />
This blog has shown you that by taking the existing Reaver decompression routine straight from assembly, placing it into Visual Studio, compiling it into a DLL, then calling into it via Python saves us a considerable amount of time. You no longer must reimplement the routine in C or Python as you simply call the routine and pass it the same data as the malware would. The tradeoff is understanding assembly, stacks and knowing what registers the routine requires. Once armed with that knowledge its easy to implement and can be applied to any function within a binary.</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p> 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
