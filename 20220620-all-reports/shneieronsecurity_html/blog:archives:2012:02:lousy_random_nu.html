<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Lousy Random Numbers Cause Insecure Public Keys - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Lousy Random Numbers Cause Insecure Public Keys Comments Feed" href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4232" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4232' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F02%2Flousy_random_nu.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F02%2Flousy_random_nu.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4232 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4232" class="post-4232 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-cryptanalysis tag-cryptography tag-keys tag-random-numbers">

	<div class="article">

		<h2 class="entry">Lousy Random Numbers Cause Insecure Public Keys</h2>
		<p>There&#8217;s some excellent research (<a href="http://eprint.iacr.org/2012/064.pdf">paper</a>, <a href="http://www.nytimes.com/2012/02/15/technology/researchers-find-flaw-in-an-online-encryption-method.html">news</a> <a href="http://arstechnica.com/business/news/2012/02/crypto-shocker-four-of-every-1000-public-keys-provide-no-security.ars">articles</a>) surveying public keys in the wild.  Basically, the researchers found that a small fraction of them (27,000 out of 7.1 million, or 0.38%) share a common factor and are inherently weak.  The researchers can break those public keys, and anyone who duplicates their research can as well.</p>
<p>The cause of this is almost certainly a lousy random number generator used to create those public keys in the first place.  This shouldn&#8217;t come as a surprise.  One of the hardest parts of cryptography is random number generation.  It&#8217;s really easy to write a lousy random number generator, and it&#8217;s not at all obvious that it is lousy.  Randomness is a non-functional requirement, and unless you specifically test for it &#8212; and know <i>how</i> to test for it &#8212; you&#8217;re going to think your cryptosystem is working just fine.  (One of the reporters who called me about this story said that the researchers told him about a real-world random number generator that produced just seven different random numbers.)  So it&#8217;s likely these weak keys are accidental.</p>
<p>It&#8217;s certainly possible, though, that some random number generators have been deliberately weakened.  The obvious culprits are national intelligence services like the NSA.  I have no evidence that this happened, but if I were in charge of weakening cryptosystems in the real world, the first thing I would target is random number generators. They&#8217;re easy to weaken, and it&#8217;s hard to detect that you&#8217;ve done anything.  Much safer than tweaking the algorithms, which can be tested against known test vectors and alternate implementations.  But again, I&#8217;m just speculating here.</p>
<p>What is the security risk?  There&#8217;s some, but it&#8217;s hard to know how much.  We can assume that the bad guys can replicate this experiment and find the weak keys.  But they&#8217;re random, so it&#8217;s hard to know how to monetize this attack.  Maybe the bad guys will get lucky and one of the weak keys will lead to some obvious way to steal money, or trade secrets, or national intelligence.  Maybe.</p>
<p>And what happens now?  My hope is that the researchers know which implementations of public-key systems are susceptible to these bad random numbers &#8212; they didn&#8217;t name names in the paper &#8212; and alerted them, and that those companies will fix their systems.  (I recommend my own <a href="http://en.wikipedia.org/wiki/Fortuna_PRNG">Fortuna</a>, from <a href="http://www.schneier.com/book-ce.html"><i>Cryptography Engineering</i></a>.)  I hope that everyone who implements a home-grown random number generator will rip it out and put in something better.  But I don&#8217;t hold out much hope.  Bad random numbers have broken a lot of cryptosystems in the past, and will continue to do so in the future.</p>
<p>From the introduction to the <a href="http://eprint.iacr.org/2012/064.pdf">paper</a>:</p>
<blockquote><p>In this paper we complement previous studies by concentrating on computational and randomness properties of actual public keys, issues that are usually taken for granted. Compared to the collection of certificates considered in [12], where shared RSA moduli are &#8220;not very frequent&#8221;, we found a much higher fraction of duplicates. More worrisome is that among the 4.7 million distinct 1024-bit RSA moduli that we had originally collected, more than 12500 have a single prime factor in common. That this happens may be crypto-folklore, but it was new to us, and it does not seem to be a disappearing trend: in our current collection of 7.1 million 1024-bit RSA moduli, almost 27000 are vulnerable and 2048-bit RSA moduli are affected as well. When exploited, it could act the expectation of security that the public key infrastructure is intended to achieve.</p></blockquote>
<p>And the conclusion:</p>
<blockquote><p>We checked the computational properties of millions of public keys that we collected on the web. The majority does not seem to suffer from obvious weaknesses and can be expected to provide the expected level of security. We found that on the order of 0.003% of public keys is incorrect, which does not seem to be unacceptable. We were surprised, however, by the extent to which public keys are shared among unrelated parties. For ElGamal and DSA sharing is rare, but for RSA the frequency of sharing may be a cause for concern. What surprised us most is that many thousands of 1024-bit RSA moduli, including thousands that are contained in still valid X.509 certificates, offer no security at all. This may indicate that proper seeding of random number generators is still a problematic issue&#8230;.</p></blockquote>
<p>EDITED TO ADD (3/14):  The title of the paper, &#8220;Ron was wrong, Whit is right&#8221; refers to the fact that RSA is inherently less secure because it needs two large random primes.  Discrete log based algorithms, like DSA and ElGamal, are less susceptible to this vulnerability because they only need one random prime.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/random-numbers/" rel="tag">random numbers</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html" rel="bookmark">Posted on February 16, 2012 at 6:51 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html#comments">49 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html" data-title="Lousy Random Numbers Cause Insecure Public Keys" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-175205">

			<div class="comment by-d0r ">

				<p class="commentcredit">

					<span class="commenter">D0R</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175205">
						February 16, 2012 7:02 AM					</a>

				</p>

				<p>Very interesting analysis of the paper, thanks.</p>
<p>Sadly, as usual, popular newspapers have reported it with too much hype &#8212; one of them alerted readers that &#8220;now the bad guys can crack any key in minutes&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175206">

			<div class="comment by-brian-raaen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.brianraaen.com' rel='external nofollow ugc' class='url'>Brian Raaen</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175206">
						February 16, 2012 7:29 AM					</a>

				</p>

				<p>You have the wrong link for Fortuna.  It should be <a href="http://en.wikipedia.org/wiki/Fortuna_(PRNG)" rel="nofollow ugc">http://en.wikipedia.org/wiki/Fortuna_(PRNG)</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175207">

			<div class="comment by-gregw ">

				<p class="commentcredit">

					<span class="commenter">GregW</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175207">
						February 16, 2012 7:38 AM					</a>

				</p>

				<p>There&#8217;s some independent simultaneous research on this topic from some other security researchers who just rushed out a blog post.  Their findings appear to be&#8211; at a high level&#8211; similar, although as I read it, it seems clearer from these second researchers that more of the problems may be from embedded devices (VPNs, firewalls, etc), and thus perhaps due to low entropy rather than bad PRNGs per se:</p>
<p><a href="https://freedom-to-tinker.com/blog/nadiah/new-research-theres-no-need-panic-over-factorable-keys-just-mind-your-ps-and-qs" rel="nofollow ugc">https://freedom-to-tinker.com/blog/nadiah/new-research-theres-no-need-panic-over-factorable-keys-just-mind-your-ps-and-qs</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175208">

			<div class="comment by-lloyd ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://LoneGunman.co.uk' rel='external nofollow ugc' class='url'>Lloyd</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175208">
						February 16, 2012 7:38 AM					</a>

				</p>

				<p>The link for Fortuna is now OK: I added a redirect on the Wikipedia side. No need for it to be updated here now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175209">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://catbag.wordpress.cam' rel='external nofollow ugc' class='url'>Carlo Graziani</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175209">
						February 16, 2012 7:45 AM					</a>

				</p>

				<p>Without venturing into conspiracy theories about deliberate weakening of RNGs, I think it&#8217;s worth pointing out that RNGs are used for (at least) two distinct purposes, and that good design features and practices for one use are terrible features for the other.</p>
<p>In computational science, RNGs are used to power Monte Carlo simulations along.  For this application, &#8220;true&#8221; randomness is of course important, but so is repeatability.  You need to be able to replicate a Monte Carlo simulation bit-for-bit, for debugging purposes and for the sake of scientific repeatability.  So even though the numbers are pseudo-random, the seeds and sequence starts must be recorded, and the RNG had better make the same stream of numbers given those initialization values.</p>
<p>In security applications, repeatability is not only unnecessary, it&#8217;s downright dangerous, as exemplified by the research above.  RNGs for this class of applications should give some strong guarantee of non-repeatability, by gathering entropy from system electronic noise, keypress rates, etc.  Which would be a terrible idea for scientific applications.</p>
<p>It&#8217;s a subtle distinction, possibly lost on some security coders (and sadly also on some computational scientists).  Selection of an RNG algorithm and/or initialization practice from the wrong application category can produce insecure code in one case, scientific malpractice in the other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175210">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175210">
						February 16, 2012 8:09 AM					</a>

				</p>

				<p>There is a trade-off in an entropy-starved situation: You can let the user wait (or enter a few random keystrokes) or you can be insecure. On the technical side, if it is Linux just read the number of bits you need from /dev/random (not /dev/urandom!) and you are fine. This may take a while though.</p>
<p>My guess is that the developers responsible are either incompetent and had no idea what they were doing (would not be a surprise) or decided to go for convenience instead of security (would not be a surprise either).</p>
<p>Side note: I know of cases where the CPU used in a device actually had a good true-RNG, but it was not used in key-generation or used wrongly due to developer incompetence. &#8220;Incompetence&#8221; here means they failed to read the half-page in the documentation that states that the bits delivered do not have 1 bit/bit of entropy but a lower value.</p>
<p>This is really not a technological problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175211">

			<div class="comment by-danny-moules ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://rushyo.com' rel='external nofollow ugc' class='url'>Danny Moules</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175211">
						February 16, 2012 8:13 AM					</a>

				</p>

				<p>It&#8217;s hardly surprising that machines that generate RSA keys straight out of factory have predictable predictability issues.</p>
<p>What is surprising is that no security personnel at the device vendors thought about shouting about this at any point &#8211; entropy, and its consideration in security assessments, shouldn&#8217;t be a black art.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175212">

			<div class="comment by-will ">

				<p class="commentcredit">

					<span class="commenter">Will</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175212">
						February 16, 2012 8:20 AM					</a>

				</p>

				<p>Were there any weak debian keys among them?</p>
<p>(Or home routers and appliances with debian baked into them?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175213">

			<div class="comment by-jakub-narebski ">

				<p class="commentcredit">

					<span class="commenter">Jakub NarÄ™bski</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175213">
						February 16, 2012 8:25 AM					</a>

				</p>

				<p>What suprised me is that Arstechnica article states that sharing prime factor is worse for security of RSA, than for DSA.</p>
<p>Can anyone tel me why it is so?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175214">

			<div class="comment by-llewelly ">

				<p class="commentcredit">

					<span class="commenter">llewelly</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175214">
						February 16, 2012 8:26 AM					</a>

				</p>

				<p>Only 0.38%? Good news if you ask me, Much better than I would have expected. Very few people know how to test an RNG. Worse, it&#8217;s easy to screw up; common preconceptions about &#8220;random&#8221; will confuse at every step of the way.</p>
<p>And even among crypto geeks who /know/ how to test (not me; I once learned the theory behind testing RNGs, but determing the output of Mersenne twister was better than a linear congruential was the farthest I ever went ), how many of them test more than one or two of the RNG reliant pieces of software they use?</p>
<p>Further, I&#8217;m convinced (and I doubt many here will disagree) this is a general problem with security related software; it&#8217;s prone to extremely subtle bugs, which he vast majority of users, even most experts, are unlikely notice, which are nonetheless potential security problems.</p>
<p>But there is good news: This particular weakness is unlikely to be exploited; there are host of easier-to-exploit weaknesses out there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175215">

			<div class="comment by-mikeazo ">

				<p class="commentcredit">

					<span class="commenter">mikeazo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175215">
						February 16, 2012 8:47 AM					</a>

				</p>

				<p>@Will, they removed any of the weak debian keys with known factors from the dataset.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175216">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter">Adam</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175216">
						February 16, 2012 9:05 AM					</a>

				</p>

				<p>Surely a homegrown RNG would help here given that this appears to be a class break of some RNG being used in the wild. Not that I advocate using a homegrown RNG, just saying.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175217">

			<div class="comment by-james-sutherland ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.deadnode.org/' rel='external nofollow ugc' class='url'>James Sutherland</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175217">
						February 16, 2012 9:08 AM					</a>

				</p>

				<p>A lousy random number generator must be one of the harder vulnerabilities to check for &#8211; particularly as a concealed fault. Easy to imagine someone having slipped in &#8220;if timezone==Iran return 1;&#8221;&#8230;</p>
<p>Back as a student, I remember writing our own entropy source &#8211; getting the user to click on a series of pseudo-randomly-located boxes on screen. We hashed the exact timestamp, x and y position within the box and a random number from the existing PRNG together.</p>
<p>@Gweihir: the &#8216;just wait&#8217; for more entropy is fine for some situations, but a busy server doing SSL could find it a bottleneck &#8211; particularly if an attacker knows that and opens a load of junk sessions to drain the entropy pool. I seem to recall entropy starvation becoming a performance bottleneck somewhere: on a headless server, entropy sources like keyboard and mouse movements don&#8217;t apply &#8211; and of course network timing can be externally influenced, making it suspect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175218">

			<div class="comment by-mike-t ">

				<p class="commentcredit">

					<span class="commenter">Mike T</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175218">
						February 16, 2012 9:23 AM					</a>

				</p>

				<p>Heh.  Randall got this one too: <a href="http://xkcd.com/221/" rel="nofollow ugc">http://xkcd.com/221/</a></p>
<p>Mike</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175219">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175219">
						February 16, 2012 9:25 AM					</a>

				</p>

				<p>Fortuna is definitely a good bet for secure RNG design.  But it still relies on collecting sufficient entropy to seed the generator, which is a non-trivial problem.  The NEED to do so is frequently brought up, but getting good entropy values for seeding still seems to be hard (particularly for server type machines).</p>
<p>Fortuna basically solved the problem of how to generate cryptographic pseudo random numbers from small amounts of entropy as far as I&#8217;m concerned (as long as the underlying crypto remains secure).  Figuring out how to get good initial entropy still seems like an open problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175220">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175220">
						February 16, 2012 10:20 AM					</a>

				</p>

				<p>I would strongly suggest people read the paper because they make other statments about the number of keys with issues such as,</p>
<p><i>It pales, however, compared to the situation with  RSA. Of 6.6 million distinct X.509 certificates and PGP keys (cf. [1]) containing RSA moduli, 0.27 million <b>(4%) share their RSA modulus</b>, often involving unrelated parties. Of 6.4 million distinct RSA moduli, 71052 (1.1%) occur more than once, some of them thousands of times.</i>.</p>
<p>Now as regular readers of this blog know &#8220;diceware&#8221; gets mentioned often when random number generation is discussed you can read the diceware authors take on this at,</p>
<p><a href="http://diceware.blogspot.com/2012/02/was-whit-really-right.html" rel="nofollow ugc">http://diceware.blogspot.com/2012/02/was-whit-really-right.html</a></p>
<p>He thinks the research points to a possible signiture to &#8220;malware&#8221; fritzing the calls to the random number generator which Bruce has also mentioned.</p>
<p>Now this is far from a new idea Adam Young and Moti Yung proposed this and other ideas to fritz PQ pairs back last century under their ideas for &#8220;Cryptovirology&#8221;,</p>
<p><a href="http://www.cryptovirology.com/" rel="nofollow ugc">http://www.cryptovirology.com/</a></p>
<p>Whilst I would not rule it out (I&#8217;ve done similar things myself as I&#8217;ve indicated in the past on this blog) it&#8217;s more likely to be poor programing in some code library software engineers are using virtualy sight unseen.</p>
<p>Why do I think this, well Adam and Moti published information that showed how to easily hide your fritzing into the selection of one of the PQ primes that would be undetectable to detect with only the PQ pair or the resulting Pub/Pri keys.</p>
<p>Essentialy what you do is use the immense redundancy in the resulting PQ pair to hide a shortend (about 1/6th of total PubKey length) hidden RSA message for which you only have the PriKey, this message contains an offset number as to where one of the PQ primes was selected from. Thus you cut your search space down to a trivial number to find one of the primes (the other being genuinely random drops out).</p>
<p>Now as Bruce notes generating genuinely random numbers is at best a difficult problem (you first have to realise that there are no random numbers only random sequences and random is such a nebulous term you can only wave your arms around ðŸ˜‰</p>
<p>However the usual place to start looking is at what are quaintly called True Random Number Generators (TRNG&#8217;s). The way they work is to take input from a physical world source (I&#8217;ll leave quantum out of this simple explination). Now one the consiquences of physical world sources is their output is effectivly modelled as two or more signals combined (by addition, multiplication or both in one or more dimensions such as amplitude, time or sequence). One is in some way predictable and we call it &#8220;bias&#8221; and the other we cann&#8217;t detect predictability and that&#8217;s the one we want to use as our source of entropy.</p>
<p>Now seperating the bias from the desired unpredictable signal is even at the best of times wastefull and can appear as some kind of &#8220;voodoo ritual&#8221; method.</p>
<p>So many designers don&#8217;t bother, they figure jusst putting it through a crypto or hash algorithm will solve the problem. It doesn&#8217;t yo have no more entropy in the result than you had before, it just &#8220;looks&#8221; more random&#8230; The problem with this is you can get sequence correlation between two or more generator outputs, which can in some cases cause symptoms like those that have been found in those RSA Certs.</p>
<p>Now one of the problems that arises is the value of each bit of entropy. Depending on the source and how the bias is removed you could be getting only a very small percentage of the bits coming out of the source. The more complex the bias removal process the more bits you get but there is only so far you can go. Thus the designer has to make a trade off between CPU cycles and lines of code used to remove bias and the number of bits required.</p>
<p>Now back in the last century one or two people suggested a heretical idea of &#8220;entropy spreading&#8221;, and it caught on. Unlike hashing the output which does not change the entropy the idea was to apply each bit of entropy to a pool of bits in such a way that it spread it&#8217;s value across many of the bits in the pool and in some systems over time as well.</p>
<p>On further reflection you can come up with a different way to spread entropy, you take a stream cipher like RC4 or other reasonably efficient &#8220;pot stirrer&#8221; and apply each bit of entropy as it occurs to &#8220;jog the pot&#8221;. Like throwing a stone in a pool the effect of the bit ripples out across the entire surface and folds back and mixes unpredictably with the other pot jogging bits. The advantage however is that the number of unpredictable bits you can get out of the stream cipher is considerably higher (look up unicity distance to see by how much).</p>
<p>A further thought on this is that of &#8220;non determanistic sampling&#8221; that is on many systems it is not possible for a piece of code to regularly sample the output of the stream cipher, therefor this adds further to the unpredictably of the generator output as you can use it as another pot jogger as well.</p>
<p>However there is a catch, on certain systems and certain operating system types there is little or no uncertainty. This happens on many embbeded systems especially those that have a Real Time OS (RTOS) or use fixed low latency design for Real Time response (ie you want your foot going down on the break peddle in your car getting through the ABS system as rapidly as possible).</p>
<p>Also no matter how fast your source of entropy is it still takes time to build up to a usefull number of bits, and rapidly sampling the entropy pool can rapidly bring down the effective level of entropy in the pool.</p>
<p>Thus one solution is to &#8220;block&#8221; a requesting process untill such time as sufficient entropy has built up. This can cause significant problems in that the process can be highly non linear and this in many systems is highly undesirable (imagine what would happen if the brake peddle signal got blocked?). And I&#8217;ve seen some designs where the blocked processes were also the ones adding entropy to the pool so dead lock could be just a breath away followed by total system lock up, not good on a PC but in an embedded system easily fatal.</p>
<p>Not knowing much of the above before you build a secure system that needs a suitably specified TRNG means that the chances are high that you can and in all probability will shoot yourself in the foot and some of your systems users in the head.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175221">

			<div class="comment by-john-kelsey ">

				<p class="commentcredit">

					<span class="commenter">John Kelsey</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175221">
						February 16, 2012 10:25 AM					</a>

				</p>

				<p>Jakob:</p>
<p>DSA is designed so it&#8217;s perfectly okay to share the system parameters<br />
(g,p,q) among many users, and also that there&#8217;s no secrecy in these values.  If any users of the same parameters get the same secret key x and public key y, that&#8217;s a big problem, but it doesn&#8217;t look like they saw any of that.</p>
<p>I&#8217;m not sure why this happened.  One guess is that if you generate your own (g,p,q) randomly, that gives you enough time to get from a relatively predictable system state to a more unpredictable one.</p>
<p>My intuition here is like this:  On a closed-off computer with no user interface and no physical hard drive and nothing going on in terms of network traffic, when you start up, your processor is in one of a fairly small number of possible states.  Techniques for drawing entropy from the OS are ultimately just measuring this state, and so there&#8217;s just not much entropy to be found.</p>
<p>Over time, I assume a certain amount of unpredictability sets in.  If the device is plugged into a network, it may be processing some packets from time to time.  There may be some other sources of unpredictability&#8211;for example, the device may have to manage its temperature by turning on/off a fan based on a thermostat, and that may affect the behavior of the system somehow.</p>
<p>If you&#8217;re generating your DSA parameters first, at least using the technique for generating a provably ok set of parameters, there&#8217;s a fair bit of processing going on.  (You have to generate a 160-bit prime and a seed, then use that to generate a 1024-bit prime so that p%q==1.)  My intuition is that during all this churning, there is enough time for the machine&#8217;s state to get somewhat more unpredictable&#8211;by the end, it can be in a larger set of possible states.  (For each SEED choice, we get a different number of iterations of the process, meaning a different set of possible machine states.)</p>
<p>So I have this mental picture that what we&#8217;re really doing is:</p>
<p>RSA:<br />
[small set of starting machine states]<br />
Generate p<br />
[slightly larger set]<br />
Generate q<br />
[slightly larger set]</p>
<p>DSA:<br />
[small set of starting machine states]<br />
Generate q and seed, and do lots of spinning and back-and-forth to get (g,p,q).<br />
[much larger set of machine states]<br />
Generate x and y=g^x mod p</p>
<p>I am not at all sure about this&#8211;I could be completely wrong.  But this would explain something about that pattern we&#8217;re seeing here.  Though it&#8217;s also quite possible that the DSA implementations are just better about getting fresh entropy, or that DSA implementations are done by higher end/more capable devices with more going on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175222">

			<div class="comment by-john-kelsey ">

				<p class="commentcredit">

					<span class="commenter">John Kelsey</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175222">
						February 16, 2012 10:37 AM					</a>

				</p>

				<p>Bruce,</p>
<p>I think if you were installing an intentional back door, you&#8217;d have included the devices&#8217; ethernet addresses in the RNG seed.  That would make the weakness invisible to this kind of examination, while still letting you brute force the low-entropy prime factors cheaply as needed.</p>
<p>I think this problem comes entirely down to assessing entropy correctly and waiting to generate RNG outputs till you have enough of it.  I don&#8217;t think Fortuna would help much&#8211;this is a place where what&#8217;s needed is dumping every bit of entropy in your possession into the pool just before you generate your high-value keypair, not holding some back in hopes that you&#8217;ll eventually reseed with enough entropy to get to a secure state.  If your RNG isn&#8217;t in a secure state once you generate your keypair, it probably doesn&#8217;t matter whether you get into one later on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175223">

			<div class="comment by-personal-otp ">

				<p class="commentcredit">

					<span class="commenter">Personal OTP</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175223">
						February 16, 2012 10:53 AM					</a>

				</p>

				<p>Thank you for the Fortuna reference, particular given the links to code; however,<br />
1) recommended code for entropy generation on various systems would be exceptionally useful</p>
<p>and</p>
<p>2) even more useful would be recommendations on existing random number generators, such as<br />
gpg &#8211;gen-random 2 (for a given version)</p>
<p>openssl rand (for a given version/platform)</p>
<p>Truecrypt&#8217;s keyfile generator (for a given version/platform)</p>
<p>Microsoft .NET System.Security.Cryptography.RNGCryptoServiceProvider (for a given version/platform)</p>
<p>(hardware) Araneus Alea I hardware (possibly used in a reduced RF environment)</p>
<p>Users, unfortunately, can be told &#8220;Use a good random number generator&#8221; and &#8220;make sure the entropy pool is sufficient&#8221;, but at the user level (even highly technical users), that&#8217;s not very useful.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175224">

			<div class="comment by-gary ">

				<p class="commentcredit">

					<span class="commenter">Gary</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175224">
						February 16, 2012 11:40 AM					</a>

				</p>

				<p>Anyone have experience with these?  <a href="http://www.idquantique.com/true-random-number-generator/products-overview.html" rel="nofollow ugc">http://www.idquantique.com/true-random-number-generator/products-overview.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175225">

			<div class="comment by-petra-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Petr&eacute;a Mitchell</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175225">
						February 16, 2012 11:57 AM					</a>

				</p>

				<p>&#8220;2) even more useful would be recommendations on existing random number generators&#8221;</p>
<p>In addition to the above, here&#8217;s <a href="http://www.random.org/" rel="nofollow ugc">an online service for random number generation</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175226">

			<div class="comment by-robert-thille ">

				<p class="commentcredit">

					<span class="commenter">Robert Thille</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175226">
						February 16, 2012 12:29 PM					</a>

				</p>

				<p>Does anyone have comments on good hardware RNGs?  Particularly the VIA C3, on chip RNGs?<br />
<a href="http://www.via.com.tw/en/initiatives/padlock/hardware.jsp" rel="nofollow ugc">http://www.via.com.tw/en/initiatives/padlock/hardware.jsp</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175227">

			<div class="comment by-tony ">

				<p class="commentcredit">

					<span class="commenter">Tony</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175227">
						February 16, 2012 1:19 PM					</a>

				</p>

				<p>Coming soon to the X86 processor (Ivy Bridge):</p>
<p><a href="http://en.wikipedia.org/wiki/RdRand" rel="nofollow ugc">http://en.wikipedia.org/wiki/RdRand</a></p>
<p>Patches are already in Linux to make (some) use of it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175228">

			<div class="comment by-oracle ">

				<p class="commentcredit">

					<span class="commenter">Oracle</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175228">
						February 16, 2012 1:28 PM					</a>

				</p>

				<p>Fortuna has one big problem &#8211; it&#8217;s a &#8220;proprietary&#8221; algorithm.  There is no spec available online&#8230;</p>
<p>The Wikipedia article does not count; or rather it counts as the best spec.  Which is obviously deficient for proper implementation &#8211; there are various details to get right, various tradeoff to be made.</p>
<p>And it&#8217;s not to useful to look at various implementations lying around &#8211; there is no way to understand what code is part of Fortuna and what is random hack.</p>
<p>So Bruce, if you really want to promote Fortuna, please make the spec public&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175229">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175229">
						February 16, 2012 2:48 PM					</a>

				</p>

				<p>This may be due to bad entropy sources in embedded devices.  Servers are starting to see the same issue.  SSDs have no rotational latency to use as an entropy source.  They have no keyboards or mice to get entropy from the user.  If running in a VM they may have biases in their view of event times so that multiple VMs could get the &#8220;same&#8221; entropy data.  Hence the need for HW RNG or DRNG (Intel&#8217;s solution in Ivy Bridge).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175230">

			<div class="comment by-thunderbird ">

				<p class="commentcredit">

					<span class="commenter">Thunderbird</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175230">
						February 16, 2012 3:24 PM					</a>

				</p>

				<blockquote><p>In addition to the above, here&#8217;s an online service for random number generation.</p></blockquote>
<p>Of course, just in case it isn&#8217;t obvious to anyone, letting someone else generate a random number you use to generate a key is probably a really bad idea if you are at all concerned with the key being, you know, secret.  I suspect this is obvious to most all people that might comment here, but might not be to someone that runs across this conversation through the wonders of Das Intartubes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175231">

			<div class="comment by-ssl-servers ">

				<p class="commentcredit">

					<span class="commenter">SSL Servers</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175231">
						February 16, 2012 4:21 PM					</a>

				</p>

				<p>There are quite a few public random number servers.  Consider:</p>
<p>openssl s_client -connect google.com:443 &lt; /dev/null | sha256</p>
<p>Using something like this&#8211;ideally using  multiple servers&#8211;as input to an entropy pool may be useful for situations where an attacker cannot see all of the network traffic.  Many systems generate keys when they boot the first time (e.g,. ssh); this is also the worst-case for available pool entropy&#8230;</p>
<p>Of course, proper hardware support is the only decent answer (VIA&#8217;s Padlock or Intel&#8217;s RdRand).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175232">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175232">
						February 16, 2012 5:19 PM					</a>

				</p>

				<p>@ Oracal,</p>
<p><i>Fortuna has one big problem&#8230;</i></p>
<p>Have a look at ,</p>
<p><a href="http://th.informatik.uni-mannheim.de/people/lucks/papers/Ferguson/Fortuna.pdf" rel="nofollow ugc">http://th.informatik.uni-mannheim.de/people/lucks/papers/Ferguson/Fortuna.pdf</a></p>
<p>It&#8217;s a PDF of a powerpoint presentaiton by Niels Ferguson going into the background of Fortuna&#8217;s design and the things considered.</p>
<p>Although not giving you a full specification, it contains more than sufficient info for you to build your own version (and you could always go and buy the book ðŸ˜‰</p>
<p>Essentialy the working end of Fortuna is AES (or other block cipher) in counter mode. The initial seed value is the AESkey and value for the counter. It is updated by changing the counter or key and sometimes both. The update is done by K entropy pools where the pool used is based on 2^k, thus the current suggestion of K=32 should give a number of years (see Yarrow for an earlier idea). When either 1MByte of update or output is read from the generator the key value is updated. This is done by clocking the counter twice and using the two values to get the new key value.</p>
<p>The way the updating of the entropy pools is done is a little more complex. Have a look at,</p>
<p><a href="http://rennes.ucc.ie/~robertmce/presentations/Fortuna_McEvoy.pdf" rel="nofollow ugc">http://rennes.ucc.ie/~robertmce/presentations/Fortuna_McEvoy.pdf</a></p>
<p>As far as I&#8217;m aware there is opensource code in atleast C++ or Python easily available that is sufficiently well written to be readily understandable.</p>
<p>On a more general note about randomness and it&#8217;s uses have a look at,</p>
<p><a href="http://www.iro.umontreal.ca/~lecuyer/" rel="nofollow ugc">http://www.iro.umontreal.ca/~lecuyer/</a></p>
<p>His papers are definatly worth a look through if you have the time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175233">

			<div class="comment by-paul ">

				<p class="commentcredit">

					<span class="commenter">paul</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175233">
						February 16, 2012 6:13 PM					</a>

				</p>

				<p>I remember reading a couple of years back that various gov&#8217;t agencies had compromised some aspects of various FOSS tools but never found out what was targeted or if the damage had been found/undone.</p>
<p>Perhaps RNGs were the target.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175234">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175234">
						February 16, 2012 6:35 PM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>&#8220;However there is a catch, on certain systems and certain operating system types there is little or no uncertainty. This happens on many embbeded systems especially those that have a Real Time OS (RTOS) or use fixed low latency design for Real Time response (ie you want your foot going down on the break peddle in your car getting through the ABS system as rapidly as possible).&#8221;</p>
<p>That&#8217;s basically what I see as the fundamental problem with cryptographically secure random number generation.  Computers, by design, are usually pretty good at having predictable behavior.  Entropy in computer systems often seems to boil down to measuring external things like user behavior (which is not always practical) or behavior determined by a sufficiently large number of factors that predicting the outcome is difficult.</p>
<p>One thing I think might be worth exploring is the idea of maximizing use of entropy in random number generators.  Decades of crypto research have given us tools that transform relatively short values into long unpredictable outputs (stream ciphers, for example).  Random number generators could potentially get a lot more cryptographically random output for each bit of true entropy input than they do right now.  The end result would be an ability to be a lot more careful in entropy collection without an appreciable drop in random number generation speed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175235">

			<div class="comment by-marian-kechlibar ">

				<p class="commentcredit">

					<span class="commenter">Marian Kechlibar</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175235">
						February 17, 2012 3:32 AM					</a>

				</p>

				<p>Interesting.</p>
<p>I like Fortuna and I have implemented a C++ port of it for mobile devices. (On smartphones, entropy sources like the camera are very useful. Tons of entropy per single frame, even in viewfinder regime.)</p>
<p>Attacking the PRNG is very advantageous for adversaries, as it does not create any compatibility issues.</p>
<p>If you&#8217;re not sure about your particular PRNG, I would suggest running the battery of NIST tests on the PRNG output from time to time. They are easy to implement, but they do take some CPU cycles.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175236">

			<div class="comment by-patrick ">

				<p class="commentcredit">

					<span class="commenter">Patrick</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175236">
						February 17, 2012 11:58 AM					</a>

				</p>

				<p>&#8220;The majority does not seem to suffer from obvious weaknesses&#8221;..</p>
<p>But :<br />
&#8220;containing RSA moduli, 0.27 million (4%) share their RSA modulus, often involving unrelated parties. Of 6.4 million distinct RSA moduli, 71052 (1.1%) occur more than once, some of them thousands of times..&#8221;</p>
<p>What the researchers seem to have found is the RNG leaking it&#8217;s non-randomness .<br />
ATM I see no reason not to assume that ALL RSA-keys are equally non-random .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175237">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175237">
						February 17, 2012 4:08 PM					</a>

				</p>

				<p>I stopped dead in my tracks the day it occurred to me that the Debian key generation bug <em>could have been</em> intentional sabotage. I&#8217;ve thought about every bug announcement differently since.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175238">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175238">
						February 18, 2012 4:55 AM					</a>

				</p>

				<p>The repeated RSA modulus factors might not be due to a bad random number generator or to bad seeding of a good random number generator.</p>
<p>Here&#8217;s another scenario: The software picks a random number, tests it for primality, and finds it isn&#8217;t prime. But then &#8212; rather than pick another random number, which might take a long time waiting for the entropy pool to replenish &#8212; the software just repeatedly increments and tests the previous number until it hits a prime. Since primes of the requisite size are (relatively) rare, there&#8217;s a small chance that two runs of the software will hit the same prime &#8212; even with a cryptographically strong random number generator seeded from a true random source.</p>
<p>Boneheaded? Of course. But it <i>could</i> have happened that way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175239">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175239">
						February 18, 2012 5:50 AM					</a>

				</p>

				<p>@ Alan Kaminsky,</p>
<p><i>Boneheaded? Of course. But it could have happened that way</i></p>
<p>Err no trust me on this I&#8217;ve seen it done that way many times, from a software developers reasoning it makes one whole load of sense for a couple of reasons.</p>
<p>Firstly because it&#8217;s guaranteed to find a prime within a short period of time. And secondly  because it &#8220;stays in chache&#8221; and is thus very fast.</p>
<p>It&#8217;s also partly done that way because some people incrorrectly designed de-bias systems for post processing TRNG output to work that way.</p>
<p>This is because the reasoning is somewhat as follows,</p>
<p>1, All primes (except 2) are odd.<br />
2, Therefore the LSBit of a prime is always 1.<br />
3, Half the numbers from a TRNG are even.<br />
4, Make TRNG output odd.</p>
<p>There are three basic ways to do step four,</p>
<p>1, Test if even and increment.<br />
2, Just set the LSB.<br />
3, Rotate TRNG &#8220;word&#8221; till LSB is set.<br />
3, Shift left one bit and set LSB.</p>
<p>The nominaly correct way is the last way (usually no branch or attendent cach issues), but many programers do it the first way.</p>
<p>And the &#8220;Add 2 and retest as prime&#8221; also makes a whole load of sense if your plan is to fritz the key pair as it reduces your search space a great deal (see my post above).</p>
<p>As &#8220;entropy&#8221; is like &#8220;fine wine&#8221; it &#8220;takes time to mature&#8221; and is thus &#8220;an inordinatly expensive commodity&#8221;. Another way you sometimes see is generate a whole stream of small TRNG numbers ( ie a word in size) then concatinate to make the large prime, if not a prime then swap bottom word with another new TRNG word or use a circular buffer and write over the bottom number and re-test.</p>
<p>Then there is &#8220;binary swap&#8221; or it&#8217;s legion of variations, generate a large random number as above if no good then swap within the array of words in a binary (or other) pattern.</p>
<p>But&#8230; At the end of the day jprimes are a &#8216;sparse data set&#8217; so ust generating more and more TRNG output is NOT guaranteed to ever finish or even get close&#8230; So pragmaticaly you do have to switch to incrementing something at some point.</p>
<p>As I described above it&#8217;s a way I&#8217;ve used in the past to fritz PubKeys amongst other things (to demonstrate a point to managment about code review process). The only extra I used was to use a BBS random number generator as well (which conveniently hid the shorter PubKey used to encrypt the start point info).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175240">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175240">
						February 18, 2012 4:23 PM					</a>

				</p>

				<p>@Alan Kaminsky:</p>
<p>&#8220;Since primes of the requisite size are (relatively) rare, there&#8217;s a small chance that two runs of the software will hit the same prime &#8212; even with a cryptographically strong random number generator seeded from a true random source.&#8221;</p>
<p>I&#8217;m not confident that I follow the reasoning here &#8212; is the idea that the increment-and-test algorithm increases the probability of repeating primes, versus generating a new pseudo-random bit sequence for each trial?  It seems to me that the probability of repeated primes is not affected, but I&#8217;m interested in seeing any argument to the contrary.  [Note:  if the pseudo-random bit source is broken, the likelihood of repeated primes might well vary between these algorithms, depending on the nature of the defect.]</p>
<p>When I wrote an RSA key generator, I used the increment-and-test algorithm, on the premise that entropy is rare and valuable, and that numerous repeated draws from the entropy-pooling random generator would decrease the entropy of the resulting key.</p>
<p>By my estimate, generating a 2048-bit RSA modulus with a new pseudo-random candidate for each trial would consume on average of more than 350 kbits (versus 2 kbits for the increment-and-test approach).  I suppose it boils down to how good one presumes the source to be.  For me, that entropy is best at first and may diminish with repeated draws seems the more conservative assumption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175241">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175241">
						February 18, 2012 6:45 PM					</a>

				</p>

				<p>@MarkH</p>
<p>Okay, let me elaborate. We are searching for a prime in a given interval. Method A is to generate random numbers repeatedly until the primality test passes. Method B is to generate one random number, then increment it repeatedly until the primality test passes. We assume the random number generator&#8217;s output is uniformly distributed in the given interval.</p>
<p>With Method A, the probability of picking a particular prime is the same for every prime in the interval, namely the reciprocal of the number of primes in the interval.</p>
<p>With Method B, the probability of picking a particular prime is <i>not</i> the same for every prime in the interval. In this case, the probability of picking a prime p is the length of the gap between p and the previous prime, divided by the length of the whole interval. But because the gaps between successive primes are not all the same, Method B picks some primes with higher probability than others. This makes it slightly more likely that two runs of Method B will pick the same (higher-probability) prime, compared to Method A.</p>
<p>It makes no sense to use a true random entropy source to pick security parameters, such as RSA primes, with biased probabilities. Instead, use a true random entropy source to seed a cryptographically strong random number generator. Then use the generator with Method A to pick RSA primes. That way, you don&#8217;t have to consume &#8220;valuable&#8221; entropy from the entropy source each time you generate a random number.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175242">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175242">
						February 18, 2012 10:43 PM					</a>

				</p>

				<p>@Alan Kaminsky:</p>
<p>&#8220;It makes no sense to use a true random entropy source to pick security parameters, such as RSA primes, with biased probabilities. Instead, use a true random entropy source to seed a cryptographically strong random number generator.&#8221;</p>
<p>I agree fully with the logic of that &#8212; if the generator is unbreakable, and there is no risk that seed might be otherwise compromised, then a seed should be usable indefinitely.</p>
<p>The objection to Method B is interesting, and for me a novel one.  In a brute force (trial division) attack on an RSA modulus, it would be advantageous (if Method B were suspected) to first test &#8220;long primes&#8221; (those following longer gaps) before short primes.</p>
<p>I examined an interval of small (non-cryptographic) primes (the 50th million of primes), and found that about half the primes expected from Method B would come from the &#8220;longest&#8221; 20 percent of primes in the interval.  Now, I don&#8217;t know to what extent the distribution I saw applies to cryptographic-size primes, but if it did, I reckon a 2.5 times speed-up of the trial division attack, equivalent to a reduction of the modulus length by 3 bits.</p>
<p>Of course, noone has suggested that such a bias toward long primes might lead to any useful attack against a particular RSA modulus.</p>
<p>But could Method B bias account, to any extent, for the repetition of primes observed in the referenced research?</p>
<p>Suppose the distribution of prime gaps had such an extreme bias, that half of Method B primes came from only one millionth of the primes in the interval from which factors of an RSA modulus are drawn*.  1024-bit moduli are typically composed by finding primes whose representation requires 512 bits, of which there are about 2 x 10^151.  The assumed severe &#8220;Method B Bias&#8221; would, accordingly, frequently draw primes from a population of, say, 10^145.</p>
<p>Applying the famous &#8220;birthday&#8221; approximation yields an estimate of more than 10^70 1024-bit RSA moduli that must be computed (under this extreme assumption of Method B bias) before the probability of a duplicated factor approaches 1/2 between any pair in this superastronomical population.</p>
<p>Those who suggest Method B as an algorithm for finding primes, sometimes also suggest setting a limit on the number of increment-and-test cycles before selection of a new pseudo-random odd.  This is based on considerations of speed rather than security, because prime gaps are sometimes very large.  However, applying this modification would reduce the Method B bias toward &#8220;long&#8221; primes.</p>
<hr />
<p>*Formulae believed to well approximate both the density of primes, and the maximal gap between primes, suggest that the maximal gap is about ln(N) times the mean gap, where N is the upper bound the interval.  For 1024-bit RSA moduli, this indicates a crude upper bound for Method B bias more like 100 than 1,000,000.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175243">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175243">
						February 20, 2012 12:23 AM					</a>

				</p>

				<p>Someone is having difficulty with a TRNG, I can&#8217;t imagine why&#8230;.All you need is a simple circuit with PSRR (power supply reject ratio) of greater than 150dB and absolutely no DC or AC bias.</p>
<p>Unfortunately most methods for removing a DC bias create a signal bias, or a &#8220;Tone&#8221; as it is called in the Audio Sigma Delta world.</p>
<p>Also the RNG should be super fast, because I need to throw away lots of results that fail some test of randomness (???) or Key strength / suitability.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175244">

			<div class="comment by-oracle ">

				<p class="commentcredit">

					<span class="commenter">Oracle</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175244">
						February 20, 2012 7:13 AM					</a>

				</p>

				<p>Another fun aspect of the proprietary-ness of Fortuna that I did not think earlier, but ties nicely to this article:</p>
<p>Let&#8217;s say I want to implement Fortuna &#8211; with some effort, I can get access to the book, one way or another.</p>
<p>Let&#8217;s say I want to implement CSPRNG &#8211; probably I will skip Fortuna, because it&#8217;s not publically available.</p>
<p>But now the interesting scenario &#8211; somebody else has implementation called &#8220;Fortuna&#8221;, and I need to evaluate whether it works and has not been weakened somehow &#8211; intentionally or not.  Seems I&#8217;m out of luck then&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175245">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175245">
						February 20, 2012 8:46 AM					</a>

				</p>

				<p>@Oracle:</p>
<p>The world has changed!  &#8220;Proprietary&#8221; used to refer to technology for which was secret, and/or for which some kind of license was required.</p>
<p>Apparently, the term has been redefined:  &#8220;proprietary&#8221; is now any technology for which I need to pay more than $0.00, and/or requires that I move my bottom from my chair.</p>
<p>Bruce&#8217;s &#8220;Practical Cryptography&#8221; can be got used from Amazon for less than $16.</p>
<p>I&#8217;m old enough to remember making trips to the library, in order to learn cool and useful stuff.</p>
<p>Sincerely,</p>
<p>A. Fossil</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175246">

			<div class="comment by-damon ">

				<p class="commentcredit">

					<span class="commenter">Damon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175246">
						February 20, 2012 2:42 PM					</a>

				</p>

				<p>apropos Dilbert comic:</p>
<p><a href="http://dilbert.com/strips/comic/2001-10-25/" rel="nofollow ugc">http://dilbert.com/strips/comic/2001-10-25/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175247">

			<div class="comment by-gilbert-midonnet ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://glmdesigns.blogspot.com' rel='external nofollow ugc' class='url'>Gilbert Midonnet</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175247">
						February 20, 2012 6:54 PM					</a>

				</p>

				<p>@ A. Fossil,</p>
<p>Amen to that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175248">

			<div class="comment by-carson ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.wistly.net' rel='external nofollow ugc' class='url'>Carson</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175248">
						February 22, 2012 4:05 PM					</a>

				</p>

				<p>@A. Fossil: In some places, it&#8217;s even worse than that; in at least one US state, &#8220;proprietary software&#8221; legally means pretty much any software that&#8217;s covered by a license of any sort.  Which sort of makes it meaningless, I think.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175249">

			<div class="comment by-_arthur ">

				<p class="commentcredit">

					<span class="commenter">_Arthur</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175249">
						February 23, 2012 10:42 AM					</a>

				</p>

				<p>Kaminsky is correct.<br />
To &#8220;generate&#8221; the prime number necessary for encryption, you start at a &#8220;random&#8221; point within a specific range, say, 200-digits numbers.<br />
You then test the candidates for primality, <em>sequentially</em>.<br />
If the range where you search for big prime numbers is too narrow (it is highly likely that everyone uses the same range), or the random number used for your &#8220;random&#8221; start point is weak, it becomes increasingly likely that you will end up picking the same prime number than someone else.  Everyone is using the exact same primality test, after all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175250">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175250">
						February 23, 2012 2:44 PM					</a>

				</p>

				<p>@ _Arthur,</p>
<p><i>Everyone is using the exact same primality test, after all</i></p>
<p>Err no they are not&#8230;</p>
<p>In the not so distant past, asside from the &#8220;Brut Force&#8221; method, there was not a diffinitive test for primality in very large primes, just a probabilistic test, which had the advantage of being very quick.</p>
<p>Then three graduate level students in India came up with a diffinitive test, which whilst not quite as quick as the probabilistic method was &#8220;none to shabby&#8221;.</p>
<p>There are also other ways of finding primes more quickly than sequential search from a random point.</p>
<p>One of which is based on the simple knowledge that the two numbers either side of multiplying the sequence of primes (including 2) has a better than average chance of being &#8220;twin primes&#8221; (2x3x5=30, 29/31). Also contrary to what is often said primes do have a fairly regular pattern because they effectivly &#8220;reflect&#8221; around these points and each sub-multiple down towards the next lowest point.</p>
<p>To see this think about each prime being the fundemental of a harmonic generator, each harmonic strikes out all it&#8217;s harmonics from further consideration, this is the basis for the sieve method. Now write out all the numbers from 0 to 60 and underline those that are prime. Now examin the pattern either side of 30 notice any similarities around the point, how about 60-90, 90-120, etc?</p>
<p>Thus if you were lazy you could encode the ofsets from a suitably high reflection point and the first couple of hundred primes. Ask how long a prime the user wanted find the nearest reflection point and use the offsets to give you a much greater chance of finding two primes very quickly.</p>
<p>Oh these reflection point twin primes have one prime with the two Least Significant Bits being both 1, the other 01, which means that the result of multiplying them is 3 mod 4. However as waluable as this may appear to be I would not use them ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175251">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175251">
						February 25, 2012 12:04 PM					</a>

				</p>

				<p>@_Arthur:</p>
<p>[1] If &#8220;the random number used for your &#8216;random&#8217; start point is weak&#8230;&#8221;</p>
<p>I take &#8220;weak&#8221; to mean here, that the number is to any significant extent predictable to an adversary.  In such case, the resulting key is insecure, no matter how else the rest of the procedure is done.  The initial &#8220;guess&#8221; must be unpredictable, or it&#8217;s game over.</p>
<p>[2] &#8220;&#8230;it becomes increasingly likely that you will end up picking the same prime number than someone else&#8221;</p>
<p>Yes &#8212; but all the same, very very very unlikely indeed.  Typically, 1024 bit keys are based on randomly chosen 512 bit primes.  The &#8220;narrow range&#8221; of 512 bit integers contains (if I did my calculation correctly) about 2 x 10^151 primes.</p>
<p>If (say) one trillion trillion (that is, 10^24) such keys were generated, the probability that there would be even a single duplicated factor among ALL of them, is less than 10^-100.</p>
<p>[3] &#8220;Everyone is using the exact same primality test, after all.&#8221;</p>
<p>No.  There are three well-known tests for pseudoprimality (that can tell whether a number if probably prime), and two practical tests for primality (that can prove a prime to be so), which might be used in real-world cryptosystems.  Most of these tests have parameters that must be chosen by the designers, and so may exist in numerous variants.  Also, two of the pseudoprime tests require &#8220;random&#8221; numbers, and so might never run the same way twice.</p>
<p>When RSA keys are based on pseudoprimality testing, there is a risk that a modulus factor will be composite, which of course results in an insecure key.  The system designer can choose the test parameters to set the probability of this disaster to a level that is judged to be acceptable.  However, aside from this risk, the test chosen doesn&#8217;t affect the probability of duplicated factors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-175252">

			<div class="comment by-mario ">

				<p class="commentcredit">

					<span class="commenter">Mario</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175252">
						March 22, 2012 11:43 PM					</a>

				</p>

				<p>Hi !</p>
<p>Although I am bit late for this discussion, I do not understand why all this enornmous intellectual strain to figure out new PRNGs when a even a lousy hardware generator would give each bit its own piece of entropy ? It is true that hrng bits will be somewhat correlated and somewhat biased (without postprocessing which is not a good idea) but it is still infinitely better than a handfull of perfectly correlated bits produced deterministically by any prng.</p>
<p>It is sad that peolpe are spending so much time and research effort on futile topic especially for crypto purposes where speed and perfect de-biasness are of no importance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-175253">

			<div class="comment by-truong ">

				<p class="commentcredit">

					<span class="commenter">Truong</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/#comment-175253">
						May 26, 2012 5:30 AM					</a>

				</p>

				<p>RSA weakness. duplicate publickey. What is the odds of that in practive. too small.</p>
<p>So just keep using RSA.</p>
<p>I am wondering that is there any way to improve to create primes . I mean there is no duplicate of public key left.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/02/lousy_random_nu.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F02%2Flousy_random_nu.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/02/lousy_random_nu.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4232' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/02/dumb_risk_of_th.html" rel="prev">â† Dumb Risk of the Day</a>		<a href="https://www.schneier.com/blog/archives/2012/02/cryptanalysis_o_3.html" rel="next">Cryptanalysis of Satellite Phone Encryption Algorithms â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
