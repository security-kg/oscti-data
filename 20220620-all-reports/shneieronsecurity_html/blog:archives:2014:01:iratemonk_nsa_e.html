<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>IRATEMONK: NSA Exploit of the Day - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; IRATEMONK: NSA Exploit of the Day Comments Feed" href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5203" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5203' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Firatemonk_nsa_e.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Firatemonk_nsa_e.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5203 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5203" class="post-5203 post type-post status-publish format-standard hentry category-uncategorized tag-exploit-of-the-day tag-implants tag-nsa tag-privacy tag-rootkits tag-surveillance">

	<div class="article">

		<h2 class="entry">IRATEMONK: NSA Exploit of the Day</h2>
		<p>Today&#8217;s item from the NSA&#8217;s Tailored Access Operations (TAO) group <a href="http://leaksource.wordpress.com/2013/12/30/nsas-ant-division-catalog-of-exploits-for-nearly-every-major-software-hardware-firmware/">implant catalog</a>:</p>
<blockquote><p><b>IRATEMONK</b></p>
<p>(TS//SI//REL) IRATEMONK provides software application persistence on desktop and laptop computers by implanting in the hard drive firmware to gain execution through Master Boot Record (MBR) substitution.</p>
<p>(TS//SI//REL) This technique supports systems without RAID hardware that boot from a variety of Western Digital, Seagate, Maxtor, and Samsung hard drives. The supported file systems are: FAT, NTFS, EXT3 and UFS.</p>
<p>(TS//SI//REL) Through remote access or interdiction, UNITEDRAKE, or STRAITBAZZARE are used with SLICKERVICAR to upload the hard drive firmware onto the target machine to implant IRATEMONK and its payload (the implant installer).l Once implanted, IRATEMONK&#8217;s frequency of execution (dropping the payload) is configurable and will occur when the target machine powers on.</p>
<p>Status: Released / Deployed. Ready for Immediate Delivery</p>
<p>Unit Cost: $0</p></blockquote>
<p>Page, with graphics, is <a href="http://leaksource.files.wordpress.com/2013/12/nsa-ant-iratemonk.jpg">here</a>. General information about TAO and the catalog is <a href="https://www.schneier.com/blog/archives/2013/12/more_about_the.html">here</a>.</p>
<p>In the comments, feel free to discuss how the exploit works, how we might detect it, how it has probably been improved since the catalog entry in 2008, and so on.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/exploit-of-the-day/" rel="tag">exploit of the day</a>, <a href="https://www.schneier.com/tag/implants/" rel="tag">implants</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/privacy/" rel="tag">privacy</a>, <a href="https://www.schneier.com/tag/rootkits/" rel="tag">rootkits</a>, <a href="https://www.schneier.com/tag/surveillance/" rel="tag">surveillance</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html" rel="bookmark">Posted on January 31, 2014 at 2:17 PM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html#comments">58 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html" data-title="IRATEMONK: NSA Exploit of the Day" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-215356">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215356">
						January 31, 2014 2:31 PM					</a>

				</p>

				<p>Your link is broken (there is a missing quote in the HTML&#8230; or an extra one, depending on how you look at it.)</p>
<p><a href="http://leaksource.files.wordpress.com/2013/12/nsa-ant-iratemonk.jpg" rel="nofollow ugc">http://leaksource.files.wordpress.com/2013/12/nsa-ant-iratemonk.jpg</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215357">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215357">
						January 31, 2014 2:53 PM					</a>

				</p>

				<p>This is probably the most interesting of the BIOS-type implants.  The idea:</p>
<p>Rather than recording your Master Boot Record (MBR) malcode on the disk, you record it in the firmware of the drive itself.  That way, if someone tries to examine the MBR after the system boots up, they will never be able to find it because the firmware only presents the &#8220;bad&#8221; MBR when the system does a cold boot or other similar condition, any attempt to read the MBR is useless.</p>
<p>Thus it is useful in hiding the MBR malcode from a &#8220;boot from CD&#8221; detector, where the system is booted from a CD/USB and the MBR examined once the CD has booted up.</p>
<p>At the same time, however, it does show the NSA&#8217;s strange emphasis on persistence.</p>
<p>The disk itself can&#8217;t tell the difference between a cold boot and the case where the disk is removed and its being remotely examined, yet the cost of evading the &#8220;boot from CD&#8221; detection is now you have guaranteed &#8220;NSA WAS HERE&#8221; writ in big glowing letters if it ever IS detected.</p>
<p>Instead, in the wild, it would probably make sense not even to sabotage the MBR, but just to implant some malcode into the Windows kernel and, hey, if it gets noticed, how do you tell the difference from all the other malcode out there?</p>
<p>Or, in many cases, just make the malcode memory-resident only: yeah it won&#8217;t survive across reboots, but it can be very <i>very</i> hard to detect, let alone capture, if it only exists in kernel memory.  And when was the last time you reset your servers, laptop, or dekstop?</p>
<p>Yet in all the slides from the ANT catalog and elsewhere, even the QUANTUMNATION mass-attack stuff (the SILKMOTH malcode/implant, which self destructs after 30 days), it all seems persistent, needlessly so.  As a result, the NSA has to work a lot harder at evading detection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215359">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215359">
						January 31, 2014 3:14 PM					</a>

				</p>

				<p>Do they really need to worry about detection if the device is ultimately going to be hit with a drone strike?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215360">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215360">
						January 31, 2014 3:58 PM					</a>

				</p>

				<p>@ Mark</p>
<p>There&#8217;s a guarantee of no forensic recovery after a drone strike? That&#8217;s news to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215361">

			<div class="comment by-adjuvant ">

				<p class="commentcredit">

					<span class="commenter">Adjuvant</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215361">
						January 31, 2014 4:07 PM					</a>

				</p>

				<p>Obligatory link to the HD microcontroller hack by Jeroen Domburg, because if I don&#8217;t post it someone else will have to:<br />
<a href="http://spritesmods.com/?art=hddhack&#038;page=1" rel="nofollow ugc">http://spritesmods.com/?art=hddhack&#038;page=1</a></p>
<p>Also the obligatory quote from the comments there: &#8220;Brings a whole new meaning to &#8216;I installed Linux on my hard drive&#8217;&#8230;&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215362">

			<div class="comment by-copper ">

				<p class="commentcredit">

					<span class="commenter">Copper</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215362">
						January 31, 2014 4:38 PM					</a>

				</p>

				<p>And what happens, if a user doesn&#8217;t have a MBR on the disk, but instead boots from an external USB stick?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215363">

			<div class="comment by-valdis-kletnieks ">

				<p class="commentcredit">

					<span class="commenter">Valdis Kletnieks</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215363">
						January 31, 2014 4:43 PM					</a>

				</p>

				<p>@copper: It&#8217;s a safe bet to take.  How many people boot from an external USB stick <em>as their normal boot procedure</em>?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215364">

			<div class="comment by-f3nkjf3nkjf ">

				<p class="commentcredit">

					<span class="commenter">f3nkjf3nkjf</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215364">
						January 31, 2014 4:50 PM					</a>

				</p>

				<p>No way they reversed engineered all the controller firmware for all these vendors. I know they could, but think of the economics. It&#8217;s extremely likely they just payed vendor providers for collaboration or ready solutions..</p>
<p>By the way this is probably the most profitable backdoor I&#8217;ve seen out of the NSA tools posted.. If malware authors got the source or binaries for this you&#8217;d see it going through a lot of exploit kits, email campaigns, and botnet PPI..</p>
<p>Still, this stuff seems like outdated tech. NSA has probably saturated the field with the stuff posted thus far, so it doesn&#8217;t eliminate the likelyhood this is some form of PSYOPS.. Declassifying old information for some CIA&amp;NSA campaign..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215365">

			<div class="comment by-carpe ">

				<p class="commentcredit">

					<span class="commenter">Carpe</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215365">
						January 31, 2014 4:53 PM					</a>

				</p>

				<p>The last time I got hit with anything (about a year ago one a windows laptop of course) it was an MBR rootkit. Luckily I caught it right away (yay for checksums), but mbr rootkits are very interesting. This though, seems to be an actual hdd firmware level rootkit that then payloads the mbr, which is one of those &#8220;why didn&#8217;t I think of that?&#8221; sort of things. I wonder if they have it for GPT now too?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215366">

			<div class="comment by-bronx ">

				<p class="commentcredit">

					<span class="commenter">Bronx</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215366">
						January 31, 2014 5:18 PM					</a>

				</p>

				<p>If only anti-virus companies would start scanning firmware&#8230;</p>
<p>you would think they would include this technology especially in light of these disclosures&#8230;</p>
<p>but something smells&#8230; probably cooperation with TLAs which prevents this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215367">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215367">
						January 31, 2014 6:16 PM					</a>

				</p>

				<p>Maybe I&#8217;m not up to date, but what are these:<br />
UNITEDRAKE, STRAITBAZZARE, SLICKERVICAR what are they doing exactly?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215368">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215368">
						January 31, 2014 7:10 PM					</a>

				</p>

				<p>@Bronx</p>
<p>Antivirus only works for widespread, generic malware. If you are being specifically targeted, it&#8217;s about as useful as something that isn&#8217;t useful at all. To protect against firmware, bios, or kernel malware, there needs to be code specifically in place to prevent anything from modifying them without your knowledge in the first place. If the attacker has physical access to your machine, which the NSA does in many cases, then that&#8217;s especially difficult to protect against.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215369">

			<div class="comment by-3jh34fhb3jh ">

				<p class="commentcredit">

					<span class="commenter">3jh34fhb3jh</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215369">
						January 31, 2014 7:28 PM					</a>

				</p>

				<p>@Anura: This is inaccurate and a common poor assumption in the software and security industry. It&#8217;s trivial to hook service handlers and mapping functions, even just using ring3, and create a impenetrable MAC HIPS, then supplement it with behavioral analyses that doesn&#8217;t use idiotic run-time trace-analyses or static analyses of binaries. For secure-install on an unsecure box just do offline breach-loading.</p>
<p>That&#8217;s actually cheaper than current development practices by vendors, which basically patch all NDIS, watchdog kernel timers,  and process creation to support firewall rules and signatures engines..</p>
<p>There will always be subscription based products because it&#8217;s not profitable to charge a single license cost for something that needs long term support..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215370">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215370">
						January 31, 2014 8:29 PM					</a>

				</p>

				<p>Please do remember the USB FLASH memory stick exploits talked about a couple moths ago.  All FLASH drives use a controller to handle internal functions.  They also have extra blocks that they can erase in the background so they are ready for use for the next write.  It would be no problem for the controller firmware to be replaced, store hidden files on some of these extra blocks, then serve up them up as exploit code much like this does.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215371">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215371">
						January 31, 2014 9:37 PM					</a>

				</p>

				<p>@ 3jh34</p>
<p>&#8220;This is inaccurate and a common poor assumption in the software and security industry. It&#8217;s trivial to hook service handlers and mapping functions, even just using ring3, and create a impenetrable MAC HIPS, then supplement it with behavioral analyses that doesn&#8217;t use idiotic run-time trace-analyses or static analyses of binaries.&#8221;</p>
<p>That inaccurate itself. There&#8217;s nothing trivial about protecting untrusted code from other untrusted code with code on untrusted hardware. Your system would be defeated by numerous items in the NSA catalog, kernel mode vulnerabilities, device related attacks, etc.</p>
<p>There <em>are</em> simple methods for stopping a huge variety of code injection attacks by design, such as control flow integrity. Several could be combined to greatly increase the security of a system without huge security engineering budget.</p>
<p>My old meme: &#8220;Tried and true is usually better than novel and new.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215372">

			<div class="comment by-buck ">

				<p class="commentcredit">

					<span class="commenter">Buck</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215372">
						January 31, 2014 9:43 PM					</a>

				</p>

				<p>Memory-resident only malcode would certainly have their perks! ðŸ˜‰<br />
Plenty of leaner, more specific, and persistent hooks for loading the real payloads&#8230;<br />
Plus, covering your ass only requires a simple forced reboot/memory-wipe!<br />
It would really be a shame if the whole network stack is vulnerable all the way up from the physical layer&#8230; :-\</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215373">

			<div class="comment by-47 ">

				<p class="commentcredit">

					<span class="commenter">47</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215373">
						January 31, 2014 9:53 PM					</a>

				</p>

				<p>&#8220;All FLASH drives use a controller to handle internal functions.&#8221;</p>
<p>What is the mode(s) of detection for such malware?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215374">

			<div class="comment by-3jh34fhb3jh ">

				<p class="commentcredit">

					<span class="commenter">3jh34fhb3jh</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215374">
						January 31, 2014 10:46 PM					</a>

				</p>

				<p>@Nick P: Not really.. How would any ROM write into encrypted page tables with write-back hashing and a CPU encryption oracle to protect keys that protect a encrypted chain of trust from untrusted execution? If you properly do a PKI or eliptic curve based ROM loader to implement chain of trust it enforces the model and any type of corruption through overflows and glitching naturally fail to yield leverage even if they get past something like DLPAR and directly manipulated low level MMU stuff..</p>
<p>With software security there are already interfaces like kernel allocation handlers, ring 3 service and mapping handlers, and NDIS(NT) for networking. These are all that&#8217;s needed for my suggested solution.. It&#8217;s just not profitable to produce a single licensed solution and market and support it long term, so you have signature subscriptions. A lot of suite type anti-virus solution already use these interfaces the just don&#8217;t implement MAC based HIPS even on highest settings.</p>
<p>Again, there is a lot of misinformation when it comes to this. My method naturally defeats any attempt to map unsigned code even through sophisticated DMA and cache payloads and direct-bus RAM glitching..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215375">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215375">
						January 31, 2014 11:15 PM					</a>

				</p>

				<p>@Nicholas Weaver:<br />
&#8220;At the same time, however, it does show the NSA&#8217;s strange emphasis on persistence.&#8221;</p>
<p>It&#8217;s not particularly strange. All of these TAO tools that Bruce has been showcasing lately, are clearly not for mass surveillance, but are designed for targeted penetration of well-protected, sophisticated opponents. People like the Syrian regime, say.</p>
<p>Getting the exploit in place in the first place probably risks somebody being tortured and killed. So it is definitely worth considerable effort to avoid having to <i>re-install</i> it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215377">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215377">
						January 31, 2014 11:28 PM					</a>

				</p>

				<p>@f3nkjf3nkjf:<br />
&#8220;No way they reversed engineered all the controller firmware for all these vendors. I know they could, but think of the economics. It&#8217;s extremely likely they just payed vendor providers for collaboration or ready solutions..&#8221;</p>
<p>Wrong, for two reasons. Firstly, it is clear from the TAO catalogue that reverse-engineering firmware is pretty much the full time job for these guys. It&#8217;s what they do: they have a bunch of engineers sitting in a well-supplied lab*, full of hardware samples from all over the world, and they sit there hacking on one thing after another, day in day out for at least the last decade if not longer.</p>
<p>Secondly, they don&#8217;t need to reverse engineer controller firmware &#8220;from all these vendors&#8221;, because most HDD manufacturers (mostly) don&#8217;t make or program the controllers, they buy them from a relatively small number of specialist HDD controller companies. The top 3 HD controller companies account for well over 90% of HDDs.</p>
<hr />
<ul>
<li>Actually, from the several flavours of product lines in the catalogue, it&#8217;s more likely half a dozen labs, each with its own dedicated engineering team.</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215378">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215378">
						February 1, 2014 12:15 AM					</a>

				</p>

				<p>@f3nkjf3nkjf:</p>
<p>As Roger has just said, the problem is easier than you think because the semiconductor market for Controller parts only has 3 or 4 vendors that supply Controllers for 99% the HDD makers.  Although the parts may be &#8220;customized&#8221; for each HDD vendor they will be based around the same core functionality and use the same Linux like OS&#8217;s typically running on either Mip&#8217;s or ARM cores. The actual firmware will be VERY similar especially in areas like Firmware update protection methods.</p>
<p>Clearly the TAO is well aware of how pathetic on-chip firmware protection really is because they do seem to target it regularly.</p>
<p>It is rather sad because some of us have been banging on about On-chip firmware vulnerability for years, but by the look of it the only one listening was the NSA. I&#8217;ve heard some recent rumors that our friends on Datong Lu have also been taking a very close look at on-chip firmware persistence for their own malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215379">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215379">
						February 1, 2014 1:51 AM					</a>

				</p>

				<p>@ 3jh34</p>
<p>So this discussion went from your original Mandatory Access Control-based HIPS with behavioral analysis to one of the CPU designs I linked to before with memory encryption and authentication. That&#8217;s progress for your scheme at least. Combining those two might accomplish something. You still need to worry about the effect of malicious input on trusted software but a number of other worries are eliminated [1].</p>
<p>[1] Maybe: Despite my liking cleverly cryptoed CPU&#8217;s, we haven&#8217;t seen them pen tested by bright black hats. There might be attacks we don&#8217;t know about yet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215380">

			<div class="comment by-aurelien ">

				<p class="commentcredit">

					<span class="commenter">AurÃ©lien</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215380">
						February 1, 2014 2:07 AM					</a>

				</p>

				<p>We had a paper at ACSAC similar to what spritemods describes:</p>
<p>Implementation and Implications of a Stealth Hard-Drive Backdoor</p>
<p><a href="http://www.acsac.org/2013/openconf/modules/request.php?module=oc_program&#038;action=summary.php&#038;id=78" rel="nofollow ugc">http://www.acsac.org/2013/openconf/modules/request.php?module=oc_program&#038;action=summary.php&#038;id=78</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215381">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215381">
						February 1, 2014 3:34 AM					</a>

				</p>

				<p>@ Roger</p>
<blockquote><p>
  All of these TAO tools that Bruce has been showcasing lately,<br />
  are clearly not for mass surveillance, but are designed for<br />
  targeted penetration of well-protected, sophisticated opponents.
</p></blockquote>
<p>Well, I don&#8217;t know about that, the persistent router vulnerabilities seem to me to be more applicable to mass surveillance (as in, all the customers of a particular ISP).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215382">

			<div class="comment by-dave-walker ">

				<p class="commentcredit">

					<span class="commenter">Dave Walker</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215382">
						February 1, 2014 5:11 AM					</a>

				</p>

				<p>Noting that the TAO catalogue as leaked isn&#8217;t exactly recent, a further interesting question to ask is how likely it is that more current filesystems (such as ZFS) are similarly nobbled, today. My guess is that it wouldn&#8217;t be too hard to do, given what the exploit already does.</p>
<p>A very important thing to verify, is whether a TPM measured boot catches this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215383">

			<div class="comment by-benni ">

				<p class="commentcredit">

					<span class="commenter">Benni</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215383">
						February 1, 2014 6:32 AM					</a>

				</p>

				<p>@Roger:<br />
&#8220;Getting the exploit in place in the first place probably risks somebody being tortured and killed. So it is definitely worth considerable effort to avoid having to re-install it.&#8221;</p>
<p>Now thats a fun one.</p>
<p>Actually, NSA has targeted engineers of telecomunication companies to get a grip into the GSM network.</p>
<p>Those router implants are also not designed for some evil terrorists in somalia.</p>
<p>NSA targets companies with these implants. with the data from these implants, they then hack into the internal networks, and can spy on everyone. These implants here are just the keys for opening the door to their mass surveillance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215384">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215384">
						February 1, 2014 9:47 AM					</a>

				</p>

				<p>@ Nick P<br />
<i>Despite my liking cleverly cryptoed CPU&#8217;s, we haven&#8217;t seen them<br />
pen tested by bright black hats. There might be attacks we don&#8217;t know about yet.</i></p>
<p>Mentioned before that I had a IBM ThinkPAD with a cryptographic BSP management module. It may have been the complexity at the time relative to experience. The challenge you&#8217;ve thrown down is interesting, being a gray hat I might think about it. Let me define &#8220;gray hat&#8221; so there&#8217;s no confusion&#8230;</p>
<p>Gray_Hat = (White_Hat &#8211; Black_Hat) = (Black_Hat + White_Hat)<br />
Being versed in the dark arts, not for nefarious or criminal purposes, it comes from the days as a hobbyist back in the early 70&#8217;s. Black hats don&#8217;t like me, I tend to out methods and processes used to gain advantage. White hats don&#8217;t like me, make them look foolish and stupid and in some way my methods put fear in their hearts. So, as a gray hat&#8211;stuff sucks.</p>
<p>As there is a plethora of ideas and suggests, there seems to be any effective method of providing the broad social trust/integrity that will be necessary in the near future as those less knowledgeable begin to understand the lay of the land&#8211;they just don&#8217;t know how screwed they are.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215385">

			<div class="comment by-dave-m ">

				<p class="commentcredit">

					<span class="commenter">Dave M</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215385">
						February 1, 2014 9:56 AM					</a>

				</p>

				<p>I assume we can&#8217;t get the HDD manufacturers to publish their code binaries so concerned and paranoid people can verify them.  Do you think it would be possible to at least get them to publish firmware signatures, and tell us how they calculated them?  JTAG could maybe work&#8230; <a href="http://spritesmods.com/?art=hddhack&amp;page=3" rel="nofollow ugc">Hard disk hacking &#8211; Hooking up JTAG</a></p>
<p>Who is to say that some or all of the manufacturers are not now including code that allows remote activation of this kind of exploit for new drives via, say, an undocumented SATA command?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215386">

			<div class="comment by-pointless_hack ">

				<p class="commentcredit">

					<span class="commenter">pointless_hack</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215386">
						February 1, 2014 10:33 AM					</a>

				</p>

				<p>NSA seems to have gotten a little giddy with the naming convention. It implies a lack of discipline, and a kind-of a frat house atmosphere of irresponsibility.</p>
<p>I&#8217;m worried our Open Source IRC will become a pedestal for technically arcane flame wars, in a mud slinging reaction to it.</p>
<p>&#8220;Truth is the first casualty of war.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215387">

			<div class="comment by-frabj ">

				<p class="commentcredit">

					<span class="commenter">Frabj</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215387">
						February 1, 2014 10:39 AM					</a>

				</p>

				<p>It is pretty much certain that all manufactures allow this kind of &#8220;activation&#8221; via SATA commands. The same commands that allow them to fix buggy firmware in the field can be used for this. There will be commands to access whatever flash is in the controller, plus reading/writing blocks in the secure manufacturer area.</p>
<p>It would be interesting if the SATA command spec had documented commands for getting access to a hash (SHA-1, say) of the firmware. At least that way users could defend themselves by publishing the hashes they see, and comparing to hashes of other identical drives.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215388">

			<div class="comment by-dave-m ">

				<p class="commentcredit">

					<span class="commenter">Dave M</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215388">
						February 1, 2014 11:08 AM					</a>

				</p>

				<p>Yes, I now see that there are SATA commands to read/write drive firmware.  But can you believe what the drive reports back?  If only a small part of the exploit firmware image is different then it wouldn&#8217;t take much room to make it invisible from the SATA level.  Would be even easier to have the exploit firmware report the &#8220;correct&#8221; firmware signature.  The JTAG approach (almost certainly available on all newer drives) would allow real hardware access to the drive firmware for verification.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215389">

			<div class="comment by-3jh34fhb3jh ">

				<p class="commentcredit">

					<span class="commenter">3jh34fhb3jh</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215389">
						February 1, 2014 11:28 AM					</a>

				</p>

				<p>@Nick P: You said &#8220;There&#8217;s nothing trivial about protecting untrusted code from other untrusted code with code on untrusted hardware.&#8221;, so I responded..</p>
<p>I mentioned hardware reinforced environments that supplement things like DLPAR, but I also pointed out the pure software solution to a MAC HIPS has always been there. Most of it doesn&#8217;t even require a driver and is already being used by AV vendors for self-protect and firewalls. All researchers know about it too..</p>
<p>You seem set on playing down other peoples statements but incapable of any technical discussion.. Things like NT service handler API, NDIS, UEFI signing, allocation API that go up to NT mapping functions in ring 0 via IOCTL, aren&#8217;t near the fiction your statements imply.. Even where there isn&#8217;t UEFI signing, like on legacy x86 and PPC hardware, there are efficient cryptograpgics methods for kernel level allocation that defeat even DMA and disk firmware base MBR attacks..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215390">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215390">
						February 1, 2014 11:42 AM					</a>

				</p>

				<p>@ 3jh34fh</p>
<p>The recurring problem in your designs is that they&#8217;re based on Windows. The discussions are about the NSA attacks. The NSA has been compelling US companies to backdoor products or give source code for 0-day hunting. Windows has a history of both issues. All of your protections have merit in ensuring the code that runs is the shipped Windows system while making black hat&#8217;s job harder.</p>
<p>The problem is that the running system can still be subverted in this threat model as one must trust Microsoft, the board/BIOS vendor, and the chip vendor. These so far haven&#8217;t been trustworthy although its hard to say how much for each one. Windows is <em>definitely</em> not trustworthy against a TLA. So, a long technical discussion on all of your Windows anti-hacking techniques is irrelevant when the opponent can put bypasses directly into Windows or UEFI.</p>
<p>That said, you&#8217;ve mentioned many different tactics that a reader might find useful against regular black hats if they must use Windows for critical stuff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215391">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215391">
						February 1, 2014 11:54 AM					</a>

				</p>

				<p>@ name.withheld</p>
<p>&#8220;Mentioned before that I had a IBM ThinkPAD with a cryptographic BSP management module. It may have been the complexity at the time relative to experience. The challenge you&#8217;ve thrown down is interesting, being a gray hat I might think about it.&#8221;</p>
<p>I&#8217;d assume it&#8217;s a vulnerability until proven otherwise. Such is the record of onboard management devices. It was something I always applied high[er] assurance methods to due to all the risks it poses. Far as testing a given crypto technique, your talent would be better applied to something like SecureMe, CODESEAL or Air Force Lab&#8217;s HAVEN virtualization scheme. These are things we might be able to clone and use. Knowing their &#8220;actual&#8221; vs &#8220;projected&#8221; strength against attackers would require good hackers laying into them at every level.</p>
<p>If they pass muster, people can then put them to use.</p>
<p>&#8220;Being versed in the dark arts, not for nefarious or criminal purposes, it comes from the days as a hobbyist back in the early 70&#8217;s. Black hats don&#8217;t like me, I tend to out methods and processes used to gain advantage. White hats don&#8217;t like me, make them look foolish and stupid and in some way my methods put fear in their hearts. So, as a gray hat&#8211;stuff sucks.&#8221;</p>
<p>That&#8217;s funny as I get a similar reaction to them. If anything, black hats respect me a bit but don&#8217;t think my methods are &#8220;cool.&#8221; They&#8217;d rather use whatever crap they saw at DEFCON or what other black hats are using. The professionals are an exception: they&#8217;ll use the best tool for the job as their paycheck is on the line. Some don&#8217;t think I&#8217;m &#8220;dirty&#8221; enough as they can&#8217;t get me to tag along on their next criminal endeavor. Those won&#8217;t even talk to me but for a short time. (shrugs)</p>
<p>The white hats are a more interesting bunch. They have shown more interest in my security tech and designs, along with old papers/tech I bring up. They still suffer from being attracted to whatever fad is in fashion. However, they do try to use their skills to actively improve things. There&#8217;s hope for them.</p>
<p>My hands-on hacking skills are mostly gone. I&#8217;ve mostly worked on higher level designs and activities over the past years. I can still see plenty of problems at that level, simultaneously knowing strength of plenty solutions against various attackers. My main role is evangelist of high assurance tech who knows enough about the field to throw suggestions at hands-on guys until something sticks in their head. Then, they build the better tool and we all benefit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215392">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215392">
						February 1, 2014 1:49 PM					</a>

				</p>

				<p>@Nick P</p>
<blockquote><p><i>The problem is that the running system can still be subverted in this threat model as one must trust Microsoft, the board/BIOS vendor, and the chip vendor.</i></p></blockquote>
<p>The next question is how will the non-USofA governments deal with this issue?</p>
<p>I&#8217;m hoping that they put pressure on the chip manufacturers to open their systems so that they can develop their own means of validating/replacing the firmware. Or start building their own fabrication plants.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215393">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215393">
						February 1, 2014 2:40 PM					</a>

				</p>

				<p>I want NSA to name my software.  Surely they would pick a cool name that would really help with sales.</p>
<p>In a PR move they should have public auctions for various services and send the money to a charity.</p>
<p>Students could have a NSA person test the code they wrote.  I would even approve of that if they tested and only disclosed the right amount of information.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215394">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215394">
						February 1, 2014 3:30 PM					</a>

				</p>

				<p>@ name.withheld&#8230;, Nick P,</p>
<ul><i>Gray_Hat = (White_Hat &#8211; Black_Hat) = (Black_Hat + White_Hat) Being versed in the dark arts, not for nefarious or criminal purposes, it comes from the days as a hobbyist back in the early 70&#8217;s.</i></ul>
<p>Tsk Tsk you guys and &#8220;Fifty Shades of Grey&#8221;, you buoys need to follow the cardinal rule and get a bit more colour in your lives&#8230; Me I&#8217;ve got a nice Red&amp;Green striped bobble hat so you can&#8217;t tell if I&#8217;m going Right or Left [1]</p>
<p>On a more serious note, much of the modern attack vectors are not realy new, they are just variations on older ideas that go back into the late 1950&#8217;s through early 70&#8217;s. The &#8220;new kids on the block&#8221; just have not seen them befor and nobodies told them so &#8220;the wheel get&#8217;s re-invented with every turn&#8221;.</p>
<p>In some ways it highlights the poor training given to up and coming &#8220;security proffessionals&#8221; and it reflects the &#8220;code cutter&#8221; not &#8220;engineering&#8221; approach.</p>
<p>I&#8217;m realy not surprised that certain ex-NSA people shake their heads sadly when they look at the way the industry is going. We cann&#8217;t fix certain fundemental problems do rather than take a solid well tried and proven engineering approach, we go for layer upon layer of obsfication in the faux hope that people won&#8217;t work their way through it.</p>
<p>But&#8230; because of the multiple layers complexity goes up exponentialy and this has several consiquences. One of which is it gives focused attackers more vectors to play with. A second and much worse effect is that the code cutters are &#8220;all at sea&#8221; and put in place much &#8220;test code&#8221; that stays there. As I&#8217;ve said before the difference between a useful test harnes and a security evading backdoor, is only the use you put it to&#8230;</p>
<p>The simple fact is, that too many people won&#8217;t face the truth that there is no guarenty of security at any level, in fact the exact opposit, so any layer you add is in effect resting not on dependable bed rock but shifting sands. The more layers the more &#8220;top heavy&#8221; and thus unstable things become.</p>
<p>Engineers worked out solutions to these problems back in the 1940&#8217;s and 50&#8217;s just to build the first (thermionic valve/tube) computer systems with unreliable components, and then we appear to have forgoten them. The simple point is that the methods to solve unreliable hardware issues are transferable technology into the security field for untrusted hardware. Likewise methods for improving quality are transferable technology into the security field for design, manufacture and maintanence.</p>
<p>So yes I can see why those who have been around the blog a few times shake there heads sadly. It&#8217;s also the reason that old style hardware engineers along with those who have a good grounding in experimental research in the physicsl sciences tend to produce better quality software than many CS graduates who get tied up with the latest tools and don&#8217;t progress beyond being code cutters (and sadly that&#8217;s also what most managers want &#8220;artisanal code&#8221; not &#8220;engineered code&#8221; with a &#8220;solid scientific and mathmatical basis&#8221;.</p>
<p>[1] For those that don&#8217;t get the joke &#8220;sea&#8221;, <a href="http://www.trinityhouse.co.uk/lighthouses/buoys/cardinal.html" rel="nofollow ugc">http://www.trinityhouse.co.uk/lighthouses/buoys/cardinal.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215395">

			<div class="comment by-trx ">

				<p class="commentcredit">

					<span class="commenter">TRX</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215395">
						February 1, 2014 5:04 PM					</a>

				</p>

				<p>Now you know what the TSA is doing when they take your laptop into the other room&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215396">

			<div class="comment by-steven ">

				<p class="commentcredit">

					<span class="commenter">Steven</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215396">
						February 1, 2014 5:55 PM					</a>

				</p>

				<blockquote><p>The supported file systems are: FAT, NTFS, EXT3 and UFS.</p></blockquote>
<p>Probably supports ext4 by now. Sigh&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215397">

			<div class="comment by-3jh34fhb3jh ">

				<p class="commentcredit">

					<span class="commenter">3jh34fhb3jh</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215397">
						February 1, 2014 5:59 PM					</a>

				</p>

				<p>@Nick P: Name an OS that hasn&#8217;t had page tables, so my &#8220;recurring problem&#8221; as you say is more than just a lazy illogical argument meant to make me look like the person who doesn&#8217;t know the specifics..</p>
<p>Even CP/M and the first Linux kernel had page table allocation handling. You can use cryptographic methods on those as well to defeat nearly anything from DMA injection up to the most advanced ROP attacks.. I admit, there is no encryption oracle to protect keys there, but generating them at run-time with some entropy and RNG defeats any distributed attack using dumped keys. Use a stream cipher per private set within page tables to make RAM glitching to dump worthless..</p>
<p>Again, you&#8217;re unable to say how to defeat my proposed solution, only to repeatedly suggest I&#8217;m wrong based on absolutely nothing..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215398">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215398">
						February 1, 2014 7:38 PM					</a>

				</p>

				<p>@ 3jh34</p>
<p>I&#8217;m not sure if you read someone else&#8217;s post as I never said a thing about page tables. I said Windows-based systems were a no-go for anything supposed to resist a US domestic TLA. I also mentioned risk of them backdooring chip or firmware your scheme depends on [which is more likely on Wintel systems].</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215399">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215399">
						February 1, 2014 10:42 PM					</a>

				</p>

				<p>@ Brandioch Conner</p>
<p>&#8220;I&#8217;m hoping that they put pressure on the chip manufacturers to open their systems so that they can develop their own means of validating/replacing the firmware. Or start building their own fabrication plants.&#8221;</p>
<p>It will be interesting. We&#8217;ve explored the heck out of those issues on this blog. Chip fabrication is a complicated, black box process that&#8217;s unlikely to be compelled into doing anything transparent. The complexity of implementing chips at the cutting edge means that creating a chip design at that level might reduce risk of chip level subversion. Irony, eh?</p>
<p>So, what chip(s) to design. The strategy I see working is starting with a well-understood solution like Linux (or Linux API on microkernel) for the software. The board will be designed and vetted by many parties. The main SOC will use open components (eg opencores.com) whose source can be examined. One of the open firmware projects can be made to use this. Security features like TRNG, secure boot assist, memory protection via crypto, control flow integrity, etc. might be integrated early on into the SOC. Many will be delayed until the next phase/chip.</p>
<p>The point is using what&#8217;s readily available with limited additional engineering to get stuff with less risk of built-in subversion. I&#8217;d combine this with some supply chain security for the SOC&#8217;s and maybe manufacturing. Some security might happen at the fab level if several countries or big firms get together with a struggling fab that needs the cash. In any case, having chips well-understood design and with lower risk of pre-installed backdoors means most worries shift up a level or two in the stack.</p>
<p>Next step will be to deal with those. The governments and big spenders wanting to develop such a solution will need to involve someone with these traits:</p>
<ol>
<li>Understanding of security risks at every layer and use case of computing stacks.</li>
<li>Knowledge of high assurance security engineering methods rated to stop or hamper TLA level threats.</li>
<li>Experience dealing with real world issues of system or project implementation, particularly tradeoffs involving legacy systems.</li>
<li>Be highly unlikely to be working for US govt, either voluntarily or involuntarily.</li>
</ol>
<p>In other words, me and few other guys on this blog. ðŸ˜‰ More realistically, some local experts or defense contractors will be given the job with lots of cash while promising to stop foreign TLA&#8217;s &#8220;this time.&#8221; Their next step will be to make CPU&#8217;s which make secure/safe software easier to write. I already did a massive paper dump here [plus a supplement] that cover plenty of CPU&#8217;s and hardware techniques for accomplishing this. I also established the bare minimum properties the system design will require to be securable. They&#8217;ll need to produce at least one SOC like this.</p>
<p>Simultaneously, they should be increasing the modularity and assurance of their software stack. They need OS&#8217;s that are inherently safer from coding bugs, useful, fast, easy to modify, and probably free of subversion. Previously, I proposed SPIN and Wirth&#8217;s Modula/Oberon operating systems as a start as they meet all of these goals. There&#8217;s little to no reason to think any malice went into these systems&#8217; design. Worst case scenario for them will be accidental vulnerabilities in design/implementation which should be easier to correct given use of typesafe, modular, easily compiled implementation.</p>
<p>Eventually, the subversion resistant development processes, OS, libraries, chips, etc. will come together in a strong coupling with each layer or component complementing anothers&#8217; strengths. These systems will probably not be compatible with MS Office, etc. However, they will be ideally suited to be workhorse machines for corporations&#8217; or governments&#8217; security critical stuff. That I see, certain design choices could make the system work for embedded, desktop, thin client, and server offerings. The versatility gives it greater market penetration which feeds back into it over time for both features and pen testing.</p>
<p>So, this is one way to do it. I know (and linked to) quite a few qualified people working on technology aspects. There are also solutions on the market with more robust design than typical COTS for people that are willing to buy them. If that&#8217;s not enough, any well-funded organizations panicking and wanting to go through extra trouble to protect critical functions from diverse TLA threats know where to find me. ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215400">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215400">
						February 1, 2014 11:48 PM					</a>

				</p>

				<p>@ Nicolas W</p>
<p>â€œRather than recording your Master Boot Record (MBR) malcode on the disk, you record it in the firmware of the drive itself. That way, if someone tries to examine the MBR after the system boots up, they will never be able to find it because the firmware only presents the &#8220;bad&#8221; MBR when the system does a cold boot or other similar condition, any attempt to read the MBR is useless. â€¦it is useful in hiding the MBR malcode from a &#8220;boot from CD&#8221; detector, where the system is booted from a CD/USB and the MBR examined once the CD has booted upâ€¦ At the same time, however, it does show the NSA&#8217;s strange emphasis on persistence. â€œ</p>
<p>[Yes, I agree. But â€œPersistenceâ€ of malware is NSAâ€™s specialty.]</p>
<p>â€œâ€¦disk itself can&#8217;t tell the difference between a cold boot and the case where the disk is removed and its being remotely examined, yet the cost of evading the &#8220;boot from CD&#8221; detection is now you have guaranteed &#8220;NSA WAS HERE&#8221; writ in big glowing letters if it ever IS detected. â€œ</p>
<p>[Thatâ€™s big if!]</p>
<p>â€œin the wild, it would probably make sense not even to sabotage the MBR, but just to implant some malcode into the Windows kernel and, hey, if it gets noticed, how do you tell the difference from all the other malcode out there?â€</p>
<p>[Very carefullyâ€¦ if at all]</p>
<p>â€œOr, in many cases, just make the malcode memory-resident only: yeah it won&#8217;t survive across reboots, but it can be very very hard to detect, let alone capture, if it only exists in kernel memory. And when was the last time you reset your servers, laptop, or dekstop?â€</p>
<p>[It would be extremely hard to detect. The malware could be moved in the swap file, hibernation file, or temp files â€“ even if the drive controller was changed]</p>
<p>â€œThrough Remote Access or Interdiction, UNITEDRAKE, or STRAITBAZZARE are used with SLICKERVICAR to upload the hard drive firmwareâ€ -NSA</p>
<p>I would assume remote implant would be via SMM or iAMT pwnd systems. If that method of implantation failed the NSA slips you a pawned HD during shipping (after your original drive mysteriously fails).</p>
<p>I see that the NSA (in 2008) had a lot of file system covered. â€¦â€FAT, NTFS, EXT3 and UFSâ€ The would include Windows servers and clients, memory sticks, backup boxes, and most Unix and *nix flavors. The only thing missing is EXT4 for *nix servers (which is what I see used for websites). But, that was in 2008 so I am confident that EXT4 is now hackable.</p>
<p>UFS:</p>
<p>â€œVendors of some proprietary Unix systems, such as SunOS / Solaris, System V Release 4, HP-UX, and Tru64 UNIX, have adopted UFS. Most of them adapted UFS to their own uses, adding proprietary extensions that may not be recognized by other vendors&#8217; versions of Unix. Surprisingly, many have continued to use the original block size and data field widths as the original UFS, so some degree of (read) compatibility remains across platforms. Compatibility between implementations as a whole is spotty at best and should be researched before using it across multiple platforms where shared data is a primary intent. As of Solaris 7, Sun Microsystems included UFS Logging, which brought filesystem journaling to UFS, which is still available in current versions of Solaris. Solaris UFS also has extensions for large files and large disks and other features.â€</p>
<p><a href="https://en.wikipedia.org/wiki/Unix_File_System" rel="nofollow ugc">https://en.wikipedia.org/wiki/Unix_File_System</a></p>
<p>[That covers a lot of servers]</p>
<p>@ Bronx<br />
If only anti-virus companies would start scanning firmware&#8230; you would think they would include this technology especially in light of these disclosures&#8230; but something smells&#8230; probably cooperation with TLAs which prevents this.</p>
<p>[It not only smells fishy but the HD controller coders are a small group of people. If I had the power of the NSA I would simply force them to provide a backdoor and tell them to keep their mouths shut.]</p>
<p>@nick p, Anura, 3jh34, roger, and others:</p>
<p>[Good discussion]</p>
<p>@f3nkjf3nkjf:<br />
&#8220;No way they reversed engineered all the controller firmware for all these vendors. I know they could, but think of the economics. It&#8217;s extremely likely they just payed vendor providers for collaboration or ready solutions..&#8221;</p>
<p>Roger:<br />
â€œthey don&#8217;t need to reverse engineer controller firmware &#8220;from all these vendors&#8221;, because most HDD manufacturers (mostly) don&#8217;t make or program the controllers, they buy them from a relatively small number of specialist HDD controller companies. The top 3 HD controller companies account for well over 90% of HDDs.</p>
<hr />
<ul>
<li>Actually, from the several flavours of product lines in the catalogue, it&#8217;s more likely half a dozen labs, each with its own dedicated engineering team.â€</li>
</ul>
<p>[Again, that is still a small group. The group to be strong armed by the NSA into providing critical design details â€“  very little reverse engineering needed]</p>
<p>3jh34:<br />
â€œThese are all that&#8217;s needed for my suggested solution.. It&#8217;s just not profitable to produce a single licensed solution and market and support it long term, so you have signature subscriptions. A lot of suite type anti-virus solution already use these interfaces the just don&#8217;t implement MAC based HIPS even on highest settings. Again, there is a lot of misinformation when it comes to this. My method naturally defeats any attempt to map unsigned code even through sophisticated DMA and cache payloads and direct-bus RAM glitchingâ€¦â€</p>
<p>[Good stuff. Do you care to start a firmware AV company? It could be profitable]</p>
<p>Dave M:<br />
&#8220;Do you think it would be possible to at least get them to publish firmware signatures, and tell us how they calculated them? JTAG could maybe work&#8230; Hard disk hacking &#8211; Hooking up JTAG Who is to say that some or all of the manufacturers are not now including code that allows remote activation of this kind of exploit for new drives via, say, an undocumented SATA command?&#8221;</p>
<p>[We donâ€™t know. But firmware signature check on boot would be helpful]</p>
<p>And</p>
<p>â€œI now see that there are SATA commands to read/write drive firmware. But can you believe what the drive reports back? If only a small part of the exploit firmware image is different then it wouldn&#8217;t take much room to make it invisible from the SATA level. Would be even easier to have the exploit firmware report the &#8220;correct&#8221; firmware signature. The JTAG approach (almost certainly available on all newer drives) would allow real hardware access to the drive firmware for verification.â€</p>
<p>[That type of access to the firmware is interesting. I wonder if some code could be written to verify the firmware for alterations. The NSAâ€™s pawning of firmware is very serious! Again, I wonder how the NSA keeps their firmware from being pawned.]</p>
<p>Brandioch C:</p>
<p>@Nick P<br />
The problem is that the running system can still be subverted in this threat model as one must trust Microsoft, the board/BIOS vendor, and the chip vendor.<br />
The next question is how will the non-USofA governments deal with this issue?</p>
<p>[Good question. The Russians and Chinese are not stupid.  I wonder how much of all government systems have been compromised. Once, compromised I would guess the safest solution is to junk the HD or the whole box. The hacking of firmware opens a Pandoraâ€™s box of horrible problems.]</p>
<p>@Adjuvant<br />
[Good link. It looks like what the NSA is using in some form. I donâ€™t the NSA needs a JTAG. I think they can just put the HD in a â€œspecial hard drive testerâ€ and reprogram the chip.]</p>
<p>I will note that SpritesMods leaves out some critical code for normal readers:</p>
<p>â€œâ€¦I want to release code, but I do not want to be responsible for a lot of permanently hacked servers&#8230; I decided to compromise: you can download the code I used here, but I removed the shadow-replacement code. Make note: I&#8217;m not going to support the process to get all this running in any way; it&#8217;s a hack, you figure it out.â€</p>
<p><a href="http://spritesmods.com/?art=hddhack&#038;page=8" rel="nofollow ugc">http://spritesmods.com/?art=hddhack&#038;page=8</a></p>
<p>It&#8217;s clear the NSA figured it out and is using it!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215401">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215401">
						February 2, 2014 1:51 AM					</a>

				</p>

				<p>@ Nick P,</p>
<ul>They need OS&#8217;s that are inherently safer from coding bugs, useful, fast, easy to modify, and probably free of subversion&#8230;</ul>
<p>Unfortunatly I don&#8217;t think that is enough for a secure OS.</p>
<p>It&#8217;s the problem of &#8220;low hanging fruit&#8221; being exploited first causing incremental layers of fixes for each successive attack. Thus increasing complexity and available attack vectors whilst not actualy solving the fundemental flaws.</p>
<p>The problem is nearly mutualy exclusive design goals, for instance subversion free is unlikely to give a fast OS and keeping subversion down is going to jibe badly with easy to modify and inherently safer from coding bugs.</p>
<p>It&#8217;s down to one of my mems of &#8220;Efficiency -v- Security&#8221;, as a general case the more efficient you make a system the more open it is to side channel attacks of various forms.</p>
<p>The soloution is in the main to decrease complexity not increase efficiency, which is not what has happened in mainstream OS development as far back as I can remember. That is the desired goal has been &#8220;more features&#8221; combined with &#8220;more efficiency&#8221;.</p>
<p>Thus the first goal of an OS has to be the absolute minimum &#8211;but not less&#8211; of functional features, monolithic solutions are out. Perhaps the easiest way to do this is to split the OS into many parts where each part has very clearly designed and limited function with interfaces that can be clearly monitored for aberant behaviour be it by data, metadata, format or time.</p>
<p>Which gives rise to the issues of what priveledge the code parts have and where you split low and high priveledge requirments.</p>
<p>This brings us back to the interfaces which need to be both simple and effective for the given function, but unfortunatly like any communication channel can be abused to leak information either by chance or design. This calls for strong monitoring of the interfaces in a way that limits or prevents abuse. The down side is that either end of the channel has to be programed with the implicit assumption not just of error but active abuse.</p>
<p>Further the interface needs to be independently controled to prevent covert channnels being established. That is the interfaces have a &#8220;Mediator in the Middle&#8221; the job of which is to ensure communications are compliant with interface policy. Thus this mediator needs to be robust in design but also have it&#8217;s own protocol for signaling exceptions etc and to do this it will need to some extent be statefull.</p>
<p>This sort of design has been seen in hardware solutions to reduce EmSec but not sofar in mainstream OS design partly because it&#8217;s seen as a &#8220;speed bump&#8221; but also because the COTS hardware does not provide desirable features to support it currently. Which gives us the &#8220;Chicken and Egg&#8221; problem but in reverse.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215402">

			<div class="comment by-james-sutherland ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.deadnode.org/' rel='external nofollow ugc' class='url'>James Sutherland</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215402">
						February 2, 2014 8:54 AM					</a>

				</p>

				<p>&#8220;The group to be strong armed by the NSA into providing critical design details â€“ very little reverse engineering needed&#8221;</p>
<p>Ironically, not even strong-armed I suspect: NSA/DoD could easily ask the manufacturers for source access for a &#8220;security audit&#8221; &#8211; wouldn&#8217;t want to risk the firmware getting compromised, would you? (MS give them access to Windows on that basis, after all!) They don&#8217;t even need much of an excuse: using a cross-section of drive vendors and models is a sensible precaution against clustered failures, and they&#8217;ll have all sorts of legitimate reasons to buy different drives: staff laptops, servers, SANs, the lot.</p>
<p>Ditto most of the servers, routers: &#8220;we&#8217;re considering approving your new firewall for government use, but we&#8217;ll need to audit the firmware first &#8230;&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-215403">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215403">
						February 2, 2014 9:24 AM					</a>

				</p>

				<p>UNITEDRAKE is a software implant.  I don&#8217;t know what it does, but I remember seeing it in a FOXACID manual.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215404">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215404">
						February 2, 2014 3:10 PM					</a>

				</p>

				<p>@ Clive Robinson<br />
<i>On a more serious note, much of the modern attack vectors are not realy new, they are just variations on older ideas that go back into the late 1950&#8217;s through early 70&#8217;s. The &#8220;new kids on the block&#8221; just have not seen them befor and nobodies told them so &#8220;the wheel get&#8217;s re-invented with every turn&#8221;.</i></p>
<p>Couldn&#8217;t agree more, everything old is new again. Part of the marketing psychosis, just put a new label and a marked up price. Part of how security theatre works, the old fear is the new fear. I chaulk it up to the fascist overlords enforcing the validity of short term memory for all U.S. citizenry.</p>
<p>But what I would like to know more about is your &#8220;hat&#8221;. Sounds quite fashionable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215405">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">tom</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215405">
						February 2, 2014 3:15 PM					</a>

				</p>

				<p>UNITEDRAKE? I suppose whatever these have in common:</p>
<p>GECKO II &#8211; System consisting of hardware implant MR RF or GSM, UNITEDRAKE software implant, IRONCHEF persistence back door</p>
<p>RETURNSPRING &#8211; High-side server shown in UNITEDRAKE internet cafe monitoring graphic</p>
<p>SEAGULLFARO &#8211; High-side server shown in UNITEDRAKE internet cafe monitoring graphic</p>
<p>SLICKERVICAR &#8211; Used with UNITEDRAKE or STRAITBIZARRE to upload hard drive firmware to implant IRATEMONK</p>
<p>UNITEDRAKE &#8211; Computer exploit delivered by the FERRETCANON system *</p>
<p>WISTFULTOLL &#8211; Plug-in for UNITEDRAKE and STRAITBIZARRE used to harvest target forensics</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-215406">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215406">
						February 2, 2014 3:47 PM					</a>

				</p>

				<p>&#8220;UNITEDRAKE &#8211; Computer exploit delivered by the FERRETCANON system&#8221;</p>
<p>FERRETCANNON is the subsystem of FOXACID that decided what exploit to send to a victim.  FOXACID never attacks people blindly.  When someone is tricked to visiting a FOXACID URL, that URL is unique so that FOXACID knows exactly who is on the other end of the connection.  Based on that, FERRETCANNON makes a decision.  Presumably the primary difference in base exploits depends on how low- or high-value the target is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215407">

			<div class="comment by-name-redacted-for-national-security-reasons ">

				<p class="commentcredit">

					<span class="commenter">[name redacted for National Security reasons]</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215407">
						February 2, 2014 3:56 PM					</a>

				</p>

				<p>I concur: they surely cover ext4 by now.</p>
<p>But&#8230; there is plenty of other formats left.  There is hassle with compatibility now and then, but if you are a Syrian war criminal, you don&#8217;t use off the shelf Bill Gates&#8217; personal poop in the first place.</p>
<p>As to persistence, collect-it-all policy would dictate implanting more rather then less, just in case. If I were a NSA spook, I would write an algorithm which would preselect targets based on certain criteria (what they already do by extratcting behavior from social media), and then implant just in case all across the board. Algorithm would also exclude certain targets, such as <a href="http://www.youtube.com/watch?v=3llihVbDIlM" rel="nofollow ugc">Kardashian sisters</a> with their 200 million a day SMSs.</p>
<p>In fact, it seems, NSA is already at it. Once a while you type <a href="http://nytimes.com" rel="nofollow ugc">http://nytimes.com</a> and https pops out asking to accept strange certificate, although NY Times does not ask for a front page. You remove manually &#8220;s&#8221; from URL and get correct page. It clearly comes from those secret rooms at telcos in real time. I am talking about certificates here, but why not other implants such as IRATEMONK as well?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215408">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215408">
						February 2, 2014 4:31 PM					</a>

				</p>

				<p>@ Name.Witheld&#8230;,</p>
<ul><i>But what I would like to know more about is your &#8220;hat&#8221;. Sounds quite fashionable</i></ul>
<p>Beauty as they say is in the eye of the beholder ðŸ˜‰</p>
<p>However being slightly older than Bruce and having a beard that came runner up in a competition, I think it safe to say I&#8217;ve reached an age where comfort is more desirable than fashion especialy now my &#8220;thin spot on top&#8221; gets sunburn or frostbite &#8211;depending on the season&#8211; rather to easily ðŸ™</p>
<p>Whilst a &#8220;Dry-z-Bone&#8221; hat is fine for a couple of seasons (and kind of makes me look like the &#8220;town drunk&#8221; in &#8220;Blazing Saddles&#8221;, when the wind gets up I need something a bit more &#8220;snug fitting&#8221;. So I have a Swedish knitted hat that has sides that keep the ears warm and if realy required can be tied under the chin. Rather than the traditional snowflake pattern I went for red and green vertical stripes and a white bobble on the top. Yes it looks compleatly ridiculous on me, and as I&#8217;m over 6&#8217;6&#8243; tall and a bit over two ft wide and look like a streched &#8220;Brian Blessed&#8221; I stand out above the &#8220;sea of heads&#8221; at London&#8217;s Waterloo station. So much so a friend spotted me from a considerable distance away and said I looked like a &#8220;Lateral Mark bobbing in choppy waters&#8221;&#8230; The big advantage for me is not only does it keep my delicate ears warm, but when people see me steaming towards them in it they move out the way PDQ especialy when I&#8217;ve a &#8220;face like thunder&#8221; on me&#8230; The scary thing though is the number of young ladies who come up to me and say they like my beard&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215409">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">tom</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215409">
						February 2, 2014 5:15 PM					</a>

				</p>

				<p>The SLICKERVICAR and WISTFULTOLL slides make it sound like UNITEDRAKE and STRAITBIZARRE play more or less the same roles. If so, we can leverage off STRAITBIZARRE to better understand UNITEDRAKE (or vice versa).</p>
<p>Thus the STRAITBIZARRE positioning in the 11th slide in the QFIRE deck might also be more or less applicable to UNITEDRAKE.</p>
<p>My reading of QFIRE is that it is a later and more sophisticated integration and replacement for the various Quantum tools, FerretCannon, and FoxAcid pieces.</p>
<p><a href="http://www.spiegel.de/fotostrecke/qfire-die-vorwaertsverteidigng-der-nsa-fotostrecke-105358-11.html" rel="nofollow ugc">http://www.spiegel.de/fotostrecke/qfire-die-vorwaertsverteidigng-der-nsa-fotostrecke-105358-11.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215410">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215410">
						February 3, 2014 10:27 AM					</a>

				</p>

				<p>@ Clive<br />
What a colorful story. I had nightmares about your hat.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215411">

			<div class="comment by-g ">

				<p class="commentcredit">

					<span class="commenter">G.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215411">
						February 3, 2014 12:34 PM					</a>

				</p>

				<p>The malware code will have to be executed, if loaded by bios. The malware code will have to be hidden, if loaded by a scanner. If the payload is only served once after powerup, if sector zero is not accessed first -&gt; boot from other medium -&gt; dont show malware sector. A flag could be used in code, to show malware code only once the system is poweredup, in reasonable time and Sector 0 is read first. This could be a solution to get access to the malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215412">

			<div class="comment by-jesse-viviano ">

				<p class="commentcredit">

					<span class="commenter">Jesse Viviano</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215412">
						February 17, 2015 4:00 PM					</a>

				</p>

				<p>I think that this is a match for the Equation Group as seen in <a href="http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/" rel="nofollow ugc">http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/</a> , <a href="https://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/" rel="nofollow ugc">https://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/</a>, and <a href="https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf" rel="nofollow ugc">https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf</a> .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-215413">

			<div class="comment by-whiskers-in-menlo ">

				<p class="commentcredit">

					<span class="commenter">Whiskers in Menlo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215413">
						February 18, 2015 7:31 PM					</a>

				</p>

				<p>Of all the exploits this one has very few defenses.</p>
<p>Once the disk microcode has been altered it has astoundingly large<br />
resources for overlays given the spare blocks and spare tracks<br />
that the controller manages.   One payload can update the<br />
BIOS so even booting from a USB stick could be hacked.</p>
<p>Booting from a USB stick might be the easy way to<br />
compromise the box.   Physically removing the drive<br />
and attaching it to another computer would also be an<br />
easy attack.</p>
<p>In some cases JTAG could be used to explore the controller<br />
but that demands vectors and test vectors.   Some devices<br />
keep code on media.   Exploring the media is darn hard but<br />
possible if the positioning signals and the data can be attached<br />
to a test fixture or perhaps a known good controler.</p>
<p>Media encryption by the controller intended to protect data<br />
confounds efforts at forensic analysis.</p>
<p>Laptops that travel and spend any time unattended in a hotel or  in security<br />
are at great risk.   Other common attacks can result in the same result.</p>
<p>One very difficult problem is that of a VM attack hidden in the disk.<br />
As long as the disk is present the bios can boot the VM from the disk<br />
and from that point it is turtles all the way down as the initial hosted<br />
code could look like the BIOS.</p>
<p>Trouble&#8230; at a lot of levels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-215414">

			<div class="comment by-cryptic ">

				<p class="commentcredit">

					<span class="commenter">Cryptic</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-215414">
						October 10, 2017 10:28 AM					</a>

				</p>

				<p>Wow. Here we are and 2017 is almost over. This is almost the same stuff we were doing in the early 90&#8217;s and no one listened.</p>
<p>Going way back to the early 1990&#8217;s, I commented to several teachers / professors about a few concepts that I had which could be very dangerous if too many people figured them out:</p>
<p>1) Use AntiVirus software to spread your infections.<br />
&#8211; Rather than trying to infect a computer and attempt to keep hiding from AntiVirus software, why not seek out vulnerabilities in the AntiVirus software in order to use it to actually spread the infection.</p>
<p>2) Attack and or intentionally damage the BIOS.<br />
&#8211; We didn&#8217;t really know much about how to code a BIOS, but we did manage to corrupt parts of the BIOS that affect either the keyboard or video. Placing an infection in the BIOS is merely an extension of what we could already do way back then.</p>
<p>We were kids / teens and didn&#8217;t even know how to code very well. Everything we knew was literally exploration while reading some really boring / dry facts about micro processors and assembler. Pascal was popular reading too, though I don&#8217;t really doing anything useful with that.</p>
<p>Anyway, the point of this is that OUR mischievous pranks only worked on systems that didn&#8217;t have a pin jumper to flash the BIOS or systems that would boot while the flash enable was jumpered.</p>
<p>IF NEW SYSTEMS STILL REQUIRED A PHYSICAL LOCKOUT TO FLASH THE FIRMWARE NONE OF THIS WOULD BE POSSIBLE.</p>
<p>It&#8217;s just insane how much &#8220;Firmware&#8221; can be reprogrammed directly though normal use. WTF does a USB mouse need new firmware?!?!?! Or a basic keyboard?</p>
<p>At the core of every system, there is a fundamental process that should never change. That &#8220;Stage 1&#8221; has no reason to be reprogrammable in any convenient way. If &#8220;Stage 1&#8221; implements adequate checks into &#8220;Stage 2&#8221;, then a reprogrammable &#8220;Stage 2&#8221; would automatically be safer to reprogram.</p>
<p>Another thing I&#8217;ve been chasing for a few years, is a concept of &#8220;How do we establish trust in an untrusted environment?&#8221;<br />
 In my approach, I envision the scenario of a used computer, be it purchased used or taken from a contaminated enterprise network.</p>
<p>1) Can we ensure the computer firmware (BIOS / EFI) is infection free?<br />
&#8211; Users can &#8220;update&#8221; their firmware, but this does not always ensure an existing infection is removed, especially if the firmware was already the newest at the time of injection. (Many systems will not allow you to re-flash the same firmware.)</p>
<p>2) If I can&#8217;t use generic &#8220;Update / Upgrade&#8221; methods to cleanse / ensure the firmware, will the manufacturer offer a way to ensure this or to re-flash the same version firmware?<br />
&#8211; Apple could not provide a way nor could they even assure me that their factory refurbished units covered this internally.<br />
&#8211; Dell presented the same scenario.<br />
&#8211; I tried a few other manufacturers via chat and help desk calls to end up with the same answer.</p>
<p>I&#8217;ve pushed Apple the hardest on this, hoping they would be less lost in their sheer volume and more concerned with their product than others. Thus far, I&#8217;m baffled to find no process nor to even get solid confirmation that their in-house refurbishing process can assure this (just in case they simply don&#8217;t want to expose a security trade secret.)</p>
<p>The rest of the real trust comes only after the hardware.<br />
From new, we can be compelled to begrudgingly assume trust, since we&#8217;d have to trust their provided firmware anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-361834">

			<div class="comment by-researcherzero ">

				<p class="commentcredit">

					<span class="commenter">ResearcherZero</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/#comment-361834">
						December 30, 2020 10:05 PM					</a>

				</p>

				<p>Do you really want the cheese [insert tech company name here]? Follow the FISA order.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/01/iratemonk_nsa_e.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/01/iratemonk_nsa_e.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Firatemonk_nsa_e.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/01/iratemonk_nsa_e.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5203' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/01/another_credit.html" rel="prev">â† Another Credit-Card-as-Authentication Hack</a>		<a href="https://www.schneier.com/blog/archives/2014/01/friday_squid_bl_410.html" rel="next">Friday Squid Blogging: Squid T-Shirt â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
