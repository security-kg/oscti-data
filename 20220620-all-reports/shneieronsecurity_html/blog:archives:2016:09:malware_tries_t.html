<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Malware Tries to Detect Test Environment - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Malware Tries to Detect Test Environment Comments Feed" href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/10803" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=10803' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F09%2Fmalware_tries_t.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F09%2Fmalware_tries_t.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-10803 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-10803" class="post-10803 post type-post status-publish format-standard hentry category-uncategorized tag-malware">

	<div class="article">

		<h2 class="entry">Malware Tries to Detect Test Environment</h2>
		<p>A new malware tries to <a href="https://sentinelone.com/s/anti-vm-tricks/">detect</a> if it&#8217;s running in a virtual machine or sandboxed test environment by looking for signs of normal use and not executing if they&#8217;re not there.</p>
<p>From a <a href="https://threatpost.com/malware-evades-detection-with-novel-technique/120787/">news article</a>:</p>
<blockquote><p>A typical test environment consists of a fresh Windows computer image loaded into a VM environment. The OS image usually lacks documents and other telltale signs of real world use, Fenton said. The malware sample that Fenton found&#8230;looks for existing documents on targeted PCs.</p>
<p>If no Microsoft Word documents are found, the VBA macro code execution terminates, shielding the malware from automated analysis and detection. Alternately, if more than two Word documents are found on the targeted system, the macro will download and install the malware payload.</p></blockquote>
<p>EDITED TO ADD (10/16): Some <a href="http://news.softpedia.com/news/clever-malware-is-clever-adds-new-anti-detection-tricks-508596.shtml">details</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html" rel="bookmark">Posted on September 28, 2016 at 6:34 AM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html#comments">32 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html" data-title="Malware Tries to Detect Test Environment" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-284460">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284460">
						September 28, 2016 7:04 AM					</a>

				</p>

				<p>When all is said and done, the way it detects is not new. It&#8217;s been discussed before with Honey-Nets and the like.</p>
<p>And as with Honey-Nets it&#8217;s the investigators lazyness in implementing an environment that is what gives the game away.</p>
<p>This is not the first time that such &#8220;check befor you fly&#8221; techniques have been used.</p>
<p>If you think back, you should remember that after Stuxnet, escaped and thus became known and subsiquently got publicaly dissected some malware started taking precautions. In atleast one case by using payload encryption to protect it&#8217;s contents. Effectively the payload encryption was &#8220;keyed&#8221; by information on the target computer (that went into a very CPU time expensive algorithm).</p>
<p>In some ways this is like the Electronic Warfare ECM / ECCM &#8230; EC&#8230;CM escalation, with the advantage being with the Malware not the investigators.</p>
<p>There are a number of downsides for the Malware, one is that the detection methods quite rapidly get to be of significant size, and this alone may well trigger Intrusion Detection Systems. Other problems are that even though encrypted the detection code or payload will have a recognisable network signiture or a polymorphic system that can be recognised. But the one that will stand out or should do if the malware author is being cautious is the CPU load on a target system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284461">

			<div class="comment by-ionel-pop ">

				<p class="commentcredit">

					<span class="commenter">Ionel POP</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284461">
						September 28, 2016 7:04 AM					</a>

				</p>

				<p>Another reasons not to use word documents üòâ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284462">

			<div class="comment by-jg4 ">

				<p class="commentcredit">

					<span class="commenter">JG4</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284462">
						September 28, 2016 7:13 AM					</a>

				</p>

				<p>another nice example of malware sensing the environment was VW&#8217;s engine controller recognizing that it was being subjected to a standardized test regime</p>
<p>would you expect any less of a company that used Nazi slave labor?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284463">

			<div class="comment by-dimitrios-andrakakis ">

				<p class="commentcredit">

					<span class="commenter">Dimitrios Andrakakis</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284463">
						September 28, 2016 7:55 AM					</a>

				</p>

				<p>@JG4 &#8220;would you expect any less of a company that used Nazi slave labor?&#8221;</p>
<p>Seriously? I come from a country that suffered a lot during this time, and even <em>I</em> don&#8217;t think WW2-stories have anything to do with anything.</p>
<p>Jeez.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284464">

			<div class="comment by-ssieth ">

				<p class="commentcredit">

					<span class="commenter">Ssieth</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284464">
						September 28, 2016 9:23 AM					</a>

				</p>

				<p>Yes &#8211; this is why test environments are generally best set up as virtual copies of real machines with as few changes as necessary to preserve data security.  Not always easy but&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284465">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284465">
						September 28, 2016 9:37 AM					</a>

				</p>

				<p>Cloak and dagger!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284466">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284466">
						September 28, 2016 9:39 AM					</a>

				</p>

				<p>This is not really new, malware tries to detect debug environment since their very first versions, more than 20 years ago, debug mode in the begining now virtual machines.<br />
The approach is kind of weird for this scope, maybe they were looking for something else too. Like the documents importance for a future cryptolocker attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284467">

			<div class="comment by-evan-th ">

				<p class="commentcredit">

					<span class="commenter">Evan Th</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284467">
						September 28, 2016 10:27 AM					</a>

				</p>

				<p>@Andrew, look at the article &#8211; the malware was running as a Word macro, and it was inspecting Word&#8217;s recent file list to see how many documents it&#8217;d opened.  That&#8217;s a fairly nice approach, actually.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284468">

			<div class="comment by-randal ">

				<p class="commentcredit">

					<span class="commenter">Randal</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284468">
						September 28, 2016 11:04 AM					</a>

				</p>

				<p>Perhaps development tools which produce an array of fake documents would be useful. There are already tools which create large numbers of test accounts and other server artifacts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284469">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284469">
						September 28, 2016 11:27 AM					</a>

				</p>

				<p>@Evan Th</p>
<p>Indeed, I was reading it somewhere else before and they claimed that the malware was counting the number of words in documents.</p>
<p>Journalists&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284470">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284470">
						September 28, 2016 11:30 AM					</a>

				</p>

				<p>Bruce, I hate to say this, but the technique to try to detect VM environments in viruses is about 20 years old now, just as Andrew said (and not just through detecting a VM&#8217;s debug mode, but by searching for other signs of actual computer usage).</p>
<p>The only thing new here is that it&#8217;s being done rather elegantly from a VBA script.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284471">

			<div class="comment by-scott-lewis ">

				<p class="commentcredit">

					<span class="commenter">Scott Lewis</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284471">
						September 28, 2016 11:51 AM					</a>

				</p>

				<p>There are a lot of enterprises running virtualized file servers and giving employees virtual desktops. In the very short run, hiding your virus or trojan because you detected you are running on a VM will limit the spread quite a bit, so this is likely a short term trend.</p>
<p>Detecting the lack of recently opened files in Word is pretty brilliant though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284472">

			<div class="comment by-zak ">

				<p class="commentcredit">

					<span class="commenter">Zak</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284472">
						September 28, 2016 12:59 PM					</a>

				</p>

				<p>To be fair to Bruce he&#8217;s reporting the news from Kaspersky:</p>
<p><i>Researchers have found a new strain</i></p>
<p><a href="https://threatpost.com/malware-evades-detection-with-novel-technique/120787/" rel="nofollow ugc">https://threatpost.com/malware-evades-detection-with-novel-technique/120787/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284473">

			<div class="comment by-karl-gruber ">

				<p class="commentcredit">

					<span class="commenter">Karl Gruber</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284473">
						September 28, 2016 2:07 PM					</a>

				</p>

				<p>TrendMicro&#8217;s Deep Discovery product lets you upload copies of your COEs to the sandbox environment, so you could populate them with docs to defeat this checking.</p>
<p>This movement to behavior based detection rather than signature and traditional heuristics offers real benefits for defeating zero day malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284474">

			<div class="comment by-george ">

				<p class="commentcredit">

					<span class="commenter">George</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284474">
						September 28, 2016 2:17 PM					</a>

				</p>

				<p>Anti-forensics has been in malware for years. Why is this suddenly news?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284475">

			<div class="comment by-grauhut ">

				<p class="commentcredit">

					<span class="commenter">Grauhut</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284475">
						September 28, 2016 4:24 PM					</a>

				</p>

				<p>Classical literature:</p>
<p>&#8220;Red Pill&#8230; or how to detect VMM using (almost) one CPU instruction<br />
Joanna Rutkowska<br />
<a href="http://invisiblethings.org/" rel="nofollow ugc">http://invisiblethings.org/</a><br />
November 2004</p>
<p>Swallowing the Red Pill is more or less equivalent to the following code (returns non zero when in Matrix):</p>
<pre><code> int swallow_redpill () {
   unsigned char m[2+4], rpill[] = "\x0f\x01\x0d\x00\x00\x00\x00\xc3";
   *((unsigned*)&amp;rpill[3]) = (unsigned)m;
   ((void(*)())&amp;rpill)();
   return (m[5]&gt;0xd0) ? 1 : 0;
 }
</code></pre>
<p>The heart of this code is actually the SIDT instruction (encoded as 0F010D[addr]), which stores the contents of the interrupt descriptor table register (IDTR) in the destination operand, which is actually a memory location&#8230;&#8221;</p>
<p><a href="https://web.archive.org/web/20110708204609/http://www.invisiblethings.org/papers/redpill.html" rel="nofollow ugc">https://web.archive.org/web/20110708204609/http://www.invisiblethings.org/papers/redpill.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284476">

			<div class="comment by-whiskersinmenlo ">

				<p class="commentcredit">

					<span class="commenter">WhiskersInMenlo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284476">
						September 28, 2016 6:05 PM					</a>

				</p>

				<p>This seems to be a big hint that many of us should work in a VM.<br />
1) copy known good VM to Fresh_VM.<br />
2) start VM using Fresh_VM image.<br />
3) Trasfer files to someplace else as needed.<br />
4) stop VM and trash Fresh_VM.  Heck kill -9 the VM.</p>
<p>Variations are possible&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284477">

			<div class="comment by-lawrence-pingree ">

				<p class="commentcredit">

					<span class="commenter">Lawrence Pingree</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284477">
						September 28, 2016 8:49 PM					</a>

				</p>

				<p>This is not new, there&#8217;s been anti-evasion capabilities for quite some time now that check environmental factors to determine whether to execute payload downloads or not etc. Minerva Labs is a provider that is using these factors to stop malware from functioning, leveraging this exact interaction to defeat malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284478">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284478">
						September 29, 2016 12:35 AM					</a>

				</p>

				<p>Whilst this behavior is nothing new, Windows 10 curiously displays VM status in Task Manager, so one would presume that checking if running in a VM just became a whole lot easier.</p>
<p>The best way to defeat malware is open untrusted documents in a throw-away instance that has no persistence.</p>
<p>About the only people this behavior really affects are those analyzing it. It only prevents dynamic analysis however, not static.</p>
<p>There will never be a perfect malware that can evade detection due to the nature of software.</p>
<p>Another way of testing could be to watch the VM from the outside. Not a new idea, but no malware can evade what it can&#8217;t see.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284479">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284479">
						September 29, 2016 12:36 AM					</a>

				</p>

				<p>&#8230;malware CAN&#8217;T evade what it can&#8217;t see&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284480">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284480">
						September 29, 2016 1:28 AM					</a>

				</p>

				<p>@ Anon,</p>
<blockquote><p>There will never be a perfect malware that can evade detection due to the nature of software.</p></blockquote>
<p>And the nature of it&#8217;s behaviour.</p>
<p>The problem however also applies to the actual CPU the malware runs on as well. That is the CPU can not see malware as part of it&#8217;s inherent characteristics. It can ONLY see what&#8217;s in memory if the code that examines memory works correctly. Thus has not been &#8220;got at&#8221; by malware or an insider.</p>
<p>Thus you need a way to check, &#8211;that is outside of the vulnerable CPU&#8211; which gives rise to the notion of a second less vulnerable set of logic to perform instrumentation on the vulnerable CPU.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284481">

			<div class="comment by-r ">

				<p class="commentcredit">

					<span class="commenter">r</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284481">
						September 29, 2016 1:46 AM					</a>

				</p>

				<p>&#8220;There will never be a perfect malware that can evade detection due to the nature of software&#8221;</p>
<p>There will never be a perfect system that can detect evasion due to the nature of software. (and standardized testing procedures)</p>
<p>This is where a malware that doesn&#8217;t set off any alarms needs to be investigated, often they&#8217;re not. Things that have been &#8220;disovered&#8221; often weren&#8217;t for years before they&#8217;re finally discovered. It&#8217;s not enough. There&#8217;s not enough eyes on things that misrepresent themselves &#8211; or even on things that don&#8217;t, with triggers based on interaction or environment unless you&#8217;re operating a very convincing environment your automated analysis will only go so far.</p>
<p>Did we ever unencrypt the environment-locked modules of stuxnet?</p>
<p>No system is perfect, the best stuff has one foot in crowd-sourcing &#8211; and public tips &#8211; not merely automated discovery and analysis.</p>
<p>Careful not to buy into the snakeoil of &#8220;absolute security&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284482">

			<div class="comment by-drone ">

				<p class="commentcredit">

					<span class="commenter">Drone</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284482">
						September 29, 2016 5:39 AM					</a>

				</p>

				<p>Loop() {<br />
  Look for Pr0n;<br />
  If (Found) {Infect}<br />
  Else {Hide}<br />
  Wait<br />
}</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284483">

			<div class="comment by-industrial-it ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://solutionspt.com/' rel='external nofollow ugc' class='url'>Industrial IT</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284483">
						September 29, 2016 9:36 AM					</a>

				</p>

				<p>I too read that the malware was counting the number of words in documents. But the way it detects it is not new.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284484">

			<div class="comment by-jpa ">

				<p class="commentcredit">

					<span class="commenter">JPA</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284484">
						September 30, 2016 12:33 AM					</a>

				</p>

				<p>@Clive &#8220;Thus you need a way to check, &#8211;that is outside of the vulnerable CPU&#8211; which gives rise to the notion of a second less vulnerable set of logic to perform instrumentation on the vulnerable CPU.&#8221;</p>
<p>Somehow this makes me think we need to teach CPU&#8217;s Buddhism. An enlightened CPU would be able to detect the malware. üôÇ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284485">

			<div class="comment by-virtual-machine ">

				<p class="commentcredit">

					<span class="commenter">Virtual Machine</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284485">
						September 30, 2016 1:46 AM					</a>

				</p>

				<p>There are a lot of vulnerabilities with VM&#8217;s that crop up. Maybe three different systems, one the more flippant system, an isolated personal system, and an isolated testing and analysis system. Hell, chuck in a honey-pot as well for the fun of it, and a mobile system with cheap removable wifi card and a hammer for going online. Mow much does that add up to now, what is the wallet damage?</p>
<p>And after all that, wait the net connection is down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284486">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284486">
						September 30, 2016 4:05 AM					</a>

				</p>

				<p>@r: I know absolute security doesn&#8217;t exist &#8211; we are human after all.</p>
<p>Part of the problem is, we do not see what we&#8217;re not looking for. Malware might try to hide (with associated behaviors) but if we don&#8217;t know to look in the first place, it doesn&#8217;t matter.</p>
<p>@Clive: I recall a discussion in the past about seperate monitoring hardware that checked the data traversing the bus to/from a CPU being monitored. The idea reminded me of the debug devices for PICs whereby the PIC is put in a debug socket that is then plugged in the board. Perhaps such a device could be created for desktop CPUs to monitor them?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284487">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284487">
						September 30, 2016 5:19 AM					</a>

				</p>

				<p>@Anon, @Clive Robinson,</p>
<blockquote><p>I recall a discussion in the past about seperate monitoring hardware that checked the data traversing the bus to/from a CPU</p></blockquote>
<p>It&#8217;s gotta be one of the longest technical security discussions here, it lasted well over three years. Castles Vs. Prisons, or C-v-P. Such a lovely name üôÇ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284488">

			<div class="comment by-sorin ">

				<p class="commentcredit">

					<span class="commenter">Sorin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284488">
						September 30, 2016 6:23 AM					</a>

				</p>

				<p>Actually that evasion trick has been detailed in June by Zscaler and Proofpoint. You should check out this article, for more recent anti-detection tricks: <a href="http://news.softpedia.com/news/clever-malware-is-clever-adds-new-anti-detection-tricks-508596.shtml" rel="nofollow ugc">http://news.softpedia.com/news/clever-malware-is-clever-adds-new-anti-detection-tricks-508596.shtml</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284489">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284489">
						September 30, 2016 9:01 AM					</a>

				</p>

				<p>@ Sorin,</p>
<blockquote><p> You should check out this article, for more recent anti-detection tricks</p></blockquote>
<p>All though the are different instantiations, they are of the same class of detection techniques.</p>
<p>That is they are looking for &#8220;not normal&#8221; charecteristics, that investigators can quickly change their test environment to replicate.</p>
<p>I know of tricks where the investigators can not change their test environment easily. I&#8217;ve mentioned some of them in the past, and they are often used as sources of entropy in random number generators and involve hardware charecteristics.</p>
<p>One charecteristic for instance is how heat effects the timing of various hardware signals. The heat comes from the difference between a computer just sitting idle and one being used. Importantly the type of use the computer is being put to changes the signals. The 24h heat signiture of an administrative / clerical user is markedly different to that of a programmer, which likewise is different to a system used as an industrial control system head end. All of which are markedly different to the use of a malware researcher.</p>
<p>Thus a malware attack of the sort you realy don&#8217;t want &#8211;covert APT from high level attacker&#8211; can run tests over several days unlocking it&#8217;s encrypted tests and payload little by little as it builds confidence in what it sees.</p>
<p>If you want an idea of real sneaky things you can check, have a think about how the various cuts of quartz crystals are effected by heat and importantly how they change depending on the electrical loads adjacent to them&#8230;</p>
<p>It&#8217;s not something you are going to see in cyber-crime malware for some time. But there are people who have  done the research and put such techniques in covert code. As has been noted before Stuxnet was a bit embarrassing in the way it got publicaly dissected and various people do not want that happening again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-284490">

			<div class="comment by-jpa ">

				<p class="commentcredit">

					<span class="commenter">JPA</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284490">
						September 30, 2016 8:35 PM					</a>

				</p>

				<p>@Clive</p>
<p>Then having a baseline for the average value of a variable that is associated with the use of the CPU, like the heat signature might act as a &#8220;thermometer&#8221; to see if malware were running as that might change the signature. Sort of like the CPU running a fever?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-284491">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/#comment-284491">
						October 1, 2016 2:57 AM					</a>

				</p>

				<p>@ JPA,</p>
<blockquote><p>Sort of like the CPU running a fever?</p></blockquote>
<p>More like a &#8220;sweat from honest toil&#8221; as the malware is looking for user generated load.</p>
<p>Importantly though it&#8217;s not just one signature, as there are a number of CPU&#8217;s in your modern computer controling the I/O. And the I/O it&#8217;s self can generate heat and power supply variations as well. One example being the WiFi subsystems.</p>
<p>The problem for the malware writer is the level of work they have to do to get the signatures of user work. They have to do it with out being observed, either directly, or from the side effects of the observation process. Heat is ideal for this because because it uses the thermal mass of various parts of the computer to integrate the work signiture so only very loe bandwidth sampling is needed.</p>
<p>So finding some other signal that naturally integrates user load to keep malware sampling thus it&#8217;s own load signiture low is what a covert (APT type) malware writer is going to be looking for. Especialy if it can be sampled in a non obvious way, thus cannot be easily &#8220;trip wired&#8221; or &#8220;instrumented&#8221; by the defenders.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2016/09/malware_tries_t.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2016/09/malware_tries_t.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2016%2F09%2Fmalware_tries_t.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2016/09/malware_tries_t.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='10803' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2016/09/using_neural_ne.html" rel="prev">‚Üê Using Neural Networks to Identify Blurred Faces</a>		<a href="https://www.schneier.com/blog/archives/2016/09/the_cost_of_cyb.html" rel="next">The Cost of Cyberattacks Is Less than You Might Think ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
