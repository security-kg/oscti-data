<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>New Timing Attack Against RSA - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; New Timing Attack Against RSA Comments Feed" href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1241" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1241' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F11%2Fnew_timing_atta_1.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F11%2Fnew_timing_atta_1.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1241 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1241" class="post-1241 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-copyright tag-cryptanalysis tag-cryptography tag-drm tag-rsa tag-side-channel-attacks">

	<div class="article">

		<h2 class="entry">New Timing Attack Against RSA</h2>
		<p>A <a href="http://eprint.iacr.org/2006/351">new paper</a> describes a timing attack against RSA, one that bypasses existing security measures against these sorts of attacks.  The attack described is optimized for the Pentium 4, and is particularly suited for applications like DRM.</p>
<p>Meta moral:  If Alice controls the device, and Bob wants to control secrets <i>inside</i> the device, Bob has a very difficult security problem.  These &#8220;side-channel&#8221; attacks &#8212; timing, power, radiation, etc. &#8212; allow Alice to mount some very devastating attacks against Bob&#8217;s secrets.</p>
<p>I&#8217;m going to write more about this for Wired next week, but for now you can read the <a href="http://eprint.iacr.org/2006/351.pdf">paper</a>, the <a href="http://it.slashdot.org/article.pl?sid=06/11/18/2030247&#038;from=rss">Slashdot thread</a>, and the <a href="http://www.schneier.com/crypto-gram-9806.html#side">essay</a> I wrote in 1998 about side-channel attacks (also <a href="http://www.schneier.com/paper-side-channel.html">this</a> academic paper).</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/copyright/" rel="tag">copyright</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/drm/" rel="tag">DRM</a>, <a href="https://www.schneier.com/tag/rsa/" rel="tag">RSA</a>, <a href="https://www.schneier.com/tag/side-channel-attacks/" rel="tag">side-channel attacks</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html" rel="bookmark">Posted on November 21, 2006 at 7:24 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html#comments">37 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html" data-title="New Timing Attack Against RSA" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-47731">

			<div class="comment by-greg ">

				<p class="commentcredit">

					<span class="commenter">greg</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47731">
						November 21, 2006 8:32 AM					</a>

				</p>

				<p>Its an interesting attack. In all liklyhood this can be extended to other similar arch types like dual cores. The big question is what about vitual servers?</p>
<p>Also as a defence, what about &#8220;slicing&#8221; the RSA with either other RSA operations with different keys or even extra instructions that affect the branch predictions, putting it all on the same thread/core? ie you take the performance hit to prevent the attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47732">

			<div class="comment by-archangel ">

				<p class="commentcredit">

					<span class="commenter">archangel</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47732">
						November 21, 2006 8:39 AM					</a>

				</p>

				<p>So we are essentially watching the processor and cribbing the math directly.  This works well, if you control the box it&#8217;s being calculated on (legitimately or not).  So I can definitely see the DRM implications, since that&#8217;s entirely local execution.  I can also see the trojan implications, for injection onto a box running RSA that you want plaintext from.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47733">

			<div class="comment by-kaa ">

				<p class="commentcredit">

					<span class="commenter">Kaa</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47733">
						November 21, 2006 10:57 AM					</a>

				</p>

				<p>Spelling nit: devAstating, not devistating. Think of &#8220;vast destruction&#8221; ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47734">

			<div class="comment by-mikea ">

				<p class="commentcredit">

					<span class="commenter">MikeA</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47734">
						November 21, 2006 11:08 AM					</a>

				</p>

				<p>@Kas<br />
Perhaps Bruce was subtly implying that a certain<br />
vendor may be on the Longhorns of a dilemma. ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47735">

			<div class="comment by-tiarnan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.dashes.com/anil/stuff/doctorow-drm-ms.html' rel='external nofollow ugc' class='url'>Tiarnan</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47735">
						November 21, 2006 11:46 AM					</a>

				</p>

				<p>Cory Doctorow&#8217;s talk on DRM at Microsoft for the EFF from a few years ago is the best &#8220;layman terms&#8221; description of why DRM is a disaster I&#8217;ve read. Worth a look.</p>
<p><a href="http://www.dashes.com/anil/stuff/doctorow-drm-ms.html" rel="nofollow ugc">http://www.dashes.com/anil/stuff/doctorow-drm-ms.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47736">

			<div class="comment by-jmr ">

				<p class="commentcredit">

					<span class="commenter">jmr</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47736">
						November 21, 2006 11:52 AM					</a>

				</p>

				<p>What&#8217;s really interesting is that you really don&#8217;t need &#8220;control&#8221; of the box beyond being able to execute code in user-space.  This attack may work against any multi-user system that performs RSA operations, such as Windows Terminal Server or ssh servers.</p>
<p>I wonder if there&#8217;s a simple solution, like replacing the Square &amp; Multiple Exponentiation algorithm:</p>
<p>S[0]=M<br />
S[1]=M<br />
for i from 1 to n-1 do<br />
__S[0]=S[0]*S[0] (mod N)<br />
__S[d[i]]=S[0] * M (mod N)<br />
__S[0]=S[d[i]]<br />
return S[0]</p>
<p>This might work if T(S[d[i]], i=0) = T(S[d[i]], i=1), which requires that S[0] and S[1] be on the same cache line, the CPU to require the same time to execute the relevent underlying machine code, ideally one cycle to perform the dereference and assignment operation, and the CPU not be able to predict data dependencies across those instructions.  This can be verified for target platforms, and additional instructions inserted to force the CPU to not recognize the lack of data dependencies.  (This last might be solved by something as simple as a double-NOT operation on d[i].)</p>
<p>Essentially, all I did was remove the branches, and always performed every calculation using the data itself as the selector for the result rather than input to a branch.  A similar approach could be taken for the Balanced Montgomery Powering Ladder.</p>
<p>The other interesting result of this paper should be a lesson to implementors:</p>
<p>Ensure that your algorithm executes in constant time in all circumstances on the target platform.</p>
<p>Finally, one last lesson:  Reuse existing implementations, as they probably did it better than you will.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47737">

			<div class="comment by-jmr ">

				<p class="commentcredit">

					<span class="commenter">jmr</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47737">
						November 21, 2006 11:54 AM					</a>

				</p>

				<p>I believe the S[1]=M step in my above algorithm is extraneous.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47738">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47738">
						November 21, 2006 12:02 PM					</a>

				</p>

				<p>Not that this is feasible in the short term, but this could be another advantage of reversible computing aside from energy efficiency. That is, reversible computation is immune to side-channel attacks by converting energy dissipation into information that can be kept secret. I think that&#8217;s what side-channel attacks are exploiting, effectively, information (or entropy)thrown out by the system because fundamental computer operations are irreversible.</p>
<p><a href="http://en.wikipedia.org/wiki/Reversible_computing" rel="nofollow ugc">http://en.wikipedia.org/wiki/Reversible_computing</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47739">

			<div class="comment by-thomas-h-ptacek ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.matasano.com/log' rel='external nofollow ugc' class='url'>Thomas H. Ptacek</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47739">
						November 21, 2006 12:31 PM					</a>

				</p>

				<p>I don&#8217;t think this is a timing attack; it&#8217;s a side-channel attack that exploits the fact that OpenSSL&#8217;s  impact on the branch prediction cache leaks information. The only &#8220;timing&#8221; done here is to determine whether a jump address is in the BTB or not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47740">

			<div class="comment by-fred-p ">

				<p class="commentcredit">

					<span class="commenter">Fred P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47740">
						November 21, 2006 1:18 PM					</a>

				</p>

				<p>@Joe &#8211; Yes; reversible computing could defend against a host of present side-channel attacks. However, with little or no entropy, it would appear (to someone unfamiliar with the field) that you&#8217;d open up other attacks: 1) reading the data that has not changed; 2) running the executed algorithm in reverse (thus likely obtaining the original inputs).</p>
<p>I would think that at least for a device that is supposed to be secure against its owner, reversible computing won&#8217;t help. It might against someone who merely uses processing time on that device in a networked system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47741">

			<div class="comment by-benny ">

				<p class="commentcredit">

					<span class="commenter">Benny</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47741">
						November 21, 2006 1:35 PM					</a>

				</p>

				<p>@ Tiarnan:</p>
<p>That was a great read, thanks for the link ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47742">

			<div class="comment by-jmr ">

				<p class="commentcredit">

					<span class="commenter">jmr</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47742">
						November 21, 2006 2:55 PM					</a>

				</p>

				<p>@Thomas H. Ptacek:</p>
<p>It is a timing attack in that the operations performed do not take a predetermined amount of time irrespective of the data being operated on.  An implementation free of timing attacks would take the same clock time for each operation irrespective of the data and non-interrupt outside influences (eg, you should be able to stop and restart the process without being able to determine where in the process the code is presently executing [without having a debugger attached to the process]).  Current implementations fail this test.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47743">

			<div class="comment by-nzruss ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.nzruss.blogspot.com' rel='external nofollow ugc' class='url'>nzruss</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47743">
						November 21, 2006 4:36 PM					</a>

				</p>

				<p>Please correct me if I read it wrong, but it appears the attacking &#8216;process&#8217; requires access to the very processor doing the RSA crunching. And while the attack still works with a hyper-threaded single CPU, there is no mention of the attack working across two distinct CPUs (within one computer). (or did I miss it?)</p>
<p>While some dual core (Intel and AMD) CPU&#8217;s have the CPU&#8217;s closely tied, Intel&#8217;s early dual core processors were still separated by the north-bridge. (And, I understand the current 4 core processor separates two of the cores by the north-bridge.)</p>
<p>So, I would have thought you could prevent this side channel attack by:</p>
<ul>
<li>Ensure at least two of the CPU&#8217;s are separated by the North Bridge, or similar.</li>
<li>Temporarily dedicate one side of the bridge solely to RSA execution. (and no other, or only &#8216;trusted&#8217; processes.) </li>
<li>Still employ traditional side channel spoofing methods to mask traffic to and from the bridge to the &#8216;insecure&#8217; CPU. </li>
</ul>
<p>Would this work?</p>
<p>I&#8217;m only an armchair enthusiast, so may have missed a critical piece of understanding, and would welcome any comments from the experts.</p>
<p>NZRuss.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47744">

			<div class="comment by-jmr ">

				<p class="commentcredit">

					<span class="commenter">jmr</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47744">
						November 21, 2006 4:54 PM					</a>

				</p>

				<p>@NZRuss:</p>
<p>I didn&#8217;t see anything about the attack working across distinct processors.  I can imagine, however, that the cache synchronization protocols may reveal timing information if the code spans multiple cache lines.  I&#8217;d have to look into the low level cache synchronization protocol to know for sure.</p>
<p>The solution that seems to have the least risk to me is to write the software in a time-independent fashion entirely, by executing every instruction and having every conditional operation access a cache line whether the result is discarded or not.</p>
<p>The fundamental notion I propose is to speculatively execute every calculation, reading all inputs from near-identical memory locations (same cache line), storing both results of the calculation into near-identical memory locations (same cache line), and choosing which result to continue with based on the data under examination, without using branch instructions.  This might be a tall order, but I think it&#8217;s achievable with effort.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47745">

			<div class="comment by-thomas-h-ptacek ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.matasano.com/log' rel='external nofollow ugc' class='url'>Thomas H. Ptacek</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47745">
						November 21, 2006 8:52 PM					</a>

				</p>

				<p>jmr:</p>
<p>You&#8217;re not describing the attack in the paper, you&#8217;re describing timing attacks in general. This attack relies on a (binary) timing difference between operations wholly unrelated to OpenSSL, which are influenced by OpenSSL&#8217;s impact on the cache.</p>
<p>Branch prediction delays are timeable, but I&#8217;m not sure that&#8217;s really the attack here. The side channel is the state the CPU keeps about what branches have been predicted, not the amount of time the OpenSSL operations take.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47746">

			<div class="comment by-anon655 ">

				<p class="commentcredit">

					<span class="commenter">Anon655</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47746">
						November 22, 2006 5:48 AM					</a>

				</p>

				<p>Bruce: that cannot be correct. We know that Alice will not attack Bob by definition. It&#8217;d have to be someone else &#8211; like Eve or Mallory!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47747">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47747">
						November 22, 2006 8:08 AM					</a>

				</p>

				<p>@jmr</p>
<p>Timing / side channel attacks have been known for a very long time and are reputed to have been the first reliable Tempest attack (see history behind the British / Canadian Rockex crypto system).</p>
<p>The usual thing you get told about Tempest is it&#8217;s all about Energy / Bandwidth, what they tend not to tell you is in which direction your clock signal should propergate through your equipment&#8230; (along with a few other gems of what turn out to be common sense).</p>
<p>Basically if you either clock your system from the output or re-clock at the output, the majority of timing attacks won&#8217;t work.</p>
<p>The reason they do work and are not likley to go away is that engineers etc always try to squeeze the last drop of performance out by using non synchronus devices and software.</p>
<p>Therefore the timing delays of different execution branches / cache hits-misses etc show up at an output (network / PSU / front pannel LEDs) in a repeatable way that alows an attacker to corelate out useful information.</p>
<p>As has been observed in the past (by the initiates) &#8220;it ain&#8217;t rocket science&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47748">

			<div class="comment by-rich ">

				<p class="commentcredit">

					<span class="commenter">Rich</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47748">
						November 22, 2006 8:11 AM					</a>

				</p>

				<p>Attack Summary</p>
<p>Given: known algorithm (code), multithreaded processor sharing BTB<br />
Goal: find private key</p>
<p>BTB is the Branch Target Buffer which is a cache of taken-branch targets</p>
<p>Algorithm:<br />
Create a spy program which keeps the BTB full.  Run the spy program and encryption algorithm (RSA) at the same time on the same processor (multithreaded CPU requirement).  Every time RSA takes a branch it replaces a spy-program&#8217;s branch in the BTB (shared BTB requirement).  The spy-program can notice its delay on its branch which RSA replaced in the BTB so it can know which RSA branches are taken (know RSA code requirement).  Since RSA branches on key bits the key bits can be determined.</p>
<p>Observations: BTB is not shared across multicores.  Caches are sometimes shared and side-channel information can be derived, but it is the L2 cache which is shared so the level of detail available in watching an L2 cache is much less than one gets from the BTB.  The last time I checked, AMD multicores are not multithreaded, but Intel, IBM, and Sun multicores are multithreaded.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47749">

			<div class="comment by-supersnail ">

				<p class="commentcredit">

					<span class="commenter">supersnail</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47749">
						November 22, 2006 8:21 AM					</a>

				</p>

				<p>&#8220;Bruce: that cannot be correct. We know that Alice will not attack Bob by definition. It&#8217;d have to be someone else &#8211; like Eve or Mallory!&#8221;</p>
<p>Not true in the DRM case; Alice is a good girl who is just trying to get access to something she already owns. The bad guy is William who infected the system with DRM in the first place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47750">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47750">
						November 22, 2006 8:25 AM					</a>

				</p>

				<p>@Fred P: My understanding of side-channel attacks was that the entropy of the system was used as information to discover secrets and this information was difficult to obfuscate because people don&#8217;t usually consider entropy as information that needed to be protected. Once we consider that entropy itself was information that could be used to attack a system, then we could device ways to obfuscate it.</p>
<p>So, perhaps, instead of switching to reversible computers to defend against side-channel atacks, I would suggest that the models used to think about reversibility be used in thinking about the overall security of a system. That is, reversible computers approach information processing as physical systems not just logical systems. The strength of RSA itself relies on the physical constraints of current computing technology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47751">

			<div class="comment by-supersnail ">

				<p class="commentcredit">

					<span class="commenter">supersnail</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47751">
						November 22, 2006 8:40 AM					</a>

				</p>

				<p>Its very easy to extrapolate this into a pratical key gathering system.</p>
<ol>
<li>Run n attacks on a known key.</li>
<li>Analyise the results to identify the timing signature of the processing of the before the known key. (probably key setup etc.)</li>
<li>Run your process continuously.</li>
<li>When the &#8220;signature&#8221; sequence is detected the following sequence will identifiy an unknown key.</li>
</ol>
<p>Over time you will capture some of the keys which were used on the shared processor (baring in mind that the spy process will probably be shunted between cpus several times!, and, on a busy machine other processes will disrupt the timing measurements so you may fail  recognise the &#8220;signature&#8221; perhaps 90% of the time ).</p>
<p>If the &#8220;secret&#8221; keys are used several times (several being 100s not 1000s)<br />
then you could easily extract most of the keys with a relativley short run<br />
(a couple of hours!).</p>
<p>You would then be faced with the rather unusual (but relatively trivial) cryptographic problem of having all the keys but no idea which locks they belong to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47752">

			<div class="comment by-jmr ">

				<p class="commentcredit">

					<span class="commenter">jmr</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47752">
						November 22, 2006 12:42 PM					</a>

				</p>

				<p>@Thomas:</p>
<p>While the attack is against the BTB, the measurement of the attack is time.  I propose that a simple way to eliminate an entire class of attacks that work by measuring time is to audit the code for each indeterminate-time operation and eliminate them, considering time indeterminance over an entire system rather than an isolated piece, and over individual operations rather than composite cryptographic operations.  Finally, I offer a specific implementation of the Square and Multiple Exponentiation Algorithm that possibly mitigates the measurement of the attack on current system implementations.  I fail to see how my suggestions are irrelevent to the attack described in this paper, as I believe those suggestions both eliminate this particular attack vector and other known vectors that work by measuring time.</p>
<p>There may also be other attacks that can be prevented by generalizing my suggestion somewhat.  I would suggest that ALL operations consume equal amount of resources, and to perform every operation on every data element.  For example, if performing a multiplication takes more power than an addition, then perform both the multiplication and the addition.  If taking one jump instruction takes a different amount of time from taking another jump instruction, then take both jumps.  If accessing one memory location may take a different amount of time from accessing another memory location, and the memory is accessed in a data-dependent way, then access both memory locations.  Use speculative execution techniques to discard unneeded results without having to execute different instruction sequences.</p>
<p>As experience is gained, we (humanity) can arrive at a list of resources that must be audited in each cryptographic primitive implementation.  We should have a comprehensive test plan for cryptographic primitives utilizing all known attack vectors.  One class of attacks is resource utilization, and we can add, over time, to the list of resources that the primitives consume and produce.  That may be BTB cache space, memory, time, power, heat, sound, bus access, memory cache,  etc.</p>
<p>True, I am not talking about the particular attack on the BTB, but presenting a methodology for eliminating many side-channel attacks on cryptographic primitives, both known and unknown.</p>
<p>@Clive:</p>
<p>Yes, as long as the prime motivating factor in implementing cryptographic primitives is performance, side channel attacks will be prevalent.  When the top priority becomes security, side channel attacks will gradually disappear.  My specific implementation suggestion takes longer on most platforms than algorithms optimized for speed, but my implementation doesn&#8217;t leak information.  I would suggest that people implementing cryptographic primitives be more concerned with security than speed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47753">

			<div class="comment by-fred-p ">

				<p class="commentcredit">

					<span class="commenter">Fred P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47753">
						November 22, 2006 2:01 PM					</a>

				</p>

				<p>@Joe-</p>
<p>I think that this paper (along with others) shows that cryptographic security is not a major consideration (and/or competence) of general-purpose CPU designers. As an example, removing Branch Prediction from the chip design (or enabling turning it off for the duration of the cryptography) would protect against this particular attack, as would preventing other threads from being on this processor for the duration.</p>
<p>My main concern with controlling entropy is that doing so in the most trivial conceptual way (nearly eliminating it) would likely open you up to another set of attacks. However, there may be better approaches. Trying to keep entropy essentially constant (but not particularly low) might help.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47754">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47754">
						November 23, 2006 7:49 AM					</a>

				</p>

				<p>@Fred P</p>
<p>&#8220;shows that cryptographic security is not a major consideration (and/or competence) of general-purpose CPU designers&#8221;</p>
<p>There is actually no reason why it should be, it is not where the problem is&#8230;</p>
<p>If you design high performance motorbikes for performance track racing, you will find little of your &#8220;specialised&#8221; work related to designing garbage collection vehicals.</p>
<p>Crypto hardware is of it&#8217;s self a very specialised field of endevor it rarely involves designing for high speed/utilisation. Processor design on the other hand does.</p>
<p>The four problems we have today that impact security are,</p>
<p>1) We have general purpose CPU&#8217;s that are as capable as specialised crypto processors, but at considerably lower price by several orders of magnitude.</p>
<p>2) We have a need to use strong crypto in modern society at the &#8220;grass roots&#8221; level.</p>
<p>3) Engineers invariably make do with what is available and pragmatic to get systems &#8220;just working&#8221; for the modern high churn markets.</p>
<p>4) Product development engineers lack any kind of specialised training in security engeneering&#8230;</p>
<p>The last point is a que to Bruce &amp; Niels / Ross / Adam &amp; Moti to plug their respective books ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47755">

			<div class="comment by-kevq ">

				<p class="commentcredit">

					<span class="commenter">KevQ</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47755">
						November 23, 2006 5:09 PM					</a>

				</p>

				<p>Would unrolling the loop somewhat help to reduce the effectiveness of this attack?  I&#8217;m thinking it would cause many more branch instructions to be fed to the BTB blocks during execution, thus making it harder to deduce from the misprediction times the value of &#8216;i&#8217; on the spy misprediction:</p>
<p>R0 = 1; R1 = M<br />
i=0<br />
while (i+S)&lt;(n-1) do<br />
[calculate d(i)]<br />
[calculate d(i+1)]<br />
&#8230;<br />
[calculate d(i+S-1)]<br />
i = i + S<br />
endwhile<br />
[calculate d(i<em>S)]<br />
[calculate d(i</em>S+1)]<br />
&#8230;<br />
return R0</p>
<p>(where S is a fixed number known at compile time)<br />
If this sort of thing does have an impact, it could be improved by implementing many different versions of the loop with different &#8216;S&#8217; (even providing paths that break the calculation up in to several sections with different &#8216;S&#8217;), and choosing which gets executed at random on each execution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47756">

			<div class="comment by-charles ">

				<p class="commentcredit">

					<span class="commenter">Charles</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47756">
						November 23, 2006 7:35 PM					</a>

				</p>

				<p>One of the problems I&#8217;m seeing is that cryptography has reached a point where you need reliable results quickly. In other words, you can&#8217;t just do it right (go too slow in an environment where you&#8217;re called frequently and you end up with a backlog) and you can&#8217;t just do it fast (obviously because you&#8217;re prone to mistakes)&#8211;you need to do it right and fast at the same time: a double-hard order since doing one makes it harder to do the other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47757">

			<div class="comment by-klaas-pieter ">

				<p class="commentcredit">

					<span class="commenter">Klaas-Pieter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47757">
						November 24, 2006 4:55 AM					</a>

				</p>

				<p>Wouldn&#8217;t it be sufficient to add noise, in the form of randomly executed code, to the executable algo code? (The algo code would then be obfuscated)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47758">

			<div class="comment by-martin ">

				<p class="commentcredit">

					<span class="commenter">Martin</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47758">
						November 24, 2006 5:38 AM					</a>

				</p>

				<p>I haven&#8217;t kept up-to-date with processor architectures, so my thinking may be a bit 8086-ish, but doesn&#8217;t simply disabling interrupts for the period of execution of the algorithm solve the problem?<br />
If this has too many undesirable side-effects, breaking the algorithm down into several interrupt-disabled chunks may help.<br />
Apologies if this proves to be a naive observation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47759">

			<div class="comment by-copsewood ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://copsewood.net' rel='external nofollow ugc' class='url'>copsewood</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47759">
						November 24, 2006 7:40 AM					</a>

				</p>

				<p>I think there might be a connection between this type of attack and traffic analysis, in the sense that the countermeasures to both are very similar: introduce false traffic into the system so information about who is talking to whom and when, or the signatures of cryptographic primitive (e.g. modular multiplication and exponentiation) operations within the system are obscured by the additional traffic. These countermeasures are equally impractical, because both require suboptimal use of the shared system, or for this system to be totally dedicated to the traffic to be protected (communications network in the case of traffic analysis or the CPU to protect against this attack).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47760">

			<div class="comment by-werner ">

				<p class="commentcredit">

					<span class="commenter">Werner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47760">
						November 24, 2006 8:02 AM					</a>

				</p>

				<p>How to prevent such an attack?</p>
<p>Possible if the algo does not use ifs. Then both paths are always computed (no different memory locations, no branch prediction).</p>
<p>Some sample in pseudo code</p>
<p>if ((a and 1)=1)<br />
  b := c;</p>
<p>will be transformed to</p>
<p>mask := (a and 1) &#8211; 1 # 0 or -1 (all bits set)</p>
<p>b := (mask and b) or (not mask and c)</p>
<p>Then there are no differences in the execution expect from differences in the calculation of c.</p>
<p>This will cost performance, but will hopefully increase securty.</p>
<p>Hope it is understandable, I am not used to write in english.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47761">

			<div class="comment by-taneli-huuskonen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.helsinki.fi/~huuskone/' rel='external nofollow ugc' class='url'>Taneli Huuskonen</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47761">
						November 25, 2006 2:16 PM					</a>

				</p>

				<p>@Werner:</p>
<p>Yes, that&#8217;s a good idea.  Besides, instead of</p>
<p>b := (mask and b) or (not mask and c)</p>
<p>you can use</p>
<p>b := ((b xor c) and mask) xor c</p>
<p>and thereby save an operation and a register. ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47762">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47762">
						November 26, 2006 4:30 PM					</a>

				</p>

				<p>OpenSSL isn&#8217;t actually vulnerable to this attack; the paper modified the code to make it vulnerable.  Recent versions of OpenSSL use a fixed-window exponentiation scheme: compute c^i for i in 0..2^k-1.  Then repeatedly square, and every k steps, multiply by c^i for the appropriate i.  To make memory accesses independent of the key, it also interleaves the table of c^i values within cache lines.</p>
<p>There still is at least one key-dependent branch in OpenSSL, in the Montgomery reduction algorithm.  But hopefully, you can&#8217;t gain any information from the Mongomery reductions, because OpenSSL uses blinding too: multiply by r^e before decrypting, and then divide by r at the end.</p>
<p>All these tricks make OpenSSL kind of slow: RSA as implemented by GMP is much faster.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47763">

			<div class="comment by-void-runner ">

				<p class="commentcredit">

					<span class="commenter">Void Runner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47763">
						November 27, 2006 3:44 PM					</a>

				</p>

				<p>A dumb question (no rotten tomatoes, please):</p>
<p>When cryptographic procedures are running  whithin an isolated &#8220;sandbox&#8221; virtual (emulated) system that involves emulating a processor (think QUEMU), are they still vulnerable to side chanel attacks like this one?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47764">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47764">
						November 28, 2006 3:13 PM					</a>

				</p>

				<p>@Void Runner</p>
<p>&#8220;When cryptographic procedures are running whithin an isolated &#8220;sandbox&#8221; virtual (emulated) system that involves emulating a processor (think QUEMU), are they still vulnerable to side chanel attacks like this one?&#8221;</p>
<p>Not a dumb question at all.</p>
<p>The answer depends on the design, not just of the processor but of the overall system.</p>
<p>IF you can prevent one process in a system effecting another (which is extreamly difficult) then it does not have the potential to leak information, otherwise it does which is your &#8220;side channel&#8221;.</p>
<p>This leads to the next question which is, &#8220;Does the side channel have sufficient bandwidth to communicate usable information&#8221;. Again if not then no usefull information leakes to the other process.</p>
<p>For example, one &#8220;off the wall&#8221; way a process may effect another is by causing the CPU to heat up and change the XTAL frequency that drives the CPU. It has been shown that you can get about eight bits of information an hour down this channel when viewed remotly across a network. Obviously a process running in the same system or CPU is likley to have a larger bandwidth, but again is there sufficient bandwidth in this or other methods.</p>
<p>The answer to this depends on many things, but if you get 1 bit for every use of the private key then after X usages you have sufficient information to reconstruct the key Dan Coppersmith estimated 25% of bits for full recovery (just wish I could remember the citation).</p>
<p>So on a busy web server it might take a day or less to get enough bits to make a search, depending on the channels available.</p>
<p>The next issue is even if a channel has insufficient bandwidth can it be used in agrigate with other channels&#8230;</p>
<p>The real problem from the defenders point of view however as this paper shows is not &#8220;IF you can use a channel&#8221; but &#8220;IF you can identify all channels and limit their use&#8221;.</p>
<p>As I said further up the blog only if you use appropriate design not just in hardware but in software as well, which most commodity systems do not.</p>
<p>So the answer to your question is very probably yes, you just have to find the side channel and exploit it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47765">

			<div class="comment by-void-runner ">

				<p class="commentcredit">

					<span class="commenter">Void Runner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47765">
						November 30, 2006 3:34 AM					</a>

				</p>

				<p>@Clive Robinson<br />
So basicaly a Virtual Machine enviroment, unless specificaly designed with side-channel protection in mind, is very likely to have its own side chanels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47766">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47766">
						November 30, 2006 7:16 AM					</a>

				</p>

				<p>@Void Runner,</p>
<p>&#8220;a Virtual Machine enviroment, unless specificaly designed with side-channel protection in mind, is very likely to have its own side chanels.&#8221;</p>
<p>I would be a bit broader than that and say,</p>
<p>&#8220;Any system is very likely to have its own unknown (to the designer) side channels&#8221;</p>
<p>The problem is side channels are very very difficult to design out of a system.</p>
<p>And problem number one is you have to be aware it&#8217;s possible to have one in XXXX manner, before you can design it out.</p>
<p>Also new side channel methods YYYY come up all the time as technology develops. So YYYY is always something that is known after the event, so it is more by luck than judgment you protect against it&#8230;</p>
<p>The usuall solution employed is the &#8220;two screened box&#8221; solution where,</p>
<p>1) you put your system into a closed environment (electricaly screened) and you very strictly control the inputs and the outputs with filters etc. Any decent book on EMC will show you this much.</p>
<p>2) Additionaly all inputs and outputs need to be re-clocking to prevent a range of time related attacks (think PWM / PPM / DSSS etc).</p>
<p>3) You then put this resulting system inside another electricaly screaned box.</p>
<p>4) Then there is the aditional problem of power supply / galvanic issolation, lead radiation / coupling, likewise for magnatic and achostic etc etc.</p>
<p>5) Also you do not bring any indicators out unless they likewise have been re-clocked and filtered&#8230;</p>
<p>A UK BID cipher machine had the unfortunate property that the output from it&#8217;s internal stream generator was brought to the front pannel as a health status light.</p>
<p>It has since been discussed that a similar problem with a comercial cipher system in computer centers with glass walls in banks might well have been responsable for confidential data leakage, in that there where red &amp; green channel LEDS directly connected to the data lines and you only needed a telescope and photodetector connected to a scope to see the results (Ouch).</p>
<p>As has been said &#8220;it ain&#8217;t rocket science&#8221; but it &#8220;sure ain&#8217;t easy&#8221; and you have to be able to think &#8220;off the wall&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47767">

			<div class="comment by-void-runner ">

				<p class="commentcredit">

					<span class="commenter">Void Runner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/#comment-47767">
						December 1, 2006 2:27 PM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>&#8220;Additionaly all inputs and outputs need to be re-clocking to prevent a range of time related attacks (think PWM / PPM / DSSS etc).&#8221;</p>
<p>I guess that is exactly what can be done by mean of a Virtual Machine with an emulated processor!<br />
Even more, certain intricacies of such re-clocking within an emulated computational environment can be set manualy by the admin of each system (server), thus, the arising side-channel phenomena (and we assume they might still be present) will differ from one machine to another greatly, as the will be relevant not only to the hardware, but also to the software, which will be fine-tuned slightly differently on each machine.<br />
What do you think of this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2006/11/new_timing_atta_1.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2006/11/new_timing_atta_1.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F11%2Fnew_timing_atta_1.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2006/11/new_timing_atta_1.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1241' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2006/11/rfid_passports_1.html" rel="prev">â† RFID Passports Less Reliable than Traditional Passports</a>		<a href="https://www.schneier.com/blog/archives/2006/11/tsa_security_ro_1.html" rel="next">TSA Security Round-Up â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
