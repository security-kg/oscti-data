<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Intentional Flaw in GPRS Encryption Algorithm GEA-1 - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Intentional Flaw in GPRS Encryption Algorithm GEA-1 Comments Feed" href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.5' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.8.1/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/63380" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=63380' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F06%2Fintentional-flaw-in-gprs-encryption-algorithm-gea-1.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F06%2Fintentional-flaw-in-gprs-encryption-algorithm-gea-1.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-63380 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">

					<a class="mobile-menu-toggle" href="#">
						Menu						<span class="mobile-menu-toggle__icon"></span>
					</a>

					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-63380" class="post-63380 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-algorithms tag-backdoors tag-cryptanalysis tag-encryption">

	<div class="article">

		<h2 class="entry">Intentional Flaw in GPRS Encryption Algorithm GEA-1</h2>
		<p>General Packet Radio Service (GPRS) is a mobile data standard that was widely used in the early 2000s. The first encryption algorithm for that standard was GEA-1, a stream cipher built on three linear-feedback shift registers and a non-linear combining function. Although the algorithm has a 64-bit key, the effective key length is only 40 bits, due to &#8220;an exceptional interaction of the deployed LFSRs and the key initialization, which is highly unlikely to occur by chance.&#8221;</p>
<p>GEA-1 was designed by the European Telecommunications Standards Institute in 1998. ETSI was &#8212; and maybe still is &#8212; under the auspices of <a href="https://sogis.org/">SOGIS</a>: the Senior Officials Group, Information Systems Security. That&#8217;s basically the intelligence agencies of the EU countries.</p>
<p>Details are in the paper: &#8220;<a href="https://eprint.iacr.org/2021/819">Cryptanalysis of the GPRS Encryption Algorithms GEA-1 and GEA-2</a>.&#8221; GEA-2 does not have the same flaw, although the researchers found a practical attack with enough keystream.</p>
<p>Hacker News <a href="https://news.ycombinator.com/item?id=27529768">thread</a>.</p>
<p>EDITED TO ADD (6/18): News <a href="https://www.vice.com/en/article/4avnan/bombshell-report-finds-phone-network-encryption-was-deliberately-weakened">article</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/algorithms/" rel="tag">algorithms</a>, <a href="https://www.schneier.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html" rel="bookmark">Posted on June 17, 2021 at 1:51 PM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html#comments">26 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html" data-title="Intentional Flaw in GPRS Encryption Algorithm GEA-1" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-381842">

			<div class="comment by-dillweed ">

				<p class="commentcredit">

					<span class="commenter">Dillweed</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381842">
						June 17, 2021 2:39 PM					</a>

				</p>

				<p>Own the Net is a mantra by most countries that do  monitoring and what sap thinks that VPN and encryption will really protect you&#8230;..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381850">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381850">
						June 17, 2021 3:33 PM					</a>

				</p>

				<p>Todays Special:  Stingray Baked Beans cooked at 2G. You can smell them cooking a mile away! Spicy!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381853">

			<div class="comment by-echo ">

				<p class="commentcredit">

					<span class="commenter">echo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381853">
						June 17, 2021 3:58 PM					</a>

				</p>

				<p>Effective 40 bit keys reminds me of the DES fiasco. I know nothing of the maths but I suppose it may be an interesting exercise for some to reverse engineer what mathematical skills and knowledge some people would need to push this through. I&#8217;m guessing that may be wildly entertaining for some and more interesting than the standard itself. What might this suggest of people&#8217;s abilities today? I have no idea.</p>
<p>The office politics and politics comments in the Kacker News thread are interesting as they note governance and human rights issues which itself is a wider security context.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381861">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381861">
						June 17, 2021 11:22 PM					</a>

				</p>

				<p>@echo:</p>
<p>An interesting difference between DES and GEA-1, is the degree of concealment.</p>
<p>The downgrading of DES was done with some smokescreen about &#8220;parity bits,&#8221; which didn&#8217;t deceive academic cryptographers.  They knew it had been deliberately weakened, and some yelled about it in public.</p>
<p>By contrast, the weakening of the stream cipher was done subtly, and I suppose required some serious expertise to carry out.</p>
<p>Although the technique probably hasn&#8217;t been studied as much as it deserves, there&#8217;s good reason to expect that nonlinear combinations of LFSR outputs can be used to make a stream cipher which is highly resistant to cryptanalysis.  At face value, GEA-1 looked solid.</p>
<p>This kind of tricky &#8220;backdooring&#8221; is what keeps some folks awake at night, wondering what and whom they can trust.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381863">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381863">
						June 17, 2021 11:40 PM					</a>

				</p>

				<p>@ MarkH</p>
<p>Is there really any reason to trust a stream cipher to not leak?</p>
<p>Especially, with a sufficient amount of traffic.</p>
<p>I guess what I am saying, is there really any proof that stream ciphers are truly secure and can not leak?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381864">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381864">
						June 18, 2021 12:24 AM					</a>

				</p>

				<p>@ ALL,</p>
<p>If you are going to read the paper start with ¬ß5 Discussion it will make life easier if your domain knowledge on LFSRs and Waslsh Functions is limited.</p>
<p>In section five you will find qialification of the &#8220;Bob Morris Retirment Observation&#8221; about &#8220;Known plaintext&#8221; which when you see how little is needed and how sparse it can be might teach you a lesson about why Microsoft File formats were the way they were in the late 1980&#8217;s onvards, also why EXE fole format likewise is bad news.</p>
<p>But whilst the paper dances around the issue, like the more well known A5/1 and A5/2 debacle the GEA-1 and GEA-2 issues are the result of France&#8217;s Crypto Policy. Which in turn is based on France&#8217;s Security Services spying not on Criminals and Terrorosts that might get some &#8220;public support&#8221;, but foreign Companies which would not. France has done this as &#8220;policy&#8221; going back at least as far as the end of WWII to supply &#8220;competitive advantage&#8221; to the &#8220;Chosen Few&#8221; French companies, that various French politicians had &#8220;intetrsts in&#8221; if not directly then through family (look back over various corruption scandals to see some of them mapped out).</p>
<p>France very deliberately manipulated the communications standards to enable easy corruption at very senior levels of the French Government which should have produced European wide if not world wide condemnation. It did not which should speak volumes to people about what goes on in other European countries especially the UK as you can see GCHQ&#8217;s grubby fingerprints all over the A5 and GRA algorithms[1].</p>
<p>But from a more technical perspective, I point out from time to time that two of the issues of crypto standards that should realy wake people up are,</p>
<p>1, They all have a short operational shelf life of less than a quater of a century.</p>
<p>2, They get &#8220;baked in&#8221; to hardware the operational shelf life of which is greater than a quayer of a century and could be more than half a century.</p>
<p>This should realy cause people to stop and think about all these &#8220;Crypto Contests&#8221; run by Standards bodies that are &#8220;advised&#8221; by Security Service Agencies.</p>
<p>But the Security Services know as I do and have said systems are upgraded by augmenting ONLY. That is dangerous legacy algorithms remain available and can be accessed by the equivalent of &#8220;man in the middle&#8221; techniques that cause &#8220;Fall Back Attacks&#8221; to be easily and usually invisably to users forced into the weakest security. This is supppsadly for &#8220;legacy compatability / interoperation&#8221; but that is just a well worn excuse as part of &#8220;finessing&#8221;.</p>
<p>If you look at A5/1, A5/2 and GRA-1, GEA-2 you can clearly see that the &#8220;second&#8221; supposedly more secure algorithms are intimately tied to the &#8220;first&#8221; very weak security algorithms, thus you do not get one without the other&#8230;</p>
<p>That is the Security Services know full well that designing a new set of hardware / firmware to remove the weak algorithm will not happen even if required by a &#8220;Standards Authority&#8221; at best the manufactures will put a &#8220;high level software block&#8221; in that will get it past &#8220;Testing&#8221; but the security services know such a block can be trivially removed by a simple Over The Air(OTA) update or hack via an application or OS bypass.</p>
<p>People should remember this when they hear about the clumsy bumblings of Law Enforcment who attack encrypted phones and applications and even set up fake supplies of such systems.</p>
<p>That is all those &#8220;secure&#8221; Smart devices have multiple vulnerabilities already &#8220;finessed in&#8221; by the security services who infest standards bodies before Law Enforcment slap another layer of insecurities on top of that&#8230;</p>
<p>It&#8217;s why I advise not just clients but everybody to &#8220;Move the Security End Point well beyond the Communications End Point&#8221;. Because if you don&#8217;t then &#8220;You have no security&#8221;. Thus to be secure you have to forgo the &#8220;conveniance&#8221; of single device operating, because all &#8220;Smart Devices&#8221; and any other &#8220;consumer electronics with communications capability&#8221; are riddled with easy &#8220;end run attacks&#8221; around any high grade algorithms or other security you care to put on them. That is &#8220;No Consumer Electronics Device can be secure ever&#8221;&#8230;</p>
<p>So nor can any OS or Apps upon Consumer Electronics no matter what they claim.</p>
<p>To be secure with consumer electronic devices you have two clear, but stark choices,</p>
<p>1, Take the security end point off of the device.<br />
2, Stop the communications end point on the device being available.</p>
<p>Preferably do both.</p>
<p>Look back on this blog where I&#8217;ve described how to do both at length in the past.</p>
<p>[1] If you are wondering why they are &#8220;stream ciphers&#8221; not &#8220;block ciphers&#8221; you will get told something that whilst true is actually a lie hidden in plain sight. You will be told they have advantages in commubications because of XXX where XXX is a whole bunch of reasons. But what is being hidden is that whilst some European Security Services intimately understand &#8220;Stream Ciphers&#8221; the various Open and academic comunities almost always go with block ciphers. Which can fairly easily be turned into stream ciphers algorithmically, but the result is very inefficient. So the security services have a nice big wide playing field that they effectively control and can get away with just about anything they want to in the way of security weakening. Because outside of their closed world few have any understanding or depth in the knowledge domain of stream ciphers&#8230; If you doubt this go have a look at the NESSIE crypto competition history.</p>
<blockquote><p><i>None of the six stream ciphers submitted to NESSIE were selected because every one fell to cryptanalysis. This surprising result led to the eSTREAM project.</i></p></blockquote>
<p><a href="https://en.m.wikipedia.org/wiki/NESSIE" rel="nofollow ugc">https://en.m.wikipedia.org/wiki/NESSIE</a></p>
<p>To be honest don&#8217;t hold your breath on eSTREAM either, there were over thirty entrants and less than one fifth were not found to have major failings. Of those that survive, I realy do not expect any of them to last a couple of decades untill they are broken. Especially those that would be attractive for long life products such as Smart Meters and Implantable Medical Electronics&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381866">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381866">
						June 18, 2021 1:42 AM					</a>

				</p>

				<p>@ SpaceLifeForm, MarkH,</p>
<blockquote><p>I guess what I am saying, is there really any proof that stream ciphers are truly secure and can not leak?</p></blockquote>
<p>Empirical evidence of non secret stream ciphers suggests very much not.</p>
<p>Now lets take a 20,000ft view as a start to a theoretical view,</p>
<p>1) A stream cipher generator has no changing random element to it.</p>
<p>2) A stream cipher &#8220;key&#8221; is just an offset, that changes the starting point of the generator not how the generator produces output.</p>
<p>3) A stream cipher has only three parts,</p>
<p>3.1) A counter.<br />
3.2) A mapping function[1].<br />
3.3) A linear mixer function.</p>
<p>4) The only random element is in the plaintext and that is usually highly predictable with strong easily recognisable statistics.</p>
<p>So the only real security comes from that mapping function&#8230;</p>
<p>The problem is to get the level of security required means that the mapping function has to be highly non linear it has to do it over a range of four times or more the number of bit of an equivalent block cipher[2]. So AES 256 equivalent requires a stream cipher with a counter of atleast 1024bits.</p>
<p>But&#8230; You should consider the maximum run length issue as well. With a stream cipher it boils down to 3W-2 that is think of the all zero state output, the output before has to differ by atleast one bit likewise the next output. So the maximum run length of zeros over those three outputs would be,</p>
<p>100&#8230;000,000&#8230;000,000&#8230;001</p>
<p>So realy you should be thinking of 12 times the block cipher key bit width. Or for AES-256 equivalent 3072 bit counter and map width. As the mapping function has to be complex needing a very very high &#8220;gate equivalence&#8221; complexity you can quickly see how the effective gate count in the mapping function would be immense.</p>
<p>So yes you would expect stream ciphers to not be very good security wise from the theoretical point of view as well.</p>
<p>Yes there are tricks to get a non-linear complexty with less gates but you then need to consider how you pick the points on the linear Walsh Map to give you that non-linear complexity with reduced gate count and that can be hard very hard and it&#8217;s not a well studied area in the Open community.</p>
<p>Also because of the &#8220;known plaintext&#8221; issue you should consider two other things,</p>
<p>1, A very nonlinear mixing function of large alphabet size.</p>
<p>2, Use the stream cipher in a nonlinear feedback or feedforward mode.</p>
<p>By which time any perceived advantages of a stream cipher over a block cipher have diminished astoundingly or compleatly vanished.</p>
<p>And that&#8217;s all before we have left the 20,000ft view point to start getting into actual theory.</p>
<p>[1] Any binary maping linear or not can be replaced withba Walsh or Sequency map of XOR gates. The simple example you are most likely to come across is the &#8220;Grey Code&#8221; map where there is one XOR gate for every bit of map width configured in a cascade.</p>
<p><a href="https://en.m.wikipedia.org/wiki/Gray_code" rel="nofollow ugc">https://en.m.wikipedia.org/wiki/Gray_code</a></p>
<p>However the highly cyclic nature of such simple Grey codes as can be seen on the Wikipedia page kind of smacks you in the eye&#8230; Thus the lack of complexity is painfully obvious.</p>
<p>[2] You can kind of see this from, a block cipher has a bit width input of &#8220;data bit width pluss key bit width&#8221; then the fact that the mixing effect of data and key effects the entire maping width.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381868">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381868">
						June 18, 2021 2:04 AM					</a>

				</p>

				<p>Another link</p>
<p>hxtps://www.vice.com/en/article/4avnan/bombshell-report-finds-phone-network-encryption-was-deliberately-weakened</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381872">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381872">
						June 18, 2021 3:30 AM					</a>

				</p>

				<p>@SpaceLifeForm:</p>
<p>It seems to me that &#8220;proof&#8221; is not a very useful concept with respect to security.</p>
<p>Of course, systems are often proven insecure by some break &#8230; but formal proofs of security are typically so limited that they tell little or nothing about security in a practical context.</p>
<p>The best <em>evidence</em> that a cipher is strong is when intensive cryptanalysis efforts have failed to find feasible attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381876">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381876">
						June 18, 2021 4:05 AM					</a>

				</p>

				<p>@ MarkH, SpaceLifeForm,</p>
<blockquote><p>The best evidence that a cipher is strong is when intensive cryptanalysis efforts have failed to find feasible attacks.</p></blockquote>
<p>Well I find the best first step is,</p>
<p><b>Show me the Random</b></p>
<p>At the end of the day the main difference between secure and insecure in a crypto algorithm is the level of &#8220;predictability&#8221;.</p>
<p>Sufficient True Random in the algorithm says &#8220;no predictability&#8221; there. Which leaves the plaintext statistics, which you have to not just flatten but mix up either true randomly or in a message dependebt way. To stop them being reproduced by the same message under different keys.</p>
<p>So you look at the mixing function for flatening and the mode you use the crypro algorithm in to spread them unpredictably far and wide.</p>
<p>If it looks like the system is not going to give you these it&#8217;s probably easiest to move onto the next algorithm&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381882">

			<div class="comment by-bob-paddock ">

				<p class="commentcredit">

					<span class="commenter">Bob Paddock</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381882">
						June 18, 2021 7:47 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>&#8220;Sufficient True Random in the algorithm says &#8216;no predictability&#8217; there.&#8221;</p>
<p>Clive I asked NXP &#8220;how does the TRNG of the Kinetis parts work?&#8221;.  They replied thus:</p>
<p>&#8220;TRNG is based on collecting bits from a random noise source. This random noise source is a ring oscillator that is sensitive to random noise (temperature variations, voltage variations, cross-talk and other random noise) within the device in which the TRNG is used. TRNG can be used to seed a hardware or software based implementation of a DRBG defined by SP800-90.</p>
<p>TRNG hasn&#8217;t been certified with FIPS and there are no plans to do it for KINETIS.</p>
<p>But, the TRNG is designed in accordance with SP800-90B guidelines, if you combine it with a SW DRBG (per SP800-90B guidelines), it should meet the FIPS requirements.&#8221;</p>
<p>What are your thoughts?</p>
<p>Won&#8217;t any true random source make a really good thermometer?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381883">

			<div class="comment by-metaschima ">

				<p class="commentcredit">

					<span class="commenter">metaschima</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381883">
						June 18, 2021 7:48 AM					</a>

				</p>

				<p>Can we just agree that any cryptographic primitive created in cooperation with a secret service agency cannot be trusted, because it is likely to have been intentionally weakened or backdoored ? Of course, this will not be discovered immediately as this and previous cases have shown, but it will be discovered eventually. The main goal of any secret service agency for as long as they have existed is espionage. How can you spy on people if you make strong crypto with no backdoor ? This cannot be. Crypto produced with their &#8220;cooperation&#8221; must be easy enough for the agency to break or it must be backdoored. Anyway, this is my opinion, but it is backed up by numerous past examples of this happening: the NSA with DUAL EC DBRG, NSA with DES/LUCIFER, the British secret service selling Lorenz machines after WWII that they could break using Colossus, NSA weakening Hagelin CX-52, NSA and Crypto AG, and others like the one in this article.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381890">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381890">
						June 18, 2021 9:06 AM					</a>

				</p>

				<p>@ Bob Paddock,</p>
<blockquote><p><i>&#8220;This random noise source is a ring oscillator that is sensitive to random noise (temperature variations, voltage variations, cross-talk and other random noise) within the device in which the TRNG is used. &#8220;</i></p></blockquote>
<p>That is mainly &#8220;chaos&#8221; at best and very frequently very determanistic.</p>
<p>As I mentioned yesterday on abother thread there is the principle of the &#8220;Loose Locked Oscillator&#8221; and it&#8217;s something that is,a right royal pain when you are developing TRNG&#8217;s.</p>
<p>Ring oscillators are very very very sensitive to the effects that make &#8220;loose Locked Oscillators&#8221;.</p>
<p>Briefly Ring Oscillators are &#8220;phase shift&#8221; oscillators where the phase shift is caused by either direct invertion or the transmission charecteristics of the gate.</p>
<p>In microcontrolers the ring oscilator gets it&#8217;s phase delay from either a very high Q tuned circuit (XTAL) or charging and discharging one or more RC lowpass circuits.</p>
<p>The the problem is that the gates be they inverters or buffers are very very high gain analog amplifiers designed for &#8220;smashing into the rails&#8221; as such their stability around the switching or mid point is quite unstable and they are very sensitive to &#8220;rail noise&#8221; which gets shifted by the bucket load around logic IC internal power traces. Worse inba ring oscillator you get &#8220;metastibility&#8221; issues that lead to tempory and soft lock ups which means they stop oscillating so stop producing output. So when combined with a determanistic algorithm it ceases to be a TRNG but a PRNG that might or might not &#8211;probably not&#8211; be CS compliant.</p>
<p>In order to stop you observing just how crappy / usless ring oscillators are as TRNGs usually they hide them behind a Hash or other CS algorithm.</p>
<p>But you don&#8217;t have to stop a ring oscillator to make it usless justvsquirt an EM signal at it that either is close to the oscillators frequency or is a much higher frequency AM modulated close to the oscillators frequency. The result is the ring oscillator synchronizes to the signal. Just like the stereo pilot signal in an Analog FM broadcast or the Colour Chroma signal burst in an old analog Colour TV signal like NTSC or PAL.</p>
<p>But it gets more fun&#8230;</p>
<p>Usually because the individual gates in a eing oscillator provide so little time delay thus phase shift they will use more than 20 gates in each ring oscillator, making the susceptability to external signals very high, they also use multiple very high frequency ring oscillators and combine them in a D-Type latch or similar.</p>
<p>When you look &#8220;close in&#8221; at the latch outpit on an oscilloscope the trace does look very random. But it is nothing like random what so ever. If you open out the timebase you will see that the transitions change frequency and bunch up and spread a part very very reliably. If you &#8220;low pass&#8221; the output you get a very pure looking sinewave. Because rather than being random it&#8217;s an &#8220;over sampled difference frequency&#8221; between the two ring oscillator frequencies&#8230;</p>
<p>As you probably know sinewaves are very very easy to find in noise you just use a very narrow bandwidth filter to remove the bulk of the noise. There are DSP algorithms that will not just find a sinewave artifact but lock onto it and follow it as a Digital Phase Locked Loop (D-PLL) without going into details the sinewave will appear through the use of an encryption algorithm just like that frequently seen image of Linux&#8217;s Tux penguin mascot. Only a lot lot more easily synchronised. Worse unlike the Tux image, it does not matter how wide the encryption algorithm is in bits&#8230; Because it &#8220;samples the signal&#8221; and that means you will see either the actual sinewave at it&#8217;s natural frequency or as either a harmonic or sub-harnonic. Which evervit is does not matter because a D-PLL will lock onto it and that will discipline an &#8220;on frequency&#8221; oscillator even if it&#8217;s &#8220;software only&#8221; like a Digital Numeric Oscillator that can be steped up or down in the tiniest of frequency increments you want. You can also make it very frequency agile by using it in the equivalent of a &#8220;fractional N&#8221; or &#8220;Sigma Delta&#8221; D-PLL.</p>
<p>The result an attacker gets to know rxactly what your supppsed TRNG is doing&#8230; Thus you are lulled into a very very false sense of security by say Intels TRNG which is again ring oscilators but hiding behind a hash algorithm&#8230;</p>
<p>So if I see &#8220;ring oscillator&#8221; in a design depending on why I&#8217;m looking at it I either say in a polite way &#8220;The doors over there&#8221;, &#8220;You should think of a better way to do this&#8221;, or &#8220;At the very least run your crypto not in ECB mode but a nonlinear chaining mode with frequent IV change and restart&#8221;.</p>
<p>But if you look at our hosts TRNG the &#8220;entropy pools&#8221; in effect do the chaining with frequent IV change and restart, but with effectively a very very very long chain (it kind of makes it a lagged Fibonacci gennerator with multiple taps, which is still linear though).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381891">

			<div class="comment by-echo ">

				<p class="commentcredit">

					<span class="commenter">echo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381891">
						June 18, 2021 9:18 AM					</a>

				</p>

				<p>@MarkH</p>
<blockquote><p>An interesting difference between DES and GEA-1, is the degree of concealment.</p>
<p>The downgrading of DES was done with some smokescreen about ‚Äúparity bits,‚Äù which didn‚Äôt deceive academic cryptographers. They knew it had been deliberately weakened, and some yelled about it in public.</p>
<p>By contrast, the weakening of the stream cipher was done subtly, and I suppose required some serious expertise to carry out.</p>
<p>Although the technique probably hasn‚Äôt been studied as much as it deserves, there‚Äôs good reason to expect that nonlinear combinations of LFSR outputs can be used to make a stream cipher which is highly resistant to cryptanalysis. At face value, GEA-1 looked solid.</p>
<p>This kind of tricky ‚Äúbackdooring‚Äù is what keeps some folks awake at night, wondering what and whom they can trust.</p></blockquote>
<p>Well yes that is quite obvious from a straight reading of the material. I&#8217;m more interested not in what is said but what is not said.</p>
<p>@metaschema</p>
<blockquote><p>Can we just agree that any cryptographic primitive created in cooperation with a secret service agency cannot be trusted, because it is likely to have been intentionally weakened or backdoored ? Of course, this will not be discovered immediately as this and previous cases have shown, but it will be discovered eventually. The main goal of any secret service agency for as long as they have existed is espionage. How can you spy on people if you make strong crypto with no backdoor ? This cannot be. Crypto produced with their ‚Äúcooperation‚Äù must be easy enough for the agency to break or it must be backdoored. Anyway, this is my opinion, but it is backed up by numerous past examples of this happening: the NSA with DUAL EC DBRG, NSA with DES/LUCIFER, the British secret service selling Lorenz machines after WWII that they could break using Colossus, NSA weakening Hagelin CX-52, NSA and Crypto AG, and others like the one in this article.</p></blockquote>
<p>This requires a range of none technology skills to deploy effectively. Exploiting political relationships, psychology and sociology, organisations, policy and legal structures, focus of interest, bikeshedding and fashion, and so on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381893">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381893">
						June 18, 2021 9:45 AM					</a>

				</p>

				<p>@ metaschima,</p>
<blockquote><p>Can we just agree that any cryptographic primitive created in cooperation with a secret service agency cannot be trusted</p></blockquote>
<p>Just one problem, if you did not fully create the crypto system, how do you actualy know if a Secret Service agency was involved or not?</p>
<p>In fact how can any company with employees designing crypto systems or parts there of, know that their employees do not have some &#8220;relationship&#8221; be it voluntary, coerced, or just hood winked by a security service agency?</p>
<p>Remember RSA and the Dual Eliptic Curve random generator? Or Jupiter Networks with similar odd code turning up in their shipped products.</p>
<p>Heck I&#8217;ve sat in on International Standards meetings and watched &#8220;technical representatives&#8221; comming up with &#8220;Health and Safety&#8221; excuses and similar to backdoor digital communications&#8230; You know exactly what they are upto, but if you challange them you get the ewuivalent of &#8220;Think of the Children&#8221; FUD comming at you from the Extended Five Eyes technical representatives and they just keep at it untill you are too exhausted ostracized&#8230; The idiot from the NSA that so badly tried to &#8220;finess&#8221; a standard caused such a hate that they got turned on and eventually &#8220;outed&#8221; and that caused all sorts of embarrassment for the standards body&#8230;</p>
<p>So if it&#8217;s not entirely your own work from the roll of a dice (entropy source) upwards, it&#8217;s best to assume it&#8217;s not secure.</p>
<p>It&#8217;s basically what they call a &#8220;root of trust issue&#8221;, if you can not establish a real root of trust then it&#8217;s probably &#8220;game over&#8221; for your security. But with law enforcment getting in the game it&#8217;s going to also be &#8220;Go straight to jail, do not pass go do not collect $200&#8221; regardless of what you might or might not have done. They can judicially squeeze you via the politically controled &#8220;Special Administrative Measures&#8221; or equivalent till you plead guilty to something. They get promotion brownie points and you are left bankrupt and unemployable such is the modern day version of &#8220;Rights Stripping&#8221;.</p>
<p>It&#8217;s kind of the new &#8220;Power Politics&#8221; and unless you have billions off shore, you don&#8217;t have the power if you behave legally&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381897">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381897">
						June 18, 2021 11:13 AM					</a>

				</p>

				<p>@Clive:</p>
<p>By the usual definition, each cipher defines a fully deterministic function (or often, a pair of such functions).</p>
<p>To describe a deterministic process as &#8220;random&#8221; or &#8220;true random&#8221; must surely lead to misunderstanding by some readers.</p>
<p>Randomness is such a crucial topic, and at the same time so baffling and mystifying.</p>
<p>Consider the legion of crypto noobs who read about &#8220;perfect secrecy&#8221; and then invent easily broken stream ciphers &#8230;</p>
<p>On topics where misunderstanding is so prevalent, it&#8217;s best to use terminology (and language more generally) with great care.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381900">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381900">
						June 18, 2021 12:37 PM					</a>

				</p>

				<p>@ MarkH,</p>
<blockquote><p>To describe a deterministic process as ‚Äúrandom‚Äù or ‚Äútrue random‚Äù must surely lead to misunderstanding by some readers.</p></blockquote>
<p>Unfortunately they both exist in a cipher system.</p>
<p>If you have say AES in ECB many might consider it &#8220;determanistic&#8221;. But the key should be &#8220;truely randomly selected&#8221; and even though it does not look random to most people even text &#8220;plaintext&#8221; contains truley random elements otherwise no new/useful information could be sent.</p>
<p>The same is true for an OTP, where the KeyMat should be truely random on every bit, but it still uses a determanistic process for it&#8217;s mixer function, and has a fair degree of localised determancy in it&#8217;s text based plaintext.</p>
<p>So the confusion does come &#8220;built in&#8221; in all crypto systems as at the end of the day it has to be at least truely random and determanistic.</p>
<p>Then of course there are &#8220;the shades inbetween&#8221; where determanistic becomes random to observation or pesudorandom. Also there is the notion of &#8220;chaos&#8221; to consider as well.</p>
<p>It&#8217;s all kind of messy and it&#8217;s not unusual to expect people to know just what sort of random you are talking about from the truly determanistic but too complex for an observer to tell through to the truly random where from time to time an observer might think they see determinism, simply because things are unbounded.</p>
<p>I hope that&#8217;s clear üòâ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381902">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">Tat√ºtata</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381902">
						June 18, 2021 1:06 PM					</a>

				</p>

				<p>Do you even need to go through the trouble of inserting some known plaintext?</p>
<p>Checking my references (I worked with GSM standards a while back), page flip, flip, flippitty flip&#8230;</p>
<p>For GPRS, the SGSN sends a 128 bit random number RAND, which is received at the MS and  encrypted on the SIM card using the A8 algorithm with the 128 bit subscriber identification key Ki. The session key Kc is derived from a (smallish) subset of the output block bits. The exact A8 algorithm used is left at the discretion of the operator (for those that actually applied encryption), but the various COMP128 options commonly offered were known to have weaknesses.</p>
<p><a href="https://arxiv.org/pdf/1002.3175.pdf" rel="nofollow ugc">https://arxiv.org/pdf/1002.3175.pdf</a></p>
<blockquote><p>2) Flaws in implementation of A3/A8 algorithms: Although the GSM architecture allows operator to choose any algorithm for A3 and A8, many operators used COMP128 (or COMP128-1) that was secretly developed by the GSM association. The structure of COMP128 was finally discovered by reverse engineering and some revealed documentations, and many security flaws were subsequently discovered. In addition to the fact that COMP128 makes revealing Ki possible especially when specific challenges are introduced, it deliberately sets ten rightmost bits of Kc equal to zero that makes the deployed cryptographic algorithms 1024 times weaker and more vulnerable, due to the decreased keyspace. Some GSM network operators tried another new algorithm for the A3/A8, called COMP128-2. COMP128-2 was also secretly designed and inherited the problem of decreased keyspace. Despite of such important problem, no other problems are reported so far. However, we can prospect for new discovered vulnerabilities in the future as it is secretly designed. An improved version of COMP128-2, called COM128-3, is also proposed that generates 64 bits of session key and resolves the problem of decreased keyspace.</p></blockquote>
<p>So this new discovery would seem almost redundant. Perhaps there is a way to combine both vulnerabilities into one even more effective attack?</p>
<p>And while we&#8217;re at it, what prevents SIM manufacturers from introducing properties reducing the effective entropy of the delivered SIMs, ranging from the subtle mathematical relationship in the RNG, to the outright brazen setting of Ki to cryptofunction(TLA_provided_key,IMSI)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381903">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381903">
						June 18, 2021 1:07 PM					</a>

				</p>

				<p>@Clive:</p>
<p>The key is supposed to be random.</p>
<p>The plaintext has some entropy &#8230; otherwise there&#8217;s no point in sending it!</p>
<p>But the <em>cipher</em> &#8212; while necessarily having certain pseudo-random properties &#8212; is not random at all.</p>
<p>I believe I understood what you meant by those words;  I&#8217;m fairly certain others will not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381909">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381909">
						June 18, 2021 2:30 PM					</a>

				</p>

				<p>@ MarkH, Clive</p>
<p>Good points about the &#8216;language&#8217;.</p>
<p>My questions were rhetorical.  I should have used &#8216;trust&#8217; instead of &#8216;proof&#8217;.</p>
<p>As they say, you can&#8217;t prove a negative.</p>
<blockquote><p>The plaintext has some entropy ‚Ä¶ otherwise there‚Äôs no point in sending it!</p></blockquote>
<p>See zoom call. Non-changing plaintext (the wall behind the person).</p>
<p>See silent time during a voice call.</p>
<p>A smart app would not transmit.</p>
<p>A dumb app can be exploited to leak the key over time, and the attacker can then go back and decrypt the already recorded data.</p>
<p>I do not trust stream ciphers to not leak if there is sufficient repetitive plaintext data.</p>
<p>Keeping the duration of the stream short may be the best defense.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381923">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381923">
						June 18, 2021 5:42 PM					</a>

				</p>

				<p>@ Tat√ºtata,</p>
<blockquote><p>worked with GSM standards a while back), page flip, flip, flippitty flip‚Ä¶</p></blockquote>
<p>The last time I was involved with the design of a GSM phone in earnest, the stack of A4 sheets was about four foot high and when in even very thin plastic binders there were so,many we had to make a new one just to hold an index of indexes&#8230;</p>
<p>And there were bugs in the documentation and we found one by bringing a UK network down&#8230;</p>
<p>As you are nodoubt aware the phone is supposed to re-register with the network every so often. The specification got changed because of certain issues. Put simply the phone was supposed to re-register in half the previous time period if the last re-register failed&#8230; But the spec dod nor give a minimum time&#8230; The UK network used a certain well known European Switch provider and the way it re-regisyered phones was not the new improved way&#8230;</p>
<p>So even though the phone was registered with the network it ended up halving the rime period untill it effectively monopolised the control channel&#8230; Fun days not&#8230;</p>
<p>Back then the backend systems of network providers were &#8220;Unix&#8221; and that was in effect &#8220;big iron&#8221; compared to the High end PC systems we did CAD/CAM etc on&#8230;</p>
<p>Then somebody &#8220;fingered me to QC&#8221; as being &#8220;The man who spoke guru&#8221;, as the machine I was using &#8211;that was actually my own&#8211; ran AT&amp;T Sys Vr4 with &#8220;DOS-Merge&#8221; that you could run around 6-8 copies simultaneously via a multi-port Serial Card that the individual &#8220;In Circuit Debuger/Developer Emulator (ICE) hardware for the CPU&#8217;s ranwith. So I suddenly &#8220;owned the problem&#8221; with dealing with the UK network people.</p>
<p>If that were not bad enough &#8220;The big-big boss&#8221; got told and it turned out his daughter was in her First year at Uni and &#8220;Could I just help a little with her Unix and maths stuff&#8221;&#8230;</p>
<p>And so on giving me less and less time to do my &#8220;real work&#8221; that my boss kept piling up on me because I got things done&#8230;</p>
<p>I thus learned the true meaning of,</p>
<p>&#8220;If you want something done quickly, but well, give it to a busy person&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381930">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381930">
						June 18, 2021 6:39 PM					</a>

				</p>

				<p>@ SpaceLifeForm, MarkH,</p>
<blockquote><p>I do not trust stream ciphers to not leak if there is sufficient repetitive plaintext data.</p></blockquote>
<p>Yup&#8230; Fixed screen startup logos are almost perfect &#8220;Known plaintext&#8221;. As you might know the more linear that &#8220;mapping function&#8221; is the less bits are needed. In theory twice the effective key &#8220;counter&#8221; width is all that&#8217;s needed to &#8220;knock it dead&#8221;.</p>
<p>But many who design Lagged Fibonacci type systems like Linear Feedback Shift Registers appear to forget something&#8230; That &#8220;clock arithmatic&#8221; or &#8220;Chinese Number&#8221; mod rules apply</p>
<p>If you look at the GEA-1 algorithm then the GEA-2 algorithm, GEA-2 just tacks another LFSR on in parallel&#8230;</p>
<p>Now LFSR&#8217;s have an interesting property, if you take the output of an LFSR and delay it through another Shift Register and add the two together via an XOR gate or equivalent, you end up with the same output sequence as the LFSR just shifted further in sequence.</p>
<p>So adding an extra LFSR to an existing system with linear or near linear combining does not get you any extra counter bit width equivalent it is just an expensive way of adding a counter offset.</p>
<p>Now ask yourself a question about what if you use two LFSR&#8217;s that differe only marginally in say one &#8220;tap&#8221; position?</p>
<p>It turns out you in effect delay a sub-sequence of the common LSFR circuits.</p>
<p>It&#8217;s what you would expect when you get sufficiently &#8220;down and dirty&#8221; with Walsh / Sequency circuits where all you are realy doing is adding individual bit sequences together via XOR gates&#8230;</p>
<p>Thus unless you take care to ensure your LSFR&#8217;s do not have any commonaliry in length and taps you effectively &#8220;loose counter bit width&#8221; or &#8220;Key bit length&#8221;.</p>
<p>Now most hardware engineers like &#8220;commonality&#8221; in design, they love repeating the same circuit block over and over. Especially if it has lots of tap points&#8230;</p>
<p>Take another look at those LFSR in GEA-1/2 they are not exactly sparse in taps&#8230;</p>
<p>So when you design a &#8220;common hardware block&#8221; what a lot of hardware engineers would do is use the fact that an XOR gate is a &#8220;Controled NOT Gate&#8221; that is if you fix one input to &#8220;high&#8221; the result is the XOR is a NOT gate or Inverter, if you fix it low then it is a non-inverting buffer&#8230; So by adding an AND gate in series with one of the XOR inputs you have a control signal that makes the resulting combined gate either a non-inverting buffer or an XOR gate. Drive those control signals from a software driven register you can make just one circuit block do any of the LFSR functions in the Key Stream generator&#8230; So you could make the actual LFSR length small and have the same taps with the result you could end up only generating a slow squarewave as the key stream if you so wished&#8230;</p>
<p>If you actually made those registers that hold the control settings a shift register, to an outside observer it would look like you were shifting in a very long key length&#8230; If you just clocked in &#8220;random data&#8221; you would get what looks like a valid &#8220;key-stream&#8221; at the output. It&#8217;s only if you get the right combination does the key stream get very very weak so your chance of finding one &#8220;randomly&#8221; is likewise very very small&#8230; But if you know the circuit hidden away inside that &#8220;secure chip&#8221; then you can arbitarily set the strength of the key-stream as you see fit&#8230;</p>
<p>So yes there are all sorts of hidden gotchers for the unwary. But lets just say you were an independent crypto system manufacturer supplying all sorts of countries. You could use identical hardware for customers in the A list that got very strong key-stream generation, say 80-bit equivalent for B-list customers and 40bit or less for C-list customers.</p>
<p>Sound familiar? Well several European Based crypto hardware suppliers effectively did just that&#8230; And one of them got mentioned on this blog today by someone asking about alleged TRNG&#8217;s embeded in chips&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381949">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381949">
						June 19, 2021 12:41 AM					</a>

				</p>

				<p>@SpaceLifeForm, Clive:</p>
<p>The only thing that repetitive, patterned or otherwise predictable plaintext can do to a stream cipher, is make it easier to infer the keystream.</p>
<p>That doesn&#8217;t matter at all for a strong stream cipher; in fact, designers of such ciphers <em>must</em> assume that an attacker has access to the raw keystream.  The design goal is to make it impossible (or at least, more costly than anyone can afford) to deduce key or initialization vector bits from the keystream.</p>
<p>If the cipher is strong, repetitive plaintext won&#8217;t leak any secret.</p>
<p>If the cipher is weak, plaintext entropy may delay cryptanalysis, but cannot be trusted to prevent it.</p>
<p>========================</p>
<p>As Clive observed, it&#8217;s best practice to use strong block ciphers if you can.</p>
<p>Stream ciphers may be useful where computing resources are very limited.  I&#8217;ve looked into coding crypto on microcontrollers with very tiny RAM capacity which would prohibit  strong block ciphers.</p>
<p>========================</p>
<p>Readers not already familiar with it, may enjoy learning about the &#8220;shrinking generator&#8221; of Coppersmith, Krawczyk and Mansour (1994).</p>
<p>It&#8217;s wonderfully small and simple, made of two LFSRs.  One is the source for keystream bits; the other functions as a &#8220;gate&#8221;, with raw outputs of the first either being used in the keystream, or discarded.</p>
<p>The 1994 paper derives or proves many interesting properties of that construction.</p>
<p>When the shrinking (or more formally, decimating) generator is used the paper recommends, the LFSR polynomials (tap sequences) are effectively the key, so a keystream is fully determined by the pair of polynomials, and a pair of initialization vectors.</p>
<p>As far as I have been able to discover, no cryptanalytic attack has been found against the shrinking generator with secret polynomials:  the best known attack remains exhaustive search, which with a total of 128 LFSR bits will remain beyond feasibility for a long time to come.</p>
<p>The shrinking generator also has a long period, allowing a large volume of data to be encrypted using a single key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381952">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381952">
						June 19, 2021 1:31 AM					</a>

				</p>

				<p>@ MarkH, Clive</p>
<blockquote><p>If the cipher is weak, plaintext entropy may delay cryptanalysis, but cannot be trusted to prevent it.</p></blockquote>
<p>Exactly.  This is what Downgrade Attacks are all about.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-381968">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381968">
						June 19, 2021 8:14 AM					</a>

				</p>

				<p>@ MarkH, SpaceLifeForm,</p>
<blockquote><p>As far as I have been able to discover, no cryptanalytic attack has been found against the shrinking generator with secret polynomials</p></blockquote>
<p>It is easily proved that there is a worse case condition where it could be broken in as little as 2W bits of the &#8220;generator&#8221; LFSR where W is the size of the &#8220;effective counter&#8221; in bits.</p>
<p>Basically there is known attack on an LFSR that says all you need is 2W bits out of the LFSR.</p>
<p>To get that out of shrinking generator, all that needs to happen is the run length on the gating/decimating generator to be 2W or longer. As I demonstrated in a comment further up you can get a maximum run length of 3W-2 bits out of an LFSR&#8230;</p>
<p>So it&#8217;s more than possible for some one who controls the two LSFR&#8217;s to compleatly bork the shrinking generator with out the user being aware of it&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-381975">

			<div class="comment by-dillweed ">

				<p class="commentcredit">

					<span class="commenter">Dillweed</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/#comment-381975">
						June 19, 2021 8:51 AM					</a>

				</p>

				<p>@ALL @Everybody</p>
<p>In this physical plain we live in called earth and in the theoretical world is there truly anything that one entity ( by entity ) for discussion purposes, I mean anyone government that could observe a event and measure its randomness and thus generate a key that no one else could observe and measure, thus create a unbreakable stream.</p>
<p>For instance, if one government had the only Hadron Collider anywhere and they were able to measure the nuances from generating sub atom particles ,which may create a unique random event and observable sounds,pressure etc.. would that be like a one time key.   Or if a certain country had the best and only technology to go into space and observe all the random events,recording such to generate unique data, again could that be impetus to make a one of a kind,random secure crypto stream.</p>
<p>OR</p>
<p>Is out existence in this world and universe non unique and everything is observable and measurable by most.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2021%2F06%2Fintentional-flaw-in-gprs-encryption-algorithm-gea-1.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="d2a7b8a4e9" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2021/06/intentional-flaw-in-gprs-encryption-algorithm-gea-1.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='63380' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2021/06/paul-van-oorschots-computer-security-and-the-internet.html" rel="prev">‚Üê Paul van Oorschot‚Äôs <i>Computer Security and the Internet</i></a>		<a href="https://www.schneier.com/blog/archives/2021/06/peloton-vulnerability-found-and-fixed.html" rel="next">Peloton Vulnerability Found and Fixed ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/06/fbi-afp-run-encrypted-phone.html">FBI/AFP-Run Encrypted Phone</a></li><li><a href="https://www.schneier.com/blog/archives/2021/05/double-encrypting-ransomware.html">Double-Encrypting Ransomware</a></li><li><a href="https://www.schneier.com/blog/archives/2021/05/bizarro-banking-trojan.html">Bizarro Banking Trojan</a></li><li><a href="https://www.schneier.com/blog/archives/2021/05/newly-unclassified-nsa-document-on-cryptography-in-the-1970s.html">Newly Declassified NSA Document on Cryptography in the 1970s</a></li><li><a href="https://www.schneier.com/blog/archives/2021/04/wtf-signal-adds-cryptocurrency-support.html">Signal Adds Cryptocurrency Support</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/root/"><img class="sidepic" alt="We Have Root" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/09/book-root-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/main.js?ver=1.0.0' id='schneier-main-js'></script>
<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
<!--
	generated 143 seconds ago
	generated in 0.217 seconds
	served from batcache in 0.001 seconds
	expires in 157 seconds
-->
