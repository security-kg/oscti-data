<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Kaspersky Labs Trying to Crack 1024-bit RSA - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Kaspersky Labs Trying to Crack 1024-bit RSA Comments Feed" href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/2305" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=2305' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F06%2Fkaspersky_labs.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F06%2Fkaspersky_labs.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-2305 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-2305" class="post-2305 post type-post status-publish format-standard hentry category-uncategorized tag-cracking tag-cryptanalysis tag-cryptography tag-encryption tag-kaspersky tag-keys tag-malware tag-rsa">

	<div class="article">

		<h2 class="entry">Kaspersky Labs Trying to Crack 1024-bit RSA</h2>
		<p>I can&#8217;t figure <a href="http://news.cnet.com/8301-10784_3-9965381-7.html">this</a> <a href="http://www.computerworld.com/action/article.do?command=viewArticleBasic&#038;articleId=9094818">story</a> out.  Kaspersky Lab is launching an international distributed effort to crack a 1024-bit RSA key used by the Gpcode Virus.  From their <a href="http://forum.kaspersky.com/lofiversion/index.php/t71652.html">website</a>:</p>
<blockquote><p>We estimate it would take around 15 million modern computers, running for about a year, to crack such a key.</p></blockquote>
<p>What are they smoking at Kaspersky?  We&#8217;ve never factored a 1024-bit number &#8212; at least, not outside any secret government agency &#8212; and it&#8217;s likely to require a lot more than 15 million computer years of work.  The current factoring record is a <a href="http://www.schneier.com/blog/archives/2007/05/307digit_number.html">1023-bit number</a>, but it was a special number that&#8217;s easier to factor than a product-of-two-primes number used in RSA.  Breaking that Gpcode key will take a lot more mathematical prowess than you can reasonably expect to find by asking nicely on the Internet.  You&#8217;ve got to understand the current best mathematical and computational optimizations of the Number Field Sieve, and cleverly distribute the parts that can be distributed.  You can&#8217;t just post the products and hope for the best.</p>
<p>Is this just a way for Kaspersky to generate itself some nice press, or are they confused in Moscow?</p>
<p>EDITED TO ADD (6/15):  Kaspersky &lt;a href=http://www.securityfocus.com/news/11523&#8243;>now says</a>:</p>
<blockquote><p>The company clarified, however, that it&#8217;s more interested in getting help in finding flaws in the encryption implementation.</p>
<p>&#8220;We are not trying to crack the key,&#8221; Roel Schouwenberg, senior antivirus researcher with Kaspersky Lab, told SecurityFocus. &#8220;We want to see collectively whether there are implementation errors, so we can do what we did with previous versions and find a mistake to help us find the key.&#8221;</p>
<p>Schouwenberg agrees that, if no implementation flaw is found, searching for the decryption key using brute-force computing power is unlikely to work.</p></blockquote>
<p>&#8220;Clarified&#8221; is overly kind.  There was nothing confusing about Kaspersky&#8217;s post that needed clarification, and what they&#8217;re saying now completely contradicts what they did post.  Seems to me like they&#8217;re trying to pretend it never happened.</p>
<p>EDITED TO ADD (6/30):  A Kaspersky virus analyst <a href="http://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html#c282018">comments on this entry</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cracking/" rel="tag">cracking</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/kaspersky/" rel="tag">Kaspersky</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/rsa/" rel="tag">RSA</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html" rel="bookmark">Posted on June 12, 2008 at 12:30 PM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html#comments">62 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html" data-title="Kaspersky Labs Trying to Crack 1024-bit RSA" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-90756">

			<div class="comment by-jon-williams ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://wizardishungry.com/' rel='external nofollow ugc' class='url'>Jon Williams</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90756">
						June 12, 2008 1:22 PM					</a>

				</p>

				<p>What if this is some sort of trick to get us to compromise a CA&#8217;s key or something?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90757">

			<div class="comment by-2tryorotheragenda ">

				<p class="commentcredit">

					<span class="commenter">2TryOrOtherAgenda</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90757">
						June 12, 2008 1:28 PM					</a>

				</p>

				<p>Good snake oil or press to brag about skill in results, if you got the keys somehow, and put up enough work and &#8216;skill.&#8217;  What about some other agenda like mapping or ?  Can&#8217;t see much market for this, and few care about crypto, so yeah ?  Would be nice to have a legit distributed system though&#8230;<br />
Good that this site brings perspective to current affairs.<br />
DJB mentioned something about 1024 might be easier than thought if [fill in blanks/google is your friend, or Bruce might help out]<br />
I&#8217;d like to smoke some of that hopeful stuff with ROI on trying to crack 1024.  So easy to go to 16384, or less for practically nothing.  Would be interesting to know if people are still really trying to crack the RSA challenges?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90758">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90758">
						June 12, 2008 1:29 PM					</a>

				</p>

				<p><em>Maybe</em> (but I wouldn&#8217;t bet on it) they figured out some weakness in the trojan&#8217;s implementation. Previous version of the same thing had some weaknesses thanks to sloppy programming (in addition to smaller key) and they (=some AV vendor, I don&#8217;t know if Kasperski) managed to reconstruct the private key.</p>
<p>More likely, they&#8217;re just clueless about cryptography.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90759">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90759">
						June 12, 2008 1:44 PM					</a>

				</p>

				<p>Even if this did work it would take the authors about 4 seconds to make a new strain with a different private key</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90760">

			<div class="comment by-pat-cahalan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://padraic2112.wordpress.com' rel='external nofollow ugc' class='url'>Pat Cahalan</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90760">
						June 12, 2008 1:56 PM					</a>

				</p>

				<p>I&#8217;m guessing that Peter&#8217;s more right than he thinks.  I imagine that Kaspersky expects that the crypto is implemented improperly.  They&#8217;re certainly not <em>clueless</em> about cryptography.</p>
<p>Bruce is right, though&#8230; their &#8220;press release&#8221; version of this story doesn&#8217;t really explain what&#8217;s going on here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90761">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter">Carlo Graziani</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90761">
						June 12, 2008 2:32 PM					</a>

				</p>

				<p>Maybe they&#8217;re hoping the key was generated by a Debian SSL library.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90762">

			<div class="comment by-mrvnmouse ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://1337hax0r.com' rel='external nofollow ugc' class='url'>MrvnMouse</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90762">
						June 12, 2008 2:36 PM					</a>

				</p>

				<p>According to the article, the virus advises the person whose data was encrypted to &#8220;buy a decryptor [sic] and provides an e-mail address to contact.&#8221;</p>
<p>Why doesn&#8217;t Kapersky simply buy the decryption software covertly and simply reverse engineer the key out of that. To decrypt the files, there would have to be a private key within (or somehow retrieved) by the decryption software. Unless, of course, the decryption software simply sends the data to a decryption server somewhere to be decrypted. In which case, I guess at the very least you&#8217;d have a decryption oracle of sorts to play with.</p>
<p>If it is possible to reverse engineer it, it would be infinitely more simple than trying to factor a 1024-bit number.</p>
<p>Regardless, even if, by some miracle they were to break the key, it would be trivial for the criminals to simply change it to another one, and so the work would only be useful for old already lost data (after a year of work.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90763">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90763">
						June 12, 2008 2:44 PM					</a>

				</p>

				<p>Swa Frantzen at ISC raised some interesting questions about the idea.</p>
<p><a href="http://isc.sans.org/diary.html?storyid=4544" rel="nofollow ugc">http://isc.sans.org/diary.html?storyid=4544</a></p>
<p>&#8220;How do we know this public key (or his next key, or the one after that), is a key the attacker actually has the matching private key for? How do we know for sure this key doesn&#8217;t belong to somebody else and by giving out the private key to thwart the apparent attacker we&#8217;re actually helping him in his real attack against somebody else.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90764">

			<div class="comment by-martin ">

				<p class="commentcredit">

					<span class="commenter">Martin</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90764">
						June 12, 2008 2:47 PM					</a>

				</p>

				<p>@MrvnMouse:</p>
<p>As I understand it, here&#8217;s how it works:</p>
<ul>
<li>The virus encrypts your files with a random symmetric key</li>
<li>This symmetric key is then encrypted with the 1024-bit RSA public key</li>
<li>You send the encrypted symmetric key to the criminals</li>
<li>The criminals decrypt the symmetric key with the private RSA key and send it to you as soon as they pocket their ransom (including the decrypting application that uses this key)</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90765">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90765">
						June 12, 2008 2:48 PM					</a>

				</p>

				<p>Not sure about the 15million CPU years to crack a truly randomly generated pq pair. The back of my &#8220;fag packet&#8221; differs somewhat.</p>
<p>One point to note from the (second link) is that a Kaspersky bod thinks/knows that the Microsoft API was used to generate the key&#8230;</p>
<p>Now even those with a short memory can probably remember that Microsoft does not have a particularly good past reputation with regards crypto and random number generators.</p>
<p>It may be possible that Kaspersky know of a weakness in the MS code that could vastly reduce the search space for p&amp;q. That however still requires significant &#8220;grunt&#8221; to exploit.</p>
<p>As an example of deliberate key weakening, what if you know for instance that one of the primes is only 256bits in length and is itself RSA encoded with a 296bit key and then mapped into the top bits of the 1024bit key. Or that one of the primes is a simple count up from a (supposadly secret) start point.</p>
<p>In either of the above cases of key weakening there is no way to tell by looking at the 1024bit pq key. But to those in the know p is fairly quickly found and q falls nanoseconds later.</p>
<p>Also I sort of vaguly remeber that D.Coppersmith published a paper that indicated that knowing only 25% of the bits for p or q was enough to fataly weaken the composit (just wish I could remember what the details where).</p>
<p>As someone (Bruce?) will no doubt confirm with details there have been a number of &#8220;weak RSA key&#8221; systems discussed in the past. I think Adam Young and Moti Yung published one as part of their research into cryptovirology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90766">

			<div class="comment by-fnord ">

				<p class="commentcredit">

					<span class="commenter">FNORD</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90766">
						June 12, 2008 2:48 PM					</a>

				</p>

				<p>The press release, to me, reads more like a cry for help than an honest proposal.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90767">

			<div class="comment by-muffin ">

				<p class="commentcredit">

					<span class="commenter">Muffin</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90767">
						June 12, 2008 3:10 PM					</a>

				</p>

				<p>I&#8217;ll bet you 10 to 1 that it&#8217;s a PR gag.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90768">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90768">
						June 12, 2008 3:29 PM					</a>

				</p>

				<p>I read about this myself earlier this week. If I remember correctly, they mention something about a file decryption utility that the blackmailer sends back, which I think they assumed could reverse their key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90769">

			<div class="comment by-skorj ">

				<p class="commentcredit">

					<span class="commenter">Skorj</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90769">
						June 12, 2008 3:30 PM					</a>

				</p>

				<p>How do these Gpcode authors get paid in the first place?  Money is very trackable.  You&#8217;d think we&#8217;d have accounts frozen and US Marines kicking in doors by now (assuming a single federal computer was infected, making this an attack on the US Govt.).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90770">

			<div class="comment by-dgeneratekane ">

				<p class="commentcredit">

					<span class="commenter">DGenerateKane</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90770">
						June 12, 2008 4:03 PM					</a>

				</p>

				<p>Groups have been trying to crack RSA Labs RC5-72 encyption challenge for over 5 years now, and have not even reached 1% completion, granted that is just from one group. At the rate that group is going it will take them over 1300 years to crack it. Needless to say over a year ago RSA withdrew the reward money and is no longer supporting it. Assuming no errors were made in the implementation of the encryption, I wouldn&#8217;t care to guess how long it would take to find the key. And that is assuming there is only one to begin with, for all we now each computer is encrypted with a new key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90771">

			<div class="comment by-mrvnmouse ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://1337hax0r.com' rel='external nofollow ugc' class='url'>MrvnMouse</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90771">
						June 12, 2008 4:11 PM					</a>

				</p>

				<p>@Martin:</p>
<p>Well if that is true, then at very least we should have access to a chosen-ciphertext attack (and possible adaptive chosen-ciphertext attack) unless the key cannot be any bit-string whatsoever. It will be an expensive attack, but at least it provides an in that is more realistic than trying to factor a 1024-bit number.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90772">

			<div class="comment by-mrvnmouse ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://1337hax0r.com' rel='external nofollow ugc' class='url'>MrvnMouse</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90772">
						June 12, 2008 4:13 PM					</a>

				</p>

				<p>As well, if the key has a structure of some sort, it may be possible to use that structure in a similar fashion to the PKCS#1 attacks.</p>
<p>Again with the hope of cracking the key eventually.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90773">

			<div class="comment by-out-of-your-pocket ">

				<p class="commentcredit">

					<span class="commenter">Out of your pocket</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90773">
						June 12, 2008 4:15 PM					</a>

				</p>

				<p>@Skorj</p>
<p>&#8220;Money is very trackable.&#8221;</p>
<p>It sure is. Whoops! Maybe not!</p>
<p><a href="http://www.washingtonpost.com/wp-dyn/content/article/2008/05/22/AR2008052203751_pf.html" rel="nofollow ugc">http://www.washingtonpost.com/wp-dyn/content/article/2008/05/22/AR2008052203751_pf.html</a></p>
<p>But hey, what do they care? Not their money, right?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90774">

			<div class="comment by-chris-l ">

				<p class="commentcredit">

					<span class="commenter">Chris L</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90774">
						June 12, 2008 4:19 PM					</a>

				</p>

				<p>It sounds like someone in executive management at Kaspersky or their family got hit with it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90775">

			<div class="comment by-jurjen ">

				<p class="commentcredit">

					<span class="commenter">Jurjen</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90775">
						June 12, 2008 4:50 PM					</a>

				</p>

				<p>Even if all the relations are found quickly with a super-sophisticated version of GNFS, who is going to provide the 6 Terabyte RAM machine for the matrix step? O yes, this RAM should be instantaneously accesible to all processors, otherwise the computation will take too long (the current implementation uses at most about 10 processors for this reason).<br />
Kaspersky probably has more money than I thought.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90776">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90776">
						June 12, 2008 4:57 PM					</a>

				</p>

				<p>Shouldn&#8217;t they be attacking the implementation of the key as opposed to the key itself?  It is in errors in the implementation that they will find ways to by pass the key and access the data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90777">

			<div class="comment by-brad-templeton ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ideas.4brad.com' rel='external nofollow ugc' class='url'>Brad Templeton</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90777">
						June 12, 2008 5:11 PM					</a>

				</p>

				<p>Not to mention that since going full blast pushes the computer power draw up by about 40 to 70 watts on a typical system today &#8212; let&#8217;s say 50 &#8212; this amounts to 6.5 Billion kw-h, costing about 670 million dollars as the U.S. residential average of 10.3 cents/kwh, or 67 trillion BTUs at the generator (the equivalent of burning 500 million gallons of gasoline, though in the USA it&#8217;s mostly coal and natural gas, then nukes and hydro)</p>
<p>That&#8217;s not very responsible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90778">

			<div class="comment by-dasinicaljoker ">

				<p class="commentcredit">

					<span class="commenter">daSinicAlJoker</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90778">
						June 12, 2008 5:11 PM					</a>

				</p>

				<p>Simple.  The person who wrote the virus miscoded the public key and now they get lots of offers of cash, but they can&#8217;t decode the files. If they just take the cash and don&#8217;t decrypt, nobody will pay up for the next version of the virus.  Somehow or other they got Kaspersky to front for their effort to get back the key and profit.  Hopefully for them, the key they included does have a real private key to go with it ðŸ™‚</p>
<p>ðŸ™‚ (I hope ðŸ™‚ ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90779">

			<div class="comment by-davi-ottenheimer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://davi.poetry.org/' rel='external nofollow ugc' class='url'>Davi Ottenheimer</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90779">
						June 12, 2008 5:20 PM					</a>

				</p>

				<p>Publicity stunt, as Vesselin Bontchev says.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90780">

			<div class="comment by-will ">

				<p class="commentcredit">

					<span class="commenter">Will</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90780">
						June 12, 2008 5:42 PM					</a>

				</p>

				<p>A question, since I know zilch about cryptography&#8230;   Does knowing the contents, in part of whole, of the encrypted file ease decryption in a case like this?</p>
<p>Presumably this virus recurses your drive, grabs all your documents, and encrypts them.  It&#8217;s not likely that it skips all the sample documents and such that are included with software so the contents of those would be known in full.  Many other documents would be known in part, particularly the beginning of them, because of their file structures.  Could this be used to shortcut/speed decryption?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90781">

			<div class="comment by-primoris_causa ">

				<p class="commentcredit">

					<span class="commenter">Primoris_Causa</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90781">
						June 12, 2008 6:18 PM					</a>

				</p>

				<h2>&gt;Groups have been trying to crack RSA Labs RC5-72 encyption challenge for over 5 years now, and have not even reached 1% completion, granted that is just from one group. At the rate that group is going it will take them over 1300 years to crack it.</h2>
<p>Groups have been &#8211; but if this threat proves severe enough, those groups and others may team together, thus providing the needed &#8220;umph&#8221;.  I know the reward was withdrawn &#8211; if it was THAT secure, why withdraw it? I think their risk anal folks believe that given enough monkeys, it can be cracked before they can get the spare cash.</p>
<p>Before it was an intellectual exercise, the work was fragmented amongst teams &#8211; now, it is a possible threat and a company is asking for all the available help it can get to break it.  While I do not doubt the altruism of the company in this endeavor, I do not know all of its employees &#8211; and if I wanted to stay on top of the &#8220;anti&#8221; algorithms, I&#8217;d work for one of them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90782">

			<div class="comment by-gotpasswords ">

				<p class="commentcredit">

					<span class="commenter">gotpasswords</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90782">
						June 12, 2008 6:53 PM					</a>

				</p>

				<blockquote>
<blockquote><p>
    A question, since I know zilch about cryptography&#8230; Does knowing the contents, in part of whole, of the encrypted file ease decryption in a case like this?
  </p></blockquote>
</blockquote>
<p>Looking at the screenshot in the CNET article, it apparently just hits your &#8220;My Documents&#8221; directory, and encrypts the files&#8217; contents.</p>
<p>If one or more of those documents is a plain text file, and you happen to know the <em>exact</em> composition of the file, down to the last space and line break, you could run a &#8220;known-plaintext&#8221; attack on the crypto.</p>
<p>Stuff like Word documents that subtly change every time you just look at them, (by doing things like storing the last date/time it was accessed) would be much harder to work with &#8211; changing just one bit of a file will give you a completely different encrypted file.</p>
<p>However, if you know the exact makeup of a file down to the last space and line break, you&#8217;re probably looking at a backup copy, at which point you say &#8220;Nice try, Gpcode.&#8221; Then you re-image the computer and restore from the backup, then get on with whatever you were doing before some would-be data kidnapper distracted you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90783">

			<div class="comment by-will ">

				<p class="commentcredit">

					<span class="commenter">Will</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90783">
						June 12, 2008 7:29 PM					</a>

				</p>

				<p>Backups&#8230; I hadn&#8217;t thought of those, but that&#8217;s cool because that makes it more likely that someone could have exact copies of files that had been encrypted by the virus.</p>
<p>So, suppose a person is hit by the virus and they provide Kaspersky (or other vendor) with encrypted documents and known to be current originals how would that affect this 15 million computer years figure for cracking the key?  Halve it?  Reduce it by an order of magnitude?  Two?  More?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90784">

			<div class="comment by-bruce ">

				<p class="commentcredit">

					<span class="commenter">Bruce</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90784">
						June 12, 2008 7:36 PM					</a>

				</p>

				<p>yeah, let&#8217;s make an assumption that people behind Gpcode won&#8217;t switch to 2048bit RSA key. Nobody expects the Spanish inquisition.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90785">

			<div class="comment by-jan-schejbal ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://janschejbal.wordpress.com' rel='external nofollow ugc' class='url'>Jan Schejbal</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90785">
						June 12, 2008 8:06 PM					</a>

				</p>

				<p>AFAIK the explaination posted by Martin at June 12, 2008 02:47 PM is correct. The virus is said to use RC4 for file encryption, and from known plaintext/ciphertext pair samples published it seems that the virus uses a separate IV per file (at least the file grows by 16 byte when encrypted, and every encrypted file is different even if original content is identical). I&#8217;d say the virus maker did a very good job. I already suggested to try the standard RC4 breaking methods known from the attacks against WEP.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90786">

			<div class="comment by-jan-schejbal ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://janschejbal.wordpress.com' rel='external nofollow ugc' class='url'>Jan Schejbal</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90786">
						June 12, 2008 8:10 PM					</a>

				</p>

				<p>Additionally, Kaspersky seems to look for help finding weaknesses (without releasing information however&#8230;), not factoring the keys (although they published the moduli). Maybe they published the moduli so companies can check if their key matches it (see above #1 for theory about this)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90787">

			<div class="comment by-suspicious ">

				<p class="commentcredit">

					<span class="commenter">Suspicious</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90787">
						June 12, 2008 8:30 PM					</a>

				</p>

				<p>Can we really trust an anti-spyware company from Russia?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90788">

			<div class="comment by-kermit-the-frag ">

				<p class="commentcredit">

					<span class="commenter">Kermit the Frag</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90788">
						June 12, 2008 8:55 PM					</a>

				</p>

				<blockquote>
<blockquote><p>
    If one or more of those documents is a plain text file, and you happen to know<br />
    the <em>exact</em> composition of the file, down to the last space and line break, you<br />
    could run a &#8220;known-plaintext&#8221; attack on the crypto.
  </p></blockquote>
</blockquote>
<p>This might help to recover the random symmetric key used on a particular victim, however it would not help in recovering the RSA private key needed to recover the symmetric keys used on other victims.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90789">

			<div class="comment by-peri ">

				<p class="commentcredit">

					<span class="commenter">peri</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90789">
						June 12, 2008 8:56 PM					</a>

				</p>

				<p>My understanding is whoever is behind the extortion scam used two (&gt;XP,&gt;=XP) private 1024-bit RSA keys. Kaspersky seems to want to break those keys so their software can decrypt the encrypted RC4 (master?) key left behind on a victim&#8217;s computer.</p>
<p>Obviously the people behind the scam can trivially create new private RSA keys. What could cause Kaspersky to believe that the hurdle for actually deploying these newly generated keys could be anywhere near the unimaginably massive task of breaking the private RSA key?</p>
<p>The only possibility I can imagine is if the current version is automatically propagating without phoning home. Is that the case?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90790">

			<div class="comment by-anthony ">

				<p class="commentcredit">

					<span class="commenter">Anthony</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90790">
						June 12, 2008 9:35 PM					</a>

				</p>

				<p>Doesn&#8217;t look like anyone has mentioned one of the easy mistakes to make â€” did the malware manage to scrub every copy of the RC4 key from memory and swap?</p>
<p>Hell of a lot easier to try every memory offset as an RC4 key than to break 1024-bit RSA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90791">

			<div class="comment by-the-imp ">

				<p class="commentcredit">

					<span class="commenter">The Imp</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90791">
						June 12, 2008 10:55 PM					</a>

				</p>

				<p>@ Suspicious</p>
<blockquote><p>
  Can we really trust an anti-spyware company from Russia?
</p></blockquote>
<p>I don&#8217;t know? Can we really trust one from the USA? History, especially recent history, tends to suggest that we cannot.</p>
<p>Better question: Can we really trust a company? The fact that it&#8217;s a company and not a person we&#8217;re dealing with seems, after analysis, to be far more relevant than which country they&#8217;re in.</p>
<p>Russians are not our (the US) enemies. They&#8217;re actually our allies (through NATO, plus others more recently), though we do disagree on a number of relatively minor issues.</p>
<p>The <em>Soviets</em> were our enemies, but that was two decades ago. The Russians were, at the time, Soviets, but there aren&#8217;t any Soviets at all anymore.</p>
<p>The Soviets were Communists, but not all Communists were Soviets (see: China). Communists were not, technically, our enemies, although the original motivation for declaring the Soviets our enemies was because we didn&#8217;t like Communists.</p>
<p>Technically, the position of the US is that Communism is fine, as long as it&#8217;s not One-Party Communism (free and fair elections). But mixing these two is sufficiently difficult that it has never been successful. Plus, this detail is lost on most folks because it was much easier to train them to irrationally hate Communists than to explain the political theory.</p>
<p>I could go on, but I can&#8217;t cram enough into a single blog post to undo a half-century of government propaganda, so you&#8217;ll probably remain unconvinced.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90792">

			<div class="comment by-hugo ">

				<p class="commentcredit">

					<span class="commenter">Hugo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90792">
						June 13, 2008 3:25 AM					</a>

				</p>

				<p>Bruce, aren&#8217;t you wrong? Is Adi your friend?</p>
<p>&#8220;paper published by Adi Shamir and Eran Tromer entitled â€œOn the Cost of Factoring RSA-1024â€³ [pdf] hypothesizes a device which could â€œbreak a 1024-bit RSA key in one year using a devices whose cost is about $10M&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90793">

			<div class="comment by-max ">

				<p class="commentcredit">

					<span class="commenter">Max</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90793">
						June 13, 2008 3:32 AM					</a>

				</p>

				<p>i don&#8217;t get why there is so much fuss about a virus that&#8217;s encrypting files. remember the viruses that simply wiped your harddisk, leaving you without hope to ever see your files again? there are thousands of those. honestly this looks like a silly PR stunt from Kaspersky to me.</p>
<p>if they manage to crack the key though, i doubt it would be due to some new advances in cryptanalysis or weaknesses in RSA.. it would show us though, how hard it is to implement cryptographic algorithms correctly.</p>
<p>Max</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90794">

			<div class="comment by-iti ">

				<p class="commentcredit">

					<span class="commenter">ITI</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90794">
						June 13, 2008 3:33 AM					</a>

				</p>

				<p>What&#8217;s a nice idea. Using crypto-key to generate buzz for my products &#8230;.<br />
It&#8217;s a concept ! ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90795">

			<div class="comment by-bruce-schneier ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90795">
						June 13, 2008 3:46 AM					</a>

				</p>

				<p>@ Hugo:</p>
<p>That Shamir device is nothing like what these guys are asking for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90796">

			<div class="comment by-sparky ">

				<p class="commentcredit">

					<span class="commenter">Sparky</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90796">
						June 13, 2008 5:06 AM					</a>

				</p>

				<p>@Anthony: That would be one possible attack vector (searching for the key in memory or the swap file), but it won&#8217;t help those already infected, who turned off their computer.</p>
<p>The easiest defense against this particular virus, is ofcourse to just move your files out of the &#8220;my documents&#8221; folder.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90797">

			<div class="comment by-andy-dingley ">

				<p class="commentcredit">

					<span class="commenter">Andy Dingley</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90797">
						June 13, 2008 5:09 AM					</a>

				</p>

				<p>Announcing the start of a project works practically as well in a PR sense, whether the project is trivially or doomed by its complexity.</p>
<p>Are they selling any 1025 bit crypto that needs a stream of frightened potential customers for it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90798">

			<div class="comment by-piotr ">

				<p class="commentcredit">

					<span class="commenter">Piotr</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90798">
						June 13, 2008 7:37 AM					</a>

				</p>

				<p>@The Imp</p>
<blockquote><p>
  I could go on, but I can&#8217;t cram enough into a single blog post to undo a half-century of government propaganda, so you&#8217;ll probably remain unconvinced.
</p></blockquote>
<p>Yes, I&#8217;m unconvinced. Not becasuse of US government propaganda, but beacuse I live in Central Europe and I lived in communist state, apparently in contrary to you.</p>
<blockquote><p>
  Russians are not our (the US) enemies. They&#8217;re actually our allies (through NATO, plus others more recently),
</p></blockquote>
<p>When did Russia join NATO ?</p>
<blockquote><p>
  though we do disagree on a number of relatively minor issues.
</p></blockquote>
<p>What is &#8220;relatively minor issue&#8221; ? Manipulated elections, destroying free press, political murders ?</p>
<blockquote><p>
  The <em>Soviets</em> were our enemies, but that was two decades ago. The Russians were, at the time, Soviets, but there aren&#8217;t any Soviets at all anymore.
</p></blockquote>
<p>Nonsense. Russia is ruled by the same poeple it was ruled 20 years ago &#8211; OK, maybe their younger subordinates.</p>
<blockquote><p>
  Communists were not, technically, our enemies, although the original motivation for declaring the Soviets our enemies was because we didn&#8217;t like Communists.
</p></blockquote>
<p>Interesting opinion.</p>
<blockquote><p>
  Technically, the position of the US is that Communism is fine, as long as it&#8217;s not One-Party Communism (free and fair elections).
</p></blockquote>
<p>Have you ever seen communism with free and fair elections ? That&#8217;s funny.</p>
<p>Anyway, I agree that trusting any company is walking on thin ice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90799">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90799">
						June 13, 2008 7:56 AM					</a>

				</p>

				<p>@Will: &#8220;A question, since I know zilch about cryptography&#8230; Does knowing the contents, in part of whole, of the encrypted file ease decryption in a case like this?&#8221;</p>
<p>This would be called a &#8220;known plaintext attack&#8221; and any properly implemented modern algorithm will be immune to such a thing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90801">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90801">
						June 13, 2008 10:45 AM					</a>

				</p>

				<p>If the virus is using RC4 (anybody got links to solid info?), with a (possible) rekey between files why are Kaspersky bothering with the 1024RSA?</p>
<p>I would have thought examining the virus code to find out how the rekey code selects it&#8217;s next key would be a more profitable line of attack if resources are limited (especially as this is an area of encryption systems that is  most often got wrong (even by experts).</p>
<p>Further what is known about the 16byte (128bit) file size increase after encryption?</p>
<p>There may be the possibility of doing several different &#8220;attacks in depth&#8221; which for a stream cipher could be extreamly trivial.  (Such as simple Xoring two cipher texts at the same offset together to remove the key stream and then untangeling the plain texts, or using known plaintext bytes [MS Word files are full of them] to determin the keystream and then using it to see if other encrypted files are using the same section of key stream ).</p>
<p>Much of the exploritory work for &#8220;in depth&#8221; attacks can be done fully automaticaly.</p>
<p>But I would still place my money on the likelyhood of breaking the &#8220;randomisation&#8221; used to re-seed the RC4 generator than on the somewhat remote possibility of breaking the 1024RSA keys&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90802">

			<div class="comment by-alexey ">

				<p class="commentcredit">

					<span class="commenter">Alexey</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90802">
						June 13, 2008 11:26 AM					</a>

				</p>

				<blockquote><p>
  Nonsense. Russia is ruled by the same poeple it was ruled 20 years ago &#8211; OK, maybe their younger subordinates.
</p></blockquote>
<p>@Piotr</p>
<p>You&#8217;re definitely right, but <em>not</em> every Russian (i.e. someone who belongs to the Russian culture) is ruled by these bastards and <em>not</em> every company with the Russian background is related to the current Russian &#8220;power&#8221;.</p>
<p>Could you distinct the regime and the fair citizens / companies?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90803">

			<div class="comment by-ronald-van-den-heetkamp ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.0x000000.com' rel='external nofollow ugc' class='url'>Ronald van den Heetkamp</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90803">
						June 13, 2008 12:44 PM					</a>

				</p>

				<p>ROFL (times 2^2048 )</p>
<p>I guess they better try to factorize their ignorance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90804">

			<div class="comment by-peri ">

				<p class="commentcredit">

					<span class="commenter">peri</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90804">
						June 13, 2008 1:45 PM					</a>

				</p>

				<p>Sorry this is just too strange a story not to have some fun<br />
2^1024 / ln(2^1024) = .2532737277e306)</p>
<p>253,911,459,726,315,806,176,455,535,422,178,634,691,804,658,042,698,668,465,296,<br />
724,799,057,451,702,684,976,176,141,917,122,044,542,402,712,025,254,055,640,335,<br />
676,256,735,613,582,800,131,140,438,756,319,384,714,361,431,391,052,945,305,511,<br />
609,606,279,793,954,029,778,180,911,025,097,229,026,387,489,354,352,364,284,054,<br />
436,196,662,660,099,591,362,410,025,762,637,353,020,451,576,701,744,853,572,915,<br />
570,815 primes on the wall. I try 2 and the key doesn&#8217;t fall&#8230;</p>
<p>253,911,459,726,315,806,176,455,535,422,178,634,691,804,658,042,698,668,465,296,<br />
724,799,057,451,702,684,976,176,141,917,122,044,542,402,712,025,254,055,640,335,<br />
676,256,735,613,582,800,131,140,438,756,319,384,714,361,431,391,052,945,305,511,<br />
609,606,279,793,954,029,778,180,911,025,097,229,026,387,489,354,352,364,284,054,<br />
436,196,662,660,099,591,362,410,025,762,637,353,020,451,576,701,744,853,572,915,<br />
570,814 primes on the wall&#8230;</p>
<p>C&#8217;mon everybody, sing along and we&#8217;ll be done in no time!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90805">

			<div class="comment by-ronald-van-den-heetkamp ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.0x000000.com' rel='external nofollow ugc' class='url'>Ronald van den Heetkamp</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90805">
						June 13, 2008 2:10 PM					</a>

				</p>

				<p>Well, yeah that is the beauty of cryptograhpy, it isn&#8217;t kids-games it&#8217;s pure maths and clever understanding. I mean, everyone who just leanrs about cryptograhpy thinks he/she can solve it, or create his own secure algortihm.</p>
<p>Cryptograhphy learned me one thing: Watch what you say, because you do not understand how it works if you do not understand mathematics that deals with cryptography. No mistakes are allowed, you either have a secure algorithm or you don&#8217;t, there is no room between it.</p>
<p>Let alone the folks that &#8216;think&#8217; they can &#8216;crack&#8217; it. I mean, it really made my day. I am smiling all day long since I read this.</p>
<p>But anyway, let them continue, I think any respected scientist will happily look at the results if they do crack it. but untill that, it isn&#8217;t plausible thay will do so even with a tenfold of their resources.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90806">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90806">
						June 13, 2008 2:41 PM					</a>

				</p>

				<p>I think they got attacked by a competitor with the virus, who WONT sell them the key and they need to get their business files unencrypted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90807">

			<div class="comment by-ranger ">

				<p class="commentcredit">

					<span class="commenter">ranger</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90807">
						June 13, 2008 6:22 PM					</a>

				</p>

				<p>Why not just try to retrieve the original files from the harddrive rather than retrieving the key fom memory/swap as suggested in some comment here? It&#8217;s not trivial to delete a file on modern file systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90808">

			<div class="comment by-suspicious ">

				<p class="commentcredit">

					<span class="commenter">Suspicious</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90808">
						June 13, 2008 9:55 PM					</a>

				</p>

				<p>@The Imp</p>
<p>Actually, no one is safe from software vendors who have rights to automatically upload and download information to and from computers.</p>
<p>An article posted on the Internet December 21, 2007 titled &#8216;The NSA 0wnz popular firewalls and &#8216;secure&#8217; email services&#8217; would make people question software companiesâ€™ intentions.</p>
<p>Link: <a href="http://www.theinquirer.net/gb/inquirer/news/2007/12/20/nsa-0wnz-popular-firewalls" rel="nofollow ugc">http://www.theinquirer.net/gb/inquirer/news/2007/12/20/nsa-0wnz-popular-firewalls</a></p>
<p>The US government sued Microsoft Corporation several years ago for billions of dollars, but a closed-door meeting resolved the suit.</p>
<p>In 2002, John Thompson, chief executive of Symantec Corp, was appointed by President Bush to the National Infrastructure Advisory Committee (NIAC) as an advisor to the critical infrastructure of the United States.</p>
<p>Software companies that make pacts with governments should raise red flags.</p>
<p>When an anti-spyware software company is trying to figure out how to break a RSA encryption, then one should be concerned not matter for what reason.</p>
<p>Another article posted on the Internet June 11, 2008 titled â€˜Experts: Spyware Legislation Needs More Workâ€™ raises even further questions.</p>
<p>Link: <a href="http://www.cio.com/article/392113/Experts_Spyware_Legislation_Needs_More_Work" rel="nofollow ugc">http://www.cio.com/article/392113/Experts_Spyware_Legislation_Needs_More_Work</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90809">

			<div class="comment by-sooth-sayer ">

				<p class="commentcredit">

					<span class="commenter">sooth sayer</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90809">
						June 15, 2008 10:32 AM					</a>

				</p>

				<p>@Imp</p>
<p>You should actually go back to kindergarten to get some comprehension.</p>
<p>Your worldview is terribly skewed .. wonder what you are you doing reading/commenting here .. if you can&#8217;t understand &#8220;simpler&#8221; reality; it&#8217;s probably beyond your faculties to factor the 1024 bit number or worry about who will and how.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90810">

			<div class="comment by-david-keech ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ladadadada.net' rel='external nofollow ugc' class='url'>David Keech</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90810">
						June 15, 2008 8:44 PM					</a>

				</p>

				<p>Why do they need help from the community ?</p>
<p>I would have thought that that the value of the private key would be enough to compensate them for the cost of buying 15 million CPU years.<br />
They could just buy the computers themselves, determine the key and start decrypting people&#8217;s documents for a fee&#8230;</p>
<p>&#8230;as long as they were confident that they could determine the key in a reasonable time frame that is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90811">

			<div class="comment by-suspicious ">

				<p class="commentcredit">

					<span class="commenter">Suspicious</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90811">
						June 15, 2008 9:55 PM					</a>

				</p>

				<p>Kaspersky is not the only one trying to break encryption keys.</p>
<p>India is trying to break the Blackberry encryption.</p>
<p>See article posted on the Internet June 13, 2008 titled &#8216;India May Crack Blackberry Encryption.&#8217;</p>
<p>Link: <a href="http://www.informationweek.com/news/mobility/messaging/showArticle.jhtml?articleID=208403978" rel="nofollow ugc">http://www.informationweek.com/news/mobility/messaging/showArticle.jhtml?articleID=208403978</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90812">

			<div class="comment by-jay ">

				<p class="commentcredit">

					<span class="commenter">jay</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90812">
						June 16, 2008 12:53 AM					</a>

				</p>

				<p>Why not simply track the guy and get hold of his private key . .Rather than spending billions and wasting other people&#8217;s time and processing power to crack the 1024 bit RSA!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90813">

			<div class="comment by-overquantum ">

				<p class="commentcredit">

					<span class="commenter">OverQuantum</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90813">
						June 16, 2008 6:49 AM					</a>

				</p>

				<p>AFAIK, estimate to break RSA-1024 is 10^12 MIPS-years. If we divide this number by 15 millions we get performance of 66667 MIPS for each PC &#8211; this is near to Core 2 Quad benchmark results. I assume &#8220;15 million modern computers&#8221; &#8211; is based on such calculation, nothing more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90814">

			<div class="comment by-ross-snider ">

				<p class="commentcredit">

					<span class="commenter">Ross Snider</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90814">
						June 16, 2008 12:39 PM					</a>

				</p>

				<p>Why don&#8217;t we ask our good friends, the botmasters of the Storm Worm, to help?</p>
<p>Seriously, estimates of 50 million computers in that botnet and I still don&#8217;t thinking a yearlong attack on the RSA key is going to be successful (although the authors of the Storm Worm have been very resourceful).</p>
<p>This is a PR stunt or something more suspicious is going on.</p>
<p>In the case of corporate secrets being ransomed by this malware, buy data recovery tools immediately. I garuntee the virus authors haven&#8217;t securely wiped the data from the disk.</p>
<p>Also, if the authors have RC4&#8217;ed the files and transferred the &#8220;randomly&#8221; (how much do you want to bet they just &#8220;srand(time(0))&#8221;ed) chosen symmetric keys after encrypting them with a public key, how would this help those already victimized? Unless we have copies of the encrypted symmetric keys, the millions of dollars put into cracking this beast has been wasted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90815">

			<div class="comment by-vwm ">

				<p class="commentcredit">

					<span class="commenter">vwm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90815">
						June 17, 2008 4:51 AM					</a>

				</p>

				<p>@ranger:</p>
<p>Seems like sombody at kaspersky had the same idea. They are posting instructions how to undeleate the encrypted files:<br />
<a href="http://www.viruslist.com/en/viruses/encyclopedia?virusid=313444" rel="nofollow ugc">http://www.viruslist.com/en/viruses/encyclopedia?virusid=313444</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90816">

			<div class="comment by-its-all-just-randomness ">

				<p class="commentcredit">

					<span class="commenter">It&#039;s All Just Randomness</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90816">
						June 17, 2008 2:19 PM					</a>

				</p>

				<p>This will probably be at least as effective as SETI@home, which has spent zillions of CPU hours and hasn&#8217;t found jack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-90817">

			<div class="comment by-kick10 ">

				<p class="commentcredit">

					<span class="commenter">Kick10</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90817">
						June 23, 2008 4:00 PM					</a>

				</p>

				<p>I&#8217;ve recently reversed gpcode.ak binary EXE and found that encryption scheme was the following:</p>
<ol>
<li>Virus imports an open RSA key from its EXE by a call to CryptImportKey(using Microsoft Enhanced Cryptographic Provider library).</li>
<li>Then it generates first RC4 key, i&#8217;ll name it RC4key_1.</li>
<li>Then virus exports generated RC4key_1 with CryptExportKey api using previously imported open RSA key(RC4key_1 is being crypted by that open RSA key) and after that it writes the exported key to readme.txt file with bad news, then imported RSA key is being destroyed by CryptDestroyKey.</li>
<li>After that virus searches hdd for files to encrypt and acts as following:<br />
4.1 Generates a sequence of 16 pseudo-random bytes(taken from system timer), i&#8217;ll name it RND;<br />
4.2 Those 16 bytes are then crypted by RC4 algo using RC4_key1.<br />
4.3 Crypted with RC4 RND sequence is then hashed by SHA1 hash-function.<br />
4.4 A second RC4 key(I&#8217;ll name it RC4_key2) is being generated using CryptDeriveKey api, the computed SHA1 hash of RND is used as base data to derive key. After key is derived, hash is destroyed immediately.<br />
4.5 The victim file is being crypted by RC4 algorithm using derived RC4_key2, then virus writes 16 bytes of RND to the resulting file followed by encrypted file content. Resulting file has _CRYPT extension, original file is then being deleted using DeleteFile api call.<br />
4.6 RC4_key2 is being destroyed.<br />
4.7 Steps 4.1-4.5 are repeated for every file to be crypted.</li>
</ol>
<p>So the problem is to obtain RC4_key1, so we can use it to crypt &#8220;RND&#8221;, stored in every file using RC4, hash it with SHA1, derive the decryption key and save the world.</p>
<p>Now its time for cryptoanalysts to say their word&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-90818">

			<div class="comment by-vitaly-kamluk ">

				<p class="commentcredit">

					<span class="commenter">Vitaly Kamluk</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/#comment-90818">
						June 26, 2008 11:28 AM					</a>

				</p>

				<p>Dear Mr Schneier,<br />
My name is Vitaly Kamluk. I am a senior virus analyst from Kaspersky Lab. I was the one who found the first sample of Gpcode virus that uses RSA-1024 encryption.</p>
<p>First of all, let me apologize for the situation that happened. To be honest I admire people like you very much. I have been present at your speech &#8220;The Psychology of Security&#8221; at BlackHat in Las Vegas last year, and I was deeply impressed by the level of knowledge that you posses. To my concern, people who come to the questions of psychology and probably metaphysics in science are real experts in their areas. Anyone has to pass a long long way to reach this point and be able to speak about that without foolish speculations.</p>
<p>To be honest, when we discovered RSA-1024 in Gpcode virus, I thought of contacting you. But then something stopped me. Perhaps I am too modest and that let me think that the problem of single virus is not worth of such professional as you are.</p>
<p>I know that area of our expertise does not fully cover cryptography and that is why public request for help looked rather reasonable.</p>
<p>The facts are that lots of users all round the world got infected and we cannot help them. If that was a virus that totally destroyed user&#8217;s data we could answer: &#8220;we are sorry  but nothing can be done&#8221;. Today users see their files in the folders and they have a chance to get them back if them pay the criminal. An unfortunately they do. It&#8217;s not worth of explanation how it stimulates the viruswriter.</p>
<p>We have been informed about hospital being infected with the virus and something hurt me inside for this state of being helpless. I tried to work hard, to work days and nights to find a solution. I should inform you that I was lucky enough and my search was not totally fruitless. I have offered affordable method of restoring files deleted by the virus. We have announced that in blogpost:<br />
<a href="http://www.viruslist.com/en/weblog?weblogid=208187531" rel="nofollow ugc">http://www.viruslist.com/en/weblog?weblogid=208187531</a><br />
and also included tutorial in virus description:<br />
<a href="http://www.viruslist.com/en/viruses/encyclopedia?virusid=313444#doc2" rel="nofollow ugc">http://www.viruslist.com/en/viruses/encyclopedia?virusid=313444#doc2</a></p>
<p>But that&#8217;s a poor solution and I believe it will not help in new versions of the virus.</p>
<p>After that I switched to reverse engineering approach and we were lucky enough to find a flaw in scheme that was used by the virus. This flaw allowed us to restore about 80% of encrypted files in the lab (the conditions were virtually ideal). In real world this conditions are not common so I believe that the real percentage of decrypted files will be much lower (to my concern less than 50%).</p>
<p>You are the first one who I informed about that, because I have seen your interest in the case of Gpcode virus by reading your critical comments on your blog. Here is our official announcement:<br />
<a href="http://www.viruslist.com/en/weblog?weblogid=208187538" rel="nofollow ugc">http://www.viruslist.com/en/weblog?weblogid=208187538</a><br />
Full description and link for the tool can be found here (Chapter &#8220;Decrypting files using StopGpcode2&#8221;):<br />
<a href="http://www.viruslist.com/en/viruses/encyclopedia?virusid=313444" rel="nofollow ugc">http://www.viruslist.com/en/viruses/encyclopedia?virusid=313444</a></p>
<p>I think that we will NOT disclose the idea of the flaw to public audience to delay the viruswriter on reversing and learning from his mistakes and improving the algorithm afterwards. And that is why I am asking every researcher who reads these lines and has already reversed or is going to reverse our solution: please, do not publish internals of the tool and do not discuss it publicly. I hope for your understanding and believe that intelligent people like you will not help evil.</p>
<p>We know that virus will return and there will be followers. That is why, Bruce, if I am allowed to speak here, I would like to offer you join us in this battle, because I strongly believe that it <em>SHOULD NOT</em> be a battle for the benefit of a single company, but it <em>SHOULD</em> be the battle for the sake of humankind.</p>
<p>Kind regards,<br />
Vitaly Kamluk</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2008/06/kaspersky_labs.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2008/06/kaspersky_labs.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F06%2Fkaspersky_labs.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2008/06/kaspersky_labs.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='2305' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2008/06/secrecy_the_mov_1.html" rel="prev">â† <i>Secrecy</i>, the Movie</a>		<a href="https://www.schneier.com/blog/archives/2008/06/top_secret_al_q.html" rel="next">Top Secret Al Qaeda Documents Left on London Train â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
