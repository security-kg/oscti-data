<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Malware Installed in Asus Computers through Hacked Update Process - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Malware Installed in Asus Computers through Hacked Update Process Comments Feed" href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/11998" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2019/03/malware_install.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=11998' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F03%2Fmalware_install.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F03%2Fmalware_install.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-11998 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-11998" class="post-11998 post type-post status-publish format-standard hentry category-uncategorized tag-hacking tag-malware tag-supply-chain">

	<div class="article">

		<h2 class="entry">Malware Installed in Asus Computers through Hacked Update Process</h2>
		<p>Kaspersky Labs is <a href="https://securelist.com/operation-shadowhammer/89992/">reporting</a> on a new supply chain attack they call &#8220;Shadowhammer.&#8221;</p>
<blockquote><p>In January 2019, we discovered a sophisticated supply chain attack involving the ASUS Live Update Utility. The attack took place between June and November 2018 and according to our telemetry, it affected a large number of users. </p>
<p>[&#8230;]</p>
<p>The goal of the attack was to surgically target an unknown pool of users, which were identified by their network adapters&#8217; MAC addresses. To achieve this, the attackers had hardcoded a list of MAC addresses in the trojanized samples and this list was used to identify the actual intended targets of this massive operation. We were able to extract more than 600 unique MAC addresses from over 200 samples used in this attack. Of course, there might be other samples out there with different MAC addresses in their list.</p>
<p>We believe this to be a very sophisticated supply chain attack, which matches or even surpasses <a href="https://securelist.com/shadowpad-in-corporate-networks/81432/">the Shadowpad</a> and the <a href="https://.avast.com/update-to-the-ccleaner-5.33.6162-security-incident">CCleaner</a> incidents in complexity and techniques. The reason that it stayed undetected for so long is partly due to the fact that the trojanized updaters were signed with legitimate certificates (eg: &#8220;ASUSTeK Computer Inc.&#8221;). The malicious updaters were hosted on the official liveupdate01s.asus[.]com and liveupdate01.asus[.]com ASUS update servers.</p></blockquote>
<p>The sophistication of the attack leads to the speculation that a nation-state &#8212; and one of the cyber powers &#8212; is responsible.</p>
<p>As I have <a href="https://www.schneier.com/blog/archives/2018/05/supply-chain_se.html">previously written</a>, supply chain security is &#8220;an incredibly complex problem.&#8221; These attacks co-opt the very mechanisms we need to trust for our security. And the international nature of our industry results in an array of vulnerabilities that are very hard to secure.</p>
<p>Kim Zetter has a <a href="https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers">really good article</a> on this. Check if your computer is infected <a href="https://shadowhammer.kaspersky.com/">here</a>, or use <a href="https://dlcdnets.asus.com/pub/ASUS/nb/Apps_for_Win10/ASUSDiagnosticTool/ASDT_v1.0.1.0.zip">this diagnostic tool</a> from Asus.</p>
<p>Another <a href="https://www.tomshardware.com/news/asus-live-update-utility-software-hacked-update,38927.html">news article</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/supply-chain/" rel="tag">supply chain</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html" rel="bookmark">Posted on March 28, 2019 at 6:42 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html#comments">35 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2019/03/malware_install.html" data-title="Malware Installed in Asus Computers through Hacked Update Process" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-334306">

			<div class="comment by-jonknowsnothing ">

				<p class="commentcredit">

					<span class="commenter">JonKnowsNothing</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334306">
						March 28, 2019 9:24 AM					</a>

				</p>

				<p>There are at least 2 groups interested in grabbing access to products going into mass market</p>
<ol>
<li>Security Services  &#8211;  These are unstoppable.  See NSA repacking a Cisco Router.</li>
<li>Other folks for a lot of reasons &#8211; Money, Trolling, Notoriety and Pawnage.  See Lion King CD Distro when original CDs contained XXX content inserted during the CD Stamping Process.</li>
</ol>
<p>Attacking supply systems is a long standing military objective. It&#8217;s a very refined attack system and JIT made it super easy to do.</p>
<p>Trying to explain to people that just because it says XXX or the LED is green or it is in shrink wrap does not mean it really is XXX or the system is not failing or it&#8217;s not been rewrapped, this doesn&#8217;t seem to connect the dots for them.</p>
<p>While this concerns technology attacks, the same goes for consumer goods and foods.  Faked Virgin Olive Oil, prohibited products in foods, mislabeled items, rewrapped meats.  It&#8217;s old hat and well known.</p>
<p>For every bar we place to prevent redirection, it is only as good as the implementation.  The system that permits an Updater to update malware or badware or crapware is useful for Group 1.  They do it regularly.  They are not going to allow the necessary changes.  Or at least not until a whole lot of folks refuse Dragonfly work projects and the companies that profit from them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334307">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334307">
						March 28, 2019 10:44 AM					</a>

				</p>

				<p>This is a point that neads further investigation / explanation,</p>
<p>&#8220;&#8216;The reason that it stayed undetected for so long is partly due to the fact that the trojanized updaters were signed with legitimate certificates (eg: &#8220;ASUSTeK Computer Inc.&#8221;).'&#8221;</p>
<p>The use was most unlikely to have been &#8216;legitimate&#8217; which implies one of three things,</p>
<p>1, Private Key was stolen.<br />
2, Private Key was remade.<br />
3, Some form of collision was found.</p>
<p>Whilst nearly anybody can do the first because the technical skills are well known and fairly easily aquired, the last two are potentially restricted to just a handfull or two at the most of organisations in the world.</p>
<p>Of those you are looking at the SigInt agencies with not just the brains but also the computing resources to carry them out.</p>
<p>Also this is in many ways an apparent replay of stuxnet, with very few actual targets in it&#8217;s scope (which also would have helped keep it covert).</p>
<p>It would be interesting to see the 600 numbers and use a service like Shodan etc to track them down to networks thus potentialy identify the targets. Then work backwards to identify the attackers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334308">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334308">
						March 28, 2019 11:01 AM					</a>

				</p>

				<p>@ALL:</p>
<p>Just one thing to remember MAC addresses are not always easy to get or associate with an individual.</p>
<p>One good way to do it is when the person crosses a boarder and the laptop is turned on to see it&#8217;s not a bomb etc&#8230;</p>
<p>Thus a small bet is all the targets have traveled to only one or two countries collectively.</p>
<p>But for others, for goodness sake do not take your main laptop phone etc abroad with you, it&#8217;s an APT risk to far for any sensible person to do these days.</p>
<p>It is a certain bet that at a number of boarders all your electronics are enumerated in many ways and they are all then stored away against the Identity in your travel documents along with your picture, finger print etc and no doubt in some cases your DNA and other fingerprints from the VIP / frequent flier lounge etc.</p>
<p>Yes it might sound a little paranoid today, but think of your tommorows. We&#8217;ve been through the same with &#8216;collect it all&#8217; where you were paranoid before Ed Snowden and had good insight or insider knowledge afterwards. Be very clear they are out to get us all because like those collecting PII for advertising the information has value. Yours might be worthless today but will it always be? Likewise the person standing next to you in the airport que their DNA etc might be of value beyond price, thus overall the average cost of collecting everybodies DNA fingerprints and images is easily worth the minor price per individual, and it will only get less costly with time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334309">

			<div class="comment by-nobody-interesting ">

				<p class="commentcredit">

					<span class="commenter">nobody interesting</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334309">
						March 28, 2019 12:14 PM					</a>

				</p>

				<p>A couple of things I&#8217;ve seen missing from most reporting on this:</p>
<p>1) Asus needs to revoke those certs (Zetter at least mentioned this), and rethink how it protects them in future, if they&#8217;re serious.  Everything else is just window dressing if they don&#8217;t get that part right; and</p>
<p>2) Has anyone wondered whether Asus was complicit?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334310">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">Jack</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334310">
						March 28, 2019 1:36 PM					</a>

				</p>

				<p>Mueller must reopen the Donald Putin investigation ASAP.<br />
Only a russian spy in the White Kremlin House could pull this off.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334311">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334311">
						March 28, 2019 1:38 PM					</a>

				</p>

				<p>One of the reasons this happened and for so long is that the current code signing peocess is broken.</p>
<p>A search of this blog shows that the failings of code signing has been mentioned for a decade or more, and two names saying it&#8217;s not a good idea and why show up regularly, @Nick P and @Clive Robinson.</p>
<p>So to add to those comments,</p>
<p>In this case the failure is the &#8220;Upload and forget&#8221; behaviour of the organisation concerned. That is they can not have had a policy of actually checking the files after they were uploaded to ensure they had not been changed at any point in time in a timely manner.</p>
<p>After the warning of stuxnet not doing this sort of checking realy is negligent behaviour.</p>
<p>There are several fairly easy ways such &#8216;image checking&#8217; can be done, but it would be wise these days to do a byte by byte comparison and not rely on hashes, as the likes of the NSA and GCHQ might have broken them.</p>
<p>In essence a copy of the files in genuine Read Only Format needs to be put on an effectively hidden computer. It either pulls the files on the public server down to check them every half hour or so. Or it&#8217;s a little more sophisticated and checks the files &#8216;off the wire&#8217; as users download them. Either way the malware substitute would have been caught very very quickly.</p>
<p>Whilst that will not solve the other issues identified and put up on this blog in the past, it will block this particular attack in future.</p>
<p>However it needs to be said that their have been other attacks developed by the GCHQ and the NSA that could achive the same result. That is the &#8216;get in quick&#8217; attack where the first TCP packet that arives at the destination machine is accepted. Thus if the SigInt agencies can have the files distributed around the net they can get their malware loded packets to a users computer first.</p>
<p>As easy as this sounds, it&#8217;s actually going to be quite hard to implement with COST systems. But that does not in any way suggest they do not have the capabilities to do it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334312">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">TatÃ¼tata</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334312">
						March 28, 2019 3:42 PM					</a>

				</p>

				<p><i>The malware had 600 unique MAC addresses it was seeking</i></p>
<p>If the malware looks for specific machine, characterised by a MAC for each adapter (Ethernet and a WiFi), then only 300 machines are really concerned.</p>
<p>How did the attacker select the MAC addresses? By running malware on the ASUS update server, and finding out who came to the watering hole that met the criteria? I found no mention of the common denominator linking the machines. A country? A company? Did AG Barr bowdlerize the report? [SNCR] A fuller picture might help Kaspersky reestablish its reputation.</p>
<p><i>Buried in those malicious samples were hard-coded MD5 hash values that turned out to be unique MAC addresses for network adapter cards. </i></p>
<p>OK, now we know that the malware was written by a 100â‚¬ rent-a-coder. ðŸ™‚</p>
<p>What&#8217;s not clear to me what exactly needs to be updated directly by ASUS. The machines would usually call home to Redmond for OS updating, but a BIOS upgrade would normally be initiated manually by the user. Stuff like video drivers would be delivered over the Microsoft channel, and not the OEM, isn&#8217;t it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334313">

			<div class="comment by-steve-friedl ">

				<p class="commentcredit">

					<span class="commenter">Steve Friedl</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334313">
						March 28, 2019 3:59 PM					</a>

				</p>

				<p>The thing that concerns me is:</p>
<blockquote><p>
Kamluk said Kaspersky notified ASUS of the problem on January 31, and a Kaspersky employee met with ASUS in person on February 14. But he said the company has been largely unresponsive since then and has not notified ASUS customers about the issue.
</p></blockquote>
<p>Hey, I get that it&#8217;s hard to get this stuff right, and an oopsie can happen, but the real test is whether a company does the right thing once the oopsie is pointed out or not.</p>
<p>Going dark, pretending it didn&#8217;t happen, and volunteering to suck don&#8217;t make me want to do business with a company.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334314">

			<div class="comment by-sam ">

				<p class="commentcredit">

					<span class="commenter">Sam</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334314">
						March 28, 2019 4:08 PM					</a>

				</p>

				<p>@nobody: Good question.  Apparently the malware was based on a modified version of a several-year-old legimate ASUS file, pointing towards attackers who were able to compromise Asus&#8217;s signing and distribution infrastructure but not their code building/deploying infrastructure.  Had Asus (or individuals within it) been complicit, they likely (but who really knows) would have injected the malware as a software build dependency, not post-build at the signing stage.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334315">

			<div class="comment by-john-brown ">

				<p class="commentcredit">

					<span class="commenter">John Brown</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334315">
						March 28, 2019 4:09 PM					</a>

				</p>

				<p>I&#8217;m really interested in who was the target here.</p>
<p>It&#8217;s not like Asus are Lenovo, or even Dell or HP.</p>
<p>Would any serious organization actually buy Asus laptops?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334316">

			<div class="comment by-john-brown ">

				<p class="commentcredit">

					<span class="commenter">John Brown</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334316">
						March 28, 2019 4:13 PM					</a>

				</p>

				<p>Ohhhh.. question answered. I didn&#8217;t realize Asus were Taiwanese. This is obviously some sort of Red Chinese operation against the Taiwanese, who might buy Asus hardware even for serious use for purely patriotic reasons.</p>
<p>Nothing wrong with that, but hope they require the company to fix their security issues in future.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334317">

			<div class="comment by-polar ">

				<p class="commentcredit">

					<span class="commenter">POLAR</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334317">
						March 28, 2019 5:48 PM					</a>

				</p>

				<p>Mixed thoughts:<br />
1- If some state agency wants to know more about 600 MAC addresses this is none of our business and anyway if they really want them nothing can prevent it. And, if they&#8217;re doing their homework properly(and why are we doubting it?) then it is a good thing that those MACs are taken care of.<br />
2- Have the MACs been published? Are they single MACs or across a range?<br />
3- Certificates give a false sense of security<br />
4- From an entrepreneur POV, I like spies to spy. It&#8217;s their job. If they are doing their job, well that is great.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334318">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334318">
						March 28, 2019 10:51 PM					</a>

				</p>

				<p>@ legal experts</p>
<p>Points to the ccleaner malware, the shadowpad malware and now Azus Shadow hammer malware and to court document where Microsoft is suing Barium a player in the malware game. Kaspersky hints that the true identify of one individual have been revealed in that court document.</p>
<p>Can some legal person find who is actually named in the case which venue is the Virginia Fort Mead area.</p>
<p>SecureList <a href="https://securelist.com/operation-shadowhammer/89992/" rel="nofollow ugc">https://securelist.com/operation-shadowhammer/89992/</a><br />
 =&gt; Microsoft court document =&gt;</p>
<p><a href="https://www.courthousenews.com/wp-content/uploads/2017/11/barium.pdf" rel="nofollow ugc">https://www.courthousenews.com/wp-content/uploads/2017/11/barium.pdf</a></p>
<p>Can anybody identify the barium guy?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334319">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334319">
						March 28, 2019 11:14 PM					</a>

				</p>

				<p>@65535:</p>
<p>&#8220;Can some legal person find who is actually named in the case which venue is the Virginia Fort Mead area.&#8221;</p>
<p>Fort Mead area&#8230; Now who do we normally assosiate with that geography ðŸ˜‰</p>
<p>They do say &#8216;acorns don&#8217;t fall far from the tree&#8217;&#8230;</p>
<p>This might start a rumour or ten 0:)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334320">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334320">
						March 29, 2019 12:17 AM					</a>

				</p>

				<p>@65535:</p>
<p>The Microsoft court submission is well worth reading as it actually gives a nice description of how the Barium persons go about their activities.</p>
<p>Interestingly is the use of a &#8216;headless C&amp;C&#8217; technique (see paragraph 29 onwards) using blogs etc that was first publicaly described in almost exactly the same way on this blog some years ago now. So one or more of the Barium individuals might well be readers of this blog.</p>
<p>In which case &#8216;Hi guys, how are your collars feeling a little hot and tight?&#8217;</p>
<p>Microsoft appear to believe that the targets for their activities are mainly in the Virginia area. Also one of the code break downs of the malware indicates that if the language on the computer is either Russian or Chinese it stops dead at that simple first check.</p>
<p>But Microsoft either don&#8217;t know the warm body names of the two people they think they have found behind Barium or they are being a little cautious.</p>
<p>That said in other unrelated cases Brian Krebs has not just found warm bodies on less info in the past, he&#8217;s actually found their real phone numbers and called them, so it&#8217;s likely these Barium guys are as tracable with a little bit of investigation. That is unless their OpSec has been better than professional.</p>
<p>Anyway it&#8217;s &#8216;turning in time&#8217; the brain is getting tired I&#8217;ll have a further look over things when I get up to greet the cold light of day ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334321">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334321">
						March 29, 2019 4:01 AM					</a>

				</p>

				<p>@1&amp;1 wrote, &#8220;But for others, for goodness sake do not take your main laptop phone etc abroad with you, it&#8217;s an APT risk to far for any sensible person to do these days.&#8221;</p>
<p>Are you not mistaken thanks to Prez. Obama all Americans were already mandated to disclose personal data to foreign governments. A couple MAC numbers shy in comparison.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334322">

			<div class="comment by-petre-peter ">

				<p class="commentcredit">

					<span class="commenter">Petre Peter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334322">
						March 29, 2019 7:09 AM					</a>

				</p>

				<p>What could i  possibly do with a version of Live Update besides installing it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334323">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334323">
						March 29, 2019 9:06 AM					</a>

				</p>

				<p>@1&amp;1~=Umm</p>
<p>1, Private Key was stolen.<br />
2, Private Key was remade.<br />
3, Some form of collision was found.</p>
<hr />
<p>4, Social engineering was used to convince a third party that the attacker&#8217;s public key was legitimate.</p>
<p>The fourth option is trivial for many intelligence agencies, especially when the third party has to deal with their jurisdiction.  However, Kevin Mitnick has convincingly shown that this attack can often be pulled off by a single talented individual.</p>
<p>There&#8217;s a whole long chain of trust here, and plenty of them are pretty weak.  Don&#8217;t assume that a collision was made when rubber hose cryptography would work much easier (or more likely social engineering).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334324">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334324">
						March 29, 2019 11:02 AM					</a>

				</p>

				<p>@wumpus:</p>
<p>&#8220;There&#8217;s a whole long chain of trust here, and plenty of them are pretty weak. Don&#8217;t assume that a collision was made when rubber hose cryptography would work much easier (or more likely social engineering).&#8221;</p>
<p>In the general case I&#8217;d agree with you.</p>
<p>But in this case some are claiming a million users were effected all over the globe, I can not see how they were socialy engineered in this case.</p>
<p>However yes people at the development end could have been hoodwinked or coerced in various ways to hand over either the private key or access to it. But I kind of see that as &#8216;part and parcel&#8217; of the trade of theft / stealing. Frequently insiders are turned by blackmail or having members of their family threatened in various ways, along with &#8216;doing a friend a favour&#8217; or being &#8216;given a drink&#8217;.</p>
<p>The smarter criminals learned long ago &#8211;unlike many others&#8211; that as a method of obtaining information, goods, or services, physical tourture of an individual was not as successfull and far riskier than threatening to do it to somebodies loved one. That is you make the individuals mind turn on themselves through their imagination. Essentially it&#8217;s how the protection racket works, actually hurting people is reserved for those who either lack imagination or for some reason don&#8217;t care and of these about one in six are likely to repay the favor ten or twenty fold which is one of the ways in which we end up with street gang warfare and injured bystanders. Which is bad for business which is why the smarter criminals tend to be more wary of using violence than others, and when they do, they tend not to leave those who might seek revenge behind. Which is why there are actually gangland &#8216;hit men&#8217; / &#8216;mechanics&#8217; actively employed, the less smart of whom tend to get caught. As has been pointed out killing people is easy but stupid unless you have meticulously pland how to stop enquires by the authorities or those left behind being made.</p>
<p>Similar issues arise with recruiting and using insiders as the Greek Phone Tapping scandle made clear.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334325">

			<div class="comment by-peter-gerdes ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://infiniteinjury.org/blog' rel='external nofollow ugc' class='url'>Peter Gerdes</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334325">
						March 29, 2019 12:50 PM					</a>

				</p>

				<p>I wonder if it might be desirable to establish a number of trusted platforms for hosting the hashes of software updates so that software update tools can download the hash from a number of platforms and ensure they all agree as well as agreeing with the actual update.</p>
<p>This would substantially reduce the risk of undetected software update attacks since it would force the malicious code to be contained in all versions of the update increasing the chances that security researchers would discover it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334326">

			<div class="comment by-denton-scratch ">

				<p class="commentcredit">

					<span class="commenter">Denton Scratch</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334326">
						March 30, 2019 8:26 AM					</a>

				</p>

				<p>@Tatutata (give or take an umlaut)</p>
<p>&#8220;How did the attacker select the MAC addresses? By running malware on the ASUS update server, and finding out who came to the watering hole that met the criteria?&#8221;</p>
<p>No.</p>
<p>MAC addresses don&#8217;t generally propagate over IP; the Asus update server doesn&#8217;t see the visitor&#8217;s MAC address.</p>
<p>Broadly speaking, you need to have hands on the machine whose MAC address you want, or be able to connect to it over ethernet (MAC addresses are used exclusively in the ethernet protocol). At risk of pointing out the obvious, ethernet is a LAN protocol. So you can&#8217;t just hoover up the MAC addresses of all those visiting your website.</p>
<p>So whoever targeted those MACs had either laid hands on the corresponding PCs (e.g. border agents); or they had local access to the PC in question (perhaps via some kind of trojan or &#8216;implant&#8217;); or they had local (or equivalent) access to another machine on the same LAN (perhaps by infiltrating that LAN).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334327">

			<div class="comment by-denton-scratch ">

				<p class="commentcredit">

					<span class="commenter">Denton Scratch</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334327">
						March 30, 2019 11:39 AM					</a>

				</p>

				<p>To be clear: my supposition is that the MACs were collected from a single LAN, or perhaps a group of related LANs, by an intruder. I would like to know what the investigators know about the MAC addresses in question; there is no comment on this from the authors or from Kaspersky.</p>
<p>If the MACs represent a commercial or government entity, then there is a good chance that the network adapters were made by the same manufacturer &#8211; with the result that the default MAC address of many of those adapters will share the same prefix.</p>
<p>Have the owners of these LANs been notified? Or even identified?</p>
<p>I suspect that quite a lot of information about this story has been kept under wraps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334328">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334328">
						March 30, 2019 12:44 PM					</a>

				</p>

				<p>@Denton Scratch @TatÃ¼tata:</p>
<p>&#8220;So whoever targeted those MACs had either laid hands on the corresponding PCs&#8221;</p>
<p>There are potentially another ways.</p>
<p>You could also get them from hotels and confrences etc where your target &#8216;uses the WiFi&#8217;, it&#8217;s not exactly difficult to turn an Android Mobile Phone into a WiFi sniffer. You could also just act as an AP with an Android phone without any modification so you could just walk up and sit at the same table with your phone in your top pocket&#8230;</p>
<p>Also there are less obvious ways favoured by various ICs so either &#8216;hands on&#8217; in the supply chain or &#8216;access to records&#8217; from the supply chain may well work.</p>
<p>Because MACs are &#8211;allegedly&#8211; unique, they do get used from time to time as &#8216;serial numbers&#8217; in software and the like (stupid I know but then anything to save 0.01cents in FMCE design).</p>
<p>But geting access to corporate LANs may not be as difficult as it sounds. Remember those Russia&#8217;s that got the order of the boot for activities incompatible with diplomatic behaviour?</p>
<p>They were set up to go WiFi sniffing from a hotel car park to a target organisation. It&#8217;s altogether possible there has been a &#8216;drive by&#8217; passive sniff of traffic from a commercial site and the WiFi MACs are what are in the file.</p>
<p>The thing that a lot of people either do not know or have forgotton is MACs are like ISBNs not only are they effectively unique, they get issued in blocks or ranges, thus the first digits are in effect a &#8216;Manufacturers Code&#8217; and due to the way things get manufactured other digits may end up being the equivalent of a &#8216;model number&#8217;.</p>
<p>If the MACs were obtained from a &#8216;drive by&#8217; it&#8217;s also possible that this attack against Asus is not unique and other manufactures support sites have also been attacked in the same way&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334329">

			<div class="comment by-rachel ">

				<p class="commentcredit">

					<span class="commenter">RachEl</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334329">
						March 30, 2019 11:48 PM					</a>

				</p>

				<p>TatÃ¼tata<br />
OK, now we know that the malware was written by a 100â‚¬ rent-a-coder. ðŸ™‚</p>
<p>See! Code cutters CAN be professionals ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334330">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334330">
						March 31, 2019 12:00 AM					</a>

				</p>

				<p>@ 1&amp;1~=Umm and Denton Scratch</p>
<p>&#8220;They do say &#8216;acorns don&#8217;t fall far from the tree&#8217;&#8230;Microsoft either don&#8217;t know the warm body names of the two people they think they have found behind Barium or they are being a little cautious.&#8221;</p>
<p>Yes, that makes me wonder.</p>
<p>As for the Russian and the Chinese &#8211; it is always them.</p>
<p>As for the MAC targeting that is very interesting.</p>
<p>&#8220;I suspect that quite a lot of information about this story has been kept under wraps.&#8221;-Dent</p>
<p>Yes, that is my reading of the situation. That also makes me wonder.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334331">

			<div class="comment by-rach-el ">

				<p class="commentcredit">

					<span class="commenter">Rach El</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334331">
						March 31, 2019 1:59 AM					</a>

				</p>

				<p>65535<br />
I wonder if MAC spoofing would circumvent the malware, or whether it is sufficiently sophisticated   to seek out the hardcoded original MAC of the hardware. As I believe has already been mentioned,  600 is such a tiny number. It is so specific!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334332">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334332">
						March 31, 2019 4:30 AM					</a>

				</p>

				<p>@65535:</p>
<p>&#8220;As for the Russian and the Chinese &#8211; it is always them.&#8221;</p>
<p>Of course not, nor is it just the US &#8216;Evil Axis of Four&#8217; which adds Iran and North Korea, they are all &#8216;distant bogiemen who&#8217;s faces the people will never see, and who&#8217;s voices will never be heard&#8217; so convenient as &#8216;whiping boys&#8217;.</p>
<p>Why? Because we actually know that any and every Nation State with the ability to do it &#8216;are doing it&#8217; and even those without the native ability are &#8216;buying it in&#8217; or in effect &#8216;outsourcing it&#8217;. Because if they were not there would not be so many private companies making very large amounts of money from packaging up exploits and back end big data systems for them. As somebody used to point out here about the US and the &#8216;Evil Axis,of four&#8217;, &#8216;logically it does not make sense&#8217;, thus is either highly improbable or effectively in human terms impossible.</p>
<p>But if you agree or not with the further &#8216;Orwellian 1984&#8217; premise that &#8216;Every great state requires a distant enemy for the people to focus on&#8217; as a way to stop them &#8216;focusing on their state and it&#8217;s failings towards them&#8217;. The US administrations &#8216;Evil Axis of four&#8217; is unquestionably a cynically motivated political driven narative, ment as a diversion from the real state of things&#8230; Such behaviour, would more properly be called propaganda, if the US Goverment was legaly alowed to use it. But supposadly they are not, so instead we could use a nu-speak name of &#8216;Fake-News&#8217;, or should it be &#8216;Real-News&#8217; (with the unwritten tag line of &#8216;We know it&#8217;s Real because we reboil it fresh every day for you to consume&#8217;).</p>
<p>As for &#8216;keeping it under wraps&#8217; I doubt we will ever know the truth. If things can be made out to be &#8216;A distant enemy&#8217; then indictments can be issued, Grand Juries held, and a ham sandwich can be tried in absentia, massive fines levied, and thus sactions issued. All like a well oiled machine unless like a group of Russians you instruct US lawyers to contest the indictments from day one&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334333">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334333">
						March 31, 2019 5:10 AM					</a>

				</p>

				<p>@Rach El:</p>
<p>&#8220;I wonder if MAC spoofing would circumvent the malware, or whether it is sufficiently sophisticated to seek out the hardcoded original MAC of the hardware.&#8221;</p>
<p>The reason I said &#8216;MACs are &#8211;allegedly&#8211; unique&#8217; is that back a long time ago with the NE2000 cheapnet ethernet card, hardware manufacturers started using &#8216;Electricaly Erasable Programmable Read Only Memory&#8217; (EEPROM) that we now call &#8216;Flash&#8217; memory to store the MAC in, so there is not actually a &#8216;hardcoded original MAC&#8217; any more, which is why it&#8217;s daft to use it with the likes of Radius etc as an authentication method.</p>
<p>So yes not just run time spoofing will work but with the right bit of code the Flash can be changed as well (failing that at one time a hardware &#8216;chip clamp&#8217; and change it electrically, if the Flash is a seperate chip, which in these days of SoCs is less likely).</p>
<p>What people tend to forget in this day and age of security vunerabilities is that &#8216;knowing a number&#8217; is not a way to authenticate. Likewise &#8216;using a secret number&#8217; is no better when people have access to the hardware. For two reasons,</p>
<p>1, Layers of software.<br />
2, Manufacturing returns.</p>
<p>There are so many layers of software between the &#8216;number&#8217; and the interface over which authentication happens that it&#8217;s not possible to check and verify on a remote machine, because it can be programed to lie (look up &#8216;GÃ¶del Machines&#8217;).</p>
<p>The profit in &#8216;Fast Moving Consumer Electronics&#8217; (FMCE) is quite small (to non existant with IoT). The cost of a &#8216;return for repair&#8217; is eyewateringly expensive when compared to that of the distribution cost. Therefore anything and everything that can be done remotely across a near zero cost to transfer information network is going to be done. This in effect means &#8216;full mutability&#8217; even in the CPU. As long as things are mutable someone is going to change then, as that is the nature of the human condition. No matter what security you put in place on the hardware, someone will work out how to get around it, again it&#8217;s part of the human condition.</p>
<p>Any one who ignores those two facts is in for a rude shock as the &#8216;Cable and Satellite set top box&#8217; manufacturers found out over and over again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334334">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334334">
						March 31, 2019 3:39 PM					</a>

				</p>

				<p>@ Rach El and 1&amp;1~=Umm</p>
<p>â€œI believe has already been mentioned, 600 is such a tiny number. It is so specific!â€</p>
<p>Yes, I agree. That sounds like a targeted attack. Give then next postâ€¦it makes me wonder.</p>
<p>â€œAs for &#8216;keeping it under wraps&#8217; I doubt we will ever know the truth.â€ -1&amp;1~=Umm</p>
<p>That usually takes a large amount power and machinery in the States â€“ wilth all the leaksâ€¦ Snowden and so on. But, NSLs are a powerful tool.</p>
<p>Sure, any truly well financed and focused nation or group could have done it. We will have to wait and see.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334335">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334335">
						March 31, 2019 10:00 PM					</a>

				</p>

				<p>@65535 @Rach El:</p>
<p>&#8220;Sure, any truly well financed and focused nation or group could have done it.&#8221;</p>
<p>But &#8216;the law of the acorn&#8217; like Ocams Razor is most often a good indicator, as is the old saying about &#8216;a dog and it&#8217;s vomit&#8217; or &#8216;criminals and the scene of the crime&#8217;.</p>
<p>So yup if I had to make a small wager, &#8216;nation state&#8217; and one that&#8217;s been caught &#8216;red handed&#8217; tampering with not just the &#8216;supply chain&#8217; but also &#8216;code signing&#8217;. Which kind of indicates the US IC.</p>
<p>But it would only be a small wager, because in the hall of &#8216;smoke and mirrors&#8217; that is &#8216;The Great Game&#8217; play room that even Kipling noticed, like many children they also like to play &#8216;follow my leader&#8217; and &#8216;Simon Says&#8217; (which is also what the banks did that got us into &#8216;Banking Crisis One&#8217; and &#8216;Banking Crisis Two&#8217;).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334336">

			<div class="comment by-josh ">

				<p class="commentcredit">

					<span class="commenter">Josh</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334336">
						April 1, 2019 3:58 AM					</a>

				</p>

				<p>&#8220;MAC addresses don&#8217;t generally propagate over IP; the Asus update server doesn&#8217;t see the visitor&#8217;s MAC address. &#8221;</p>
<p>I&#8217;m not quite so sure that MAC don&#8217;t propagate over IP.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334337">

			<div class="comment by-citizen0 ">

				<p class="commentcredit">

					<span class="commenter">citizen0</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334337">
						April 1, 2019 9:28 PM					</a>

				</p>

				<p>&#8220;supply chain security is &#8220;an incredibly complex problem.&#8221;&#8221;</p>
<p>Why?</p>
<p>It seems to me the answer is simple: Corporations need to stop using minimal security to save $$, or be held financially accountable when they don&#8217;t.</p>
<p>Every time we see major corporations being hacked, there&#8217;s a rush of people saying &#8220;security is hard&#8221; but when the next attack occurrs, it seems as if they&#8217;ve attempted nothing to abate it.</p>
<p>Questions nobody is asking:</p>
<ol>
<li>How did hackers upload the trojan to the update server?</li>
<li>WHY was the update server not made read-only on the public side?</li>
<li>WHY doesn&#8217;t ASUS have the ability to check any new files added to their servers with a hash table to see if it is one of their own?</li>
</ol>
<p>All these corporate hacks make me think of a person who, in order to save money, decided to only put screen doors on their house instead of lock-and-key doors. Then they wonder why they keep getting robbed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334338">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334338">
						April 2, 2019 5:13 AM					</a>

				</p>

				<p>@:</p>
<p>&#8220;Why?&#8221;</p>
<p>Simple answer, is if the NSA with one of the largest budgets in the world can not get it right, how much do you think it would cost consumers for all companies to get it right?</p>
<p>Yup economic activity as we currently know it would cease to exist and apart from security work as guard labour so would most jobs.</p>
<p>With regards,</p>
<p>&#8220;Questions nobody is asking:&#8221;</p>
<p>Some of them have been asked befor, in fact years before. I used to advise clients that web sites should where possible be static and read only or deploy a checking method as I described above,</p>
<p>&#8220;&#8216;In essence a copy of the files in genuine Read Only Format needs to be put on an effectively hidden computer. It either pulls the files on the public server down to check them every half hour or so. Or it&#8217;s a little more sophisticated and checks the files &#8216;off the wire&#8217; as users download them. Either way the malware substitute would have been caught very very quickly.'&#8221;</p>
<p>But as I noted above it does not solve all of the problems as &#8216;State Level&#8217; attackers have shown they have other methods that site owners can do nothing about.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-334339">

			<div class="comment by-petre-peter ">

				<p class="commentcredit">

					<span class="commenter">Petre Peter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334339">
						April 3, 2019 7:44 PM					</a>

				</p>

				<p><cite>Updates need to be authenticated, to prevent attackers from tricking you into installing a malicious update.</cite></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-334340">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/#comment-334340">
						April 4, 2019 2:40 AM					</a>

				</p>

				<p>@Petre Peter:</p>
<p>&#8220;Updates need to be authenticated, to prevent attackers from tricking you into installing a malicious update.&#8221;</p>
<p>The malicious update in this case was authenticated, that&#8217;s why so many machines accepted the download.</p>
<p>The simple fact is &#8216;code signing&#8217; is not a very good way to do such authetication, and it never has been, as people have indicated on this blog and other places in the past decade or so.</p>
<p>For authentication to work it has to be robust in security terms and not subject to numerous &#8216;single points of failure&#8217; like having multiple people with access to the &#8216;secret&#8217;. Even past US Presidents now long dead knew that (&#8216;Three can keep a secret if two of them are dead&#8217; &#8211; Benjamin Franklin).</p>
<p>Code signing as it is currently used is based on a single &#8216;secret&#8217; that for the process to be orgaisationaly robust in human terms &#8216;many have to get access to it&#8217;.</p>
<p>So code signing as it&#8217;s currently used gives you a choice of two alternatives,</p>
<p>1, Be robust as a process.<br />
2, Be robust as an authenticator.</p>
<p>You can&#8217;t realy have both in an organisation, so what ever you implement to try and get both is very likely to fail at both.</p>
<p>The problem is nobody has yet come up with an idea that has been made public that is both organisationaly robust and authenticationaly robust.</p>
<p>The one thing we do know from other experience in related areas, is that if somebody publishes a new idea to try and cover both bases, then it is likely to be overly complex, thus full of other attack vectors.</p>
<p>So &#8216;Heads you lose, tails they win, and on the edge is not stable&#8217;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2019/03/malware_install.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2019/03/malware_install.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2019%2F03%2Fmalware_install.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2019/03/malware_install.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='11998' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2019/03/programmers_who.html" rel="prev">â† Programmers Who Don&#039;t Understand Security Are Poor at Security</a>		<a href="https://www.schneier.com/blog/archives/2019/03/nsa-inspired_vu.html" rel="next">NSA-Inspired Vulnerability Found in Huawei Laptops â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
