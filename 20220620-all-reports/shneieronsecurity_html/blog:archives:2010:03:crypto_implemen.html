<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Crypto Implementation Failure - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Crypto Implementation Failure Comments Feed" href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3275" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3275' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F03%2Fcrypto_implemen.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F03%2Fcrypto_implemen.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3275 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3275" class="post-3275 post type-post status-publish format-standard hentry category-uncategorized tag-aes tag-denial-of-service tag-encryption tag-hardware tag-keys tag-passwords tag-usability">

	<div class="article">

		<h2 class="entry">Crypto Implementation Failure</h2>
		<p>Look at this new AES-encrypted <a href="http://www.engadget.com/2010/02/19/corsairs-padlock-2-offers-256-bit-aes-encryption-inside-a-rugge/">USB memory stick</a>.  You enter the key directly into the stick via the keypad, thereby bypassing any eavesdropping software on the computer.</p>
<p>The problem is that in order to get full 256-bit entropy in the key, you need to enter 77 decimal digits using the keypad.  I can&#8217;t imagine anyone doing that; they&#8217;ll enter an eight- or ten-digit key and call it done.  (Likely, the password encrypts a random key that encrypts the actual data: not that it matters.)  And even if you wanted to, is it reasonable to expect someone to enter 77 digits without making an error?</p>
<p>Nice idea, complete implementation failure.</p>
<p>EDITED TO ADD (3/4):  According to the manual, the drive locks for two minutes after five unsuccessful attempts.  This delay is enough to make brute-force attacks infeasible, even with only ten-digit keys.</p>
<p>So, not nearly as bad as I thought it was.  Better would be a much longer delay after 100 or so unsuccessful attempts.  Yes, there&#8217;s a denial-of-service attack against the thing, but stealing it is an even more effective denial-of-service attack.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/aes/" rel="tag">AES</a>, <a href="https://www.schneier.com/tag/denial-of-service/" rel="tag">denial of service</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/passwords/" rel="tag">passwords</a>, <a href="https://www.schneier.com/tag/usability/" rel="tag">usability</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html" rel="bookmark">Posted on March 4, 2010 at 6:05 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html#comments">100 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html" data-title="Crypto Implementation Failure" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-132261">

			<div class="comment by-arctanck ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.mylearningdiary.com' rel='external nofollow ugc' class='url'>arctanck</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132261">
						March 4, 2010 6:20 AM					</a>

				</p>

				<p>Sounds more like a marketing ploy than better security!?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132262">

			<div class="comment by-tim ">

				<p class="commentcredit">

					<span class="commenter">Tim</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132262">
						March 4, 2010 6:24 AM					</a>

				</p>

				<p>With only space for five buttons, how would you do it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132263">

			<div class="comment by-pete ">

				<p class="commentcredit">

					<span class="commenter">pete</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132263">
						March 4, 2010 6:42 AM					</a>

				</p>

				<p>Well, you could enter a 25-digit code to get 80 bits of entropy, which should provide enough security for the next 10 years or so.<br />
Sure it&#8217;s not very convenient, but on the other hand you get proper encryption without installing software and you do not have to worry about interoperability. Could be worse.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132265">

			<div class="comment by-peter-a ">

				<p class="commentcredit">

					<span class="commenter">Peter A.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132265">
						March 4, 2010 6:52 AM					</a>

				</p>

				<p>Bruce:</p>
<p>Do you have some reference saying that the encryption key is actually generated from (or encrypted with) the digits entered? Or are these digits simply a credential to release a factory-generated 256-bit key buried deep in the silicon or maybe only enabling the security function of some crypto chip on board? The latter would be no different from various crypto card systems out there which are deemed to be secure, some even legally mandated or required.</p>
<p>Their webpage says something about 2-minute lockout after entering a wrong PIN several times so brute-forcing a PIN by attaching a piece of electronics to the keypad is not a valid attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132266">

			<div class="comment by-anderer-gregor ">

				<p class="commentcredit">

					<span class="commenter">Anderer Gregor</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132266">
						March 4, 2010 6:54 AM					</a>

				</p>

				<p>These are five buttons, not ten &#8212; so 25 &#8220;digits&#8221; would only give you 58 bits of entropy. For 80 bits, you would need 35 &#8220;digits&#8221; &#8212; and, honestly, how many people are willing to memorize even these 25 digits?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132267">

			<div class="comment by-an-alex ">

				<p class="commentcredit">

					<span class="commenter">an alex</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132267">
						March 4, 2010 7:00 AM					</a>

				</p>

				<p>Bruce,</p>
<p>did you read the product&#8217;s manual?</p>
<p>&#8220;After 5 unsuccessful user PIN entry attempts, your Flash Padlock will be disabled for 2 minutes. The red LED will blink to indicate the unit has been locked. After 2 minutes, you can attempt to unlock your Flash Padlock.&#8221;</p>
<p>So it&#8217;s no more than 3600 attempts per day. 7 digits will give you an average of ~4 years of brute-forcing. Sounds good enough for casual use. (Of course it&#8217;s not top-secret quality, but it&#8217;s much better than the rest on the market.)</p>
<p>I&#8217;m assuming here that there are no other implementation issues with the product, e.g. that there is real encryption instead of just a password check, and that encryption key is derived via hardware noise generator. It would be interesting to know whether this assumption is sound.</p>
<p>Also, if I was designing this thing, I would have made it lock permanently after 10 (or something) wrong PIN attempts. You could still reset it, but the data would have been lost.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132268">

			<div class="comment by-frank-ch-eigler ">

				<p class="commentcredit">

					<span class="commenter">Frank Ch. Eigler</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132268">
						March 4, 2010 7:02 AM					</a>

				</p>

				<p>&#8220;complete implementation failure&#8221;?</p>
<p>Well, even if the effective security is closer to 50 bits rather than 256, so what?</p>
<p>The physical security aspects (lockout, breach detection) are much more interesting than quibbling about the number of buttons.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132269">

			<div class="comment by-justanotheruser ">

				<p class="commentcredit">

					<span class="commenter">justanotheruser</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132269">
						March 4, 2010 7:07 AM					</a>

				</p>

				<p>All this talk of 77 or 25 digit passwords is moot if you check out the products page on the Corsair site.</p>
<p>Protection: Your own 4-10 digit PIN protects and locks access to the Flash Padlock 2</p>
<p>The question to ask (or my question at any rate) is, can the hardware encryption be bypassed to attempt software decryption?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132270">

			<div class="comment by-gregory ">

				<p class="commentcredit">

					<span class="commenter">Gregory</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132270">
						March 4, 2010 7:09 AM					</a>

				</p>

				<p>I think that it&#8217;s not so simple:</p>
<ol>
<li>The lock mechanism is sufficient to make a brute force attack too long to be interesting. So the 30 bits of entropy of a 10-digit PIN should not be compared directly.</li>
<li>The choice of the AES 256 is maybe for performances purpose (depending on the flash controller).</li>
</ol>
<p>So I think that the real security point here is how the PIN code is verified ?</p>
<p>PS: From a marketing point of view, it&#8217;s impossible to ask more than 10 digits.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132271">

			<div class="comment by-dave-page ">

				<p class="commentcredit">

					<span class="commenter">Dave Page</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132271">
						March 4, 2010 7:10 AM					</a>

				</p>

				<p>Clearly we need a USB memory stick into which you can plug a USB keyboard to type in a passphrase!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132272">

			<div class="comment by-cowbutt ">

				<p class="commentcredit">

					<span class="commenter">cowbutt</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132272">
						March 4, 2010 7:13 AM					</a>

				</p>

				<p>I hope Corsair have improved upon their original Flash Padlock product:</p>
<p><a href="http://www.computerworld.com/s/article/print/9062527/Review_7_secure_USB_drives" rel="nofollow ugc">http://www.computerworld.com/s/article/print/9062527/Review_7_secure_USB_drives</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-132273">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132273">
						March 4, 2010 7:15 AM					</a>

				</p>

				<p>&#8220;From a marketing point of view, it&#8217;s impossible to ask more than 10 digits.&#8221;</p>
<p>Exactly, and ten digits is not enough to make brute-force attacks too long to be interesting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132274">

			<div class="comment by-philb ">

				<p class="commentcredit">

					<span class="commenter">PhilB</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132274">
						March 4, 2010 7:22 AM					</a>

				</p>

				<p>There are 5 buttons, but it appears that pushing a button to the left gives you one number, while pushing to the right gives you another number. The buttons are labeled with two numbers on each one (0 | 1).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132275">

			<div class="comment by-mat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.kakomu.com' rel='external nofollow ugc' class='url'>Mat</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132275">
						March 4, 2010 7:28 AM					</a>

				</p>

				<p>If any sort of valuable information were stored on such a device, the hacker would have an easier time disassembling the device, removing the physical memory chip and finding a device to read the memory chip. Considering most of the USB manufacturers use similar memory chip types such as TSOP and PQFP and all the chips tend to print their manufacturing information on the chip itself, it shouldn&#8217;t be too difficult to figure out how to extract the data from the chips, thereby bypassing the security hardware. It&#8217;s the same problem associated with physical access of a computer: If a hacker has physical access, extracting data is simple if you remove the HDD and attach it to another computer.</p>
<p>A device like this isn&#8217;t meant to provide any security to people that require it for most or any documents. Rather, this sort of device prevents a crime of opportunity. It&#8217;s like putting valuables into a small lock box. The lock box can easily be transported and opened by a determined thief, but it deters the less-than-determined thief from bothering.</p>
<p>In the end, I think something like Winrar&#8217;s archive security is a bit easier to use and makes it more difficult to circumvent security methods.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132276">

			<div class="comment by-foobar ">

				<p class="commentcredit">

					<span class="commenter">foobar</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132276">
						March 4, 2010 7:33 AM					</a>

				</p>

				<p>Why is the &#8220;lockout time&#8221; even relevant? It&#8217;s DRM.<br />
If you have physical access to the device, you can crack it open and access the Flash storage chip directly. That way you will be able to crack any reasonable key with little computation time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132277">

			<div class="comment by-tsechin ">

				<p class="commentcredit">

					<span class="commenter">tsechin</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132277">
						March 4, 2010 7:37 AM					</a>

				</p>

				<p>it looks like there are only 5 buttons.  5^10 combinations is about 23 bits.  in any case, 10^10 is still only about 33 bits.  i wonder what mode of operation it uses (please tell me it&#8217;s not ECB&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-132278">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132278">
						March 4, 2010 7:44 AM					</a>

				</p>

				<p>&#8220;Why is the &#8216;lockout time&#8217; even relevant? It&#8217;s DRM.  If you have physical access to the device, you can crack it open and access the Flash storage chip directly. That way you will be able to crack any reasonable key with little computation time.&#8221;</p>
<p>It depends on how the lockout is implemented.  But, yes, you&#8217;re right.  In my threat model, I was assuming a non-destructive attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132279">

			<div class="comment by-andrew-suffield ">

				<p class="commentcredit">

					<span class="commenter">Andrew Suffield</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132279">
						March 4, 2010 7:44 AM					</a>

				</p>

				<p>It is curious that nobody has asked the most obvious question here:</p>
<p>How do I know that this device is actually encrypting any data?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132280">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132280">
						March 4, 2010 7:47 AM					</a>

				</p>

				<p>In most cases the weakest link in the chain is the human holding the ends.</p>
<p>Also do you realy want to walk around with a stick of explosive with the blasting cap already inserted?</p>
<p>Which is why the likes of the NSA have crypto ignition keys which are easy to remove.</p>
<p>The fault of this product is not seperating the cap and the C4.</p>
<p>Arguing about the number of key strokes is like arguing about how many layers of tissue paper you need before you get a 50/50 chance of it exploding when you hit it with a 1/4 pound hammer that it won&#8217;t explode in your face.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132281">

			<div class="comment by-louis ">

				<p class="commentcredit">

					<span class="commenter">Louis</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132281">
						March 4, 2010 7:47 AM					</a>

				</p>

				<p>If I really want the data, I will let the user input the code, while lurking in the memory space, and then leech out all content once the data is out in the open.</p>
<p>To me, this is still the failure of those devices; namely, you can&#8217;t use them on untrusted PC&#8217;s without fear of leaking all your information.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132283">

			<div class="comment by-randy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.corsair.com/products/padlock2/default.aspx' rel='external nofollow ugc' class='url'>Randy</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132283">
						March 4, 2010 7:58 AM					</a>

				</p>

				<p>Apparently you all missed the obvious from the vendor site:</p>
<p><a href="http://www.corsair.com/products/padlock2/default.aspx" rel="nofollow ugc">http://www.corsair.com/products/padlock2/default.aspx</a></p>
<p>&#8220;Protection: Your own 4-10 digit PIN protects and locks access to the Flash Padlock 2&#8221;</p>
<p>So it&#8217;s only 4-10 digits.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132284">

			<div class="comment by-dfxm ">

				<p class="commentcredit">

					<span class="commenter">dfxm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132284">
						March 4, 2010 8:01 AM					</a>

				</p>

				<p>10 digit numerical passcode? Sounds like if you are in America and you know the owner&#8217;s phone number, you&#8217;ll be able to open this right up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132285">

			<div class="comment by-ping-che-chen ">

				<p class="commentcredit">

					<span class="commenter">Ping-Che Chen</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132285">
						March 4, 2010 8:12 AM					</a>

				</p>

				<p>There is a simple way to make it much more secure (I don&#8217;t know if this particular product implements this or not though). First, you have to make the controller using an internal storage for its firmware, so there is no way to read its internal data. Then, when the user set the password, an internal random 256 bits password is generated from a random source, and written to the internal storage. Then, when doing encryption or decryption, the internal password is XORed with the user password. This way, even if you have physical access to the flash chips (which is not difficult), you still can&#8217;t brute force the password even if the user entered a relatively short password, without the internal password in the controller (which should be completely invisible outside of the chip).</p>
<p>Of course, it may be possible to probe the controller to get the internal controller. I don&#8217;t know enough about flash storage to know how difficult this is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132286">

			<div class="comment by-ping-che-chen ">

				<p class="commentcredit">

					<span class="commenter">Ping-Che Chen</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132286">
						March 4, 2010 8:14 AM					</a>

				</p>

				<p>&#8220;Of course, it may be possible to probe the controller to get the internal controller.&#8221;</p>
<p>Should read</p>
<p>&#8220;Of course, it may be possible to probe the controller to get the internal password.&#8221;</p>
<p>Sorry for the typo ðŸ˜›</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132287">

			<div class="comment by-piet ">

				<p class="commentcredit">

					<span class="commenter">Piet</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132287">
						March 4, 2010 8:21 AM					</a>

				</p>

				<p>At least it looks good. How long till the paint comes of the key&#8217;s you use the most?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132288">

			<div class="comment by-david-brady ">

				<p class="commentcredit">

					<span class="commenter">David Brady</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132288">
						March 4, 2010 8:29 AM					</a>

				</p>

				<p>There are only 5 input buttons. They are labeled in pairs because humans often memorize numbers that need all 10 digits.</p>
<p>With only 5 buttons, you&#8217;d need 110 digits, not 77. The device only allows pins of 4-10 digits, however; assuming you were dutiful and used all ten the keyspace there is ~9.8M.</p>
<p>Assuming you weren&#8217;t, a 4-digit PIN has a keyspace of 625, which, given 2-minute lockouts after 3 attempts, can be traversed in 7 hours.</p>
<p>This is really excellent kid sister encryption; it worries me, however, that a government official might think this device secure enough to get even more careless with it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132289">

			<div class="comment by-cassiel ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cassiel.com' rel='external nofollow ugc' class='url'>cassiel</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132289">
						March 4, 2010 8:41 AM					</a>

				</p>

				<p>I am not a hardware engineer, nor do I play one on TV, but: even if the encryption happens at the flash level, and even if the password key is long enough to prevent brute-force attacks given the timeouts, there must be at least a passing chance that the lockout machinery has an analogue component (so, to prevent lock timeouts, just pull a reset pin high, or similar).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132290">

			<div class="comment by-jgreco ">

				<p class="commentcredit">

					<span class="commenter">jgreco</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132290">
						March 4, 2010 8:43 AM					</a>

				</p>

				<p>@Louis</p>
<p>Exactly.  This is why I never really understood the point to these types of devices.  The only thing I can really think of is that since the user is inputting their password directly with the hardware, special software on the host computer isn&#8217;t needed.  Worthless on untrusted computers, but convienent on trusted ones.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132291">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132291">
						March 4, 2010 8:52 AM					</a>

				</p>

				<p>I would think this could be beneficial if used in conjunction with software crypto.</p>
<p>Providing you don&#8217;t destroy the case, you&#8217;d have to get the key entered into the keypad right to begin attacking from a software perspective.</p>
<p>How its set up is a benefit to casual use, but this could be used to deter (annoy) more determined intruders.  Would make it tougher to copy the device so they can begin a software attack against the copy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132292">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132292">
						March 4, 2010 9:00 AM					</a>

				</p>

				<p>@ Ping-Che Chen,</p>
<p>&#8220;&#8230; &#8230; Then, when doing encryption or decryption, the internal password is XORed with the user password.&#8221;</p>
<p>NO No no.</p>
<p>You where doing OK up untill then.</p>
<p>You are making the &#8220;looks like an OTP&#8221; mistake.</p>
<p>Although not impossible to stop reading the internal contents of a chip can be made difficult. BUT if you have the level of difficulty linearly on the X axis and the cost on the Y axis you will find a good aproximation to an exponential increasing curve.</p>
<p>Thus you could assume that the internal secret becomes available in the length of time it takes to disolve the chip plastic (which with the right solvents is easily measurable to a couple of lock out times) and the length of time it takes to mount it up in an apropriate microscope/probe test jig (which can and have be bought second hand on even megre university project funds).</p>
<p>XOR is not the way to go you have AES on chip why not use it in a variant of the Unix Password system to bump the real work factor up. Oh and make sure the varient includes the number of times through AES as well as a salt to stop Rainbow table trade offs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132293">

			<div class="comment by-data-eraser ">

				<p class="commentcredit">

					<span class="commenter">Data Eraser</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132293">
						March 4, 2010 9:21 AM					</a>

				</p>

				<p>I think that what this thing really needs is complete data wipe (cryptographic erasure) after say 10-20 failed attempts. Just erase the password encrypted key and you have deleted all the data, at least assuming that the &#8216;bad guys&#8217; haven&#8217;t already copied that memory.</p>
<p>Seriously, this could be good enough for any secrets that won&#8217;t be cracked by a crack team of security/hardware experts. If they are just going to try to get in through the front door (password guessing), keeping them out is easy. If they are going to compromise the hardware, well, they probably can find easier ways in than that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132294">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132294">
						March 4, 2010 9:22 AM					</a>

				</p>

				<p>@ tsechin,</p>
<p>&#8220;I wonder what mode of operation it uses (please tell me it&#8217;s not ECB&#8230;)&#8221;</p>
<p>The chances are even if it&#8217;s not it might as well be.</p>
<p>There are a whole load of issues with encrypting a Data Base which essentialy a file system is (ie it is a keyed flat DB with fixed length records etc).</p>
<p>You then need to add in the constraints that a flash file system adds (ie wear leveling and record erasing) and basically very few people get it even close to being right.</p>
<p>It&#8217;s the sort of stuff PhD disertations where made of just a few years ago.</p>
<p>And I suspect if you asked Bruce nicely he would probably put his hand up to saying what some of the issues are but also admit to not knowing them all off the top of his head (unless he&#8217;s been building on recently).</p>
<p>I have slightly painfull memories of having conservativly designed an HD encryption system and being somewhat proud of myself for having covered all the bases, then having it ripped apart in minutes by somebody in the know with tricks I&#8217;d not heard of at the time.</p>
<p>One of the tricks actually capatalised on the conservative nature of the design (ie in strengthening in one direction I&#8217;d inadvertantly weakend it in another).</p>
<p>Luckily the way I&#8217;d designed the system it only took the work of a few minutes to identify and make most of the changes, then a days slog writing a new sub module, then into the long formal test stage&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132295">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132295">
						March 4, 2010 9:28 AM					</a>

				</p>

				<p>If someone&#8217;s going to try to brute force it, they&#8217;re probably going to break the casing and interface directly with the electronics.  Assuming this is the case, I&#8217;m guessing that power cycling the device every few attempts might be enough to circumvent the 2 minute lockout.  This of course assumes they took a naive approach to implementing the timer.</p>
<p>If the encrypted key is stored with the data, i.e. in the first sector, then interfacing directly with the storage chip(s) might also get around a lockout.</p>
<p>It&#8217;ll probably keep your data safe if you lose it and some random person picks it up, but I wouldn&#8217;t trust it to protect me from someone who seriously wants my data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132297">

			<div class="comment by-alexandre-carmel-veilleux ">

				<p class="commentcredit">

					<span class="commenter">Alexandre CARMEL-VEILLEUX</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132297">
						March 4, 2010 9:37 AM					</a>

				</p>

				<p>Why not reverse engineer the software/hardware, extract the memory chips and brute force those? Any government can do that easily and the cost would not be astounding for non-government actors either. Max PIN is 10 digit, trivial to brute force and from the look of it, we&#8217;re talking 5 values not 10 per digits.</p>
<p>I somehow doubt it&#8217;s tamper-resistant enough to mitigate that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132298">

			<div class="comment by-eh ">

				<p class="commentcredit">

					<span class="commenter">EH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132298">
						March 4, 2010 10:37 AM					</a>

				</p>

				<p>Bruce, I assume manufacturers read your blog to tease whatever information they can out of it.  How else would they FINALLY have a USB device which cannot be broken through software (or, more accurately, has apparently been designed with that goal in mind).  With all of the key logger type attacks which scare people as much as a pair of flaming underpants, they seem to be going in the right direction.</p>
<p>I was actually impressed that it appears they are trying to actually improve on the totally broken chips you&#8217;ve put in the dog house.</p>
<p>Do you have any recommendations for any designers reading your blog on how to avoid issues with trusting the computer with your PIN/password and simultaneously supporting enough bits of entropy?  Or, if none, a recommendation on which of those two goals  they should focus on instead?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132299">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter">BF Skinner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132299">
						March 4, 2010 11:21 AM					</a>

				</p>

				<p>@Andrew Suffield &#8220;How do I know that this device is actually encrypting any data?&#8221;</p>
<p>That&#8217;s not the most obvious or relevant question to my mind. @Daniel got to it with his observation</p>
<p>@Daniel &#8221; if you lose it and some random person picks it up&#8221;</p>
<p>The first question to ask is &#8220;What degree of protection does this device offer my information&#8221;. What&#8217;s the metric?<br />
This is what Bruce and his fellow cypherpunks are getting at. The lower the entropy the less the protection. But all Corsair says is &#8220;suited for security-minded consumers and professionals&#8221; which could be construed as a promise to the CIA or &#8220;AES&#8221; which is a method not ameasure. What protection profile did they adopt (if any) during design. What evaluation did they submit it to? They say you can put your sensitive data on it but that word covers a host of sins (my business plans maybe, the noc list for all my undercover agents in Columbia probably not). Managers and deciders are being told to be standards compliant (FIPS140-1, AES etc) so they hear AES and argue &#8220;that&#8217;s good enuf.&#8221;</p>
<p>GSA, though, certifies manufacturers security containers before they are made avalaible on schedule for sale to the Gov&#8217;t. The certification is as a function on how much time it takes to break into the safe.  Can&#8217;t we expect/should we demand the same from &#8220;security&#8221; manafacturers? If I&#8217;m a manager and you tell me that the Corsair will standup to a determined attack for XX days or XX minutes I&#8217;ll be able to judge how  suitable it is for my sensitive data.</p>
<p>It is interesting to note that Corsairs were French privateers.</p>
<p>Corsair&#8217;s warranty promises &#8220;Corsair hardware product is guaranteed to operate, as specified by its datasheet, and in the operating environment for which it was intended, for the life of the product or the extent of the warranty.&#8221; Does this imply they are liable for implementation details that give up the key or data? If it is they limit themselves to the cost of the device or it&#8217;s replacement so I don&#8217;t take their promise too seriously.</p>
<p>I would like to run forensics on the stick after the data was cleared with their 911 method.</p>
<p>You know that fast voice at the end of the commercial? The one that warns about undisclosed costs, milage and side effects&#8230;it said &#8220;PadLocks are developed and produced by Corsair Memory based on licensed technology (patents pending) from ClevX, LLC. &#8221; ClevX, Clever eXtensions, is an IP collection company few have heard of that have like all the patents in world. If they are who I think they are &#8230;they they are smart people (may actually have invented a simple low cost way to deflate the power of a hurricane) and they cite a lot of these keypad sticks to other companies.<br />
<a href="http://www.clevx.com/news.html" rel="nofollow ugc">http://www.clevx.com/news.html</a></p>
<p>@Bruce<br />
Can we get a white board and attack tree diagraming app built into the blog? Would it help? It would help me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132300">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132300">
						March 4, 2010 11:33 AM					</a>

				</p>

				<p>@ EH</p>
<p>&#8220;Do you have any recommendations for any designers reading your blog on how to avoid issues with trusting the computer with your PIN/password and simultaneously supporting enough bits of entropy? Or, if none, a recommendation on which of those two goals they should focus on instead?&#8221;</p>
<p>What&#8217;s the guessing Bruce will direct you in the direction of a book shop in a few days time&#8230;</p>
<p><a href="http://www.schneier.com/book-ce.html" rel="nofollow ugc">http://www.schneier.com/book-ce.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132301">

			<div class="comment by-volker-hetzer ">

				<p class="commentcredit">

					<span class="commenter">Volker Hetzer</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132301">
						March 4, 2010 11:41 AM					</a>

				</p>

				<p>I think this is of more use in a more traditional environment:<br />
Embassador travels home, gets new key, learns it, writes it down and puts it in safe once back in embassy and then you can send over usb sticks any old how.<br />
The advantage is that you don&#8217;t have to fear hacking. At the embassy you have a PC with USB, a printer, monitor and keyboard and no network connection anywhere in sight.</p>
<p>Substitute embassy with any high value enterprise and you&#8217;ve got customers enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132302">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132302">
						March 4, 2010 12:11 PM					</a>

				</p>

				<p>Add a keypad a second factor to standard password entering software, and it would be good.</p>
<p>And, perhaps, burning the data out using an internal battery after 10 failed attempts would be good to. Flash drives, encrypted or not, shouldn&#8217;t be the only copy of your data anyhow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132303">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132303">
						March 4, 2010 12:17 PM					</a>

				</p>

				<p>@ BF Skinner,</p>
<p>I had a look at your ClevX link and found amongst other things the following white paper,</p>
<p><a href="http://www.clevx.com/documents/Flash%20Padlock%20White%20Paper-1_final_v1.pdf" rel="nofollow ugc">http://www.clevx.com/documents/Flash%20Padlock%20White%20Paper-1_final_v1.pdf</a></p>
<p>And to be quite honest I don&#8217;t like it one little bit.</p>
<p>It appears in practice that DataLock is very little to do with the encryption on the Flash Drive.</p>
<p>From the blurb (if it can be believed) it is actually technology that hides the flash drive from the host computer untill the pin is entered.</p>
<p>That is it plays around with the USB spec to make the device look like a mobile phone charger or equivalent or an ordinary USB Mass Storage Class Device.</p>
<p>Worse the device has an internal battery and the user can sit there and enter in pins without it being connected to a USB host&#8230;</p>
<p>What gives me grave misgivings is they define it as being suitable as a &#8220;two factor authentication&#8221; device&#8230;</p>
<p>That is,</p>
<p>1st factor, is having the device.</p>
<p>2nd factor, is knowing the pin.</p>
<p>I will let others make judgment on this but as far as I&#8217;m concerned that is not two factor authentication in the traditional sense (ie you don&#8217;t include the data storage device as one factor).</p>
<p>The question then arises just how does DataLock interface to the encrypted flash drive to unlock it?</p>
<p>Could be as simple as just enabaling the USB interface and raising a single &#8220;good to go&#8221; status bit/line?</p>
<p>Oh and apparently &#8220;Black Box&#8221; use the technology in their Take range which includes a charming little pink number called secret diary which is OK for a teenager to hide her thoughts&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132304">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter">BF Skinner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132304">
						March 4, 2010 12:30 PM					</a>

				</p>

				<p>@Clive<br />
&#8220;1st factor, is having the device.<br />
2nd factor, is knowing the pin.&#8221;</p>
<p>Not the worst definition I&#8217;ve heard<br />
(1st Factor: Password_A, 2nd Factor: Password_B) but it ranks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132305">

			<div class="comment by-tapani-otala ">

				<p class="commentcredit">

					<span class="commenter">Tapani Otala</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132305">
						March 4, 2010 12:35 PM					</a>

				</p>

				<p>Meh on the number of bits of entropy. I&#8217;d be much more worried about the classic &#8220;brute&#8221; force attack: I&#8217;ll cut off this thumb if you don&#8217;t give me the combination to this other &#8220;thumb&#8221;.</p>
<p>Not a new idea: <a href="http://bit.ly/ahL214" rel="nofollow ugc">http://bit.ly/ahL214</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132306">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132306">
						March 4, 2010 12:57 PM					</a>

				</p>

				<p>Hmm,</p>
<p>@ EH and others thinking about designing a secure USB mass storage device.</p>
<p>A little advice.</p>
<p>1, Put the key on a seperate device that plugs into the memory storage device (ie an ignition key based around a secure smart card or SIM chip). This holds the AES keys and possibly the hardware crypto engine as well.</p>
<p>2, Use a 10-40 digtit PIN for the ignition key (either direct or through the mass storage device. Which unlocks the secure smart card or SIM.</p>
<p>3, Use PK to comunicate managment info within the various bits of the system.</p>
<p>That is the ignition key has a private key and a public key (likewise the mass storage device if it contains the crypto engine). Pulling the ignition key kills the encryption engine.</p>
<p>The easiest way to build such a device is to have the mass storage device have &#8220;USB On The Go&#8221; in it where it acts like a USB Mass storage device to the computer on the USB (B socket or A plug) interface and like a simple host on it&#8217;s (USB A socket) interface.</p>
<p>The Ignition key acts as a USB device only. You can buy of the shelf chips that act as USB Devices that interface directly to Smart Cards or SIMs. So the design of this is a bit of a no brainer. You can get Secure Smart Cards / SIMs at ELA 4 and above quite easily and they have the crypto engine built in as well as the PK certs and managment etc.</p>
<p>You can now get single chip microcontrolers with two or more USB interfaces and interfaces to Flash devices or SD/MMC cards etc.</p>
<p>With a little skill and thought you could probably have a demo unit up in a month as nearly all the software you need to do the heavy lift is available from the chip manufactures. Therefore you are mainly writing a &#8220;script&#8221; to glue it all together.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132307">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132307">
						March 4, 2010 1:42 PM					</a>

				</p>

				<p>Ok, so we have a encrypted 8GB USB drive with a trusted path (hallelujah!), AES-256, a lockout feature and 4-10 digit PIN for authorization for the low price of $60! I have to disagree with some of the comments: that&#8217;s freakin&#8217; awesome! That is&#8230; if regular consumers are using it to prevent opportunistic or non-technical attacks. Not government, high value assets, sophisticated attackers, etc. To be clear on my stance: good for low assurance situations, nothing more. The trusted path makes it worth the money: most of the &#8220;better&#8221; encrypted drives retrieve the password through the main operating system of a PC. There are many more attack vectors on a laptop or desktop than a flash drive. So, the system is more specific, the TCB smaller, and the protection good enough to deter non-technical or opportunistic attackers. It&#8217;s also cheap. That&#8217;s nice.</p>
<p>There is one particular advantage that drives with PIN or trusted path have over PC-based drives: it should be harder to write software that subverts them. I could see things like SanDisk being subverted by ignorant script kiddies thanks to well-written kernel-level tools that intercept passwords, but attacks on this device are likely to require physical possession and a certain amount of hardware knowledge. If you ask me, this is an improvement in the world of COTS crypto bulls***.</p>
<p>It will be hard to build something better that&#8217;s not a kludge. Clive and I were working out the details in the past. It basically takes an inline-media encryptor situated between the main system and the storage medium. Like the NSA&#8217;s IME, it must require two-factor authentication, key/buffer zeroize function, and covert channel reduction. COTS solution might use separation kernel, truecrypt-derived filesystem encryption, and RAM overwriting on shutdown. One application is an embedded HD enclosure that IME&#8217;s arbitrary HD&#8217;s. Most recent incarnation uses VIA Artigo board for cheap, low watt, crypto-accelerated action. Still takes up plenty of space.</p>
<p>I&#8217;ve been wondering how to make it as small as a typical external HD. I think it could be done using an embedded board whose tiny processor has TRNG and crypto acceleration. Certain FreeScale PPC chips and, for higher security, General Dynamics INFOSEC chip come to mind. I don&#8217;t know how to maintain security &amp; price if I apply this approach to a flash drive. I think that would require a more expensive, custom approach. We are better off securing small, portable hard disk enclosures with built-in encryption. What do the rest of you think? Is that the most cost-effective approach for implementing an open-source, COTS media encryptor?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132308">

			<div class="comment by-nobody-special ">

				<p class="commentcredit">

					<span class="commenter">Nobody Special</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132308">
						March 4, 2010 3:22 PM					</a>

				</p>

				<p>No it isn&#8217;t the theoretical most secure device imaginable.</p>
<p>However &#8211; if you are a local council, hospital or company with workers who occasionally need to copy data between machines &#8211; this is a very good choice.</p>
<p>You don&#8217;t need truecrypt installed, don&#8217;t have any issue with copying between OSes or on machines you don&#8217;t have admin rights on. It is secure enough (assuming they have done the HW correctly) not to worry when someone drops it in the pub.</p>
<p>It is available in the shops &#8211; you don&#8217;t need to own your own airforce to buy one &#8211; and it doesn&#8217;t cost much more than any decent brand memory key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132309">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132309">
						March 4, 2010 4:17 PM					</a>

				</p>

				<p>I think, like everything else, whether or not this is secure enough depends on the information it is protecting.</p>
<p>It would be effective against casual loss and snoopoing, and a deterent against evesdropping.  It would also take a pretty patient person to do a brute force.</p>
<p>On the flip side, it is insufficient to protect information that is highly sensitive.</p>
<p>Of course, IMHO, if the information is so sensitive that the protection of this device is insufficient, it probably shouldn&#8217;t be on a USB in someone&#8217;s pocket anyway.   Secure storage and mobile storage are often mutuall exclusive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132310">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132310">
						March 4, 2010 7:05 PM					</a>

				</p>

				<p>@ HJohn</p>
<p>Good point about security cost being relative to the value of the information. There are a few points I disagree with. First, an encrypted external drive isn&#8217;t a deterrent against eavesdropping: it promotes it by making eavesdropping more productive, either physically of the individual or digitally of the PC processing the sensitive data.</p>
<p>Additionally, we don&#8217;t know enough about how the device works internally to gauge the work involved in brute force or even if brute force is the most cost-effective attack. As Ross Anderson points out on side channel attacks, his <em>undergraduate</em> students routinely evince secrets from &#8220;secure&#8221; chips. They also use equipment that isn&#8217;t outrageously expensive or rare. The likelihood of this attack depends mainly on the value of the information, as the attackers and equipment are out there for the buying. How much would one have to pay an unscrupulous geek in a university to get the PIN with a side channel attack?</p>
<p>&#8220;information&#8230; so sensitive that&#8230; device is insufficient, it probably shouldn&#8217;t be on a USB in someone&#8217;s pocket anyway. Secure storage and mobile storage are often mutuall exclusive.&#8221; (HJohn)</p>
<p>The last point I&#8217;m only partially in disagreement with. Generally speaking, most tiny devices aren&#8217;t secure or aren&#8217;t cost-effective to secure. I mentioned something similar in the last post. However, one can have very portable security. For instance, General Dynamics TACLANE line of communications products provide excellent, military-grade security and are pretty portable. I mean, the Edge smartphone is huge by commercial standards, but it&#8217;s still very portable and usable. A netbook with trusted boot, a separation kernel and good architecture gives ease of use with excellent security in a tiny, energy-efficient package. Green Hill&#8217;s built one on INTEGRITY, in fact. Another company built a medium assurance VPN solution from an inexpensive, Ethernet-enabled PCMCIA card with OpenBSD. Mobility and security are often at odds, but they aren&#8217;t as mutually exclusive as many think. They can be mixed together in many useful scenarios with careful engineering. It&#8217;s been done over and over. Companies just need to do it more often. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132311">

			<div class="comment by-bh ">

				<p class="commentcredit">

					<span class="commenter">bh</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132311">
						March 4, 2010 7:35 PM					</a>

				</p>

				<p>I just ran into a similar issue recently.  In order to get government certification, we had to have our passwords encrypted with AES.  I really wanted to grab whoever wrote it and try and get it through their skull that the passwords are usually only 8 characters long!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132312">

			<div class="comment by-sam ">

				<p class="commentcredit">

					<span class="commenter">Sam</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132312">
						March 4, 2010 9:43 PM					</a>

				</p>

				<p>@Nick P.</p>
<p>See this device:<br />
<a href="http://www.apricorn.com/product_detail.php?type=family&#038;id=58" rel="nofollow ugc">http://www.apricorn.com/product_detail.php?type=family&#038;id=58</a></p>
<p>And I agree with the rest of the commenters &#8211; &#8220;complete implementation failure&#8221; is offbase.  And even if it was an implementation failure, at least this is a step in the right direction.  Companies are starting to come out with products with genuine security, don&#8217;t kick them in the nuts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132313">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132313">
						March 4, 2010 9:52 PM					</a>

				</p>

				<p>Is anyone interested in a side bet on which attack vector will crack this puppy quickest?</p>
<p>I&#8217;ll place my bet on differential power analysis, identifying critical code sections and simple Timing glitched power attacks completing the job.</p>
<p>BTW lock-outs after 3 or more tries only stop a hacker if the device has an internal battery back-up or some form of internal energy storage. I&#8217;ll bet this USB stick has neither.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132314">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132314">
						March 5, 2010 12:54 AM					</a>

				</p>

				<p>&#8220;Exactly. This is why I never really understood the point to these types of devices. The only thing I can really think of is that since the user is inputting their password directly with the hardware, special software on the host computer isn&#8217;t needed. Worthless on untrusted computers, but convienent on trusted ones.&#8221;</p>
<p>When was the last time you used a trusted computer?  Do you work for the NSA or something?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132315">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132315">
						March 5, 2010 1:05 AM					</a>

				</p>

				<p>@ Robert,</p>
<p>&#8220;BTW lock-outs after 3 or more tries only stop a hacker if the device has an internal battery back-up or some form of internal energy storage. I&#8217;ll bet this USB stick has neither.&#8221;</p>
<p>Did you read my post above where I give a link to the ClevX White Paper?</p>
<p>The device has a battery and you can enter the pin whilst it is not connected to anything. As long as you plug it into a USB Host within 15 secs it looks just like any old USB Mass Storage device.</p>
<p>The scary bit as I pointed out is the &#8220;lock&#8221; part appears to simply turn the USB interface from Mass Storage to something like USB power charger, so the host does not see it as a valid USB device any more.</p>
<p>It talks about being a replacment for &#8220;bio-metric&#8221; locked USB devices etc. It does not mention encryption at all.</p>
<p>Which is why I put forward the thought about how it activates the encrypted flash storage behind it&#8230;</p>
<p>If it&#8217;s a &#8220;good to go&#8221; signal on a PCB track, then it&#8217;s most definatly game over before it starts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132317">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132317">
						March 5, 2010 1:23 AM					</a>

				</p>

				<p>@ Sam,</p>
<p>&#8220;Companies are starting to come out with products with genuine security, don&#8217;t kick them in the nuts.&#8221;</p>
<p>I&#8217;m not sure that this one qualifies on &#8220;genuine security&#8221;.</p>
<p>If you read the ClevX White Paper I posted a link to above you will find it mentions SabOx, and how it&#8217;s technology (at a very poor stretch of the imagination) meet&#8217;s the &#8220;two factor&#8221; requirment&#8230;</p>
<p>There is a trend in the industry to make products to meet the check box list faux security requirments of SabOx auditors, not knowledgable evaluation by security advisors.</p>
<p>It&#8217;s kind of like the difference between &#8220;crystal healing&#8221; and &#8220;modern surgery&#8221;, the difference is not that important to you untill you get a burst appendix.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132318">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132318">
						March 5, 2010 2:53 AM					</a>

				</p>

				<p>@Clive<br />
  With this product, the more I read the less I like what I&#8217;m reading.</p>
<p>The advertising blurb says it is full AES256 encryption of the Data on the Flash chip.</p>
<p>The White paper suggests it is just an Enable &#8220;lock-out&#8221; protection, probably implemented on a cheap flash based microcontroller like a PIC or 8051.</p>
<p>If it is the later than this is a truly pathetic attempt at data security. It might stop script kiddies  but that&#8217;s about all it would stop.</p>
<p>Unfortunately, I&#8217;m also finding that Security concerns have created a whole industry stamping and certifying what they barely understand. I had to talk with an auditor asking about SabOx security certification just the other day, my what a painful experience!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132319">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132319">
						March 5, 2010 3:04 AM					</a>

				</p>

				<p>@ Brian,</p>
<p>&#8220;When was the last time you used a trusted computer? Do you work for the NSA or something?&#8221;</p>
<p>I work on a trusted computer most of the time, because I&#8217;m investigating the design of such a beast designed around COST minimal cost components in a new format with much finer granularity than existing systems.</p>
<p>However because it&#8217;s a work in progress it cannot be tursted to some peoples definition of the expression &#8220;trusted computer&#8221; and I would argue that their definition is wrong any way.</p>
<p>Which highlights the issue of what do we mean by &#8220;trusted computer&#8221; any way, and in what &#8220;time frame&#8221;?</p>
<p>As the old joke has it you can trust a computer that,</p>
<p>&#8220;Is embeded in a block of concreate at the bottom of the Mariana Trench&#8221;</p>
<p>You can tell it&#8217;s an old joke because NASA amongst others are going there. ( <a href="http://en.wikipedia.org/wiki/Mariana_Trench" rel="nofollow ugc">http://en.wikipedia.org/wiki/Mariana_Trench</a> )</p>
<p>So the joke needs a &#8220;maybe&#8221; update added to it.</p>
<p>That&#8217;s the trouble with security it gets harder not easier as technology improves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132320">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132320">
						March 5, 2010 3:47 AM					</a>

				</p>

				<p>@ Robert,</p>
<p>&#8220;Unfortunately, I&#8217;m also finding that Security concerns have created a whole industry stamping and certifying what they barely understand.&#8221;</p>
<p>I&#8217;m not sure it&#8217;s actually &#8220;Security Concerns&#8221; I&#8217;m comming around to the opinion it&#8217;s &#8220;Liability Concerns&#8221;.</p>
<p>That is somebody on the board says &#8220;What&#8217;s our liability under&#8230;&#8221; and from that point onwards the focus is not on security but liability mitigation under whatever &#8220;business rule&#8221; they are most concerned about.</p>
<p>With regards to,</p>
<p>&#8220;I had to talk with an auditor asking about SabOx security certification just the other day, my what a painful experience!&#8221;</p>
<p>Yes driving six inch nails into a concreat block with your forehead can be a less painfull experiance.</p>
<p>And it&#8217;s not just SabOx it&#8217;s the Payment Card Industries (PCI) nonsense as well (as you might find out shortly depending on who you work for ðŸ˜‰</p>
<p>Security by penalty avoidence is not security, never was and it never will be. All that happens is that risk gets externalised and like a hot potato gets passed down the line, at each point people mitigate a singular risk in a specific way and pass it on.</p>
<p>Sitting on the side of this downward spiral are auditors who are making money by certifing and organisation meets a particular requirment.</p>
<p>And this is where a conflict of interest arises.</p>
<p>The auditor is payed by a company to certify if it mights the narrow requirments of liability X mitigation.</p>
<p>The auditor walks in the door takes one look around the place and thinks &#8220;OMG this is a pigs breakfast&#8221;. They have two choices at this point</p>
<p>1, Sink.<br />
2, Swim</p>
<p>If they tell the client &#8220;your security is a pigs breakfast&#8221; they know in all likley hood they will be shown the door etc.</p>
<p>If they say nothing and do a general audit then the Company will not get the certificate so the auditor will be effectivly shown the door etc.</p>
<p>If they shut their eyes and walk a very very narrow pathway down a checklist for one singular risk then they can supply a certificate.</p>
<p>In the latter case the Auditor gets paid the company gets it&#8217;s certificate that alows it to carry on doing business. And the chances are the auditor will get more business.</p>
<p>The only problem for the auditor is when something goes wrong (and it will) will a judge accept that the auditor issued the certificatly &#8220;honestly&#8221;. And to do this the Lawyers will pull out the contracts, rules and audit procedure and go through it with an electron microscope looking for &#8220;liability&#8221; they will then argue the case in front of the judge and all sorts of &#8220;legal profitering&#8221; tactics will be played such as &#8220;electronic discovery&#8221;.</p>
<p>At some point either bankruptcy or a judgment will put a final end to the issue.</p>
<p>However my betting is bankruptcy of little organisations and &#8220;out of court&#8221; for the big boys is what will happen.</p>
<p>It is the almost inevitable consiquence of &#8220;self regulation&#8221; in a monopolistic market, where liability can be externalised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132322">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132322">
						March 5, 2010 4:36 AM					</a>

				</p>

				<p>@Clive<br />
&#8220;And it&#8217;s not just SabOx it&#8217;s the Payment Card Industries (PCI) nonsense as well&#8221;</p>
<p>I agree with this statement. &#8220;Common Criteria&#8221; hardware certification is a bit of a joke.</p>
<p>The reality is that VERY VERY few people are &#8220;properly&#8221; qualified to do this, especially in the area of secure chips.<br />
Unfortunately, for the certifying company, it is logical to pick the least qualified certifier.</p>
<p>There are 3 reasons for this<br />
 1) It just paperwork anyway attitude&#8230;<br />
 2) Anyone really qualified probably works for a competitor or will work for them sometime soon. So don&#8217;t tell them your latest secrets&#8230;<br />
3) worst still they are the enemy (a hardware hacker)</p>
<p>So reality is that I want to reveal as little as possible and get the stamp.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132323">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132323">
						March 5, 2010 8:57 AM					</a>

				</p>

				<p>@Nick P: &#8220;First, an encrypted external drive isn&#8217;t a deterrent against eavesdropping: it promotes it by making eavesdropping more productive, either physically of the individual or digitally of the PC processing the sensitive data.&#8221;</p>
<hr />
<p>Hi Nick,</p>
<p>I appreciate your courteous response and agree with most of what you wrote.  In regards to the above quote, when I say &#8220;deterent to evesdropping&#8221;, what I mean is one cannot log keystrokes to obtain a key on such devices.  I probably used terminology that drew another conclusion, and I appreciate you calling me on it.</p>
<p>Happy Friday</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132324">

			<div class="comment by-arclight ">

				<p class="commentcredit">

					<span class="commenter">Arclight</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132324">
						March 5, 2010 11:44 AM					</a>

				</p>

				<p>This definitely improves security for casual users. Assuming the implementation details aren&#8217;t obviously flawed (i.e. no password stored in cleartext, etc) then the attacks that are still feasible in my mind would be:</p>
<ol>
<li>Steal the device, take it back to the manufacturer or your lab, connect it to a JTAG debugger, drop new software on it that allows unlimited brute-force attempts by USB. Brute-force the likely ~25-bit key quickly using a normal PC. </li>
</ol>
<p>This assumes that the anti-debug feature has not been set on the microcontroller. If it has, you could possibly still replace the chip or use hardware tampering techniques to repair the on-chip fuse.  In any case, attacking the hardware adds time and expense.</p>
<ol>
<li>In the real world, this thing still needs to be attached to a PC to be used. So the likely attack is going to be installing some malware on the PC to simply copy the stick&#8217;s contents the next time the user logs in.</li>
</ol>
<p>Arclight</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132326">

			<div class="comment by-donald-johnston ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.maseconsulting.com' rel='external nofollow ugc' class='url'>Donald Johnston</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132326">
						March 5, 2010 7:14 PM					</a>

				</p>

				<p>I view this situation as somewhat of a &#8220;two form factor&#8221; authentication &#8230; something you have (the USB stick) and something you know (the pass code).  So if a system has a key-logger to capture your code the perpetrator would still need to steal your USB stick.  I used an Ironkey device and for the pass phrase always try to use upper and lower case with digits and special characters (maybe 52 variations); but even with that you would still need 42 characters to match the 256 bit entropy.  I&#8217;m only using 14 characters right now &#8230; fairly easy to remember but the &#8220;secret&#8221; data I have isn&#8217;t worth much more effort!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132327">

			<div class="comment by-ben ">

				<p class="commentcredit">

					<span class="commenter">Ben</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132327">
						March 5, 2010 8:08 PM					</a>

				</p>

				<p>If the device has a battery, couldn&#8217;t you just disconnect it to avoid the lock-out?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132328">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132328">
						March 6, 2010 12:17 PM					</a>

				</p>

				<p>@ HJohn</p>
<p>Thanks for the clarification. ðŸ˜‰</p>
<p>@ Sam</p>
<p>Well, it&#8217;s a step in the right direction. The real problem is that companies are marketing these devices like they provide real protection against more than casual or amateur attackers. Common Criteria is also misleading and part of the problem. So many companies say &#8220;Certified as secure at EAL4+ of the Common Criteria&#8221; and businesses say, &#8220;Hey, the government tested and certified them, so they are good.&#8221; They neglect to mention that CC is mainly about the development process and never tell people EAL4 is designed to protect against &#8220;inadvertant or casual attempts to breach security.&#8221; Inadvertant isn&#8217;t a fitting description of most attacks on crypto. ðŸ˜‰</p>
<p>I&#8217;d like to see more devices with strong tamper-resistance or strong design that eliminates a need for it. For instance, tamper-evident hard drive enclosures that derive the key from an onboard secret, a user PIN, and a physical token like a crypto-key. This mimics the NSA design. The buffers would use fast RAM and all information flow tracked. When the drive is stopped, for any reason, the key and all that data are quickly overwritten. I often promote separation kernels for high assurance because MILS is ideal for this. For red-black separation, label each partition red, black, or MLS. The security policy is two-level: red &amp; black can&#8217;t talk, but they can both talk to MLS; capability-based scheme to further allow very specific interactions between MLS &amp; non-MLS protocols. The MLS components and their interactions with others must be verified, but any other software component can fail without violating Red-Black security.</p>
<p>Designing an external hard drive with no remote attacks and few feasible software attacks is damn near trivial using best practices developed over 50 years. Defeating hardware attacks is far from trivial, but most &#8220;secure&#8221; drives can&#8217;t even solve the software problem. Companies could do better and it wouldn&#8217;t cost much more. You see, Sam, most readers of this blog know that most of the problems in encryption products are preventable and that the company is just spending a lot more on marketing than engineering. Just a little more money &amp; security greatly improves. Most companies refuse to do this because they don&#8217;t really care. So, whenever they label a poorly developed product &#8220;secure,&#8221; promote it for critical stuff, then it gets busted, the good folks on this blog tend to show the greedy bastards no mercy. I can&#8217;t blame them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132329">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132329">
						March 6, 2010 9:12 PM					</a>

				</p>

				<p>@NickP<br />
&#8220;I&#8217;d like to see more devices with strong tamper-resistance or strong design that eliminates a need for it. For instance, tamper-evident hard drive enclosures that derive the key from an onboard secret, a user PIN, and a physical token like a crypto-key&#8221;</p>
<p>I&#8217;m not sure where to weigh in on this wish. Clearly a few cents added for crypto hardware will permanently defeat script kids, however once a competent &#8220;hardware hacker&#8221; has physical possession of the Hard-drive it is really just a matter of time and budget before he gets at the stored data.</p>
<p>So you need to define what you believe your adversary is technically capable off and willing to pay for the information on the harddrive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132330">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132330">
						March 7, 2010 1:08 AM					</a>

				</p>

				<p>@ Robert</p>
<p>&#8220;you need to define what you believe your adversary is technically capable of and willing to pay for the information on the hard drive.&#8221;</p>
<p>I&#8217;m totally with you, here. I&#8217;d go further and say &#8220;capable of&#8221; in general, as it might be a more low-tech solution: shoulder surf the PIN, then later let user fall asleep or &#8220;assist&#8221; them, then take crypto key. So, we definitely need to weigh the value of the information vs. attack vectors vs. existing countermeasures. Risk management in its purest, there.</p>
<p>The point where I take a detour is your claim that a hardware hacker getting access can get the stored data. It depends on a lot. If the data is encrypted with an onboard key, then sure. If the encryptor requires another device to form the master key, then it must be swapped for an identical, subverted one &amp; a method must exist to get the data off of it later, either covert channel or stealing it again. However, if the crypto-key &amp; drive use public-key crypto built into their hardware &amp; authenticate their traffic, then it might take a really sophisticated attacker to retrieve the inter-chip encryption keys in order to subvert the device. Additionally, if all the attacker got was the hard drive, then they would have nothing. So, depending on attacker&#8217;s level of skill, there are numerous level&#8217;s of security provided and each will defeat a particular class of attackers. Believe it or not, the last might cost thousands to attack physically (except if user is attacked), but only cost a few hundred extra to build it.</p>
<p>I have been toying around with a design idea for a tamper-resistant system. The idea is a tiny, trusted embedded computer. It would be small, like a smartphone or PC card. Instead of computers with ports for IO devices/mediums, we would essentially have &#8220;docks&#8221; for this computer. There would be a notebook, a desktop, a server, etc. They might offer expanded functionality, particularly devices, but this embedded computer would be the root of trust. It would have user&#8217;s private key, security policy, hash values for stuff on the &#8220;docks&#8221;, highly secure OS, restricted DMA, etc. Such a limited system would be easy to secure from software &amp; pin IO attacks. The other systems would be built on its security. Someone might say: &#8220;but we already have TPM&#8217;s and all that good stuff.&#8221; Well, they&#8217;re too big to carry all the time. If we use this approach, you can plug your trusted card in to the hotel computer, use it, and then remove it when your done. You could sleep with it, hide it in a field, whatever. To subvert your critical apps on any of these docks, the trusted system must be subverted. My prototype design is basically an embedded coprocessor board with medium assurance. It hooks up to the main system via Firewire to load the software to memory, regularly check its integrity, and it can be asked by apps to perform sensitive operations. It&#8217;s a kludge, though. Real hardware designers could do better.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132331">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132331">
						March 7, 2010 4:18 AM					</a>

				</p>

				<p>@NickP</p>
<p>&#8220;The point where I take a detour is your claim that a hardware hacker getting access can get the stored data&#8221;</p>
<p>Sorry I did not mean to imply that the stored data was unencrypted, only that it is what is on the disk.  There are numerous ways to use two key systems to encrypt the data so that decryption requires access to information that is simply not present on the disk.</p>
<p>Unfortunately most of these protocols also defeat the intended purpose of the device namely as a portable data storage  / inter machine data transport device.</p>
<p>When you physically split the key into multiple portions human behavior is also uniquely optimized to defeat your best efforts.  You will often find that the software key portion gets written plaintext on the device. (Users Logic being it is useless because it is only half the problem, so I&#8217;ll make it easier to use/ remember)  If you add a second device say RFID secure smartcard, to hold the second key, than it will be taped to the hard-drive (rather than being kept separate on a key chain). It&#8217;s always human nature that&#8217;s the weakest link.</p>
<p>Whats interesting is that PUF&#8217;s (as discussed elsewhere) are actually one of the best ways to generate Keys for something like a HardDrive. The reason PUF&#8217;s are very valuable here is that the PUF never needs to be revealed outside of the drive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132332">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132332">
						March 7, 2010 2:20 PM					</a>

				</p>

				<p>@ Robert</p>
<p>Alright, I&#8217;m seeing your real point now. So, you&#8217;re concerned that the human factor, particularly convenience, reduces the security margin of the medium assurance techniques? It can indeed. (sighs) I think it&#8217;s incorrect to assume that users will always do these things. I&#8217;ve actually seen it done less than half the time among lay users. In many cases where it was done, it was insignificant: user who trusts others in the building, but not hackers, posts password on monitor. That&#8217;s not good, but the password security against remote attackers will hold. So, the question is how do we deal with that?</p>
<p>I have to clarify something about my little smartcard-like device. It&#8217;s not intended to go with just that one product. It will work with many products and solutions. It will be exclusively manufactured in a keychain form factor to increase odds of a user putting it there. It would work with several solutions: hard drive encryption, VPN, user authentication on laptop/desktop, etc.</p>
<p>Users would be educated that, like a credit card or house key, it should be protected at all times. This, coupled with the fact that its an expensive secure drive, should keep most users from doing things like taping the usb key to the drive. It would be easiest to pull off in corporate environments, where policy and strong enforcement could ensure that a certain minimal amount of care is taken all of the time, with extra care taken some of the time. Again, this should improve security in many cases. Robert, I&#8217;m not trying to solve the whole problem of INFOSEC here: that&#8217;s impossible. It&#8217;s really a bunch of separate problems requiring separate solutions that integrate in a holistic way. These designs just form one or more components of the total solution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132333">

			<div class="comment by-tom-t ">

				<p class="commentcredit">

					<span class="commenter">Tom T.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132333">
						March 8, 2010 5:16 AM					</a>

				</p>

				<p>I&#8217;ve read most of these comments. Please tell me what I&#8217;m missing.</p>
<p>We&#8217;re focusing on the tree, not the forest. The question is not &#8220;How do I make a USB key safe?&#8221;<br />
The question is &#8220;How do I store data securely and portably?&#8221;</p>
<p>It seems to be agreed that whatever the merits of the device in question, sooner or later it needs to be plugged into another device to allow its decrypted data to be human-readable. For convenience, let us call this other device a &#8220;computer&#8221;.</p>
<p>The question is not whether said &#8220;computer&#8221; is &#8220;trusted&#8221; or &#8220;trustworthy&#8221;. The only question is: Has it been compromised? If it has, the whole thing is an exercise in futility.</p>
<p>Right so far?</p>
<p>So we <em>must</em> assume that it has not, for any of this to be meaningful. Therefore, regardless of whether the computer is trustworthy, you must choose to trust it to proceed. Right?</p>
<p>OK. Now that we&#8217;ve decided that this particular box will be trusted, let us use TrueCrypt or something similar to encrypt our sensitive data. (The plausible deniability is a bonus feature that the USB stick does not offer by default.) This allows the use, not of ten digits, but of all keyboard characters, for the password. Even a laptop keyboard has about 90 useful characters. Using only a ten-character password offers about 2^65 possibilities, if my math is any good. Fifteen characters offers about 2^97, same disclaimer. I think we&#8217;re beyond brute force here, lockout or no. 20 characters gets you almost 2^130.</p>
<p>OK, now use your thumb drive for backing up your letter to Aunt Emily, and burn the TrueCrypt volume to a CD (or DVD, if it&#8217;s that bulky). No more worries about electronic forensics, popping the lockout pin, dismantling the chip &#8212; any adversary can read freely the laser bites in the disc, but what good does it do them? Their only possibllity is of the rubber-hose genre, and nothing works against that.</p>
<p>I don&#8217;t know how the various materials used in CDs or DVDs show up on various scanning devices versus the <em>metal</em> USB stick in question. Answer, please? &#8212;  but getting the medium from point A to point B is a separate issue, to be solved separately. The disk is greater in area, but much thinner, than any USB stick. Work with that. (Sandwich it in between your collection of Michael Jackson CDs.)</p>
<p>Assuming that you carry your chosen, trusted computer with you &#8212; or have it when you receive the CD from a source equally trusted &#8212; you&#8217;re in. If it&#8217;s lost or stolen, you of course made backups, and the finder or thief gains nothing.</p>
<p>The USB is the wrong avenue in the first place: Too vulnerable to both front- and side-channel attacks and physical attack. But if you <em>must</em> have it for some reason, just encrypt the data with TrueCrypt before writing it to the stick. The USB keypad keeps casual thieves out, and the pros who get into it are probably going to rubber-hose you anyway, so why even bother with the extra expense, and with shouting to the world, &#8220;I have super-secret, valuable data on this stick.&#8221; (Yes, obscurity is not sufficient security, but calling attention to your high-value data is a negative for security.)</p>
<p>Oh, and use TC in Portable Mode on BartPE, to leave no traces on the encrypting and decrypting machines. No need even to install TC on the machine, which might otherwise be a further flag to your adversary.</p>
<p>What am I missing?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132335">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132335">
						March 8, 2010 7:52 AM					</a>

				</p>

				<p>@ Tom T.,</p>
<p>&#8220;What am I missing?&#8221;</p>
<p>How about stoping,</p>
<p>&#8220;the pros who get into it are probably going to rubber-hose you anyway&#8221;</p>
<p>It is actually not that difficult to do if you know how.</p>
<p>There are ways to share a secret with a number of people and there are ways that a secret can be made to only work the once&#8230;</p>
<p>If you have to phone three friends and convince them you are ok and you and not under duress or chemical influance to get parts of the shared secret the chances are if they know you well then they will hand you a duress secret if required.</p>
<p>Now the trick is how to make a system whereby if anyone of the three suspect duress and give you their duress secret it gives you the duress key but only if all three give you the non duress secret do you get the non duress key&#8230;</p>
<p>It can be done in a number of ways the question which is best.</p>
<p>After all what you don&#8217;t know (might hurt you but) you cannot tell.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132336">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132336">
						March 8, 2010 9:39 AM					</a>

				</p>

				<p>@TomT<br />
TrueCrypt is a great product BUT how can you ever be certain that the software encrypt program that you are running has not been compromised or that some key-logger is not installed on the machine that you plug the USB stick into.</p>
<p>Sure the hacker still needs to get physical possession of the USBstick but in the case of a targeted attack he will intentionally first load the Key-logger and than steal the usb-stick.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132337">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132337">
						March 8, 2010 6:45 PM					</a>

				</p>

				<p>@ Tom T.</p>
<p>Sure, TrueCrypt to encrypt files and put them on a USB drive. It&#8217;s definitely a common approach. Here&#8217;s the problem: as BartPE lacks a full desktop or notebook suite of useful applications, it&#8217;s not going to be used to work on the stuff in the TrueCrypt volume. Hence, the main OS will wherever it&#8217;s plugged in. That brings me to your next point: the computer is trusted. There are so many ways to compromise a regular PC, but not as many for a USB drive. The problem is that the PC must be able to protect the password/PIN. Even if malware is there when the secure drive is mounted, it will only have temporary access to the files. If the password, PIN or key is found, the access is permanent and the PIN or password might be used to gain access to other machines. Unless you have an OS worthy of being &#8220;trusted,&#8221; it shouldn&#8217;t be. Modern OS&#8217;s can&#8217;t even provide a trusted path, much less trusted authentication to devices.</p>
<p>This is the most basic issues. The other issues to worry about involve attacks on the platform. They might attack the BIOS, they might do a cold boot attack (or the recent warm version), they might rootkit your computer with an evil hypervisor, they might rootkit the OS itself, or create a bogus application to simulate the device PIN entry system. Too many ways for it to go wrong. By contrast, a USB drive with a security kernel, encryption, and trusted path fairs far better. It&#8217;s also easier to do with a hard drive form factor than thumb drive form factor.</p>
<p>As for your opening statement, it would seem that you are also focusing on a tree. You set out to build a secure, portable way to store data and your answer is to start by trusting OS&#8217;s that have had hundreds of vulnerabilities and run millions of lines in kernel mode? Focusing on the forest means building a secure system as a whole. To do this, one first starts with a secure foundation. This is another reason why it&#8217;s easier to secure the USB drives: they are specific purpose, require little software, and hence can be made in minimalist, secure ways. The alternative is doing it your way on a desktop built on top of a verified platform: INTEGRITY; LynxSecure; GEMSOS. Although, you kind of have to code it all yourself to ensure secure integration of various components. Just remember to open-source it and share it with us if you decide it&#8217;s worth the effort. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132338">

			<div class="comment by-tom-t ">

				<p class="commentcredit">

					<span class="commenter">Tom T.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132338">
						March 9, 2010 4:13 AM					</a>

				</p>

				<p>Clive, thanks for the rubber-hose solution. Will keep that in mind.</p>
<p>Robert, please see my opening. The USB has to be plugged into something, as you said, and if that something is compromised, <em>nothing</em> will save you. Hence you <em>must</em> trust <em>something</em>, rightly or wrongly, or you go nowhere.</p>
<p>Nick P: OK, but you&#8217;re taking the issue far beyond the OP, which dealt with selling ordinary consumers and businesses an inexpensive way to (presumably) store portable data securely. I tried to stay within those constraints, and suggested that for that market (98+%?), the encrypted CD might be better.</p>
<p>Of course there are a zillion ways to compromise any (common) thing. See comment to Robert.</p>
<p>How is your &#8220;secure&#8221; USB to be read? Does it include its own reader, or does it plug in &#8220;somewhere?</p>
<p>I think I might not have been clear on the BartPE approach. You never boot your OS. You boot the Bart PE that you made from a known, uncorrupted Win disc, <em>while not connected to the Internet</em>. You run TrueCrypt in Portable Mode, which leaves no traces in the OS, registry, whatever. Please see <a href="http://www.truecrypt.org/docs/?s=truecrypt-portable" rel="nofollow ugc">http://www.truecrypt.org/docs/?s=truecrypt-portable</a><br />
and <a href="http://www.truecrypt.org/faq" rel="nofollow ugc">http://www.truecrypt.org/faq</a> (search &#8220;traces&#8221;) for info on running TC just enough to do your work, then shut down. (Disclosure: I have no connection whatsoever with TrueCrypt.)</p>
<p>The rest of your attacks &#8212; cold boot, etc. &#8212; seem equally possible with any USB stick. Note that I did not suggest putting the TC volume on the USB stick, except if you <em>must</em> use USB for some reason. I suggested the CD/DVD, for reasons  stated in my first post.</p>
<hr />
<p>&#8220;Although, you kind of have to code it all yourself to ensure secure integration of various components. Just remember to open-source it and share it with us if you decide it&#8217;s worth the effort. ;)&#8221;</p>
<hr />
<p>Thanks; I&#8217;ll leave that to others. Which takes me back to my point: What is the best way for most people to use COTS or open-source OTS components to store and <em>move</em> the data around securely? I believe that my suggestion has advantages over the product in question, for multiple reasons. <strong>Not perfect, but better than the ten-digit USB stick advertised.</strong>  That was my bottom line.</p>
<p>Thanks to all for replies.</p>
<p>I know Bruce hasn&#8217;t the time for the likes of this, but I surely wish he could weigh in on the pros and cons of this approach vs. the product advertised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132339">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132339">
						March 9, 2010 4:45 AM					</a>

				</p>

				<p>@Clive<br />
 Off topic:<br />
Clive, I&#8217;ve been reading a number of previous post where you have discussed RFID &#8220;side channel attacks&#8221;, clearly things like the TRNG are very susceptible to such attacks, however it seems to me that it might be possible to even program / reprogram the internal Flash / EEPROM memory directly, using only an appropriate RF modulated field and a synchronized Timing attack.</p>
<p>The reason this attack might work relates to the manner in which the on chip power is regulated on most RFID chips, this is regulation to reduce unintentional backscatter.</p>
<p>If you know of any such attacks, than I&#8217;m very interested in the details.</p>
<p>BTW: An attack like this completely bypasses the program execution and crypto system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132340">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132340">
						March 10, 2010 1:54 AM					</a>

				</p>

				<p>@ Tom</p>
<p>Well, your constraint that you&#8217;ve mentioned explains part of my post: my solution is designed to provide <em>real</em> protection against <em>real</em> threats, not a security theater show for the layman that will buy anything. Also, that kind of layman isn&#8217;t 98% of this market: we&#8217;re talking about somewhat inconvenient, more expensive drives here. That&#8217;s actually quite a smaller market. The people willing to buy this flash drive may be willing to buy a portable, external HD with real security. But, moving on to your real question: &#8220;what about the BartPE/TrueCrypt solution for most lay persons?&#8221;</p>
<p>I know about BartPE. The reason I said what I said is because of how the layman (average, 98+%) thinks. Well, that solution isn&#8217;t nice for the layman. The lay man wants convenience and many who know about TrueCrypt or PGP and their ease of use are already buying some cheap thumb drive with a PIN. Now you show up talking about saving their documents, shutting down their computer, booting some CD, plugging in a device, maybe waiting for driver installation (again!), authenticating on it, loading up truecrypt, typing in some long/good password, working on stuff, saving stuff, closing truecrypt (taskbar too, for next part), &#8220;safely removing&#8221; thumb drive, and restarting computer, reentering password in the process. Wow! It&#8217;s that simple?!</p>
<p>The geek class has already had a simple &amp; somewhat secure solution to malware problems: keep an up-to-date, read-only, RAM-only, locked down Linux distro on a CD-ROM. Also, have your banks&#8217; public key written down. Boot up off the CDROM, connect to the bank, do your stuff, and get off. A separate computer for critical stuff that never goes online otherwise is also nice. Even the geeks usually don&#8217;t do this stuff, security geeks included. The steps involved in your solution are quite involved for the layperson who hears the marketing material for this thumb drive and is like &#8220;well, why don&#8217;t I just do this? it&#8217;s easier!&#8221; Perhaps, they see some SanDisk encrypted thumb drive and it&#8217;s FIPS certification and think, &#8220;If the government trusts this thing, then so will I!&#8221; Don&#8217;t get me wrong: your idea definitely has merit on technical and security grounds. As a matter of fact, I use a similar solution with Ubuntu &amp; Incognito (overwrites RAM after use) in prototype private viewer designs.</p>
<p>I just don&#8217;t see damn near any of 98+% of the market doing your complicated solution every day. They&#8217;d rather just buy something they can type some crap into and plug in: maybe my ultra-secure external hard drive that&#8217;s somewhat expensive, but most likely a really cheap encrypted thumb drive with little to no security. Convenience trumps tedious security. It&#8217;s just how the market works, Tom. That was my point.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132341">

			<div class="comment by-tom-t ">

				<p class="commentcredit">

					<span class="commenter">Tom T.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132341">
						March 10, 2010 8:13 PM					</a>

				</p>

				<p>@ Clive: That which I do not know cannot be beaten out of me, but I can still be killed or, more likely, maimed, for refusing to reveal it if my adversary cannot be convinced that I don&#8217;t know it.</p>
<p>Nick P, thanks for your continued courteous reply. I <em>did</em> fail to state my target market and constraints in my OP, and apologize for the suggestion that my solution was &#8220;perfect&#8221;.</p>
<p>I&#8217;m looking, first:</p>
<p>at those who already trust their boxes, rightly or wrongly, and think the advertised product is &#8220;the answer&#8221;. Many comments here suggest that it is of dubious value, even on a &#8220;safe&#8221; platform. Assuming said trusted box, it is not at all hard for a non-tech user to use TrueCrypt in normal mode; their step-by-step screenshots are excellent. The CD was suggested as being not subject to the physical destruction, electronic attacks, etc. of the USB, but instead relying on the encryption of TC. To me, the USB stick is the &#8220;security theater&#8221; &#8212; a much more false sense of security.</p>
<p>I secondly went into the Bart thing to try to forestall and address the inevitable comments that no OS or puter is trustworthy. It&#8217;s definitely a step up the tech scale. I realize class (1) won&#8217;t do this, but I still think they&#8217;re better off my way than the advertised way. Your opinion on that specific comparison is welcome.</p>
<p>I agree thoroughly that most users will buy the SanDisk FIPS, or this one, and think they&#8217;re done. &#8220;We&#8221; need to disabuse as many as possible of this idea.</p>
<p>As you say, the geeks already have much more secure platforms, so I should have left that Bart part out (but would have been attacked on that grounds, LOL). For that portion of the masses who follow reasonable safe hex, and are not ultra-high-value targets, I think that encrypting your files with TC is quick, once you get used to it, and adds safety to either any USB stick or the CD &#8212; and eliminates the need for the &#8220;security theater&#8221; costly USB gizmo.</p>
<p>And as mentioned, a USB stick with those buttons screams to the world &#8220;I have valuable data worth stealing&#8221;, while a blank CD &#8212; you can make your own label. &#8220;My visit to Grandma&#8217;s house for Christmas&#8221;. Every little &#8216;bit&#8217; helps (ha ha)</p>
<p>For those already compromised, we can&#8217;t help them at this point.</p>
<p>For known ultra-high-value targets, they&#8217;re going to have to move strongly in your direction, and hopefully choose the right consultant, of which there are few.</p>
<p>I think we&#8217;re not as far apart as it may have seemed, and that was my fault for not iterating the above distinctions. The post was already amply long, IMHO. I&#8217;ve enjoyed our discussion, and if you have any further comments, I&#8217;d welcome them. I&#8217;m just trying to come up with something better than the advertised product, that is still within the skill level of most users (and in the case of TC, free.) Thanks again.</p>
<p>p. s. I trust Password Safe, which Bruce fathered (or at least, donated the sperm lol) for those long, safe passwords. Again assuming no keylogger or any other malware in my machine, am I not safe? &#8212; makes using crypto-strength passwords a breeze, and also free. So the TC process is sped up by that, also.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132342">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132342">
						March 12, 2010 10:58 PM					</a>

				</p>

				<p>@ Tom T</p>
<p>Your point about the dubious nature of the advertised product seems right on. I also agree that TrueCrypt is usable, with a little training, for non-technical users. Some will need more training than others, but I&#8217;m sure most can learn to use it. The big question is: will they go through that trouble every time they want to access something confidential? I&#8217;m doubting it. Also, the use of a TC-encrypted CD medium instead of the USB device simply shifts the angle of attack from a simple, very secure device class to a complex, vulnerable-as-hell device class. If the BIOS/firmware/hypervisor-layer is attacked, then the CD-ROM doesn&#8217;t ensure a trusted initial state. See the Blue Pill attack for an example. Now, if this isn&#8217;t the case, then BartPE loads and the system is in the state it was on the disc, hopefully uninfected.</p>
<p>So, what can happen next? A BartPE system with certain apps will have any vulnerability the same regular Windows system would. If it has Internet connectivity, it can be hit that way. If a user surfs the Web while working on confidential documents, a simple drive-by-download or spoofing attack can get the key. If they leave for a minute while BartPE loads, an attacker could do a firewire-based attack before they get back. The thing that all of these attacks have in common is that they rely on the weaknesses of the platform and that they all get the key. At that point, the attacker can have permanent, unrestricted access to the data on the medium. A trusted path, like PIN, USB drive wouldn&#8217;t allow this even if it&#8217;s in enemy hands. With these points in mind, I&#8217;ll address your other questions.</p>
<p>Your next point was that the solution you mentioned is still better than the advertised one. I&#8217;d agree that the advertised one &amp; most FIPS drives are pure security theater, while your solution protects against <em>some</em> threats. So, I&#8217;d agree that TrueCrypt+BartPE is better. As for the ultra-high-value target part, you don&#8217;t have to be one. The real concept is: is the information on your drive worth more than it costs to extract it? If it is, then a corporate spy might try to attack it. If it&#8217;s on a regular laptop/desktop, he will great it with a smile. If it&#8217;s some secure USB drive &amp; he has to subvert it too, he will be unhappy with the extra time &amp; money he will spend: reverse engineering; hacking; making it look unmodified; do so before user notices it&#8217;s missing. Most corporate spies don&#8217;t get violent, so there is a ton of risk if it&#8217;s on a secure platform vs a &#8220;make yourself at home&#8221; OS. ðŸ˜‰ The attempts to put the security into a separate device isn&#8217;t security theater: special-purpose devices are inherently easier (and cheaper) to secure. There&#8217;s also dedicated, secure coprocessors to help.</p>
<p>So, any targetted attack is better off when the user is using TrueCrypt on a mainstream OS. You don&#8217;t have to be ultra-high-value to attrack a sophisticated attack: you just have to be worth a few minutes and a firewire cable or one paid-for custom firmware hack. Script kiddies could pull that off with prepackaged tools. I mean the average user trying to protect their tax records might do this, but the computer OS/firmware must be <em>really</em> locked down (and have no firewire) before I&#8217;d trust it. But, if you are bent on coming up with such a method, a custom Linux distro on read-only USB drives (they exist) with a secure, signed update function &amp; truecrypt could do the job. The hardware would have a protected BIOS, be hard to disassemble, and support Intel vPro in its safest incarnation for protection against rogue devices &amp; modified software. The reason to use a custom Linux distro is that you can build it bottom-up &amp; only put in what you need, reducing attack surface.</p>
<p>Finally, I don&#8217;t trust Password Safe (or KeePass, for that matter). I like to think of it as a variation of the Lord of the Rings line: &#8220;one [keylogged] password to pown them all.&#8221; Password Safe&#8217;s design assumes that the underlying system (a) has a trusted path and (b) is free of privileged malware, which also defeat (a). Todays systems are riddled with insecurity at every level, so neither assumption is safe in theory or practice. Just look at the size of the botnets (read: powned computers) these days &amp; how quickly they rebuild them. You can use the password managers, but you are taking great risks. If you value the convenience over security, then that&#8217;s fine as long as you know you&#8217;re making the tradeoff. I keep thinking about porting it to an external, secure coprocessor but there&#8217;s still so many risks. We need a trusted path in the OS&#8230; and now the browser, which is a crappy second OS these days.</p>
<p>And your post wasn&#8217;t too long: it clarified plenty of points, allowing me to focus on what mattered. Besides, Clive&#8217;s posts are like a DOS attack on my system resources: if I can survive them, then yours should be no trouble. ðŸ˜‰ I&#8217;ve also enjoyed our discussion &amp; I hope that, as always, the details in it benefit casual passers-by who have similar questions as you. I also hope, consistent with one of my personal goals, that I&#8217;ve shown you just how important platform-level security is &amp; why we need to replace our current platforms. I&#8217;ve been promoting certain architectures &amp; OS&#8217;s that do a better job. If you want to look at a small sample, then look at the links in my last post to Winter (near bottom at 2:08pm) here:</p>
<p><a href="http://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html#comments" rel="nofollow ugc">http://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html#comments</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132343">

			<div class="comment by-thecoldspy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.thecoldspy.com' rel='external nofollow ugc' class='url'>thecoldspy</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132343">
						March 13, 2010 6:15 AM					</a>

				</p>

				<p>Great comments all. However one point made very clear is that the disk itself screams valuable data installed here. Not many have mentioned one major issue, which is traveling with it through airports. Since TSA has I believe the legal right to ask you for your passwords on any device going through the airport, one would assume that they would skip a music CD with a Truecrypt container file, but defiantly ask you for the pin or password to a device that screams important secure data resides here. Also, where is the double blind password implemented on this so called secure device? If it does not exist, then easily one pin number opens it and gives everything inside.</p>
<p>I agree that one could in fact then have everything encrypted in it with a double password, one for garbage files which can easily be given to an airport rep or other rep so asking, and the other for the important data. But a device such as this is screaming to the public when you travel that important data may in fact reside here, instead of on that Music CD where you just so happen to have the real important data.</p>
<p>I think it is worth discussing, since most people would assume rather wrongly that they could in fact travel with such devices through an airport without question, which they could on a random basis, but would have to be willing to allow 10.00 per hour airport reps the ability to scan everything on the drive prior to boarding if they so asked. And if you refuse, they can confiscate said disk, thus you will lose the important data, or at the least they can deny you the ability to board.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132344">

			<div class="comment by-thecoldspy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.thecoldspy.com' rel='external nofollow ugc' class='url'>thecoldspy</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132344">
						March 13, 2010 6:38 AM					</a>

				</p>

				<p>Also one more issue. If we are talking about real world applications for such a device, then we must look at the reality behind such devices in say a routine traffic stop. Officer A sees super secure device in your possession. Officer A moves to ask you for the pin so he can look at your data on his laptop, you refuse, thus giving him probable cause based upon the stop to run you in for a further examination. Again you are asked for your pin, you give it up, thus data is no longer secured. If you do not give it up, what comes next can be more costly to you.</p>
<p>On the other point brought up about it being inserted into a non trusted computer, if that computer had malware on it with a logger, as soon as the drive was recognized, data would then no longer be secure. This leads you to the conclusion that the device is meant for never leaving the office or traveling with it or allowing it to leave a or inserted into a non trusted computer, making it a totally useless device for any real world security application.</p>
<p>Sounds more like a marketing device made to give the illusion of security where no security truly exits. If you are the sole holder of this pin, you can be asked &#8211; or even in some cases &#8211; required by law to give said pin to appropriate authorities, thus rendering any data on said device insecure. As long as this is true, it is often better to use truecrypt and place a container file on a random music CD. When stopped or questioned by the authorities, they see a random set of music CD&#8217;s instead of super secure devices in your possession. If by any stretch of the imagination you are asked by the authorities to see the music CD, the officer hears music on it, thus allowing him to move onward without further questioning. Same applies in an airport, no secure looking devices present, thus data security is more assured. The less you look like you are carrying sensitive data, the better the chances are you will not be molested or required to divulge said pins.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132345">

			<div class="comment by-roger-wolff ">

				<p class="commentcredit">

					<span class="commenter">Roger Wolff</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132345">
						March 13, 2010 3:26 PM					</a>

				</p>

				<blockquote><p>
  making it a totally useless device for any real world security application.
</p></blockquote>
<p>Scenario 1. You need to transport data between two computers you own.</p>
<p>(re: giving up the pin to the authorities)<br />
Scenario 2. Your adversary is not the authorities.</p>
<p>Re: implementation:</p>
<p>Of course we, the readers of this blog, know that you should add the entered key to the stored (random) key and then decrypt a relatively big block of data, with the final result needing to be a specific value for the decryption key to be correct. In practise however, I&#8217;m guessing that the device simply holds your 256 bit key somwhere, and has firmware to refuse to initialize the crypto module if you don&#8217;t provide the proper pin.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132346">

			<div class="comment by-tom-t ">

				<p class="commentcredit">

					<span class="commenter">Tom T.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132346">
						March 13, 2010 5:43 PM					</a>

				</p>

				<p>@ Nick P.:<br />
&#8220;If it has Internet connectivity, it can be hit that way. If a user surfs the Web while working on confidential documents, a simple drive-by-download or spoofing attack can get the key. If they leave for a minute while BartPE loads, an attacker could do a firewire-based attack before they get back.&#8221;</p>
<p>Please note that I did specify what seems to be common-sense for the security-conscious: Do not be connected  to the Internet when working with data that are sensitive enough to require encryption, whether they are headed to USB or CD or whatever. Leaving a machine unattended is <em>always</em> a risk; again, you don&#8217;t do that when doing sensitive work. (I&#8217;d put the laptop in its case and carry it into the restroom with me, if it were a public place/airplane, whatever &#8212; but mostly, try do do it at home.)</p>
<p>I&#8217;m well aware of the need for trusted platforms. I don&#8217;t see the average home user getting one that they can afford; education in safe hex is probably the best that we can hope for. Gov and corp with huge DBs definitely need more than OTS stuff. No argument. GL with your system &#8212; of course you&#8217;ll let us know when it&#8217;s ready.</p>
<p>(But how do we know that we can trust <em>you</em>? lol. &#8212; open source, vetted by many pairs of eyes, etc. &#8212; same ol&#8217;, same ol. [wink])</p>
<hr />
<p>&#8220;Password Safe&#8217;s design assumes that the underlying system (a) has a trusted path and (b) is free of privileged malware, which also defeat (a).&#8221;</p>
<hr />
<p>If those conditions are not met, then are you not hosed regardless of whether you&#8217;ve memorized an epic Norse pass-poem? As soon as you enter it&#8230;.</p>
<hr />
<p>&#8220;Besides, Clive&#8217;s posts are like a DOS attack on my system resources: if I can survive them, then yours should be no trouble. ;)&#8221; ROFLMAO!!!! (No offense, Clive; you&#8217;ve made some good points. As Bruce so coyly says, &#8220;There are many comments, some of them interesting&#8221;.)</p>
<hr />
<p>@ thecoldspy:</p>
<p>Thank you; I&#8217;ve been saying exactly the same thing. Obscurity isn&#8217;t security, but it can help. Putting up a neon sign that &#8220;I am carrying data worth stealing&#8221; definitely hurts. Good points on both TSA and police traffic stops (or other encounters). Pick a band that most cops hate, have the CD case on the back seat with old bags of half-eaten potato chips, etc&#8230; Filling it mostly with actual music files, then a hidden-volume TC volume, is cool, since a TC volume is designed to appear as random garbage to any analysis.</p>
<p>@ Roger Wolff: I&#8217;m mostly assuming that you are carrying your laptop with you, or else sending the CD to a trusted associate by snailmail, with a return address of MegaMusic, Inc., or some such additional subterfuge &#8212; haven&#8217;t thought that part through thoroughly yet &#8212; Better &#8212; Send a couple of sweaters in birthday wrapping paper, write &#8220;Happy Birthday&#8221; in big letters on the outside brown wrapping paper, and put the CD inside, in between the sweaters.</p>
<hr />
<p>@ EVERYONE: The excellent part of all of this is that it <em>gets us thinking</em>. Long before reading Bruce&#8217;s statement that the best mindset for a security-conscious programmer or whatever is to think like a thief &#8212; &#8220;How can I bypass this system&#8221; &#8212; I used to amuse myself in airport security lines by visualizing ways in which I could get a banned item through, easily and with high confidence. The type of discussion here helps us all to look at the latest products and solutions, and decide: Snake oil? Genuine benefit? &#8212; or the usual, &#8220;tradeoffs&#8221;, and to determine the relative value of those tradeoffs.</p>
<p>FWIW, I lead a terribly dull life, nothing anyone would want to know about, just  the usual few credit cards, etc. And I might want to keep private any records of a discussion with a lover, or of health, family, or other personal matters, even though these are of little value to a thief. (Try to blackmail me? [shrugs] Publish it, I don&#8217;t care. End of blackmail. If you are in a sensitive corp or gov post, then live your life accordingly, Misters Spitzer, Sanford, etc.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132347">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132347">
						March 14, 2010 12:00 AM					</a>

				</p>

				<p>@all<br />
  with a secure flash drive as discussed, what are you all&#8217;s thoughts on the data files having a maximum lifetime?<br />
What I mean is that the files will be automatically erased if not accessed with the correct pin within some &#8220;user defined&#8221; time period.</p>
<p>This feature would not stop anyone familiar with the device (that could disable the tamper detection and remove the battery, in time) however it would sure make the police look silly when they claimed some data was on the drive, only to find it completely erased, because they waited too long between accesses.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132348">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132348">
						March 14, 2010 12:25 AM					</a>

				</p>

				<p>@ Robert</p>
<p>Actually, it&#8217;s not a bad idea so long as people remember to reset the clock. The number of expired SSL certificates out there immediately comes to mind. If they forget or don&#8217;t care to read the manual, then their data both expires &amp; disappears.</p>
<p>If you&#8217;re into fooling the authorities, look into deniable computing like deniable encryption &amp; deniable filesystems. The filesystems like StegoFS are pretty interesting. If built correctly, someone with a rubber-hose attack can&#8217;t ever prove you have more data on them. Of course, they can&#8217;t prove you gave them everything, either. A double edged sword that might be useful for certain people, but for the average person possession of this might be an admission of guilt in today&#8217;s courts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132349">

			<div class="comment by-gianluca-ghettini ">

				<p class="commentcredit">

					<span class="commenter">Gianluca Ghettini</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132349">
						March 15, 2010 6:18 PM					</a>

				</p>

				<p>I don&#8217;t understand the point to this type of lock-out protection.. I mean, if I have physical access to the device, I can dump the flash memory, then find out how the actual AES encryption key is generated from the numeric PIN (there must be an algorithm hardcoded somewhere inside the usb key), then decrypt the content of the dump file by bruteforcing over the PIN space in a reasonable amount of time. (nowadays, a 10^10 key space is ridiculous)<br />
I think this is just another case of security-by-obscurity</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132350">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132350">
						March 15, 2010 8:34 PM					</a>

				</p>

				<p>@Gianluca<br />
  I don&#8217;t disagree entirely with what your saying, BUT your attack depends on you accessing the PIN. Without the on chip PIN your attack becomes a brute force attack on AES.<br />
If these guys know what they are doing they will protect that PIN and make sure it is not externally accessible, or even accessible by decapping and probing the chip. If they add some tamper protection than they could have a very secure product.<br />
(see my comment on this being an ideal application for an on chip PUF (Physically unclonable function)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132351">

			<div class="comment by-gianluca-ghettini ">

				<p class="commentcredit">

					<span class="commenter">Gianluca Ghettini</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132351">
						March 16, 2010 5:50 AM					</a>

				</p>

				<p>@Robert</p>
<p>well, no&#8230; my attack doesn&#8217;t require to know the right PIN, only the PIN-&gt;AESkey algorithm which of course (as you pointed out) must be reverse-engineered by decapping the chip. By the way, decapping the chip may be very difficult and expensive.</p>
<p>However, there&#8217;s no need at all to hardcode the right PIN inside the usb key nor the AES encryption key. THe user enters a PIN using the numeric pinpad, the algorithm computes the AES encryption key on the fly from that PIN and tries to decode the data. Finally, some crc or hash check can be performed to verify that the entered PIN was the right one.</p>
<p>I may have not explained well my attack&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132352">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132352">
						March 16, 2010 4:28 PM					</a>

				</p>

				<p>@ Gianluca</p>
<p>Yes, the attack would be prohibitively expensive, which is the point of hardware security because none are foolproof. We just want the enemies to look at the task ahead of them and say &#8220;it&#8217;s not worth it.&#8221;</p>
<p>Due to the many attacks, though, I generally don&#8217;t recommend the PIN alone be the security. For one, a secure microcontroller should store the permanent secrets and produce the key from the PIN. Two, I&#8217;d prefer a design similar to the NSA&#8217;s IME where a PIN is combined with a Crypto Ignition Key. The form factor is about too small, though, so I was toying with the idea of a tiny key-like crypto device used alongside a high security product like the thumb drive. The key device works with all devices the company makes &amp; basically authenticates those devices using a shared secret unique to each storage device. The keylike device would store the master key used for encryption, sent to thumb drive over a secure tunnel after it authenticates. Each would probably use 1 USB port, but you could take the key device out after it transmits the secret key. It could store keys for a number of devices. While this scheme is slightly cumbersome, the user would only have to protect &amp; always carry that one key. Without it, the storage mediums and such would be useless. Note: the thumb drive would still have a PIN entry, but the PIN would be mixed with the secret key stored in the key device. Upon use, the decryption key would be overwritten with pseudo-random data.</p>
<p>Alternatively, the key device could have some kind of tiny connector that would be present on all company devices and be plugged in directly. This eliminates the need for crypto during transmission, but might raise the cost by using unusual connectors. The company could use it in a variety of medium assurance products: secure storage; VPN&#8217;s; link encrypters; authentication systems. There will have to be a revocation or reset scheme for when users loose their key, though, and that must be done <em>very</em> carefully. It&#8217;s likely to be the weakest link.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132353">

			<div class="comment by-gianluca-ghettini ">

				<p class="commentcredit">

					<span class="commenter">Gianluca Ghettini</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132353">
						March 16, 2010 6:17 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>Very interesting idea. It reminds me of the trusted platform module, in which users can safely store their account passwords and encryption keys. The only difference is that the TPM resides inside the computer (as a chip soldered to the motherboard or as an extra cicuitry added to the die of the cpu) whereas the keylike device is an external device.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132354">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132354">
						March 16, 2010 9:44 PM					</a>

				</p>

				<p>@Gianluca</p>
<p>I did not explain myself properly.</p>
<p>What I was proposing there would be a separate (secret number say 256 bits) on each  device (a PUF probably), this would be mixed with the user PIN to form a unique key, this key would be so large that attacking the PIN to AES key process would be useless. I think NickP is suggesting the same.</p>
<p>Unlike Nick&#8217;s solution I would not allow the device secret number to be accessible (or programmable), in any way (other than for internal AES key generation).   Adding access to this internal key (PUF) creates to many security weaknesses.  My  solution is likely to make me sound like a fool, because the current thinking is that public key methods are better suited to the task, the logic being that any stored secret key is like a huge flashing sign to a hardware hacker (dig here for gold)</p>
<p>My only defense is that I&#8217;ve always maintained that the data should be first encrypted on the host computer, before being sent to any external  device. Additionally I do not use a single secret key (common to all devices) rather each one has it&#8217;s own secret key, which is completely unknown outside of the chip. Discovering the secret key is only possible by destroying the device (at which point the key is useless to you and everyone else). If you assume your adversary is capable of extracting the PUF key and constructing a similar device with your key, than I&#8217;d respectively suggest that &#8220;that data&#8221; does not  belong on ANY portable device.</p>
<p>In the this existing product the 5 key (10 digit) PIN is the obvious weakness.</p>
<p>For real security this user &#8220;PIN&#8221; needs to be at least 256 bits long and possibly stored in some master key secure style tag. The usb drive needs to make a secure tunnel. Nick&#8217;s solution makes this master key another USB device which must be plugged into the host at the same time as the encrypted drive. I would probably make the master key tag a secure RF tag.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132355">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132355">
						March 16, 2010 10:39 PM					</a>

				</p>

				<p>@ Nick P, Gianluca,</p>
<p>If it was me designing the product I&#8217;d,</p>
<p>First : make it look exactly like any USB extension &#8220;numeric keypad and tracker ball with memory card reader&#8221; and make it function that way as well.</p>
<p>Thus having it with a laptop etc is perfectly plausable and desirable. You could also put a longer than normal lead on it and a little backlit LCD and make it effectivly a &#8220;presentation&#8221; controler as well.</p>
<p>Second : the flash storage would be an SD or other memory card and removable it would be perfectly normal except for a &#8220;crypto container&#8221; file.</p>
<p>Third : a &#8220;Crypto Ignition Key&#8221; as a VLF RFID key fob. (Or using a cheap RJ11/RJ45 connector etc).</p>
<p>If the  key pad device had USB &#8220;on the go&#8221; then there are all maner of other possabilities.</p>
<p>Essentialy the keypad device would send out a challenge to the key fob and vise versa via a &#8220;shared secret&#8221; protocol of some kind (which one does not overly matter as long as it&#8217;s replay proof etc).</p>
<p>Once the keypad device and key fob have negotiated and recognised each other, the &#8220;root directory list of the memory card&#8221; is sent to the fob. If the fob recognises a valid container name it lets the keypad device know that a pin should be entered.</p>
<p>If the user types the pin on the keypad within a short time out period, the pin is sent to the fob (but not the computer).</p>
<p>The fob then requests the first block of the container file and uses this &#8220;serial number&#8221; along with the pin to look up and decrypt the &#8220;AES Token&#8221; in it&#8217;s own internal DB.</p>
<p>It sends the AES Token to the keypad device that then decrypts the token to get the actual AES key.</p>
<p>Thus to get the AES key you need to have,</p>
<p>1, A valid container.<br />
2, The valid PIN<br />
3, The keypad &#8220;secret&#8221;<br />
4, The fob &#8220;secret&#8221;</p>
<p>The fob will store more than one AES Token per container serial number.</p>
<p>Thus several keys are available selected by the PIN the user types in so administerative and duress keys etc are possable (ie container is multi level and user thus has reasonable deniability).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132356">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132356">
						March 17, 2010 2:10 AM					</a>

				</p>

				<p>@ all</p>
<p>My designs specifically avoids trying to be deniable. If your scheme is secure, it doesn&#8217;t matter if you advertise the importance or not. Sure, deniable schemes reduce your risk of being randomly targetted or risks against availability of data. However, deniability provides little protection of assets except against the most casual or inept thieves and cops. The Feds I know will take every device you have &#8220;just in case,&#8221; but my previous designs aren&#8217;t really for protecting against Feds: they know how to find TrueCrypt &#8220;hidden&#8221; (Nick laughs) partitions using free tools online and if they are after you then you have much more to worry about. Tiny flash drives, untraceable netbooks, innoculous RAM-based Linux distro&#8217;s, good hiding spots &amp; innoculous ways of storing/retrieving these are best way to hide stuff. I&#8217;ve got tons of proven schemes that&#8217;s I&#8217;ve designed and picked up from others, but if I share them they aren&#8217;t deniable. (sorry)</p>
<p>That wasn&#8217;t the point of my posts, though. I&#8217;m more worried about the people who are actually targetting me and my data: casual thieves; script kiddies; prick low-tech physical hackers; good software hackers; good, but underfunded hardware hackers; sophisticated and well-funded attackers. My thumb drive scheme protects you in five out of six cases most of the time, but not the last because it&#8217;s cost prohibitive. The cops target you if you are: diskliked; conspicuous; somewhat suspect; substantiated suspect; totally guiltly except for a court hearing; true rebel/saboteur/terrorist. Being a nice, helpful guy deals with the first three and sometimes fourth. Good hiding and mobility strategies prevent the next two from being a problem. The last one requires paranoia beyond most people can&#8217;t stomach and I won&#8217;t even try to help you. So, why are you guys focusing so much on deniability if it buys you little against any serious attacker and theft losses can be defeated with a backup mechanism for encrypted data?</p>
<p>@ Robert</p>
<p>I was referring to an onboard secret that was diffult to access, but not PUF&#8217;s specifically. I believe you, Clive and I have had the discussion on them before. I&#8217;m still avoiding them for now because their security properties are controversial, just as biometrics were early on (and rightly so). I also specifically avoided public cryptography because it is too complex, bug-prone, &amp; resource intensive. We&#8217;re talking about a thumb drive here whose bill of materials must be dirt cheap. For reference, my mutual authentication &amp; master key generation scheme is very similar to the one Clive mentioned. There&#8217;s some details that are different, but the principle is the same: one must compromise two devices, one trusted &amp; one semi-trusted, and a user PIN to decrypt whats on one device. This situation is hard for both casual thieves and smart attackers because the ratio of work to protect it vs work to break it works in users favor.</p>
<p>If we aren&#8217;t using a validated PUF scheme and we want to be able to loose the drive, then the secret [partly] has to be stored elsewhere. User&#8217;s memory, users PC (must be secured), or some kind of key fob. The first is unworkable, the second is very impractical (currently), and the latter was the basis of my strategy. Sure your plugging two things in, one on your keychain and one from briefcase, but how hard is that? Just never loose the key thing and you can loose anything that depends on it without worry. Users are also already trained to understand the importance of and protect keys. This is why the NSA&#8217;s &#8220;Crypto Ignition Key&#8221; device looks like a key: builds on user&#8217;s ingrained habits. Password habits, laptop habits, web surfing habits and the like all suck in comparison. The only worry is lost or stolen keys. I&#8217;d try to reduce the risk with carefully conceived revokation, erasure and recovery mechanisms, but prevention is the best strategy with tiny devices &amp; the key fob thing helps there. Btw: it doesn&#8217;t necessarily have to be USB, but I&#8217;m not experience enough in embedded hardware design to know what connectors are tiny &amp; still cost-effective in quantities of tens of thousands so I just said that by default.</p>
<p>@ Clive on deniable, secure devices</p>
<p>Ah, the sleeping giant awakes. Trying to steal my thunder old man? ðŸ˜› I&#8217;ll admit your trackball/numberpad idea is pretty nice &amp; for more covert activities than you mentioned. Since I&#8217;ve already talked about the deniability issue in general, I&#8217;ll focus on the product level here. The main problem about your plan is that your deniable device must not be deniable to succeed in the marketplace. Let me explain for the sake of the others. Products secure enough to mitigate all risks I mention above usually cost a lot of money to develop, test &amp; independently evaluate. They are also relatively costly to produce due to extra muscle or functions needed for crypto, zeroization, etc. Any company that develops something like that will market it as aggressively as possible to recover their investment. Green Hill&#8217;s overmarketing of INTEGRITY &amp; General Dynamics remodeling &#8220;Sectera&#8221; government products into &#8220;TalkSecure&#8221; commercial ones are good examples.</p>
<p>The point? If a company invests in and markets your device, all attackers who read slashdot, engadget &amp; schniers blog will know about &amp; target it in weeks. A percentage of the rest will follow. Unless they design, test &amp; build it too cheap to be secure, it won&#8217;t be deniable. That&#8217;s my theory &amp; the field of spy gear &amp; success in compromising &#8220;encrypted&#8221; COTS thumb drives seem to support it. Tremendous numbers of regular or professional attackers read up on things. They know what to look for. So, even if deniability doesn&#8217;t work, the security should be good enough to work. Unfortunately, designs that are secure and affordable can&#8217;t be deniable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132357">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132357">
						March 17, 2010 6:25 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;Ah, the sleeping giant awakes. Trying to steal my thunder old man? :P&#8221;</p>
<p>I do wish people wouldn&#8217;t hammer on about my &#8220;god like&#8221; apperance, it&#8217;s a bit of a Thor point 8)</p>
<p>(Just like the end of my thumb right now, I was busy doing the cooking and dicing an onion when yeouch I sliced open a little fingernail sized flap, and it would not stop bleading, the result supper an hour late and my thumb to big to type with at the usual rate 8( mind you I&#8217;m excused KP / dish wash for a few days 8)</p>
<p>&#8220;The main problem about your plan is that your deniable device must not be deniable to succeed in the marketplace.&#8221;</p>
<p>I was not using deniable for it&#8217;s &#8220;function&#8221; but deniable as in &#8220;not in use&#8221; or &#8220;insufficient privalages&#8221; (ie not admin level etc).</p>
<p>We see this with SD cards they are so common they don&#8217;t attract attention as a &#8220;crypto&#8221; device, even though they are in most cases. They are just seen like MMC cards as &#8220;mass storage&#8221;. Likewise with phone SIM cards as &#8220;they make the phone work&#8221; not &#8220;crypto engine&#8221;.</p>
<p>Often the easiest way to hide something is in plain sight, and the easiest way to do that is &#8220;familiarity breeds contempt&#8221;. You don&#8217;t hide the capability you just make it a &#8220;minor feature&#8221;.</p>
<p>The whole point of making the flash memory a removable memory card is the same as the ignition key (fob) you have one more stage of seperation so it is just like an IME from that point of view.</p>
<p>However the side effect is unless you have a memory card &#8220;WITH&#8221; a &#8220;VALID&#8221; container file, you don&#8217;t have an IME. What you have is a usefull keypad/vanilla memory card reader/USB on the go/ USB hub device.</p>
<p>Likewise the binding of the parts together so that any one part is missing none of the others can be used to build the AES key, renders it just a usefull device not an IME.</p>
<p>With regards,</p>
<p>&#8220;Products secure enough to mitigate all risks I mention above usually cost a lot of money to develop, test &amp; independently evaluate.&#8221;</p>
<p>If the design is done correctly the expensive part is the &#8220;independently evaluate&#8221; and there are ways to reduce that cost as well (use a standard EAL4+ crypto card, or SIM card as the crypto engine).</p>
<p>Likewise,</p>
<p>&#8220;They are also relatively costly to produce due to extra muscle or functions needed for crypto, zeroization, etc.&#8221;</p>
<p>The big up front cost is generaly in &#8220;tooling&#8221; not component cost.</p>
<p>Likewise in many cases the cost of placing an item like a resistor or capacitor onto a surface mount PCB is more expensive than the component it&#8217;s self.</p>
<p>As for &#8220;heavy lift&#8221; or &#8220;silicon grunt&#8221; the price of CPU&#8217;s with inbuilt crypto is down to about one USD difference if you shop around (have a look at SIM chips for instance).</p>
<p>As for &#8220;zeroization&#8221; we&#8217;ve had a chat about this in the past and it is a design trade off. In some respects the price is a diode electrolytic cap four resistors and a bit of interupt driven software.</p>
<p>Even the NSA accept that AES encrypted data is secure to &#8220;Top Secret : Codeword&#8221; without the AES key (or so they tell us with their IME blurb ðŸ˜‰</p>
<p>The real expensive part is &#8220;anti snooping&#8221; that is TEMPEST and Tamper Evident design. For a comercial design the later can be achived by making it throw away epoxy filled, the former is currently/probably not of relevance outside of certain circles.</p>
<p>&#8220;Any company that develops something like that will market it as aggressively as possible to recover their investment.&#8221;</p>
<p>Yes and no it depends on many things primary of which is the &#8220;sweet spot&#8221; on sales volume -v- worth to the customer. Part of the latter is &#8220;utillity&#8221;.</p>
<p>If I put five devices in one my production costs are only marginaly larger than that of producing the most expensive item on it&#8217;s own. However the utility to the customer is that they get five usefull devices in one for the price of say three seperate items. Thus you have the potential to make a significantly larger proffit.</p>
<p>We see this in the mobile phone market where a modern phone is,</p>
<p>Phone + media player + games console + internet browser + PDA + camera + video conferancing +&#8230; + conveniance.</p>
<p>All for the price of a basic phone + basic digital camera.</p>
<p>Have a think about what a memory card reading key pad, LCD and &#8220;USB on the go&#8221; hub device can do&#8230; irespective of being a mid range IME. And never never underate the utility of &#8220;conveniance&#8221; to a &#8220;mobile worker&#8221; cosumer.</p>
<p>With regards,</p>
<p>&#8220;Unless they design, test &amp; build it too cheap to be secure, it won&#8217;t be deniable.&#8221;</p>
<p>The point is not to deny that the unit has strong crypto features, it is simply to &#8220;hide in plain sight&#8221; by making that asspect just a small part of the devices utillity.</p>
<p>What is unknown to most people is that a simple phone with USB accessable Mass Storage Class ability can with only a relativly small software upgrade use the crypto functions on the SIM&#8230; It won&#8217;t be a quick IME but it&#8217;s all there apart from a few lines of code. And the market price on some of these phones is sub 150USD&#8230;</p>
<p>And the reason the phone manufactures don&#8217;t do it as standard well it&#8217;s the presure of phone service suppliers.</p>
<p>The phone service suppliers have an identity crisis occuring, competition and economic climate are forcing them down the same path as ISP&#8217;s in the UK (and probably other places). That is they are finding themselves clasified as &#8220;bulk service providers&#8221; which is a very very cost sensitive and thus almost proffitless position to be in when your buyers are &#8220;fickle home consumers&#8221; who can drop you with the blink of an eye.</p>
<p>The iPhone store model is what the phone service providers are all desperate salivating for. Where they (not Apple) take a 30% TAX on &#8220;must have apps&#8221; designed by others. It is as others have noted &#8220;a nice little earner&#8221; or &#8220;money for old rope&#8221;.</p>
<p>Google amongst others have recognised a &#8220;barrel&#8221; they can strap not just the phone service providers over but other third parties, at the same time as improving their market position against the third parties (Microsoft for instance).</p>
<p>So keep your eye on Android et al apps they might end up being a nasty shock to many &#8220;security product&#8221; suppliers quite soon ðŸ˜‰</p>
<p>Getting back to your point&#8217;s</p>
<p>&#8220;That&#8217;s my theory &amp; the field of spy gear &amp; success in compromising &#8220;encrypted&#8221; COTS thumb drives seem to support it.&#8221;</p>
<p>Is only true within it&#8217;s limited viewpoint. Exploiting utility and conveniance changes the viewpoint dramaticaly and makes your point false in that wider context.</p>
<p>With regards,</p>
<p>&#8220;Tremendous numbers of regular or professional attackers read up on things. They know what to look for. So, even if deniability doesn&#8217;t work, the security should be good enough to work.&#8221;</p>
<p>The &#8220;weasle words&#8221; are &#8220;should be good enough to work&#8221;. Specificaly &#8220;to work&#8221; is the viewpoint of the customer not the supplier. It is why we are seeing ludicrously insecure items sold as meeting Sarbines Oxley.</p>
<p>As pointed out by BF Skinner, under some view points &#8220;two passwords&#8221; is &#8220;two factor authentication&#8221;. And the<br />
security auditor just nodds it through with a tick in the checkbox (even if the two passwords are &#8220;1234&#8221; and &#8220;abcd&#8221; as a UK building society used on it&#8217;s cash machines for years&#8230;)</p>
<p>The advantage of adding more &#8220;utility and conveniance&#8221; is although the consumer price might be double or tripple the profit might be more than ten times, thus you can have a broad range of products which are effectivly all the same from the internal design point of view.</p>
<p>This has a strange &#8220;inventory&#8221; effect as seen in the car industry, lock industry and in semi-conductor suppliers such as Intel and AMD.</p>
<p>It encorages a single high end base design for the internal mechanics or electronics put in many products across a very wide value range. The only thing that realy changes is the &#8220;packaging  and marketing focus&#8221; and the cost to the consumer.</p>
<p>Which generaly means you get the base design designed for high end functionality and the cost amortised across the whole range. And thus considerably more highend features in lower spec lower cost devices (it&#8217;s why overclocking works so well).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132358">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132358">
						March 17, 2010 3:55 PM					</a>

				</p>

				<p>@ Clive</p>
<p>I&#8217;ll respond to that post later after work but was quickly posting regarding one statement&#8230;</p>
<p>&#8220;busy cooking and dicing an onion&#8221;</p>
<p>Does this mean they finally let you out of the hospital? If so, then congratulations on your escape! ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132359">

			<div class="comment by-gianluca-ghettini ">

				<p class="commentcredit">

					<span class="commenter">Gianluca Ghettini</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132359">
						March 17, 2010 6:38 PM					</a>

				</p>

				<p>@ Clive</p>
<p>&#8220;Does this mean they finally let you out of the hospital? If so, then congratulations on your escape! ;)&#8221;</p>
<p>I don&#8217;t know exactly the story, but I hope too!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132360">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132360">
						March 18, 2010 5:37 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Yes they have let me out on furlow because of my bodies good behaviour, but in reality surgery was cancelled due to equipment failure&#8230;</p>
<p>So I&#8217;ve been assigned (not so) light domestic duties by my Ex as apparently It&#8217;ll stop me being a &#8220;usless invalid&#8221; (I remember the stress being on the former not the latter). So I have the enforced pleasure of my son&#8217;s company, and he being 8 and some what hyper (even when he&#8217;s asleep) is ensuring that the hospital requirment of &#8220;rest and light excercise&#8221; is being sorely tested ðŸ˜‰</p>
<p>So this morning I&#8217;m venturing into the loft to get out the prototype robot&#8217;s I built some years ago and teach him some practical engineering skills.</p>
<p>However the after school club is attempting to teach him another cooking skill this afternoon. Apparently fruit kababs whatever they might be (sounds like a vegi assult on a manly institution to me ðŸ˜‰</p>
<p>@ Gianluca Ghettini,</p>
<p>&#8220;I don&#8217;t know exactly the story, but I hope too!&#8221;</p>
<p>I don&#8217;t either nor do the medical proffession but we like you hope too as well and the sooner the better for all concerned 8)</p>
<p>Put simply I&#8217;ve been somewhat hard on my body over the years including falling 300ft down a Scotish mountin side. Various physical activities like Rugby mountin climbing fell walking/running and bouncing of the front and sides of cars and lorries whilst cycling and other physicaly strenuous activities whilst wearing the green have aparently caught up with me. So I spend a good deal of time in pain of one form or another which stops me sleeping (I&#8217;ve had to stop tacking the pain killers for medical reasons).</p>
<p>However the pain has hiden some underlying issues that have been slowly sneaking up on me as well and it is these that are currently putting me in hospital one week in four.</p>
<p>But on top of that are the issues from a botched operation or three and the results of having had my head flying kicked into a metal pole when on my way to work one day giving a full fracture of the lower jaw on the point. Which the maxiofacial surgeon chearfully informed me was a first for him (apparently it&#8217;s normaly only seen on the rather abruptly deceased in cars etc).</p>
<p>The trouble is that they are minor problems by themselves thay conspire to fight each other one way or another. For instance PE&#8217;s and DVT&#8217;s (blood clots in lungs and extrematies which requires ingestion of rat poisson in substantial quantities) against intestinal bleeding which require the opposit treatment. Between these two alone I&#8217;ve been in hospital after three episodes of PE/DVT and four episodes of blood loss requiring blood transfusions or fluid recussitation since August. Then there is the three or four atypical bacterial attacks around a surgery site that mean a week in hospital for exotic IV anti-B&#8217;s. Oh and of course these medications react adversly with the rat poison and other medications I&#8217;m on as well as my problematical liver (apparently it&#8217;s enzime output says I&#8217;m a serious alcoholic but it&#8217;s physical apperance and the fact I hardly drink says otherwise, so they think it may be an effect caused by the cocktail of drugs I&#8217;m on, hence no more pain killers and sleeping tablets etc)</p>
<p>So the medical proffession are trying to find a sweet spot that will keep me out of their clutches, me I&#8217;m thinking of getting a &#8220;time share&#8221; on a hospital bed ðŸ˜‰</p>
<p>Anyway as various people keep telling me &#8220;while there&#8217;s life in the old dog&#8230;&#8221; there&#8217;s the oportunity for the medical proffession to play&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132361">

			<div class="comment by-jarda ">

				<p class="commentcredit">

					<span class="commenter">Jarda</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132361">
						March 21, 2010 12:49 PM					</a>

				</p>

				<p>I&#8217;d be rather interesting to know, if this  thing can&#8217;t be defeated by disconnecting one pin from the circuit, like we have seen already with some other supersecure flash drive which was, I think, also reported here long ago.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132362">

			<div class="comment by-yuhong-bao ">

				<p class="commentcredit">

					<span class="commenter">Yuhong Bao</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132362">
						April 6, 2010 9:53 PM					</a>

				</p>

				<p>&#8220;The White paper suggests it is just an Enable &#8220;lock-out&#8221; protection, probably implemented on a cheap flash based microcontroller like a PIC or 8051. &#8221;<br />
The one that posted the white paper confused the second version with the first version, which was indeed exactly what you describe (a Dutch researcher was able to bypass it just by hooking a resistor).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132363">

			<div class="comment by-yuhong-bao ">

				<p class="commentcredit">

					<span class="commenter">Yuhong Bao</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132363">
						April 7, 2010 1:53 AM					</a>

				</p>

				<p>Jarda: Yea, that is the entire point of the second version of the Padlock, to fix this flaw that existed in the first version by actually using hardware encryption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132364">

			<div class="comment by-shane-pearson ">

				<p class="commentcredit">

					<span class="commenter">Shane Pearson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132364">
						April 24, 2010 5:48 AM					</a>

				</p>

				<p>Bruce,</p>
<p>Corsair claims to generate a unique-per-device deterministic random number (presumably and hopefully securely stored within the control chip and not the flash) and also generates a non-deterministic random number when the PIN number is created (a session key), to pad out the full 256-bits required for the key (or XOR with the PIN, I can&#8217;t be sure yet).</p>
<p>So I wonder if this actually could be much more secure than it seems?</p>
<p>If the keys are securely stored within the control chip and can&#8217;t be accessed without the PIN or opening/microscope etc and no data goes to flash unencrypted, then this seems secure to me (assuming no mistakes with implementation).  No?</p>
<p>See the reply from Corsair at the bottom of this thread:</p>
<p><a href="http://forum.corsair.com/FORUMS/showthread.php?p=444988" rel="nofollow ugc">http://forum.corsair.com/FORUMS/showthread.php?p=444988</a></p>
<p>Shane</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132366">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132366">
						September 15, 2013 6:16 PM					</a>

				</p>

				<p>Since I first found out about this product from this blog entry, I thought I&#8217;d write a comment about it.</p>
<p>This review compares the Corsair Padlock 2 and Apricorn Aegis Secure Key USB drives. Both drives are 16Gb, and have a PIN pad.</p>
<p>First, a speed test, on a USB 2.0 port:<br />
2.73Gb of music files, write speed:<br />
Corsair Padlock 2 = 6.4Mb/sec<br />
Apricorn Aegis Secure Key = 3.8Mb/sec<br />
Sandisk Extreme USB 3.0 = 12.5Mb/sec</p>
<p>The Sandisk was used without encryption.</p>
<p>Now, to the security part.<br />
The PIN is not used as part of the encryption access for either drive.  How do I deduce this?  Because the PIN can be change independently of the data.  If the PIN were part of the actual encryption key, changing the PIN would wipe the drive.  The PIN is only used for enabling the USB connectivity.</p>
<p>Both drives claim AES 256-bit encryption, but only the Aegis is validated FIPS 140-2 Level 3.<br />
The Corsair has 5 numeric keys, and PIN length of 4 to 10 numbers.<br />
The Aegis has 10 numeric keys, and a PIN length of 7 to 15 numbers.<br />
The Corsair has a timeout of two minutes for every five wrong guesses.<br />
The Aegis <i>wipes the drive</i> after ten wrong guesses.<br />
The Corsair is not detected by Windows when it is locked.<br />
The Aegis is detected by Windows, but it is an unknown device.</p>
<p>From what I gather reading the owner&#8217;s manuals, both of them create their keys when the drive is wiped.  Neither of them use the PIN as a basis for the internal keys.</p>
<p>How secure are these?  Good question if you are up against the NSA or similar.  I&#8217;m <i>guessing</i> that the keys are stored in the encryption chip, and the keypad also is wired to the encryption chip.  This will definitely foil the adversary who can&#8217;t or won&#8217;t bother with tearing the USB drive apart, milling the chips open, and deducing the data by reading the chip with a microscope.  The Corsair gives you over 12,000,000 potential combinations, so maybe that&#8217;s good enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-132367">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter">Adam</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132367">
						January 8, 2014 2:49 PM					</a>

				</p>

				<p>And then there is this, which I discovered (along with this blog post) when researching which encrypted USB drive to purchase:</p>
<p><a href="http://veerboot.tweakblogs.net/blog/561/corsair-padlock-hacking.html" rel="nofollow ugc">http://veerboot.tweakblogs.net/blog/561/corsair-padlock-hacking.html</a></p>
<p>So far the only one I can find that looks to be worth a damn is the Apricorn Aegis Secure Key</p>
<p><a href="http://www.apricorn.com/products/hardware-encrypted-drives/aegis-secure-key.html" rel="nofollow ugc">http://www.apricorn.com/products/hardware-encrypted-drives/aegis-secure-key.html</a></p>
<p>which is FIPS 140-2 compliant.  Not sure how much credence to give that though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-132368">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/#comment-132368">
						March 6, 2015 5:03 AM					</a>

				</p>

				<p>With all these claims and counter-claims, and I have no doubt that some of you people have serious knowledge about all this&#8230;</p>
<p>BUT&#8230;</p>
<p>Has any of you managed to hack a Corsair&#8217;s Padlock 2, or do you have at least prove that it has been done?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/03/crypto_implemen.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/03/crypto_implemen.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F03%2Fcrypto_implemen.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/03/crypto_implemen.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3275' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/03/tom_engelhardt.html" rel="prev">â† Tom Engelhardt on Fear of Terrorism</a>		<a href="https://www.schneier.com/blog/archives/2010/03/comprehensive_n.html" rel="next">Comprehensive National Cybersecurity Initiative â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
