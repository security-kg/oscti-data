<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Bypassing Two-Factor Authentication - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Bypassing Two-Factor Authentication Comments Feed" href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4606" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4606' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F12%2Fbypassing_two-f.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F12%2Fbypassing_two-f.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4606 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4606" class="post-4606 post type-post status-publish format-standard hentry category-uncategorized tag-banking tag-malware tag-two-factor-authentication">

	<div class="article">

		<h2 class="entry">Bypassing Two-Factor Authentication</h2>
		<p>Yet another way two-factor authentication has been <a href="http://www.techspot.com/news/51037-trojan-bypasses-two-factor-authentication-steals-465-million.html">bypassed</a>:</p>
<blockquote><p>For a user to fall prey to Eurograbber, he or she must first be using a computer infected with the trojan. This was typically done by luring the user onto a malicious web page via a round of unfortunate web surfing or email phishing attempts. Once infected, the trojan would monitor that computer&#8217;s web browser for banking sessions. When a user visited a banking site, Eurograbber would inject JavaScript and HTML markup into their browser, prompting the user for their phone number under the guise of a &#8220;banking software security upgrade&#8221;. This is also the key to Eurograbber&#8217;s ability to bypass two-factor authentication.</p></blockquote>
<p>It&#8217;s amazing that I wrote about this <a href="https://www.schneier.com/blog/archives/2005/03/the_failure_of.html">almost eight years ago</a>.  <a href="https://www.schneier.com/blog/archives/2012/02/the_failure_of_2.html">Here&#8217;s</a> another example of the same sort of failure.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/banking/" rel="tag">banking</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/two-factor-authentication/" rel="tag">two-factor authentication</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html" rel="bookmark">Posted on December 10, 2012 at 1:04 PM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html#comments">40 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html" data-title="Bypassing Two-Factor Authentication" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-189085">

			<div class="comment by-nick ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://it.nicksimmonds.com' rel='external nofollow ugc' class='url'>Nick</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189085">
						December 10, 2012 1:22 PM					</a>

				</p>

				<p>This would also be a good way to grab phone access even in the absence of two-factor authentication, for some other purpose.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189086">

			<div class="comment by-otto ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ottopress.com/' rel='external nofollow ugc' class='url'>Otto</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189086">
						December 10, 2012 1:47 PM					</a>

				</p>

				<p>So, in order for this attack to succeed, the victims had to:</p>
<p>a) fall prey to a trojan link via email spam or similar,</p>
<p>b) visit a bank account site supported by the trojan (presumably it worked with more than one particular bank),</p>
<p>c) fall for the &#8220;give us your phone number for a security update&#8221; message, and</p>
<p>d) install the trojan onto their phone allowing their 2-factor to be compromised as well.</p>
<p>Okay, I understand that this is a legitimate problem, and that clearly many people (30k-ish) fell prey to this attack&#8230; But really, what kind of level of security hoops do you have to put in front of people before they can&#8217;t do this anymore? I mean, let&#8217;s be frank here, the security failed here on multiple levels specifically because the victims believed what was presented to them at every step of the path. If at any point they had stopped and questioned the sequence of events, then they probably would have broken the chain.</p>
<p>How can you teach a healthy paranoia to somebody to prevent this sort of thing?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189087">

			<div class="comment by-bill ">

				<p class="commentcredit">

					<span class="commenter">Bill</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189087">
						December 10, 2012 1:57 PM					</a>

				</p>

				<p>Otto is right on the money. People will do stupid things if you ask them stupid questions. This kind of two factor authentication was nearly fool proof when phones were dumb and couldn&#8217;t install a third party app that could intercept texts.</p>
<p>But our phones are smart now, allowing people to make stupid security decisions. So how do we use the intelligence built into the phone to prevent people from doing stupid things? Maybe instead of relying on text messages it should be a push notification that brings up a bank specific app that does some sophisticated secure authentication with the bank and only allows a user to perform the verification. Just about all of the mobile platforms allow enough sandboxing to make this viable, i think.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189088">

			<div class="comment by-rh ">

				<p class="commentcredit">

					<span class="commenter">RH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189088">
						December 10, 2012 2:28 PM					</a>

				</p>

				<p>My solution is still simple: I have a $50 laptop running linux which is only turned on for banking transactions, and the logged off.  Now the computer is even harder to break into than the two-factor auth!  This makes two-factor auth into security-in-depth, rather than the single line of defense.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189089">

			<div class="comment by-sam-j ">

				<p class="commentcredit">

					<span class="commenter">Sam J</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189089">
						December 10, 2012 3:06 PM					</a>

				</p>

				<p>@RH</p>
<p>Why buy a laptop? As long as everything is being done over the internet (i.e., you don&#8217;t need storage space), booting Linux off of a live USB or CD would work just as well.</p>
<p><a href="http://distrowatch.com/table.php?distribution=lps" rel="nofollow ugc">LPS</a> in particular is perfect for that. It&#8217;s specially designed by the Air Force to be used by personnel viewing classified documents on their home computers, and as such has numerous protections against any data being left behind on the machine it&#8217;s being run through. It also has a handy AES encryption tool that is quite intuitive.</p>
<p>Only downside is they set it up with a theme that makes it look like XP, but, oh well&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189091">

			<div class="comment by-itgrrl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://itgrrl.com/' rel='external nofollow ugc' class='url'>itgrrl</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189091">
						December 10, 2012 4:20 PM					</a>

				</p>

				<p>@Sam: From a user-adoption, training cost-reduction, and support cost-reduction perspective, setting LPS to look like XP is exactly the right decision.</p>
<p>When I used to set up cheap/free Linux-based systems for my had-only-ever-used-Windows-before friends, I would skin it to look as much like XP as possible, including setting up a &#8220;My Documents&#8221; and &#8220;My Pictures&#8221; folder, etc. They weren&#8217;t interested in &#8216;learning&#8217; Linux, and my goal was to make them as self-sufficient as possible in the shortest possible time (to reduce my support burder). This wasn&#8217;t an exercise in bringing about the year of Linux on the desktop (hah!), but rather one of providing friends without a computer one at very low/no cost.^</p>
<p>Similarly for the Air Force, I expect the objective is to create a suitably secure environment for their users, without having to re-train them (much).</p>
<p>(I&#8217;m sure you actually know all that of course, but I guess I&#8217;m feeling chatty today.)</p>
<p>^ Sadly, after putting in a fair bit of effort to provide such a system to one friend, she then went out and bought a Windows system because the one I&#8217;d provided for free couldn&#8217;t run her Windows games&#8230; Sometimes you can&#8217;t win.   ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189092">

			<div class="comment by-itgrrl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://itgrrl.com/' rel='external nofollow ugc' class='url'>itgrrl</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189092">
						December 10, 2012 4:24 PM					</a>

				</p>

				<p>@Sam: I had a look at the DistroWatch link you included for LPS because I wanted to have a play &#8211; it links to <a href="http://www.spi.dod.mil/lipose.htm" rel="nofollow ugc">http://www.spi.dod.mil/lipose.htm</a> which gives a 403. Walking the tree to <a href="http://www.spi.dod.mil/" rel="nofollow ugc">http://www.spi.dod.mil/</a> similiarly gives a 403. Do you know if this is a glitch or if access is restricted only to those connecting from the US military IP ranges?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189093">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189093">
						December 10, 2012 4:49 PM					</a>

				</p>

				<p>@ Otto, Bill,</p>
<p><i>But really, what kind of level of security hoops do you have to put in front of people before they can&#8217;t do this anymore?</i></p>
<p>Pick a number between X and Infinity and keep revising upwards.</p>
<p>The problem is the system put in place by the bank is broken in a number of ways. Some of which alow the user discretion and thus fails to ensure a transaction is properly authorised.</p>
<p>Remove the discretion and use the authentication properly then this problem won&#8217;t occure.</p>
<p>Briefly as I&#8217;ve indicated on this and other blogs many timess before (going back for more years than I care to remember), the two things that are required to be done are,</p>
<p>1, Properly two way authenticate the transaction, user to bank, bank to user, user back to bank with sufficient entropy that for practical purposes the authentication can only be valid.</p>
<p>2, Force the user into the authentication loop such that the transaction has to actuall go through the user to be authenticated.</p>
<p>Whilst there are known solutions to the first requirment (shared secret) it requires the use of an immutable token to get sufficient entropy to ensure the integrity of the transaction authentication.</p>
<p>The second requirment is currently an open problem due to human failings and this is likely to remain open for some time.</p>
<p>The overal description of the process is,</p>
<p>1, The user types the transaction into the token that uses the shared secret to display a unique transaction request string that cannot be altered or replayed.</p>
<p>2, The user types the request string into the browser and it gets sent to the bank.</p>
<p>3, The bank uses the shared secret to decode the transaction request and uses the information along with a unique acceptance code to produce a unique transaction acknowledgment string that cannot be altered or replayed, and sends this back to the users web browser.</p>
<p>4, The user types the acknowledgment string into the token, the token uses the shared secret to decode the string and recover the information returned by the bank and compare it to the original transaction.</p>
<p>At this point the token has acceptable proof that the Bank knows the transaction details correctly, and importantly it was only the bank that could have generated the acceptance code (which is only the case as long as the shared secret is still a secret and the token has not been infected with malware etc).</p>
<p>5, The token displays the transaction details from the bank and asks the user to confirm the transaction. If the user does the token uses the shared secret, the transaction details and the acceptance code to generate a unique transaction compleation string which cannot be altered or replayed.</p>
<p>6, The user types the displayed compleation string into the browser interface and sends it to the Bank.</p>
<p>7, The bank uses the shared secret to decode the compleation string it checks the transaction details and the acceptance code, if and only if they are correct and have been received in a reasonable time frame does the bank process the transaction.</p>
<p>From this it can be seen that two things are important,</p>
<p>A, The shared secret remains a secret and cannot be accessed directly in any way by the user or any other entity ie it remains in a tamper proof modual in the users token and in the bank system. It can only be accessed indirectly in that messages are submited to the tamper proof module that in effect encodes and signs the message and outputs it as a string.</p>
<p>B, The token is for practical purposes immutable and is never directly connected to anything other than the user via the keyboard and display so it is not possible for a malware shim to be loaded onto it.</p>
<p>The problem with this system is the size of the strings sent back and forth that the user has to be able to type in perfectly without either a mistake or frustration&#8230;</p>
<p>And that is an almost insurmountable problem because the size of these strings are likely to be a minimum of 32chars each and may be considerably more than that.</p>
<p>Which is going to make the system impracticable at best to use. Hlwever anything less than this is going to be vulnerable to attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189094">

			<div class="comment by-somebody ">

				<p class="commentcredit">

					<span class="commenter">somebody</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189094">
						December 10, 2012 4:51 PM					</a>

				</p>

				<p>@otto and Bill<br />
Phone numbers are not secret.  Smart phones are not secure, heck the entire phone system is not secure.  Businesses are trying to build security on sand and then blaming the user.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189095">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">chris</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189095">
						December 10, 2012 5:06 PM					</a>

				</p>

				<p>Sam J wrote: LPS in particular is perfect for that. It&#8217;s specially designed by the Air Force to be used by personnel viewing classified documents on their home computers</p>
<p>strong skepticism.  in the USA, at least, it&#8217;s a severe security violation to have classified material at home or on a computer not certified for that purpose.  i highly doubt that AF would develop software to facilitate security violations.</p>
<p>tell it to the marines &#8211; the old sailors won&#8217;t believe you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189096">

			<div class="comment by-sam-j ">

				<p class="commentcredit">

					<span class="commenter">Sam J</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189096">
						December 10, 2012 5:16 PM					</a>

				</p>

				<p>@ittgrrl &#8211; That&#8217;s quite strange, the link is still up for me. I&#8217;m not in the military, just on a normal network. I did as well know that familiarity was the reason for LPS&#8217; design. Even still though, it still kind of drags. Seeing Tux in the place the Windows logo usually is on the Start menu just makes me want to bang my face against the desk (I&#8217;m a Slacker, to give some background to my feelings regarding the &#8216;purity&#8217; of Linux).</p>
<p>Although LPS is specially designed to leave no trace, any other lightweight linux distro, Puppy Linux, Tiny Core, Damn Small Linux, or Tails (which uses Tor by default) would all do the trick as well as RH&#8217;s second laptop trick (assuming he&#8217;s running Ubuntu, Fedora, Debian, Slack, Arch, etc).</p>
<p>@chris &#8211; That&#8217;s just my understanding of why it was created based on some discussions I found about it online, not directly from the military itself. My assumption is that there is some sort of threshold for the classification level of the material. It&#8217;s quite possible people were pulling it out of their asses though, as an explanation for why it exists. It did make sense to me, as well, as I can&#8217;t figure out why else they would have created it (except as a programming experiment, I guess).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189097">

			<div class="comment by-johnston ">

				<p class="commentcredit">

					<span class="commenter">Johnston</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189097">
						December 10, 2012 5:21 PM					</a>

				</p>

				<p>Non-technical users can be protected from all manner of attack, past present and future, simply by using NoScript or something similar.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189098">

			<div class="comment by-student ">

				<p class="commentcredit">

					<span class="commenter">student</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189098">
						December 10, 2012 5:37 PM					</a>

				</p>

				<p>@ Sam, @ittgrrl:<br />
I had no problem accessing and downloading the iso.</p>
<p>Ten days ago I posted questions about the attack surface for live CD&#8217;s on the Friday night squid fry.  No greybeards answered; here are the questions again.</p>
<blockquote><p>What attack surface does a mini XP live disk run have for access from one USB to another for propagating a trojan/dropper?</p>
<p>Same question for a linux live disk?</p>
<p>Same question for a Windows PE live disk?</p>
<p>Same questions for a live USB run for any of the above?</p>
<p>Thanks.</p></blockquote>
<p>Here&#8217;s what the .mil site has to say:</p>
<blockquote><p>Any malware that might infect a computer can only run within that session. A user can improve security by rebooting between sessions, or when about to undertake a sensitive transaction. For example, boot LPS immediately before performing any online banking transactions. LPS should also be rebooted immediately after visiting any risky web sites, or when the user has reason to suspect malware might have been loaded. In any event, rebooting when idle is an effective strategy to ensure a clean computing session. LPS is updated on a regular basis (at least quarterly patch and maintenance releases). Update to the latest versions to have the latest protection.</p></blockquote>
<p>So the answer is that depending on what you&#8217;re doing it is possible to infect the memory space and thereby propagate the virus/trojan to another USB stick through the memory space.  Hence, one shouldn&#8217;t think that a live CD is completely immune to compromise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189099">

			<div class="comment by-godel ">

				<p class="commentcredit">

					<span class="commenter">Godel</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189099">
						December 10, 2012 5:56 PM					</a>

				</p>

				<p>@itgrrl</p>
<p><a href="http://www.spi.dod.mil/lipose.htm" rel="nofollow ugc">http://www.spi.dod.mil/lipose.htm</a> works for me and I&#8217;m not even in the US.</p>
<p>181MB download for the basic system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189100">

			<div class="comment by-ben ">

				<p class="commentcredit">

					<span class="commenter">Ben</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189100">
						December 10, 2012 6:29 PM					</a>

				</p>

				<p>If you want to secure the system well, then I think you have to dictate the hardware and software that&#8217;s allowed to run at least part of the authentication.</p>
<p>I&#8217;d run it like this:<br />
You go through your bank as normal with whatever the best security that can reasonably be managed is. Your bank receives your request to do something with your money and sends an encrypted copy of that request back to the their secure device that they&#8217;ve given you in branch, where it gets decoded. You then use that device to authorise the transaction. And that device does one thing, accepts a known form of input, in a known way on a restricted platform and refuses to run anything else.</p>
<p>That&#8217;s the only way I can think of to do it and be reasonably sure.</p>
<p>Otherwise, if the user&#8217;s end is compromised, it&#8217;s game over. One time codes won&#8217;t do it. You might think you&#8217;re typing what you wants into the browser, and you might think it&#8217;s telling you the right answers back, but your stuff never went to the bank, it never even left your machine, the attacker just stripped out the authentication &#8211; whatever it is you&#8217;re typing in as the one time unique transaction code &#8211; and added his stuff to it. The attacker can show you whatever he likes coming back the other way, he&#8217;s not actually decoding it for you. What you&#8217;re seeing is just smoke and mirrors.</p>
<p>You could defeat man in the middle attacks easily enough, if you assume that the user&#8217;s end is secure and the bank&#8217;s end is secure. You can have shared secrets to encrypt things, and the attacker can&#8217;t meaningfully alter the communication without knowing them. The card reader that goes with my account is one example of a store of such potential shared secrets. I have to put them in when I want to use the money in my account, they encrypt the information, it goes to whoever it goes to. If you used them as keys for strong encryption, they&#8217;d be useless to anyone who didn&#8217;t know the secret.</p>
<p>Assuming of course that the computer this end is secure. That&#8217;s the kicker for me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189101">

			<div class="comment by-pat ">

				<p class="commentcredit">

					<span class="commenter">Pat</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189101">
						December 10, 2012 7:44 PM					</a>

				</p>

				<p>&#8220;It&#8217;s amazing that I wrote about this almost eight years ago.&#8221;</p>
<p>It&#8217;s amazing that it took someone eight years to follow your advice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189102">

			<div class="comment by-tsgt ">

				<p class="commentcredit">

					<span class="commenter">tsgt</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189102">
						December 10, 2012 11:07 PM					</a>

				</p>

				<p>ITgrrl&#8230; That site is reachable from some addresses but blocked for others.<br />
<a href="http://web.archive.org/web/20110717142746/http://spi.dod.mil/lipose.htm" rel="nofollow ugc">http://web.archive.org/web/20110717142746/http://spi.dod.mil/lipose.htm</a> is OK, but<br />
<a href="http://www.spi.dod.mil.nyud.net/lipose.htm" rel="nofollow ugc">http://www.spi.dod.mil.nyud.net/lipose.htm</a> is blocked.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189103">

			<div class="comment by-vijay ">

				<p class="commentcredit">

					<span class="commenter">Vijay</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189103">
						December 10, 2012 11:17 PM					</a>

				</p>

				<p>Yup &#8230;.  very simple Two-Factor Authentication is only as good as the first line of defense &#8230;. once that is compromised .. pretty easy to hoodwick all other lines of defenses &#8230;<br />
As Bruce keeps advising security is all about adequate protection, detection and reaction .. all these 3 put together &#8230; As Otto inidicated with the advent of smart phones and democratization of APIs .. its now even more vulnerable &#8230;&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189104">

			<div class="comment by-anonymous-coward ">

				<p class="commentcredit">

					<span class="commenter">anonymous coward</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189104">
						December 11, 2012 1:56 AM					</a>

				</p>

				<p>We can continue about stupid users for a long time, but if doctors would ask &#8220;all your problems will disappear with a lobotomy, proceed?&#8221; how many &#8220;yes&#8221; would you get?<br />
We still have not learned to formulate questions or propose systems most users can understand.<br />
Our web page shows some figures we need to type on a token, then our token shows some figures we need to type on the computer, done. Money gone. How much? to whom?<br />
There is only a perceived relation between what we type on a keyboard, what is shown on the screen and what is send over the line. The software is one big MitM doing something.<br />
We can solve it but not by fixing people I am afraid.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189105">

			<div class="comment by-richard-birenheide ">

				<p class="commentcredit">

					<span class="commenter">Richard Birenheide</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189105">
						December 11, 2012 2:20 AM					</a>

				</p>

				<p>Bank policies worsen this. When two-factor authentication was introduced at my bank, one had the choice for SMS or a (cheap) device. I am able to receive SMS to my landline phone (which is a pretty dumb phone). Nevertheless, the bank rejected using the landline for this and insisted for using a mobile number. I opted for the device then (in addition to using a Linux Live USB stick).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189106">

			<div class="comment by-steve-jones ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.appeos.com' rel='external nofollow ugc' class='url'>Steve Jones</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189106">
						December 11, 2012 4:00 AM					</a>

				</p>

				<p>I believe there was a similar case recently with HSBC accounts where the trojan adds &#8220;training&#8221; options to the online banking website. It looks just like part of the site, so all the two-factor authentication is useless.</p>
<p>I mentioned it to someone in the bank when they were boasting about how secure their new code generator dongles were. I said it decreased security as it gave a false sense of security, making the customer less likely to be sceptical about the new &#8220;training&#8221; options.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189107">

			<div class="comment by-matt ">

				<p class="commentcredit">

					<span class="commenter">matt</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189107">
						December 11, 2012 4:34 AM					</a>

				</p>

				<p>Live CD is the easiest way for free but its secure only if your hardware is not programmable &#8230; because malware can infect BIOS or VGA so even if you change your hard drive or use Live CD still malware works (this attack is not common because its much easier to trick people or hack them). as we saw before tokens do not help noobs who are victim of social engineering (problem of security guys is that they see problem from their own skill and think it works, put yourself as a old fat woman who even get scammed by facebook links.. if you understand this then don&#8217;t use token as most of american banks. this ACH which take 3 days is much more effective to prevent fraud, European banks who have instant transfer with token security are paradise for black hats)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189108">

			<div class="comment by-peter-a-not-the-usual-one ">

				<p class="commentcredit">

					<span class="commenter">Peter A. (not the usual one))</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189108">
						December 11, 2012 5:14 AM					</a>

				</p>

				<p>Clive,</p>
<p>Have you thought about how much random text will be required for each transaction?  I suspect bank usability teams would scream in protest at making customers copy 50+ random chars each time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189109">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter">Adam</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189109">
						December 11, 2012 5:57 AM					</a>

				</p>

				<p>My bank (Rabo) would be pretty immune to this.</p>
<p>There is a 6 digit pin to log into a bank account which thieves might be able to exploit but to actually do anything inside the account requires answering a secondary challenge. When I want to transfer money, even between internal accounts, the site challenges me with a code and requires I punch it into my device and receive an 8 digit response and type that into the site.</p>
<p>So even if I were unfortunate enough to be running a trojan they&#8217;d get to look at my bank account (possibly assuming the site doesn&#8217;t vet suspicious IP activity) but would be limited in what they could do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189110">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189110">
						December 11, 2012 11:01 AM					</a>

				</p>

				<p>@ Peter A. (not the usual one),</p>
<p><i>Have you thought about how much random text will be required for each transaction? I suspect bank usability teams would scream in protest at making customers copy 50+ random chars each time</i></p>
<p>Yes which is why I mentioned it as an (insurmountable problem).</p>
<p>I have in the past thought of various ways to reduce it but each time the attackers come up with a new way (for another attack) that could provide an attack against a shortend string.</p>
<p>For instance I thought about using some kind of shortish checksum, which by using Capatchers would make automated attacks much more difficult&#8230; However within a year or so it became clear attackers were not using automated attacks against capatchers but paid next to nothing computer users in places like China, to post spam to blogs etc&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189111">

			<div class="comment by-firefox ">

				<p class="commentcredit">

					<span class="commenter">Firefox</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189111">
						December 11, 2012 11:16 AM					</a>

				</p>

				<p>Anybody wonder whether the LPS distro includes something that logs your activity to NSA/DIA/MI/etc.?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189112">

			<div class="comment by-alexander-churanov ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://alexanderchuranov.com/' rel='external nofollow ugc' class='url'>Alexander Churanov</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189112">
						December 11, 2012 11:31 AM					</a>

				</p>

				<p>Very strange. I&#8217;m in Russia and my bank requires entering a one-time password for each transaction &#8211; this is second factor. One-time passwords are printed on a scratch card, I get the card directly in the bank office.</p>
<p>Why use phones at all? Is it a legacy authentication method?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189113">

			<div class="comment by-jonathan-thornburg ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Thornburg</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189113">
						December 11, 2012 12:39 PM					</a>

				</p>

				<p>@Alexander Churanov (and others)<br />
A similar one-time-password-for-each-transaction is used by many German banks.  Alas, there are already trojans in the wild which successfully attack this scheme.  The problem is that if the PC is trojaned, then when you one-time-password-authenticate a transaction, it may actually be a very different transaction than the one you expect.  That is, you think you&#8217;re one-time-password-authenticating &#8220;transfer $rent to $landlord&#8221; but the trojan in the browser has invisibly-to-you rewritten the transaction to become &#8220;transfer $rent to $crook&#8221;.</p>
<p>The only way I know of around this problem, is to cryptographically bind the transaction details to the authentication&#8230; which requires a SECURE outboard device to do the crypto.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189114">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189114">
						December 11, 2012 2:24 PM					</a>

				</p>

				<p>@ Firefox,</p>
<p><i>Anybody wonder whether the LPS distro includes something that logs your activity to NSA/DIA/MI/ etc.</i></p>
<p>It does not need to.</p>
<p>All it needs to do is have some kind of recognizable signature within it&#8217;s expected traffic.</p>
<p>We already know the NSA is in progress to &#8220;Hoover up&#8221; all the Internet packets within what the NSA consider ther purview. Thus all they realy need is some marker used to identify the traffic type&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189115">

			<div class="comment by-rh ">

				<p class="commentcredit">

					<span class="commenter">RH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189115">
						December 11, 2012 5:55 PM					</a>

				</p>

				<p>@Clive</p>
<p>I think one can boil the problem down to much simpler (though the full robust path you describe is nice): Secure transactions require a secure computing device.  In your system, it is an &#8220;immutable token,&#8221; but it can be anything.</p>
<p>Boiling down your transaction yields:<br />
&#8211; The bank must generate a 1 time transaction, which it will harden against replay attacks (separate from the authentication method)<br />
&#8211; Some method to transfer that 1 time transaction to the secure computing device (your method was having the user type it in)<br />
&#8211; Some way of viewing the transfer on a secure display on the secure computing device (your method did this as part of typing in the transaction)<br />
&#8211; The secure computing device signs the transaction using any method desired<br />
&#8211; The secure computing device transmits the signature to the insecure medium (in your case, by having the user type it in)</p>
<p>I find the most undervalued part of the whole process is the secure display.  The only way to truly stop man in the middle attacks is to be able to trust the device you&#8217;re using to inspect the transaction.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189116">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189116">
						December 12, 2012 2:37 AM					</a>

				</p>

				<p>@ RH,</p>
<p><i>Secure transactions require a secure computing device. In your system, it is an &#8220;immutable token,&#8221; but it can be anything</i></p>
<p>There is a subtle problem with &#8220;immutable token&#8221; that needs to be addressed (and no I did not go into it this time around explaining it, so here we go ðŸ˜‰</p>
<p>Immutable tokens are a theoretical device which in practice just don&#8217;t get made in a standard low cost manufacturing dessign. And further for such a device to be even close to &#8220;secure&#8221; they have to be bug and backdoor free as well&#8230;</p>
<p>To make something immutable, bug and backdoor free and suitable for low cost production is a tough bordering on impossible problem&#8230;</p>
<p>However let us assume the device does not have a backdoor but might have a bug. Due to testing and some formal methods we know the device will work correctly for correct input and that to behave incorrectly it needs incorrect input in the form of malware.</p>
<p>Thus provided we control the input to the device to correct input only it will suffice for the task it is designed for.</p>
<p>We can do this by making the device only communicate to the outside world through the user, and make the user innitiate the transaction through the device.</p>
<p>Provided the user can tell the difference between correct input and malware then we can negate the device bug issue by moving it to the user recognising incorrect input.</p>
<p>There is of course a problem with this over and above the user typing in a lot of information, which is the information has to be meaningfull to the user so they can differentiate it from potential malware. Which has the downside of making the communications process longer (but probably less error prone).</p>
<p>All in all the &#8220;not in person&#8221; transaction problem is a difficult one and involves all sorts of tradeoffs to move it from theoretical to practical. And everywhere you perform a trade off you potentialy open a point of attack.</p>
<p>It quickly gets to the point where you get into a guessing game of &#8220;security margins&#8221; where, &#8220;You know there is an actual or potential risk but you view it as acceptable within current knowledge / technology available to you.&#8221; (think size of DES key as an example). You are in effect placing a bet against the future/unknown knowledge which is perhaps not a good idea as the attackers are likely to be better at finding bugs etc as they have future time on their side, whereas you don&#8217;t with production deadlines.</p>
<p>As far as I&#8217;m aware I was the first person to publicaly propose using SMS as a side channel to give secure authentication back in the 1990&#8217;s, but indicated I thought it impractical due to &#8220;secondary service&#8221; timeliness issues. Since then a lot of things have changed and as I indicated above with capatchers in ways I would not have guessed at because the idea had not (as far as I&#8217;m aware) even been thought of at the time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189117">

			<div class="comment by-patrick-g ">

				<p class="commentcredit">

					<span class="commenter">Patrick G.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189117">
						December 12, 2012 10:23 AM					</a>

				</p>

				<p>SMS-TAN systems were introduced after the old (indexed) TAN systems were deemed too easy to exploit even without any user interaction (drive-by infection, man-in-the-middle attacks etc.)</p>
<p>The fix for generic (i)TAN cards was that SMS-TAN systems don&#8217;t just give a code but show transaction details and amount so you can check the code is used for the transaction you desired.</p>
<p>Sure it won&#8217;t help if you give them full access to your Smartphone by following a series of unclever actions, but let&#8217;s be serious, if they own your Smartphone, E-Mail and your home PC there is no end to how they could screw you&#8230;</p>
<p>As to alternatives with old-style &#8220;dumbphones&#8221; and special ReadOnly-Linux-PCs or ROM-Distros: never going to happen for the majority of people. Period. They would rather go to the Bank counter &#8220;per pedes&#8221; to make a transaction&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189118">

			<div class="comment by-brazzy ">

				<p class="commentcredit">

					<span class="commenter">brazzy</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189118">
						December 12, 2012 3:17 PM					</a>

				</p>

				<p>@Adam:</p>
<p>Sorry to burst your bubble, but that method offers almost no additional security when your computer is compromised, as the malware can do a man-in-the-middle attack and when you next want to transfer money between your accounts, you&#8217;re actually confirming via your device a transaction that moves everything you own to the Ukraine while your browser shows you a perfectly innocent internal transaction.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189119">

			<div class="comment by-otto ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ottopress.com/' rel='external nofollow ugc' class='url'>Otto</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189119">
						December 13, 2012 3:23 PM					</a>

				</p>

				<p>To be fair about it though, people don&#8217;t understand 2-factor authentication anyway, so it may be a case of they don&#8217;t know what the expected path to be taken is, and thus cannot recognize when they have deviated from it.</p>
<p>Every time I&#8217;ve tried to explain how Google Authenticator works (I use it for my gmail account) to somebody, at some point I&#8217;m invariably asked &#8220;so, what happens when your phone can&#8217;t connect to the internet?&#8221; They assume that there&#8217;s some communication between the phone and Google to do the authentication, when there is not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189120">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189120">
						December 16, 2012 1:45 AM					</a>

				</p>

				<p>Honestly, once there&#8217;s malware running on the user&#8217;s OS, all bets are off. 2fa is red-herring.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189121">

			<div class="comment by-jb ">

				<p class="commentcredit">

					<span class="commenter">JB</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189121">
						December 17, 2012 7:54 AM					</a>

				</p>

				<p>In my opinion part of the problem is that the users are now left on their own. Two decades ago you couldn&#8217;t do much bank business without interaction with bank people. Now normally you can&#8217;t even reach them when you want to. It&#8217;s all online, it&#8217;s all automatic &#8230; and cheap of course. So when you see that message there&#8217;s no easy way to just call the bank and ask &#8230; Of course if there were a phone number displayed on the webpage that number would be faked too :-).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189122">

			<div class="comment by-mce ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cleverandsmart.cz' rel='external nofollow ugc' class='url'>MCE</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189122">
						December 19, 2012 11:22 AM					</a>

				</p>

				<p>It is not necessary to generate and rewrite 50+ random characters. Keep in mind that such an OTP is valid only for limited amount of time and just for one transaction, if HOTP is used, you can retype 9 random characters as well.</p>
<p>As of the transaction details (target account number, amount and currency), you need not to retype them into calculator, there are many solutions how to transfer them from the computer screen to the calculator. One solution I described <a href="http://www.cleverandsmart.cz/autorizace-transakce-v-internetovem-bankovnictvi-jednorazovym-heslem/" rel="nofollow ugc">here</a> one year ago. (Itâ€™s in Czech, sorry, but you can use Google translator, if you are interested).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189123">

			<div class="comment by-a-country-farmer ">

				<p class="commentcredit">

					<span class="commenter">A Country Farmer</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189123">
						December 20, 2012 11:51 AM					</a>

				</p>

				<p>What&#8217;s the solution then, or closest approximation thereof?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189124">

			<div class="comment by-fjf ">

				<p class="commentcredit">

					<span class="commenter">fjf</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189124">
						January 1, 2013 3:55 PM					</a>

				</p>

				<p>In Germany, many bank customers use &#8220;SmartTAN optic&#8221;. The secure(1), immutable(2) token is a generic TAN generator with an individual chip card.</p>
<p>After logging in to the bank site with a password (PIN) you can see your data. To make a transfer, you enter the data (recipient, amount, etc.) on the web site. It then generates a flickering code which is read by the TAN generator via optical sensors from the screen. It shows the data on a small display and computes a 6-digit TAN from it using the secret on the chip card. The user types this number into the web site form and submits it to the bank which can verify the TAN. (More details on <a href="http://de.wikipedia.org/wiki/Transaktionsnummer#chipTAN_comfort.2FSmartTAN_optic_.28Flickering.29" rel="nofollow ugc">Wikipedia</a>; the English version is not so detailed, but you may be able to translate the German version or at least see some pictures.)</p>
<p>An attacker who controls the victims&#8217;s computer can read their data, but if they try to modify the transaction details, the data displayed on the TAN generator won&#8217;t match and the customer will notice (if they pay attention, otherwise it&#8217;s all a useless endeavour anyway).</p>
<p>After (usually) 3 failed attempts the account is locked. So the TAN does not have to be excessively long and uncomfortable to use (6-digits mean a 3/1000000 chance for a guessing attack; much better than the 4-digit TANs used on ATMs here).</p>
<p>(1) Of course, an attacker could attempt to subvert either one in production, transport or at the customer&#8217;s site, as by breaking in. These are not really attacks against electronic banking, more like physical attacks and the usual security mechanisms (secure transport, secured storage etc.) would apply.</p>
<p>(2) The only input to the TAN generator (apart from a few buttons to basically start the procedure) are the chip card and the optical code. An attacker could try to subvert the code in order to infect the device with malware. However, it&#8217;s a rather simple device with limited function, and as a programmer myself I do think it&#8217;s possible to write such firmware securely (treat the input as fixed-length, or otherwise avoid buffer overflows and other beginner&#8217;s mistakes, separate writable data from executable code etc.). So if the device was designed competently (which, of course, the normal has no way to verify), it won&#8217;t be possible to subvert it like smartphones.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189125">

			<div class="comment by-jac_ ">

				<p class="commentcredit">

					<span class="commenter">jac_</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/#comment-189125">
						January 22, 2013 12:07 AM					</a>

				</p>

				<p>Another way to bypass 2fa</p>
<p><a href="http://nakedsecurity.sophos.com/2013/01/20/indian-two-factor-authentication-fraudsters-busted-by-delhi-cops/" rel="nofollow ugc">http://nakedsecurity.sophos.com/2013/01/20/indian-two-factor-authentication-fraudsters-busted-by-delhi-cops/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/12/bypassing_two-f.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/12/bypassing_two-f.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F12%2Fbypassing_two-f.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/12/bypassing_two-f.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4606' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/12/buy_your_own_at.html" rel="prev">â† Buy Your Own ATM Skimmer for $3000</a>		<a href="https://www.schneier.com/blog/archives/2012/12/dictators_shutt.html" rel="next">Dictators Shutting Down the Internet â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
