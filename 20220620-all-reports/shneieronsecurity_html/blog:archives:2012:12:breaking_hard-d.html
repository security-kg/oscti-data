<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Breaking Hard-Disk Encryption - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Breaking Hard-Disk Encryption Comments Feed" href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4624" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4624' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F12%2Fbreaking_hard-d.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F12%2Fbreaking_hard-d.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4624 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4624" class="post-4624 post type-post status-publish format-standard hentry category-uncategorized tag-cryptanalysis tag-cryptography tag-encryption tag-full-disk-encryption tag-pgp tag-side-channel-attacks tag-truecrypt">

	<div class="article">

		<h2 class="entry">Breaking Hard-Disk Encryption</h2>
		<p>The newly  <a href="http://www.elcomsoft.com/PR/EFDD_121220_en.pdf">announced</a> <a href="http://www.elcomsoft.com/efdd.html">ElcomSoft Forensic Disk Decryptor</a> can decrypt BitLocker, PGP, and TrueCrypt.  And it&#8217;s only $300.  <a href="http://thenextweb.com/insider/2012/12/20/this-299-tool-is-reportedly-capable-of-cracking-bitlocker-pgp-and-truecrypt-disks-in-real-time/">How does it work?</a></p>
<blockquote><p>Elcomsoft Forensic Disk Decryptor acquires the necessary decryption keys by analyzing memory dumps and/or hibernation files obtained from the target PC. You&#8217;ll thus need to get a memory dump from a running PC (locked or unlocked) with encrypted volumes mounted, via a standard forensic product or via a FireWire attack. Alternatively, decryption keys can also be derived from hibernation files if a target PC is turned off.</p></blockquote>
<p>This isn&#8217;t new.  I wrote about AccessData doing the same thing in <a href="https://www.schneier.com/blog/archives/2007/01/choosing_secure.html">2007</a>:</p>
<blockquote><p>Even so, none of this might actually matter. AccessData sells another program, Forensic Toolkit, that, among other things, scans a hard drive for every printable character string. It looks in documents, in the Registry, in e-mail, in swap files, in deleted space on the hard drive &#8230; everywhere. And it creates a dictionary from that, and feeds it into PRTK.</p>
<p>And PRTK breaks more than 50 percent of passwords from this dictionary alone.</p></blockquote>
<p>It&#8217;s getting harder and harder to maintain good file security.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/full-disk-encryption/" rel="tag">full-disk encryption</a>, <a href="https://www.schneier.com/tag/pgp/" rel="tag">PGP</a>, <a href="https://www.schneier.com/tag/side-channel-attacks/" rel="tag">side-channel attacks</a>, <a href="https://www.schneier.com/tag/truecrypt/" rel="tag">TrueCrypt</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html" rel="bookmark">Posted on December 27, 2012 at 1:02 PM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html#comments">56 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html" data-title="Breaking Hard-Disk Encryption" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-189548">

			<div class="comment by-ryan ">

				<p class="commentcredit">

					<span class="commenter">Ryan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189548">
						December 27, 2012 1:14 PM					</a>

				</p>

				<p>Sooo&#8230; Maintain full-HD encryption at all times, or just don&#8217;t bother?</p>
<p>Also, does it scan every possible combination of unencrypted files as possible keyfiles? I highly doubt it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189549">

			<div class="comment by-thorne ">

				<p class="commentcredit">

					<span class="commenter">Thorne</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189549">
						December 27, 2012 1:27 PM					</a>

				</p>

				<p>Key files on a removable drive FTW!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189551">

			<div class="comment by-ross-patterson ">

				<p class="commentcredit">

					<span class="commenter">Ross Patterson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189551">
						December 27, 2012 1:35 PM					</a>

				</p>

				<p>@Thorne: <i>Quis custodiet ipso custodes?</i>  Who will encrypt the encryption keys?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189552">

			<div class="comment by-kurt-dillard ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://kurtdillard.com' rel='external nofollow ugc' class='url'>Kurt Dillard</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189552">
						December 27, 2012 1:41 PM					</a>

				</p>

				<p>It seems like Elcomsoft glosses over the potential challenges of getting the hibernation files. If you&#8217;re using FDE than those files are encrypted, so if you always hibernate or shutdown before walking away from your PC you should be safe from these tools, right?</p>
<p>The Firewire attacks (and other hardware-based exploits) are interesting; so is analyzing the DRAM for encryption keys; but all of these can be mitigated by keeping your PC with you whenever its turned on or sleeping, and waiting for it to fully power off when hibernating or powering down.</p>
<p>Also, I&#8217;m not sure how relevant the AccessData tool is, if you&#8217;re using FDE then their software won&#8217;t be able to find passwords stored on it when the computer is turned off.</p>
<p>It seems like in the long run encryption operations will have to be offloaded to tamper-resistant hardware, but that is expensive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189553">

			<div class="comment by-arkanoid ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://arkanoid.livejournal.com' rel='external nofollow ugc' class='url'>ArkanoiD</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189553">
						December 27, 2012 2:02 PM					</a>

				</p>

				<p>why no dmcrypt and filevault?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189554">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189554">
						December 27, 2012 2:15 PM					</a>

				</p>

				<p>What if your encrypted volumes have been unmounted / and for how long?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189555">

			<div class="comment by-moe ">

				<p class="commentcredit">

					<span class="commenter">Moe</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189555">
						December 27, 2012 2:19 PM					</a>

				</p>

				<p>Move along, nothing to see here.</p>
<p>&#8220;If the PC being investigated is turned off, the encryption keys can be retrieved from the hibernation file. The encrypted volume must be mounted before the computer went to sleep. If the volume is dismounted before hibernation, the encryption keys may not be derived from the hibernation file.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189556">

			<div class="comment by-richard ">

				<p class="commentcredit">

					<span class="commenter">Richard</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189556">
						December 27, 2012 2:20 PM					</a>

				</p>

				<p>PGP and TrueCrypt can store keys on smart cards does Bitlocker have this feature?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189558">

			<div class="comment by-arkanoid ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://arkanoid.livejournal.com' rel='external nofollow ugc' class='url'>ArkanoiD</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189558">
						December 27, 2012 2:26 PM					</a>

				</p>

				<p>Smartcards won&#8217;t help here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189559">

			<div class="comment by-curmudgeon ">

				<p class="commentcredit">

					<span class="commenter">Curmudgeon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189559">
						December 27, 2012 2:26 PM					</a>

				</p>

				<p>Dictionary attacks based on printable string searches could be defeated by using passphrases that contain mostly non-printing characters.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189560">

			<div class="comment by-kurt-dillard ">

				<p class="commentcredit">

					<span class="commenter">Kurt Dillard</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189560">
						December 27, 2012 2:27 PM					</a>

				</p>

				<p>Richard, BitLocker uses the TPM to store the keys and other information such as data the OS startup files to check their integrity before unlocking the TPM.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189561">

			<div class="comment by-kurt-dillard ">

				<p class="commentcredit">

					<span class="commenter">Kurt Dillard</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189561">
						December 27, 2012 2:32 PM					</a>

				</p>

				<p>Good catch Moe. It seems to me that they are confusing &#8216;sleep&#8217; with &#8216;hibernation&#8217; too. If the computer is in &#8216;hibernation&#8217; mode its completely turned off which means that the hibernation files stored on the encrypted system volume would be encrypted. Bruce or anyone else feel free to correct me if my understanding of how these FDE products work is incorrect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189562">

			<div class="comment by-nycman ">

				<p class="commentcredit">

					<span class="commenter">nycman</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189562">
						December 27, 2012 2:34 PM					</a>

				</p>

				<p>If you had a file encrypted with PGP, but had the file open when an attacker gets access to your computer, would we now say PGP is &#8220;broken&#8221;?  FDE is no different.  They all are vulnerable while the disk is unlocked.  Which is why best practice is to disable sleep mode, set a timeout to hibernate, strong pass-phrase.  The hibernate partition should be encrypted too.  For additional security, use FDE and a file encryption product.  If FDE is compromised, the individual files will still be encrypted.</p>
<p>Is it possible that malware does a memory dump or extracts the FDE key, sending it to the attacker, while you are working on your computer?  The attacker later retrieves your powered off laptop and already has the key.  Would a TPM with strong password protect against this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189563">

			<div class="comment by-derp ">

				<p class="commentcredit">

					<span class="commenter">derp</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189563">
						December 27, 2012 2:50 PM					</a>

				</p>

				<p>They warn about sleep/hibernation mode right on the truecrypt website. If your machine is off there&#8217;s no way to retrieve anything with FDE, especially with DDR3 memory that is immune to cold boot attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189564">

			<div class="comment by-cris-perdue ">

				<p class="commentcredit">

					<span class="commenter">Cris Perdue</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189564">
						December 27, 2012 3:10 PM					</a>

				</p>

				<p>So let&#8217;s assume you are using a full disk encryption product and your computer is hibernating.  You wake it up from hibernation. Now at this point RAM has no decryption keys in it, indeed is basically blank. Does the disk encryption product ask for your passphrase during wakeup? Or is the hibernation file not encrypted? Or what? An inquiring mind would like to know.</p>
<p>Thanks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189565">

			<div class="comment by-brad-cable ">

				<p class="commentcredit">

					<span class="commenter">Brad Cable</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189565">
						December 27, 2012 3:35 PM					</a>

				</p>

				<p>Curmudgeon: most (if not all) encryption software hashes your password immediately, yielding a hex based result which is still easily searched by looking for strings.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189566">

			<div class="comment by-kurt-dillard ">

				<p class="commentcredit">

					<span class="commenter">Kurt Dillard</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189566">
						December 27, 2012 3:38 PM					</a>

				</p>

				<p>Great question Cris, I&#8217;ve been using BitLocker for years, I have it configured to prompt for the PIN in order to unlock the TPM when resuming from Hibernate. However, you are not prompted for a PIN when waking from sleep mode. I used to use TrueCrypt but don&#8217;t recall how it behaves.</p>
<p>Some links from Microsoft on these issues (note the dates too):<br />
&#8211; Defense-in-Depth vs. BitUnlocker: How to defeat Cold DRAM attacks using BitLocker, Power Options, and Physical Security<br />
<a href="http://blogs.technet.com/b/staysafe/archive/2008/02/24/defense-in-depth-vs-bitunlocker-how-to-defeat-cold-dram-attacks-using-bitlocker-power-options-and-physical-security.aspx" rel="nofollow ugc">http://blogs.technet.com/b/staysafe/archive/2008/02/24/defense-in-depth-vs-bitunlocker-how-to-defeat-cold-dram-attacks-using-bitlocker-power-options-and-physical-security.aspx</a><br />
&#8211; Protecting BitLocker from Cold Attacks (and other threats)<br />
<a href="http://blogs.msdn.com/b/si_team/archive/2008/02/25/protecting-bitlocker-from-cold-attacks-and-other-threats.aspx" rel="nofollow ugc">http://blogs.msdn.com/b/si_team/archive/2008/02/25/protecting-bitlocker-from-cold-attacks-and-other-threats.aspx</a><br />
&#8211; Blocking the SBP-2 driver and Thunderbolt controllers to reduce 1394 DMA and Thunderbolt DMA threats to BitLocker<br />
<a href="http://support.microsoft.com/kb/2516445/en-us" rel="nofollow ugc">http://support.microsoft.com/kb/2516445/en-us</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189568">

			<div class="comment by-yuri ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://yurisk.info' rel='external nofollow ugc' class='url'>Yuri</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189568">
						December 27, 2012 3:57 PM					</a>

				</p>

				<p>Even if an attacker has the access to a running computer with mounted volumes, he would still need to break into the system to acquire memory dump. But if he can break into the system, why would he need the keys if he could just double click to access the data ?<br />
In other words &#8211; for their product to work, you need a memory dump, but if you have means to get memory dump, you don&#8217;t need their product anyway ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189569">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189569">
						December 27, 2012 4:04 PM					</a>

				</p>

				<p>Does anyone know if Firewire attacks will be achievable on machines with Firewire converters &#8211; say, via Thunderbolt? Wondering if that DMA vector may be disappearing soonish&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189570">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189570">
						December 27, 2012 5:05 PM					</a>

				</p>

				<p>That&#8217;s called an evil maid attack, old news.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189571">

			<div class="comment by-gangnam-style ">

				<p class="commentcredit">

					<span class="commenter">gangnam style</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189571">
						December 27, 2012 6:33 PM					</a>

				</p>

				<p><a href="http://www.truecrypt.org/docs/?s=hibernation-file" rel="nofollow ugc">http://www.truecrypt.org/docs/?s=hibernation-file</a></p>
<p>You can set TC to automatically dismount whenever your comp goes into hibernation mode, though if the entire disk is encrypted, there&#8217;s no hiberation files to find.</p>
<p>Elcomsoft is selling regular old memory siphoning software that will suck the memory contents out of a running system to get any keys stored there. There will be nothing there if:</p>
<p>-all containers dismounted<br />
-you set your comp to automatically dismount when entering sleep or hibernation mode<br />
-the comp is powered off<br />
-you aren&#8217;t using an encryption program that keeps keys in memory</p>
<p>If you have DDR3 memory, they do not hold any voltage after being powered off which have made cold boot attacks a thing of the past if you&#8217;re worried about immediate shutdown and seconds later, seized system and memory analysis.</p>
<p>If you&#8217;re paranoid and worried about firewire access you can always write a script that if somebody inserts a firewire device your machine will then either power off or start zeroing out memory and the drive. Meddle around with linux/bsd automount settings</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189572">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189572">
						December 27, 2012 9:32 PM					</a>

				</p>

				<p>Nice that there&#8217;s something about forensics: my recent paper grab has some nice innovations in that area.</p>
<p>&#8220;Bulletproof solution to forensic memory acquisition&#8221;<br />
<a href="http://www.acsac.org/2012/openconf/modules/request.php?module=oc_program&#038;action=summary.php&#038;id=112&#038;OPENCONF=3c4f43ed25fe8d1fc21058f5430563d4" rel="nofollow ugc">http://www.acsac.org/2012/openconf/modules/request.php?module=oc_program&#038;action=summary.php&#038;id=112&#038;OPENCONF=3c4f43ed25fe8d1fc21058f5430563d4</a></p>
<p>TRESOR-Hunt: Attacking CPU Bound Encryption<br />
<a href="http://www.acsac.org/2012/openconf/modules/request.php?module=oc_program&#038;action=summary.php&#038;id=237&#038;OPENCONF=3c4f43ed25fe8d1fc21058f5430563d4" rel="nofollow ugc">http://www.acsac.org/2012/openconf/modules/request.php?module=oc_program&#038;action=summary.php&#038;id=237&#038;OPENCONF=3c4f43ed25fe8d1fc21058f5430563d4</a></p>
<p>I remember Clive liked the TRESOR scheme. I knew it would fall eventually. DMA is a pandora&#8217;s box for security issues, it seems.</p>
<p>I honestly have to give it to Clive for coming up with the best idea for COTS HD crypto: combine a self-encrypting drive, an inline-media encryptor, and full-disk encryption. They have to break it all. The problem: the NSA is pretty much the only one making an IME, so must custom make that one. SED + FDE is still an improvement that shouldn&#8217;t hurt performance, as SED&#8217;s have hardware acceleration.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189573">

			<div class="comment by-jordan ">

				<p class="commentcredit">

					<span class="commenter">jordan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189573">
						December 28, 2012 2:28 AM					</a>

				</p>

				<p><strong>this is just for windows hibernate or mac sleep also effected ? how to automatically remove  hibernate files every time computer boot and wipe out free space ?</strong></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189574">

			<div class="comment by-a-nonny-bunny ">

				<p class="commentcredit">

					<span class="commenter">A Nonny Bunny</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189574">
						December 28, 2012 2:34 AM					</a>

				</p>

				<p>I disabled the pagefile and hibernation file on my computer, because I didn&#8217;t really see the point of sacrificing a third of my solid state disk. If you have enough memory and your computer boots in 10 seconds, what&#8217;s their use?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189575">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189575">
						December 28, 2012 9:54 AM					</a>

				</p>

				<p>Guys you don&#8217;t get it right?</p>
<p>Hibernate: Some people don&#8217;t encrypt the full disk. If you don&#8217;t encrypt de Partition where the hibernation file sits, they can get access too it.</p>
<p>If have everything encrypted, then hibernation is safe.</p>
<p>Sleep or Running machines. A cold boot attack WILL work, even with DDR3 they work. And then you can make a memory dump. Done.</p>
<p>Only with ECC Ram, you would more safe. But somehow there is still a lack of ECC in home grade Systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189576">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189576">
						December 28, 2012 10:55 AM					</a>

				</p>

				<p>This attack, which I agree is an old one, seems like a pretty basic failing of computer hardware security that needs to be fixed before ANY software security matters much.  Physically plugging a device into a machine shouldn&#8217;t give you complete access to the system.  Is this the Star Wars R2-D2 security model or what?</p>
<p>However, I had heard that at least with OSX, the firewire memory dump may not work any more.  If the other operating systems haven&#8217;t followed suit, it seems like a good time to do so.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189577">

			<div class="comment by-yerpa ">

				<p class="commentcredit">

					<span class="commenter">yerpa</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189577">
						December 28, 2012 2:17 PM					</a>

				</p>

				<p>According to the MIT lecture I just saw on signals and systems cold boot attacks are extinct ever since DDR3 ram. They do not hold a charge and are immediately cleared when powered down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189578">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189578">
						December 29, 2012 3:59 PM					</a>

				</p>

				<p>Hmm,</p>
<p>For all those talking about DDR3 memory loosing everything when you turn the power of I would be cautious about making that statment.</p>
<p>The reason is there are several low level ways data is &#8220;residualy retained&#8221; in memory that is not powered up.</p>
<p>This has been an industry known issue as far as I&#8217;m aware since befor the first IBM PC hit the streets by several years (ie back in the 1970&#8217;s).</p>
<p>Whilst modern designs of various types have reduced the effects it is still an issue if other technniques have not been employed.</p>
<p>As noted by @Nick P above I have prefered options that make things a little more difficult for attackers, but I would be daft to call them secure. This is partly because the technology is not being used correctly and partly because of the weakest links in the security chain &#8220;user convenience&#8221; and &#8220;efficiency&#8221;.</p>
<p>For instance Keying Material (KeyMat) is going to be vulnerable if it&#8217;s entered from a single point (ie the computer keyboard) because amongst other things the OS does it&#8217;s best to store the data in half a dozen buffers that often get writtten to disk in part or full depending on what the OS is doing and why.</p>
<p>The NSA Inline Media Encryptor (IME) gets around this single channel issue by having a KeyMat only channel via the crypto ignition keys.</p>
<p>A few external HD&#8217;s with FDE use a keypad on the devices to enable you to enter a PIN that then selects or builds the KeyMat which is stored in the drive electronics. [Whilst this obviates the keyboard route all these FDE external HD systems I&#8217;ve seen todate are security wise very weak, for &#8220;user convenience&#8221;].</p>
<p>Likewise software based encryption has issues to do with human failings in the weakness of passwords and passphrases. They like the keyboard buffer end up being stored in system memory in some form that an OS could for one reason or another put onto the HD etc.</p>
<p>Thus I&#8217;m a firm beliver in seperate channels for KeyMat at each level (PC, IME, Ext FDE HD). I just think the current KeyMat channel solutions are not upto the job for various reasons that are not technical. Thus it is the suppliers that are letting us down for one reason or another&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189579">

			<div class="comment by-johnston ">

				<p class="commentcredit">

					<span class="commenter">Johnston</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189579">
						December 30, 2012 4:33 PM					</a>

				</p>

				<p>&#8220;Elcomsoft Forensic Disk Decryptor acquires the necessary decryption keys by analyzing memory dumps and/or hibernation files obtained from the target PC.&#8221;</p>
<p>OpenBSD&#8217;s malloc fills junk bytes into allocated and freed chunks via the J option.  By default OpenBSD encrypts the swap (where hybernation state is kept), and has done so for many years.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189580">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189580">
						December 30, 2012 5:41 PM					</a>

				</p>

				<p>@ Johnston</p>
<p>Once again, OpenBSD solves a problem many months to years before anyone else notices it&#8217;s there. They don&#8217;t bother looking for major press. They just find problems, fix them, and move on. Another example, if I recall, was them fixing a BIND problem almost a year before it was &#8220;discovered&#8221; by security researchers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189581">

			<div class="comment by-prebootme ">

				<p class="commentcredit">

					<span class="commenter">PreBootMe</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189581">
						December 30, 2012 7:49 PM					</a>

				</p>

				<p>My understanding is that this FDE vulnerability is due to lack of pre-boot authentication (PBA).</p>
<p>Without PBA, when the computer boots, the FDE encryption key is automatically decrypted (with no user authentication) and stored in RAM when the computer boots. So, without PBA, if someone steals your computer they can boot it (i.e. from full shutdown) to the Windows OS login, essentially bypassing the FDE.</p>
<p>With PBA, when the computer boots, the user is prompted to authenticate before the FDE encryption key is decrypted into memory.</p>
<p>This is why most (all?) FDE encryption products default to using some form of PBA (e.g. Microsoft recommends using a PBA PIN with Bitlocker for laptop computers).</p>
<p>One question I have is whether the Elcomsoft decryptor works on the GuardianEdge (aka Symantec) FDE product. Does the GuardianEdge FDE product use &#8220;trickier&#8221; memory obfuscation for the in memory decrypter FDE encryption key?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189582">

			<div class="comment by-perplexed ">

				<p class="commentcredit">

					<span class="commenter">Perplexed</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189582">
						December 31, 2012 6:23 PM					</a>

				</p>

				<p>Wait&#8230;.</p>
<p>As others have pointed-out:</p>
<p>Isn&#8217;t FDE intended to protect data while it is <b>at rest</b>?</p>
<p>Doesn&#8217;t the attack in question require either:<br />
-access to the encrypted volume while it is <b>mounted</b> or,<br />
-access to an <b>UNencrypted</b> hibernation file?</p>
<p>As far as the <i>latter</i> is concerned, wouldn&#8217;t either:<br />
a) making sure the hibernation file is <i>encrypted</i> (which,  presumably, any FDE scheme worth its salt would do by default) or,<br />
b) not using hibernation altogether ,<br />
render such an attack ineffective?</p>
<p>As far as the <i>former&lt;/&gt; is concerned, if an attacker has successfully managed to gain access to a <b>mounted</b> encrypted volume, isn&#8217;t it </i><i>already</i> game-over in nearly all cases?</p>
<p>So what is the big deal here?</p>
<p>What am I missing?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189583">

			<div class="comment by-missing-nah ">

				<p class="commentcredit">

					<span class="commenter">Missing nah</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189583">
						December 31, 2012 7:32 PM					</a>

				</p>

				<p>You are not missing anything.  Its a non issue for most.  Just don&#8217;t use sleep.</p>
<p>I think the bigger issue, at least for individuals, is where to store your emrgancy backup access keys.  You can&#8217;t just have them in a drawer next to the computer.  But if your computer is seized by someone willing to do so, couldnt they take your safe, or suppoaena your depostit box?  Yes, seems we are missing the big issue here&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189584">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189584">
						January 1, 2013 3:28 PM					</a>

				</p>

				<p>@ Perplexed,</p>
<p><i>Doesn&#8217;t the attack in question require either-access to the encrypted volume while it is mounted or-access to an UNencrypted hibernation file</i></p>
<p>Not in all cases, the attack is actually about illicitly obtaining / recovering crypto Keying Material (KeyMat) to access the encrypted data on secondary storage.</p>
<p>So if you think about it, all this attack requires is for the Keying Material (KeyMat) to be in accessable system memory (RAM, Registers, HD Electronics, or I/O or other peripheral devices) in some form usable to the attacker.</p>
<p>If you consider what happens when a COTS PC/Server computer system boots up it has neither an OS or other executable code in it&#8217;s RAM, nor KeyMat for encrypted secondary storage.</p>
<p>What usually happens on a COTS system when a hardware reset (power up etc) occurs is,</p>
<p>1) A ROM chip is switched in to the system memory map to run from the &#8220;reset vector&#8221;.</p>
<p>2) Generaly the ROM has a minimal lever loader that copies the image of some kind of Basic Input Output System (BIOS) from the ROM into RAM at some other memory location and then jumps to execute the image in RAM. Almost the first thing the BIOS image does is to switch the ROM out of the system memory map altogether.</p>
<p>3) The BIOS (image in RAM) then performs some Power On System Test (POST) diagnostics and basic hardware setup including copying any &#8220;expansion card&#8221; ROM into memory and then looks around for &#8220;bootable media&#8221;. If no bootable media is found early PC&#8217;s like the Apple ][ or original IBM PC dropped into the ROM BASIC interactive interpreter, where as more modern PCs display an error message and halt, whilst some server systems drop into a basic shell on the designated console that allows an operator to select a boot devicee or do other activites.</p>
<p>4) If a bootable device is found (or selected) the computer system will use a bootstrap loader to either load an OS or another bootstrap loader into RAM and start executing it&#8230;.</p>
<p>But if the bootable device is fully encrypted the system cann&#8217;t do this last step (4), so it needs to get the KeyMat from somewhere first&#8230;</p>
<p>There are three basic ways it can get the KeyMat,</p>
<p>1, Ask the user/operator to type the KeyMat in on the console.<br />
2, Read the KeyMat from the bootable media/device.<br />
3, Read the KeyMat from a &#8220;fill device&#8221;.</p>
<p>The first requires considerable skill from the user, the second is obviously insecure and the third requires an additiional secure storage device.</p>
<p>In Mil/Gov/Dip systems only option three is generaly considered and for the NSA devices such as the Inline Media Encryptor (IME) they use one or more KeyMat fill devices called &#8220;Crypto Ignition Key/Devices&#8221;.</p>
<p>In commercial/consumer grade systems they have int the past usually used options one or two or more recently a combination of both such that the user/operator types in a PIN/Password/Passphrase which then unlocks the CPU bus connected HD (or fill device) and the KeyMat gets coppied from it into system RAM.</p>
<p>From this point onwards the KeyMat is vulnerable to this or similar attacks.</p>
<p>Now as we all know &#8220;users love simplicity and ease of use&#8221; and they don&#8217;t want to be typing in multiple AES keys etc. Thus many modern iA86 PC motherboards come with a secure tamper evident KeyMat storage device which is the MS / Intel Trusted Platform Managment (TPM) device. Whilst other PCs and servers use a crypto smart card or even a specialised RS232 or USB device (some even pull it across a secure network connection using a modified form of NetROM).</p>
<p>Now the TPM has the KeyMat in it and depending on how it&#8217;s configured defines the way KeyMat gets into system RAM at boot up.</p>
<p>In many cases TPMs or other crypto fill devices can be set up to just load the KeyMat automatically on bootup with either a minimal (weak) PIN/Password/Passphrase or no protection at all on the (incorrect) assumption that an attacker cannot get it out of RAM without having hardwired physical access&#8230;</p>
<p>So just turning a computer on can in many cases cause the KeyMat to get pulled into memory even though it might not let you procead to fully boot into the OS without entering a user name and password etc&#8230;</p>
<p>Thus it&#8217;s quite possible to have a computer system with high entropy KeyMat stored in a secure module inside it that is used for full encryption of the data on the HD. That in reality is realy only protected by a four digit PIN or short guessable username and password/passphrase. That can usually be &#8220;guessed&#8221; in some way with access to the hardware (If I remember Correctly Apple phones and other smart phones suffer from this problem).</p>
<p>Worse this weak &#8220;user input&#8221; can usually be collected with a suitably small device such as a keyboard logger or miniture CCTV camera hidden in a ceiling fixture etc etc or just picking the users pocket, or reading the sticky note attached to the screen/keyboard where the user has healpfully written it down as an aid memoir.</p>
<p>It&#8217;s problems such as these that makes the use of FDE and other &#8220;data at rest&#8221; security systems a bit pointless for the majority of users. In some respects the whole FDE marketplace is not actually driven by &#8220;real security concerns&#8221; but &#8220;checkbox audit concerns&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189585">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189585">
						January 2, 2013 11:45 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>It sometimes helps to understand what threat the TPM in your description protects against. The two main threats are:</p>
<p>1- Removal of the Hard drive from a server and and attempting to decrypt the volume offline (off site)</p>
<p>2- Booting the server or pc from secondary media (cd rom, a linux drive, etc&#8230;) then attempting to decrypt the secondary volume.</p>
<p>As far as I know, the TPM does a good job protecting against those two attacks.</p>
<p>Keep in mind, however, that the main purpose of a TPM is not for encrypting a volume &#8212; this was an ancillary first commercial use of the TPM (Trusted Platform Module). Refer to our previous discussion about what &#8220;Trusted boot&#8221; means as opposed to &#8220;Secure boot&#8221;, or for that matter, the definition of &#8220;Security&#8221;&#8230;</p>
<p>The TPM does not simply store KeyMat, it seals it to a platform state. Without that state (which will surely be the case when you mount the stolen drive on a different server with a different TPM), the KeyMatt will not be available. And it&#8217;s decrypted within the TPM. There are various configurations and architectures for using a TPM to assist in full volume encryption. Some implementations are strong, and some are, well&#8230; a little weaker&#8230;</p>
<p>There are also implemented mechanisms in commercial products to protect against what is known as &#8220;reset attack&#8221;, where RAM is scrubbed before shutdown, or on power up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189586">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189586">
						January 2, 2013 4:36 PM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>It sometimes helps to understand what threat the TPM in your description protects against</i></p>
<p>Yes it does, and the two cases you mention are by and large not related to stealing the keys from memory. I mentioned it because in a significant number of case the TPM is configured badly so it putst the keys in memory with insufficient safe guards&#8230;</p>
<p>That is it does not matter how good or bad the basic strength of your safe is, if the user leaves the keys or combination of easy reach of it.</p>
<p>A big problem that is begining to buble up with security is the issue of &#8220;Real -v- Audit&#8221; as it&#8217;s driver.</p>
<p>If the driver is for &#8220;real security&#8221; then the processes as well as the technology are covered effectivly by policy.</p>
<p>However if the driver is for &#8220;audit security&#8221; then the technology will match the auditors check boxes but the processes will almost invariably only be there for &#8220;lip service&#8221; reasons.</p>
<p>Whilst the increased level in security means a larger market and (hopefully) reduced prices for the technology, the &#8220;audit&#8221; driver means that the technology will almost certainly be lacking in one or more ways. An example of this is a supposadly secure external HD that used 256bit AES to encrypt the data, however the AES key was stored internaly and only protected by a short length PIN. Thus you have AES KeyMat with ~256bits of entropy being protected with a 4 digit PIN giving only 13-14bits of entropy&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189587">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189587">
						January 2, 2013 5:24 PM					</a>

				</p>

				<p>@ Clive Robinson,</p>
<p>I hear you&#8230;<br />
You are describing a case, then, when an adversary has physical access to the device and the liberty to use hardware equipment to dump memory and steal a key. Would be easier if they just get to the information they want while they&#8217;re at it. They still need to know what the key is for since the TPM has a hierarchy of keys, not a single key.</p>
<p>Almost all bets are off, when an adversary has physical access to the device with this level of attack. By the way, The TPM&#8217;s I last looked at were EAL 4+ (Nick P would not like anything below 7, I guess)&#8230;</p>
<p>Speaking of drivers, its mainly a check in the box&#8230;<br />
&#8216;nough said about that ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189588">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189588">
						January 2, 2013 5:47 PM					</a>

				</p>

				<p>I want to comment a bit on this:</p>
<blockquote><p> An example of this is a supposadly secure external HD that used 256bit AES to encrypt the data, however the AES key was stored internaly and only protected by a short length PIN. Thus you have AES KeyMat with ~256bits of entropy being protected with a 4 digit PIN giving only 13-14bits of entropy&#8230; </p></blockquote>
<p>If the external drive is protected by a TPM, the PIN or pass-phrase alone is not sufficient to break it. i.e, the entropy of the 256 AES has not been reduced to the length of the PIN or the pass-phrase. Here is why:</p>
<p>1- The encrypting / decrypting AES key is itself wrapped by another key internal to the TPM, which is wrapped by another key, and another, all the way to the SRK.</p>
<p>2- The TPM will NOT decrypt a key if the following is not true:<br />
a- PCR&#8217;s do not contain the expected values the wrapping key was sealed to<br />
b- correct pass-phrase was not entered.</p>
<p>So you really need to know the pass-phrase and have access to a clone of the computer the external drive was attached to at the time of encryption. That clone includes a clone of the TPM on the original device as well (with its unique SRK &#8212; Storage Root Key, which is generated at the time the TPM is taken ownership of), it includes all the option ROMS that were measured and extended to the TPM PCRs (Platform Configuration Registers) &#8212; An identical clone (as far as what was measured in these PCRs)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189589">

			<div class="comment by-bill ">

				<p class="commentcredit">

					<span class="commenter">Bill</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189589">
						January 3, 2013 9:15 AM					</a>

				</p>

				<p>So what would people suggest for good file security?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189590">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189590">
						January 3, 2013 1:39 PM					</a>

				</p>

				<p>@ Wael</p>
<p>Good points on TPM. Yes, with regular hackers or thieves, the TPM should be effective at ensuring a trusted state and preventing keys from leaking. I prefer something with a bit more flexibility in what I can do with it, but TPM&#8217;s can do this basic thing. If implemented correctly.</p>
<p>@ Clive Robinson</p>
<p>&#8220;By the way, The TPM&#8217;s I last looked at were EAL 4+ (Nick P would not like anything below 7, I guess)&#8230;&#8221;</p>
<p>Previously, maybe. No longer now that I&#8217;ve seen so much of the history of high assurance and understand it&#8217;s economics. I think a high assurance TPM is quite doable, more than before. I&#8217;ll settle for EAL5-6 TPM that makes the right choices in how they approach hardware security, software assurance, and security features.</p>
<p>The problem I&#8217;ve been having with Common Criteria is EAL&#8217;s vs Protection Profile attributes vs Security Targets. The government prefers using Protection Profiles and I think they decided to only use them for high assurance evaluations. The other thing is that, within a Protection Profile, the attributes themselves are implemented at different levels of assurance. For instance, the security kernel mechanism itself might be EAL7, but the drivers or auditing code certainly wasn&#8217;t.</p>
<p>So, I&#8217;d divide it up as follows. First, the EAL should be EAL5 at a minimum. We have several smartcards and their associated middleware evaluated at EAL5+ with plenty of useful features. The VAMP and AAMP7G processors were formally verified to tremendous levels. We also have three smartcard platforms with EAL7-like development assurance: MULTOS, Gemalto&#8217;s JavaCard, and IBM&#8217;s Caernarvon. So, there&#8217;s no technical excuse that these TPM&#8217;s should be EAL4.</p>
<p>So, I&#8217;d use commercial best practices for the basic hardware. We can assume it will be beaten by undergrads like most other platforms. Maybe make an optional port to IBM&#8217;s FIPS Lvl 4 coprocessor. Anyway, for hardware security, we just need basic tamper-resistance and effort put into it provably resisting software level attacks (i.e. no security critical errata).</p>
<p>Now, from here, we can implement the security-critical parts in hardware or design a new TPM around an EAL5-certified cryptoprocessor (my preference). If it&#8217;s hardware, we use existing hardware verification technology for initial design, refinements and testing. We can already achieve good results with that. Galois&#8217;s Cryptol supports generating VHDL code from crypto algorithm specs. Tools like Esterel&#8217;s SCADE or similar event-driven architecture might be used for their certified code generators.</p>
<p>If it&#8217;s the other choice, the TPM would be software: what runs on cryptoprocessor and what interfaces to it (mostly drivers). We have tech now to formally specify and prove assembler, interrupts, concurrency, and drivers. We need to use it to some acceptable degree. NICTA was also working on auto-generating drivers from hardware specs, but idk their progress.</p>
<p>(Note: We don&#8217;t necessarily need a cryptoprocessor if we&#8217;re not worried about high-tech physical attacks. We can use a robust SOC like Freescale offers with onboard crypto mechanisms such as TRNG. That makes things MUCH easier.)</p>
<p>A side advantage of using a software-centric TPM design is that it can be field-updated. I&#8217;ve detailed methods before here and otherwise on how to build a high assurance boot and update mechanism. There is also a commercial I.P. available for that from one vendor, but idk it&#8217;s actual security.</p>
<p>Another advantage is flexibility. The same basic hardware can be reused for other security functionality. An example would be for a recovery-oriented architecture where the untrusted system keeps telling the trusted coprocessor which memory locations are immutable or about dataflows. The coprocessor can periodically check to ensure operations are going appropriately. The TPM and these other products likely share the need for trusted boot, storage, crypto primitives, RNG, etc. A common platform keeps costs down.</p>
<p>For assurance, I&#8217;m fine with gradually increasing assurance. That concept existed as far back as MLS LAN. So, right now, we use minimal verification technology to catch low hanging fruit. We apply existing, high-quality commercial IP to produce an interim product. (Or we just keep existing TPM&#8217;s that are good enough.)</p>
<p>Then, we start a new bottom up design using high assurance principles. Make it modular so we can assure components individually and their interactions. Gradually improve the platform. Every now and then, a release can be made to generate revenue to continue support. This is how Karger recommended doing EAL7-type projects and worked for the Caernarvon project. Whatever they build, it should be at least EAL5+ overall and crypto/rng/interface should strive for EAL7. Mixed assurance is fine with me so long as we get the right mix.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189591">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189591">
						January 3, 2013 6:09 PM					</a>

				</p>

				<p>@ Nick P</p>
<blockquote><p> I think a high assurance TPM is quite doable, more than before&#8230; </p></blockquote>
<p>I think so too. The problem is not technical Per Se, I think it&#8217;s economic. TPMs were designed to be cheap devices (sub $1  &#8211; often a lot less) &#8211; I have not looked at TPMs in over 5 years, so my information maybe dated. Computer manufacturers cannot afford pennies these days; an increase of say 5 cents to the price of a TPM is unacceptable! There are other factors too. Will leave that to your imagination ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189592">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189592">
						January 3, 2013 10:58 PM					</a>

				</p>

				<p>@ Wael</p>
<p>Wow, I didn&#8217;t know they were under $1. That&#8217;s priced more like some of these cheap microcontrollers. This explains the lower flexibility, features, performance and/or assurance.</p>
<p>Alright, so maybe the average vendor won&#8217;t buy it. Maybe they might go for it in a solution they can mark up on a premium. The Dell &#8220;Secure Consolidated Client&#8221; for MLS is an example: it&#8217;s a Dell computer with INTEGRITY-178B and some custom software. I know Green Hills isn&#8217;t exactly cheap. They pay the extra cost b/c they can charge more for the system.</p>
<p>So, the trick seems to be finding a way to market systems that have an extra level of assurance. It might also help to develop a bit of an ecosystem of products around the TCB. Examples might be monitors, digital signature systems, authentication, etc. Not sure how to do that, so I guess this stuff remains in limited markets or on custom stuff I come up with. ðŸ˜‰</p>
<p>Note: Chips like Freescale iMX have many nice security features and plenty of speed, yet cost around $5 for at least 100. I keep thinking about using them. I prefer PowerPC, but there&#8217;s plenty of ARM software out there due to smartphone wars.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189593">

			<div class="comment by-random-user ">

				<p class="commentcredit">

					<span class="commenter">Random User</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189593">
						January 4, 2013 12:06 AM					</a>

				</p>

				<p><a href="https://www.eff.org/deeplinks/2011/12/newyears-resolution-full-disk-encryption-every-computer-you-own" rel="nofollow ugc">https://www.eff.org/deeplinks/2011/12/newyears-resolution-full-disk-encryption-every-computer-you-own</a></p>
<p>The EFF, among many others, clearly do not agree with the conclusion of Clive Robertson that,</p>
<blockquote><p>the use of FDE and other &#8220;data at rest&#8221; security systems [are] a bit pointless for the majority of users.</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189594">

			<div class="comment by-random-user ">

				<p class="commentcredit">

					<span class="commenter">Random User</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189594">
						January 4, 2013 12:08 AM					</a>

				</p>

				<blockquote><p>the conclusion of Clive Robertson</p></blockquote>
<p>Clive <i>Robinson</i>, that is.</p>
<p>Sorry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189595">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189595">
						January 4, 2013 12:11 AM					</a>

				</p>

				<p>@ Nick P</p>
<p>Less than $1 When you them in millions ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189596">

			<div class="comment by-privacy-impropriety ">

				<p class="commentcredit">

					<span class="commenter">Privacy =/= Impropriety</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189596">
						January 4, 2013 12:27 AM					</a>

				</p>

				<p>As somewhat of an aside, it would seem to me that there could be benefit in encrypting as much of one&#8217;s data as possible&#8211; no matter how non-sensitive and inconsequntial.</p>
<p>Some reasons:</p>
<p>-Encrypting only sensitive data flags it as such<br />
(This would also seem to be a valid argument for using Tor and even SSL as much as possible&#8211; even for one&#8217;s most mundane and neutral traffic.)</p>
<ul>
<li>If one&#8217;s encrypted data differs significantly from one&#8217;s unencrypted data, detecting such discrepancies may be possible and may at least make easier attacks on the encryption</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189597">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189597">
						January 4, 2013 1:17 PM					</a>

				</p>

				<p>@ privacy/impropriety</p>
<p>That is why cryptogeeks have always argued for pervasive use of crypto.<br />
The problem you highlight was a reason RubberhoseFS and their ilk failed: the only people using them definitely had something to hide.</p>
<p>The OpenBSD and anonymity tacks are the only groups I recall that successfully pulled off the pervasive crypto concept.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189598">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189598">
						January 4, 2013 11:49 PM					</a>

				</p>

				<p>FDE is easy its KeyMat handling that&#8217;s the hard problem. Average consumers have the weirdest mutually exclusive concepts of regarding data security.  In the one instance they want security that is LEO unbreakable but at the same time they want some method by which HD manufactures and even local PC repair spots can recover the data after they loose the key.  So consumers only really want to feel good, they read lots of FUD that they can barely understand and they want to do something, sorry but that&#8217;s the market for FDE, the do something crowd.</p>
<p>The TPM product that meets the do-something requirements is absolutely useless for serious EAL whatever applications. Now TPM do-something can easily be a sub $1 product BUT the serious EAL5/6 TPM will need to be a $10 or more product because it will never ship in Million unit quantities. As the volume shrinks the price skyrockets, so by the time you address serious EAL7 you are lucky if the identifiable volume is 1K units.</p>
<p>BTW it will take you over a year to obtain EAL5 certification so even if both do-something and EAL5 are the same basic part there will be a significant development cost difference for the EAL5 part.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189599">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189599">
						January 5, 2013 2:26 AM					</a>

				</p>

				<p>@ Random User,</p>
<p><i>The EFF, among many others, clearly do not agree with the conclusion of Clive Robertson</i></p>
<p>First off when you quote me please do so accurately and in context, otherwise it leaves you open to various accusations. Oh and getting my naame wrong does not help your case either.</p>
<p>What I actualy said was,</p>
<p><i>It&#8217;s problems such as these that makes the use of FDE and other &#8220;data at rest&#8221; security systems a bit pointless for the majority of users. In some respects the whole FDE marketplace is not actually driven by &#8220;real security concerns&#8221; but &#8220;checkbox audit concerns&#8221;</p>
<p>So as can be seen before you modified what I had said and put it out of context for the sake of your argument, I had made my comment not as an open ended statment as you had deliberatly made it but bounded by what I had stated above it in my reply to &#8220;Perplexed&#8221;.</p>
<p>As can be seen with my opening reply to Perplexed&#8217;s question,</p>
<p></i><i>So if you think about it, all this attack requires is for the Keying Material (KeyMat) to be in accessable system memory (RAM, Registers, HD Electronics, or I/O or other peripheral devices) in some form usable to the attacker.</i></p>
<p>I was limitting my context to this new attack.</p>
<p>The EFF posting you link to was from back in 2011, and what they quote as the material they used as it&#8217;s foundation is thus even older.</p>
<p>As Bruce has noted a number of times in the past, attacks only get better with time.</p>
<p>But you have further not compared what I have said with what the EFF have said.</p>
<p>My comment was in two basic parts the first described how most computer systems (PC/Server) get to the point of using a fully encrypted device the second part about how systems fail because of,</p>
<p><i>&#8230; as we all know &#8220;users love simplicity and ease of use&#8221; and they don&#8217;t want to be typing in multiple AES keys etc.</i></p>
<p>As Bruce has also noted in the past users regard security as getting in the way of the work they are paid to do and by which their performance and thus employment, potential bonuses and promotion are judged by their managers (not tthe IS staff). Thus it is in a users self interest to set their priorities as appropriate and minimise the impact or inconveniance any security measure may impose.</p>
<p>Thus if the system alows it short easily broken passphrases, passwords and PINS are to be expected as the norm rather than as the exception.</p>
<p>I then went on to describe various ways that system manufactures had designed systems to &#8220;help the user&#8221; and how due to poor configuration and use, the high entropy of the AES KeyMat could be reduced to just a few bits of a four digit PIN.</p>
<p>As Bruce has also pointed out in the past security is a chain the strength of which fails on it&#8217;s weakest link. Which would in this case be the pass phrase, password or four digit PIN.</p>
<p>As you may or may not know the benchmark for crypto attacks is a &#8220;Brut Force Attack&#8221; which is basically trying each possible Key in turn untill you find the right one. Now trying 2^128 guesses on an AES key is currently thought to be not possible in the expected remaining life time of the Universe. However going through the 2^13 bits of a probable four digit PIN can be done in just a few seconds if you can get appropriate access to the points in the computer system motherboard [1]. Which if you do will release the AES KeyMat into the computer system memory for the attacker to harvest at which point it&#8217;s &#8220;Game Over&#8221; for the prevention of access to the &#8220;data at rest&#8221; under FDE.</p>
<p>Now if you go back to the EFF articale you will see they very specificaly go over the generation and use of strong passphrases. It has it&#8217;s own highlighted section that begins with,</p>
<p><i>Full-disk encryption is most effective if you make a strong passphrase&#8230;</i></p>
<p>So rather than the EFF being in disagreement with what I&#8217;ve said they were in fact stressing the importance of not making the mistake I was highlighting as being a major &#8220;real world issue&#8221; with current FDE system usage.</p>
<p>So you could further say the EFF were being up beat about FDE due to their assumption users would follow all their advice ad do the right thing, and I was being pesemistic about users not doing all that was required.</p>
<p>I would say in my defence that I think the EFF were being overly optomistic about users and due to practical experiance of myself and others including Bruce, I am being realistic about what many users will do in practice.</p>
<p>In many ways security from a users perspective is much like many new year resolutions like &#8220;I will get fit&#8221; they spend good money on equipment to help them achive the goal but then don&#8217;t use it properly so get no real benifit from it&#8230;</p>
<p>So just to make it clear for you,</p>
<p>The weakest link in the security system defines it&#8217;s strength, and the point at which an attacker will attack, if they are aware of it, and can exploit it. Due to various human failings humans will modify systems to make their life as simple as possible so that they can get on with their work. Such modifications are almost always to the detriment of system security.</p>
<p>And finaly the only real difference between the time when the EFF wrote their piece and the time I wrote the above, is there is now an acknowledged method by which an attack can be fairly easily mounted against an FDE protected system such as a laptop, by Government and LEAs against individuals, because ElcomSoft has for commercial reasons decided to release a cheap tool for them to do so.</p>
<p>[1] This is a currently open field of research but put simply if the TPM on your system motherboard is a seperate chip to the one doing the FDE then the KeyMat has to travel across the wire in some way. Whilst it&#8217;s possible to encrypt it in some way many systems to date have failed to do it sufficiently well to prevent them being broken which has happened several times. Further the TPM is also susceptable to software injection attacks [2] even if it is not a seperate chip,</p>
<p>[2] Many TPM&#8217;s are vulnerable to software attacks because of the way they check code that is to be executed by the system CPU. In essence it&#8217;s a form of code signing, where you hash the memory image as it&#8217;s loaded and check the hash against a signed version. As this is computationaly expensive it&#8217;s often only done on loading and not during run time. If an attacker can change the code on such a system after it&#8217;s checked neither the TPM or CPU will know the code is nolonger trusted and it&#8217;s game over. There are a number of ways this can be done the two primary ways are via DMA [3] and Interupt handlers [4].</p>
<p>[3] On nearly all system motherboards there are one or more Direct Memory Access (DMA) controlers used to quickly move images of memory around system memory without causing the CPU to slow or halt it&#8217;s execution. In essence they are like a very limited function co-processor who&#8217;s function is to copy the information from one location in main system memory to another. In some systems DMA is available via an external interface and is used by high speed high capacity memory devices. The problem with this is that such interfaces are usually poorly protected and an attacker with a quite simple device can plug it in and change the information stored in any memory location in memory. Thus it&#8217;s fairly simple to read out the system memory image and analyse it on another system and then write back what is in effect malware that both the TPM and CPU assume is trusted code. This attack is in effect at a level bellow the CPU in the computing stack and ias such is one in many in the vast gulf between hardware design and software that as I&#8217;ve indicated a number of times in the past on this blog is not currently protected in any way.</p>
<p>[4] DMA is not the only way an attacker can get at system memory to change signed code that has been checked by the TPM / CPU. Most CPU&#8217;s have facilities for dealing with Real Time Events that occure asynchronously to the executing code on the CPU. In many cases these events need to be serviced so rapidly that dealing with them in a round robin way with software polling is not viable. To do this the hardware raises an exception and causes the CPU to switch from ordinary processing of data to an exception handler. Because of the nature of these exceptions they are given their own name of &#8220;Interupts&#8221; whilst originaly designed for hardware they have long since been used for software as well and now form the bed rock of communicating data from user execution space to kernal protected execution space. And thereby open up an attack vector via the interupt handler. Originaly computer system suppliers designed all of the I/O devices and wrote the interupt handlers &#8220;in house&#8221;. However that all changed back in the 1970&#8217;s when other people started designing add on hardware and usually wrote the Device Drivers themselves to work with an API developed by the OS kernel designers. As we know it&#8217;s possible to put in software hooks that will pass a code review process by the OS designers organisation and thus be signed as trusted code. But like all usefull tools these software hooks can be used for other nefarious activities such as changing memory that is assumed to be trusted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189600">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189600">
						January 5, 2013 10:00 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>I remember Clive liked the TRESOR scheme. knew it would fall eventually. DMA is a pandora&#8217;s box for security issues, it seems</i></p>
<p>I was not ignoring you but waiting for the thread to die down a bit before replying, as my posts have generaly have some length to them (as this one will ðŸ˜‰</p>
<p>If you view the security stack in computing at the bottom of what you might call the physical layer is quantum effects working up through basic device physics transistors logic gates etc. At the top of the traditional ISO OSI seven layer model you have the apllication layer, but as we know from &#8220;layer 8/9/10&#8221; conversations it goes all the way up into politics.</p>
<p>If you view this stack you discover some quite unpleasant truths, for instance I remember your conversations with @RobertT over the lack of security in the chip design process and your surprise at just how little security there was.</p>
<p>As for the political process well I guess most of us will never realy understand what goes on in there. The machianations of the various performing arts rights holders is enough of an indication that &#8220;Money Talks, and civil rights walk.&#8221;.</p>
<p>But what many people don&#8217;t realise is the dependance relationships of security that is the application layer security is based not just on the layers beneath but the policy layers above.</p>
<p>That is you can undermine computer security as expected from beneath but also from above via protocols standards and upwards to politics and legislation like CALEA.</p>
<p>The thing is many people don&#8217;t realise there is a large gulf of no security below what they consider the physical layer that is above the basic logic gate level but below the CPU level they see in abstract terms through software.</p>
<p>If you think about the hierarchie of an actual computer system we have the CPU as the boundry for software. Thus this is where most code cutting software developers consider the &#8220;be all and end all&#8221; of their mental map. They don&#8217;t consider that there are layers beneath such as the memory and IO that can change behind their back and thus effect what they do and make their mental security models entirely invalid.</p>
<p>DMA is just one such way of manipulating the memory beneath the CPU level there is also the Memory Managment Unit and the I/O mechanisms that rule the roost via the interupt mechanisms that run at what you might consider Ring -1. And these are what you might consider the upper layers of this gulf of insecurity. There are other tricks such as the actual CPU microcode or equivalent in all the other state machines.</p>
<p>Normaly we don&#8217;t consider them in the security model both currently and in times past. The obvious question thus arising is why?</p>
<p>Well it is because of the idea of &#8220;Physical Access Control&#8221; preventing &#8220;front panel access&#8221;. That is the computer room was an &#8220;outer perimeter&#8221; that could be much more easily defended by the physical means of bricks, mortar, doors, locks and human security such as guards and 24&#215;7 resident operators than it could by using the hardware and software of the system.</p>
<p>Sadly whilst back in the 1960&#8217;s and 70&#8217;s they were well aware of these below the CPU problems they did not have the computing hardware resources spare to do anything about it. Thus the prevailing view was you had no choice but to do it by physical access control. And with the very resource limited big iron systems of the time running in &#8220;time share&#8221; not &#8220;resource share&#8221; this was not realy much of an issue, you just changed a tape or disk pack and reloded the memory.</p>
<p>But the prevailing view became a mind set and few remembered why it just became &#8220;this is the way we do things&#8221;. Hence as the switch from &#8220;time share&#8221; to &#8220;resource share&#8221; happened the development of security still remained firmly set in &#8220;big iron&#8221; &#8220;physical access control&#8221; and the outside the perimeter terminals were dealt with by development along the lines of &#8220;trusted path&#8221;.</p>
<p>Then back in the 70&#8217;s and 80&#8217;s the physical access control security model broke down, the first Personal Computer resources started that eventually resulted in the demise of big iron and terminals. But the security model and ideas appeared stuck in the big iron model and incapable of keeping up with the changes. Thus rather than put even rudimentry security in the PC the user simply took out the floppy disks put them in a box and into the fire proof safe. Thus in a perverse way the big iron access control security model lived on.</p>
<p>It was not till the late 80&#8217;s and early 90&#8217;s when PC&#8217;s had HD&#8217;s as the norm and  business networks started to be not just on LANs inside the physical perimeter of the building walls, to WANs outside the physical access control perimeter that people started to wake up and we got the ideas of Firewalls, DMZs, Bastion Hosts etc. But the &#8220;big iron&#8221; mentality still remained and thus we now have VPN&#8217;s, that still have the underlying assumption of &#8220;physical access control&#8221; and &#8220;trusted paths&#8221;&#8230;</p>
<p>But now we have to deal with the likes of laptops and smart devices the &#8220;physical access control&#8221; model is clearly broken and only now are people waking up to the fact that the &#8220;big iron&#8221; security model of &#8220;physical access control&#8221; does not apply any more&#8230;</p>
<p>The upside is that now unlike back before the 90&#8217;s we have the hardware resources to deal with the issue. But the hard won expertise of the 60&#8217;s and 70&#8217;s is long since retired or deceased and the vital papers are scattered in dust covered boxes in peoples lofts and garages and old archives and dark basements where nobody goes any longer.</p>
<p>Many of the papers were restricted or higher security rating paid for by various Governments who have long since tucked them away in locked archives where they probably won&#8217;t see the light of day untill after the ideas have been re-invented.</p>
<p>In many respects our Governments have become like the Holy Roman Church, jealously hiding information and burning heretics who try to get the message out. But history tells us they are fighting a losing battle. Whilst they might be able to control &#8220;ideas before their time&#8221; these ideas will happen to others when their time comes, and it is obvious there is a problem that needs to be solved.</p>
<p>We can see this actually happening currently but there is still the question of the effect of those Layer 8 and above issues pushing down. We saw in the past Crypto was in effect outlawed (it&#8217;s use even carried the death penalty in many countries and still does). As I&#8217;ve said before the game has moved on the likes of the NSA et al are playing with protocols and standards that become engrained and difficult to change or replace.</p>
<p>But the likes of the DOD have woken up to the fact that not only has the game changed but the &#8220;bat and ball&#8221; have been taken away from them.</p>
<p>The Gulf in security I&#8217;ve mentioned is now hurting the DOD and they are actually putting their hand in their pocket to get industrial and academic researchers to come up with ways to close it down, if it can (which I don&#8217;t think it can in a hard assured way).</p>
<p>COTS technology is here to stay, not just in the private sector but all the public sectors including all areas of the Government and thus military, diplomatic and intelligences services. The old days of government contracts to build secure systems are long gone and won&#8217;t come back in the way they once were. This is simply because the Western Nations have let the technology ball drop and those in the Eastern nations have taken it back to play on their home turf.</p>
<p>Thus what to do?</p>
<p>Well what might happen is the development of &#8220;key components&#8221; on home turf. That is to use what little fabrication is available in Western Nations to develop silicon that sits as guardians in the system controling information by segregating the untrusted parts and how information flows between them.</p>
<p>Will such systems be developed I suspect the answer is yes, simply because trying to extend security down into the memory layer is a difficult task all the current ideas about &#8220;tagging&#8221; memory also fail to methods that are known to exist in this security gulf. And if you think about it to be of use still DMA has to be able to change those tags&#8230;</p>
<p>As I&#8217;ve indicated in the past one of the ideas behind &#8220;Prisons-v-Castles&#8221; is &#8220;probablistic security&#8221; that is you assume you just won&#8217;t be able to close the security gulf with hardware solutions you will need to find some other way to mitigate untrusted hardware.</p>
<p>The question that is arising is, &#8216;Is the computing industry ready to grab this thorny branch of how to make untrusted components work in a trusted way? or continue to ignore it?&#8217;.</p>
<p>I think it can be done and I see from one of your comments on another thread that you are thinking about it. Well I should issue a health warning, that the idea is like a wart, in that not only does it grow on you, the more you scratch it the faster it grows ðŸ˜‰</p>
<p>But all that said I still like the basic idea behind TRESSOR, it does what it says on the tin, the problem is that it is not the basic design of TRESSOR tha is wrong it&#8217;s the basic design of the CPU that is at fault. If Intel make minor changes to the CPU design such that they add &#8220;write only registers&#8221; to the CPU to do the crypto then TRESSOR-Hunt would not work as changing the memory irrespective of how would not alow the KeyMat to be read back out of the CPU. It is not as though such write only registers are unknown in CPU designs.</p>
<p>Also with regards to using TPM for FDE logically it should not push KeyMat back to the CPU, the way it should work is the CPU pushes an identifier and passphrase etc into the TPM. The TPM then sets up it&#8217;s internal crypto to use the key coresponding to the identifier. The KeyMat thus stays inside the TPM chip and the CPU funnels data for the HD through the TPM which acts as the guardian sitting on the information flow, which is in effect what the NSA IME does. So neither the CPU or system memory gets to see the KeyMat after it&#8217;s loaded into the TPM device.</p>
<p>But can the KeyMat be moved across system buses that could be probed without it mattering?</p>
<p>The simple answer is yes, provided both ends of the communication can generate sufficient entropy then there are known protocols for the two ends to create a shared secret with their inter communication being fully monitored.</p>
<p>Such protocols can and have been built into smart cards, thus designing and making your own IME is possible and attacks on the system CPU and Memory won&#8217;t alow access to the KeyMat.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189601">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189601">
						January 6, 2013 1:07 PM					</a>

				</p>

				<p>&#8220;Will such systems be developed I suspect the answer is yes, simply because trying to extend security down into the memory layer is a difficult task all the current ideas about &#8220;tagging&#8221; memory also fail to methods that are known to exist in this security gulf. And if you think about it to be of use still DMA has to be able to change those tags&#8230;&#8221;</p>
<p>That&#8217;s why IOMMU&#8217;s were invented. Intel and (i think) POWER already have them. I think some validated reference designs, put in public domain, that could be adapted to other processor architectures is a nice NSF grant opportunity. I think we&#8217;ll still see such issues in very constrained embedded systems, though.</p>
<p>&#8220;The question that is arising is, &#8216;Is the computing industry ready to grab this thorny branch of how to make untrusted components work in a trusted way? or continue to ignore it?&#8217;.&#8221;</p>
<p>Actually, you could say they&#8217;ve been doing that all along. Almost everything they produce is untrusted software trying to perform trusted functions, with untrust[worthy] security software enforcing behavioral policies on untrust[worthy] apps. You could say there&#8217;s a sane way to meld trusted/untrusted parts and an utterly ridiculous way supported by market/user ignorance. They&#8217;ve taken the route we&#8217;d predict.</p>
<p>As for good melding you&#8217;re talking about, it&#8217;s been going on in a very limited way in academic circles (and some products) for decades. I&#8217;ve been seeing more work than usual in past 5 years than 90&#8217;s, although it&#8217;s still plenty re-invention. I saw a new solution for stopping buffer overflows, for instance. They would have been more productive if they Google&#8217;d MULTICS, then used grant money on something NEW.</p>
<p>&#8220;I think it can be done and I see from one of your comments on another thread that you are thinking about it. Well I should issue a health warning, that the idea is like a wart, in that not only does it grow on you, the more you scratch it the faster it grows ;-)&#8221;</p>
<p>You must have forgot I&#8217;ve been obsessing over this stuff as much as you for years now, incl. on this blog. I know more now than I ever did. Yet, the goal seems more difficult now than ever. I&#8217;ve almost burned out trying to fight the momentum of market and industry. It&#8217;s why I&#8217;m in favor of legal incentives: the market doesn&#8217;t [usually] produce high quality or security on its own. Our hope is in seeing how this worked with Orange Book mandate leading to B3/A1 systems &amp; recent DO-178B/DO-178C leading to dozens of high[er] assurance offerings.</p>
<p>&#8221; If Intel make minor changes to the CPU design such that they add &#8220;write only registers&#8221; to the CPU to do the crypto then TRESSOR-Hunt would not work as changing the memory irrespective of how would not alow the KeyMat to be read back out of the CPU. It is not as though such write only registers are unknown in CPU designs.&#8221;</p>
<p>I had never heard of write-only registers. It is known that processors in the past had more innovative hardware with respect to security. Intel also had processors with advanced security models. However, the market demanded the other ones. I can&#8217;t really blame Intel: they continue adding security features wherever customer demand justifies it, incl. IOMMU &amp; record speed TRNG. Incentives&#8230;</p>
<p>The real secure processor designs right now are Aegis, SecureCore, and SecureME. The people looking into randomized caches have moved onto partitioned caches for performance and simplicity. The latter isn&#8217;t so bad an idea as TCB&#8217;s are usually divided into trusted and untrusted. It&#8217;s not enough for isolation between untrusted apps, though.</p>
<p>&#8220;Also with regards to using TPM for FDE logically it should not push KeyMat back to the CPU, the way it should work is the CPU pushes an identifier and passphrase etc into the TPM. The TPM then sets up it&#8217;s internal crypto to use the key coresponding to the identifier. The KeyMat thus stays inside the TPM chip and the CPU funnels data for the HD through the TPM which acts as the guardian sitting on the information flow, which is in effect what the NSA IME does. So neither the CPU or system memory gets to see the KeyMat after it&#8217;s loaded into the TPM device.&#8221;</p>
<p>I have to agree with Wael in that TPM&#8217;s aren&#8217;t made for that. TPM&#8217;s are designed to seal secrets to a certain system state. This tech is used to bootstrap software security solutions. The superior method you are mentioning is a crypto coprocessor. It may be a certified cryptochip or FPGA, but it keeps the secrets while doing the crypto heavy lifting. This was used in the LOCK platform I occasionally mention, along with hardware reference monitor for memory access.</p>
<p>The main reason they don&#8217;t do that is cost and legacy. TPM&#8217;s, Wael tells me, are ridiculously cheap. They also don&#8217;t really change anything else about how the computer works. That probably makes integration incredibly easy. So, the TPM economic model seemed to be: we have a product that is useful to those who want it, invisible to those that don&#8217;t, easy to integrate, standardized and doesn&#8217;t affect your costs.</p>
<p>I still think, with help from hardware guys, we could rig up a better TPM than TPM using crypto-coprocessor like you (we) want. I was considering using one of the Freescale PPC boards with security enhancements to make it simpler. (Also, most crypto comes with x86 or PPC code.) Wire that joker in through memory bus, PCI bus or something. Offload some TCB to it. We&#8217;re set against regular attackers.</p>
<p>&#8220;The simple answer is yes, provided both ends of the communication can generate sufficient entropy then there are known protocols for the two ends to create a shared secret with their inter communication being fully monitored.&#8221;</p>
<p>Definitely. NSA Type 1 devices support this now, I think. I know they have the Firefly protocol for key exchange. Many commercial cryptochips have features needed to do this.</p>
<p>&#8220;Such protocols can and have been built into smart cards, thus designing and making your own IME is possible and attacks on the system CPU and Memory won&#8217;t alow access to the KeyMat.&#8221;</p>
<p>I should have read the rest of your sentence first. We were thinking on the same page. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189602">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189602">
						January 7, 2013 5:38 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>I know more now than I ever did. Yet, the goal seems more difficult now than ever.</i></p>
<p>Ah ha, you have passed an important step on the path to enlightenment ðŸ˜‰</p>
<p>There is an old story about the various stages of a designer,</p>
<p>When a problem is described to them they say as a,</p>
<p>Young Designer :- No problem, I&#8217;ll get right on it.<br />
Mature Designer :- Hmm I can see some issues, tell me more about your requirments.<br />
Guru :- Hmm I don&#8217;t think you understand what you ask, walk with me awhile.</p>
<p>I&#8217;ve always found the more I know about the surface (froth) of a subject the more I need to know what is below. I&#8217;ts one of the reasons I tend not to try and keep up with trends which are often skipping the surface and frequently based on ill found assumptions. I try instead to get to understand the provable fundementals instead, and then build on those.</p>
<p>Speaking of ill found assumptions you mentioned IOMMUs. Like all MMU&#8217;s they can indead offer increased security but only if used correctly and the majority of the time that&#8217;s the catch.</p>
<p>The problem with an MMU is two fold, the first is what controls it, the second is the issue of the memory that holds the page translation tables.</p>
<p>With single CPU systems there is no choice, the CPU controls the MMU and it&#8217;s control busses form part of the CPU side memory or IO map. Usually to make things easy with virtual memory handling, the MMU is either at a hard CPU side address or put in the IO map at a hard address. Likewise the page translation tables.</p>
<p>Obviously whilst this makes things easier for the system designer and kernel developers it makes a hard target for attackers&#8230;</p>
<p>If there is a design flaw in the kernel then an attacker can get either at the MMU control lines or at the page translation tables in memory, at which point it&#8217;s game over. As I&#8217;ve indicated up this thread there are various ways both above and below the CPU level in the stack by which such attacks are possible.</p>
<p>Unfortunatly this problem often get&#8217;s carried over into multiple CPU systems, that for various reasons give kernel level access to any of the CPUs.</p>
<p>My prefered solution is that none of the user side CPU&#8217;s or for that matter the main kernel CPU(s) have any access to the MMU control lines or memory holding the page translation tables.</p>
<p>That is the security hypervisor controls all MMUs and the page translation tables are stored in it&#8217;s private memory area that is entirely seperate from user/kernel memory. That way an attacker cannot see the MMU or it&#8217;s tables let alone make any changes directly. This issolation can be further improved by making the hypervisor a Harvard architecture and ensuring the code base is a simplified state machine (all of which we have discussed in the past).</p>
<p>Providing the hypervisor is correctly designed it takes compleat control of memory provision and memory is provided to each user process based on the hypervisor security criteria. This enables the memory allocatio process to be massivly simplified thus reducing complexity and code and thus bugs and attack vectors. The biggest issue becomes that of priority queing to avoid locks for essential processes which can be done by a simple and robust heap mechanism that recognises not just priority but dependancy.</p>
<p>With regards write only registers they go back to the early days of ALU design pre bit-slice processor, and the micro coded state machines that turned them into usable CPUs [1].</p>
<p>A write only register is in effect a D-Type latch, a read write register is the D-Type latch and a tristate buffer feeding back the latch ouput back to the data bus at the input along with some arbitration logic for read and write opperations.</p>
<p>Obviously there are considerably less gates and metalisation with a write only latch thus they were prefered by the resource limited hardware designers. The problem was with writing code, with a well developed state machine such as used in the CPU state machines the microcode had no reason to readback an address or data latch etc. Not so general computer application level software developers their inability to take responsability for maintaining accurate state information within their programs ment reading back control registers and the like became a requirment [2].</p>
<p>As for TPMs yes Wael is right many are of limited functionality at best, and thus have failings that alow people to get around their supposed functionality.</p>
<p>What we need along with IOMMUs is what you might consider to be IOIMEs that is each IO channel is in effect a stream that has an IME sitting as a guardian astride it. The TPM would work as I described and would logicaly be built within the IME or use an entirely seperate channel to get KeyMat from a fill device such as an appropriat EAL smart card.</p>
<p>As @ RobertT has noted as well as Bruce, whilst we have adiquate crypto alogrithms these days it&#8217;s the KeyMat handling that lets us down badly and for some reason it&#8217;s another area where there is a large gulf in security.</p>
<p>And before anybody says PKI, it&#8217;s ill thought out and thus brings as many if not more problems to the table than it solves. Like code signing and other trusted initiatives PKI is based on a number of assumptions that at best only just hold with a following wind. For instance consider the case of initial pairing of Alice and Bob, how does Alice know she is actually talking to directly to Bob and not just some Man In The Middle bridge device that has it&#8217;s own PK Cert that claims it&#8217;s Bob which Bob is inadvertantly going through (think issues with certain Governments and Fake certificates to catch disident Facebook user etc). You still end up with the need for an initial trusted path between Alice and Bob to transfer their respective public keys, and further this should preferably be &#8220;out of band&#8221; signaling.</p>
<p>[1] For those that have never seen the logic design of an ALU look up a 74181 or any of the later 2900 series bitslice processors from AMD, I won&#8217;t bother giving ECL parts as they realy are difficult to get data sheets on and can twist your mind trying to understand the whys and wherefors of them.</p>
<p>[2] I suspect that some people will think I&#8217;m being a little harsh on code cutters who due to the deficiences of other code cutters to accuratly maintain state, have to go out and find it for themselves, especially when dealing with the likes of exceptions. I&#8217;m not, it&#8217;s the poor design of the software that is to blaim, if they had to maintain state in the program then the program dessign would be more rubust and in all probability less complex and less bug ridden. For some reason nearly all programers are &#8220;optomistic&#8221; in that they assume exceptions are not going to happen and thus state does not need to be kept. Thus when an exception happens either or both data is lost and the program crashes, neither of which are good especialy when it&#8217;s the brakes of your car the program is controling&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189603">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189603">
						January 7, 2013 12:55 PM					</a>

				</p>

				<p>@ Clive Robinson, @ Nick P</p>
<blockquote><p> As for TPMs yes Wael is right many are of <b>limited functionality</b> at best, and thus have failings that alow people to get around their supposed functionality. </p></blockquote>
<p>I didn&#8217;t say that! I am just saying they are designed with a price point in mind to serve a specific purpose. They act as the root of trust for a computing device. If you think of them as a crypto-processor (or accelerator), then of course they are very limited.</p>
<p>Here is a cut and paste from the faq on TCG site:</p>
<p><i> Do the TPM specifications require a certain cryptographic algorithm (DES, AES, etc.)?<br />
Yes. They require RSA SHA-1 and HMAC. AES is not required in v1.1 of the specification, but may be required in future versions. The use of symmetric encryption is not required in the TPM. TCG will continue to evaluate developments in cryptography.<br />
How do TPMs compare with smart cards or biometrics?<br />
They are complementary to the TPM, which is considered a fixed token that can be used to enhance user authentication, data, communications, and/or platform security. A smart card is a portable token traditionally used to provide more secure authentication for a specific user across multiple systems, while biometrics are providing that functionality in an increasing number of systems. Both technologies can have a role in the design of more secure computing environments.<br />
What role does Trusted Computing and the TPM play in authentication?<br />
The TPM provides secure storage and key generation capabilities, similar to other hardware authentication devices, so it can be used to create and/or store both user and platform identity credentials for use in authentication. The TPM can also protect and authenticate user passwords, thereby providing an effective solution of integrating strong, multifactor authentication directly into the computing platform. With the addition of complementary technologies such as smart cards, tokens and biometrics, the TPM enables true machine and user authentication. </i></p>
<p>And here is a brief of the &#8220;purpose&#8221;, copied from TCG portal:</p>
<p><i><br />
Systems based on Trusted Computing:</p>
<pre><code>Protect critical data and systems &lt;b&gt;agains&lt;/b&gt; a variety of attacks
Enable secure authentication and strong protection of unlimited certificates, keys, and passwords that otherwise are accessible
Establish strong machine identity and integrity
Help satisfy regulatory compliance with hardware-based security
Cost less to manage, removing need for expensive tokens and peripherals &lt;/i&gt;
</code></pre>
<p>Seems they have a typo &#8212; if any TCG contributing members are reading this, please fix the &#8220;typo&#8221; &#8212; Against, not agains ðŸ™‚</p>
<p>Refer to <a href="http://www.trustedcomputinggroup.org" rel="nofollow ugc">http://www.trustedcomputinggroup.org</a> for more information. You will need some time going through a few thousand pages of specifications ðŸ™‚</p>
<p>Finally, @ Clive Robinson&#8230;<br />
Did you mention Castles-V-Prisons again? ðŸ™‚</i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189604">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189604">
						January 7, 2013 12:59 PM					</a>

				</p>

				<p>@ Wael</p>
<p>Appreciate the reply and information.</p>
<p>&#8220;Did you mention Castles-V-Prisons again?&#8221;</p>
<p>He did&#8230; don&#8217;t get him started&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-189605">

			<div class="comment by-mikey ">

				<p class="commentcredit">

					<span class="commenter">Mikey</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189605">
						January 16, 2013 11:34 PM					</a>

				</p>

				<p>As a lurker of many, many years I just want to add that I think one of the best things about this site is not just the articles or opinions that Bruce posts; but the discussions in the comments.</p>
<p>I think I&#8217;ve learnt more from Clive Robinson, Nick P,  et al, than from most of the textbooks and reference guides collecting dust on my bookshelf that I used to pick up my alphabet soup of certs and qualifications.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-189607">

			<div class="comment by-patrick-molinelli ">

				<p class="commentcredit">

					<span class="commenter">Patrick Molinelli</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/#comment-189607">
						October 31, 2014 7:17 PM					</a>

				</p>

				<p>Mr. Schneier,</p>
<p>I am a student at University of Maryland College, about to get my degree in CyberSecurity. The whole field of forensics and hacking is fascinating to me, and continues to be more exciting as time progresses.</p>
<p>I have read several articles and written a few papers on the forensics of various digital mediums, and just finished reading your article.</p>
<p>I was wondering&#8230;.if a computer or laptop is bit-locker encrypted, and cleanly shutdown, and the individual never hibernates the system, uses new DDR3 memory, and has a very lengthy complex password that is not saved on an external medium or saved onto a file on the computer or laptop in question&#8230;..would this be the forensic investigators nightmare?</p>
<p>It seems most methods involve pulling information from a running computer, or rely on pulling data from the memory from a system that was hibernated, or shutdown incorrectly, etc.</p>
<p>I saw that there was a study done that showed certain information like passwords were stored for a short time in the ram for older types of memory, but that the newer memory is not susceptible to this type of cold boot attack.</p>
<p>Respectfully,</p>
<p>Patrick Molinelli</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/12/breaking_hard-d.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/12/breaking_hard-d.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F12%2Fbreaking_hard-d.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/12/breaking_hard-d.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4624' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/12/public_shaming.html" rel="prev">â† Public Shaming as a Security Measure</a>		<a href="https://www.schneier.com/blog/archives/2012/12/becoming_a_poli.html" rel="next">Becoming a Police Informant in Exchange for a Lighter Sentence â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
