<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Prepaid Electricity Meter Fraud - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Prepaid Electricity Meter Fraud Comments Feed" href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3571" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3571' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F09%2Fnew_prepaid_ele.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F09%2Fnew_prepaid_ele.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3571 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3571" class="post-3571 post type-post status-publish format-standard hentry category-uncategorized tag-cons tag-fraud tag-keys tag-scams tag-utilities">

	<div class="article">

		<h2 class="entry">Prepaid Electricity Meter Fraud</h2>
		<p><a href="http://www.eveningtimes.co.uk/news/editor-s-picks/thousands-in-city-conned-by-cheaper-energy-scam-1.1053149">New attack</a>:</p>
<blockquote><p>Criminals across the UK have hacked the new keycard system used to top up pre-payment energy meters and are going door-to-door, dressed as power company workers, selling illegal credit at knock-down prices.</p>
<p>The pre-paid power meters use a key system. Normally people visit a shop to put credit on their key, which they then take home and slot into their meter.</p>
<p>The conmen have cracked the system and can go into peopleâ€™s houses and put credit on their machine using a hacked key. If they use this, it can be detected the next time they top up their key legitimately.</p></blockquote>
<p>The system detects the fraud, in that it shows up on audit at a later time.  But by then, the criminals are long gone.  Clever.</p>
<p>It gets worse:</p>
<blockquote><p>
Conmen sell people the energy credit and then warn them that if they go back to official shops they will end up being charged for the energy they used illegally.</p>
<p>They then trap people and ratchet up the sales price to customers terrified they will have to pay twice Â­ something Scottish Power confirmed is starting to happen here in Scotland.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cons/" rel="tag">cons</a>, <a href="https://www.schneier.com/tag/fraud/" rel="tag">fraud</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/scams/" rel="tag">scams</a>, <a href="https://www.schneier.com/tag/utilities/" rel="tag">utilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html" rel="bookmark">Posted on September 21, 2010 at 1:42 PM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html#comments">65 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html" data-title="Prepaid Electricity Meter Fraud" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-145495">

			<div class="comment by-sweeney ">

				<p class="commentcredit">

					<span class="commenter">Sweeney</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145495">
						September 21, 2010 2:06 PM					</a>

				</p>

				<p>Makes the old way of putting the pennies into the gas meter look good!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145496">

			<div class="comment by-atis ">

				<p class="commentcredit">

					<span class="commenter">atis</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145496">
						September 21, 2010 2:24 PM					</a>

				</p>

				<p>Recently I have been visiting UK and found those power meters surprising.</p>
<p>They had paper cards with magnetic strip, as I understand card is used only once because place I stayed had several of them laying around power meter.</p>
<p>It would be possible to have cards cloned to another used card, so apparently card should contain only ID and meter should have some sort of closed circuit communications back to power company.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145497">

			<div class="comment by-harrow ">

				<p class="commentcredit">

					<span class="commenter">Harrow.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145497">
						September 21, 2010 2:40 PM					</a>

				</p>

				<p>@Sweeney: (Makes the old way of putting the pennies into the gas meter look good!)</p>
<p>Is that what that was?  My father told me it was my piggy bank!</p>
<p>-Harrow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145498">

			<div class="comment by-erik-neu ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mondegreen2.blogspot.com/' rel='external nofollow ugc' class='url'>Erik Neu</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145498">
						September 21, 2010 3:05 PM					</a>

				</p>

				<p>Isn&#8217;t the &#8220;It Gets Worse&#8221; part the vector for catching the criminal? When they come back to extort more money?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145499">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">Jack</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145499">
						September 21, 2010 3:06 PM					</a>

				</p>

				<p>Another possibility: the hack works, the electricity company can&#8217;t detect it and this story is a social countermeasure.</p>
<p>Here in the UK we have a TV license, a mandatory annual fee for any household with a TV. We have long been warned that there are &#8220;detector vans&#8221; capable of determining whether a TV is being used in a property. The BBC have never explained how they detect a TV and have been exempted from the Freedom of Information Act on the grounds that revealing what is actually inside the van would diminish the deterrent effect. A cynical man might suggest that the detector van is something of a hollow threat.</p>
<p><a href="http://www.theregister.co.uk/2008/10/27/beeb_tvdetector_secrets/" rel="nofollow ugc">http://www.theregister.co.uk/2008/10/27/beeb_tvdetector_secrets/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145500">

			<div class="comment by-john-hardin ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.impsec.org/~jhardin/' rel='external nofollow ugc' class='url'>John Hardin</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145500">
						September 21, 2010 3:13 PM					</a>

				</p>

				<p>@Jack: They detect the purr&#8230;</p>
<p><a href="http://orangecow.org/pythonet/sketches/fish.htm" rel="nofollow ugc">http://orangecow.org/pythonet/sketches/fish.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145501">

			<div class="comment by-somebloke ">

				<p class="commentcredit">

					<span class="commenter">somebloke</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145501">
						September 21, 2010 4:42 PM					</a>

				</p>

				<p>From the linked report:</p>
<p>&#8220;It must be made clear that using these illegal devices is a criminal offence.</p>
<p>Users may not fully appreciate this but should ask themselves â€“ if something seems like to good a deal it most probably is.&#8221;</p>
<p>Surely that&#8217;s a typo?!?</p>
<p>Technical details would be useful. What constitutes a &#8216;hacked key&#8217;? There appears to be little technical detail (presumably so that everyone else doesn&#8217;t start doing it themselves!)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145502">

			<div class="comment by-gary ">

				<p class="commentcredit">

					<span class="commenter">Gary</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145502">
						September 21, 2010 5:51 PM					</a>

				</p>

				<p>TV detection vans work on the basis of Van Eck phreaking. Wikipedia suggests they work on LCD as well as CRT, but doesn&#8217;t mention plasma TVs.</p>
<p>In practice though, they often just went around to places without a TV licence on the basis that most houses have a TV.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145503">

			<div class="comment by-askme233 ">

				<p class="commentcredit">

					<span class="commenter">askme233</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145503">
						September 21, 2010 7:13 PM					</a>

				</p>

				<p>John Hardin FTW.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145504">

			<div class="comment by-imperfect-citizen ">

				<p class="commentcredit">

					<span class="commenter">Imperfect Citizen</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145504">
						September 21, 2010 7:15 PM					</a>

				</p>

				<p>@John Hardin LOL!!<br />
It could be worse, at least they aren&#8217;t hell&#8217;s grannies going door to door beating people up for tea money and yarn for the crochet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145505">

			<div class="comment by-caf ">

				<p class="commentcredit">

					<span class="commenter">caf</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145505">
						September 22, 2010 12:47 AM					</a>

				</p>

				<p>Jack&#8217;s explanation has the ring of truth about it.  Consider: If the power meters were &#8220;online&#8221; devices, then the hack wouldn&#8217;t work; ergo the power meters are likely offline devices.  If they&#8217;re offline devices, then there doesn&#8217;t appear to be a vector to detect the attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145506">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145506">
						September 22, 2010 1:58 AM					</a>

				</p>

				<p>Very poor security controls + offline operation = something less than newsworthy for security engineers and admins. Simply following best practices could have beaten this scheme. One such best practice is having offline devices authenticate data using a digital signature and a hard-coded public key. There are so many cheap crypto-capable boards out there that there&#8217;s little excuse these days, especially considering the costs of compromise. I think that simple public-key trick would have defeated schemes like this entirely. A processor like MIT&#8217;s Aegis could also help in similar future scenarios.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145508">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145508">
						September 22, 2010 2:47 AM					</a>

				</p>

				<p>@NickP<br />
 I have not read all the details of the hack BUT for offline payment cards it is very difficult to get around the need for a single shared secret. even if it is simply for mutual authentication.</p>
<p>It is true that the stored data could be encrypted with a two key crypto system but this does not necessarily prevent the hack because it appears they are selling / using a  card based upon an official original card.</p>
<p>The easiest hack of this kind is to simply prevent the on chip EEPROM being written, so  they buy an official card, destroy the EEPROM write circuit, and use it on lots of meters. hence the need to go door to door. It could also be a cloned card, but that is a little harder, because you now need to get the cloned chips manufactured.<br />
 Since the meters cannot communicate with each other, they have no way of knowing that the cloned card is being used in multiple locations.</p>
<p>Ideally the meter should not add the value until it verifies that the card has subtracted the value (i.e. decremented the on chip EEPROM) but some simple changes to the code can make this communication happen with the RAM rather than the EEPROM. (BTW Most modern payment cards can prevent this by encrypting RAM data differently from EEPROM data)</p>
<p>I assume that the end user will not be able to add value to the cloned card (hundreds of people turning up with the same card ID is a little obvious), so they would need to officially add vale to their old card which would raise the issue &#8220;how they got the last $50&#8221; I assume the card has a record of the meter reading and corresponding last payment. The error probably gets picked up the second value add after the hacked card is used.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145509">

			<div class="comment by-mike-harrison ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.utiliflex.com' rel='external nofollow ugc' class='url'>Mike Harrison</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145509">
						September 22, 2010 2:57 AM					</a>

				</p>

				<p>I&#8217;m in the prepaid electricity industry, but not in Europe. We typically use  STS/IEC-62055-41 token based meters as well as AMI.  No actual details of what happened, so I can only make some guesses:</p>
<p>It&#8217;s a &#8220;two way&#8221; token carrier key. At some point you take your key back to a vending point, which sends a total kWh reading upstream. They see your meter shows a usage of X, you have only paid for Y, you owe the difference. Detecting the fraud is easy, and may include a signature (ID) of the original token generation if it is a clone of some valid master key. Most meters of this type can also export entered tokens, which can be checked against the master system to make sure they match. Such tokens are typically encrypted and valid only for a specific meter and date range, although exceptions exist and may be the exploit.</p>
<p>Two-way communications (aka AMI) meters are more expensive and have communications infrastructure costs beyond &#8220;token meters&#8221;, and have their own issues/attack vectors. They are not a cure-all, but they do address other issues. The issue here is unique in &#8220;non-technical losses&#8221; in that normal decent good customers that didn&#8217;t really think they were doing anything wrong ended up in trouble.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145510">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145510">
						September 22, 2010 4:10 AM					</a>

				</p>

				<p>&#8220;In practice though, they often just went around to places without a TV licence on the basis that most houses have a TV.&#8221;</p>
<p>Never had a TV, get hassled by door-to-door warden types on a fairly regular basis but have never seen a van.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145511">

			<div class="comment by-ayo ">

				<p class="commentcredit">

					<span class="commenter">Ayo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145511">
						September 22, 2010 4:49 AM					</a>

				</p>

				<p>People could top up illegally and then &#8216;misplace&#8217; their cards and have the energy company issue another card as replacement. Breakdowns like this always happen when appropriate procedures/processes are not implemented or people are given the incentive to bypass implemented processes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145512">

			<div class="comment by-autolykos ">

				<p class="commentcredit">

					<span class="commenter">Autolykos</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145512">
						September 22, 2010 6:58 AM					</a>

				</p>

				<p>The trick with those Detector-Trucks is old &#8211; older than TV even. The Nazis drove around with trucks that had antennas on top and claimed they could find out if someone was listening to foreign radio. Quite a lot of people probably believed this, so the broadcasting companies also found this trick useful (the German GEZ also does this &#8211; oh the irony).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145513">

			<div class="comment by-sebastian-kubeck ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.jroller.com/sebastianKuebeck/' rel='external nofollow ugc' class='url'>Sebastian KÃ¼beck</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145513">
						September 22, 2010 7:58 AM					</a>

				</p>

				<p>Not terribly surprising.<br />
See Ross Anderson&#8217;s and Shailendra Fuloria&#8217;s paper (from July 2010) on the subject:</p>
<p><a href="http://www.lightbluetouchpaper.org/2010/07/26/who-controls-the-off-switch/" rel="nofollow ugc">http://www.lightbluetouchpaper.org/2010/07/26/who-controls-the-off-switch/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145514">

			<div class="comment by-nobodyspecial ">

				<p class="commentcredit">

					<span class="commenter">NobodySpecial</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145514">
						September 22, 2010 9:55 AM					</a>

				</p>

				<p>TV detector vans detect the LO frequency in the tv tuner, so don&#8217;t care what kind of display you use.<br />
However a recent BBC program revealed that they only had 8 active vans for the whole country and the triangulation process was very slow. So most of the vans were just dummies that dropped off a bunch of inspectors with a list of addresses of people without a licence &#8211; although the dummy vans had the same antennae on top.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145515">

			<div class="comment by-james ">

				<p class="commentcredit">

					<span class="commenter">James</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145515">
						September 22, 2010 12:34 PM					</a>

				</p>

				<p>Yes, detecting the Local Oscillator is a good way, although it can probably be defeated if you line your house with a metal to create a faraday cage. Clearly this is a bit overkill and I think it will be cheaper just to pay.<br />
I do believe the vans also go about with luck. Lets face it, most people have TVs and those who don&#8217;t pay have a higher likelyhood they&#8217;re stiffing the government.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145516">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145516">
						September 22, 2010 4:47 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>Good info. I think I wasn&#8217;t clear about how my scheme would be used, so I&#8217;ll give some specifics for you to review. The private key would be held by the utility company to sign a particular credit. The public key would be in the meters, probably with one of the cheap crypto-chips protecting &amp; using it. The physical key would simply contain a digitally signed piece of data with any critical information: the meter that should receive it; the owner&#8217;s ID, if any; the amount of electricity purchased; timestamp. Modifications to the physical key wouldn&#8217;t help, as the signature and data wouldn&#8217;t match. I would probably make the input non-DMA, as well. This makes the meter itself and the private key the target, with the meter more likely to be targeted.</p>
<p>At this point, one can use tamper-resistant design with tight integration of control and security functions. I&#8217;m not saying it would be &#8220;secured,&#8221; but might be made harder to attack. But my scheme to digitally sign the credits and verify them at the meter should beat any attacks on the physical key because it&#8217;s treated as an untrusted storage medium. What do you think of this scheme with the extra detail?</p>
<p>Also, I&#8217;m a system designer who lets other people do low-level hardware implementation details. This means I welcome any insights on securing the meter from attack. I&#8217;m also curious if it would be possible to integrate control of the electricity and the security functions on the same chip. I guess I&#8217;m looking for a way to keep the most basic hardware hackers from bypassing the security function and just telling the meter: give them electricity. Any ideas?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145517">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145517">
						September 22, 2010 10:28 PM					</a>

				</p>

				<p>Problems with your proposal<br />
 1) you can&#8217;t limit the customer to using ONLY the initially issued smart card that is associated with their meter. Basically people loose these things, renters move and take cards with them. So EVERY offline  payment system,  MUST work with a generic card purchased at an appropriate store.</p>
<p>2) Because of the requirements in 1) a cloned card with a certain credit must work everywhere. The details of the crypto (two key, single key, elliptic, whatever are irrelevant), because the perp does not alter the information on the card, to create value, rather he exactly copies the good cards information, including the encrypted value.<br />
 Usually to do this exact copy of a card, the hacker needs to gain direct write access to the EEPROM using a test mode.  and needs to change the cards own ID to match the cloned cards ID.</p>
<p>As I said earlier, the easiest hack is to buy a good card and just to kill the EEPROM write circuits. This is detectable / correctable at the system level, but that assumes the meter system person actually knows how to correctly program secure software&#8230;..</p>
<p>3) Fixes. All fixes for this problem require that a valueless card be inserted into the electricity meter and have the meter sign the cards info so that the value subsequently added can be uniquely created for this meter. Unfortunately this is a two step procedure for the end customer and is is therefore unpopular. An alternative is to have the meter display an ID which can be written down and entered when the credit is purchased. Unfortunately this puts people in the crypto loop, so this system is prone to error.</p>
<p>Other fixes:<br />
 If the generic card has a serial number, which cannot be faked, than even a hacker with access to the correct cards cannot clone a card.  Most payment card ID&#8217;s have lock bits that theoretically prevent them being reprogrammed BUT&#8230;</p>
<p>New solutions:<br />
To achieve this &#8220;unfakeable&#8221; card ID payment card  makers are trying to use fundamental physical differences in the construction of the chips to create unique ID&#8217;s. The hackers get around this by changing their clone cards program to query a ROM location for the ID rather than reading the card ID, so the ROM gets programmed with the unfakeable ID of a good card, and so the game continues&#8230;</p>
<p>Ultimately the security of the card / payment system depends on protecting a secret, it might be a &#8220;key&#8221; or a methodology, but IMHO the best security ultimately rests in the undocumented steps that protect the stored key information.</p>
<p>Tamper resistance:<br />
All new electricity meters have tamper resistance built-in, usually this is done by sensing both Active and Neutral current and comparing the two.</p>
<p>Unfortunately without a return comms channel, the meters knowledge that it has been tampered with is of very little value too the electricity provider.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145518">

			<div class="comment by-ac2 ">

				<p class="commentcredit">

					<span class="commenter">AC2</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145518">
						September 23, 2010 12:19 AM					</a>

				</p>

				<p>Question, why are energy prices so bloody high in the UK that make people easy prey for such schemes?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145519">

			<div class="comment by-wil ">

				<p class="commentcredit">

					<span class="commenter">Wil</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145519">
						September 23, 2010 3:34 AM					</a>

				</p>

				<p>regards detector vans tangent: read Spycatcher, it discusses how MI5 discovered you could even detect what frequencies a receiver was listening too by blasting and listening too the howl</p>
<p>its all tempest, so yes detector vans do work.  If they are used as much as their owners would like us to imagine is another thing, of course.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145520">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145520">
						September 23, 2010 10:35 AM					</a>

				</p>

				<p>@ RobertT, Nick P,</p>
<p>The problem boils down to a trade off in what can be done and the costs. The fact that it&#8217;s an off line system means it&#8217;s always going to be a bust and there is no way to stop it.</p>
<p>If you think about it, the simplest way around Smart meter security is not to use the silly thing in the first place, just appear to be using it.</p>
<p>That is you put a small load on the consumer side of the meter, then disconnect the meter from the consumer unit (fuse board). You then find an appropriate point in the distribution side to take a spur to your consumer unit&#8230;</p>
<p>The utility company can with time detect this due to taking the total load at the substation and comparing it to the total readings from all the meters (but low usage used to get missed in the +-5% meter acuracy).</p>
<p>That is the simplest bottom line attack you have to defend against no mater what you do to the meterit cannot currently be stoped.</p>
<p>The next step up for the attacker and virtualy undetectable by the utility company is to drill a hole through a party wall and spur of your neighbours consumer ring. That way the meter readings tie up. Your neighbur will notice it if you are silly and &#8220;cain it&#8221; but not otherwise.</p>
<p>In this case the utility company does not care one jot as they are getting the money due&#8230;</p>
<p>So the only thing of interest to the utility company is what the price of the &#8220;secure meter&#8221; is over the cost of the &#8220;insecure meter&#8221; and how does it compare to the losses from bypassing the meter.</p>
<p>That would be the bottom line if it was not for Bl**dy Stupid Politicos. They want smart meters so they can jump on the &#8220;green band wagon&#8221; without speending any tax money (as they&#8217;ve blown it all on bribing voters and schommozing the banks).</p>
<p>So the master plan is to force the meters in by legislation and get the poor consumer to pay for it.</p>
<p>This is a massive eye wateringly bright big fat mouth watering wet dream for the utility companies. Because you dear consumer will have to pay for a meter you most certainly don&#8217;t want and the utilities will profit by it with multiple tarrifs with all sorts of different rates and confusion.</p>
<p>Think how mobile phone companies exploit those who just want a simple service, as the lowest level of what the utilitis hope to achive, all in the name of &#8220;saving the planet&#8221;. And you won&#8217;t have a choice because if you object to the plan you are obviously a &#8220;filthy no good planet wreaker hell bent on consuming the scant natural resources for the perverted pleasure of creating polution to poison all the little children etc etc.&#8221;</p>
<p>For the Politicos and the utilities it&#8217;s a certain winner as for us consumers grit your teeth and bend over to have your wallet extracted the hard way without the benifit of either pain killers or lubricant&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145521">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145521">
						September 23, 2010 3:48 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Stealing from the neighbors being the best, but least ethical, of your ideas. The idea can be (and is for some people) extended to water and WiFi.</p>
<p>@ RobertT &amp; Clive</p>
<p>&#8220;1) you can&#8217;t limit the customer to using ONLY the initially issued smart card that is associated with their meter. Basically people loose these things, renters move and take cards with them. So EVERY offline payment system, MUST work with a generic card purchased at an appropriate store.&#8221;</p>
<p>Decent point. I had a hell of a reply for you too. I spent an hour designing an online smart meter system that used signed messages stored on untrusted cards along with a message revocation list at utility side to provide the security with no usability loss for customers. After I wrote up two great systems with tons of capabilities, I came up with a radical idea that seems so good I deleted all the other stuff. My online meter would handle energy credits with excellent security, but in the US I think this radical approach might deserve consideration. (And folks, you saw it here first!)</p>
<p>RADICAL APPROACH I JUST BRAINSTORMED (very abstracted)</p>
<p>In the US, we typically get our electricity turned on, use as much as we like, then pay the bill the next month. We might even get an extra month with penalties. If we don&#8217;t pay enough after a certain period of time, they send a guy to cut it off by physical interaction with the meter. Activation has a delay and requires physical interaction with the meter. This leads me to think of a simpler automated design which doesn&#8217;t [apparently] suffer from credit reuse attacks because it doesn&#8217;t use them, while using an untrusted card to transport critical data. Here&#8217;s the 50 mile overview:</p>
<ol>
<li>The meter denies electricity to the house by default.</li>
<li>User supplies a card that tells the meter to turn on and stay on until a set date and time. (usually 1 or 2 months in future)</li>
<li>After that period, the meter kills the power. (Except to the meter of course ðŸ˜‰</li>
<li>When a user pays their bill, their card is updated with a signed message containing a new cutoff date for their meter.</li>
<li>The user inputs this data to the meter. The meter validates it, then sets the cutoff time to the one on the card.</li>
</ol>
<p>In this system, default deny is used to force authorization. The utility just sends the machine a cutoff date tied via a unique ID to that specific machine. By not adding or removing anything, along with the unique ID, we don&#8217;t have to worry about replay or reuse attacks. Entering that code/card would just further ensure their power was cut off. This system is fundamentally simpler than credit based systems and is compatible with existing US usage and billing methods. What do you guys think about THAT one? Just so original, simple and probably easy to implement. Here it is a bit more precisely.</p>
<p>RADICAL SMART METER SYSTEM SPECIFICATION (offline version)</p>
<p>1A. Meter Requirements<br />
  1-1. Controls flow of electricity into home.<br />
  1-2. Receives input in form of card. (Maybe serial port for field personnel.)<br />
  1-3. Internally possesses a unique meter ID.<br />
  1-4. Validates input by checking format, meter ID and signature.<br />
  1-5. If input is valid, sets internal cutoff date to date on card. Notifies success or fail code.<br />
  1-6. Has accurate internal clock or way to deal with drift.<br />
  1-7. Security Policy: Cut off electricity at the set time.<br />
  1-8. Log and report the amount of electricity used in trusted way.</p>
<p>1B. Meter Functions<br />
  1-1. Activate or disable mechanism to allow electricity to flow.<br />
  1-2. Read data on card via non-DMA interface.<br />
  1-3. Hash the data and verify the signature w/ utility public key. Public key is hardwired to the system or stored on a cryptoprocessor. Check for proper format. If properly formatted, check that unique meter id in signed data matches the meter at the person&#8217;s house.<br />
  1-4. Set internal cutoff date to date on card. Notify via outputs of success or failure w/ fail code. If the cutoff date is stored on untrusted storage, sign it and verify it during system boot. If verification of internal cutoff date ever occurs, kill electricity and notify via fail code.<br />
  1-5. Many clock implementation strategies.<br />
  1-6. The security kernel will be invoked regularly. The security kernel executes the security policy: If TodaysDateAndTime &lt; CutoffDateAndTime, allow electricity. Enable or disable electric flow as needed.<br />
  1-7. If its not an online system, customer inserts their card into the device. Device gets electricity usage, timestamps it, signs it with private key, and loads info on card. Private key is hardcoded to chip or stored on a cryptoprocessor.</p>
<p>2A. Utility Requirements<br />
  2-1. Keep records that associate customers and meters with homes [via addresses and such].<br />
  2-2. Collect the usage data and bill customers for usage data.<br />
  2-3. Upon satisfactory payment, determine new cutoff date.<br />
  2-4. Generate signed data containing the meter&#8217;s unique id and new cutoff date. Meter ID is stored in the customer&#8217;s billing records.<br />
  2-5. Put signed data on customer&#8217;s card.</p>
<p>2B. Utility Functions<br />
  2-1. Identify customer with traditional information gathering processes, associate meter ID at address to customer record, and issue card &amp; credentials.<br />
  2-2. Collect Usage Data<br />
    2-2-1. Copy data from customer&#8217;s card.<br />
    2-2-2. Hash it and verify the signature using database of meter public keys.<br />
    2-2-3. Check for proper format. Check timestamp for recency, reject according to company policy. Verify meterID from card matches meterID on file for customer.<br />
    2-2-4. If validated, send the usage data to the billing system.<br />
    2-2-5. Give customers a bill in some way.<br />
  2-3. Billing system generates a new cutoff date and puts it on the bill. It will be applied after payment.<br />
  2-4. Customer pays. Retrieves the meterID and new cutoff date. Hashes &amp; signs it.<br />
  2-5. Signed data is sent to the card reader/writer, which puts the data on the card.</p>
<ol>
<li>Card Requirements<br />
3-1. Stores a few KB of data.<br />
3-2. Industry standard durability.<br />
3-3. Non-DMA interface. (Prob magstripe.)<br />
3-4. Cheap.</li>
</ol>
<p>(Note: See how unimportant the card is? Users might be provided with a backup during account setup to use interim until they get a new one.)</p>
<p>Assurance Arguments</p>
<ol>
<li>The security policy and enforcement mechanism prevent electricity from being used past the cutoff date.</li>
<li>The only user activity at the meter is setting a new cutoff date.</li>
<li>Due to digital signatures, the utility provider must authorize any cutoff date change.</li>
<li>The user can only forge usage information by subverting the meter. (Random audits, internal tests and [more] secure chips help prevent this.)</li>
<li>Reuse of a card at either end can&#8217;t help the customer cheat the electric company due to timestamps &amp; the non-additive nature of the scheme.</li>
<li>The security relevant functions are simple enough to verify and verified components exist to implement them.</li>
</ol>
<p>Hopefully a slam dunk of offline meter system design without a security flaw. (I probably shouldn&#8217;t have opened my mouth there&#8230;) The system is also simple enough to be formally verified to high assurance standards. Anyone doubting that should look at BLACKER: it was a complex VPN &amp; authorization system that got Orange Book A1 rating using 1980&#8217;s engineering &amp; verification technology. Our capabilities have advanced considerably since then. There&#8217;s also plenty of COTS components to implement this scheme, including a plethora of cheap cryptoprocessors designed to resist tampering &amp; side channel analysis. The system also further backs up my claim that N increase in security/assurance doesn&#8217;t imply N decrease in usability. It&#8217;s extremely usable: both usage reporting and setting new cutoff date are done by the user hitting a button, using the card and seeing an OK message. Interaction with utility regarding card data can be done at utility&#8217;s office, at a kiosk, or over the internet using PC software and a card reader/writer attached to their PC. USB would be easier but poses security &amp; assurance issues. I&#8217;ve considered a dongle or something, but I&#8217;m trying to keep it relatively simple.</p>
<p>So, what do you guys think about this radical little scheme? If it passes analysis, I should probably patent it. (Note: I explicitly reserve copyright on the ideas in this post, just in case&#8230;).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145522">

			<div class="comment by-werner ">

				<p class="commentcredit">

					<span class="commenter">Werner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145522">
						September 23, 2010 4:15 PM					</a>

				</p>

				<p>You can generalize the idea. Instead of putting a credit on the card, you put a limit against cumulative use, be it time (as in your example) or total consumption.</p>
<p>Total consumption would have the advantage that you don&#8217;t need to match consumption with time.</p>
<p>Activating a new card would require synchronization with the meter, but you could work around this by having an &#8220;emergency credit system&#8221; that gives a small additive credit (like the current cards) but that can only be invoked every so often.</p>
<p>By the way, if the meter can write the current cumulative consumption to the card, you don&#8217;t need online reporting either. The customer will bring a recent meter reading each time they recharge.</p>
<ul>
<li>Werner</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145523">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145523">
						September 23, 2010 8:44 PM					</a>

				</p>

				<p>@NickP<br />
 Interesting, but I think you lost sight of the target market &#8220;pre-paid electricity&#8221; and the nature of the customers that normally select this option.</p>
<p>Prepaid is most popular in rental accommodation, short term leases and with those who&#8217;s credit rating is too low for the electricity retailer to offer credit.</p>
<p>Your scheme appears to offer a fixed 1 month credit and requires that the user take the card to an appropriate store, to have the meter results read every month regardless of their actual usage rates.</p>
<p>So a big reason for prepaid is that no one was offering them 1 month Credit to begin with.  The electricity provider also cares more about the amount of electricity used than the date by which it is used. If you are suggesting that the date &#8220;time-out&#8221; add an extra level of protection then this is a reasonable idea that is already implemented in most meters that I have seen. (basically pre-paid coupon is good for 3 months maximum)</p>
<p>It seems to me that all your added security comes from the requirement than the card be signed by the meter, before value is added to the card. I think this is the same as I said above, unfortunately for the consumer it becomes a 2 step procedure, which makes it unpopular.  Secure YES popular NO.</p>
<p>As far as the electricity retailer is concerned there is no real difference between fake cards and meter bypassing (as Clive pointed out). The meter accounting methods that they use to detect both types of theft are basically the same, so if the scheme is used for any significant length of time than meter inspectors will be sent to the appropriate sectors and will check for problems. I have no idea if the law is different for meter bypassing vs use of fake cards, but i suspect both are treated the same way.</p>
<p>I&#8217;ll reread your proposal tonight when I have a little more time to focus.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145524">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145524">
						September 23, 2010 8:46 PM					</a>

				</p>

				<p>@ Wemer</p>
<p>Interesting ideas. Total consumption, in particular, has a lot of potential. It could actually be implemented just like my system, reusing much of its design effort. The device would keep a consumption counter and a consumption limit. The card could have a signed message with the new consumption limit, rather than &#8220;add this many hours&#8221; to prevent reuse attacks. I figure that&#8217;s how you intended implementation.</p>
<p>The utility company could represent consumption values by a 64-bit number, with 128-bit in an extreme case. The meter could do it one of two ways: a 64/128 bit number for both total and max consumption that always increase; 32 bit values along with a 32-bit counter. The lower bits are mentioned to take advantage of cheap 32-bit chips and possibly 16-bit chips that can do simple 32-bit math. I&#8217;d rather use 32-bit w/ MMU to take advantage of recent safety-critical RTOS&#8217;s, esp. separation kernels.</p>
<p>In the 32bitscheme, each reload would subtract last months total consumption from the running total and optionally set a new max consumption. The inputs would be provided on the card by the utility company and signed. I am using subtraction here to account for the delay between meter reading and loading continued activation data from the utility company. I think even if it goes through months worth of use before a reload, the consumption value shouldn&#8217;t overflow: residences that use over 4,294,967,296 kwHr&#8217;s in three months will probably be using the industrial version with 64-128 bit counters. A 32-bit counter should suffice as I doubt any home will ever experience more than 4,294,967,296 bill payments either. So, that&#8217;s three simple variables and just a few primitive operators. Seems easy enough.</p>
<p>Everything else in my design would stay the same. The timestamps might be removed if the utility company audits unusually low utility usage or sharp declines in usage. The audits should include comparing reported usage with substation readings and inspecting the meters of homes with sudden decreases. They could keep a record of the previous month (or all months) to perform this check to ensure a sane data value and use the signature to verify authenticity.</p>
<p>All in all, your proposal is pretty cool. If we use my old scheme with your total consumption modification instead of cutoff dates, we still can have untrustworthy cards and only need to activate the meter, which can be done through the card with signed command. In the process, we may be able to remove the time stamps and maybe the ultra-reliable clock requirement for the control system. Nice progress on this for four guys and a few hours effort. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145525">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145525">
						September 23, 2010 9:06 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>It does seem to be an issue of markets. In that market, my system wouldn&#8217;t meet requirements. Like I said, out here people <em>do</em> actually get a month or two credit. I don&#8217;t know if it&#8217;s most of the US or just most of the Southern states where I&#8217;ve owned property. There may be some usage limits, but I&#8217;ve never noticed them in many cities. Their MO is to let you turn on electricity with a deposit (covering their butt), let you use it until billed, cut you off if you don&#8217;t pay, and sue you for the money if you don&#8217;t pay the now higher bill (penalties and such). So, our utilities essentially do work on a month or two credit and the Mid-South companies treat the second month as a grace period where they add late penalties and you don&#8217;t get cut off. The time between first bill and cutoff usually doesn&#8217;t change so that could automatically determine the digital cutoff date put onto a card.</p>
<p>Your usability complaint is valid. It does add an extra step. However, the same complaint can be lodged against the credit based offline systems. As far as I was aware, the user had to load the card somehow and then use it on the meter somehow. In my system, the user loads data on the card and uses it on the meter. Same no. of steps. In our existing Mid-South companies, I just use as much electricity as I want and then pay when the bill comes. Payment can be done in person, by mail or over the phone with cash, check or credit cards. All offline smart meter systems that have been proposed add at least one extra step for us. It might not be a problem: utilities are a monopoly out here and they can easily force a system adoption. They have in the past and they certainly could again, so an extra step or two might only hurt public relations rather than adoption.</p>
<p>I could build a usage monitor into my design similar to the total consumption that Wemer and I are discussing, but I really haven&#8217;t seen it. Business customers might have to deal with that but I&#8217;ve never had to handle the administration details for business class electricity and hence don&#8217;t know if it&#8217;s different for them. The only limits I&#8217;ve run into on utilities have been an Internet bandwidth cap. If the utility wants to impose limits, the system and signed data could be modified to do that. I think I need to study the markets you are discussing as they seem to be very, very different from ours. Maybe crank out a credit-based design for them after I learn how they work. In mean time, with my market characteristics I&#8217;ve given you, what do you think of the cutoff or consumption systems?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145527">

			<div class="comment by-ralph ">

				<p class="commentcredit">

					<span class="commenter">Ralph</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145527">
						September 23, 2010 9:22 PM					</a>

				</p>

				<p>These meters charge about 1/3 more for the electricity than someone getting credit and paying by direct debit.</p>
<p>It really is expensive power. They make the poor pay more. In Scotland as well &#8211; chilly.</p>
<p>Not only that but they can increase the rate to include paying back any previous debts or indeed debts of previous tenants.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145528">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145528">
						September 23, 2010 11:06 PM					</a>

				</p>

				<p>@NickP<br />
  Just a quick reply<br />
1) People selecting Perpaid electricity often may not want Credit because of the associated on-going liability associated with Credit.</p>
<p>2) for prepaid client: think of someone that moves to a new city rents an apartment month to month and needs electricity. He gladly buys a $100 prepaid coupon. and will try to stretch that amount to last for his intended stay.  If needed, or for longer stays, he repeats procedure.</p>
<p>With this customer there is no liability for electricity consumed after he left the premises, but forgot to inform the electricity retailer. There are no hidden account cancellation charges&#8230;..He pays $100 and buys some number of KWH or power and leaves (maybe selling any residual value to the next tenant).</p>
<p>He is happy, the retailer has no account setup costs, and no reason for further billing him, power automatically turns off when the credit is exhausted. Simple.</p>
<p>I actually know some people who select prepaid and prefer it because it acts as an in-built consumption limiter. Typically the meter will display residual power, so I know if I have 100KWHr of electricity left on the meter and 10 days to go before, I move or have enough money to again pay,  than I know that 10KWHr per day is my maximum consumption rate. When I check the next day and see that I&#8217;ve used 20KWhrs than I get an idea about how to adjust my usage to make the available electricity last for the required period. Pensioners and those on fixed incomes fit into this class.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145529">

			<div class="comment by-werner ">

				<p class="commentcredit">

					<span class="commenter">Werner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145529">
						September 24, 2010 2:56 AM					</a>

				</p>

				<p>@Nick P: don&#8217;t subtract anything. Just keep counting. Design the counter such that it cannot possibly have a valid reason to overrun.</p>
<p>The procedure would be as follows: old limit on card is X. We assume the limit has been transferred to the meter. (But it&#8217;s okay if it hasn&#8217;t.)</p>
<p>You go to the shop and pay for Y more units of whatever. Card gets set to X+Y.</p>
<p>You go back home and put the card in the meter. Its current limit is L, the running total T.</p>
<p>If X+Y is less than L, ignore the card. This can be an honest mistake, e.g., someone owning more than one card and inserting the wrong one.</p>
<p>If X+Y is greater than T+some safety threshold S, reject the card or accept only T+S and increment the &#8220;unusual transactions&#8221; counter. This protects against assigning some insanely large limit for whatever reason (manipulation, malfunction, whatever).</p>
<p>If we&#8217;ve made it this far, set L to X+Y.</p>
<p>If you lose the card, just buy a new one with the limit set to X+Y from the company&#8217;s records. This depends on the shop having online access to a database containing the customer&#8217;s record.</p>
<p>Regarding the hardware, I don&#8217;t know what exactly they put into these meters, but it&#8217;s probably simple. This also helps with hardening the system against tampering.</p>
<ul>
<li>Werner</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145530">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145530">
						September 24, 2010 12:36 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;&#8221;</p>
<p>I&#8217;ve not yet sat down with pencil and paper to work through it.</p>
<p>However my first question prior to that is have you done a Cost / Benift Analysis?</p>
<p>If you assume that 99.9% of housholds are honest (ie 1 in a thousand are criminals, which is about the population density of criminals in the UK) then the loss you are looking to protect needs to be atleast balanced by the difference in price between a traditional meter and a smart meter in every home. The average home usage is around 130 GBP / quater or call it 500GBP a year.</p>
<p>This means if the utility companies are paying for the meter (as they currently do) then they are going to be looking at less than 50pence a meter price difference after manufacture to make it worth while doing (to every home).</p>
<p>The last time I looked &#8220;key meters&#8221; where tens of pounds more expensive thus they where only put in where theft had already happened or was deamed very likley to happen.</p>
<p>They then offset the price of this meter and the higher running costs on the tariff.</p>
<p>However there is ample evidence according to a number of consumer groups in the UK that the utility companies are &#8220;over egging the pudding&#8221; and have a payback period of six months or less. Thus the accusation levied against the utility companies of &#8220;blatant profitering&#8221;.</p>
<p>Having pulled quite a few of the first second and third generation electronic pay meters apart I can assure you that just on safety grounds alone I would not have one in any house.</p>
<p>That is in the UK we have the principle of &#8220;double insulation&#8221; that is there are atleast two insulating layers sufficient to withstand atleast twice (if not significantly more) times the voltage under the majority of use cases (like a cable dropping in a bath etc). None of the meters I looked at had double insulation the cases where made of brittle materials and they where most certainly not by any stretch of the imagination water or gas proof.</p>
<p>The electrical regulations have a very very (and compleatly inacurate) assumption that they will be mounted in a seperate lockable enclosure in ordinary usage. In mot cases they are put on a board (to stop you &#8220;flipping the meter&#8221;) under the stairs or in the &#8220;mop cupboard&#8221; where people natural stick things like step ladders, tool boxes, vacuum cleaners, buckets, mops, brooms and just about any other clutter you can imagine (and I&#8217;ve seen a few you such as &#8220;exploding bottles of home brew&#8221; and &#8220;hydraponic hemp gardens&#8221;).</p>
<p>So most of what you would consider likey to go through the meter case in one way or another is in reality right there just waiting to happen (and believe me it does with regular monotony and many people get hurt in a year).</p>
<p>So&#8230; there is evidence the utility companies will not even pay to make the meters &#8220;safe/fit for purpose&#8221;&#8230;</p>
<p>Hence my earlier comments about the utility company joy at legislation forcing the ever ripped off consumer having to pay for the new &#8220;smart meters&#8221; our political lords and masters are getting off on (as it does not cost them either).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145531">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145531">
						September 24, 2010 4:18 PM					</a>

				</p>

				<p>@ Werner</p>
<p>@ Werner</p>
<p>Well, I do prefer the addition only version as well. It was the first of my two methods. I mentioned subtration in scheme two so we could use 32-bit values only. That might allow us to use extremely cheap hardware and verify the design easier. I considered this because I figured the utilities would probably only go for the cheapest hardware when selecting a smart meter design. I don&#8217;t know if doing 64-128bit additive design will require an expensive processor. Maybe a hardware guy can chime in on this? I guess we should proceed on the additive design since this is a thought experiment. ðŸ˜‰</p>
<p>I see you are also building in little safety checks. I have no issues with any, so I&#8217;ll integrate from there. My system design uses the card to carry commands rather than just values. We can probably do it a lot like IP and other protocols with a fixed number of bits at the beginning to represent the command, then a set to represent the length of the data/arguments, the data/arguments, and then the signature. No need for a checksum for the data tks to the signature. But the signature could be corrupted. Optional prevention might be having the signature&#8217;s integrity verified during the load process. This is probably unnecessary though, as a flaw would be good motivation to buy a new card.</p>
<p>So, we have Command = CommandName+Length+Data+Signature. A few commands that come to mind for your system are SetLimit, SetSafetyThreshold, and ActivateMaintenanceMode. The last command is optional and would allow field personnel to disable tamper sensors and activate necessary software with merely the swipe of a card. That&#8217;s just three commands and the commandname field could be as little as 2 bits long (four possible values). Very economical. If we are doing additive, then limit and threshhold are 64 bit values. Hence, the data for one command never exceeds 64 bits. Might get rid of the size field and just have 64 bits between CommandName and Signature on all commands.</p>
<p>The system should also probably have a way to include multiple commands, at least SetLimit and SetSafetyThreshold done together. To make parsing easier, we could put the number of commands present as the first thing on the card. Due to the small number, it too would be a tiny data type. So, we extend our card contents to NumberOfCommands + One or More of Command where number of Commands equals NumberOfCommands. (I know it sounds redundant but specification tools often require things like that to aid automated checks.)</p>
<p>Since I&#8217;m toying with a high assurance design, I will intentionally overdesign this and decompose the system into functions. Only one sideeffect is allowed per function. Pre- and post-conditions are used to catch errors. SPARK Ada would probably be used, but I&#8217;m doing pseudocode here. Some functions aren&#8217;t thoroughly defined here.</p>
<p>global variables (info flow analysis keeps this from being a problem)</p>
<p>define totalusage as 64-bit number and set to zero<br />
define usagelimit as 64-bit number and set to zero<br />
define safetythreashold as 64-bit number and set to zero<br />
define carddata as binary array and set to empty<br />
define cardreaderror as integer and set to zero<br />
define powerstatus as boolean and set to false (off by default)<br />
define varproperpowerstatus as boolean and set to false (off by default)<br />
define maintenancemode as boolean and set to false</p>
<p>define function setpowerstatus(boolean newStatus) Turns power on or off depending on argument. Updates powerstatus variable.<br />
define function properpowerstatus(totalUsage, Limit) Decides if power should be on or off. Returns boolean. That is sent to setpowerstatus.<br />
define function readdatafromcard() Returns an error code or a binary array (or byte array or whatever) of the data on the card.<br />
define function maintenancemode() Enters maintenance mode. May necessitate other variables and functions and have total write access to system.</p>
<p>pre(powerstatus== (true or false))<br />
setpowerstatus(newStatus)<br />
post(powerstatus == newStatus)</p>
<p>pre(varproperpowerstatus == false; usagelimit and totalconsumption are positive)<br />
properpowerstatus(totalUsage, usagelimit)<br />
post(varproperpowerstatus == true or false; usagelimit and total consumption are positive)</p>
<p>pre(carddata is empty; cardreaderror equals zero)<br />
ReadDataFromCard<br />
post( (carddata is not empty and cardreaderror equals zero) OR (cardreaderror &gt; 0) )</p>
<p>pre(carddata is not empty; cardreaderror equals 0; usageLimit, totalUsage, and safetyThreshold are positive)<br />
ProcessCardData()<br />
post(carddata is empty; cardreaderror equals 0; increased(usageLimit) OR changed(safetyThreshold) OR maintenanceMode==true)</p>
<p>LOOP FOREVER</p>
<p>If maintenancemode==true, then maintenancemode();</p>
<p>set varproperpowerstatus to false;<br />
properpowerstatus(totalUsage; usageLimit);<br />
setpowerstatus(varproperpowerstatus);</p>
<p>set carddata to empty;<br />
set cardreaderror to zero;</p>
<p>ReadDataFromCard();</p>
<p>If cardreaderror equals 0, then ProcessCardData() else ProcessCardErrors()</p>
<p>END LOOP</p>
<p>Easy as pie, oh my! I wonder if I should code it up or do the parser. I&#8217;m not sure how I would design a safety critical parser. I&#8217;m trying not to do any dynamic memory allocation in this system so it will be totally predictable and possible to use a separation kernel with time partitioning. I think this is the perfect system to use with something like Integrity-178B, DEOS or Xtraatum. It&#8217;s just so simple. So, where&#8217;s my mistake if any? (Other than left out documentation, which is intentional cuz I ain&#8217;t putting that much time in right now. 8)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145532">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145532">
						September 24, 2010 4:29 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Your cost arguments are good but you already had the counter in your own post: the companies are pushing smart meters for more control and profiteering. They also have special status that allows them to force consumers to do it their way and have no other options. So, the cost would be passed to the consumer for at least the first meter. Might be an activation charge or equipment renewal fee annually to cover for future maintenance. Cost won&#8217;t be an issue at the user side and cost at the utility&#8217;s end can (and will) be minimized.</p>
<p>When looking at the costs, I think there might be a small payoff to the system. Other than making meter fraud a bit harder, the system will automate the process of disconnecting and reconnecting homes. If a meter bypass prevents this, their traditional auditing methods will catch it. In other cases, the system will save the utility company a trip. This could provide cost benefits. The knowledge that the cutoff will be automatic and merciless might prevent some customers from being too behind on their payments. So, I see a few potential payoffs for the utility company, but imho smart meters are almost always bad for the consumer in some way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145533">

			<div class="comment by-werner ">

				<p class="commentcredit">

					<span class="commenter">Werner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145533">
						September 24, 2010 4:47 PM					</a>

				</p>

				<p>@Nick P: err, even the tiniest of CPUs can handle very very large integers. It just takes them slightly more time. Do you think computers had great difficulties counting above 255 in the days of, say, the Apple ][ ? ðŸ™‚</p>
<ul>
<li>Werner</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145534">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145534">
						September 24, 2010 11:07 PM					</a>

				</p>

				<p>@NickP<br />
 Lot of interesting work, BUT you are fixing a problem that does not exist, at least not for future Meter systems.</p>
<p>All new meter systems being installed, (basically anywhere in the world today) have two way communications built in. So called Smart Grid Meters.</p>
<p>Once you can remotely control the meter, and remotely read the electricity usage there is very little reason for the Pre-paid Card activated meters.</p>
<p>You can keep this &#8220;downcounter&#8221; meter functionality if the user wants prepaid &#8220;look-alike&#8221; meter but the infrastructure is all smart grid.</p>
<p>As Clive has pointed out, users have the privilege of paying for these new meters (sometimes up to $400USD) to have a perfectly good meter replaced by a smart meter. In most cases the only possible beneficiary of the Smart Meter is the electricity retailer, so it is remarkable that the user pays model has been so universally adopted. (but that&#8217;s politics  not engineering so I&#8217;m not at all qualified to comment)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145535">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145535">
						September 25, 2010 12:40 AM					</a>

				</p>

				<p>@ Werner</p>
<p>It&#8217;s not as much my concern that the smaller processors couldn&#8217;t handle big numbers as much as how it would work when time partitioning on the RTOS only allows so much time to do the work. I guess it&#8217;s not really a big deal, esp. as I was preferring a 32-bit processor w/ MMU. Don&#8217;t know why I got hung up on it. (Sleep deprivation possibly&#8230;)</p>
<p>@ RobertT</p>
<p>If they do, then we can make an online protocol. You say &#8220;anywhere in the world&#8221; but our meters require physical termination and activation. It would seem the two way link doesn&#8217;t support this critical functionality. There might be smart meters available out here that have that function, but I admittedly don&#8217;t know much about their availability or features. I&#8217;ll have to look into it. I agree that a User Pays model for a product that only benefits the utility is very bad for us and shouldn&#8217;t have any user support.</p>
<p>Ok, if we can get two way meters, then the design will change. I still prefer Werner and I&#8217;s system components that use total vs max consumption. If this could pose a problem for any reason, the cutoff date approach and a strong time protocol could be used. Two-way communication actually simplifies the situation if we&#8217;re using digital signatures. Well, at the protocol design level. The implementation of course becomes more complex. Our offline system was a fun thought experiment regardless of its practicality. At least it had some value&#8230; ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145536">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145536">
						September 25, 2010 4:02 PM					</a>

				</p>

				<p>@ Werner,</p>
<p>&#8220;&#8230; err, even the tiniest of CPUs can handle very very large integers. It just takes them slightly more time. Do you think computers had great difficulties counting above 255 in the days of, say the Apple ][ ?&#8221;</p>
<p>The addition (which subtraction is anyway) should be atomic, due to openings caused by interupts and the like.</p>
<p>I actually was involved with an energy system on the Apple ][ back in the early 1980&#8217;s using the UCSD P system (I still have an Apple ][ and the disks etc in a cupboard).</p>
<p>And yes interupts where a problem as meter readings could get updated during an addition in the main program and you could get a hidden &#8220;roll under&#8221; effect where the interupt caused a middle byte in a reading above say 0xF0 to rollover to less than 0x0F during the addition.</p>
<p>As it is an effect that is normally never seen (ie in a 3byte addition on ~10min interupt interval) during testing and often does not occure reproducably in the field it&#8217;s put down to being just a &#8220;glitch&#8221; at best. So the protection code never gets even considered let alone added by the code cutters.</p>
<p>Fast forward 6years or so and I was investigating (in my own time) what are now called (in some places) &#8220;EM Active Envelop Fault Injection Attacks&#8221; on an &#8220;electronic purse&#8221; and I found I could change values in the purse by large amounts due to simmilar probs with 4byte wide adds on 8bit micros.</p>
<p>Now I would have been one of the first to put my hands up to saying I don&#8217;t rate it highly as an attack vector on electronic electricity meters due to the implementation cost vastly outweighing the potential loss (ie a smart student filching a bit of &#8220;lecie&#8221; in their digs) due to the limiting effect of the &#8220;total metering&#8221; at the substation.</p>
<p>But&#8230; I likewise would not have rated this attack in Scotland simply because I would not have seen the cost benifit for a &#8220;single person&#8221; and not think about how &#8220;criminal gangs&#8221; could profit by it (in the same way drug dealers do of giving a freebie to get you hooked).</p>
<p>This attack has changed the &#8220;game&#8221; thus the &#8220;defenders&#8221; need to consider attack vectors which might only be profitable if done on 100+ meters.</p>
<p>And yes &#8220;this old dog has learned a new trick&#8221;, by the way the gangs have employed &#8220;drug dealer&#8221; tactics in a new way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145537">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145537">
						September 25, 2010 9:57 PM					</a>

				</p>

				<p>Who needs doorstep crooks to get free electricity?</p>
<p>At the height of the Y2K hysteria, our prepaid meter gave up charging us for the actual electricity (or even noting what we&#8217;d used) but continued charging us the day charge, reducing the charge to about a fifth of what it should have been. The lazy oiks at the electricity company didn&#8217;t actually notice for two years, at which point they replaced the meter but didn&#8217;t try to stiff us for the money, partly, I assume, as there was no record of what we&#8217;d actually used. As there were several people in the house topping up every now and again, we hadn&#8217;t even noticed for the first year.</p>
<p>Roll forward 4 years and in another property we switched suppliers, because the current supplier was really taking the Michael with the price. We knoew the new supplier was way cheaper, but were pleasantly surprised when they turned out to be less than half the price. Only they weren&#8217;t, as we found out a year later when the contacts on our key broke and it had to be replaced. They didn&#8217;t bother chasing it, or in fact mentioning it.</p>
<p>In May last year, our recently fitted meter again gave up recording what we used. We didn&#8217;t notice till July because we&#8217;d put a huge chunk of money on it as we were away a lot. When I did look, it had only gone down by about a days worth in 3 months. Gave it a couple of weeks, then called in mid August to get it fixed, expecting the suppliers to be only too keen to get it fixed so they could start charging again. Hardly; the first appointment they could drum up was mid November.</p>
<p>Makes you wonder if the ridiulous prices are to make the customers they do manage to charge cover for their endless failure to run their businesses even passably well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145538">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145538">
						September 25, 2010 11:17 PM					</a>

				</p>

				<p>@Clive<br />
&#8220;Fast forward 6years or so and I was investigating (in my own time) what are now called (in some places) &#8220;EM Active Envelop Fault Injection Attacks&#8221; on an &#8220;electronic purse&#8221; and I found I could change values in the purse by large amounts due to simmilar probs with 4byte wide adds on 8bit micros&#8221;</p>
<p>Interrupts are an interesting problem with any high security micro. Typically with a realtime system you assign the highest priority interrupts to the time critical tasks (like measurement) and figure the Crypto can be done at the lowest priority. Unfortunately this concept opens the micro to a whole class of attacks where the timer interrupt is flooded. I&#8217;ve also seen several EM attacks that injected into the Xtal cct. Surprisingly I don&#8217;t think I&#8217;ve ever seen this class of attacks talked about before. (I don&#8217;t think Ross has ever mentioned these attacks).</p>
<p>In some Micros you can cause a stack overflow which results in the return address overwriting the stored data.</p>
<p>Another class of interrupt attack is to detect the jitter in the start of a certain lower priority interrupts, this attack assumes that during critical adds / multiplies the lower priority interrupts (or os tasks) are masked.  as a result the micro reveals the length of each multiply&#8230;opps (I love these side channel attacks, because most people are clueless as to how you hacked it. worse than this they still don&#8217;t get it when you explain the attack)</p>
<p>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145539">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145539">
						September 26, 2010 1:26 AM					</a>

				</p>

				<p>@ RobertT,</p>
<p>&#8220;I don&#8217;t think Ross has ever mentioned these attacks&#8221;</p>
<p>If by &#8220;Ross&#8221; you mean Prof Ross J Anderson over at Camb Labs I had mentioned in an email to him about using EM attacks against systems when he was looking at &#8220;self clocking&#8221; systems as a way to get around Differential Power Analysis.</p>
<p>I&#8217;m assuming that as he did not appear to persue self clocking systems after that, that he realised what the potential for EM attacks was. He also made oblique refrence to it in his book when talking about computer keyboard leads and their susceptibility.</p>
<p>To be honest the only academic paper I have seen relating to EM attacks was the recent one on what a plain CW signal did to a random number generator (went from 32bit equivalent to sub 8bit equivalent) by a couple of researchers at Camb Labs and pressented at an IEE conferance (it&#8217;s up on the lightthebluetouchpaper.org site)</p>
<p>It&#8217;s actually quite odd because I&#8217;ve not exactly been quiet on the subject these past thirty years, I guess people just assumed passive EMC would make it a non issue. However active EMC where you use spread spectrum techniques &#8220;to beat the mask&#8221; has actually made active EM attacks a whole lot easier as the SS clock is usually directly derived fron the same master clock that drives the CPU thus providing a loverly synchronisation system for free&#8230;</p>
<p>I&#8217;m waiting to see if the bods in Camb Labs will actually combine a couple of the attack vectors such as monitoring the SS signal from the master clock to determin clock drift and pump high load network traffic (say SSL etc) to change it.</p>
<p>It would be a practical way to identify which SS signal you want coming from a room full of computers such as a server farm, and thus corelate an EM attack with a network attack etc&#8230;</p>
<p>I realy feel we will see real EM attacks in the wild in the not to distant future and I know @ Nick P has had some thoughts on the issue to chat to his clients about.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145540">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145540">
						September 26, 2010 11:11 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>&#8220;I love these side channel attacks, because most people are clueless as to how you hacked it. worse than this they still don&#8217;t get it when you explain the attack.&#8221;</p>
<p>I wish I could say I wasn&#8217;t &#8220;most people&#8221; in this case but&#8230;. grr&#8230; You said you&#8217;ve seen an attack like this in the real world. Could you give even a filtered explanation of what occurred and how you determined the method they were using? (Doesn&#8217;t seem like something anyone would monitor or easily monitor.) I would also be very grateful if you explained in semi-lay terms exactly how this attack is accomplished, detected and prevented. As I&#8217;ve said before, I&#8217;m mainly a systems guy with very little direct hardware experience. I&#8217;m slowly picking these things up and I figure if enough people explain it my understanding of it will be pretty good. Thanks for any help on this ahead of time.</p>
<p>@ Clive Robinson</p>
<p>I wonder how much of the TEMPEST Level 1 standard and Type 1 cryptographic devices protect from active attacks. I know the old STU-3 was vulnerable to active EM attacks because you couldn&#8217;t use cell phones near them. I wonder if the new ones have those capabilities or if you have to have everything in a Faraday cage.</p>
<p>&#8220;I realy feel we will see real EM attacks in the wild in the not to distant future and I know @ Nick P has had some thoughts on the issue to chat to his clients about.&#8221;</p>
<p>Yeah, I told them to switch back to paper, vaults, guards and monitoring galore if they are concerned about that on general purpose or COTS systems. Let&#8217;s face it, Clive: there&#8217;s no <em>cost-effective</em> solution and the risk is currently too low to justify to even the most paranoid management types. Maybe RobertT&#8217;s description of the real-world incident will be helpful for those articulating the real-world dangers. As it stands, we can barely get passive EM resistance in businesses and government is doing less than ever. Have you noticed how they relaxed their EMSEC requirements over the years? Did you notice how that paid off? (lulz)</p>
<p>Btw, why do you often say &#8220;@ Nick P&#8221; rather than &#8220;Nick P&#8221;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145541">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145541">
						September 27, 2010 1:07 AM					</a>

				</p>

				<p>@Clive<br />
   I agree, at first glance SS clocking looks like a great fix for Differential Power Analysis (DPA) but when implemented it actually makes DPA easier, because it gives you a clock edge plus long term SS sequence to lock too. Most of the first generation anti DPA systems used a short LSFR to generate a jittered clock that varied the instruction start execution time (relative to the system clk). So externally the instruction timing looks just like SS clocking.</p>
<p>Self timed logic is also VERY sensitive to thermal and voltage conditions. So intentionally modulating the temp and voltage and creating, what test experts call a &#8220;schmoo plot&#8221;. and comparing the power spectrum at different Schmoo corners reveals a lot about the nature of the calculations.  Using thermal gradients across the chip is also very useful when combined with DPA on self timed logic.</p>
<p>From my experience &#8220;self timed&#8221; logic is the worst choice for anti DPA, however it does help prevent &#8220;glitch&#8221; attacks.</p>
<p>Some are new products are generating the instruction clock using multi input LSFR&#8217;s and dithering the LSFR with the output of a hardware RNG. I&#8217;ve looked at one of these secure micros on the bench and found it very difficult to get any information from the power spectrum. (I believe they also have a shunt regulator internally, so this really helps smooth out the IDDQ  variations.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145542">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145542">
						September 27, 2010 10:12 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8216;Btw, why do you often say &#8220;@ Nick P&#8221; rather than&#8221;Nick P&#8221;&#8216;</p>
<p>Well, put simply the at (@) symbol catches the eye of those doing a mark 1 eyeball search down the hundred recent posts list.</p>
<p>It also helps for those with names that also get caught in common automated word searches (of which nick is one).</p>
<p>It&#8217;s also become a habit and we know how hard those are to break ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145544">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145544">
						September 27, 2010 10:34 AM					</a>

				</p>

				<p>@ RobertT,</p>
<p>&#8220;Some are new products are generating the instruction clock using multi input LSFR&#8217;s and dithering the LSFR with the output of a hardware RNG. I&#8217;ve looked at one of these secure micros on the bench and found it very difficult to get any information from the power spectrum.&#8221;</p>
<p>Yes I expect for most &#8220;bench instrumentation&#8221; that would be the case as the &#8220;chip rate&#8221; is constantly changing (the same trick has been tried with very high chip rate DSSS systems). However the catch then becomes any regular time frame. This is the weakness of any digital modulation SS system as you can use the data frame as the null point to center your tracking demodulator.</p>
<p>However with a micro controler with a little care you can make any such &#8220;required&#8221; clock edge asynchronous to the main CPU functioning (a simple random length pad or fill at the end of an interupt that generates the edge will do that).</p>
<p>As for,</p>
<p>&#8220;I believe they also have a shunt regulator internally, &#8230;&#8221;</p>
<p>Provided it&#8217;s in the chip and they don&#8217;t make the usuall &#8220;current path&#8221; mistakes you see in digital only chips then yes it will go a long way. However designing a micro along similar lines to a 24bit A-D chip is going to have quite a few implications.</p>
<p>I was once shown the design of a &#8220;serial CPU&#8221; that actually had multiple small chips optocoupled together in the package and to say I was &#8220;gob-smacked&#8221; would be an understatment. And before you ask no I do not know if it ever went into production, the fact it was contemplated to get over a percieved potential side channel problem spoke volumes about what some people then knew about side channels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145545">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145545">
						September 27, 2010 2:25 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>I&#8217;m wondering if there is even a way to make a processor useful for running modern apps that is immune to passive and active EM attacks. I think this is going to require so many usability, performance and cost tradeoffs that it might be better to focus our actions on TEMPEST enclosures and ways to prevent EM links that external interfaces (ethernet, power linet, etc.). This is what most TEMPEST systems do and seems to be the easiest method.</p>
<p>Actually, the easiest method is throwing a bunch of critical systems in an EMSEC cabinet or room w/ filters on cords leaving it. I&#8217;ve only seen two books or guides on EMSEC. Most of the good info is classified. The best help hardware security experts could give us system guys is good info on building TEMPEST enclosures and filters. We need some open hardware designs and books on the subject. Maybe we can get the cost down on a bunch of components and get more of them in COTS systems. That&#8217;s the only solution I see working interim. (Then there&#8217;s the issue of processor bugs and hardware not behaving according to spec. Got to fix that too.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145546">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145546">
						September 27, 2010 6:43 PM					</a>

				</p>

				<p>Nick P,</p>
<p>&#8220;Actually, the easiest method is throwing a bunch of critical systems in an EMSEC cabinet or room w/ filters on cords leaving it.&#8221;</p>
<p>For some applications you could put the chip in it&#8217;s own EmSec case only fractionaly larger than a 14pin DIL package.</p>
<p>Think about a smart card chip slapped between two (appropriate) metal plates with surface mount filters between the external pins and chip bond out pads.</p>
<p>Provided the function is such that the data rate on any pin is low then likewise radiation will be low. For high speed data you could encrypt the data and use an appropriate crypto mode to ensure &#8220;traffic flow&#8221; cannot be performed.</p>
<p>With regards,</p>
<p>&#8220;I&#8217;ve only seen two book or guides on EMSEC.&#8221;</p>
<p>Yes they are a bit thin on the ground. However a lot of the basic stuff is realy common sense and most RF or analogue design engineers can work it out with just a simple pointer or two. And if you know where to look the hints and the theory they relate to are easily found.</p>
<p>A place to start for most is a good book on EMC, Hewlet Packard used to have some very good ApNotes and they are still up on the web in several places.</p>
<p>It&#8217;s when you get past the basics the fun starts but again it&#8217;s not (quite) rocket science and can be worked out.</p>
<p>The big thing to recognise is &#8220;encapsulation and segregation&#8221; of function as a design philosophy and to recognise and control the &#8220;channels&#8221; by which susceptability or emission occur.</p>
<p>Also recognising the sometimes arcane and complex methods by which information leaks as energy escapes any which way it can.</p>
<p>Sadly the area of theory that is a bit sparse is &#8220;near field&#8221; and that is where the bulk of the EmSec physics happens.</p>
<p>I do however suspect that the academic work in this area will improve greatly over the next couple of years, simply because the other low hanging fruit are starting to be &#8220;mined out&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145547">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145547">
						September 28, 2010 12:21 AM					</a>

				</p>

				<p>@Nick P<br />
â€œI wish I could say I wasn&#8217;t &#8220;most people&#8221; in this case but&#8230;. grr&#8230; You said you&#8217;ve seen an attack like this in the real world. Could you give even a filtered explanation of what occurred and how you determined the method they were using? â€¦.â€</p>
<p>It wasnâ€™t THEY but rather it was me implementing the attack on a design that a team had been working on, I always like to try out new hardware hacks on my own projects, usually without telling the design team in advance about the intended attack vector. The point is that they need to be independently thinking about information leakage vectors, because if I can dream up an attack than so can lots of other peopleâ€¦.</p>
<p>Detecting and prevent attacks:<br />
 Detecting is remote EMsec attacks is relatively simple, you need several antenna {hertzian-dipoles} tuned to different frequency ranges. Since all remote Emsec attacks require high intensity RF fields you can detect them with a simple peak detect circuit connected directly to the antenna. Basically you are crudely measure EM field strength over a broad frequency band.</p>
<p>Another common input vector is through the power supply, protecting against this vector is a little more difficult but it requires a LOT of EM power or direct effect to the power supply regulation. So this is a Near field only attack.</p>
<p>My favorite attack is to locally inject power supply interference is by overdriving CMOS output signals. This attack is nice because it can utilize existing fault protection hardware against as a fault injection vector. (for example an enclosure lid switch would typically be directly connected to a CMOS I/O, if I can access this wire than I can reverse drive it to inject substrate current) This method means that the PCB level power supply decoupling caps are now isolated by the bond wire / pads of the chip. This overdrive current forward biases the output ESD protection structures and causes them to locally inject minority carriers into the chip substrate. (sorry no easy way to explain this, but it is related to the physics of a CMOS fault called Latch-up) minority carrier recombination can be used to de-bias internal analog circuits, particularly internal LDOâ€™s (low drop-out regulators) and bandgap references. If the bandgap circuit is susceptible to minority carrier injection, than you can directly modulate the chip internal supply voltage, which is extremely useful for timing and so called â€œglitchâ€ attacks.</p>
<p>Checking for active EMsec susepibility:</p>
<p>In general, Active EMsec attacks, affect high impedance input nodes of a product. So to check if a particular product is likely to be sensitive to Active Emsec I&#8217;ll intentionally add, to suspect nodes, a burst of sine waves, from a highish impedance oscillator source (say 1k to10k ohms). If this results in an observable change in power or functionality than I conclude that an EMsec attack, on this node, COULD compromise the product. So I need to take extra shielding / filtering care with this node. Implementing a real active EMsec attack is not always possible because of the physical constraints of a real product, basically for active Emsec attacks to work the injection node must behave like an efficient antenna at the carrier frequency being used. So where I mentioned Active Emsec sensitivity, I usually take the shortcut of deliberately injecting a burst sine wave on a bench setup. I do this with my own products, and the products of competitors.</p>
<p>Sensitivity of 32 khz crystals:<br />
  Usually the xtal oscillator is one of the easiest ccts to inject into. Most crystal oscillators are VERY high impedance common mode circuits, so injecting a disturbance signal into this node is very easy. In many microcontrollers the 32Khz osc is divided down to create a 1msec timer interrupt. If you inject a burst signal at 320khz into this node, the interrupt will occur at 0.1msec intervals. Now since the rest of the tasks are typically scheduled from the timer interrupt, everything will try to run 10 times faster. Unfortunately the actual CPU clock has not been increased, so the round robin tasker will get into a real mess. In some designs, the tasks will rescheduled before they even complete, this results in a return stack overflow. By controlling the timing and length of the injected burst, relative to the program execution, I can intentionally interfere with the execution and the  results of crypto tasks, such as mutual authentication. Usually the fault vector is through overwrite of the data stack, however when the return stack is messed up, calls to one task can result in returns to another.</p>
<p>It is also possible to combine burst interference with DPA. Usually this method will try to incrementally speed-up the microcontroller task execution until asynchronous tasks interfere. To do this I would normally do an FFT on a suitable length of power analysis.  What you see is the timing sequence for all the software tasks, such as read keyboard every 20 msec, measure temp every 50msec â€¦. these tasks will all speed up, by the incremental change in the effective Xtal frequency( actual freq + injected error). You will also see some tasks that stay at the same repetition frequency. The tasks that change frequency are scheduled as a result of the timer interrupt, and those that stay the same have other real time sources. Since these other tasks are probably interrupt driven themselves, you can use these tasks to interfere with the desired crypto task. (in effect you increase the timer task execution rate until the independent task is exactly harmonically related to the timer task. You can than slowly walk the two sequences across one another and lock when the crypto task occurs. This technique is very powerful, especially if the crypto task disables interrupts during critical adds / multiplies. By doing this you can identify the exact interval over which interrupts are disabled. (on the DPA FFT it shows up as side bands on the independent task spur), the frequency shift of the side band directly gives you the interrupt disable length.  If the code is done correctly, BIG IF, than there is NO information in this task jitter, however it is very difficult to make all code execution paths have identical path lengths and execution time, so observing the disable interrupts interval, directly leaks information about the nature of the crypto task multiplies. From here on the attack becomes a standard timing analysis attackâ€¦</p>
<p>Unfortunately there is no simple way to combine â€œreal worldâ€ real time functionality with the secure computer desire for no information leakage.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145548">

			<div class="comment by-simon-c ">

				<p class="commentcredit">

					<span class="commenter">Simon C</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145548">
						September 28, 2010 10:41 AM					</a>

				</p>

				<p>On my meter the topup is a plastic stick with the contacts protected by a little scabbard.<br />
In order to top up you have to take it to a local shop with the apropriate top up machine and after paying the fee you are given a receipt.<br />
My last one now details this scam and says that the power company knows when you steal electricity.<br />
Also replacement keys are charged at varying prices from Â£30-Â£150 based on the cost of couriering the new key to you. Presumeably to discourage you from having serveral.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145549">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145549">
						September 29, 2010 8:00 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>I appreciate your reply. I&#8217;m adding it to my archives on the topic, to be fully comprehended at a later date. There&#8217;s quite a few of Clive&#8217;s posts in there, as you may have guessed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145550">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145550">
						October 2, 2010 3:00 AM					</a>

				</p>

				<p>@NickP<br />
Nick I just reread what I had posted and realized that it is VERY bad advice to try to implement some of these fixes without understanding the back-doors that the fixes open.<br />
 For instance: detecting high strength E fields is easy using dipole antenna&#8217;s, HOWEVER the very existence to this detector opens the system to a class of overdrive attack. So to properly do this the Dipole inputs need to be protected by external diodes which limit the maxim peak to peak swing to +-0.7V.</p>
<p>IMHO the only real hardware security is to truly believe that you are at least one step ahead of all likely attackers. This knowledge (or lack thereof)  lets you sleep well each night.</p>
<p>What&#8217;s sad  is that your security chip business can prosper, if you can honestly tell the customer how bullet proof the system is.  It really does not matter if this is a statement of your own ignorance, or truly reflects the  advanced level of your hardware security.<br />
 Note this is especially true when you start discussing attacks at a semiconductor  / substrate level.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145551">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145551">
						October 2, 2010 11:19 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>To chase up on papers to do with some of what RobertT has mentioned have a look at this publications page for a &#8220;Reader&#8221; at Queens Uni Belfast,</p>
<p><a href="http://www.ecit.qub.ac.uk/Aboutus/BusinessCard/index.html?name=m.oneill&#038;AllPapers=true" rel="nofollow ugc">http://www.ecit.qub.ac.uk/Aboutus/BusinessCard/index.html?name=m.oneill&#038;AllPapers=true</a></p>
<p>The lady has some chip level knowledge of side channels and has researched into various aspects of them.</p>
<p>@ RobertT,</p>
<p>What brought her to mind was an odd item on Dark Reading about a TRNG which is an almost direct copy from the Uni reasearch center news page about a new Ubiquitous TRNG,</p>
<p><a href="http://www.ecit.qub.ac.uk/News/" rel="nofollow ugc">http://www.ecit.qub.ac.uk/News/</a></p>
<p>The blurb says,</p>
<p>&#8220;Optimised for circuits, FPGA and ASIC, they push efficiency to the limit by using just one logic gate, one look-up table and four transistors respectively.&#8221;</p>
<p>Which as a description just sounds odd&#8230; Almost like a student describing their first project.</p>
<p>However the more interesting bit was,</p>
<p>&#8220;The next step is to find ways of making the generators sufficiently robust to be embedded in devices such as mobile phones, smartcards and RFID tags, and &#8211; where they are used for security applications &#8211; to secure them from attack and develop appropriate countermeasures.&#8221;</p>
<p>The trouble as always with these things is there appears no further info up on the web.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145552">

			<div class="comment by-en4rab ">

				<p class="commentcredit">

					<span class="commenter">en4rab</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145552">
						October 3, 2010 6:21 PM					</a>

				</p>

				<p>Whilst i understand that security is important, in this instance is it the end of the world? Even if a customer fiddles the electric there should still eventually be a day of reckoning where the reading on the electronic meter will be reconciled against the suppliers records of payment made through the meter key topup system, from there on its a matter of threats of court action and adding the discrepancy as a debt to the meter so the user has to pay the outstanding money back over the next X months etc</p>
<p>This is a similar situation i guess to a &#8220;canteen cashcard&#8221; system I have seen where a &#8220;value loader&#8221; is used to put money on a card for use in payment from the canteen/vending machines, the one I am familiar with uses a mifare classic RFID card and it took all of 5 mins to dump it using a Â£35 reader from touchatag, Im fairly sure you could then edit the card to contain an arbitrary value up to Â£655.35  (it stores the value as 16bit integer number of pennys) there is a record of the last 3 transactions on the card, and i would hope there is a record of money added on a back-end server to allow a tally up of money added vs money spent to catch fraud, but im not sure if this is the case and im not going to try to find out.<br />
Interestingly the supplier of this kit has options for Mifare classic/Legic/iClass i haven&#8217;t looked but i assume the legic and iClass cards are the least secure most rubbish of their respective family&#8217;s since the seem to think mifare classic is secure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145553">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145553">
						October 3, 2010 11:09 PM					</a>

				</p>

				<p>@Clive,<br />
   Interesting find, I was not aware of this work.</p>
<p>On reading the TRNG details (as limited as they are) I&#8217;m very skeptical about the ability of the circuit to generate real random results in the presence of modulated Substrate currents and extreme power supply noise.</p>
<p>The problem is always with the Random Noise sampling point. Even very experienced Analog and RF CMOS designers have lots of problems achieving good PSRR (over 70dB) with purpose built custom circuits and lots of balanced  symmetric layout tricks. It is somewhat difficult to believe that one FPGA gate + 4 Fets and a small look-up table will somehow out preform full custom mixer circuits (which is essentially what the RGN sampler does)</p>
<p>At the moment they are apparently keeping their circuit secret. If they send me a schematic and or layout I&#8217;ll gladly review it. However, my guess is they would rather continue to exist (and publish) in blissful ignorance, it is easier to make incredible claims when you know no better.</p>
<p>I&#8217;ll see if I can find out any details of the PUF cells, they also claim to be working on.  I have a feeling that their TRNG might be based on an auto-offset correcting PUF cell plus a non-linear dither table.  This creates a self oscillating continuous time 1st order sigma delta modulator, which in effect folds thermal noise into frequency domain jitter.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145554">

			<div class="comment by-steve-simon ">

				<p class="commentcredit">

					<span class="commenter">Steve Simon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145554">
						October 20, 2010 6:43 PM					</a>

				</p>

				<p>The traditional method of doing this in the UK was to make a play-do mould of the coin the meter takes (used to be 50p). Fill the mould with water and freeze it. Then use the ice 50p pieces in the meter.</p>
<p>All works well until the meter is read and the reading does not match the cash in the coinbox.</p>
<p>Ahh &#8211; them where the days.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145555">

			<div class="comment by-karenwhe ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.prepaidmeters.co.za' rel='external nofollow ugc' class='url'>karenwhe</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145555">
						November 16, 2010 2:00 PM					</a>

				</p>

				<p>Unfortunately this (scams) are also happening in South Africa which is the home of STS technology and prepayment is very widely employed.</p>
<p>Furthermore, municipal meters are stolen then sold as sub-meters at exorbitant prices by people who claim to be municipal employees (some actually are).</p>
<p>By the time the consumer finds out that the meter is useless and it has to be returned to the municipality, it is too late.</p>
<p>Unfortunately consumer knowledge is also very low in regards with utilities and hence scams are wide spread.</p>
<p>Very sad.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145556">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145556">
						December 16, 2010 12:53 PM					</a>

				</p>

				<p>can somebody help me whit mifare algorithm? krack hack i dont know the word, or build or idont know sell it to me somehow? thak you werry much alex contact me at <a href="mailto:sebbank@mail.ru">sebbank@mail.ru</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145557">

			<div class="comment by-wze3369 ">

				<p class="commentcredit">

					<span class="commenter">wze3369</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145557">
						December 23, 2010 11:47 AM					</a>

				</p>

				<p>actually its not a hacked or cracked card. its a stolen engineers key. they issue them to engineers so when they install a new pre pay meter they can check it works an give ya Â£20 or whatever credit plus Â£5 emergency. costs tenner a click in suffolk as far as i know. and if you intersperse it with 5 legit top upsan 1 cheapie it doesn&#8217;t come on top. or hasn&#8217;t yet(as far as i know). @18 months plus of usage. good job anyway,rip off merchant energy companys. i&#8217;d clone an give every pre payer a free Â£20 key if i could cause its only poor people in general need pre pay an pay extra for it!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145558">

			<div class="comment by-lafayett ">

				<p class="commentcredit">

					<span class="commenter">Lafayett</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145558">
						January 11, 2011 11:24 AM					</a>

				</p>

				<p>I was wondering how long it would take for these prepay meters to be hacked. I do know the electric people recently replaced the key as they claimed the old one was broken. Maybe they&#8217;ve gone public now as they have a defense. Either way, wouldn&#8217;t it be simpler to attach a switch to bypass the meter, it&#8217;s virtually impossible to detect &#8216;stolen&#8217; electricity as there are so much losses in the system. I also recall the old method where you plugged in a capacitor that caused the meter to go backwards ..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145559">

			<div class="comment by-dotty ">

				<p class="commentcredit">

					<span class="commenter">dotty</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145559">
						December 13, 2011 5:47 PM					</a>

				</p>

				<p>what if you are accused of fraud and didnt do it? i am getting letters that i bought electricity from a door step seller.</p>
<p>i had requested teh meter be changed over three times and each tiem there was a reason it was not changed.</p>
<p>what would make them think i didi this<br />
i have a debt collector calling me and im not sure what to do- i already told them i suspected the memter was broken as i often would top up te key and no electricity would appear?<br />
how do they keep track bc no on has come to read the meter since i switchde to edf and now ive moved from that property<br />
they are sending me electricity billsnd</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145561">

			<div class="comment by-mutznutz ">

				<p class="commentcredit">

					<span class="commenter">mutznutz</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145561">
						May 1, 2012 10:24 AM					</a>

				</p>

				<p>i had 27 gray master keys for putting lecky on 15pound ones that clears debt as well 25pound ones 20pound and 1pound red keys and green keys and some little box Called a FLAG KEY it says push button to activate key property of northern electric</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-145562">

			<div class="comment by-mutznutz ">

				<p class="commentcredit">

					<span class="commenter">mutznutz</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145562">
						May 1, 2012 10:28 AM					</a>

				</p>

				<p>you can not get caught if you top up as normal they will get its just when you get credit on you doent top up as normal</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-145563">

			<div class="comment by-gary ">

				<p class="commentcredit">

					<span class="commenter">Gary</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/#comment-145563">
						January 11, 2013 6:11 AM					</a>

				</p>

				<p>We need that conman in SA&#8230;. the electricity rate here in South Africa is crazy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/09/new_prepaid_ele.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/09/new_prepaid_ele.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F09%2Fnew_prepaid_ele.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/09/new_prepaid_ele.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3571' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/09/haystack.html" rel="prev">â† Haystack</a>		<a href="https://www.schneier.com/blog/archives/2010/09/the_stuxnet_wor.html" rel="next">The Stuxnet Worm â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
