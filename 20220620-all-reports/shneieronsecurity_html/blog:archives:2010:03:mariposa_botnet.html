<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Mariposa Botnet Shut Down - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Mariposa Botnet Shut Down Comments Feed" href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3299" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3299' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F03%2Fmariposa_botnet.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F03%2Fmariposa_botnet.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3299 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3299" class="post-3299 post type-post status-publish format-standard hentry category-uncategorized tag-botnets tag-crime tag-malware tag-spain">

	<div class="article">

		<h2 class="entry">Mariposa Botnet Shut Down</h2>
		<p>The Spanish police <a href="http://news.yahoo.com/s/afp/20100303/tc_afp/spaincanadausitinternetsoftwarecomputercrime">arrested</a> <a href="http://www.theregister.co.uk/2010/03/04/mariposa_police_hunt_more_botherders/">three</a> <a href="http://www.ft.com/cms/s/0/f6960e5a-2711-11df-b84e-00144feabdc0.html">people</a> <a href="http://news.bbc.co.uk/go/click/rss/1.0/-/2/hi/technology/8547453.stm">in</a> <a href="http://www.timesonline.co.uk/tol/news/tech_and_web/article7047853.ece">connection</a> <a href="http://news.cnet.com/8301-27080_3-10462718-245.html">with</a> the 13-million-computer <a href="http://defintel.blogspot.com/2009/10/mariposa-botnet-analysis.html">Mariposa</a> botnet.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/botnets/" rel="tag">botnets</a>, <a href="https://www.schneier.com/tag/crime/" rel="tag">crime</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/spain/" rel="tag">Spain</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html" rel="bookmark">Posted on March 5, 2010 at 6:02 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html#comments">54 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html" data-title="Mariposa Botnet Shut Down" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-133283">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133283">
						March 5, 2010 6:12 AM					</a>

				</p>

				<p>A single bot is worth around $15 (2007 dollars).</p>
<p>Jason Franklin, Vern Paxson, Stefan Savage, Adrian Perrig. &#8220;An Inquiry into the Nature and Causes of the Wealth of Internet Miscreants&#8221;. ACM Conference on Computer and Communications Security (CCS), ACM, November, 2007.<br />
<a href="http://www.truststc.org/pubs/385.html" rel="nofollow ugc">http://www.truststc.org/pubs/385.html</a></p>
<p>A botnet of 13 million computers would be expected to be worth almost $20M. At a ROI of 2% this botnet should make the owners around $400k a year.</p>
<p>It seems the people behind it lacked the skill to market the botnet. Maybe they lacked even more skills as they were caught.</p>
<p>Another question would be what fraction of the bots would be running Windows?</p>
<p>100%, or more?<br />
ðŸ˜‰</p>
<p>Winter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133284">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133284">
						March 5, 2010 6:16 AM					</a>

				</p>

				<p>Sorry for over posting, but I forgot something.</p>
<p>&#8220;The first member of the gang was arrested in early February, when he inadvertently logged into the network without disguising the address of his computer. &#8221;<br />
<a href="http://news.bbc.co.uk/2/hi/technology/8547453.stm" rel="nofollow ugc">http://news.bbc.co.uk/2/hi/technology/8547453.stm</a></p>
<p>Security is hard, even for a botnet owner.</p>
<p>But Foxyproxy is not that hard to configure?<br />
For this type of operation, I would use a special browser, hardwired into Tor.</p>
<p>Witner</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133285">

			<div class="comment by-aaawww ">

				<p class="commentcredit">

					<span class="commenter">aaawww</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133285">
						March 5, 2010 7:21 AM					</a>

				</p>

				<p>I&#8217;d use an entire virtual machine, on a thumb drive, encrypted with plausible deniability, using a linux guest with twm, tor privoxy and firefox with the user agent changed to be one of the search bot engine</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133286">

			<div class="comment by-sebd ">

				<p class="commentcredit">

					<span class="commenter">sebD</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133286">
						March 5, 2010 7:26 AM					</a>

				</p>

				<p>Sorry if this is a dumb question, but what happens with a botnet once the people behind it are arrested ? The computers won&#8217;t be cleaned of the malicious code. Is it imaniginable that someone takes control over it ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133287">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133287">
						March 5, 2010 7:36 AM					</a>

				</p>

				<p>Hmm,</p>
<p>13 million PC&#8217;s.<br />
Majority of top 1000 Companies.<br />
Infection via Net or Memory stick.</p>
<p>All by &#8220;hackers of less than average ability&#8221;&#8230;</p>
<p>Now imagine if you can what would be the case if the BotNet is covert with near infinite One time Use command channels (I&#8217;ve described how to do this before)</p>
<p>If we look at it they actually made more than one mistake.</p>
<p>The first was their bot net was not covert. This was a business choice they made.</p>
<p>It was recognisable by,</p>
<p>1, it&#8217;s control channel.<br />
2, it&#8217;s upload channel.<br />
3, It was rented out for DoS etc.</p>
<p>They where caught not because of this or their money making techniques but by a simple avoidable error.</p>
<p>I don&#8217;t know about you lot but I think we have a real problem here&#8230;</p>
<p>If you look at the two infection vectors it was set up as a &#8220;fire and forget&#8221; system not a &#8220;directed&#8221; system. Personaly I think &#8220;directed&#8221; attacks have had their day others might disagree (to which I would say look at the stats).</p>
<p>It was capable of crossing &#8220;air gap&#8221; security to infect machines on issolated networks.</p>
<p>What is not clear is if they worked out a way to get data back across the air gap (as the old saying goes &#8220;what goes up must come down&#8221;). Getting the data out is technically slightly easier than getting the infection in, in the first place. Which leves getting the control channel across the air gap, again not an overly difficult technical task (the virus got in).</p>
<p>Now imagine such a system was run not by crooks but a Government.</p>
<p>They would have no need to have the Bot Net pay it&#8217;s way so it could just sit their quietly gathering info on the PC concerned.</p>
<p>When the control channel sends an appropriate check match (such as more than 30% of mail box adressess are .gov or .mil) on the control channel along with send an ID string and mail inbox address. This low bandwidth covert up load channel can then be used to identify speciffic machines in a ver covert way.</p>
<p>Thus it can be used to identify a single target machine and slup out PDFs and Doc files as though the attack had been originaly directed&#8230;</p>
<p>Not all money needs to be made by stealing ID or CC details etc. Sometimes copies of files are way way more valuable and the owner of the file may never know it went missing&#8230;</p>
<p>I&#8217;m waiting to see the rise of the covert &#8220;Info Broker&#8221; botnet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133288">

			<div class="comment by-wiredog ">

				<p class="commentcredit">

					<span class="commenter">wiredog</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133288">
						March 5, 2010 7:57 AM					</a>

				</p>

				<p>From Krebs On Security:<br />
<a href="http://www.krebsonsecurity.com/2010/03/mariposa-botnet-authors-may-avoid-jail-time/" rel="nofollow ugc">http://www.krebsonsecurity.com/2010/03/mariposa-botnet-authors-may-avoid-jail-time/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133289">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133289">
						March 5, 2010 8:21 AM					</a>

				</p>

				<p>@ Winter,</p>
<p>The trouble with figures such as,</p>
<p>&#8220;A single bot is worth around $15 (2007 dollars).&#8221;</p>
<p>Is they have no real meaning.</p>
<p>Let us assume that there was a mythical company called DieBlow that made voting machines. And that they decided to use &#8220;signed code updates&#8221; installed from maintance personel machines (Wintel Laptops).</p>
<p>What sized RSA key could be broken on 13million PC&#8217;s in say 12 hours a day &#8220;slack time&#8221;.</p>
<p>What&#8217;s the chance more than 50% of the maintanence personnel&#8217;s laptops could be identified and subverted?</p>
<p>Finall question what price could you get to buy the presidancy of the USoA?</p>
<p>Something tells me atleast 50USD / machine or 650million USD is not unrealistic for some political parties to raise from &#8220;spare change&#8221; of the offshore companies their supporters own&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133290">

			<div class="comment by-leolo ">

				<p class="commentcredit">

					<span class="commenter">Leolo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133290">
						March 5, 2010 8:34 AM					</a>

				</p>

				<p>400k divided between 5 people is 80k a year.   This is a maximum.  I&#8217;d be suprised that they made as much.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133291">

			<div class="comment by-marq ">

				<p class="commentcredit">

					<span class="commenter">Marq</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133291">
						March 5, 2010 8:39 AM					</a>

				</p>

				<p>I love reading the detailed analysis of the bots.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133292">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133292">
						March 5, 2010 8:49 AM					</a>

				</p>

				<p>@Clive Robinson:<br />
&#8220;The trouble with figures such as,</p>
<p>&#8220;A single bot is worth around $15 (2007 dollars).&#8221;</p>
<p>Is they have no real meaning.&#8221;</p>
<p>If you rent out a botnet, you will get a price per bot.</p>
<p>It is in the paper I mentioned. The authors of the study tried to determine these prices from real bids and came up with fluctuating prices, between ~$5-$20.</p>
<p>So, $15 might be an over estimation, and I should have written $200M for the total price and $4M per year return.</p>
<p>But even at a very low $1 per bot, the botnet would have been worth around $13M. And even a low 1% return would then make $130k per year.</p>
<p>Clearly, the Mariposa botnet did not get the owners that kind of return. Maybe the botnet was simply too big for this market to get a good return.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133293">

			<div class="comment by-seth-breidbart ">

				<p class="commentcredit">

					<span class="commenter">Seth Breidbart</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133293">
						March 5, 2010 9:39 AM					</a>

				</p>

				<p>Winter, rent is per unit time.  If a bot rents for $1, over what period?  (Typical bot rental prices are around $.01/day, +-50%.)</p>
<p>You can&#8217;t have a &#8220;2% of value annual revenue&#8221; on something that lasts for 5 years.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133294">

			<div class="comment by-pj ">

				<p class="commentcredit">

					<span class="commenter">pj</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133294">
						March 5, 2010 9:52 AM					</a>

				</p>

				<p>I love reading detailed analysis of botnets too.</p>
<p>@clive, I love your posts here, and am glad you choose to only use your knowledge for the good ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133295">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133295">
						March 5, 2010 9:53 AM					</a>

				</p>

				<p>For 13 million bots, it would seem the efficiency of the total network was low.  Thus the disillusioned expectation that more bots get more money.  When the return approaches zero, we should see less of this but certain groups are only interested in the stolen data and access, not the money.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133296">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133296">
						March 5, 2010 9:54 AM					</a>

				</p>

				<p>@Seth Breidbart:<br />
&#8220;Winter, rent is per unit time. If a bot rents for $1, over what period? (Typical bot rental prices are around $.01/day, +-50%.)&#8221;</p>
<p>Sorry, the prices quoted are sales. That is, price for transfer of control per bot.</p>
<p>Rent prices could be per run, e.g., one batch of spam, or for a time. But I have no idea whether these rent prices are known. I do not remember whether these were discussed in the study I refer to.</p>
<p>Therefor, I speculate about Return-on-Capital. For an asset worth $13-200M, you would expect a ROC as a percentage, that is, something in the range $100k-4M per year for a 1-2% ROC.</p>
<p>Either their market is simply not large or liquid enough to supply such a ROC. I think their market failed largely because of transaction costs (finding and convincing &#8220;honest&#8221; clients).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133297">

			<div class="comment by-seth-breidbart ">

				<p class="commentcredit">

					<span class="commenter">Seth Breidbart</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133297">
						March 5, 2010 10:03 AM					</a>

				</p>

				<p>Return on capital for a wasting asset has to include depreciation.  A bot worth $15 with a 5-year expected life can&#8217;t rent for less than $3/year or it wouldn&#8217;t be worth $15.</p>
<p>The prices I mentioned are available from a google search; confidential information I have access to agrees with that estimate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133298">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133298">
						March 5, 2010 10:09 AM					</a>

				</p>

				<p>@ Winter,</p>
<p>I think that you misunderstood what I was getting at.</p>
<p>The value of 13million bots is way way higher than the current market price. That is even a one off transaction could if carried out the right way net 0.5BillionUSD at quite low risk to not only them but the botnet as well.</p>
<p>I note from your reply to Seth,</p>
<p>&#8220;Either their market is simply not large or liquid enough to supply such a ROC. I think their market failed largely because of transaction costs (finding and convincing &#8220;honest&#8221; clients).&#8221;</p>
<p>That you are thinking similar thoughts.</p>
<p>If it was me I would be looking at having a &#8220;covert cloud&#8221; ontop of the botnet doing highly parellel tasks that have a high dollar value either directly or indirectly.</p>
<p>For instance what is the value of the private key to sign code for protected devices (mobile phones / DRM etc).</p>
<p>There are a whole host of other things like this that don&#8217;t realy put the bot net at risk or for that matter the operators.</p>
<p>Using such a resource for spam or DoS shows a real lack of ability in the thinking department for these people.</p>
<p>Oh and they don&#8217;t have to find &#8220;honest clients&#8221; but likewise with a little thought the bot net could be laundered for certain types of &#8220;cloud&#8221; activity if they went about it the right way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133299">

			<div class="comment by-uk-visa ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.medivisas.com/' rel='external nofollow ugc' class='url'>uk visa</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133299">
						March 5, 2010 10:15 AM					</a>

				</p>

				<p>&#8216;More than 13 million PCs, in 190 countries in more than half of the worldâ€™s 1,000 largest companies and at least 40 big financial institutions.<br />
The virus was programmed to steal all login details and record every key stroke on an infected computer.&#8217;<br />
&#8230; if these were of less than average ability the more successful bot by the clever guys must still be in play&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133300">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133300">
						March 5, 2010 11:28 AM					</a>

				</p>

				<p>And yet, just a few weeks ago, experts on this very forum claimed that taking out a zombie network in that fashion was impossible.</p>
<p>And yet it was done.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133301">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133301">
						March 5, 2010 11:49 AM					</a>

				</p>

				<p>@Seth Breidbart:<br />
&#8220;Return on capital for a wasting asset has to include depreciation. A bot worth $15 with a 5-year expected life can&#8217;t rent for less than $3/year or it wouldn&#8217;t be worth $15.&#8221;<br />
@Clive Robinson:<br />
&#8220;Oh and they don&#8217;t have to find &#8220;honest clients&#8221; but likewise with a little thought the bot net could be laundered for certain types of &#8220;cloud&#8221; activity if they went about it the right way.&#8221;</p>
<p>Obviously, we agree that these people were unable to capitalize on their botnet.</p>
<p>So this story only helps us to get more frightened about all the botnets that are herded by competent people.</p>
<p>@Brandioch Conner:<br />
&#8220;And yet, just a few weeks ago, experts on this very forum claimed that taking out a zombie network in that fashion was impossible.&#8221;</p>
<p>Who said that the botnet was taken out?</p>
<p>Winter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133303">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133303">
						March 5, 2010 12:06 PM					</a>

				</p>

				<p>@ Brandioch Conner</p>
<p>&#8220;And yet, just a few weeks ago, experts on this very forum claimed that taking out a zombie network in that fashion was impossible.</p>
<p>And yet it was done.&#8221;</p>
<p>Err no it has not in any way been taken out. All that happened was the control channel was disrupted so the bots where not getting instructions.</p>
<p>According to one artical shortly after the control channel was disrupted one of the bot operators bribbed a person working for an IP registry and got part of the control channel back and then turned those bots onto one of the organisations as a DoS taking out not just the company but the ISP and all the other companies that used the ISP.</p>
<p>Worse is Spanish law does not actually prohibit what has been done, so the gentalmen concerned are out and about and free to download the rest of the data they aquired and stashed away.</p>
<p>Realisticaly it looks like they might not even go to trial let alone see the inside of a jail. The Police are looking for evidence of a crime (such as Fraud) to actualy charge them with and from what has been said it looks like that might not even happen.</p>
<p>Which leaves the point so delicatly put by @ sebD,</p>
<p>&#8220;Sorry if this is a dumb question, but what happens with a botnet once the people behind it are arrested ? The computers won&#8217;t be cleaned of the malicious code. Is it imaniginable that someone takes control over it ?&#8221;</p>
<p>In this case the original bot net owners got some of it back.</p>
<p>However the rest of the net is still (in most cases) sitting their waiting for instructions via the control channel.</p>
<p>There is of course the question as to if the operators put a &#8220;deadman&#8217;s switch&#8221; in.</p>
<p>As it was a &#8220;fire and forget&#8221; that had a vector to get across air gaps I doubt that it has a switch and if it has I again doubt it has a &#8220;take the world down with it&#8221; payload.</p>
<p>So the chances are some of the bots will sit there looking for the control channel untill the &#8220;owned PC&#8221; joins the &#8220;great bit bucket in the sky&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133304">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133304">
						March 5, 2010 12:18 PM					</a>

				</p>

				<p>@ Winter,</p>
<p>&#8220;So this story only helps us to get more frightened about all the botnets that are herded by competent people.&#8221;</p>
<p>Not just &#8220;herded&#8221; but &#8220;hidden&#8221; as well.</p>
<p>After some thought on the matter a while ago triggered by hearing some researchers self importantly &#8220;blowing on&#8221; about how they where finding and measuring bot nets therfore they where not realy an issue as they where only used for Spam and DoS and we had mitigation for those.</p>
<p>I sat down and thought about how I would go about it and how I would protect the investment whilst capatalising on it.</p>
<p>Lets be honest Spaming and DoSing are little more than babies scribbling on the paint work with a crayon. It&#8217;s easily visable and easily removable/painted over.</p>
<p>I&#8217;ve got a little more technical knowledge and a slightly more inventive mind and let me put it this way,</p>
<p>Let&#8217;s just say you don&#8217;t want to know the potential of &#8220;covert bot nets&#8221; I thought up if you want to sleep at night.</p>
<p>And I&#8217;m sure there are people with better knowledge and imaginations than my old noggin has these days.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133305">

			<div class="comment by-yt ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.iaarchive.org' rel='external nofollow ugc' class='url'>yt</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133305">
						March 5, 2010 12:31 PM					</a>

				</p>

				<p>@pj Who says Clive only uses his knowledge for good?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133306">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133306">
						March 5, 2010 12:49 PM					</a>

				</p>

				<p>@Winter<br />
&#8220;Who said that the botnet was taken out?&#8221;</p>
<p>That would be the articles that Bruce had linked to. They can be found in the story at the top of this page.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133307">

			<div class="comment by-pj ">

				<p class="commentcredit">

					<span class="commenter">pj</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133307">
						March 5, 2010 2:06 PM					</a>

				</p>

				<p>@clive<br />
&#8220;Let&#8217;s just say you don&#8217;t want to know the potential of &#8220;covert bot nets&#8221; I thought up if you want to sleep at night.&#8221;</p>
<p>Yes we do! ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133308">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter">BF Skinner</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133308">
						March 5, 2010 3:07 PM					</a>

				</p>

				<p>@winter &#8220;these people were unable to capitalize &#8221;</p>
<p>Two drink minimum.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133309">

			<div class="comment by-john-f ">

				<p class="commentcredit">

					<span class="commenter">John F</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133309">
						March 5, 2010 3:45 PM					</a>

				</p>

				<p>@Brandioch:  That article was a little over-simplified (and overoptimistic, to boot).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133310">

			<div class="comment by-jane ">

				<p class="commentcredit">

					<span class="commenter">Jane</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133310">
						March 5, 2010 9:56 PM					</a>

				</p>

				<p>@ Clive &#8211; If you take the time to read the full report and news articles, you would see that you are quite wrong. The botmasters temporarily regained control of Mariposa &#8211; only temporarily. They are not now, in any way, in control of any part of the botnet. The Mariposa Working Group did not simply disrupt the communication &#8211; they took over the command and control structure of the botnet. Yes, the affected computers are still compromised with malware but the people responsible for Mariposa no longer have access via their command and control structure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133311">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133311">
						March 5, 2010 11:43 PM					</a>

				</p>

				<p>It makes me think that the US building one free, medium assurance OS would pay itself off. We mainly focus on securing our computers to protect our assets. One thing botnets and their strength in numbers bring to the forefront is that securing our systems may mean securing <em>their</em> systems too. Their means any vulnerable user with a decent connection. A Linux compatible OS might be a decent start, with kernel extensions to reduce attack surface, a small hypervisor that just maintains kernel integrity (i.e. SecVisor), and a saved, signed trusted state for particular applications in read-only medium. There would be a few certified hardware platforms: desktop; workstation; server; notebook; netbook. I think this would be a few million well spent reducing our attack surface, esp. if open-sourced, analyzed and distributed by foreign sources so foreign users don&#8217;t have to totally trust USA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133312">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133312">
						March 6, 2010 1:07 AM					</a>

				</p>

				<p>@ jane,</p>
<p>&#8220;If you take the time to read the full report and news articles, you would see that you are quite wrong.&#8221;</p>
<p>First do yourself the favour of going back and reading what I wrote will you?</p>
<p>But your use of &#8220;quite wrong&#8221; suggests you are on a PR spin excersise for the MWG so lets go throught it.</p>
<p>You said,</p>
<p>&#8220;The botmasters temporarily regained control of Mariposa &#8211; only temporarily.&#8221;</p>
<p>I said,</p>
<p>&#8216;Err no it has not in any way been taken out. All that happened was the control channel was disrupted so the bots where not getting instructions.</p>
<p>According to one artical shortly after the control channel was disrupted one of the bot operators bribbed a person working for an IP registry and got part of the control channel back and then turned those bots onto one of the organisations as a DoS taking out not just the company but the ISP and all the other companies that used the ISP.&#8217;</p>
<p>What part of this is untrue?</p>
<p>Please note, the articals where not clear just how &#8220;temporarily&#8221; it may or may not be (note deliberate use of present tense).</p>
<p>And they made no comment as to what else the Bot net Operator did with those machines during that time such as maybe putting more malware onto some of those machines as a seed to a new botnet (thus use of present tense).</p>
<p>Hence unlike you looking through rose tinted PR specticals, I have cautiously left it open.</p>
<p>You say,</p>
<p>&#8220;They are not now, in any way, in control of any part of the botnet.&#8221;</p>
<p>Sorry that is not a claim you can justifiably make, there are aproximatly 13million machines out there how can you know what their state is at any one point in time. Some where out of the MWG control for a while and the wake up call was part of the MWG&#8217;s ISP got DoSed. The botnet operators or others currently unknown (there may be more than three, and probably more than three who know how the control channel works) may well have taken over some of them briefly to put on new malware you don&#8217;t know they have not and you cannot watch all 13million (or however many are left) so your stament is of little vaule and sets a possibly false impression that may be more harmfull.</p>
<p>&#8220;The Mariposa Working Group did not simply disrupt the communication &#8211; they took over the command and control structure of the botnet.&#8221;</p>
<p>So if your statment is true you are confirming that others know how the channel works and thus others can work it out and do the same</p>
<p>Thus you are only &#8220;tentativly&#8221; in control of it untill somebody who knows how it works goes and bribes somebody else, etc, etc&#8230;.</p>
<p>You lost control of part of it once unless you take other corrective steps it can happen again such is the nature of the way things work.</p>
<p>Or would you care to give reliable verifiable technical reasons as to why it&#8217;s not going to happen again?</p>
<p>Oh but hang on you partialy confirm what I&#8217;ve said with,</p>
<p>&#8220;Yes, the affected computers are still compromised with malware&#8221;</p>
<p>And go on with,</p>
<p>&#8220;but the people responsible for Mariposa no longer have access via their command and control structure.&#8221;</p>
<p>That is pure supposition on your behalf, the MWG lost part of the botnet once and in all probability it can be done again ad nausium. Don&#8217;t repeat the mistake, just for a bit of PR Spin.</p>
<p>Because you fail to mention your hold on the command and control structure is at best &#8220;tentative&#8221; for a whole host of reasons not just &#8220;bribary&#8221;.</p>
<p>So put your PR spinner back in the box please.</p>
<p>Giving the FALSE IMPRESSION all is well when in all probability it is not, is not doing the MWG or anybody else any favours. In fact it gives many the excuse to do nothing which is much much worse.</p>
<p>The fact is a lot (figure currently not known) of the machines of this bot net are still sitting their waiting for comands and they will do so in many cases untill either proactive action by the machines owner or they get taken off of the Internet.</p>
<p>The exception to this is if there is some way the control channel can be used to modify the malware so it becomes inefectual in some way.</p>
<p>The only problem with this is that in a number of juresdictions (the UK being one) you would be commiting a crime if you did so. So Catch 22, damed if you do damed if you don&#8217;t&#8230;</p>
<p>Thus all anybody (who knows how the control channel works) has to do is get between the MWG faux controller and the infected machine and they can, by usuing a number of well known and less well known tricks get controll of those down stream machines. Thus the closer to the MWG faux controller they do it the larger the number they get.</p>
<p>Would you or somebody else from the MWG care to comment honestly?</p>
<p>Complacency and Spin will only encorage those who should be taking action to put their house in order to carry on sitting on their thumbs&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133313">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133313">
						March 6, 2010 1:38 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Carefull what you wish for ðŸ˜‰</p>
<p>I have in the past noted that you would be safe using a non mutable (ie CD based) OS and no sem-mutable memory. Thus power down and any problems go away.</p>
<p>Well for various reason we have discussed I was &#8220;over optomistic&#8221; on the degree of &#8220;safe&#8221; and should have said &#8220;posibbly safe If, you also&#8230;&#8221;</p>
<p>The one thing this bot net did was use a very old attack vector of virus style infection from removable media&#8230;.</p>
<p>Thus it could cross the &#8220;air gap&#8221; from your Internet PC to your private PC and get at your confidential information&#8230;</p>
<p>Thus it only required two other things,</p>
<p>1, Getting control information across the air gap.</p>
<p>2, Getting the confidential information back across the air gap.</p>
<p>Humans are creatures of habit so if you cross the air gap once the chances are you can do it twice etc, so getting control data in is almost easier than getting the malware in.</p>
<p>Oh and if you think about it as long as the removable media is infected the &#8220;Internet&#8221; PC will just get reinfected the minute the media gets pluged in again&#8230;</p>
<p>Thus the hard part is hiding the confidential data going back to the Internet either on the removable media or the low(ish) bandwidth comms link.</p>
<p>Saddly not all (read most) users can be educated to this fact at a level where it modifies their behaviour.</p>
<p>But there is the issue of AV and zero day&#8230;</p>
<p>Malware writers are getting smart faster than almost everybody else.</p>
<p>If they first stop and think how to capitalise their malware properly (ie not Spam or DoS) and make the bot net properly covert then we are potential going to &#8220;be living in&#8221; some seriously &#8220;interestingly times&#8221;&#8230;</p>
<p>I just wish a few people would wake up to the fact and start thinking seriously about it instead of blowing their trumpets and resting on their laurals.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133314">

			<div class="comment by-yt ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.iaarchive.org' rel='external nofollow ugc' class='url'>yt</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133314">
						March 6, 2010 2:30 AM					</a>

				</p>

				<p>@Nick P: someone is working on it, just not in the US (and the goal is not just medium assurance).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133315">

			<div class="comment by-asdf ">

				<p class="commentcredit">

					<span class="commenter">asdf</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133315">
						March 6, 2010 9:35 AM					</a>

				</p>

				<blockquote><p>
  Who says Clive only uses his knowledge for good?
</p></blockquote>
<p>Who says Clive isn&#8217;t totally talking out of his ass?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133316">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133316">
						March 6, 2010 12:41 PM					</a>

				</p>

				<p>@ vt</p>
<p>I&#8217;d like more specifics. Open-source people have been working on this for decades, but have produced jack. There are already high assurance proprietary solutions that I&#8217;d trust with my life, but not against backdoors. ðŸ˜‰ If you want to see them, then retrieve an older post where I link to all of them by typing this in Google: &#8220;schneier&#8221; &#8220;Nick P&#8221; &#8220;Integrity&#8221; &#8220;Turaya&#8221;. Maybe adding &#8220;MILS&#8221; would help, but I have a ton of links and mentions on a few pages of real things. I&#8217;m aware of many open-source foreign projects, including those that succeeded like seL4, Nova, Nizza &amp; Turaya. We&#8217;d all be better off if you mentioned the name of your sources, as we could evaluate their prospects. I always do.</p>
<p>@ asdf</p>
<p>I sometimes wonder. He&#8217;s undeniably very knowledgeable and brilliant. Much of what he says in esoteric fields checks out from my own diverse 10+ year background. Determining the proportion of Clive&#8217;s comments that are wild ass guesses is an NP-complete problem. ðŸ˜‰</p>
<p>@ Clive</p>
<p>Yes, any information flow between the systems can be a problem. The best we can do is only allow certain types of data and filter them. Thanks to the military, there are tons of these &#8220;cross-domain&#8221; security solutions that have proven quite effective. But, will these things work out to protect ignorant users against sophisticated malware developers? I have doubts. My solution to this problem in the past was multi-pronged: limited file formats; verification that it is in fact that format; trusted or very isolated, execute-only viewers, esp. for PDF &amp; media. I couldn&#8217;t solve proprietary format issues like Word, so I just said to avoid them for others. Besides, RTF is so much more space-efficient &amp; easier to parse. ðŸ˜‰</p>
<p>There is a bigger issue, though. You should have noticed it first when thinking of booting from read-only media. When doing this, one implicitly trusts the platform booting it. Malware authors have successfully attacked each element of this platform: processor bugs; firmware (general); BIOS; cache; PCI/IO subsystems. This is before one even considers the kernel or drivers running in kernel-mode! The attack surface is f***ing huge! Any attempt to make a mass market, medium assurance system will need to solve these problems. The solution will also need to be somewhat seemless. Here&#8217;s a partial I&#8217;ve been toying with: Intel Core Due Extreme (least bugs); quality firmware w/ tweaks to deal with processor bugs; TPM. The Perseus Architecture (see Turaya) is used. The firmware loads a trusted microkernel, services, &amp; drivers first. They use TPM to unlock keys used to load/verify a Linux/Windows VM. Critical signed updates could be hot-loaded, but the main form of update would be getting a new RO memory medium. As in MILS, security-critical services are outside &amp; information flow is very explicit.</p>
<p>It&#8217;s not high assurance, though, as the kernel &amp; trusted functions aren&#8217;t as verified &amp; covert channel reduction not as strong. More than good enough as a seemless, security improvement for average user. Could eliminate read-only media with a PC made to work with high assurance kernels, like INTEGRITY on Dell Optiplex. Then, the software would be trustworthy enough to ensure execute- and read-only file operations.  The medium assurance version, though, is a nice stepping stone &amp; wouldn&#8217;t require a serious hardware conversion for the better medium assurance version that features high assurance components.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133317">

			<div class="comment by-guess-who ">

				<p class="commentcredit">

					<span class="commenter">Guess Who...</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133317">
						March 6, 2010 1:38 PM					</a>

				</p>

				<p>Ass<br />
Spouting<br />
Daft.<br />
Formulation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133318">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133318">
						March 6, 2010 5:13 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;Determining the proportion of Clive&#8217;s comments that are wild ass guesses is an NP-complete problem.&#8221;</p>
<p>Hmm not sure myself, but rumor has it I am human so I must be fallible 8)</p>
<p>Seriously though, even what appears &#8220;wild ass&#8221; is usually verifiable by simple logical steps, that are usually well within others comprehension. It&#8217;s just that they don&#8217;t see the connection untill you walk them through, then you get that &#8220;well that&#8217;s obvious look&#8221;.</p>
<p>With regards the issues,</p>
<p>&#8220;Yes, any information flow between the systems can be a problem. The best we can do is only allow certain types of data and filter them.&#8221;</p>
<p>What it boils down to in the end is not allowing external data to become code</p>
<p>Easy to say but&#8230;</p>
<p>&#8220;Thanks to the military, there are tons of these &#8220;cross-domain&#8221; security solutions that have proven quite effective.&#8221;</p>
<p>Yes and in general they have a large chunk of &#8220;Not User Friendly&#8221; attached to them.</p>
<p>&#8220;But, will these things work out to protect ignorant users against sophisticated malware developers? I have doubts.&#8221;</p>
<p>I&#8217;m not sure that there are actualy that many &#8220;ignorant users&#8221; out there. The problem is better looked at one of the &#8220;utility of resources&#8221;. That is a user regards a computer in the same way they do their car or mobile phone, they have a function to make their life easier, such that they can get better utility out of their time.</p>
<p>If you think about it even your averagely smart malware writer is well well ahead of the game. And almost the entire security industry is having to fight managment to even have a voice, let alone resources.</p>
<p>Mainly because managment&#8217;s view is not one of security but &#8220;liability&#8221; limitation/mitigation/externalisation, which means &#8220;safe doors on tents&#8221; because SabOx / PCI / HIPPA et al are effectivly perscriptive not advisory, mainly so auditors can have tic box checklists.</p>
<p>And to be honest I&#8217;m not sure of a way in the current climate of how you would jump managment out of the view. Especialy with &#8220;self regulation&#8221; and those auditing dependent directly for their income from those they audit.</p>
<p>Most security products get designed to meet the  tic the boxes on the auditors checklist, irespective of if it makes sense or not (BF Skinner&#8217;s example of two passwords = two factor authentication&#8230; being a prime example).</p>
<p>Any way there are still some people out there that realise the difference between faux checklist security and actual security and are actually prepared to devote a few resources to it.</p>
<p>&#8220;My solution to this problem in the past was multi-pronged:&#8221;</p>
<p>Always a good way especialy if you get 100% or more overlap from area to area.</p>
<p>&#8220;limited file formats; verification that it is in fact that format;&#8221;</p>
<p>Ouch, not easy at the best of times and with the likes of XML it is a hairs bredth from being interpreted code.</p>
<p>&#8220;trusted or very isolated, execute-only viewers, esp. for PDF &amp; media.&#8221;</p>
<p>That is almost game over as much media these days is effectivly interprated code not data</p>
<p>&#8220;I couldn&#8217;t solve proprietary format issues like Word, so I just said to avoid them for others.&#8221;</p>
<p>Yes most MS files are alowed to contain either code or linked/hidden data that can be used as code by something else (ie IE components).</p>
<p>Besides, RTF is so much more space-efficient &amp; easier to parse. ðŸ˜‰</p>
<p>Hey how about WordStar 4 8)</p>
<p>&#8220;There is a bigger issue, though.&#8221;</p>
<p>Saddly there are many, not all of them obvious even with 20-20 hindsight.</p>
<p>&#8220;You should have noticed it first when thinking of booting from read-only media. When doing this, one implicitly trusts the platform booting it.&#8221;</p>
<p>Put simply &#8220;anything semi-mutable&#8221; and it&#8217;s potentialy game over.</p>
<p>&#8220;Malware authors have successfully attacked each element of this platform: processor bugs; firmware (general); BIOS; cache; PCI/IO subsystems.&#8221;</p>
<p>Yup and it&#8217;s going to get worse with time with &#8220;PnP interfaces&#8221; etc. DMA from I/O is just plain nasty</p>
<p>&#8220;This is before one even considers the kernel or drivers running in kernel-mode! The attack surface is f***ing huge! Any attempt to make a mass market, medium assurance system will need to solve these problems.&#8221;</p>
<p>My viewpoint is actually go for much finer granularity than the kernal. That is think parellel processing and scripting, with functions running in jails with signitures on not just the function but it&#8217;s IO as well (my Prison -v- Castel view).</p>
<p>&#8220;The solution will also need to be somewhat seemless.&#8221;</p>
<p>That&#8217;s the big problem irrespective of which way you go, it&#8217;s almost always going to end up a &#8220;start from scratch&#8221; approach.</p>
<p>&#8220;Here&#8217;s a partial I&#8217;ve been toying with: Intel Core Due Extreme (least bugs); quality firmware w/ tweaks to deal with processor bugs; TPM. The Perseus Architecture (see Turaya) is used.&#8221;</p>
<p>TPM has it&#8217;s issues as I&#8217;m sure you are aware (and no I&#8217;m not talking the DRM debate for others tagging along on this).</p>
<p>&#8220;The firmware loads a trusted microkernel, services, &amp; drivers first.&#8221;</p>
<p>Bang, how does the firmware know it&#8217;s not running in a virtual machine?&#8230;</p>
<p>(Hence my fondness for talking about &#8220;limited resource jails&#8221; and hardware hypervisor checking &#8220;resource signitures&#8221; (such as time etc).</p>
<p>&#8220;They use TPM to unlock keys used to load/verify a Linux/Windows VM.&#8221;</p>
<p>Ok as long as the keys have usefull meaning (in some systems they actualy don&#8217;t, and in others the keys are weak for various reasons). It is very very difficult to get 90% right and is very viewpoint and assumption dependent.</p>
<p>&#8220;Critical signed updates could be hot-loaded,&#8221;</p>
<p>As you know I&#8217;m no real fan of &#8220;signed code&#8221; it actually means very very little in practice. Essentialy all it means is &#8220;Fred Smith has locked a binary file&#8221; on such and such a date etc. It in no way says anything about the quality of the binary file.</p>
<p>&#8220;but the main form of update would be getting a new RO memory medium.&#8221;</p>
<p>It has the same problem.</p>
<p>I&#8217;d like to see &#8220;execution signitures&#8221; as well whereby any code can be externaly monitored and checked whilst it is executing. But this means significantly reducing complexity to make the signitures more easily checked.</p>
<p>But I know this not going to happen this side of Xmass (2020 8(</p>
<p>&#8220;As in MILS, security-critical services are outside &amp; information flow is very explicit.&#8221;</p>
<p>Thus stepping towards 2020 ðŸ˜‰</p>
<p>&#8220;It&#8217;s not high assurance, though, as the kernel &amp; trusted functions aren&#8217;t as verified &amp; covert channel reduction not as strong.&#8221;</p>
<p>It&#8217;s actually about as far as you can go on a &#8220;single system&#8221; without aditional external monitoring.</p>
<p>&#8220;More than good enough as a seemless, security improvement for average user.&#8221;</p>
<p>Hopefully ðŸ˜‰</p>
<p>&#8220;Could eliminate read-only media with a PC made to work with high assurance kernels, like INTEGRITY on Dell Optiplex. Then, the software would be trustworthy enough to ensure execute- and read-only file operations.&#8221;</p>
<p>The hardware is still the Achiles heel though and DMA is a no no as is direct IO of any form.</p>
<p>&#8220;The medium assurance version, though, is a nice stepping stone&#8221;</p>
<p>It would cut a lot of the problems we currently see (known knowns) and quite a few we can forsee (known unknowns). However I suspect malware will &#8220;evolve&#8221; is such a system gains traction.</p>
<p>It&#8217;s a bit like the pointless &#8220;Linux has less malware than MS&#8221; argument. The reason is more to do with market share than technical superiority. You shine a powerfull enough light on a steel plate and eventually it will get through it&#8217;s just a matter of time, determination and incentivisation.</p>
<p>And of course there is always going to be that user to do a handy end run around the technical security&#8230;</p>
<p>Which is where we started.</p>
<p>So step 1 on the master plan,</p>
<p>1, Eliminate all users&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133319">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133319">
						March 7, 2010 12:44 AM					</a>

				</p>

				<p>@ Clive</p>
<p>Ah, I like the response. At first, I was thinking: &#8220;he had to respond to everything point by point&#8230;&#8221; but then I realized it might be easier for other readers to follow than your usual essays. That is, the organization scheme and context are readily available. Ok, so my response.</p>
<p>&#8220;not allowing external data to become code&#8221;</p>
<p>Don&#8217;t think it&#8217;s that simple, although that&#8217;s a nice start. I think the rule is more abstract: not allowing external data to cause unauthorized behavior. This covers cases where the intentionally malformed data causes unwanted effects, although the system never classifies it as code because it doesn&#8217;t actually execute. It just causes side effects.</p>
<p>On &#8220;Not User Friendly&#8221; cross-domain and user ignorance&#8230;</p>
<p>We are on the same page on Not User Friendly: that&#8217;s why they&#8217;ll usually fail except in certain careful corporate implementations. As far as ignorant users, I assure you they exist and in mass. When I got laid off from one security-related job, I ended up on self-checkout at a retail store. The system was ingeniously designed from a usability perspective: one basically didn&#8217;t have to think to operate it. However, there were always a steady &amp; very significant percentage of people who would do incredibly stupid things. These things were so stupid the other customers laughed when told about it. Even when told the problem, many would continue to try the same thing. So, I think the people and situations you described are definitely correct, but we can&#8217;t rule out people doing dumb things regularly. If the percentage I saw is indicative of national techno-dumbness, then there would be over ten million people whose dumb decisions would destroy a mass-market cross-domain solution.</p>
<p>on format &#8220;game over&#8230; much media&#8230; is interpreted code not data&#8221;</p>
<p>I think we&#8217;re quibbling over abstractions here. One could say that all data is code in any event-driven system because it determines the sequences of actions. A person in control of the inputs is essentially a real-time imperative programmer. ðŸ˜‰ It&#8217;s not really game over, though. If the media viewer&#8217;s behavior is well defined and validated well, the worst the attacker can do in certain formats is try to use more CPU/memory resources than expects. Big deal: we just kill the program. I mean, a Word document or modern full-featured PDF might as well be code. But, certain subsets of them are more like flexible, interpreted data. That can be done carefully, as Java, RTF and HTML (w/o JavaScript) demonstrate. Safe viewers can be made.</p>
<p>On low-level hardware issues&#8230;</p>
<p>Yes, Plug-n-Play has become more than an interface: it&#8217;s a philosophy solely rooted in usability. That&#8217;s nice until security is concerned. I&#8217;ve often joked it should be called Plug-n-PRAY. ðŸ˜‰ We still haven&#8217;t found common ground on the castle vs. prison view, as you call it. All this signature tracing, special IO formats, parallel&#8230; I don&#8217;t see regular code monkeys doing it right or even caring. However, we have built castles that lasted, like Gemini Network Processor for confidentiality/integrity or IBM mainframes for availability and certain degree of isolation. We even have a platform that verified the processor (AAMPG7), firmware, kernel (INTEGRITY-178B), and trusted components. Like Gemini, they took a layered and secure composition approach that&#8217;s proven itself over time.</p>
<p>The most recent addition to castle model is MIT&#8217;s Aegis secure processor. It doesn&#8217;t trust the RAM, IO, etc. It&#8217;s a lot like TPM in the use of root of trust &amp; secure load &amp; attestation. However, the loading and trust starts inside the processor itself and it keeps hashes of external RAM and IO stuff, checking it regularly. It can also verify signed updates to critical portions. It has onboard cryptographic acceleration and does all of its trusted comp. functionality with just a few extra instructions. If one wants to build the ultimate next-gen castle hardware, they find a better CPU. I&#8217;d like a similarly trusted IOMMU, though, with authenticated communication with the CPU. I can&#8217;t imagine all of this having a high rate of speed, though. Maybe start with embedded stuff.</p>
<p>Additionally, we could combine my Castle and embedded server board ideas with your prison view to use a bunch of small, embedded Aegis-style chips running in parallel. The totality of these, along with a Master node, become the system. One node would be the GUI or user-facing portion of each app, with the others acting as a compute node with trusted boot, load, and (when done with app) purge. Servers would be the first useful application, but one could put a bunch in a desktop tower with KVM for a secure PC. ðŸ˜‰</p>
<p>&#8220;how does the firmware know it&#8217;s not running in a virtual machine?&#8221;</p>
<p>Similar to the Chinese room argument or those that say it&#8217;s impossible to tell reality from a granular-enough simulation if reality is simulatable. Hardware hypervisors can be probed for keys and then simulated. At some point, we have to trust something. If we wanted a medium assurance, it would start with the CPU itself in some hardwired bootloader. It loads and verifies the initial firmware. Then, the firmware loads any signed updates, using the hardware verification function. Once firmware is loaded up, then the OS can be loaded similarly or with a regular TPM. The processor is the root of trust. It must work. The TPM just builds on it. TPM is useful because there are several inexpensive chips on the market, along with plenty of software support even for high assurance vendors. Again, it&#8217;s just a building block, not the root of trust.</p>
<p>&#8220;DMA is a no no as is direct IO of any form&#8221;</p>
<p>Hence the IO MMU. There is one in vPro chipset, which that Dell Optiplex has. It&#8217;s MMU+IOMMU+TPM+IntelVT+securekernel = much_improved_software_security. The only worry there is implementation flaws, which vPro had from the go. The IOMMU&#8217;s restrict DMA device access to certain memory regions. Trusted firmware, secure kernel, medium assurance IOMMU, and carefully orchestrated protocol for granting/revoking access to memory regions solves this problem if we use castle approach. Device firmware that has access can be subverted at some point, but MILS approach only gives it minimal access to begin with. A random PCI card&#8217;s subverted controller doesn&#8217;t read the RNG&#8217;s internal entropy state. It&#8217;s either an IOMMU or custom, slower, non-x86 CPU with baked in security. Which will users pay for?</p>
<p>&#8220;It&#8217;s a bit like the pointless &#8220;Linux has less malware than MS&#8221; argument.&#8221;</p>
<p>I don&#8217;t think so. We&#8217;re talking the difference between low-defect development approaches of highly modular, predictable software with standard software development approaches of mixed-up, complex software. It&#8217;s &#8220;correct by construction&#8221; vs. &#8220;penetrate and patch.&#8221; Penetrate &amp; patch gives quick time to market, plenty of features, maybe low cost, and a ton of bugs. Correct by construction give only core feature set, slower time to market, cost increase, and little to no bugs. The Linux vs. Microsoft argument is about incentives to attack two software that are considered similarly buggy. I mean, sure more attackers and incentives will result in more existing bugs found in low-defect software. The point is that medium assurance, low defect software has far fewer latent bugs and, as experience shows, most of them have minimal (or unnoticeable) impact. Let attackers move from hitting Linux platforms to BAE Systems&#8217; XTS-400 platforms: they aren&#8217;t going to get far trying to subvert XTS-400&#8217;s TCB with infected Word documents or automated worms. They&#8217;ll stop at user-mode data consumers and integrity mechanisms might even prevent that from going far. Like med. assurance software in general, it&#8217;s architecture, development methods, testing and maintenance are just that much better.</p>
<p>&#8220;So, step 1 on the master plan: eliminate all users.&#8221;</p>
<p>If I said I was with you on that, it would be considered conspiracy to commit genocide. So, I&#8217;ll say it&#8217;s a great idea that I [cough] would never want to see happen [cough]. We can fantasize, though, by popping in Terminator 3 and watching Skynet solve all humanity&#8217;s security problems. (Well, it creates a certain &#8216;availability&#8217; problem for the human system ðŸ˜‰ The Matrix puts an interesting spin on it: from a certain perspective, the machines are the users/consumers and the people are the producers. We move from the top of the food chain to the very bottom&#8230; in one script. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133320">

			<div class="comment by-jane ">

				<p class="commentcredit">

					<span class="commenter">Jane</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133320">
						March 7, 2010 10:25 PM					</a>

				</p>

				<p>@Clive &#8211; Hi. To be clear, I am in no way associated with the MWG, I am simply a curious (if somewhat less knowledgeable) bystander. I think you raise a lot of valid points, I was simply trying to clarify what I thought was an error, but which may have just been a misunderstanding on  my part. I thought you were under the impression that the MWG had only briefly taken over the c&amp;c structure.. re-reading your comments now, I see that this isn&#8217;t what you were saying. Yes, the botnet could potentially be regained by someone, somewhere, you are correct. And yes, the machines (as has been reported elsewhere) were infected with additional malware that the MWG does not necessarily have a view of and that could lead to misuse in other manners. This is my first time posting here and I didn&#8217;t intend to start things off on the wrong foot &#8211; my apologies if I (as usual) managed to stick that foot right in my mouth.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133321">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133321">
						March 8, 2010 12:12 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;Additionally, we could combine my Castle and embedded server board ideas with your prison view to use a bunch of small, embedded Aegis-style chips running in parallel. The totality of these, along with a Master node, become the system.&#8221;</p>
<p>The hardware sounds like it&#8217;s as close as it&#8217;s going to get without going fully custom (not that that is to much of an issue these days).</p>
<p>From the OS etc side if you say your &#8220;castle&#8221; is the &#8220;Prison Gov &amp; Warders&#8221; then you are 99% of the way there, but coming from the top down not the bottom up.</p>
<p>The bottom up aproach adds some interesting twists that improve on what the top down aproach will give you.</p>
<p>And oddly with the bottom up aproach it&#8217;s all mostly for free because of engineering in the &#8220;sweet spots&#8221;.</p>
<p>First a little boring history as to how I arrived at the basic design.</p>
<p>The idea all started with a thought almost identical to your,</p>
<p>&#8220;I don&#8217;t see regular code monkeys doing it right or even caring.&#8221;</p>
<p>I&#8217;d like to say it all started at a security event for programers a few years back however the idea had been bouncing around my head one way or another for quite some time before that (actually nearly 20 years ago when I was thinking about doing a PhD. But could not find &#8220;Readers&#8221; to act as supervisors because they didn&#8217;t get the problem&#8230;)</p>
<p>Any way back to the  security sminar which was little more than an informal side event at another larger event.</p>
<p>The bod out front asked how many years production application programing time people had had, and it varied but averaged around 12 years across something like 50 people. So something like 600 years nose to the grind stone experiance give or take a little.</p>
<p>The bod out front then asked how many had had formal security training. Lets just say the total was around 2 days amongst the 50 or so production programers there&#8230;</p>
<p>So ~2days in 600 years in production code cutting or a ~1 day in 100,000 days (most progs work more than 7 days a week equivalent even if not paid for it)&#8230; And the programers at this walkin session where there because they had a personal incentive to be there. I dread to think what the rest of the industry average was like.</p>
<p>Yes it was starting to change more recently but then, well first some major companies and then the banks gave the world the one finger salut and in the resulting economic climate it has regressed more than ten years in many respects in about the length of time it takes to blink twice (or atlrast thats what it feels like).</p>
<p>Thus you can probably sympathise with my view that it is a waste of time trying to resolve the security problem any time soon by education of &#8220;regular code (cutting) monkeys&#8221;. Irespective of if they want to make the effort managment etc are just not going to let it happen, 99 times in a 100 the urrent managment view is &#8220;liability mitigation&#8221; not &#8220;security&#8221;, (which means the money goes to auditors).</p>
<p>I&#8217;ll admit I&#8217;m perhaps a little jaudiced but on the &#8220;computing side&#8221; I come from a CLI and Embedded background. Unlike most code cutters I&#8217;d had to cut my own BIOS / OS etc as well as the application on top and get it out the door with &#8220;no patches possible&#8221; (yup that&#8217;s the way it used to be ;). We had to be engineers not artisans or artists.</p>
<p>Also due to when I entered the industry I&#8217;d designed the actuall logic circuit guts of what we blythely call CPU&#8217;s, and cut the state machines and microcode to bring them to life from a handfull of 74Sxx chips (anyone apart from me or NASA remember the 181?) or ECL.</p>
<p>Basicaly I&#8217;ve lived with abstracting design up the stack and seen how the faults slide in proportional to the abstraction and now get left to &#8220;patch tuseday&#8221; etc (and lets say I&#8217;m less than impressed with it).</p>
<p>You may know the current 10/20/30/40 rule of &#8220;application code error causes,</p>
<p>10% = Business logic errors.<br />
20% = User input errors.<br />
30% = Data timing errors from back end systems etc.<br />
40% = Unknown &#8220;glitches&#8221;.</p>
<p>The industry clearly has significant growing pains from the Terminal/CLI days. Only 30% of the errors are down to &#8220;human issues&#8221;, 70% are down to code cutting issues. Much of which is due to code cutters not understanding &#8220;state&#8221; and &#8220;timing&#8221; or they and others how to &#8220;Stress-n-Test&#8221; for them (regression testing only catches &#8220;Known Knowns&#8221; and a few &#8220;Known Unknowns&#8221; as for probablistic testing or &#8220;fuzzing&#8221; that&#8217;s what the users to do better&#8230;).</p>
<p>If you reflect on this sad state of the idustry and ignore the needless bells and whistles of the GUI etc for a minute you will see in many ways we are a lot lot worse off than the old &#8220;Unix Scripting Methodology&#8221; days. Mainly because we have very much got component re-use wrong, not just from the security asspect, but in general.</p>
<p>However also reflect abit on the Unix method and you will realise it is about as far as we&#8217;ve got in realistic &#8220;security seperated&#8221; code re-use.</p>
<p>You have three parts, the OS provides the plumbing and the CL utilities provide the base functions, and the script provides the overall program logic.</p>
<p>You see a simple but elegant split of duties with it. You have a script telling the OS to line up functions and the required plumbing to push the data through to achive good solid results.</p>
<p>So good infact that some systems that used the method to &#8220;Rapid Application Design&#8221; found they did not actually need to code much up (and in the case of many SysAdmins they had better things to do with their time).</p>
<p>In fact a new generation of Unix scripters came along with early web Common Gateway Interface (CGI) scripts for early web design. And guess what we are going to see similar pop up again with Cloud Computing.</p>
<p>Scripting this way is interesting because of the seperation, and how it also alows parellel threads to run etc.</p>
<p>Impoertantly though the OS takes care of a big chunk of &#8220;State&#8221; and &#8220;timing&#8221; which the script writer usually does not see or care about as it just happens. The (apparent) limitations of the CLI functions force the script writer to remove (needless) complexity and (usually) deal with exceptions. Oh and it is usually fairly clear at what point in the script things break thus making testing easier. All of which are good ðŸ˜‰</p>
<p>So what about &#8220;security&#8221;,<br />
if you think about it as long as the OS does the plumbing and data access securely then the script writer does not need to know about the low level security only the high level security. Thus a big chunk of the problem is taken off of them and they can get on with the business logic etc (saddly Unix security sucks by current needs and it needs addressing).</p>
<p>Thus you have small generic functions (ls / tr / grep etc) that act like filters. They have no need of security in general because of the way they work. That is the OS hands them data they filter it and hand the result back to the OS.</p>
<p>It is the OS that actually does the security via file permissions etc.</p>
<p>However there are issues with this the first is the Unix Security model is way way to granular and way way to limited in scope (though some tools etc have improved this quite a bit). The second is the functions have become bloated and overly complex for what they do 99% of the time and that is bad for security.</p>
<p>It also gives rise to huge globs of needless code which makes things oh so inefficient.</p>
<p>So sadly the code cutters won the day by weight of numbers and other scripting methods with less seperation etc where brought in. And some have been very very successfull but done baddly.</p>
<p>We see this problem with the proliferation of code libs that are available (have a look at the Perl CPAN resource or the Python equivalent to see what can happen with scripting libs).</p>
<p>Unfortunatly we have lost the seperation and thus the security and other desirable asspects in most cases ðŸ™</p>
<p>Now I have also had cause to think a little on Turing and Goedels little problems (halting and undecidability etc). And realised yes you could do an end run around them&#8230;</p>
<p>The problems arise mainly because it is a &#8220;single&#8221; universal engine &#8220;observing it&#8217;s self&#8221; effectivly &#8220;from within&#8221;, and there is no formal seperation of code and data.</p>
<p>So I thought OK lets keep the universal engine with all it&#8217;s faults and many many advantages BUT we would add a second non universal engine to keep an eye on it.</p>
<p>How does that change the equation? Well actually in a limited domain such as a security hypervisor it changes it a great deal (it does not 100% solve it but that is another issue).</p>
<p>For security this second engine does not have to be universal at all (a simple &#8220;all states known&#8221; state machine will do). And you can make it in such a way that it always fails safe. You can remove &#8220;general looping and branching&#8221; and in many ways make it very like a DSP system that processess data but does not act on the data except when a limit is reached in which case it fails to safe (ie halt in this case). Oh and the data it processes is not the script data but the signitures that arise from the functions of the script executing in the Universal engine which is why a DSP like system is fine.</p>
<p>Further you do not have to use the rather useful von Neuman architecture, a simplified Harvard architecture is actually better for the job. Thus you can further seperate code and data compleatly (under certain constraints).</p>
<p>Thus you have your von Neuman universal Turing engine being watched by a subset of the Harvard architecture which is also a limited not universal engine.</p>
<p>Thus Turing and Goedel still get to play in the universal engine but Einstien belives his determanistic God of the Harvard engine is watching over them (he still gets to play dice though ðŸ˜‰</p>
<p>Thus you move from the notions of &#8220;security is not possible due to Turing and Goedel&#8217;s problems&#8221; and &#8220;security is only possible in a fully known state machine&#8221; to the working middle ground.</p>
<p>Mathmeticians have already done this with a similar problem at Los Almos where Monte Carlo methods came to life (so the idea has a pedigree ðŸ˜‰<br />
Thus you could call it Monte Carlo or probabalistic security.</p>
<p>So much for the over view.</p>
<p>1) Now if you simplify the view point a bit there are two basic types of security breach issues based around the inherant faults of the von Neuman &#8211; Turing engine,</p>
<p>1.1, It occures by accidental combination of faults.</p>
<p>1.2, It occures by the deliberate excercising of faults.</p>
<p>The second is AKA Malware.</p>
<p>Take a leap of faith for now that the accidental faults can effectivly be stopped by the system I&#8217;m outlining, I&#8217;ll come back to it later.</p>
<p>The issues with Malware are actually quite simple to describe it is &#8220;extra code&#8221; that &#8220;should not be there&#8221;.</p>
<p>2) Malware comes in two basic forms,</p>
<p>2.1, Built in.<br />
2.2, Later additions.</p>
<p>The first I shall call &#8220;Malicious code&#8221; not Malware. The distinction is important because of the assumption that the code is &#8220;known to be good&#8221; when in fact it is not. And it is the main reason the current fad of &#8220;signed code&#8221; is currently a bit pointless (except where pointing the finger is concerned).</p>
<p>Malicious code &#8220;should be&#8221; detectable / preventable to a certain extent by formal methods used in the design and build. But it&#8217;s early days on this and there are a lot of steps between current formal methods and code signing which are not covered thus allow plenty of scope for malicious code to be slipped in unnoticed.</p>
<p>Malware is what attackers add to a previously &#8220;known good&#8221; system to excercise inherant faults.</p>
<p>Importantly it is tangable &#8220;extra&#8221; code.</p>
<p>3) For this extra Malware code to survive even casual observation it has to be able to hide,</p>
<p>3.1) Malware is usually &#8220;trivialy&#8221; easy to find on a system that is not running. Simply by checking mutable memory (file systems etc) signitures etc. That is, it is &#8220;trivial&#8221; to determin on a byte by byte basis not to say it is &#8220;trivial&#8221; in time or work load. The exception of cause is those dynamic &#8220;pesky user&#8221; files&#8230;</p>
<p>3.2) To hide on a running machine Malware needs redundancy in the system it is on to set up what is in effect a Virtual Machine.</p>
<p>4) Two points arise from this Malware VM view,</p>
<p>4.1, If it cannot have the required resources it cannot hide.</p>
<p>4.2, No VM is perfect, time based and other signitures will reveal it&#8217;s existance.</p>
<p>5 ) The less resources Malware has the easier detecting it becomes.</p>
<p>That is because it has less ability to camoflage it&#8217;s self, and detect probing and fake responses.</p>
<p>Importantly this is not a linear trade off which means there are sweet spots to be exploited.</p>
<p>And this is why bottom up as oposed to top down has advantages because in general it&#8217;s at the bottom where you find the best sweet spots.</p>
<p>[To see this think of car safety, that is a car seat belt is only &#8220;so so&#8221; you can spend more money but each linear step in safety comes at a power law or exponentialy increasing cost. Sometimes the cost curve is so steep it might as well be a brick wall. Likewise with an air bag.</p>
<p>However use both an air bag and a seat belt you get improved safety.</p>
<p>But&#8230; You can depending on the curves get improved safety using less expensive seat belts and air bags. And if you design them into the system from the start you effectivly get your improved safety for free or less&#8230;</p>
<p>You can do the same with other safety features like crumple zones and SIPPs etc. Thus get a quite dramatic increase in safety but for no additional cost.]</p>
<p>You just have to work within the design sweet spots from the very early stages of the design to get the best advantages by makeing the appropriate trade offs.</p>
<p>6) One trade off is if you take your program appart into little tasklets or fuctions etc the resource required for each part is fairly easy to calculate in most cases and there are libraries of code already in existance for parellel processing to show how to do this effectivly.</p>
<p>Thus, say you have 20 little von Neuman &#8211; Turing engines, you can limit the amount of RAM or CPU cycles or input or output, for each one to give it just sufficient resources to do the job and no more.</p>
<p>Thus each is a jail cell tailored to the requirment the function running inside it and very little more.</p>
<p>This put&#8217;s preasure on the Malware in more than two ways.</p>
<p>6.1) The first is it does not have sufficient resources in any cell to be able to achive very much let alone hide via a VM.</p>
<p>6.2) The second is it cannot unlike the desired program communicate from cell to cell simply.</p>
<p>6.3) Thirdly if the tasklets are sufficiently small their complexity is low thus their charecteristics are much more easily calculated thus they can be for the whole program.</p>
<p>6.4) Forthly in a scripting language the functions can have base signitures without knowing what programe is going to use them. As long as certain bounds are known just before they are used the signiture can be calculated.</p>
<p>7) Due to this the programer does not need to know what the signiture is or care, they just have to know what the bounds are and pass them to the fucnction control channel.</p>
<p>Thus the OS tasking the script has three parts to it that. The first traditional Unix two that,</p>
<p>7.1, load the function (puts the tasklets in the jails).</p>
<p>7.2 Connects the plumbing between the functions that the data traverses.</p>
<p>Note I don&#8217;t say objects for good reason, as most object implementations are designed to be efficient not secure, and thus can leak/mix code with data etc. They also tend to be overly complex as well&#8230;</p>
<p>It is the third bit where the security happens.</p>
<p>7.3, Each function sitting in it&#8217;s jail is fed data by the OS has and has results taken away by the OS as normal. However unlike normal the OS also monitors these channels to ensure they stay within the security signiture bounds.</p>
<p>Further every so often the function is suspended and the jail is searched for contraband (ie extra code or data that should not be there).</p>
<p>7.4) The price that has to be paid is basically in &#8220;cheap&#8221; CPU workload not in &#8220;expensive&#8221; programer effort. And CPU ability doubles about every year for the same cost whilst programers want pay rises each year&#8230;</p>
<p>8) Now this brings us back to the original point,</p>
<p>What is the difference between the Castle and prison.</p>
<p>Actually very very little they both have,</p>
<p>8.1, A person in charge (Duke/Govnor).</p>
<p>8.2, Trusted staff (Knights/Wardens).</p>
<p>8.3, Restricted enviroments where limited trust workers work (Serfs/Trusties)</p>
<p>8.4 Closed environments where untrusted workers are kept and worked (slaves/prisoners).</p>
<p>Further they both have external and internal defensive systems.</p>
<p>9) The real difference between the two is in the tipping point for trust, and the basic design that follows on from this.</p>
<p>9.1) In a Castle most and sometimes all the people inside are trusted implicitly and interact freely in well resourced areas (which is the analagy of our modern office networks).</p>
<p>9.2) In a Prison most are untrusted are not allowed to interact at all and have very few resources.</p>
<p>9.3) In a Castle the security is by and large a perimiter issue.</p>
<p>9.4) In a prison security is mainly an internal issue.</p>
<p>Thus in a castle a low % of resourses are devoted to internal security and a higher % to external security and creature comforts.</p>
<p>In a prison the opposit is generaly true.</p>
<p>10) The trust tipping point also changes the view point of the internal resorces.</p>
<p>10.) In a Castle you look at cohorts of considerable numbers of men who can be trusted to use the resources at hand wisely to get small and large jobs done and they achive more per man for it, that is they are more efficient.</p>
<p>10.2) In a prison however you look at individual or one or two prisoners in a cell, their available resources are just sufficient to carry out small simple tasks and no more, and they are heavily monitored.</p>
<p>Thus it is the trust tipping point and granularity that make the difference between the Castle and the Prison.</p>
<p>In your Castle view the tipping point is near the OS level, thus the processess are like &#8220;cohorts&#8221; they are efficient but they are difficult to check for security.</p>
<p>In my Prison view the tipping point is down at single functions, thus they are like &#8220;prisoners&#8221; they are compleatly untrusted, monitored and only given sufficient resources to do their job.</p>
<p>And although less efficient the prison view is much much more secure.</p>
<p>11) At first sight less efficient would indicate higher cost.</p>
<p>However is that actually an issue?</p>
<p>As I noted above in 7.4 you are actually looking at CPU workload -v- software development cost.</p>
<p>11.1) Most if not all systems these days have CPU cycles to burn, thus they are already grossly inefficient so the cost there is effectivly less than zero.</p>
<p>11.2) The system should have minimal impact on code cutters, and may well enforce &#8220;de-complexity&#8221;</p>
<p>11.3) It will improve exception handeling and fault reporting thus easing not just test but field maintanence.</p>
<p>11.4) It will make users feel &#8220;enabled&#8221; and thus more responsive to the system.</p>
<p>11.5) It will also enable easy migration onto cluster style systems (think Cloud etc).</p>
<p>And quite a few other advantages not least of which is the increase in low level security against malware.</p>
<p>11.6) The downside is there is currently little hardware to support it. However as you noted above the chips to do it are starting to appear for other reasons. And the systems they end up in may well do &#8220;very nicely&#8221; as blades or COTS boards.</p>
<p>11.7) Ovarall the idea has more benifits than costs even without the increased security asspects. When the increased security is taken into account it has significant advantages for similar cost of existing systems.</p>
<p>12) Now a prediction or two for you that also tells you why I&#8217;m looking at it currently.</p>
<p>12.1) History shows us we go through computing cycles from central resources with user terminals/thin clients to self contained all in one desktop/laptop systems and back again.</p>
<p>12.2) We are currently swinging back to thin client with cloud computing etc.</p>
<p>12.3) CPU manufactures cannot alow this to happen as the development costs for low demand server CPU&#8217;s is significantly offset by high demand client CPU&#8217;s. If the world becomes too server centric then progress on CPU&#8217;s will stall.</p>
<p>12.4) Thus what is likley to happen is that our migration to the cloud will continue and $aaS (replace $ with appropriate letter) will first be outsourced then brought back into house as the silicon venders move the tipping point to maintain revenue.</p>
<p>12.5) Along with this tipping point will be the putting of server type CPU&#8217;s into more desktop and laptop systems.</p>
<p>12.6) But the spare CPU cycles will not go to waste as they currently do. The cloud will migrate back onto these platforms in a couple of ways.</p>
<p>12.6.1) The first will be the equivalent of SETI@home.</p>
<p>12.6.2) The second will be web servers on the client machine either as middle ware or middle ware and backend.</p>
<p>Such is the nature of re-use.</p>
<p>12.7) Cloud &#8220;Software as a Service&#8221; (SaaS) will see a strong &#8220;thin client&#8221; development for smaller more portable &#8220;connected&#8221; devices (netbooks mobile phones etc).</p>
<p>We have seen the start of this with Google&#8217;s two OS offerings (Android and Chrome).</p>
<p>By current necesity the security of the client will get a lot lot stronger (something I started banging on about ages ago and Google actually got on with on the quiet). OS level security will migrate up into the browser, or conversly the browser will migrate down into the client OS (either way should improve security if not done the MS way with IE desktop intergration).</p>
<p>My money (and Googles) would be on upwards security migration with the web browser becoming the equivalent of the new user &#8220;graphical shell&#8221; and comms and data flows migrated back down into the OS to get &#8220;security seperation&#8221;.</p>
<p>12.8) Thus we will actualy favour hardware based VM&#8217;s and MILS kernels and also encorage them to become finer grained.</p>
<p>12.9) The question then becomes will the kernels split out a large amount of functionality into &#8220;user space&#8221; with the equivalent of the old Unix CL utilities. Simply by splitting out the &#8220;trust&#8221; into the kernel where low level security actually belongs (not in the apps).</p>
<p>12.9) If this spliting out does happen will the dual path (user data / security control) in the kernal and functions be implemented giving the &#8220;signiture&#8221; based probablistic security.</p>
<p>I hope that adds some background and clarity to the idea?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133322">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133322">
						March 8, 2010 1:28 AM					</a>

				</p>

				<p>@  Jane,</p>
<p>&#8220;This is my first time posting here and I didn&#8217;t intend to start things off on the wrong foot &#8211; my apologies&#8221;</p>
<p>No you where right to question (nobody here is perfect we all miss things from time to time and as I&#8217;m getting on a bit&#8230; ðŸ˜‰</p>
<p>I&#8217;m sorry I jumped down on you, it&#8217;s just that you came across to me as a &#8220;covert&#8221; PR rep. And I&#8217;m overly sensitive to them at the moment.</p>
<p>On Bruce&#8217;s blog we have seen a fair few recently and some (like the &#8220;divining bomb detector&#8221;) are obviously quite dangerous as people end up getting badly hurt or killed by their less than honest actions.</p>
<p>Some of those hurt and killed are civilians in distant lands who we may not know, others are troops we have sent who should be protecting them and they have friends and loved ones here. All deserve considarably better from us than Faux Security.</p>
<p>Any way, you desrve a more friendly welcome than I gave you, so excuse me while I change the foot I&#8217;m chewing on.</p>
<p>(Note to BF Skinner I still look like a &#8220;bear on a bad hair day&#8221;, before you suggest an orangatang or some such 8)</p>
<p>By and large we don&#8217;t bite (just chew 8), but we are sometimes rude in a friendly way.</p>
<p>However we can and do come across as a little blunt sometimes. For some reason it appears to go with the landsape (as any one attending some of the early crypto conferances will confirm).</p>
<p>A little sugestion, although I don&#8217;t remember any other person posting as &#8220;Jane&#8221; on this blog, it is a common enough name to be almost anonymous so it might be wise to pop a letter or some such afterwards as &#8220;Nick P&#8221; does.</p>
<p>Oddly as others have noted in the past, my name is getting on for being anonymous as well 8(</p>
<p>Any way welcome, draw up a chair and stay a while.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133324">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133324">
						March 9, 2010 1:05 AM					</a>

				</p>

				<p>@Clive Robinson:</p>
<p>A very nice write up about castles, prisons, and compartmentalization. Most certainly a reinvented wheel, though.</p>
<p>Did you ever look at Bitfrost and the XO? The Android security model? They are going that way, and have implemented it.</p>
<p><a href="http://wiki.laptop.org/go/OLPC_Bitfrost" rel="nofollow ugc">http://wiki.laptop.org/go/OLPC_Bitfrost</a><br />
<a href="http://arxiv.org/abs/0912.5101" rel="nofollow ugc">http://arxiv.org/abs/0912.5101</a></p>
<p>Winter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133325">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133325">
						March 10, 2010 1:28 AM					</a>

				</p>

				<p>@ pj,</p>
<p>In answer to your question&#8230;</p>
<p>I got a little email the other day rebuking me on letting cats out of bags re &#8220;how to enumerate Honey Nets&#8221;, and &#8220;Headless Bot Net Control&#8221; from a (supposed) security researcher who works in industry.</p>
<p>So rather than tell you my thoughts I&#8217;ll give you a link to some work by a well acknowledged &#8220;proper&#8221; security researcher ðŸ˜‰</p>
<p><a href="http://www.privacy.org.nz/assets/Files/20815647.ppt" rel="nofollow ugc">http://www.privacy.org.nz/assets/Files/20815647.ppt</a></p>
<p>Peter Gutmann makes interesting and easy reading (most of the time) and he usually calls it like he see&#8217;s it, with practical examples.</p>
<p>He has coined the phrase Malware as a Service (MaaS) to describe one small asspect of what I mentioned to Winter about the &#8220;capitalisation of a botnet&#8221;.</p>
<p>Put simply the &#8220;malware economy&#8221; is now considerably greater than the &#8220;drugs economy&#8221; which means that &#8220;buying a country&#8221; or two is within the &#8220;Criminal Information and Communication Technology&#8221; (CICT) Maffia&#8217;s capabilities if the become more focused.</p>
<p>Look at Peter&#8217;s presentation and then ask yourself  two questions,</p>
<p>1) Are those who think botnet machines are worth only 5-20USD, realy  well below the mark?</p>
<p>2) Do those who say botnets are for Spam and DoS and we know how to mitigate this deluding themselves?</p>
<p>If you are not sure just remember that we have already seen recently a modified Zeus attack tailored to .mil etc that was trawling for documents&#8230;</p>
<p>Now ask yourself what value such documents might have especialy if you can get them across the &#8220;Security Air Gap&#8221; which has often been looked at as the best line of defense as &#8220;they cann&#8217;t cross it&#8221;.</p>
<p>But is mostly not implemented correctly so makes the &#8220;Security Air Gap&#8221; at best a &#8220;Maginot Line&#8221; ( <a href="http://en.wikipedia.org/wiki/Battle_of_France" rel="nofollow ugc">http://en.wikipedia.org/wiki/Battle_of_France</a> ).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133326">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133326">
						March 10, 2010 7:09 AM					</a>

				</p>

				<p>@ Winter,</p>
<p>&#8220;A very nice write up about castles, prisons, and compartmentalization. Most certainly a reinvented wheel, though.&#8221;</p>
<p>Actually not, read on to see why.</p>
<p>&#8220;Did you ever look at Bitfrost and the XO? The Android security model? They are going that way, and have implemented it.&#8221;</p>
<p>As far as I remember the One Laptop Per Child XO model is based on BSD &#8220;jails&#8221;.</p>
<p>I&#8217;ve had a look at the Android document you linked to and it appear Android has a similar problem.</p>
<p>They are both &#8220;top down&#8221; approaches to security and both stop their granularity at the process.</p>
<p>This lack of granularity makes generating signatures and controlling resources difficult as those who have played with SELinux are more than fully aware.</p>
<p>I have actually proposed two parts to the hardware &#8220;cell&#8221; which is a point you might have missed,</p>
<p>1, Minimal resources in hardware.<br />
2, Signature control by hypervisor.</p>
<p>Likewise the program is not dealt with at the coarse &#8220;process level&#8221; nor the less coarse &#8220;thread level&#8221; but the fine &#8220;function level&#8221; (it could be done at the various levels under that such as the high language statement level or even the byte code instruction level).</p>
<p>The point is that a &#8220;cell&#8221; limits resources defined on what the function is to do and how it goes about doing it (the functions are built in like the old style Unix CL utilities and thus have well defined actions and fairly easy to produce signatures).</p>
<p>The resources made available to the cell via the hypervisor are,</p>
<p>1, CPU<br />
2, Memory<br />
3, Buffered File I/O</p>
<p>The function has no knowledge of which process it is part of only what it has been invoked to do via the script. The Script passes bounds to the hypervisor that tell it what the function should be accessing.</p>
<p>The hypervisor knows from this information what data to send via buffered file IO and what data it will get back. It will also know from the static analysis of the function what the CPU and memory parameters are.</p>
<p>Thus any malware has to fit inside of this very resource controlled cell and communicate via the controlled IO whilst still staying inside of the signature mask.</p>
<p>Further at any point the hypervisor can stop the function without it&#8217;s knowledge and do a &#8220;cell inspection&#8221; to check what is there.</p>
<p>Thus the malware is going to have a very very difficult time (not impossible but getting close to it).</p>
<p>The advantage of this &#8220;bottom up&#8221; approach is it gives you a whole load of extras as well for free.</p>
<p>You can see that various researchers are nibbling away at the sides of the idea but they are still coming at it top down not bottom up and thus are constrained by their own outlook.</p>
<p>Oddly if you look at the Android paper you linked to, sections 7.15 and 7.16 are very close to the idea but just don&#8217;t quite go the distance. The reason being I suspect is it would require a whole re-work to Android that is not going to happen.</p>
<p>The important thing to remember about the hardware hypervisor is it is not like a traditional von Neumann architecture but a more limited subset of the Harvard architecture somewhat similar to that you find in some DSP chips without going into the ins and outs of it this chip sits their as a warden looking at the cells. If it detects anomalous behavior it locks down the cell and passes it up the security stack.</p>
<p>One advantage of this Script/function approach is that it allows the functionality of unused parts of the program to be effectively removed. Thus for argument sake you have a music player that goes to the Internet to download track and title info etc. You can simply say to the security system not to give any resources to that particular function and for it to return a null string etc. Provided the code cutter who wrote the script followed proper exception handling then the script should carry on without it or if the function is vital for some reason, stop the script and produce a meaningful error message.</p>
<p>SELinux can do coarse grained resource control but it is only at the process level which means it cannot do the above unless it is built into the program which we known your average code cutter will not do simply because of &#8220;efficiency and features&#8221;.</p>
<p>I&#8217;ll leave it up to you to decide if my &#8220;wheel&#8221; is engineered for a function or artisan made for any horse drawn cart that comes along&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133327">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133327">
						March 10, 2010 10:19 AM					</a>

				</p>

				<p>@Clive Robinson:<br />
&#8220;As far as I remember the One Laptop Per Child XO model is based on BSD &#8220;jails&#8221;.&#8221;</p>
<p>That is only part of the trick. They use the KVM to run each and every application. Then each application is run in a chroot jail.</p>
<p>Bitfrost is very much about protecting the XO from hardware wear-out attacks (it runs on a limited battery and flash). So they monitor resource use, including CPU use.</p>
<p>Furthermore, each application is installed with unchangeable permission for use of drivers. So a word processor or photo app have no access to the network etc. Also, data organization is different which allows a better control of what application can access what bits.</p>
<p>This does sound to go in the same direction as you do.</p>
<p>But remember that the XO is intended to be a limited power device for children. It has to be practical and secure for use by children in a school environment. This means, they do mostly cover remote network attacks. If someone can get their hands on the hardware, the most they do is brick it.</p>
<p>All in all, I have not seen any chinks in that armor (but feel free to enlighten me).</p>
<p>The android is different. For one, they do not use KVM.</p>
<p>Winter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133328">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133328">
						March 11, 2010 2:00 AM					</a>

				</p>

				<p>@ Winter</p>
<p>Alright, time for me to step in. I&#8217;ll start by saying I like BitFrost, but not Android necessarily. BitFrost takes something we do well and improves on it in many ways. I&#8217;d love to see RHEL Desktop modified like that. It&#8217;s not secure, though. How can I say that?</p>
<ol>
<li>Hardware. Processor has known bugs, some potentially exploitable and several can be used to obscure malware. Firmware is unvalidated against subversion by end user, but many are like that. Any other system level attacks might be feasible, but let&#8217;s move on to more realistic stuff.</li>
<li>OS. The OS is Linux. BAD choice for a &#8220;secure&#8221; system. When you look at an OS&#8217;s kernel-mode code and see comments like &#8220;Why is this here?&#8221;, you should worry. Getting several vulnerabilities/bugs in a month isn&#8217;t comforting either. The principle issue is that the number of latent defects is usually proportional to complexity &amp; lines of code. The Linux kernel is huge and each bug in it potentially has all the powers of kernel mode available to devastate reliability &amp; security. OS&#8217;s like QNX Neutrino, INTEGRITY &amp; OKL4 manage to keep everything but the small kernel in user-mode and still run fast. Why does Linux continue to do the opposite? Linus hates microkernels. See Linus vs. Tanenbaum.</li>
</ol>
<p>So, just using a monolithic OS like Linux increases the TCB and attack surface many fold. To see the difference in a practical application, look at Micro-SINA where they switched SINA VPN from Linux to L4/Fiasco. The difference is astounding. The best engineered microkernel-based OS I&#8217;ve seen is INTEGRITY: it&#8217;s architecture makes it almost impossible for any app to exhaust kernel resources and rigorous development/certification drives up assurance. Linux couldn&#8217;t begin to pass one of those &#8220;correct by construction&#8221; evaluations. Neither could any other monolithic OS that I know about.</p>
<ol>
<li>Drivers. In Linux, drivers are in the kernel. There are some tricks to get them out, but they aren&#8217;t normally used. In microkernels above, drivers are in user-mode and given certain hardware access privileges. If a driver screws up, it doesn&#8217;t crash the entire system via memory corruption or CPU overload. In monolithic system, one must trust the device drivers. Two methods: signature &amp; extreme validation (think Microsoft&#8217;s SLAM). Signature proves source is correct, but driver can still be buggy. Without an IOMMU, malicious drivers are still a problem, but monolithic systems must trust them totally. Result of an exploited bug in kernel mode? If you&#8217;ve ever used a few different graphics drivers in Ubuntu, you will know what I mean.
</li>
<li>
<p>Resource control. This is a big issue that crosses over 1-3. The basis of a reference monitor to ensure security is proper mediation of &#8220;subjects&#8221; access to &#8220;objects.&#8221; Subjects might be cells, users, processes or something else. Objects may be CPU time, memory, devices, file system, etc. Every subject and every object must be accounted for by the kernel in a very validated way. Anything with a shortcut around this will invalidate the security model. Additionally, the mechanisms and security model should be designed/built in such a way as to be practically feasible, like Bell-Lapadula MLS in military and MILS separation kernels in aerospace. Monolithic OS&#8217;s, POSIX compliance, and bloated native installs are the exact opposite of this. Security enforcement is everywhere and nobody understands how it all fits together.</p>
</li>
<li>
<p>Abstraction &amp; Composability. I know I&#8217;ve slowly moved from specific issues in Bitfrost to general security engineering issues, but bear with me because these are all relevant. I define abstraction quite like OOP: the implementation is hidden by a simpler interface. The overall system is &#8220;composed&#8221; by the interaction of the components, which are layered side-by-side or on top of one another. For a good example, see the GNTP (GEMSOS) evaluation or BAE Systems XTS-400 (linux compatible). They use strong layering and a protection ring model to make for a strong security architecture that still supports legacy (untrusted) code.</p>
</li>
</ol>
<p>The idea is that we build each layer &amp; test/verify it independently. Then, we verify the system as a whole by verifying the interactions of layers/components against system requirements. You simply cannot do that in systems as complex as Linux or even Android. Android does do some layering that improves its security, but the bottom layer has the problems mentioned in points 2-4. Because of this, one can&#8217;t be sure things are interaction properly, data isn&#8217;t leaking, etc. Under the hood, the system isn&#8217;t deterministic enough to meaningfully evaluate to medium to high assurance. Additionally, it has a shitload of untrustworthy components in its TCB, bringing me to point 5.</p>
<ol>
<li>TCB &amp; non-TCB support libraries. If it&#8217;s needed for the device to work properly, then it&#8217;s part of the TCB or at least a functional requirement. Either way, if it had plenty of exploitable vulnerabilities (cough webkit cough) or is sufficiently complex, the system that depends on it cannot be considered secure. Then there&#8217;s the new Java VM implementation. (bughunt round 2!) Sure, there may be limitations. Maybe the best the enemy can do is DOS, but why should even that succeed? If you ask me if Android is a secure platform, you are actually asking if Linux, Android stack (including webkit), &amp; Java libraries are secure. That&#8217;s a lot bigger than &#8220;phone OS&#8221; would suggest. ðŸ˜‰ Bitfrost is a hardened Linux distro with some security features. Is a hardened Linux secure? See 2-4.
</li>
<li>
<p>The Internet. This is when it gets extra crazy. Before this thing entered the picture, the device was in the hands of a trusted individual who presumably wouldn&#8217;t destroy their own crap. Internet will bring many attack vectors, which I need not mention, that every mainstream OS (incl. Linux) has failed to defeat. Malware comes in all shapes and sizes &amp; targets vulnerabilities obvious and obscure, straightforward and esoteric.</p>
</li>
</ol>
<p>Conclusion: If you want a secure system, then you must secure its building blocks and their interactions. If you want secure data, it must be secured (somehow) at rest, in use and in transit. By secure, I mean I don&#8217;t loose everything, my identity included, at least once and restore several dozen times a year. When Clive and I discuss med to high assurance, we are talking about <em>real</em> security. Fortunately, we are just discussing software right now. Defending against physical or hardware-based attacks, like against radiating something or introducing voltage glitches, requires more than I mentioned. If you doubt the importance of this stuff, look up the recent article about 1,024 bit RSA being defeated by a powerline attack. That&#8217;s f***ed up. ðŸ˜‰</p>
<p>How to build a secure system? Well, there are many methods. I&#8217;ve been espousing a MILS approach, but with more dynamic scheduling. The important thing is to follow the concepts. Look up Saltzer and Schroeder&#8217;s info security principles for a start and then Schell&#8217;s GEMSOS Lessons Learned paper. The basic lesson is good requirements gathering, unambiguous specification of requirements, extremely rigorous implementation, and strong correspondence between requirements, design &amp; implemenation. Modularity, layering &amp; avoiding common pitfalls are always good sign. Event-driven model easiest to pull off, which is what open-source fully verified seL4 did. Best to learn what is secure (and securable) by looking at examples. Aesec&#8217;s GEMSOS crypto seals, Nizza/Perseus Architectures, Nitpicker GUI, CapDesk desktop, OP web browser, OKL4 secure hypercell (in tons of phones) and INTEGRITY&#8217;s Platform for Secure Networking &amp; Mobile Devices. For hardware, look at General Dynamics line, esp. INFOSEC processor, and MIT&#8217;s Aegis processor. At system/integration level, look at Tokeneer EAL5 open-source demo, Praxis&#8217;s other work, Galois&#8217;s work, anything MILS-related, LOCK project (doc&#8217;s online), BLACKER VPN, Rockwell Collins&#8217; Turnstill, and Sectera Edge.</p>
<p>These products, whether demos or products, all embody many good principles of secure architecture, development, execution, and/or maintenance. A few, such as GEMSOS-based BLACKER &amp; INTEGRITY, have been in high-risk military products for over a decade without failing. XTS-400 &amp; Boeing LAN have done pretty well too, even being medium assurance by comparison. So, I could expand the definition to good principles plus years of survival against people who know how to knock weak systems down. I mean, there&#8217;s still configuration and securing apps and such, but a secure TCB solves so many problems for the developer. I mean, OS&#8217;s like Linux don&#8217;t even provide a trusted path from user to arbitrary system process. Every other solution I mentioned does. Unspoofable login screens, strong guarantees against keylogging between domains, etc. If we go with good design/implementation/validation and maturity, then INTEGRITY or GEMSOS are best way to start new secure platform. Bitfrost, Android, and Linux might be &#8220;good enough&#8221; for casual users in a risk analysis, but calling them &#8220;secure&#8221; is just verbal masturbation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133329">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133329">
						March 11, 2010 3:18 AM					</a>

				</p>

				<p>For those interested in the RSA power line attack</p>
<p>It was carried out by three people,</p>
<p>Andrea Pellegrini,<br />
Valeria Bertacco<br />
Todd Austin</p>
<p>It was presented on the 10th of this month at DATE.</p>
<p>You can get a copy from Valeria&#8217;s pages at U Mich,</p>
<p><a href="http://www.eecs.umich.edu/~valeria/research/publications/DATE10RSA.pdf" rel="nofollow ugc">http://www.eecs.umich.edu/~valeria/research/publications/DATE10RSA.pdf</a></p>
<p>In many respects it is an important paper for the open research community.</p>
<p>In essence what they have done is apply a simple &#8220;fault injection&#8221; to &#8220;harmlessly&#8221; attack a standard machine and standard off the shelf software and reconstruct the 1024bit RSA key.</p>
<p>To use their words,</p>
<p>&#8220;We report on the first physical demonstration of a fault-based security attack of a complete microprocessor system running unmodified production software&#8221;</p>
<p>And the software attacked is,</p>
<p>&#8220;We expose and exploit a severe flaw on the implementation of the RSA signature algorithm on OpenSSL, a widely used package for SSL encryption and authentication.&#8221;</p>
<p>The reason this is possible is the way the software has been written in a &#8220;linear and always repeated&#8221; way a failing that is in much software and realy should have stopped twenty years ago when the first &#8220;signiture attacks&#8221; against Smart Cards surfaced to become DPA in the late 1990&#8217;s&#8230;</p>
<p>Oh and as I have known for thirty years and said on the odd occasion, the same attack can be carried out by EM Field fault injection which concevably could be done from 200ft away using equipment from the surplus radar equipment market which has been modified to allow AM/pulse modulation of the &#8220;fault signature&#8221; onto a 10Ghz or equivalent carrier (the dificult bit is &#8220;locking the fault injection to the system under attack&#8221;).</p>
<p>This is the second paper this year which has shown how a simple attack can have devistating consiquences on systems.</p>
<p>At the root of the problem is the issue of &#8220;efficiency -v- Security&#8221; allowing an exploitable side channel a theme I have banged on about for quite some time (as some of you will know).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133330">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133330">
						March 11, 2010 4:39 AM					</a>

				</p>

				<p>@Nick P</p>
<p>Great write up. Obviously, I can only agree. I know several kernel developers are ranting against Linux insecurity on a regular basis (eg, Alan Cox used to keep a special &#8220;secure&#8221; kernel tree).</p>
<p>But I am afraid we are drifting towards the &#8220;embed it in concrete and dump it in the Mariana trench&#8221; security.</p>
<p>The aim of computer security is to get to a point where the expected losses (risks) due to security breeches is much lower than the profits from using the computer.</p>
<p>Increasing the cost, in all meanings of the word, of the security can quickly get you into the situation that it becomes pointless to actually use a computer. That was probably one reason the Android does not implemented the Bitfrost model.</p>
<p>The OLPC is a case in point. The aim was to supply children with a low cost laptop with cheap (free) software. This makes any OS other than Linux a non-issue. Bitfrost had only two goals: 1) protect the children 2) protect the laptop. Obviously, they rather brick the laptop, data and all, than endanger the children. This is completely different from the economics of an average (military) workstation, where the data are worth more than the hardware and user combined (I kid).</p>
<p>The optimal solution for the OLPC is to keep the cost of the security below the replacement cost of the laptops. That is, simply (remotely) decommission compromised laptops and keep backups. I think Bitfrost went a long way into reaching that optimal point. And it works for <em>children</em>, security without passwords and the like.</p>
<p>The security policies you presented would make the OLPC impossible (at least for the next decade). It would also make most home use of PCs impossible. It would simply become too expensive and too cumbersome to use a secure computer. At least until some secure OS along these principles arrives, and enough applications are ported.</p>
<p>So I do think Bitfrost is a step in the right direction. Yes, it is a step, and not the whole way. But to get somewhere, you need to make one step at a time. Jumping tends to make you fall and break bones.</p>
<p>Bitfrost works, even on limited hardware, and even a child can use it. If all desktops would implement it, that would be a huge improvement.</p>
<p>And, what would be the next step from Bitfrost?</p>
<p>Winter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133331">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133331">
						March 11, 2010 2:08 PM					</a>

				</p>

				<p>@ Winter</p>
<p>Well, sure, we definitely must balance the cost of security against the goals. Your example of Android was quite proper: cell phone users want to be very expressive &amp; wouldn&#8217;t have purchased a cell phone that works like BitFrost. I have to clarify that the big point behind the stuff in my last post is that it can all be seemless. For instance, a processor that works, driver updates that are certified/signed, drivers/services in user-mode instead of kernel mode&#8230; The list goes on &amp; the user wouldn&#8217;t be able to tell the difference between a secure microkernel w/ Linux API &amp; a hardened Linux kernel. Additionally, the secure program design principles would be done by developers and the installation routines might, a la Bitfrost, tell the system what privileges the app needs. The main difference isn&#8217;t the usability or surface behavior: it&#8217;s what goes on under the hood &amp; behind the scenes.</p>
<p>Cost is still an issue, though. Obviously, securing the platform &amp; producing low defect software will add to the cost. I think the cost of securing the platform is worth it. With a secure platform, we could build solutions to many other problems. Without one, we <em>cannot</em> solve the other problems. Billions of dollars are annually wasted on security solutions built on weak TCB&#8217;s that invalidate their security. I think spending even tens of millions on developing a secure platform has huge payoff. The good news is that, as in previous post, they are already here. They just need to be customized for desktop use. Currently, though, a high assurance COTS solution like GH Platform for Sec. Networking gives an OEM secure RTOS, drivers, partitioned networking, partitioned filesystem, virtualization (user-mode), compatibility layers &amp; a top-notch IDE for a few hundred thousand one time. A few hundred K one time to solve 90% of the technical problems? Sounds like a steal to me. I&#8217;m just not an OEM with deep pockets. (tears surface&#8230;)</p>
<p>So, my conclusion is that, for even mid-sized firms, secure software is affordable and usable via great tool &amp; middleware support. Cleanroom, Praxis Correct by Construction, &amp; Galois Haskell tricks have cost effectively produced solutions with little to no bugs &amp; no dead (useless, maybe malicious) code. Cleanroom is easy to learn &amp; extensive studies support its defect-reduction claims. So, developers can get in on the action too at least for security-critical software. For these basic issues, it&#8217;s not the cost: they just lack the will. They don&#8217;t care because the market doesn&#8217;t care. The person who solves the security problem will be the person that gets the market to care and shows suppliers how to do it affordably and as painlessly as possible.</p>
<p>So, I&#8217;ve talked plenty about them. I threw out nearly every relevant example in the previous post, but I don&#8217;t know if you had the time or will to Google all of them. How about I give you a few links where you can look at real-world versions of what I&#8217;m saying &amp; answer the question: could lay users benefit from these &amp; do any examples seem good enough to deploy further? (Note: to prevent moderation delays, I only provided 3 hyperlinks. don&#8217;t know the limit &amp; hate waiting for spam filters. sorry for inconvenience ðŸ˜‰</p>
<p>INTEGRITY Secure Virtualization (top solution I&#8217;ve seen; see their examples on bottom)</p>
<p><a href="http://www.ghs.com/products/rtos/integrity_virtualization.html" rel="nofollow ugc">http://www.ghs.com/products/rtos/integrity_virtualization.html</a></p>
<p>Solutions Using INTEGRITY Separation Layer (note that they are very practical)</p>
<p><a href="http://www.integrityglobalsecurity.com/pages/otherSolutions.html" rel="nofollow ugc">http://www.integrityglobalsecurity.com/pages/otherSolutions.html</a></p>
<p>Perseus Security Architecture (whole site is a great read)</p>
<p><a href="http://www.perseus-os.org/content/pages/Objectives.htm" rel="nofollow ugc">http://www.perseus-os.org/content/pages/Objectives.htm</a></p>
<p>Recent Nova microhypervisor (Nick: hypervisors done RIGHT!)</p>
<p>at hypervisor DOT org</p>
<p>Turaya Desktop is a Perseus-based Data Loss Prevention suite if you want to look it up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133332">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133332">
						March 11, 2010 5:37 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;The resources made available to the cell via the hypervisor are, 1, CPU 2, Memory 3, Buffered File I/O&#8221;</p>
<p>I swear you might as well be talking about MILS. Your prison approach &amp; their castle approach parallel so much. We could have an almost-prison by building a MILS castle where all the apps were decomposed into primitive functions, each in their own partition &amp; POLA enforced on communication, which also runs critical portions through guards. If the smaller functions were like black boxes, as in previous designs we&#8217;ve discussed, they wouldn&#8217;t even need monitoring: just the main active components. That means software guards could be used with less of a performance hit. Separation kernel would also impose CPU/memory restrictions you mentioned. The only thing that would be missing was the trusted, DSP thing doing the monitoring: it would be replaced by software guards &amp; probably use FSM&#8217;s to track state &amp; do safe fails and such. Like I said, your method and the modern MILS approaches are very similar. They usually partition at the component or subsystem level of granularity for performance reasons, but you can do it as small as functions if you like.</p>
<p>A good example of this is OKL4 &#8220;Secure Hypercell&#8221; tech in smartphone virtualization. It&#8217;s a fancy word that means it&#8217;s a small, ultra-reliable, capability-based microkernel that can run/manage individual apps (which may be component functions of others) and VM&#8217;s via virtualization layer (user-mode) side by side. They aren&#8217;t a separation or MILS kernel, but it&#8217;s pretty close in function/assurance/performance. So, you start by running your app in VM (Linux, Symbian, etc.). You take security- or safety-critical code out &amp; put into separate partition. It&#8217;s TCB is suddenly that of the microkernel. As they point out, you can further decompose the app as much as performance, time &amp; labor allow. Aside from real-time monitoring with coprocessor, doesn&#8217;t this seem pretty close to what you mention? Not the same, but very close? The source of those claims is linked below. They have nice visuals of how it works, along with a nice field track record to back it up with.</p>
<p><a href="http://www.ok-labs.com/_assets/download_library/ok_tech.pdf" rel="nofollow ugc">http://www.ok-labs.com/_assets/download_library/ok_tech.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133333">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133333">
						March 12, 2010 2:21 AM					</a>

				</p>

				<p>@Nick P:<br />
Thanks for the links.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133334">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133334">
						March 12, 2010 9:34 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;I swear you might as well be talking about MILS. Your prison approach &amp; their castle approach parallel so much.&#8221;</p>
<p>Yes and no MILS has similar granularity.</p>
<p>The bit it lacks over and above the &#8220;DSP&#8221; bit is having the pre built &#8220;function&#8221; components with pre built signitures to monitor.</p>
<p>One of the points behind this is to remove a big chunk of the low level security issue from the equation (ie code cutters).</p>
<p>The programer (much as in the old IBM assembler) selects a function to do something such as read in data from a file (or the Unix equivalent etc).</p>
<p>This function comes in two parts the bit the programer wants and the security signature which is passed to the hardware hypervisor. The OS adds the required values to the signature to make it fit to the job in hand and limit the require resources right down.</p>
<p>Thus a chunk of low level security is there without the programer having to do anything to get it.</p>
<p>Further the smaller the function the tighter the signature can be bound to the function and the easier the signature is to produce.</p>
<p>Also you force not just a standard exception handeling model but also better error mesages and better logging into the system at close to zero extra cost.</p>
<p>This is the bit you get for free doing the bottom up aproach which you tend not to get from the top down aproach.</p>
<p>Don&#8217;t get me wrong I like MILS I just think it could do a lot more for the same money with a slightly different underlying architecture.</p>
<p>As an analagy in cars Side Impact Protection Systems,</p>
<p>The top down aproach makes them an expensive addition to an existing design.</p>
<p>The bottom up aproach on a new design builds them in as a structural feature alowing optimal placing etc.</p>
<p>The for free bit, converting the car design to a soft top is oh so easy with non of the old problems where the design just assumed the doors etc where their for the niceties not for safety.</p>
<p>It&#8217;s the way you look at things from the outset before even the requirments analysis has pen to paper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133335">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133335">
						March 12, 2010 10:15 PM					</a>

				</p>

				<p>@ Clive</p>
<p>I guess biggest problem I have with your solution is that I don&#8217;t understand how you are going to implement it. I&#8217;m mainly a software guy, so this is pretty low level for me. It seems like your DSP is treating the CPU &amp; external stuff as black boxes, watching the IO &amp; keeping track of state. I&#8217;m wondering how you will get the CPU &amp; DSP to work together that way when the CPU&#8217;s internal state is very important. In modern systems, the CPU is what loads the initial trusted state: if it screws up, how do you even boot the fail safe? And is your DSP solely looking at bit patterns or does the CPU tell it certain things (e.g. beginning to read file from device 2 to this address space)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133336">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133336">
						March 13, 2010 4:07 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;I&#8217;m mainly a software guy, so this is pretty low level for me. It seems like your DSP is treating the CPU &amp; external stuff as black boxes, watching the IO &amp; keeping track of state. I&#8217;m wondering how you will get the CPU &amp; DSP to work together&#8221;</p>
<p>The problem I think you are having is you are thinking in terms of the &#8220;monolithic slab CPU&#8221; we currently have from Intel and AMD etc which has like the &#8220;saber toothed tiger&#8221; over specialised to do just one evolutionary task well to the detriment of all others.</p>
<p>Go back to a &#8220;simpler time&#8221; around 20 years ago of PC accelerator cards using multiple RISC CPU&#8217;s each with their own private memory block and no need of paging and other Virtual Memory tricks etc.</p>
<p>Each RISC block exists in a &#8220;world of it&#8217;s own&#8221; when running just like an embeded microcontroler. Think about them from the &#8220;simple embeded microcontroler&#8221; view point of CPU control bus, memory address/data bus and I/O bus (look at the original ix86 CISC design when x was less than 4).</p>
<p>That is the RISC CPU comes out of reset and executes it&#8217;s &#8220;embeded program&#8221; it reads data from an I/O bus &#8220;in&#8221; device processes it and writes it to an I/O bus &#8220;out&#8221; device. If the I/O bus is held the CPU halts/pauses (stalls on I/O).</p>
<p>If you think on it a little further it is a hardware representation of a simple Unix Command Line piplined process.</p>
<p>[The C-CPU has no knowledge of security that is done by the H-CPU and system &#8220;OS&#8221; which sets up the &#8220;plumbing&#8221; of IPC via &#8220;pipes&#8221; or &#8220;sockets&#8221;.]</p>
<p>Now imagine a high end program written as a script that is split into all it&#8217;s sub functions. All the sub functions are &#8220;pipelined&#8221; together by the system &#8220;OS&#8221;. In simple cases this would be less &#8220;efficient&#8221; than a monolthic code block but only in CPU &#8220;grunt&#8221;.</p>
<p>From the &#8220;embeded microcontroler&#8221; view point, each sub function is the &#8220;embeded program&#8221; in an &#8220;embeded controler&#8221; all sitting on a backplane with multiplexed I/O and control buses (as seen in high end Cray and Sun Starfire boxes and IBM Z servers).</p>
<p>This is a proven method of doing &#8220;parellel processing&#8221; which due to the proliferation of COTS has been virtualy eclipsed.</p>
<p>The addition I&#8217;ve made is the hardware hypervisor doing it&#8217;s &#8220;DSP&#8221; on the &#8220;function signature&#8221;.</p>
<p>So yes &#8220;when running a function&#8221; the compute engine (C-CPU) is seen as &#8220;black box&#8221; from the outside, and from the inside &#8220;it&#8217;s own little universe&#8221;. However the &#8220;system&#8221; does not get to see or talk to the C-CPU engine (CPU+Memory+I/O) it talks to the Hypervisor (H-CPU) that watches the C-CPU when running, and modifies the compute engines memory when the CPU is not running.</p>
<p>The system sees the Hypervisor engine as being on two seperate buses the traditional &#8220;data/comms&#8221; buses and in addition the security bus (more on these buses and backplanes later)</p>
<p>So the &#8220;data flow&#8221; in the system passes data to the first hypervisor which passes it down to the compute engine that filters/processes the data and hands it back to the hypervisor which passes it back to the system. The system then takes this processed data and passes it to the next hypervisor in the line.</p>
<p>The only real issue is getting the &#8220;embedded function&#8221; onto the C-CPU.</p>
<p>Apart from the top control &#8220;King/Gov&#8221; engine all the other engines have their memory loaded and locked for them (MMU&#8217;s and DMA done right are a security plus, more on that later).</p>
<p>Ignore how the top control engine starts up for now just assume it comes up &#8220;secure&#8221;.</p>
<p>All the other engines are held in reset by their respective hypervisor(s), which in turn are held in reset by the system.</p>
<p>The Gov engine takes control of one of the non IO engines and it&#8217;s attendent hypervisor and loads an image into it to act as a simple security schedular for the lower level hypervisor(s).</p>
<p>The Hypervisor as I said is a simplified Harvard architecture and has a code side and a data side. The code side is effectivly &#8220;ROM&#8221; (see how some DSP chips load code into themselves after reset from a &#8220;hidden external EEPROM&#8221;) and remains non mutable during the hyporvisor execution. The data side faces it&#8217;s respective von Neumann engine(s).</p>
<p>Conceptualy each time a &#8220;cell&#8221; engine is used for a new function,</p>
<p>1, Both the hypervisor (H-CPU) and compute (C-CPU) engines are reset,<br />
2, The H-CPU engine gets the signiture and bounds loaded on the code side.<br />
3, The C-CPU engine gets the function code DMA&#8217;d into it&#8217;s restricted memory space via a one way private bus.<br />
4, The C-CPU engine MMU is preloaded and locked.<br />
5, The H-CPU engine is taken out of reset and it takes control of the data I/O to the C-CPU.<br />
6, The H-CPU takes the C-CPU engine out of reset.</p>
<p>And the &#8220;black box&#8221; is now running a function.</p>
<p>Back to the DMA and MMU and security. Done right it can be made very very secure. It is a question of control and bus isolation.</p>
<p>DMA of the form I&#8217;m looking at is quite simple, you have the hypervisor CPU (H-CPU) engine outside of the Compute CPU (C-CPU) engine. The C-CPU has no ability to see anything other than it&#8217;s memory and a simple I/O status register. The memory is controled by the DMA controler which is controled by the H-CPU. Thus the C-CPU just sees memory buffers where data &#8220;magicaly&#8221; apears and disapears and an I/O  status register telling it when the magic has happened.</p>
<p>The H-CPU does the &#8220;magic&#8221; in four ways,</p>
<p>1, Load memory images when C-CPU is held in reset.</p>
<p>2, Load data into &#8220;read only input buffer(s)&#8221; when C-CPU is &#8220;held/paused&#8221;.</p>
<p>3, Unload data from &#8220;write only output buffer(s)&#8221; when C-CPU is &#8220;held/paused&#8221;.</p>
<p>4, Inspect all memory for &#8220;contraband&#8221; when C-CPU is &#8220;held/paused&#8221;.</p>
<p>The MMU is likewise controled by the H-CPU and the C-CPU has no knowledge of it. Thus the H-CPU allocates only sufficient memory and buffer space to the C-CPU to do the function. Thus any low level malware is starved of resources.</p>
<p>The problem with nearly all COST CPU&#8217;s is the assumption that the CPU control&#8217;s the MMU to do pageing etc it&#8217;s self, which means if malware gets &#8220;ring 0&#8221; it&#8217;s game over.</p>
<p>The whole point of this design is the C-CPU does functions of scripted programs and thus does not need to page memory in and out or multi task or any other of those &#8220;kernel functions&#8221; where low level security holes happen. Thus you can take a simple &#8220;off the shelf&#8221; FPGA design and hack the design down and  providing there are enough pins you can put both the H-CPU and C-CPU on the same FPGA.</p>
<p>If you where going into serious production you can see that with quite a small modern silicon area you could have four &#8220;cell CPU&#8221; cores each with a private chunk of the 8Mbyte of internal memory and one main hypervisor and four slave hypervisors all in the same footprint a mid to low range Intel/AMD laptop CPU currently has.</p>
<p>Which brings me onto backplanes and data/control and I/O buses.</p>
<p>I/O to the real world is effectivly &#8220;untrusted&#8221; as it should be and the usual MILS Castle aproach applied.</p>
<p>The low level of the Prison aproach is to leverage &#8220;parellel processing&#8221; and &#8220;scripting&#8221; techniques into MILS and other security architectures to get rid of code cutter &#8220;glory balls&#8221; of programs in a way that,</p>
<p>1, Reduces the granularity to &#8220;proven secure functions&#8221;.<br />
2, Where the secure functions have low complexity and low resource needs.<br />
3, Where the low complexity alows effective easily tailored security signitures.<br />
4, And the resources can be tightly fitted and controled around the function.<br />
4, Where the tailoring and resource control is done by the build process, not the code cutter.</p>
<p>Thus the low level security against malware is taken almost compleatly out of the code cutters hands. Which means you get the low level security at the cost of system &#8220;grunt&#8221; but this comes cheap by comparison with traing code cutters and doing low level code audits etc etc.</p>
<p>But as you are doing bottom up engineering you get a whole host of freebies.</p>
<p>First off as I said iX86 wher x is above 4 is overly optomised for single chip &#8220;specmanship&#8221; and is mostly a compleate waste of silicon in multi CPU systems (it is why we are now seeing Intel go down the multi core route). Thus the silicon that can be freed up will provide plenty of gates for the hardware hypervisor, and still have gates spare.</p>
<p>Forcing parellel programing onto code cutters is very good, it makes their product scalable onto SaaS or &#8220;cloud&#8221; systems much much more efficiently</p>
<p>Forcing the parellel programing to use trusted functions that are effectivly stand alone programes (ie scripting) forces the correct addressing of &#8220;exception handaling&#8221; and &#8220;error messages&#8221; onto the code cutters via the build tools. As these are the root cause of well over 60% and as much as 90% of &#8220;in the field&#8221; problems we would expect some real gains to be made in this area.</p>
<p>There are other gains such as &#8220;code reuse&#8221; will actualy work, but hey you want the bad news ðŸ˜‰</p>
<p>Firstly there will be increased overhead in terms of hardware and a decresse in efficiency.</p>
<p>However looking at previous systems that have been properly designed to be &#8220;reliable&#8221; and &#8220;scalable&#8221; these extra overheads are relativly small (ie a few %). Which means they are very much irrelavent in most cases.</p>
<p>The usual &#8220;object orientated&#8221; code aproach won&#8217;t work. This is not an object issue but a code cutter issue. As we know from experiance objects fit well in user interfaces but just don&#8217;t work in transactions (try mapping objects onto an RDBMS properly, if you think pain is pleasure you will be in seventh heaven). The reason is simply the wrong view point.</p>
<p>Any way many &#8220;objects&#8221; try to hard to be &#8220;all things to all men&#8221; which frome an efficiency or security view point is just bad news (just compare the C standard library to the C++ standard libraries to see why this can be bad news).</p>
<p>Oh and the system is limited in what &#8220;security&#8221; comes for free. It obviates the malware attack issue but does not address the issue of &#8220;malicious code&#8221;. That is if the code cutter deliberatly puts in malicious high level code this system is not going to detect it (otherwise secure programs would just write themselves). But it does limit most of what a malicious code cutter can do to the point where they are squeased out by &#8220;formal methods&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-133337">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133337">
						March 13, 2010 2:39 PM					</a>

				</p>

				<p>@ Clive</p>
<p>Alright, I&#8217;ve archived the entire discussion for future reference. I think I&#8217;m beginning to see some of the pieces come together. I still have qualms about the signature approach being unable to differentiate between malicious &amp; non-malicious in real-time, but your design is reset-based &amp; hence would prevent long-term reinfection. Are you even really analyzing the IO with the monitor or are you just using it to direct, examine the memory of, and reset the compute CPU&#8217;s? In previous discussions, you described it somewhat like an IDS, but now it just seems like a real-time, code-integrity checking engine for compute nodes.</p>
<p>Another issue, possibly due to my limited hardware experience, is with the silicon requirements. A typical platform is millions of lines of code which probably correspond to hundreds of thousands of functions, each requiring a computer/hypervisor pair. Even the simplest CISC cores take up a significant chunk of any affordable FPGA. Custom designing functions &amp; acknowledging they will probably be multiplexed to reduce compute node requirements leads me to believe the system still needs almost a hundred thousand FPGA&#8217;s or tens of thousands of high end FPGA&#8217;s. That&#8217;s a lot of FPGA&#8217;s, Clive. Even assuming one could do a lot with an Intel-type wafer, Intel&#8217;s manufacturing processes are far ahead of the curve compared to FPGA&#8217;s, proprietary, and unlikely to be released to give them competition. They&#8217;re too invested in Itanium for mission-critical apps. Looking at ClearPath, Tilera, and NVIDIA parallel chips, I don&#8217;t see anyone who can sqeeze enough multiplexed functions on a chip to make this design cost-effective.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-133338">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/#comment-133338">
						March 14, 2010 6:16 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>I&#8217;ll try to be quick a tads more indepth on this reply without getting to deep.</p>
<p>&#8220;I still have qualms about the signature approach being unable to differentiate between malicious &amp; non-malicious in real-time&#8221;</p>
<p>I can understand that as it takes a whole different &#8220;world view&#8221; from normal (which is why I keep talking about bottom up not top down design).</p>
<p>Think not of &#8220;whole monolithic programs&#8221; in the normal sense. Nor of programs in scripting languages like Perl. Think of small functions made as micro programs that are scripted via IPC (Unix shell script and CL utilities).</p>
<p>Each function is very small has a minimal number of loops and next to no storage. It is more of a &#8220;filter&#8221; building block than a &#8220;user program&#8221;.</p>
<p>The signatures are &#8220;heartbeats&#8221; either put into the function by the build tools or exist naturaly via the I/O buffer requests. Thus the heartbeat type and number are known to the build tools that make the &#8220;skeleton&#8221; of the signature. The hypervisor knows aproximatly what order each heartbeat comes and importantly when and what it&#8217;s tag should be.</p>
<p>Any change in this expected heartbeat behaviour is not good news and raises a security indicator for further consideration (ie a cell search).</p>
<p>Thus a &#8220;do while&#8221; loop would have a heartbeat at the begining to say it&#8217;s in the loop and what the limits are, a sub heartbeat at each itteration has the loop count and while test input and result. Likewise any break conditions have heartbeats.</p>
<p>Thus any malware would have to know what nearly unique heartbeat had to go next and when, which would require it to be able to analyse the state of the prison &#8220;cell&#8221; before the valid heartbeat time out. And as the cell is resource constrained&#8230;</p>
<p>The heart beats enable not just the signature but also a very good debug/diagnostic for fault tracing and error messages and why any exceptions occur (remember nearly 80% of faults are not code logic faults).</p>
<p>All unexpected exceptions cause an automatic &#8220;cell search&#8221; and dump of stack and heap to log for analysis by the hypervisor.</p>
<p>&#8220;Are you even really analyzing the IO with the monitor or are you just using it to direct, examine the memory of, and reset the compute CPU&#8217;s?&#8221;</p>
<p>It is both although I&#8217;m not having to do to much IO content anaylsis at the moment it&#8217;s a work in slow progress (as am I of late ;). Also it may not be required in many cases for subtal reasons.</p>
<p>&#8220;In previous discussions, you described it somewhat like an IDS, but now it just seems like a real-time, code-integrity checking engine for compute nodes.&#8221;</p>
<p>It&#8217;s probably because I&#8217;m focusing in on individual bits at a time.</p>
<p>The heartbeats and the I/O checking give you the signatures for IDS, which also give you some of the code-integrity checking. The random &#8220;cell search&#8221; gives you full code-integrity &#8220;Monte Carlo&#8221; style.</p>
<p>So there is no gaurenty low level malware cannot get in briefly but it would have to be something quite extrodinary to do much other than be detected quickly.</p>
<p>&#8220;A typical platform is millions of lines of code&#8221;</p>
<p>It depends if you have a monolithic kernel like linux it currently has some 12million lines of code that go into it.</p>
<p>If you look at the Minix 3 kernel it has around 4 thousand lines of code.</p>
<p>If you look at the bottom of the C Standard library there are only a very small handfull of functions that need kernel support.</p>
<p>Going to an I/O Buffer model strips that down even further think of it conceptually like that of the bottom USB comms layer (which I&#8217;m seriously thinking of doing in silicon) in some respects.</p>
<p>In other respects IPC by jumping windows provided by the simple VM MMU controler on a block of external memory (which is like software passing by refrence rather than passing by value, and can have similar issues).</p>
<p>&#8220;which probably correspond to hundreds of thousands of functions,&#8221;</p>
<p>Err no actually about 200 hundred are all that are required and only a handfull get regularly used.</p>
<p>&#8220;each requiring a computer/hypervisor pair.&#8221;</p>
<p>Only whilst they are in active use. Remember that like any tasking computer you page out and task switch to make optimal use of resources.</p>
<p>When you staticaly link the functions a lot of the code bloat and security issues vanish. And the function code becomes very small.</p>
<p>Think of the difference between the Unix command line and stream editors &#8220;ed&#8221; and &#8220;sed&#8221;, and a wysisyg editor like MS Word. Then look at a point or two in between such as vi or jstar and web based editors such as that that appeared in the likes of GMail. There are many ways of doing the same things and each has it&#8217;s advantages and disadvantages. But with a little ingenuity you can do what vi originaly did which was to build on a much simpler primative or function (ed).</p>
<p>&#8220;Even the simplest CISC cores take up a significant chunk of any affordable FPGA.&#8221;</p>
<p>Yup and CISC is most definatly not the way to go it&#8217;s an evolutionary dead end as Intel have discovered.</p>
<p>Some of us are old enough to remember what ARM stands for (Acorn RISC Machines). And also building CPU&#8217;s out of early Texas DSP chips to support &#8220;Forth&#8221; in a significant way which actually only needs 27 base instructions to work well which kind of makes even most RISC CPU&#8217;s look bloated.</p>
<p>You do however have to add a few other hardware instructions for Maths and buffers but it&#8217;s an easy tradeoff senario in most cases.</p>
<p>[Forth for those that are not familiar with it is a &#8220;stack based&#8221; RPN language which has been known to beat optomised C code hands down. The RPN and stacks make analysing it very easy and light work.]</p>
<p>Just to show how crazy it can be sombody developed a LISP system on a Forth engine the performance results where at the time eyebrow raising to say the least.</p>
<p>&#8220;Custom designing functions &amp; acknowledging they will probably be multiplexed to reduce compute node requirements leads me to believe the system still needs almost a hundred thousand FPGA&#8217;s or tens of thousands of high end FPGA&#8217;s.&#8221;</p>
<p>Err no the functions are software images just like any normal program. The Kernel code is very minimal and modular and the C-CPU very &#8220;light weight RISC&#8221; in most cases (and not &#8220;pipe-lined&#8221; which causes all sorts of efficiency issues).</p>
<p>Function code is compiled into static &#8220;micro-images&#8221;  (as are code moduals in embeded systems) and is loaded very rapidly into the C-CPU memory space through the H-CPU.</p>
<p>[There are ways where you can bank switch the memory and registers to the C-CPU so &#8220;context switching&#8221; is just two or three clock cycles, such are the joys of stack based designs.]</p>
<p>IPC / data comms is done currently by memory mapped buffers into a large shared external memory space via a simple VM MMU controler. Thus the results in the output buffer of one &#8220;function&#8221; become the input buffer of the next function.</p>
<p>Importantly from the security context neither the H-CPU or C-CPU have access to the control side of the VM MMU. Thus they have absolutly no knowledge of the external memory just a view of one or more buffers in a fixed place in their memory map.</p>
<p>[This is done by the externaly controled simple VM MMU controler the C-CPU simply changes a status bit to say it&#8217;s finished with a buffer and halts on the external system updating the simple VM MMU controler to the new external memory window and clearing the status bit. This can usually be done as a page counter with address offset so is very very fast (just a couple of clock cycles).]</p>
<p>Imagine the IPC as a circular buffer of buffers with multiple functions using the one circular buffer of buffers in &#8220;lockstep&#8221;.</p>
<p>Thus imagine the functions lined up (A,B,C,D,E,F) each with one &#8220;in&#8221; and one &#8220;out&#8221; buffer. B&#8217;s out buffer will be switched to become C&#8217;s in buffer likewise C&#8217;s out buffer will be switched to become D&#8217;s in buffer. Thus C will stall/block if B has not finished writing to it&#8217;s out buffer, preventing it being switched to become C&#8217;s next in buffer.</p>
<p>However A&#8217;s in buffer gets fed from a &#8220;file&#8221; and F&#8217;s out gets fed to a &#8220;file&#8221;. These &#8220;files&#8221; are again just buffers to either large memory buffers for HD files or heads of streams.</p>
<p>&#8220;Even assuming one could do a lot with an Intel-type wafer&#8221;</p>
<p>Ahh my mistake I was using Intel chips mainly as a &#8220;silicon area/size&#8221; comparison, not a direct function comparison.</p>
<p>That is to give an indicator of gate count pin count internal memory potential and cost that can be achived. Thus alowing a mental comparison to how many of these little beasts can be put in a package (and might well have done if the IBM PC team had picked the Motorola 68K instead of the Intel 8086).</p>
<p>I guess I should have looked for a high end Renedering GPU Chip that would be closer but in most cases their internal structure silicon area is proprietry knowledge so it&#8217;s not easy to use as a comparitor for what&#8217;s possible.</p>
<p>&#8220;Intel&#8217;s manufacturing processes are far ahead of the curve compared to FPGA&#8217;s, proprietary, and unlikely to be released to give them competition.&#8221;</p>
<p>Yes, but unlike GPU manufactures they give away a lot of data in terms of gate density structures and chip area speed through put etc etc in marketing blurb. Which is why if can be used as a fairly reliable indicator of what is possible.</p>
<p>I&#8217;m using FPGA&#8217;s simply for prototyping hardware, in the same way I used to use reprogramable ROM as state machines and in one case an RF IF (but that&#8217;s another story altogether).</p>
<p>If you have a look around you will find you can get PCI cards with multiple FPGA&#8217;s on which means you don&#8217;t have to even think about picking up a soldering iron 8)</p>
<p>&#8220;They&#8217;re too invested in&#8230; &#8230;Looking at&#8230; &#8230;NVIDIA parallel chips, I don&#8217;t see anyone who can sqeeze enough multiplexed functions on a chip to make this design cost-effective.&#8221;</p>
<p>Look at what Sun did with their RISC CPU and Cray designed multiplexing (Starfire systems such as the 10K), likewise what IBM do in their Z machines.</p>
<p>They are still (maybe in Sun&#8217;s case) doing it and producing throughput Intel still has wet dreams about. But Intel can not achive because they have gone to far down an evolutionary culdersac of single chip CISC. Then to get performance Intel have had to add all the pipelining, lookahead and hyperthreading etc etc which chews up a lot of silicon for very little benifit.</p>
<p>Intel chips are designed to &#8220;appear to be all things to all systems&#8221;. But in reality they do a limited set of some things very well for &#8220;office desktops&#8221;. And thus perform badly in high end single user systems and low end servers and just cannot hack it in high end servers (look at context switching times and the underlying reasons).</p>
<p>But the Intel chips are extrodinarily cheap for &#8220;office desktops&#8221; because the overly expensive designs are amortised across multiple millions of chips.</p>
<p>The fact that they do baddly in high end high integration servers is the reason we have gone to clustering. However even here people are looking at using games consoles and graphics cards because the GPU&#8217;s have way way more performance for properly parellel tasks, not just in silicon area but in bang/watt and bang/chip cost.</p>
<p>Go have a look at some early ARM processors and have a look how Unix did the IPC plumbing etc and have a think on how a simple VM MMU controler can be added on to map &#8220;buffers&#8221; for doing all the I/O above the hardware layer.</p>
<p>What I have done is move the tipping point by taking a new look from the bottom up. Instead of using desktop mother boards for making clusters I&#8217;ve used FPGA&#8217;s on PCI cards.</p>
<p>I&#8217;m also currently playing (all be it very slowly) with PC104 cards to see if I can migrate up the COTS stack to get similar effects for considerably less cost. There is a reason for this and it is to do with &#8220;multi media&#8221; some functionality will not go into such limited resources as FPGA&#8217;s. And like it or not high integration PC motherboards do make cheap thin clients for user I/O work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/03/mariposa_botnet.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/03/mariposa_botnet.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F03%2Fmariposa_botnet.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/03/mariposa_botnet.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3299' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/03/comprehensive_n.html" rel="prev">â† Comprehensive National Cybersecurity Initiative</a>		<a href="https://www.schneier.com/blog/archives/2010/03/another_intervi_3.html" rel="next">Another Interview with Me â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
