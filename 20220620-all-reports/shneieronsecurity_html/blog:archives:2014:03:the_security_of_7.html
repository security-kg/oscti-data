<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>The Security of the Fortuna PRNG - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; The Security of the Fortuna PRNG Comments Feed" href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5269" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5269' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F03%2Fthe_security_of_7.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F03%2Fthe_security_of_7.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5269 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5269" class="post-5269 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-fortuna tag-protocols tag-random-numbers tag-schneier-news">

	<div class="article">

		<h2 class="entry">The Security of the Fortuna PRNG</h2>
		<p>Providing random numbers on computers can be very difficult.  Back in 2003, Niels Ferguson and I designed <a href="https://www.schneier.com/fortuna.html">Fortuna</a> as a secure PRNG.  Particularly important is how it collects entropy from various processes on the computer and mixes them all together. </p>
<p>While Fortuna is widely used, there hadn&#8217;t been any real analysis of the system.  This has now changed.  A new <a href="http://eprint.iacr.org/2014/167">paper</a> by Yevgeniy Dodis, Adi Shamir, Noah Stephens-Davidowitz, and Daniel Wichs provides some theoretical modeling for entropy collection and PRNG.  They analyze Fortuna and find it good but not optimal, and then provide their own optimal system.</p>
<p>Excellent, and long-needed, research.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/fortuna/" rel="tag">Fortuna</a>, <a href="https://www.schneier.com/tag/protocols/" rel="tag">protocols</a>, <a href="https://www.schneier.com/tag/random-numbers/" rel="tag">random numbers</a>, <a href="https://www.schneier.com/tag/schneier-news/" rel="tag">Schneier news</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html" rel="bookmark">Posted on March 11, 2014 at 6:28 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html#comments">36 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html" data-title="The Security of the Fortuna PRNG" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-217713">

			<div class="comment by-error ">

				<p class="commentcredit">

					<span class="commenter">Error?</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217713">
						March 11, 2014 7:52 AM					</a>

				</p>

				<p>Good morning Bruce.  The Tags link to Fortuna isn&#8217;t a link.  Or maybe this isn&#8217;t an error?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217715">

			<div class="comment by-ryan ">

				<p class="commentcredit">

					<span class="commenter">Ryan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217715">
						March 11, 2014 8:35 AM					</a>

				</p>

				<p>Bruce, any thoughts on their use of AES instead of a secure hash function with a larger state (and therefore larger pools) as you chose in the original Fortuna design?</p>
<p>IANA cryptographer, but using a PRF with only 2^128 states that never repeat just <em>feels</em> wrong in a cryptographic PRNG, no matter how often it is re-keyed. Isn&#8217;t such a construction inherently biased by the fact that outputs cannot repeat over short intervals?</p>
<p>To overcome, you can of course only use say 64-bits of each AES output, but then you&#8217;ve halved any throughput gains made by using AES in the first place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217716">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217716">
						March 11, 2014 9:57 AM					</a>

				</p>

				<p>@Ryan.<br />
While I think Fortuna was probably designed before this was important, current Intel (and AMD) chips can do AES in hardware.  Getting SHA256 in hardware currently involves buying bitcoin mining hardware, so expect a price premium.  I&#8217;d expect using the first 64 bits with SSE3 (whichever includes AES) to be more effective, even if this means doing the operation twice (or four times and be fed by an additional 64 bits from a separate AES buffer).</p>
<p>I admit, I&#8217;m rather surprised at the use of SHA256 in the entropy pools and AES as the &#8220;main hash&#8221;.  Sounds like multiple points of failure (mainly chances to get the algorithm wrong).  I can only assume that SHA256 wasn&#8217;t fast enough when fortuna was originally designed (and even if it is now, AES has a sufficient speed advantage for the output).</p>
<p>Note that the paper seemed to assume a source of perfect randomness.  Even before the Intel Hardware RNG scandal, this was likely the tricky (and untestable/unprovable) part of the design.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217717">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217717">
						March 11, 2014 12:01 PM					</a>

				</p>

				<p>@Ryan</p>
<p>Block ciphers in counter mode have been well studied, and they should provide sufficient randomness as long as there are no distinguishing attacks.</p>
<p>That said, I&#8217;d love to see Keccak analyzed for this purpose; it seems like sponge functions are ideal for this task.</p>
<p><a href="http://sponge.noekeon.org/SpongePRNG.pdf" rel="nofollow ugc">http://sponge.noekeon.org/SpongePRNG.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217718">

			<div class="comment by-matt ">

				<p class="commentcredit">

					<span class="commenter">matt</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217718">
						March 11, 2014 12:01 PM					</a>

				</p>

				<p>why the heck isn&#8217;t anyone talking about making random number generators from quantum noise? random.org used fm radio static into a sound card for years. Geiger counters with a small radioactive source (potassium is radioactive  &#8211; salt substitute!) are inexpensive too. makes me think the egos of software designer&#8217;s are more interested in solving a software problem than implementing a cheap, easy physical solution that actually would work!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217719">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217719">
						March 11, 2014 12:11 PM					</a>

				</p>

				<p>@matt</p>
<p>Systems like Fortuna are about collecting available entropy on existing systems without adding new hardware to do so. It has nothing to do with egos, it has to do with the reality that pretty much everyone needs quality random numbers available on their system, and not everyone is going to buy specialized hardware random number generators.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217720">

			<div class="comment by-matt-is-dumb ">

				<p class="commentcredit">

					<span class="commenter">matt is dumb</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217720">
						March 11, 2014 12:13 PM					</a>

				</p>

				<p>why the heck isn&#8217;t anyone talking about making quantum noise generators to trick quantum noise based random number generators into delivering predictable results?   people have had FM transmitters for years and people still trust that silly hack.  makes me think the egos of matt&#8217;s are more interested in &#8220;solving&#8221; a problem than actually solving the problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217721">

			<div class="comment by-macarthur ">

				<p class="commentcredit">

					<span class="commenter">Macarthur</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217721">
						March 11, 2014 12:45 PM					</a>

				</p>

				<p>I&#8217;m really glad that you summarized it Mr. Schneier, because reading over the paper I could barely grasp all of the insanely high number of mathematical symbols. I hope that someone who understand sit all can update fortuna and make it more robust.</p>
<p>P.S. I tried to understand it, but honestly way too many crazy high-level stuff in it. I was glad that it wasn&#8217;t that weird two-column system that I see in a lot of papers but that math I don&#8217;t know.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217722">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217722">
						March 11, 2014 2:28 PM					</a>

				</p>

				<p>Matt,<br />
The hardware generator in Intel processors uses thermal noise which should be roughly as good as your &#8220;quantum noise&#8221;.  At current design rules, they may even qualify as &#8220;quantum noise&#8221; (some measurable bits&#8217; worth, at least).  I&#8217;d expect even more specialized chips to be far less trustworthy.</p>
<p>I&#8217;ll take drive head travel and other proven oldies, although I&#8217;m not sure why it isn&#8217;t more common to put a microphone near a fan since most computers have microphone inputs built in (check the fft for randomness, then hash into the needed chunks).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217723">

			<div class="comment by-shaping ">

				<p class="commentcredit">

					<span class="commenter">shaping</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217723">
						March 11, 2014 3:10 PM					</a>

				</p>

				<p>RE: matt/matt is dumb</p>
<p>Both these characters could be NSA sock puppets aimed at undermining confidence in the use of physical random number generators as such.</p>
<p>The one thing the NSA fears more than anything else is a crypto system that they can&#8217;t even in principle crack like one-time pad.</p>
<p>So they emphasize all the defects in such a system while downplaying the advantages.</p>
<p>This is where cryptography meets psychological shaping operations.</p>
<p>The goal is to tilt the future development of cryptographic systems in their favor like they did with the BULLRUN program.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217724">

			<div class="comment by-jonathan-wilson ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Wilson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217724">
						March 11, 2014 4:29 PM					</a>

				</p>

				<p>I am surprised that we haven&#8217;t seen support for SHAx in the latest CPUs given how widely its used.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217725">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217725">
						March 11, 2014 6:01 PM					</a>

				</p>

				<p>Jonathan &#8211; coming in Skylake:</p>
<p><a href="https://en.wikipedia.org/wiki/Intel_SHA_Extensions" rel="nofollow ugc">https://en.wikipedia.org/wiki/Intel_SHA_Extensions</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217726">

			<div class="comment by-snarki-child-of-loki ">

				<p class="commentcredit">

					<span class="commenter">Snarki, child of Loki</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217726">
						March 11, 2014 6:40 PM					</a>

				</p>

				<p>Matt,<br />
I suggest you give physical RNG a try.  What you&#8217;ll find is that it gives you a reasonable, but not perfect, source of entropy. So you still have to do the cryptographic post-processing to get good random numbers.</p>
<p>There are those who have tried physical random number generators, and those who advocate them. Those sets are nearly 100% disjoint.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217727">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217727">
						March 11, 2014 7:44 PM					</a>

				</p>

				<p>I was considering using my own block cipher to make a PRNG, but I need more people to look at it first. It&#8217;s 512/32 round and I&#8217;m going to put it on Sourceforge soon.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217728">

			<div class="comment by-matt ">

				<p class="commentcredit">

					<span class="commenter">matt</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217728">
						March 11, 2014 7:56 PM					</a>

				</p>

				<p>Nope, not a sock puppet here. Semi-competent grouch?</p>
<p>After Fortuna has allowed the system to boot, given the low cost and high quality of physical RNG numbers, why would you want to use a pseudo RNG at all the rest of the time?</p>
<p>In a thousand years, can you guarantee that any pseudo RNG algorithm won&#8217;t be weakened or broken? Nope. A $12 fm radio has true perfect forward secrecy, and gets rid of a large chunk of very complicated code.</p>
<p>It would not be hard for an EE to design one out of discrete components (apart from the USB or PCI interface chips) thereby avoiding compromise of the hardware, like the fuss over the intel motherboard random number generator chip. Reverse biased diode, amp, A/D converter, interface.</p>
<p>Thank you for all of your replies and explanations. Sorry about getting trollish earlier.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217729">

			<div class="comment by-carl-sai-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Carl &#039;SAI&#039; Mitchell</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217729">
						March 11, 2014 8:11 PM					</a>

				</p>

				<p>@matt<br />
The issue is you still need to normalize (whiten) the outputs of the TRNG. Physical generators invariably have biases, and cryptographic uses of random numbers don&#8217;t tolerate such biases. So you use the TRNG to seed an entropy pool for a CSPRNG. Also, many physical sources open up an extra channel by which to attack the generator. Designing a hardware random number generator isn&#8217;t that hard, making it work well takes some actual effort, and making it secure on its own is quite complex.</p>
<p>A $12 FM radio is vulnerable to someone with a $20 FM transmitter.</p>
<p>@Chris Abbott<br />
Your qualifications are what? You&#8217;ve broken which algorithms? Given how difficult making a secure cypher is don&#8217;t expect anyone to spend even 30 seconds looking over it unless you can show you are qualified to be producing such a thing. It takes a huge amount of effort to evaluate a cryptographic algorithm properly (years of work,) and so no one will do that for free, for someone with no significant history of being a good cryptanalyst.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217730">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217730">
						March 11, 2014 8:54 PM					</a>

				</p>

				<p>Two nice Ritter surveys on TRNG&#8217;s.</p>
<p><a href="http://www.ciphersbyritter.com/RES/NOISE.HTM" rel="nofollow ugc">http://www.ciphersbyritter.com/RES/NOISE.HTM</a></p>
<p><a href="http://www.ciphersbyritter.com/RES/RNGMACH.HTM" rel="nofollow ugc">http://www.ciphersbyritter.com/RES/RNGMACH.HTM</a></p>
<p>Geiger counter based designs are mentioned in one of the links. <a href="http://www.blackcatsystems.com/GM/products/GM10GeigerCounter.html" rel="nofollow ugc">Here</a> is one that specifically warns that it picks up background radiation with $199 serial port and $249 USB models. Connect it&#8217;s measurements to an entropy pool whose hash feeds a CRNG.</p>
<p>People wanting a software solution without external device can always consider something like Haveged or DakaRND. These convert hardware timing fluctuations into random numbers. This type of generator&#8217;s actual security isn&#8217;t well-understood, though.</p>
<p>The coolest one at one point was LavaRNG. They aimed a camera at a lava lamp to provide truly random input to feed a post-processing phase. They later got rid of a lava lamp using a camera and a box. Or something like that.</p>
<p>I just used dice and well-shuffled cards to produce enough entropy for a seed. I manually entered this into a program that produced a hashed master secret from it. This was fed into a CRNG to produce the actual random numbers (or other CRNG&#8217;s seed keys). An updated version gathered every bit of data, esp unique data, it could on my system into another hash image. There&#8217;s usually also timing (a la havage) and network sniff data fed into another. These were combined with the master secret using hash functions, with the function run a number of times between each step. Sometimes I used different hash functions.</p>
<p>A previous posting here I pointed out that the easiest method is a specific, hardened, custom device for producing RNG&#8217;s. The devices produces them and they&#8217;re sent to the other systems. Transport might be a safe physical media, over a network, and so on. If other nodes use good CRNG, the RNG appliance might not even need to generate much. Entropy pool updates over a network can also be automated to happen periodically and via a one-way cable so master node isn&#8217;t compromised. Admin just receives reports from nodes that they received the data, maybe with the hash. Admin also gets a report from RNG appliance which should match.</p>
<p>Note: There&#8217;s now a <a href="http://www.vanheusden.com/entropybroker/" rel="nofollow ugc">tool</a> available that does a variation of what mine did.</p>
<p>Network taps themselves can also make for good entropy sources if your network has a mix of devices and workloads. Just periodically sampling packets and hashing them is simple enough. The important thing is that there&#8217;s a user-entered master secret of max entropy and the other entropy is combined with it safely. Let&#8217;s not forget onboard generators like Intel&#8217;s or VIA&#8217;s which, when used as an untrusted added source, provide a nice boost for my design even if they&#8217;re rigged to be non-random. That&#8217;s because the strongest link verified by my own hands and eyes.</p>
<p>Last minute addition: wireless sniffers. Tapping into a bunch of people nearby&#8217;s network activity would provide source of random data. There&#8217;s legal and ethical issues with that. However, one can sniff WiFi traffic with ease. Moreover, sampling encrypted traffic like is common with personal WiFi would preserve those people&#8217;s privacy. Further, if content itself was mixed in, the fact that it&#8217;s already randomized by encryption should add nicely to the entropy. It&#8217;s not <em>truly</em> random, but it will at least have a random distribution.</p>
<p>What do you all think of using WiFi sniffers in a neighborhood with plenty of encrypted AP&#8217;s as an input source? And, btw, this is in context of my scheme where at least one highly verified method is used in the process and other entropy is to make job computationally harder. And where we are using software only solutions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217731">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217731">
						March 11, 2014 9:02 PM					</a>

				</p>

				<p>@ Chris Abbott</p>
<p>He&#8217;s not being mean. He&#8217;s simply telling the truth. You&#8217;re better off using the existing, well-analyzed ciphers for any practical project. There are existing CRNG constructions that survived years of analysis. I just use them and feed extra stuff into the seeding process to make attacker&#8217;s job harder. Finding clever ways to put extra complexity for an attacker while using little extra CPU/memory and without breaking security proofs of your crypto functions will give you all the problem-solving fun you want. ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217732">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217732">
						March 12, 2014 1:20 AM					</a>

				</p>

				<p>All that said, I find making block ciphers to be fun, personally. Make all the ciphers you want, just don&#8217;t expect anyone to take them seriously.</p>
<p>I would never use any that I actually wrote myself. I have always said I would use my ciphers only so I can learn how to break them&#8230; I&#8217;ve been half-way through a number theory book for about 2 years, so you can see how that is going (I&#8217;m a community college dropout, so it&#8217;s really a pain to get that deep into the theory &#8211; I&#8217;d rather program).</p>
<p>I am actually proud of how far I&#8217;ve evolved with my latest cipher (although key setup is really slow):<br />
<a href="https://github.com/AnuraBufo/bufo" rel="nofollow ugc">https://github.com/AnuraBufo/bufo</a></p>
<p>Every cipher I make, I end up learning where it can be improved, learning from my mistakes, etc. I&#8217;m sure a year from now, I&#8217;ll look at that and say &#8220;Hey, I know what I could have done to make it better!&#8221; or (hopefully not) &#8220;Wow, that was a huge, glaring mistake!&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217733">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217733">
						March 12, 2014 1:43 AM					</a>

				</p>

				<p>Off-topic background information:</p>
<p>Originally, the core transformation used in that cipher (logically consisting of eight bijective 8&#215;8 bit s-boxes, and eight injective 8&#215;56 bit sboxes combined addition modulo 2^56, with 8 rotations, but implemented as a eight 8&#215;64 bit s-boxes using addition modulo 2^64 and still 8 rotations) was designed for a somewhat memory-bound hash function called Rana, which was inspired by my last &#8220;genius&#8221; cipher idea, which used an 8&#215;8 MDS matrix, and ended up being significantly slower than expected; I found out the poor performance was due entirely to memory access.</p>
<p>The idea of a memory-bound hash function was that it could be used along-side a  key-stretching function to make it more expensive. I eventually scrapped the whole idea of relying on a memory-bound hash function in the first place when designing my KDF (which I do actually hope to get published&#8230; if I ever finish the paper). I decided to later make a cipher from the transformation for fun, which became Bufo and has been gathering cobwebs for the past few months.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217734">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217734">
						March 12, 2014 2:20 AM					</a>

				</p>

				<p>I remember my first cipher, it used xor, rotation, and bitwise-and operations only&#8230; It might have been strong (highly unlikely)&#8230; but it had a throughput of about 10Kbps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217735">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217735">
						March 12, 2014 3:52 AM					</a>

				</p>

				<p>Hardware entropy generator?</p>
<p>A cheap microphone directed at the fan of your computer will give you quite a number of bits of entropy.</p>
<p>Whitening is needed, as always.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217736">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217736">
						March 12, 2014 7:10 AM					</a>

				</p>

				<p>@ Matt,</p>
<ul><i>why the heck isn&#8217;t anyone talking about making random number generators from quantum noise? random.org used fm radio static into a sound card for years</i></ul>
<p>Simple answer quick : They are more trouble than they are worth for ordinary usage.</p>
<p>The longer answer is to do with &#8220;Signal to Noise&#8221; in what is at the lowest level an analog signal. You have three parts to consider,</p>
<p>1, The physical source.<br />
2, The amplification chain.<br />
3, The sampling and digitisation system.</p>
<p>All of these parts are not closed systems and thus subject to various sources of external interferance, likewise they are not perfect so they distort the signal in amplitude and time and suffer from limited bandwidth.</p>
<p>Now consider the actual signal comming from the source it consists of three parts,</p>
<p>1, Predictable signal (offset and bias).<br />
2, faux entropy (determanistic noise).<br />
3, Real entropy (undetermanistic noise).</p>
<p>You are only interested in the real entropy and in general that is only a tiny fraction of the signal from the source.</p>
<p>Whilst the offset and bias can be predicted in both amplitude and time the instantanious values cannot, thus any correction system will result in error signal the magnitude of which may be comparable with the real entropy signal you are actually looking for.</p>
<p>The faux entropy signal is the real problem, whilst it may be determanistic, it may be undetermanistic to you but not an adversary attacking your system by injecting a signal know to them. Further it could be you don&#8217;t sufficiently test your source sufficiently. For instance you might take a signal from a fan, you would expect it to have a rotational component based on the fan RPM, but consider it might be a DC fan which is sensitive to changes in the supply voltage these means your rotational signal is going to be frequency modulated by some function of the supply voltage. Likewise it is also going to be effected by the load on the fan blades. An attacker may be able to &#8220;add&#8221; a signal that you cannot detect which would either swamp or sink the real entropy out.</p>
<p>The problem you have is not in combating this (you can generate an antiphase or subtractive signal) but in identifing it. You have only finite resources and limited time and thus can only address a tiny fraction of the problem. Thus unless you take some quite extream precautions you could be attacked and not know it.</p>
<p>For instance you mention the use of an FM radio. Firstly are you aware of the effects of the radios &#8220;de-emphassis&#8221; circuit and IF bandwidth and any AFC circuit and how it responds to noise that might look like a valid stereo pilot tone and how to deal with them correctly? How about break through in the audio circuits from the stereo decoder circuit? Mains hum breakthrough in RF and Audio and what effect it has on the radio&#8217;s local oscillator?</p>
<p>Then how do you know if mains bourn interferance is not getting into the radio front end or power supply unit or any other part of the radio? How about well out of band interferance from say a GSM mobile phone or two way radio or local Ham operator? How would you go about detecting it? How about adjacent channel interferance that comes and goes due to changing propergation effects?</p>
<p>All these have to be taken into account and firstly detected befor corrected&#8230;</p>
<p>Then an attacker can do all sorts of tricks over and above those which you would find difficult to detect even if you were aware of them. One such is to generate an artigicial noise signal and raise it to slightly above the background noise level but below any detector threashold you have (2-3dB up is usually sufficient). They could also at the same time direct an out of band signal of large amplitude at the radio that would &#8220;quieten&#8221; other noise sources. What you would see would be from your point of view the same as normal ie noise of a given amplitude, however the attacker is actually feeding a signal that is fully determanistic to them but not you&#8230;</p>
<p>If you have difficulty in beleving this a few years ago two researchers at the Uni of Cambridge Computer Labs obtained a &#8220;high quality&#8221; commercial True Random Noise Generator and hit it with an unmodulated microwave signal the result was to take it&#8217;s output from 32 bits of entropy down to around 7bits that makes guessing attacks trivial. That is the effect of an out of band quietening signal. Now imagine what would have been the result if they had modulated it with synthetic noise. To the normal (mainly usless) tests the output would look perfectly valid. However when correlated to the synthetic noise source the corelation would be very high&#8230;</p>
<p>Such are the problems with TRNG&#8217;s and mildly sophisticated attackers&#8230; I&#8217;m aware of other more sophisticated attacks that I developed back in the 1980&#8217;s so I&#8217;m sure that many other more sophisticated directed attacks are possible and available to knowledgable and moderatly resourced attackers (ie less than 10,000USD of &#8220;home-brew&#8221; kit).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217737">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217737">
						March 12, 2014 11:38 AM					</a>

				</p>

				<p>Also, it should be said that you don&#8217;t need special hardware to get truly random data: video, audio, mouse movements, time between key presses, performance statistics (cpu usage, IO, temperature, fan speed), and noise from other devices can be used to provide entropy. Some intel CPUs have the, highly criticized, RdRand generator built in. Some AMD CPUs also have hardware random number generators</p>
<p>The thing is that no single source of entropy should be trusted, so the solution is to take as many entropy sources as possible and run them through a cryptographic function so that even if a large number of sources are compromised, the system itself should remain secure. Ideally, even if quality sources dry up and you only have compromised sources remaining, then it still should not be exploitable to an outside attacker who is not aware of the state, provided at one point the RNG was seeded with sufficient entropy (and ideally the RNG would save its state so that the next time the system boots, the RNG is in a state that is unpredictable by anyone who does not have access to the machine).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217738">

			<div class="comment by-namesaresmokeamongbrighterclouds ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ip.e-sushi.net/' rel='external nofollow ugc' class='url'>NamesAreSmokeAmongBrighterClouds</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217738">
						March 12, 2014 1:43 PM					</a>

				</p>

				<p>Nice to see you mention the paper. To me, that builds additional trustâ€¦ which â€“ in these days â€“ I regard to be the most valuable asset.</p>
<p>Thanks!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217739">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217739">
						March 12, 2014 6:04 PM					</a>

				</p>

				<p>I&#8217;m only partially through the paper. In section 3.1, where it says &#8220;Correspondingly, such RNGs typically include some ad hoc entropy estimation procedure E whose goal is to block the RNG from outputting output value Rj until the state has not accumulated enough entropy gamma* (for some entropy threshold gamma*).&#8221;, either I just don&#8217;t understand this or &#8216;until&#8217; is supposed to be &#8216;if&#8217; (or maybe the &#8216;not&#8217; should be omitted).</p>
<p>In Figure 5, in the proc. refresh(seed, S, I), is it intended that the</p>
<p>(Sout, R)&lt;&#8211;nextout(seedG, Sout)<br />
Srho&lt;&#8211;Srho^R</p>
<p>steps be omitted when SC(skey, tau) returns upside-down-T as the value for out?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217740">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217740">
						March 12, 2014 6:40 PM					</a>

				</p>

				<p>I&#8217;m surprised at Figure 8, namely the 2 in</p>
<p>ELSE out&lt;&#8211;max{out: tau = 0 mod 2**out*P/wmax}</p>
<p>when I looked at the equivalent part of Fortuna, some time ago, my first thought was that the 2 was arbitrary, and that 3 or 4 (or 1.5) might be better. Now Dodis, Shamir, Stephens-Davidowitz and Wichs have agreed with Ferguson and Schneier, and put their imprimatur on 2. Ugh. It would probably take me weeks to work out a proof that 2 either is or isn&#8217;t better than alternatives.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217741">

			<div class="comment by-mike-amling ">

				<p class="commentcredit">

					<span class="commenter">Mike Amling</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217741">
						March 13, 2014 1:43 PM					</a>

				</p>

				<p>This is what happens when I don&#8217;t first read the entire paper.</p>
<p>I wrote about 2**out in Figure 8 to an author of the paper, and they were kind enough to write back:</p>
<blockquote><p>
&#8230;<br />
In the constant-rate regime, there&#8217;s a very clear way to judge a scheme: You simply compute what we call the competitive ratio, r, which is just the ratio of the maximum entropy that we need to receive to be secure relative to an idealized scheme that knows everything about the system (e.g., how much entropy it&#8217;s received, when it&#8217;s been compromised, etc.). In this regime, our best scheme is about twice as efficient as the original Fortuna with the numbers that Ferguson and Schneier suggest, and it uses a base of 3. See Theorem 5, and in particular note the parameter b and the parametrized competitive ratio r_b. Intuitively, we achieve a competitive ratio proportional to roughly (b+1/b)/\log(b), and it turns out that that&#8217;s minimized at b=3. (It happens that base 4 is almost as good, which might be convenient for practitioners.)<br />
<br />In the non-constant-rate regime the situation is a bit complicated. In particular, our security definition is slightly subtle, with two parameters, \alpha and \beta. If we receive some amount of entropy proportional to \alpha in time T, then we guarantee security at time \beta*T. Intuitively, once we&#8217;ve received sufficient entropy, we need to take some sufficient additional time to get that entropy into the register, the time that this takes is proportional to the amount of time that it took us to get the entropy in the first place. \alpha defines &#8220;sufficient entropy&#8221; and \beta defines &#8220;sufficient additional time&#8221; (multiplicatively).<br />
<br />
The scheme from Figure 8 in base b achieves \beta = b^2 and \alpha proportional to 1/\log(b). So, in theory, there&#8217;s just a tradeoff between \alpha and \beta and no real way to define an optimal base. However, note that in the constant-rate case, the competitive ratio r just corresponds to \alpha * \beta, so a natural thing to do is simply to extend this and minimize \alpha * \beta, which gives b = 2. (We can argue more rigorously that this parameter makes sense.) But, it&#8217;s worth noting that these parameters necessarily come from a fairly extreme worst-case analysis that, in particular, assumes that our entropy source gives us just enough entropy and then stops providing any more. We could define a model in which we ask our entropy source to be &#8220;roughly constant&#8221; over &#8220;long&#8221; periods of time, and depending on the definitions of &#8220;roughly constant&#8221; and &#8220;long&#8221;, b = 3 might give a better competitive ratio than b = 2.<br />
<br />
Given all of this ambiguity and how complex the paper already was, we just fixed b = 2 in the non-constant-rate regime.<br />
&#8230;
</p></blockquote>
<p>Just on instinct, I had used 3 in my adaptation of Fortuna to Keccak last year.</p>
<p>Another issue I was going to raise, namely that Figure 4 passes skey to attacker A but not to adversarial entropy supplier E, is addressed in section 7.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217742">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217742">
						March 13, 2014 1:49 PM					</a>

				</p>

				<p>@Nick, Carl<br />
It&#8217;s just something I&#8217;ve done for fun and educational reasons. Something people could check out for the hell of it as a curiosity. Of course I would disclose that to people. I don&#8217;t advocate anybody actually use it for anything important. I always use AES and Twofish for real projects.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217743">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217743">
						March 13, 2014 2:19 PM					</a>

				</p>

				<p>@ Chris</p>
<p>Sounds good. I&#8217;m all for people tinkering around, learning, and having fun. It&#8217;s the very essence of hacking in the old meaning of the term.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217744">

			<div class="comment by-chris-abbott ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://abbottit.com' rel='external nofollow ugc' class='url'>Chris Abbott</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217744">
						March 13, 2014 9:22 PM					</a>

				</p>

				<p>Yeah, if anyone wants to see the source I&#8217;ll put it on my website.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217745">

			<div class="comment by-joachims ">

				<p class="commentcredit">

					<span class="commenter">JoachimS</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217745">
						March 14, 2014 4:00 AM					</a>

				</p>

				<p>Anura: Just looked at the code at github. A few observations:</p>
<p>(1) HUGE s-boxes. You will probably be vulnerable to time based side channel attacks.</p>
<p>(2) Where does the constants in t.c and f.c come from? You should document that so anybody can replicate it. Even you. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217746">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217746">
						March 14, 2014 4:48 AM					</a>

				</p>

				<p>@JoachimS</p>
<p>I have all the code I used to generate them. The sboxes are 8 8&#215;64 bit sboxes, which is about 4x the memory as you can expect in most software implementations and AES. And yeah, timing attacks are a possibility.</p>
<p>The sboxes in f.c were found via a pseudorandom search. I basically seeded xorshift with constants I copied from sha512 (entirely for convenience), randomly sorted an array with the numbers 0-255, and ran for a few weeks until I found sboxes with suitable cryptographic properties: nonlinearity 98, max value of 8 in xor table, and a generalization of the bit independence/avalanche/completeness criterion in which for every input differential and every combination of output bits, I check that the parity is 1 with a probability of 0.5 +/- 40/256 (extremely difficult to find good numbers for that property randomly, but for comparison AES sbox has a bias of 16/256).</p>
<p>The sboxes in t.c are computed from f.c; I&#8217;d have to check the code to generate it, but IIRC each byte is basically computed by nesting functions in f.c a number of times depending on the position, with a constant 0x00-0x07 xord depending on the position. You can see that the least significant byte for t[m][n] is f[m][n]-n.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217747">

			<div class="comment by-jeff-epler ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://emergent.unpythonic.net' rel='external nofollow ugc' class='url'>Jeff Epler</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217747">
						March 14, 2014 4:52 PM					</a>

				</p>

				<p>As a person who has dabbled with hardware &#8220;true&#8221; random number generators, I &#8220;independently discovered&#8221; plenty of lessons about this topic.</p>
<p>One of the big items I learned is: Very simple whitening methods together with very biased inputs can give output streams that readily pass statistical randomness tests like dieharder (i.e., &#8220;my PRNG/TRNG passes DieHarder&#8221; doesn&#8217;t mean much).  Only analysis like we see in this paper can really give you confidence that your outputs are unguessable by an adversary with specific capabilities.</p>
<p>So while the math is way over my head I say: I hope that my favorite operating systems will take lessons from it as soon as possible to improve their cryptographic-quality random number generation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-217748">

			<div class="comment by-rogelio-m-serrano-jr ">

				<p class="commentcredit">

					<span class="commenter">Rogelio m. Serrano Jr.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217748">
						September 5, 2014 6:26 PM					</a>

				</p>

				<p>In the paper the authors mentioned an optimisation. What is it exactly? The pool to be filled is chosen randomly and then also emptied randomly and a random permutation of the pools are emptied every 32nd reseed?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-217749">

			<div class="comment by-researcher ">

				<p class="commentcredit">

					<span class="commenter">Researcher</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/#comment-217749">
						April 1, 2018 4:33 PM					</a>

				</p>

				<p>A few days ago I found a site which is dedicated to the PCG PRNG and mentions all publicly available algos with corresponding critics including Fortuna. Fortuna is mentioned in the blog of the site. It would be nice if Mr.Schneier would comment. Currently (I&#8217;m not surprised) the site is under DDoS or simply unavailable. <a href="http://www.pcg-random.org/" rel="nofollow ugc">http://www.pcg-random.org/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/03/the_security_of_7.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/03/the_security_of_7.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F03%2Fthe_security_of_7.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/03/the_security_of_7.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5269' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/03/firewalk_nsa_ex.html" rel="prev">â† FIREWALK: NSA Exploit of the Day</a>		<a href="https://www.schneier.com/blog/archives/2014/03/ragemaster_nsa.html" rel="next">RAGEMASTER: NSA Exploit of the Day â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
