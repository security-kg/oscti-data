<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Firefox Enables DNS over HTTPS - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Firefox Enables DNS over HTTPS Comments Feed" href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/12396" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=12396' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F02%2Ffirefox_enables.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F02%2Ffirefox_enables.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-12396 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-12396" class="post-12396 post type-post status-publish format-standard hentry category-uncategorized tag-browsers tag-child-pornography tag-dns tag-firefox tag-https tag-mozilla tag-security-engineering tag-terrorism">

	<div class="article">

		<h2 class="entry">Firefox Enables DNS over HTTPS</h2>
		<p>This is <a href="https://techcrunch.com/2020/02/25/firefox-dns-https-default-united-states/">good news</a>:</p>
<blockquote><p>Whenever you visit a website &#8212; even if it&#8217;s HTTPS enabled &#8212; the DNS query that converts the web address into an IP address that computers can read is usually unencrypted. DNS-over-HTTPS, or DoH, encrypts the request so that it can&#8217;t be intercepted or hijacked in order to send a user to a malicious site.</p>
<p>[&#8230;]</p>
<p>But the move is not without controversy. Last year, an internet industry group branded Mozilla <a href="https://techcrunch.com/2019/07/05/isp-group-mozilla-internet-villain-dns-privacy/">an &#8220;internet villain&#8221;</a> for pressing ahead the security feature. The trade group claimed it would make it harder to spot terrorist materials and child abuse imagery. But even some in the security community are split, amid warnings that it could make incident response and malware detection more difficult.</p>
<p>The move to enable DoH by default will no doubt face resistance, but browser makers have argued it&#8217;s not a technology that browser makers have shied away from. Firefox became the first browser to implement DoH &#8212; with others, like Chrome, Edge, and Opera &#8212; quickly following suit.</p></blockquote>
<p>I think <a href="https://en.wikipedia.org/wiki/DNS_over_HTTPS">DoH</a> is a great idea, and long overdue.</p>
<p>Slashdot <a href="https://it.slashdot.org/story/20/02/25/1210223/firefox-to-enable-dns-over-https-by-default-to-us-users">thread</a>. Tech details <a href="https://hacks.mozilla.org/2018/05/a-cartoon-intro-to-dns-over-https/">here</a>. And <a href="https://www.zdnet.com/article/dns-over-https-causes-more-problems-than-it-solves-experts-say/">here&#8217;s</a> a good summary of the criticisms.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/browsers/" rel="tag">browsers</a>, <a href="https://www.schneier.com/tag/child-pornography/" rel="tag">child pornography</a>, <a href="https://www.schneier.com/tag/dns/" rel="tag">DNS</a>, <a href="https://www.schneier.com/tag/firefox/" rel="tag">Firefox</a>, <a href="https://www.schneier.com/tag/https/" rel="tag">https</a>, <a href="https://www.schneier.com/tag/mozilla/" rel="tag">Mozilla</a>, <a href="https://www.schneier.com/tag/security-engineering/" rel="tag">security engineering</a>, <a href="https://www.schneier.com/tag/terrorism/" rel="tag">terrorism</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html" rel="bookmark">Posted on February 25, 2020 at 9:15 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html#comments">60 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html" data-title="Firefox Enables DNS over HTTPS" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-347076">

			<div class="comment by-whiten01se ">

				<p class="commentcredit">

					<span class="commenter">WhiteN01se</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347076">
						February 25, 2020 9:37 AM					</a>

				</p>

				<p>&#8220;Using a DoH implementation within an application: Some browsers have a built-in DoH implementation and can thus <b>perform queries by bypassing the operating system&#8217;s DNS functionality</b>. A drawback is that an application may not inform the user if it skips DoH querying, either by misconfiguration or lack of support for DoH.&#8221; (Wikipedia)</p>
<p>And that&#8217;s where it flies right out of the window. I decide what DNS is to be used (in this case: my piHole), not anybody else. Period.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347077">

			<div class="comment by-tz ">

				<p class="commentcredit">

					<span class="commenter">tz</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347077">
						February 25, 2020 9:43 AM					</a>

				</p>

				<p>One problem is login or click here for ToS bounce pages, but I&#8217;ve found that going to (<a href="http://" rel="nofollow ugc">http://</a>)1.1.1.1 usually can bring them up.  Otherwise some other fixed IP.</p>
<p>There&#8217;s also DNS-over-TLS which also works, but HTTPS adds a few things making it more efficient.</p>
<p>You still need to do &#8220;custom&#8221; for NextDNS in firefox if you want your account settings to be used (just add /123456/devid &#8211; account number, optional &#8220;device&#8221; string).</p>
<p>I like NextDNS because it has great analytics and configurable block, white, and blacklisting.  I managed to shut off most invasiveness on my network security cameras, but they kept getting time from specific NTP sites (time.nist.gov, time.microsoft.com, time.apple.com) and I saw that in the NextDNS.io logs and analytics.  And one Android app I used keeps wanting to talk to Facebook.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347078">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347078">
						February 25, 2020 9:46 AM					</a>

				</p>

				<p>I wonder, if one <em>somehow</em> simply relied on IP numbers directly for accessing a website, would that in theory negate any and all use of a DNS server?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347079">

			<div class="comment by-ken ">

				<p class="commentcredit">

					<span class="commenter">Ken</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347079">
						February 25, 2020 9:51 AM					</a>

				</p>

				<p>It&#8217;s a trust issue more than a security issue. I trust our locally managed DNS far more than I trust some browser vendor with an unknown agenda.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347080">

			<div class="comment by-whiten01se ">

				<p class="commentcredit">

					<span class="commenter">@WhiteN01se</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347080">
						February 25, 2020 10:00 AM					</a>

				</p>

				<p>Just switch the DoH provider to your pi-hole and the problem is solved: <a href="https://docs.pi-hole.net/guides/dns-over-https/" rel="nofollow ugc">https://docs.pi-hole.net/guides/dns-over-https/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347081">

			<div class="comment by-peter-a ">

				<p class="commentcredit">

					<span class="commenter">Peter A.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347081">
						February 25, 2020 10:11 AM					</a>

				</p>

				<p>@Ken: but your local DNS resolver has to go to the root and TLD and SLD and&#8230; all of this is seen by your upstream IP transport provider. Unless all DNS servers in the world implement DNS over TLS, having local resolver does not do much to solve trust issues with your ISP. I agree with you that using public resolver with encrypted traffic (either DoT or DoH) just moves your trust elsewhere.</p>
<p>I also have a local validating resolver (not all devices on my network are smart enough to check for errors) and I really don&#8217;t have an opinion if configuring it to go for data to some public resolver instead of allowing it to query all the way from the top is a better way to go or not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347082">

			<div class="comment by-dr ">

				<p class="commentcredit">

					<span class="commenter">DR</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347082">
						February 25, 2020 10:12 AM					</a>

				</p>

				<p>One side effect of enabling secure DNS in Firefox is that it will bypass the local hosts file.</p>
<p>This is mainly an issue only if you use the local hosts file to weed out advertisers or unwanted sites.</p>
<p>Some references:<br />
<a href="https://stackoverflow.com/questions/37452361/why-is-my-hosts-file-entry-being-ignored-by-the-browser" rel="nofollow ugc">https://stackoverflow.com/questions/37452361/why-is-my-hosts-file-entry-being-ignored-by-the-browser</a><br />
<a href="https://stackoverflow.com/questions/58842319/firefox-not-honoring-hosts-file" rel="nofollow ugc">https://stackoverflow.com/questions/58842319/firefox-not-honoring-hosts-file</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347083">

			<div class="comment by-allan ">

				<p class="commentcredit">

					<span class="commenter">allan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347083">
						February 25, 2020 10:37 AM					</a>

				</p>

				<p>We rely on our enterprise DNS to block sites that may be harmful to our employees.<br />
We would have no control over the DoH server, and futhermore, no visibility to sites our employees vist (including java scripts enbedded within &#8216;legal&#8217; or &#8216;approved&#8217; sites. We disapprove of DoH for these reasons. I really wish there were an enterprise wide method to disable this &#8216;protocol.&#8217;<br />
Sorry, Bruce, I really agree with almost everything you say but must take a stand against this.<br />
Peace</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347084">

			<div class="comment by-ferritecore ">

				<p class="commentcredit">

					<span class="commenter">ferritecore</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347084">
						February 25, 2020 10:43 AM					</a>

				</p>

				<p>DNS over HTTPS, A good idea, more or less. I&#8217;d probably prefer DNS over a secure socket without wrapping it in HTTP, but whatever.</p>
<p>DNS resolution (or anything else) in an application bypassing established system services is as recipe for chaos. Different applications resolve differently?</p>
<p>Push for encrypted DNS in the system service. Then every application will benefit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347085">

			<div class="comment by-frank ">

				<p class="commentcredit">

					<span class="commenter">Frank</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347085">
						February 25, 2020 10:43 AM					</a>

				</p>

				<p>Now using DNS over HTTPS on firefox (outside US!)</p>
<p>&#8220;Today, Firefox began the rollout of encrypted DNS over HTTPS (DoH) by default for US-based users. ..</p>
<p>If youâ€™re outside of the US and would like to enable DoH, youâ€™re welcome to do so by going to Settings, then General, then scroll down to Networking Settings and click the Settings button on the right. Here you can enable DNS over HTTPS by clicking, and a checkbox will appear. By default, this change will send your encrypted DNS requests to Cloudflare.&#8221;<br />
<a href="https://blog.mozilla.org/press-uk/2020/02/25/firefox-continues-push-to-bring-dns-over-https-by-default-for-us-users/" rel="nofollow ugc">https://blog.mozilla.org/press-uk/2020/02/25/firefox-continues-push-to-bring-dns-over-https-by-default-for-us-users/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347086">

			<div class="comment by-www ">

				<p class="commentcredit">

					<span class="commenter">www</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347086">
						February 25, 2020 10:46 AM					</a>

				</p>

				<p>It baffles me how security experts can support the move to DoH. Of course encrypted DNS requests would be great, but is <em>inside the browser</em> really the place for that? The idea is wonderful, but the implementation is not just sub-optimal, but harmful. The effort towards DoH would&#8217;ve been much better spent getting OS&#8217;s to support and default to DoT.</p>
<p>How would DoH affect other areas sorely lacking in DNS security, like IoT? If anything it will make it harder by duplicating effort. Or are we looking to run Firefox on ESP8266&#8217;s now?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347087">

			<div class="comment by-whiten01se ">

				<p class="commentcredit">

					<span class="commenter">WhiteN01se</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347087">
						February 25, 2020 10:48 AM					</a>

				</p>

				<p>What &#8211; if i may &#8211; is the point of having DoH other than to override user&#8217;s DNS settings, potentially without user knowledge and consent?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347088">

			<div class="comment by-dr-blank ">

				<p class="commentcredit">

					<span class="commenter">Dr Blank</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347088">
						February 25, 2020 10:52 AM					</a>

				</p>

				<p>@allan<br />
<i>I really wish there were an enterprise wide method to disable this &#8216;protocol.&#8217;</i></p>
<p>DNS over HTTPS can be disabled using group policy.</p>
<p>You would have to use the group policy templates provided by Mozilla. These templates provide the option &#8220;Configure DNS Over HTTPS&#8221; which can be set to disabled.</p>
<p><a href="https://support.mozilla.org/en-US/kb/customizing-firefox-using-group-policy-windows?redirectlocale=en-US&#038;redirectslug=customizing-firefox-using-group-policy" rel="nofollow ugc">https://support.mozilla.org/en-US/kb/customizing-firefox-using-group-policy-windows?redirectlocale=en-US&#038;redirectslug=customizing-firefox-using-group-policy</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347089">

			<div class="comment by-michael-leake ">

				<p class="commentcredit">

					<span class="commenter">Michael Leake</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347089">
						February 25, 2020 11:22 AM					</a>

				</p>

				<p>I did not know where to put this, the latest &#8216;The Simpsons&#8217; will humorously explain, completely how bitcoin and blockchain work</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347090">

			<div class="comment by-kieran ">

				<p class="commentcredit">

					<span class="commenter">Kieran</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347090">
						February 25, 2020 11:24 AM					</a>

				</p>

				<p>It looks like any using a DNS security product can disable this behaviour by setting up an A record for the canary domain, use-application-dns.net&#8230; but what&#8217;s to stop nosy ISPs (or other attackers) doing that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347091">

			<div class="comment by-michaela-merz ">

				<p class="commentcredit">

					<span class="commenter">Michaela Merz</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347091">
						February 25, 2020 12:04 PM					</a>

				</p>

				<p>DOH is a pretty stupid idea. Name resolution should not be done on application level or we end up with each application deciding for itself which name server to use. It also forwards all of the resolution requests to a single source, with tons of possible bad implications. As the addresses within the data communication are not encrypted, our providers are aware of the data traffic anyway. DOH circumvents organizational settings and it may even ignore the hosts file. The fact the Mozilla enables it by default is IMHO ridiculous. As a security engineer, I am not happy with the (security) state of the classic DNS. But DOH is a step in the wrong direction. It creates more problems than it solves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347092">

			<div class="comment by-realfakenews ">

				<p class="commentcredit">

					<span class="commenter">RealFakeNews</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347092">
						February 25, 2020 12:30 PM					</a>

				</p>

				<p>Inside the browser is entirely the wrong place for this.</p>
<p>Busy now, so I&#8217;ll expand my thoughts later.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347093">

			<div class="comment by-mansour ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.google.com' rel='external nofollow ugc' class='url'>Mansour</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347093">
						February 25, 2020 12:50 PM					</a>

				</p>

				<p>I guess in my 20 years of career in security, this is the first time I disagree with you Bruce ðŸ™‚ I don&#8217;t think this is a good news. Introducing DoH on Firefox yes is a very good news indeed, but Mozilla forcing it for users definitely is not.<br />
DoH is not a silver bullet, but still a very good control. However in the absence of so many DNS providers supporting it, it just empowers privacy-monsters like Google; as they will now have access to a huge resource of DNS queries coming from people who even are not using Google products.<br />
I know Mozilla is enabling DoH for Cloudflare servers, but that&#8217;s not much different.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347094">

			<div class="comment by-vrk ">

				<p class="commentcredit">

					<span class="commenter">VRK</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347094">
						February 25, 2020 1:18 PM					</a>

				</p>

				<p>@Bruce Thanks. for most this just means it will be switched from mode 0 to mode 2, I suspect? Still a fail at times even if the sys and pipe admins are on board.</p>
<p>@WhiteN01se</p>
<blockquote><p>an application may not inform the user if it skips DoH querying</p></blockquote>
<p>Exactly. It seems DOH was neutered in favor of ADMIN forced dns since mozFF 70: no warning. Note: &#8220;network.dns.skipTRR-when-parental-control-enabled&#8221; in about:config, set false. Bizarre pref.</p>
<p>@Curious</p>
<blockquote><p>*somehow* simply relied on IP numbers</p></blockquote>
<p>was my question also, but as Peter [not so generically] said &#8220;just moves your trust elsewhere&#8221;, as I see it: Then you still trust routing. The upshot: BEATING FAKE is having a neck you can choke when you hand your 10Â¢ to the ferryman: marry a farmer, getOffTheGrid()</p>
<p>@allan your REGIME model has failed for anyone who&#8230; everyone.</p>
<p>@Dr Blank the post is oddly undated. I think firefox 70 caters to those having &#8220;parental issues&#8221;.</p>
<p>@Michaela</p>
<p>Agreed DNS is in a bad state, but the DOH patch seems&#8230; like a rung up the ladder for now. Truely HTTPS itself is broken without trusted dns. TORproject is a pretty successful patch too, but why are we kicking against the pricks like this? Loyalist saber rattling. Byte them, not the IETF.</p>
<blockquote><p>&#8220;forwards all of the resolution requests to a single source, with tons of possible bad implications.&#8221;</p></blockquote>
<p>Unless the network admin is a known &#8220;sympathizer&#8221; who fears ROI and SAM more than&#8230; selling you for beer money.</p>
<blockquote><p>&#8220;addresses within the data communication are not encrypted, our providers are aware of the data traffic anyway&#8221;</p></blockquote>
<p>It is odd that esni isn&#8217;t enabled when Mozilla, for example, goes to DOH mode 2 etc. But then neither DOH NOR ESNI are fully supported.</p>
<p>@all<br />
I think it was the IETF that said</p>
<p>&lt;</p>
<p>blockquote&gt;&#8221;A client MUST NOT trust a DNS API server simply because it was discovered, or because the client was told to trust the DNS API server by an untrusted party.&#8221;&lt;?blockquote&gt;</p>
<p>whats a mother to do? I wear a swimsuit at the beach, and a door is on my bathroom too. Dang, what crime MUST I be hiding? EOF</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347095">

			<div class="comment by-dr-flay ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://about.me/dr.flay' rel='external nofollow ugc' class='url'>Dr.Flay</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347095">
						February 25, 2020 1:24 PM					</a>

				</p>

				<p>OK. So many people missing important points here.</p>
<p>1) Mozilla are not taking choice away. First you have the choice to switch it off, and next you have the choice to use your preferred DNS in the config if they provide DoH.</p>
<p>2) This is a temporary fix until the OS vendors have implemented their own replacements.<br />
(even when they do I will continue using DNSCrypt).<br />
As pointed out this is not something that individual programs should be doing or it will become its own security risk.<br />
Microsoft have already started on their version.</p>
<p>3) HOSTS files will work with OS level DoH (when we get it).</p>
<p>4) DoH/DoT etc. are only a partial fix.<br />
Currently no software has any way to show you DNSSec success, errors or failures since Firefox and Chrome dropped support that allowed extensions to show this. Even with an encrypted DNS you have no feedback or indication to show if there is a man-in-the-middle<br />
Is your DNS using the expected key ? and same for the DNS of the site you are visiting ?<br />
We have no indication that certs and IPs do not match.<br />
Browsers try to warn about certs not matching the domain, but when the domain is correct but the IP is not, they could care less.<br />
Encrypted is nice, but encrypted to the correct places is better.</p>
<p>5) For those that want OS, router or pihole level encrypted DNS with HOSTS blocking now, that has been available since DNSCrypt was available. It used to be DoT and/or DNSCrypt, but they added DoH a while back.<br />
Its HOSTS handling is more flexible and powerful than standard OS implementation, allowing for forwarding and cloaking rules.<br />
You can find cloudflare and quad9  in the DNSCrypt resolver list.<br />
It can use as many DNS as you like and will opt for the fastest responding.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347096">

			<div class="comment by-www ">

				<p class="commentcredit">

					<span class="commenter">www</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347096">
						February 25, 2020 2:12 PM					</a>

				</p>

				<p>@Dr.Flay: I think you&#8217;ll find that we&#8217;re not so much missing the points, as judging the damage done as (much) more than the gain.</p>
<ol>
<li>As all of infosec knows: defaults matter. A lot. DoH is a bad choice, and worse as a default.</li>
<li>That does not excuse a &#8220;fix&#8221; in the wrong place, especially when it has this kind of detrimental effects. If anything the rollout of DoH will increase friction to adopting (proper) OS-level solutions. &#8220;But our DNS is already encrypted with DoH! <em>derp</em>&#8220;</li>
<li>Irrelevant, because we don&#8217;t have that (yet).</li>
<li>That&#8217;s an easily solvable logistics issue (not a technical problem) and no different with DoH.</li>
<li>Same as 2.</li>
</ol>
<p>Nothing you&#8217;ve said vindicates DoH in the least.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347097">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">me</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347097">
						February 25, 2020 2:35 PM					</a>

				</p>

				<p>@ALL<br />
You are bassically complaining about &#8220;man in the middle attack stop working this is bad meh&#8221;</p>
<p>Well you are all wrong, doh enforce the dns that you chosed, and you are the only one who should chose your dns, bot your isp or anyone else<br />
-doh bypass my pihole? set your doh to pihole<br />
-doh bypass enterprise blocklist? if you rely on mitm attack over dns to implement it you are doing it wrong.<br />
-doh bypass my hosts file? Get a firewall, pointing domain to 127.0.0.1 is not the proper way to block internet communication, a firewall is.<br />
That app might use hardcoded ip and bypass your hosts file and pihole EVEN WITHOUT DOH so if your problem is blocking get a firewall! And stop complaining about doh</p>
<p>Tl;dr: pointing domain to localhost is not good to blocking comm. Direct ip connection exist get a firewall, doh is not the problem, you are the problem, you are doing it wrong</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347098">

			<div class="comment by-jesse-thompson ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.lightsecond.com' rel='external nofollow ugc' class='url'>Jesse Thompson</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347098">
						February 25, 2020 2:43 PM					</a>

				</p>

				<p>Look, I&#8217;ve got the solution to <em>every</em> problem mentioned here.</p>
<p>Neither DoH nor DoT protect user from ISP seeing HTTPS host fields? Over-sold promises to dissidents could put them in hot water with hostile governments?</p>
<p>Easy, I&#8217;ll just start a virtual-desktop service and then <em>absolutely all</em> of your online activity can be encrypted! Bruce ought to love that, right? Perfect security. ðŸ˜€</p>
<p>You&#8217;re worried about communicating or collaborating with person X but you need end-to-end encryption with them? Easy, when your virtual desktop makes network connections to their virtual desktop, we bridge your connection in the middle and no packet on the wire will ever not be encrypted. And encrypted === security, right?</p>
<p>Worried about criminals going dark? That&#8217;s no problem, our virtual desktop service collaborates with Law Enforcement to support legal investigations into whatever it is they&#8217;re after, all to keep you safe.</p>
<p>Concerned about moving the processing to the cloud reducing available features? Never fear, our software will maintain 24/7 control over your local hardware resources such as microphone, camera, smartcard reader, USB ports, etc so that all of your favorite services will always be right at your fingertips via our virtual desktop interface.</p>
<p>Uncertain about &#8220;moving trust elsewhere&#8221;? Well never fear, our solution was explicitly designed to move <em>all</em> trust in the system directly to <strong>me!</strong> and if you can&#8217;t trust me personally, then who <em>can</em> you trust with 100% of your digital activity and sensing devices, amirite? ðŸ˜€</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347099">

			<div class="comment by-think-of-the-children ">

				<p class="commentcredit">

					<span class="commenter">Think of the CHILDREN!</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347099">
						February 25, 2020 2:59 PM					</a>

				</p>

				<p>So let me get this straight&#8230; if you&#8217;re pro-privacy, you&#8217;re an &#8220;internet villain&#8221; because we can&#8217;t spy on every single thing every single person  worldwide does on the internet, to find child pornography (&#8220;think of the children&#8221; argument) or terrorists (oh, the old &#8220;you must be terrified&#8221; argument)&#8230;</p>
<p>By this argument, manufacturers of clothing should also be branded &#8220;villains&#8221; because they allow people to conceal weapons (i.e. think of the children, and the terrorists).  Everyone should be forced to walk around naked to make sure they&#8217;re not going to blow everyone&#8217;s heads off&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347100">

			<div class="comment by-secure-by-default ">

				<p class="commentcredit">

					<span class="commenter">Secure BY DEFAULT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347100">
						February 25, 2020 3:15 PM					</a>

				</p>

				<p>If you&#8217;re used to relying on breaking security/privacy to implement some sort of needed feature&#8230; and you find that this new world we&#8217;re headed towards where everything is secure/private by default is breaking your feature, then you&#8217;re really living in the past.  The people have spoken.  They want control over their own devices.  They want security by default.  They don&#8217;t want to be spied upon constantly, they wish to have privacy.  Of course, on the flip side, they&#8217;ve also spoken: as long as it doesn&#8217;t cost more.  Most people will not pay one iota extra for security or privacy&#8230; but all things being equal (especially cost, usability, etc), they&#8217;ll prefer security and privacy.  If you can&#8217;t handle this brave new world, maybe you need to consider changing your world view.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347101">

			<div class="comment by-www ">

				<p class="commentcredit">

					<span class="commenter">www</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347101">
						February 25, 2020 3:25 PM					</a>

				</p>

				<p>@Secure BY DEFAULT: We want the same things, but we disagree on how to get it.</p>
<p>This is less a case of &#8220;the people have spoken&#8221; and more &#8220;Mozilla has decided.&#8221; As one of the few options not actively hostile against user privacy, Mozilla&#8217;s decisions are a big deal.</p>
<p>DoH &#8220;frees&#8221; people from having their devices controlled by one set of adversaries by handing that control over to another.</p>
<p>You&#8217;re right about cost, of course. But DoH isn&#8217;t a cost issue, it&#8217;s a technical direction issue. We can achieve the same/greater security and privacy by driving OS-level DoT/DNSCrypt adoption rather than DoH.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347102">

			<div class="comment by-homer-simpson ">

				<p class="commentcredit">

					<span class="commenter">Homer Simpson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347102">
						February 25, 2020 3:50 PM					</a>

				</p>

				<blockquote><p>
  I did not know where to put this, the latest<br />
  &#8216;The Simpsons&#8217; will humorously explain, completely<br />
  how bitcoin and blockchain work
</p></blockquote>
<p>D&#8217;oh!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347103">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">TatÃ¼tata</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347103">
						February 25, 2020 4:42 PM					</a>

				</p>

				<p>Can someone tell me how local domains are supposed to be resolved using DoH? If I need to access a router, a printer, an access point, or any another machine in the 192.168.xxx.xxx or 10&#8230; ranges , how will the DNS exchange look like?</p>
<p>Now I have domain resolution by the router, and configuring local addresses is something of a PITA with the DNSMasq implementation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347105">

			<div class="comment by-back-to-ie6 ">

				<p class="commentcredit">

					<span class="commenter">Back to IE6</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347105">
						February 25, 2020 8:49 PM					</a>

				</p>

				<blockquote>
<blockquote>
<blockquote><p>
      Sorry, Bruce, I really agree with almost everything you say but must take a stand against this. Peace.
    </p></blockquote>
</blockquote>
</blockquote>
<p>Quoted for truth.</p>
<p>I understand if @Bruce is looking at this from a larger, societal / public-use perspective -and sure, I get that from a Herd Immunity angle or as a global policy, this might be <em>on balance</em>  beneficial to society &#8211; but a lot of us readers are enterprise admins, particularly in the USA, and DoH is absolutely terrible for us trying to protect our networks and dumb users from themselves / securing our employers or customers organizations via DNS filtering.</p>
<p>I prefer NOT to break TLS/HTTPS with certificate injection / inspection wherever possible. So I&#8217;d rather do filtering at the DNS level combined with a high quality AV/EDR (and email spam filtering, etc). This DoH change breaks half of my regular network security stack.</p>
<p>I run my own DNS servers that have TLS protection between my on-prem DNS servers and their upstream DNS providers. I do that for two reasons: to protect my public facing DNS queries from snooping, and/while to be able to filter my client-to-server DNS queries. Anything that by default circumvents my enterprise-provided DNS settings and protections is bad&#8230; No two ways about that.</p>
<p>Firefox just got uninstalled from 100k+ endpoints. Sorry users&#8230; but you just cant be trusted to not watch Japanese scat porn on the conference room projector while not downloading Russian malware torrents on company time.</p>
<p>/shrug</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347106">

			<div class="comment by-rachel ">

				<p class="commentcredit">

					<span class="commenter">Rachel</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347106">
						February 25, 2020 9:08 PM					</a>

				</p>

				<p>It&#8217;s worth remembering, Mozilla has countless holes in their &#8216;we respect privacy&#8217; facade.   about:config is riddled with corporation telemetry. They phone home and everyone else every which way but loose</p>
<p>as Clive Robinson noted recently Firefox code is now complex and bloated beyond the point of no return.  The capacity of Firefox to browse websites should be considered a side effect</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347107">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347107">
						February 25, 2020 10:05 PM					</a>

				</p>

				<p>D&#8217;oh! is a really dumb idea that&#8217;s being forced down our throats by a couple of geeks at Mozilla and Google who have run out of other ideas on what to tweak next.  Firstly, it does nothing because the very next network operation after a DNS request is to go to the site that you did the DNS query for.  Secondly, I decide where my DNS goes, and that&#8217;s to my local ISP, who couldn&#8217;t care less where I go, not to Google or similar who really, really want to know where my DNS queries go.  In addition since I&#8217;m running a PiHole I want my DNS queries to be run over DNS, not over D&#8217;oh!, so that I can filter out all the bad sites.</p>
<p>So in summary it has a whole shopping list of really serious things wrong with it, while providing no benefit to me whatsoever.  It&#8217;s security geeks saying y&#8217;all watch this, nothing more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347108">

			<div class="comment by-name-withheld-for-obvious-reasons ">

				<p class="commentcredit">

					<span class="commenter">name.withheld.for.obvious.reasons</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347108">
						February 26, 2020 12:03 AM					</a>

				</p>

				<p>@ TatÃ¼tata</p>
<blockquote><p>Can someone tell me how local domains are supposed to be resolved using DoH?&gt;</p></blockquote>
<p>Currently I understand that the resolver within Mozilla&#8217;s Firefox is the caller to the hosted service. Other applications would have to hook the API to utilize, though Microsoft is planning a DOH which should really be DNS over TLS (DOT). The plan by Microsoft would have the DNS resolver for the OS would be DOH compatible.</p>
<p>From what I understand there is a fallback query logic that goes from the highest level access down to lower levels. Not sure how the localhost or local resolver in a resolv.conf stanza might behave at this point. I would assume a similar behavior where the local host file will be the first interrogation the local DNS database, and then any externally enumerated servers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347109">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347109">
						February 26, 2020 12:15 AM					</a>

				</p>

				<p>I read nearly all the comments and they missed this: there are ransomware using DoH. So, unless you add every DoH provider to your HOSTS file (blocking them,) you have a potential security issue at hand. Since DoH makes all IOCs IPs irrelevant; you cannot see them anymore.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347110">

			<div class="comment by-drone ">

				<p class="commentcredit">

					<span class="commenter">Drone</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347110">
						February 26, 2020 1:49 AM					</a>

				</p>

				<p>Mozilla Speaks &#8211; Addresses concerns about DoH in new Blog post:</p>
<p>&#8220;The Facts: Mozillaâ€™s DNS over HTTPs (DoH), Mozilla February 25, 2020&#8221;</p>
<p><a href="https://blog.mozilla.org/netpolicy/2020/02/25/the-facts-mozillas-dns-over-https-doh/" rel="nofollow ugc">https://blog.mozilla.org/netpolicy/2020/02/25/the-facts-mozillas-dns-over-https-doh/</a></p>
<p>My first take on DoH in Firefox (FF)&#8230;</p>
<ul>
<li>
<p>Look, DoH is better than nothing, which is what we have today and except for DoH the foreseeable future. Mozilla has put two years into live testing DoH in FF and it&#8217;s ready now.</p>
</li>
<li>
<p>Schemes better than DoH are taking forever to emerge and all of them seem to be more difficult to deploy.</p>
</li>
<li>
<p>If something better than DoH comes along, no problem. You just gradually dual feed and transfer over to it. No big deal. In the meantime we still have DoH, which in many/most cases is better than nothing.</p>
</li>
<li>
<p>If you don&#8217;t like/want DoH in FF, just turn it off, it&#8217;s reportedly as simple as flipping a switch. Voila, FF is back to the way it was before.</p>
</li>
<li>
<p>If deploying DoH pisses off Governments, Standards Bodies, Regulatory Agencies, ISP&#8217;s, Software/Hardware Corporations etcetera who all think they have a better idea &#8211; then GOOD. Maybe they&#8217;ll get off their collective arses and do something for a change. Nothing else is getting done today and DNS is still hanging out there in the naked.</p>
</li>
<li>
<p>Enterprises easily have full control over the computers they own and that their employees use at work. If a company doesn&#8217;t want DoH no problem, just flip the switch in FF. The Sysadmin locks down the User account, sets up Firefox how he/she wants, and sets the Firefox Master Password. Poof, DoH is gone. Or the Sysadmin can setup DoH in FF different from the default and still use it.</p>
</li>
<li>
<p>There are only two DoH capable DNS resolver systms for Firefox, Cloudflare and NextDNS. Yeah, I don&#8217;t like this either, but you gotta start somewhere. The number of servers will grow as DoH for FF does (if it does), and reputations will be earned over time. If you don&#8217;t feel safe as an early DoH adopter, just turn it off for now.</p>
</li>
<li>
<p>Mozilla seems to have put some thought into accommodating stuff like parental controls etc. Time will tell. For example Mozilla is not deploying DoH in the UK yet until concerns in that market are addressed.</p>
</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347111">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347111">
						February 26, 2020 1:54 AM					</a>

				</p>

				<p>@www: It baffles me how security experts can support the move to DoH.</p>
<p>From an informal survey, the majority of security people I&#8217;ve talked to recognise it for what it is, a really dumb idea.  As Paul Vixie (I think) put it, the only people who think D&#8217;oh is a good idea are people who don&#8217;t understand DNS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347112">

			<div class="comment by-phaete ">

				<p class="commentcredit">

					<span class="commenter">Phaete</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347112">
						February 26, 2020 2:01 AM					</a>

				</p>

				<p>So it is on by default (non UK), and now they have chosen now where to send your surfing data if you just update your browser.<br />
Money grabbing in the disguise of security delivered by bloatware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347113">

			<div class="comment by-drone ">

				<p class="commentcredit">

					<span class="commenter">Drone</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347113">
						February 26, 2020 2:23 AM					</a>

				</p>

				<p>So it seems DoH has its own Twitter account(?) Looks like it. Active, some interesting stuff. I dunno &#8211; I am NOT a Twitterer. Worth a look anyway&#8230;</p>
<p>#DoH</p>
<p><a href="https://twitter.com/hashtag/DoH?src=hash&#038;ref_src=twsrc%5Etfw" rel="nofollow ugc">https://twitter.com/hashtag/DoH?src=hash&#038;ref_src=twsrc%5Etfw</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347114">

			<div class="comment by-drone ">

				<p class="commentcredit">

					<span class="commenter">Drone</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347114">
						February 26, 2020 2:35 AM					</a>

				</p>

				<p>Whoa there parner, Re: my previous comment on the #DoH Twitter account (I always forget to cut the URL tracker trails). Use this instead:</p>
<p><a href="https://twitter.com/hashtag/DoH" rel="nofollow ugc">https://twitter.com/hashtag/DoH</a></p>
<p>Soooo&#8230; Is this the Twitter account for the Department of Health (DoH) somewhere? Never-mind, there is still a bunch of recent DNS-over-HTTPS posts there. Yeah, Twitter &#8211; what a mess (laughing while typing this).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347115">

			<div class="comment by-not_a_robot ">

				<p class="commentcredit">

					<span class="commenter">Not_A_Robot</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347115">
						February 26, 2020 2:42 AM					</a>

				</p>

				<p>DoH can mess up some things with DNS, that&#8217;s for sure. That&#8217;s one of the reasons why I have 4 browsers on my PC at work. Standard Chrome, DoH enabled Firefox in anonymous mode, Epic browser for easy access to proxy servers and Tor Browser just for fun.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347116">

			<div class="comment by-nsa-disinformation ">

				<p class="commentcredit">

					<span class="commenter">nsa disinformation</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347116">
						February 26, 2020 4:35 AM					</a>

				</p>

				<p>seems that is full of anti-encryption comments, with no sense arguments like &#8220;omg my corporate dns filtering doesn&#8217;t work anymore&#8221;.<br />
well if you rely on dns filtering to prevent people accessing websites you are doing it wrong:<br />
1-people could change their dns and stop using the corporate one<br />
2-people can use direct ip and don&#8217;t use dns at all<br />
3-people can use google translate<br />
4-people can use so many tunneling ways that even china firewall can&#8217;t keep up</p>
<p>so stop blaming doh for your incompetence, if you want to filter websites you block them by ip with firewall, not by dns.</p>
<p>another no sense thing is &#8220;mozilla decide what is my dns&#8221; nope, you decide!<br />
want to use doh? chose between providers that support it: cloudflare, google, &#8230;<br />
don&#8217;t want to use it? turn it off.</p>
<p>i&#8217;m using system wide doh with dnscryptproxy.</p>
<p>and not only! i&#8217;m going to turn it on NETWORK WIDE from the router as soon as the fritzbox update is published!!!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347117">

			<div class="comment by-spellucci ">

				<p class="commentcredit">

					<span class="commenter">Spellucci</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347117">
						February 26, 2020 6:23 AM					</a>

				</p>

				<p>Amusingly, it appears TechCrunch&#8217;s security certificate has expired, and my browsers block me from seeing the article.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347118">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347118">
						February 26, 2020 1:42 PM					</a>

				</p>

				<p>@ nsa disinformation</p>
<p>I agree with your comments.  Filter at the firewall level not the naming service level (alternatively you can write down on a paper sheet the IP addresses of those &#8220;filtered&#8221; servers you want access to before going to work).</p>
<p>In any case, if a corporation is against DNS-over-HTTPS they can set up their own recursive name servers and block any access to port 53 on servers not controlled by the IT staff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347119">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347119">
						February 26, 2020 1:52 PM					</a>

				</p>

				<p>I would like to run a sort of &#8220;poll&#8221; in this forum, as the best security experts are here and will provide accurate feedback.  Ok, not really a poll, I just want your knowledgeable opinion.</p>
<p>What it your choice for a naming service?  I am talking about standard name resolution, the one done at the operating system level.</p>
<ol>
<li>OpenDNS? (208.67.222.222, 208.67.220.220, and 208.67.222.220)
</li>
<li>Cloudflare? (1.1.1.1, and 1.0.0.1)
</li>
<li>Running your own local recursive name server connected directly to the root servers?
</li>
<li>Other choice?
</li>
</ol>
<p>I am not sure OpenDNS, now owned by Cisco, and Cloudflare are so privacy-aware as they say.  Even Google says they care about our privacy (&#8230;or lack of).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347120">

			<div class="comment by-john-l ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://jl.ly' rel='external nofollow ugc' class='url'>John L</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347120">
						February 26, 2020 2:19 PM					</a>

				</p>

				<p>Firefox&#8217;s version of DoH sends your DNS query stream to Cloudflare. Is there any reason to trust them more than the people who run your network with whom you have a business relationship? Not that I can see.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347121">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347121">
						February 26, 2020 2:22 PM					</a>

				</p>

				<p>@ Who?</p>
<p>Options 1&amp;2 have proved themselves untrustworthy, either to corporate or Gov IC intetests (which are about the same these days)&#8230;</p>
<p>Whilst there are some strange things you could do for option 4, The hassle of option 3 might be less because it&#8217;s a more troden path&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347122">

			<div class="comment by-michael ">

				<p class="commentcredit">

					<span class="commenter">Michael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347122">
						February 26, 2020 2:50 PM					</a>

				</p>

				<p>Everybody is so quick to blame Mozilla, but realistically, the whole industry is to blame. We&#8217;ve been dragging our feet for DECADES on implementing secure DNS. It&#8217;s one of the last major gaping holes on the internet and we&#8217;re long overdue for securing DNS. Mozilla&#8217;s strategy is aggressive because it needs to be; if they kept it off by default, the industry could continue to drag their feet on implementing and deploying secure DNS.</p>
<p>Google has employed similar strategies with their search engine and Chrome web browser and to great effect. If you don&#8217;t pressure companies into upgrading security, they probably never will. If not for the efforts of Google, Mozilla, EFF, and others, the majority of websites on the internet would likely still be unsecured.</p>
<p>So rather than complaining that Firefox is ruining your enterprise structure, embrace it, appreciate that this is going to greatly improve security and privacy for everybody, and learn how to adapt.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347123">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347123">
						February 26, 2020 3:47 PM					</a>

				</p>

				<p>@ Clive Robinson.</p>
<p>Clear enough, thanks!</p>
<p>I agree with you.  Both Cisco and Cloudflare are north-american companies that may have been targeted with NSLs, not to say the entire networking industry has bugs (I would say full backdoors in most cases) ranging from accounts and passwords hardcoded in production operating system releases to really odd bugs that can be exploited by means of tools like EXTRABACON and EPICBANANA making them look untrustworthy.</p>
<p>As you I think option 3 is a good compromise between public naming services and in-house solutions&mdash;I have been doing it for years.  Obviously much better than a fully populated multi-gigabyte <i>/etc/hosts</i> file (option 4).  Not really private, but we are talking about name resolution at the operating system level and logs are in our hands.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347124">

			<div class="comment by-uhh-dude ">

				<p class="commentcredit">

					<span class="commenter">Uhh, dude ...</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347124">
						February 26, 2020 4:03 PM					</a>

				</p>

				<blockquote><p>&#8230; even some in the security community are split, amid warnings that it could make incident response and malware detection more difficult.</p></blockquote>
<p>Dude, the ladies in the back office are splitting their legs and pressing rape charges over your web browsing history.</p>
<p>The &#8220;incident response&#8221; which they require is generally referred to &#8220;in the biz&#8221; as <b><a href="https://en.wikipedia.org/wiki/Swatting" rel="nofollow ugc">SWATting</a></b>.</p>
<p>Malware detection? Anything capable of connecting to SSH, database or other &#8220;management&#8221; ports is malware. Period. Overly solicitous parents and tech-illiterate MBAs with undergrad college majors in psychology. Extremely conservative religious patriots (Mormons) at the NSA data center in Utah (Bumblehive etc.) looking over your shoulder as you surf the Internet&#8230; Oh, yeah, don&#8217;t tell anyone but they have banks in S.L.C., real banks. Why do you keep losing your identity at those online banking sites? Maybe you need psychiatric help <a href="https://www.identitytheft.gov/" rel="nofollow ugc">https://www.identitytheft.gov/</a> to make a recovery plan &mdash; the government has diagnosed you with dissociative identity disorder and deemed you to be suicidal and ineligible to possess firearms for the rest of your life because you looked up poisonous death cap mushrooms online. Or maybe you&#8217;re a serial killer who shouldn&#8217;t have a gun because of what you were looking up on the web.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347125">

			<div class="comment by-dr-oink ">

				<p class="commentcredit">

					<span class="commenter">Dr. Oink</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347125">
						February 26, 2020 4:52 PM					</a>

				</p>

				<p>If the desire is to keep ISP (i.e. gov&#8217;t or what-now) from tracking your web surfing then some kind of VPN service might be a better approach</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347126">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347126">
						February 26, 2020 5:28 PM					</a>

				</p>

				<p>@John L: Firefox&#8217;s version of DoH sends your DNS query stream to Cloudflare. Is there any reason to trust them more than the people who run your network with whom you have a business relationship? Not that I can see.</p>
<p>I trust Cloudflare, under the jurisdiction of the Committee for State Security&#8230; sorry, Department of Homeland Security, not to mention fairly probable penetration by the NSA, MSS, Unit 8200, FSB, and everyone else, infinitely less than I trust my local ISP, who is a very long way from US jurisdiction, and in a country with strong privacy protection laws.  In fact I trust every D&#8217;oH provider I know of vastly less than my local ISP.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347127">

			<div class="comment by-uhh-dude ">

				<p class="commentcredit">

					<span class="commenter">Uhh, dude ...</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347127">
						February 26, 2020 9:46 PM					</a>

				</p>

				<p>@Dave</p>
<blockquote><p> I trust my local ISP,</p></blockquote>
<p>Good fellows, aren&#8217;t they? They probably eat lunch with you at the telco employees union hall. Or else there&#8217;s a pub down the street serves German food and beer, and they&#8217;re always having a &#8220;hackathon&#8221; or something like that.</p>
<p>It was a quintillion-dollar scam, but that&#8217;s only a billion dollars to Mike Bloomberg, because those union benefits never really did translate to real cash take-home pay.</p>
<p><a href="https://www.bloomberg.com/news/features/2019-10-08/quintillion-ceo-s-promise-to-wire-the-arctic-was-1-billion-scam" rel="nofollow ugc">https://www.bloomberg.com/news/features/2019-10-08/quintillion-ceo-s-promise-to-wire-the-arctic-was-1-billion-scam</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347128">

			<div class="comment by-myliit ">

				<p class="commentcredit">

					<span class="commenter">myliit</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347128">
						February 26, 2020 11:33 PM					</a>

				</p>

				<p>@Dave</p>
<p>Why would you trust your local ISP?  I think they are, in general, trying to play catch up in the Surveillance Capitalism game.</p>
<p>How about DNScrypt?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347129">

			<div class="comment by-someone ">

				<p class="commentcredit">

					<span class="commenter">Someone</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347129">
						February 27, 2020 6:20 AM					</a>

				</p>

				<p>Well, DoH is as bright as MPLS over HTTP, or Electricity over IP: <a href="https://tools.ietf.org/html/rfc3251" rel="nofollow ugc">https://tools.ietf.org/html/rfc3251</a></p>
<p>Use DoT in the OS&#8217;s resolver, problem solved. No need to have N applications implement their own resolvers, for their own suspicious reasons.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347130">

			<div class="comment by-who ">

				<p class="commentcredit">

					<span class="commenter">Who?</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347130">
						February 27, 2020 7:02 AM					</a>

				</p>

				<p>good <a href="https://www.opennic.org/" rel="nofollow ugc">https://www.opennic.org/</a><br />
bad OpenDNS Cloudflare Google your isp DNS</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347131">

			<div class="comment by-notaname ">

				<p class="commentcredit">

					<span class="commenter">NotAName</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347131">
						February 27, 2020 4:18 PM					</a>

				</p>

				<p>I think that DOH does solve an important problem, but I wish that the solution was not just &#8220;ask authority &#8216;Cloudflare&#8217;.&#8221;</p>
<p>The original idea of having multiple, reasonably independent root name servers is an excellent one, and DOH would have benefited from a similar structure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347132">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347132">
						February 28, 2020 12:48 PM					</a>

				</p>

				<p>The wikipedia page implies to me that the data that is encrypted is also available in a non-encrypted portion of a request.</p>
<p>How is that any kind of step forward?</p>
<p>It seems to me that if you want to say this is a good idea, it might be nice to list the benefits of the change.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347133">

			<div class="comment by-randy ">

				<p class="commentcredit">

					<span class="commenter">Randy</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347133">
						February 28, 2020 2:49 PM					</a>

				</p>

				<p>I&#8217;m baffled that Bruce says he loves it, but just about everyone else says that it&#8217;s either ineffective or a bad idea.</p>
<p>What gives?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347134">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347134">
						February 28, 2020 9:17 PM					</a>

				</p>

				<p>@ Rabdy,</p>
<blockquote><p>What gives?</p></blockquote>
<p>Two things,</p>
<p>1, Threat model.<br />
2, Implementation.</p>
<p>All encrypting DNS requests does at the base level is &#8220;hide&#8221; the data from &#8220;third parties in transit&#8221;. It does not hide it from the DNS server or it&#8217;s operator.</p>
<p>So the threat model has a Shannon channel for communications and three parties,</p>
<p>1, Channel originator (client).<br />
2, Channel terminator (server).<br />
3, Channel observer (evesdroper).</p>
<p>In theory DNS over HTTPS does not hide the &#8220;fact&#8221; of the request transmission, &#8220;when&#8221; or &#8220;length&#8221; of the request from a &#8220;third party&#8221; evesdropper only the request &#8220;contents&#8221;. So the typical leaks meta-data hides data that has several known issues.</p>
<p>The problem is who is the bigger threat to the &#8220;first party&#8221; client&#8230; The &#8220;second party&#8221; server, or &#8220;third party&#8221; evesdropper?</p>
<p>In practice the first &#8220;upstream&#8221; &#8220;third party&#8221; knows most about you, that is your Internet Service Provider (ISP) because,</p>
<p>1, You pay them non anonymously.<br />
2, They see all your traffic.</p>
<p>Untill recently this was not seen as a problem. However large US ISP&#8217;s appart from buying legislation to drive out small ISPs or ban other ISP suppliers, have started &#8220;double tapping&#8221; by not only charging over the odds service rates to customers for restricted service, but then also selling the customers details to who ever will give them money, no matter of how much &#8220;ill repute&#8221; the purchaser might be (they just charge more).</p>
<p>Thus DNS over HTTPS would kill off some but by no means all of this &#8220;ISP Douple tap&#8221;. Which some people see as good, I don&#8217;t happen to because it&#8217;s &#8220;A sticking plaster on a broken bone&#8221; problem. That is, it is fixing one of the symptoms of the problem not the actual problem it&#8217;s self.</p>
<p>This is because,</p>
<p>1, It does not stop third party observation of traffic.<br />
2, It does not fix the second party issue.</p>
<p>That is whilst DNS over HTTPS might hide the request contents it does not hide the request or the time it happened at, nore does it hide the traffic to the site the DNS request was for. So with a little traffic analysis a state analysis of the client can be easily reconstructed. Some might argue that the use of a Virtual Private Network (VPN) would hide the &#8220;site traffic&#8221; to which I would respond no, it just shifts the problem of an evesdropping third party upstream, it does not solve it.</p>
<p>But this still leves the second party problem, and here is where the big issue arises.</p>
<p>Whilst most ISP&#8217;s have their own DNS servers which is seen rightly as a problem, the ISP especially a small one does not have enough traffic to become a fully fledged &#8220;data aggregator&#8221; which is why it was not seen as much of an issue untill AT&amp;T started double tapping. However Google, Cloudflare and similar are not just big enough to be data aggregators, some are the most pernicious at being so and are very definitely &#8220;evil&#8221;.</p>
<p>Which is where we come on to the second issue of &#8220;implementation&#8221;. When you look around who provides DNS over HTTPS &#8220;servers&#8221; there are very very few and guess what they are Google, Cloudflare and others of the &#8220;evil&#8221; &#8220;data aggregator&#8221; species.</p>
<p>Thus if you use DNS over HTTPS you know fairly well that you are handing over yet more &#8220;private&#8221; information to the &#8220;evil&#8221; &#8220;data aggregators&#8221; that they did not get in the past&#8230;</p>
<p>From this point alone &#8220;DNS over HTTPS&#8221; is a very very bad idea. Though it&#8217;s defenders will argue that &#8220;with time others will set up servers&#8221;. Personally I don&#8217;t think they will, becaus whilst there were once sound technical reasons why an ISP had to run a DNS server as well as other servers for DHCP and NTP Email etc, those reasons in the main don&#8217;t exist any more and especially not for DNS over HTTPS.</p>
<p>But it gets worse&#8230; the proper place for domain name to IP address translation is in you Operating System (OS) where it can be shared by all applications, and propper policies can be set etc, not in any application it&#8217;s self especially one that tries very hard to make it near impossible for the average user to set up correctly at the best of times.</p>
<p>But due to who gives money to the application software developers you start quickly to realize that DNS over HTTPS is a &#8220;con game&#8221; by certain of the &#8220;evil&#8221; &#8220;data aggregators&#8221;.</p>
<p>Thus there is one thing you can almost definitely guarenty, getting this application to stop using DNS over HTTPS will become a task that even Hercules would find taxing, secondly on every update the flags and other changes you make to stop it will not just get reset they will be renamed or changed, to stop script developers and the like.</p>
<p>It&#8217;s also fairly likely that the DNS over HTTPS will get changed frequently in little annoying ways. Not a problem for &#8220;evil&#8221; &#8220;data aggregators&#8221; as they will be driving the changes, and not a problem for the application developers because they will effectively in on the con one way or another. But other potential DNS over HTTPS service suppliers, they will effectively be frozen out of the changes untill the last moment making their task of staying current and not having things break very difficult.</p>
<p>But there is one further asspect to consider, that is the FCC and their current incumbrant who is &#8220;on loan&#8221; from the major telcos. He knows he&#8217;s going to be out on his ear at some point, thus he&#8217;s subject to all the &#8220;nest feathering&#8221; activities that political appointies get upto. He will no doubt arrange for it that the likes of DNS over HTTPS can be considered &#8220;non essential&#8221; thus something an ISP either does not have to alow or can downgrade to the point it&#8217;s effectively usless. Why because that will not stop the &#8220;evil&#8221; &#8220;data aggregators&#8221; but it will force them to negotiate with the big Telco ISPs to give DNS over HTTPS to their servers usable bandwidth etc. Thus it will force out all other DNS of HTTPS service providers.</p>
<p>But this nasty little con that DNS over HTTPS is, has a secondary purpose. It stops any solution to the second party problem.</p>
<p>It is entirely possible to come up with a replacment for DNS where any request from a client can be &#8220;annonymous&#8221; thus killing the second party theft of private data dead in it&#8217;s tracks.</p>
<p>We realy should be pushing for such a protocol not DNS over HTTPS. The &#8220;evil&#8221; &#8220;data aggregators&#8221; by pushing the application developer to put DNS over HTTPS in the application where it most certainly does not belong, preempts and thus prevents a better protocol that makes client requests to the second party server anonymous&#8230;</p>
<p>But consider this, because the HTTPS protocol is in effect open to all traffic types, how do you know that what you think is just a DNS request is not some kind of telemetry or password collecting system? Wr know as certain fact because they were caught at it that both Google and Facebook were collecting and storing away plaintext passwords. Such power is like a drug, and few drug users don&#8217;t have &#8220;addictive personalities&#8221; thus they will almost certainly &#8220;revert to type&#8221; to get their power fix&#8230;</p>
<p>So my advice is refuse to be seduced by the faux romantic patois that surrounds DNS over HTTPS, and reject it out of hand, and instead push for a proper protocol that provides protection of &#8220;privacy&#8221; against both second party servers and third party evesdroppers, because if we don&#8217;t do it now, we will never be alowed the opportunity later.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-347135">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">TatÃ¼tata</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347135">
						March 2, 2020 10:10 AM					</a>

				</p>

				<p>I manually enabled DoH on Firefox (I&#8217;m not in the US) out of curiosity, and things seemed to be working OK, until I tried a certain (IMO legit) site since Saturday, where the following message being displayed in the browser client area:</p>
<blockquote><p>
Please enable cookies.</p>
<p>Error 1001 Ray ID: xxxxxxxxxxx â€¢ 2020-xx-xx xx:xx:xx UTC<br />
DNS resolution error<br />
What happened?</p>
<p>You&#8217;ve requested a page on a website (xxxxxx.xxx) that is on the Cloudflare network. Cloudflare is currently unable to resolve your requested domain (xxxxxx.xxx). There are two potential causes of this:</p>
<p>    Most likely: if the owner just signed up for Cloudflare it can take a few minutes for the website&#8217;s information to be distributed to our global network.</p>
<p>    Less likely: something is wrong with this site&#8217;s configuration. Usually this happens when accounts have been signed up with a partner organization (e.g., a hosting provider) and the provider&#8217;s DNS fails.</p>
<p>Cloudflare Ray ID: xxxxxxxxxxx â€¢ Your IP: xxx.xxx.xxx.xxx â€¢ Performance &amp; security by Cloudflare
</p></blockquote>
<p>The site in question works  and in other browsers and also when I disable DoH in Firefox.</p>
<p>The message clearly states that the issue is DNS-related, i.e., DoH. Why should I need cookies for a DNS request? Or is it only demanded for the error page? And as far as I can tell, the site in question isn&#8217;t been served by Cloudflare, despite what the message says.</p>
<p>Is there a potential for censorship when most DNS requests will eventually be mediated through a handful of global CDN operators? And what if Cloudflare or some other CDN is served with a National Security Letter forcing them to hand over all their traffic records?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-347136">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">TatÃ¼tata</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/#comment-347136">
						March 2, 2020 12:58 PM					</a>

				</p>

				<p><i>I wonder, if one <em>somehow</em> simply relied on IP numbers directly for accessing a website, would that in theory negate any and all use of a DNS server?</i></p>
<p>A big hosts file might have still been somewhat feasible 35 years ago, but totally unrealistic today.</p>
<p>Originally, a web server at a given IP address served only one domain at a time. Later, in view of the necessity of sharing resources and addressing IPV4 address exhaustion, a server could serve any number of domains. DNS returns you a common address for a bunch of servers, but in the initial HTTP 1.1 handshake the client specifies which particular one it desires. Furthermore, HTTPS, which guarantees that the site you&#8217;re talking to is the one you want, wouldn&#8217;t work anymore, as it is based on the domain name and not the resolved IP address.</p>
<p>And more than one result can be returned by DNS: alternate addresses for traffic shaping, IPV6 addresses, MX records, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2020/02/firefox_enables.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2020/02/firefox_enables.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F02%2Ffirefox_enables.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2020/02/firefox_enables.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='12396' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2020/02/russia_is_tryin.html" rel="prev">â† Russia Is Trying to Tap Transatlantic Cables</a>		<a href="https://www.schneier.com/blog/archives/2020/02/newly_declassif.html" rel="next">Newly Declassified Study Demonstrates Uselessness of NSA&#039;s Phone Metadata Program â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
