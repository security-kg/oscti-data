<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>The Nemim.gen Trojan - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; The Nemim.gen Trojan Comments Feed" href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4785" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4785' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F04%2Fthe_nemimgen_tr.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F04%2Fthe_nemimgen_tr.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4785 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4785" class="post-4785 post type-post status-publish format-standard hentry category-uncategorized tag-concealment tag-data-destruction tag-forensics tag-malware">

	<div class="article">

		<h2 class="entry">The Nemim.gen Trojan</h2>
		<p>This clever piece of malware evades forensic examination by <a href="http://www.darkreading.com/security/vulnerabilities/240152960/microsoft-discovers-trojan-that-erases-evidence-of-its-existence.html">deleting its own components</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/concealment/" rel="tag">concealment</a>, <a href="https://www.schneier.com/tag/data-destruction/" rel="tag">data destruction</a>, <a href="https://www.schneier.com/tag/forensics/" rel="tag">forensics</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html" rel="bookmark">Posted on April 18, 2013 at 11:36 AM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html#comments">20 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html" data-title="The Nemim.gen Trojan" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-194909">

			<div class="comment by-jason-burnett ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://jason-burnett.com' rel='external nofollow ugc' class='url'>Jason Burnett</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194909">
						April 18, 2013 12:11 PM					</a>

				</p>

				<p>While this is pretty horrific, I do think it&#8217;s <em>very</em> clever.  It&#8217;s starting to seem like the safest approach to malware is to assume you&#8217;re going to get infected, it&#8217;s just a matter of when, and then make plans accordingly.  (Perhaps people more knowledgeable on the subject than I have been of this mindset for a while now.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194910">

			<div class="comment by-gomez ">

				<p class="commentcredit">

					<span class="commenter">gomez</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194910">
						April 18, 2013 1:28 PM					</a>

				</p>

				<p>Won&#8217;t the data persist on journaled filesystems, if the infected files are modified?</p>
<p>I don&#8217;t know much about how viruses are implemented, but perhaps a defence could  be for the operating system to randomly move executable files to different parts of the hard drive?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194911">

			<div class="comment by-anup ">

				<p class="commentcredit">

					<span class="commenter">Anup</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194911">
						April 18, 2013 1:47 PM					</a>

				</p>

				<p>I wonder how long it will be before this increasingly self aware code turns into something that the creator cannot control, even if it was because of some bug he/she did not catch. Maybe it is time we had something similar to the three laws of robotics, but of course, with malware, it is a moot point.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194912">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194912">
						April 18, 2013 2:10 PM					</a>

				</p>

				<p>I would think most large companies are running network ids that saves binaries and alerts such as FireEye.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194913">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194913">
						April 18, 2013 2:44 PM					</a>

				</p>

				<p>That arms race is starting to look like it&#8217;s biological analogue.</p>
<p>Maybe it is time to look closer at how unicellular organisms, plants, and animals deal with organic viruses for ideas?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194914">

			<div class="comment by-northern-realist ">

				<p class="commentcredit">

					<span class="commenter">Northern Realist</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194914">
						April 18, 2013 2:54 PM					</a>

				</p>

				<p>@winter &#8211; check back issues of Scientific American and of the IBM Journal &#8212; they were looking at this approach long ago&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194915">

			<div class="comment by-matt-hollingsworth ">

				<p class="commentcredit">

					<span class="commenter">Matt Hollingsworth</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194915">
						April 18, 2013 3:24 PM					</a>

				</p>

				<p>Of course many people who are protecting themselves using read-only bootable drives and backups miss the problem of malware that is composed of known xploits or worse yet, BIOS or hardware level hacks that are not fixed by re-installing or booting from read only media&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194917">

			<div class="comment by-repentant-evildoer ">

				<p class="commentcredit">

					<span class="commenter">Repentant Evildoer</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194917">
						April 18, 2013 6:06 PM					</a>

				</p>

				<p>I worked as an assembly language programmer at an adware company from 2002-2004.</p>
<p>We used, or considered using, just such methods as this. We routinely deleted or hid our own components, or made them load as printer drivers. We randomly shuffled the innards of our loader so anti-virus programs wouldn&#8217;t recognize it as it was being downloaded.</p>
<p>And there were many worse things that we were asked to do but refused, such as pretending we were a deleted file, or patching the OS so we wouldn&#8217;t show up in directory searches.</p>
<p>The company was eventually shut down by the state Attorney General.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194918">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194918">
						April 18, 2013 6:17 PM					</a>

				</p>

				<p>@ Jason Burnett,</p>
<p><i>Perhaps people more knowledgeable on the subject than I have been of this mindset for a while now.</i></p>
<p>The simple answer is yes.</p>
<p>For instance some OS&#8217;s have &#8220;append only&#8221; file systems where it is possible to read and write data but not delete or overwrite existing data.</p>
<p>Another example is an OS with file systems with strong file type seperation, where it then becomes much easier to watch file systems for unexpected or unauthorized changes. Strong seperation in file systems has similar advantages to strong seperation in system memory and functionality and you can almost &#8220;type safe&#8221; it the way you do variables in some high level languages.</p>
<p>As a technique it predates most security concernces as it was originaly designed to optomize system performance, and as such a usefull technique has almost been lost and although it can be found in dusty journals from the 1960&#8217;s it has been &#8220;re-invented&#8221; by security researchers that are not aware of it because their litrature searches tend to use the wrong keywords.</p>
<p>Unsurprisingly there are many other techniques from the 60&#8217;s &amp; 70&#8217;s that have likewise become in effect &#8220;lost knowledge&#8221; that are effective in helping reduce and make easier the detection of what we now call &#8220;malware&#8221; in it&#8217;s various forms.</p>
<p>And guess what some are being thought up anew by researchers who were not even born at the time (and in some cases neither were there parents&#8230;).</p>
<p>@ Nick P who posts regularly on this blog appears to have made searching for this &#8220;old knowledge&#8221; a bit of a hobby and has in the past posted links to old journals that are now online.</p>
<p>Sadly whilst little of our new knowledge is original and the old knowledge is available little or any of it has made it into commodity operating systems where it would make very significant improvments in security.</p>
<p>As I&#8217;ve occasionaly said in the past most of our commodity OS&#8217;s need to start again. That is they realy realy need to ditch backwards compatability, that is in oh so many ways responsable for our current security ills one way or another.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194919">

			<div class="comment by-thomas ">

				<p class="commentcredit">

					<span class="commenter">Thomas</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194919">
						April 18, 2013 6:45 PM					</a>

				</p>

				<p>@Clive</p>
<p>Ditching backwards compatibility will happen around the same time the US converts to metric.</p>
<p>Everyone knows it&#8217;s necessary, should have happened years ago and will only get more expensive the longer we delay.</p>
<p>It just isn&#8217;t going to happen.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194920">

			<div class="comment by-aaron ">

				<p class="commentcredit">

					<span class="commenter">Aaron</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194920">
						April 18, 2013 9:25 PM					</a>

				</p>

				<p>There&#8217;s a space at the end of the href attribute in your URL that may cause it to not load when clicked in some situations. Just to let you know</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194921">

			<div class="comment by-im-no-superman ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.buggedplanet.info' rel='external nofollow ugc' class='url'>I&#039;m No Superman!</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194921">
						April 19, 2013 1:47 AM					</a>

				</p>

				<p><a href="http://www.buggedplanet.info" rel="nofollow ugc">http://www.buggedplanet.info</a></p>
<p>There is so much malware in the wild, with web pages telling you how to disguise it from sites like VirusTotal, even if you check files against sites like VT and the anti-malware programs you are running, there&#8217;s no hope to be clean at all. There&#8217;s always the chance you&#8217;re rooted either through malicious hardware design or through something hiding in firmware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194922">

			<div class="comment by-12-monkeys-hackers-movies-how-would-it-blend ">

				<p class="commentcredit">

					<span class="commenter">&#039;12 Monkeys&#039; + &#039;Hackers&#039; movies, how would it blend?</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194922">
						April 19, 2013 3:16 AM					</a>

				</p>

				<p>Routers article, simple:</p>
<p><a href="http://readwrite.com/2013/04/16/beware-the-wireless-router-security-threat" rel="nofollow ugc">http://readwrite.com/2013/04/16/beware-the-wireless-router-security-threat</a></p>
<p>Compromising Embedded Linux Routers with Metasploit, better article:<br />
<a href="https://community.rapid7.com/community/metasploit/blog/2013/04/05/" rel="nofollow ugc">https://community.rapid7.com/community/metasploit/blog/2013/04/05/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194923">

			<div class="comment by-nooiy ">

				<p class="commentcredit">

					<span class="commenter">Nooiy</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194923">
						April 19, 2013 3:20 AM					</a>

				</p>

				<p>Nothing new here. Erasing tracks is one common function in malwares. Even its other attributes like password stealing and so on seems very dull (use of Base64 in url is like using clear text).</p>
<p>Just another PR transforming a simple malware in a weapon&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194924">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194924">
						April 19, 2013 5:04 AM					</a>

				</p>

				<p>@ Repentant Evildoer,</p>
<p><i>We used, or considered using, just such methods as this. We routinely deleted or hid our own components, or made them load as printer drivers. We randomly shuffled the innards of our loader so anti-virus programs wouldn&#8217;t recognize it as it was being downloaded&#8230;</i></p>
<p>Hmm you were one of the &#8220;Guns for Hire&#8221; I used to talk about at that time when much of the security industry and academic researchers were trying to portray such malware activities as being &#8220;uber script kidies&#8221; doing such things for &#8220;ego food&#8221;rather than for monetary gain.</p>
<p>I could be petulant and go &#8220;Nah Nah told you so!&#8221; to those industry &#8220;pundits / gurus&#8221; but to be quite honest I&#8217;d rather just smile politely and carry on making my predictions (and hopefully living long enough üòâ to see if I call them right or not[1].</p>
<p>And tucked away in the article Bruce links to is a little snippit that is not in the MS posting. Which is the bit about checking for user activity at the keyboard etc.</p>
<p>That is it&#8217;s checking for a real life user machine and many would think not a server. But that would be a very limited view point, what is not mentioned is that this behaviour also acts as a Honey pot/net filter, thus making it less likely that the malware will get snagged.</p>
<p>Some years ago I directed my mind to how to avoid Honey pot/net systems and user activity or lack there of was my first thought, but I considered it &#8220;to obvious&#8221;.</p>
<p>However another thought that I discussed on this blog was how to remotly detect such systems in as camoflaged a way as possible.</p>
<p>The realisation you need is not to look for user activity which can be faked with scripts if the admin is smart enough but something else.</p>
<p>Which is where the old &#8220;follow the money&#8221; argument comes into play.</p>
<p>All Honey trap systems use resources which are expensive in various dimensions such as system purchase, power consumption, environmental cost (ie physical space, air con etc), maintanence and insurance costs etc. To reduce costs nearly all honey trap systems use Virtual Machine technology and this can be seen as an Achilles Heel of Honey Traps.</p>
<p>So the question then becomes not how to detect users but how to detect virtual machines.</p>
<p>After a little thought you realise you are looking for a distinquisher that shows two or more virtual machines share the same hardware from a remote location&#8230;</p>
<p>Well there are several ways but my criterion was how to camoflage what you are doing from the Honey Trap admin. Who is for obvious reasons paying very close attention to their logs but in all probability also recording every packet that hits the network in ways that cannot be remotely detected. So the method must not only appear as someting the admin expects in their logs and will thus ignore but also not contain any differentiator like a precious new zero day exploit etc.</p>
<p>There are several ways this can be done but most leak some information about what you are doing if the person looking at captured data is smart enough.</p>
<p>Thus the probe you use must at the very least follow the &#8220;Duck Principle&#8221; (If it looks like a duck, waddles like a duck and quacks like a duck, why would you assume it&#8217;s a goose). So you need to find a suitable duck, and I decided to use a nice noisy &#8220;brain dead script kiddie attack&#8221; that does a simple port test or equivalent that looks just like netcat etc in a simple script. Obviously what ever method you chose has to get above the access bar set by the Honey Trap admin.</p>
<p>The real difference is that the probe is carefully timed and the responces from the VM&#8217;s are likewise carefully timed. This is because VM&#8217;s all share the same system clock and thus any drift in it can be seen in the VM responses across the network due to packet timing information. Thus if you see a bunch of machines that all have the same clock drift the chances are they are all on the same base hardware and are thus VM&#8217;s and thus best avoided if you don&#8217;t want your latest valuable zero day to be caught and analysed.</p>
<p>I actually emailed one or two people in the HoneyNet project to warn them to be alert for such a probing attack or do what would be required to decouple the VMs sufficiently well from the system clock that a network timing probe attack would be prohibitive in time. Of those emailed the response was shall we say compleatly underwhelming.</p>
<p>Perhaps now they realise malware writers are looking to detect Honey Trap machines they will take the issue a little more seriously&#8230;</p>
<p>[1] For those who want to make their own predictions two pieces of advise and a filter. Firstly &#8220;follow the money&#8221; ultimatly it is &#8220;the route of all evil&#8221; which motivates people to tred that path to supposed riches which is the base of the American Dream. Secondly study history in a broad context as has been observed &#8220;people who do not learn from history have condemed themselves to re-live it&#8221; or more appropriatly new tech alows old tricks new places to be performed. So find an old trick and mentaly re-work it for the new environment and if you can see how money can be made from it, there&#8217;s a high degree of certainty that somebody will actually do it. When is the question and that&#8217;s where you apply the filter, it will happen most probably when the easier money has been nearly all consumed and the smarter people see it&#8217;s time to move to a new trick (ie the principle of the low hanging fruit).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194926">

			<div class="comment by-repentant-evildoer ">

				<p class="commentcredit">

					<span class="commenter">Repentant Evildoer</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194926">
						April 19, 2013 5:50 AM					</a>

				</p>

				<p>@ Clive Robinson,</p>
<p>Our code silently declined to install on any machine which had a debugger installed. This was not difficult to discover, and anyway the only one we really wanted to avoid was SoftICE.</p>
<p>We didn&#8217;t worry much about avoiding honeypots, because distributors of our ad client weren&#8217;t supposed to create driveby-download wrappers. But since they had financial incentives to do so (they got paid by the install), they did.</p>
<p>This cost us money and exposed us to accusations of illegal activity, so we set up honeypots of our own. They were exactly as you describe, VMs running unpatched versions of Windows XP (i.e., pre-SP1). We had the machines semi-randomly crawl the web until our monitoring daemon noticed an unknown process starting.</p>
<p>I say &#8220;semi-randomly&#8221; because we knew where to start: primarily sites purporting to link to adult material, secondarily sites offering song lyrics.</p>
<p>On top of all this there was a silent war going on between adware vendors. It began when we discovered that a competitor&#8217;s client was uninstalling ours, against which we retaliated in kind; from there it escalated as you would expect. I spent many hours dissecting competitors&#8217; code, some of which was much nastier than ours. (This was before the Sony rootkit debacle made many of these methods common knowledge.)</p>
<p>Bugs in this kind of low-level code could (and a few times did) make the user&#8217;s PC functionally useless, requiring a reinstall of the OS to recover.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194928">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">Nobody</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194928">
						April 19, 2013 8:54 AM					</a>

				</p>

				<p>Yeah, I have to admit, this is nothing new. Other articles get more into the technical details where there may be something new, but this concept is one of the first ones a malware developer who was serious about stealth would come to understand.</p>
<p>Probably a lot of the systems using this manner of functionality simply are not caught.</p>
<p>@Clive R</p>
<p>&#8220;Hmm you were one of the &#8220;Guns for Hire&#8221; I used to talk about at that time when much of the security industry and academic researchers were trying to portray such malware activities as being &#8220;uber script kidies&#8221; doing such things for &#8220;ego food&#8221;rather than for monetary gain.<br />
I could be petulant and go &#8220;Nah Nah told you so!&#8221; to those industry &#8220;pundits / gurus&#8221; but to be quite honest I&#8217;d rather just smile politely and carry on making my predictions (and hopefully living long enough üòâ to see if I call them right or not[1].&#8221;</p>
<p>The price of consistently coming up with bright ideas is you have to remain at least somewhat anonymous when doing so, and just shrug off the patent trolls of the world&#8230; or others who have a far more exhaustible supply of good ideas and bicker on &#8220;owning&#8221; them.</p>
<p>The pleasure is one sees the future, and can be a profound, though unseen influence.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-mod odd alt thread-odd thread-alt depth-1" id="comment-194929">

			<div class="comment by-moderator official">

				<p class="commentcredit">

					<span class="commenter">Moderator</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194929">
						April 19, 2013 10:16 AM					</a>

				</p>

				<p>Please save off-topic news for the squid thread.  There&#8217;ll be one along later today.  Or if you can&#8217;t wait, you could use <a href="http://www.schneier.com/blog/archives/2013/04/friday_squid_bl_371.html#comments" rel="nofollow ugc">last week&#8217;s</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-194930">

			<div class="comment by-snowbody ">

				<p class="commentcredit">

					<span class="commenter">Snowbody</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194930">
						April 19, 2013 12:56 PM					</a>

				</p>

				<p>Didn&#8217;t some DOS TSR viruses move themselves around memory when they detected an antivirus running?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-194931">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/#comment-194931">
						April 22, 2013 1:53 PM					</a>

				</p>

				<p>Maybe I&#8217;m dating myself, but this was common practice back in the OLD hacker days.   You&#8217;d write code, usually something to intercept passwords/track console activity.  Have it dump the goods somewhere then clean up the mess behind you.</p>
<p>Granted, it was a much more manual process back then, but we were also only interested in targeting a particular system for curiosity back then, not targeting millions of computers for profit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2013/04/the_nemimgen_tr.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2013/04/the_nemimgen_tr.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F04%2Fthe_nemimgen_tr.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2013/04/the_nemimgen_tr.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4785' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2013/04/initial_thought.html" rel="prev">‚Üê Initial Thoughts on the Boston Bombings</a>		<a href="https://www.schneier.com/blog/archives/2013/04/nsa_cryptograph.html" rel="next">NSA Cryptography Course ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
