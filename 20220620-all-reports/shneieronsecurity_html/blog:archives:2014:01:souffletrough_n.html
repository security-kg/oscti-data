<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>SOUFFLETROUGH: NSA Exploit of the Day - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; SOUFFLETROUGH: NSA Exploit of the Day Comments Feed" href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5160" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5160' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fsouffletrough_n.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fsouffletrough_n.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5160 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5160" class="post-5160 post type-post status-publish format-standard hentry category-uncategorized tag-backdoors tag-bios tag-exploit-of-the-day tag-exploits tag-firewall tag-hardware tag-malware tag-nsa tag-operating-systems tag-security-engineering">

	<div class="article">

		<h2 class="entry">SOUFFLETROUGH: NSA Exploit of the Day</h2>
		<p>One of the top secret NSA documents published by <i>Der Spiegel</i> is a 50-page <a href="http://leaksource.wordpress.com/2013/12/30/nsas-ant-division-catalog-of-exploits-for-nearly-every-major-software-hardware-firmware/">catalog</a> of &#8220;implants&#8221; from the NSA&#8217;s Tailored Access Group.  Because the individual implants are so varied and we saw so many at once, most of them were never discussed in the security community.  (Also, the pages were images, which makes them harder to index and search.)  To rectify this, I am publishing an exploit a day on my blog.</p>
<p>Today&#8217;s implant:</p>
<blockquote><p><b>SOUFFLETROUGH</b></p>
<p>(TS//SI//REL) SOUFFLETROUGH is a BIOS persistence implant for Juniper SSG 500 and SSG 300 firewalls. It persists DNT&#8217;s BANANAGLEE software implant. SOUFFLETROUGH also has an advanced persistent back-door capability.</p>
<p>(TS//SI//REL) SOUFFLETROUGH is a BIOS persistence implant for Juniper SSG 500 and SSG 300 series firewalls (320M, 350M, 520, 550, 520M, 550M). It persists DNT&#8217;s BANANAGLEE software implant and modifies the Juniper firewall&#8217;s operating system (ScreenOS) at boot time. If BANANAGLEE support is not available for the booting operating system, it can install a Persistent Backdoor (PBD) designed to work with BANANAGLEE&#8217;s communications structure, so that full access can be reacquired at a later time. It takes advantage of Intel&#8217;s System Management Mode for enhanced reliability and covertness. The PDB is also able to beacon home, and is fully configurable.</p>
<p>(TS//SI//REL) A typical SOUFFLETROUGH deployment on a target firewall with an exfiltration path to the Remote Operations Center (ROC) is shown above. SOUFFLETROUGH is remotely upgradeable and is also remotely installable provided BANANAGLEE is already on the firewall of interest.</p>
<p>Status: (C//REL) Released. Has been deployed. There are no availability restrictions preventing ongoing deployments.</p>
<p>Unit Cost: $0</p></blockquote>
<p>Page, with graphics, is <a href="http://leaksource.files.wordpress.com/2013/12/nsa-ant-souffletrough.jpg">here</a>. General information about TAO and the catalog is <a href="https://www.schneier.com/blog/archives/2013/12/more_about_the.html">here</a>.</p>
<p>In the comments, feel free to discuss how the exploit works, how we might detect it, how it has probably been improved since the catalog entry in 2008, and so on.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="https://www.schneier.com/tag/bios/" rel="tag">BIOS</a>, <a href="https://www.schneier.com/tag/exploit-of-the-day/" rel="tag">exploit of the day</a>, <a href="https://www.schneier.com/tag/exploits/" rel="tag">exploits</a>, <a href="https://www.schneier.com/tag/firewall/" rel="tag">firewall</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/security-engineering/" rel="tag">security engineering</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html" rel="bookmark">Posted on January 13, 2014 at 2:45 PM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html#comments">43 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html" data-title="SOUFFLETROUGH: NSA Exploit of the Day" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-213368">

			<div class="comment by-matt-leidholm ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://twitter.com/mattleidholm' rel='external nofollow ugc' class='url'>Matt Leidholm</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213368">
						January 13, 2014 2:51 PM					</a>

				</p>

				<p>Be honest: you&#8217;re doing these according to codename in reverse awesomeness order, right?</p>
<p>Because these things just keep getting better.</p>
<p>(I wish I knew enough about Juniper SSG 500 and SSG 300 firewalls to leave a thoughtful comment; I do not.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213369">

			<div class="comment by-ben-rosengart ">

				<p class="commentcredit">

					<span class="commenter">Ben Rosengart</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213369">
						January 13, 2014 3:21 PM					</a>

				</p>

				<p>Someone at NSA must have been awfully hungry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213370">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213370">
						January 13, 2014 4:05 PM					</a>

				</p>

				<p>We need open source firewalls, running open source operating systems, with fully 100% open source drivers/bios/firmware/etc to be more safe from such abuse.  Not the kind where you have an open source wrapper around proprietary closed-source binary blobs, but actual proper through-and-through open source.  Security by obscurity is not security at all.  The solution to eroding trust in a secretive pwned infrastructure is more openness.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213371">

			<div class="comment by-nix ">

				<p class="commentcredit">

					<span class="commenter">Nix</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213371">
						January 13, 2014 4:08 PM					</a>

				</p>

				<p>Does <em>anyone</em> still think System Management Mode is a good idea? Because code should be allowed to run on the processor without the knowledge or awareness of the operating system! What could possibly go wrong? (Answer: a lot. If I could throw all SMM off my systems, I would &#8212; but I can&#8217;t because some of the SMM traps are used to fix outright hardware bugs, and they&#8217;re all undetectable without a logic analyzer in any case. Very useful for malware&#8230;)</p>
<p>DB: you need more than open source firmware for SMM to not be a threat. You need an open source <em>chipset</em>, and proof that you&#8217;re actually running the thing you have the source to. SMM is deeply, deeply evil.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213372">

			<div class="comment by-parker ">

				<p class="commentcredit">

					<span class="commenter">Parker</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213372">
						January 13, 2014 4:39 PM					</a>

				</p>

				<p>Screw open-source. I&#8217;m sick of hearing how open-source everything and command line in Linux crap is going to fix everything. Wake up!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213373">

			<div class="comment by-iain-moffat ">

				<p class="commentcredit">

					<span class="commenter">Iain Moffat</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213373">
						January 13, 2014 5:18 PM					</a>

				</p>

				<p>@Nix and DB &#8211; I think it goes further than having a trusted chipset and trusted code to ensuring that there is nowhere in the system that persistent malware can hide through a power cycle, and the boot process has to start from a provable and immutable root of trust e.g. a really read-only ROM (I can see fuse link PROM and masked ROM coming back into fashion!) with code that can checksum each more complex layer of software on the way to the final operational code before it is allowed to run. New designs for security devices probably ought to forego &#8220;smart&#8221; peripherals with any embedded storage, and accept the inconvenience of human involvement in upgrades to leave malware with no easy hiding place.</p>
<p>Usually modern network kit has a permanent ROM  boot loader which executes an operating system from flash memory which then loads a configuration file and/or rule set to tailor it to the requirements of the site where it is installed.</p>
<p>Looking at the recent posts in this series there seems to be a family of firewall implants comprising different loaders for different vendors and hardware (Souffletrough, Jetplow, Halluxwater and Feedtrough) with a common higher layer (Bananaglee). The higher layer seems to work across different unix-like operating systems (I believe PIX post version 6 and ASA are Linux based and Juniper generally use OpenBSD) so the common higher layer of the implant probably depends more on a common CPU type and the ability to operate concealed by SMM, while the loaders are tailored to the boot process and available NVRAM/EEPROM hiding places in each platform.</p>
<p>Looking at the PIX/ASA versions supported compatibility starts more or less at the transition from 486DX/Pentium Pro to Celeron or Pentium III processors. It would be interesting to know if the Pix 501 (the sole AMD PIX) was supported by Jetplow/Bananaglee as an aside.</p>
<p>This view of platform specific loaders for a common payload tends to be supported by use of almost the same graphic on the page with the slide linked from each article. The process in each case described here seems to be that something hiding at or below BIOS level patches the operating system to add a hidden process (Bananaglee) which is the working part of the implant. As such it is a first cousin of PC resident advanced persistent threats.</p>
<p>Hope this helps</p>
<p>Iain</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213374">

			<div class="comment by-coyne-tibbets ">

				<p class="commentcredit">

					<span class="commenter">Coyne Tibbets</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213374">
						January 13, 2014 5:50 PM					</a>

				</p>

				<p>BANANAGLEE-related exploits (so far): SOUFFLETROUGH, FEEDTROUGH, JETPLOW, ZESTYLEAK, GOURMETTROUGH; more coming up I&#8217;m sure.</p>
<p>But BANANAGLEE seems to be a central/core exploit, described in several of the other offerings as being installed by the offering and providing an anchor for reinstallation of the other offering.</p>
<p>According to several of the entries, BANANAGLEE itself is persisted into the BIOS.</p>
<p>Given that, and the structure of the modern boot processes used by many platforms, it occurs to me that BANANAGLEE must be a specific exploit into UEFI. That once the child O/S is subverted with one of the other exploits then BANANAGLEE is pushed into the UEFI BIOS boot stack; where it provides a hook for remote upgrades and for re-installation of exploits removed by such activities as O/S upgrades.</p>
<p>To accomplish this would require that BANANAGLEE be signed with a signature known to UEFI. This would have to be done by a UEFI core manufacturer, such as Intel, or perhaps even leverage support hardcoded within UEFI itself.</p>
<p>This is stronger support for the idea that UEFI is compromised by the NSA; that every modern UEFI machine is NSA-ready out of the box.</p>
<p>I&#8217;ll be interested to see how many exploits from the catalog depend on BANANAGLEE.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213375">

			<div class="comment by-galileo-galilei ">

				<p class="commentcredit">

					<span class="commenter">galileo galilei</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213375">
						January 13, 2014 6:22 PM					</a>

				</p>

				<p>Note, that most recent architecure change in motherboards involved puting BIOS on a dedicated chip.<br />
Manufacturers will not spend a penny extra for no reason, and extra chip makes no difference for BIOS&#8217;s funcionality. So,what reason could that be?</p>
<p>This was a hint that BIOS is used by NSA for implants, and manufacturers must be complicit.</p>
<p>I say, keep an eye on BIOS and its manufacturers.</p>
<p>I predict China will offer NSA-free architecture, which will cost American businesses severe financial losses.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213376">

			<div class="comment by-dorn-hetzel ">

				<p class="commentcredit">

					<span class="commenter">Dorn Hetzel</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213376">
						January 13, 2014 6:55 PM					</a>

				</p>

				<p>Maybe we need to go back to the days of rows of toggle switches for bootstrap code&#8230;  CDC Cyber style, anyone? üôÇ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213377">

			<div class="comment by-rob-schneider ">

				<p class="commentcredit">

					<span class="commenter">Rob Schneider</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213377">
						January 13, 2014 7:33 PM					</a>

				</p>

				<p>$10 says all this stuff is detectable with this:<br />
<a href="http://www.mitre.org/capabilities/cybersecurity/overview/cybersecurity-blog/copernicus-question-your-assumptions-about" rel="nofollow ugc">http://www.mitre.org/capabilities/cybersecurity/overview/cybersecurity-blog/copernicus-question-your-assumptions-about</a><br />
You can&#8217;t detect the SMM subversion due to the way the architecture works, but I doubt they&#8217;re able to hide their flash chip modifications.</p>
<p>@Coyne &#8220;To accomplish this would require that BANANAGLEE be signed with a signature known to UEFI.&#8221; No it wouldn&#8217;t. Obviously once you&#8217;re in BIOS you can just turn off signature checks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213378">

			<div class="comment by-tony-h ">

				<p class="commentcredit">

					<span class="commenter">Tony H.</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213378">
						January 13, 2014 8:48 PM					</a>

				</p>

				<p>I&#8217;m not quite getting this BANANAGLEE. These Exploit-of-the-day things are from TAO, and they all ensure that BANANAGLEE stays in place under adverse circumstances, or at least that there&#8217;s a backdoor waiting for when BANANAGLEE gets updated for the OS in question. But BANANAGLEE is more routine, i.e. presumably doesn&#8217;t require any TAO magic to get it in place. So of course the question is how does BANANAGLEE <i>normally</i> get installed? Or is it purely an administrative thing; TAO does all the installers, and DNT does the overall architecture, exfiltration network, etc?</p>
<p>I&#8217;m still astonished all these haven&#8217;t been found in the wild. What about all those firewalls and routers on eBay? I bought one that had a bank&#8217;s config info on it a few years ago; maybe I should go back and look for BANANAGLEE on the drive I replaced.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213379">

			<div class="comment by-annoyed ">

				<p class="commentcredit">

					<span class="commenter">annoyed</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213379">
						January 13, 2014 10:27 PM					</a>

				</p>

				<p>I would assume it is installed using opcodes and/or assembly either to the processor(s) or micro-controller(s).</p>
<p>If they have access to the metal (remotely or directly doesn&#8217;t matter) there&#8217;s nothing that can stop them.</p>
<p>It&#8217;s a big tiny world to hide in.</p>
<p>Computer security has become Schr√∂dinger&#8217;s cat: if you didn&#8217;t push that opcode yourself and if you don&#8217;t have something that continually checks it and everything else both at rest and work, and then checks its results then you have no way of knowing whether you are secure or not.</p>
<p>I love open/free/libre source but the minimum requirement for the future is open/free/libre hardware. Everything else is like building on quicksand.</p>
<p>There is one possible &#8220;shortcut&#8221; and that is to utterly compromise every part of the hardware in every way replacing everything that can be replaced with your own custom firmware. An astronomical task for even low-end computers including for whatever accessories one hooks up.</p>
<p>I hope Binnie fully subverts microSD cards soon and posts a detailed howto; something like that is about the only thing left to trust (if you continually &#8220;re-breach&#8221; it on startup).</p>
<p>It will be slow and cumbersome but opens the door for the next step which is to likewise fully &#8220;corrupt&#8221; USB-sticks (same innards) and powered USB-hubs (then one can aim for the same with USB keyboards and simplistic USB screens for a general purpose rudimentary computer).</p>
<p>Close the door, do not have any other electronics in the room, break out your mylar survival blankets and Snowdenize yourself and just maybe they won&#8217;t see you playing solitaire on that piddly thing üòõ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213380">

			<div class="comment by-huawei ">

				<p class="commentcredit">

					<span class="commenter">Huawei</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213380">
						January 13, 2014 11:11 PM					</a>

				</p>

				<p>So, what of talk to the effect that the House Intelligence Committee&#8217;s blast at Huawei a little over a year ago was as much about facilitating NSA spying as about deflecting Chinese spying?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213381">

			<div class="comment by-iain-moffat ">

				<p class="commentcredit">

					<span class="commenter">Iain Moffat</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213381">
						January 14, 2014 3:26 AM					</a>

				</p>

				<p>@Dorn Hetzel: The next step from toggle switches in the 1960s/early 1970s was to store the boot code either in a diode matrix ROM or a core ROM where a bit was signified by a diode or ferrite ring present or absent at a particular point in the grid. Either is non rewritable and can be visually inspected but avoids the error prone time consuming exercise of loading via switches. Building a diode matrix ROM for a few tens of bytes is quite straightforward (diodes are less than 2p/3 cents each and address decoding needs a few TTL devices) and could provide at least a bios checksum routine and stored expected answer to create a root of trust for a computer otherwise built with commercial parts. I think the bigger challenge is to find a complete kit of parts or commercial single board computer made this century that is free of NVRAM or EEPROM where malicious code can persist across a power cycle. This means not just the CPU and memory but also all of the peripheral devices (NICs, disk controllers, disk drives, &#8230;.). I the only other approach is for the trusted ROM code to explicitly zero all known NVRAM and EEPROM before proceeding to load the OS. This fails if some NVRAM or EEPROM embedded in the CPU or peripheral controllers is undocumented.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213382">

			<div class="comment by-qwertyuiop ">

				<p class="commentcredit">

					<span class="commenter">qwertyuiop</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213382">
						January 14, 2014 5:30 AM					</a>

				</p>

				<p>@Parker &#8211; I&#8217;m with you on that. Open source is touted as the solution to all of our problems &#8220;because you can verify the code yourself&#8221;. In theory that&#8217;s fine but in practice I&#8217;d say totally impossible because how many of us could actually verify the code? I know that I don&#8217;t have the skills myself and I know very few people who do.</p>
<p>@DB says &#8220;We need open source firewalls, running open source operating systems, with fully 100% open source drivers/bios/firmware/etc to be more safe from such abuse.&#8221; How many people have the level of understanding to actually verify the code in software as diverse as a firewall, an OS, drivers for dozens of different devices, a bios, etc? Every single one of those requires subject specific knowledge and I suspect the number of people whose knowledge embraces all of those individual expert areas could be counted on the fingers of one hand.</p>
<p>Let me quickly add that I&#8217;m not anti open source. I love open source and use it a lot myself, but please let&#8217;s stop kidding ourselves that any more than a very few people actually download the source, check the code, and then compile it (with a compiler that they&#8217;ve already checked). Most of us don&#8217;t even compile it ourselves, let alone check the code first; we go to a site which we <b>believe</b> to be trustworthy and download it from there.</p>
<p>And that&#8217;s only the software! If you want to be truly sure that you&#8217;re as safe as it is possible to be then you are going to have to design and fabricate the hardware itself, starting with the chips &#8211; how can you trust anybody else?</p>
<p>The reality is that at some point most of us are going to have to trust somebody else to be straight and honest, and we&#8217;re also going to have to accept that not everybody will be so we need to take extra measures to protect ourselves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213383">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213383">
						January 14, 2014 6:42 AM					</a>

				</p>

				<p>It seems to me BIOS and firewalls are a weak link.</p>
<p>Popular commercial software firewalls must be a laughably weak point then.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213385">

			<div class="comment by-bob-s ">

				<p class="commentcredit">

					<span class="commenter">Bob S.</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213385">
						January 14, 2014 6:49 AM					</a>

				</p>

				<p>Re: &#8221; trusted ROM code to explicitly zero all known NVRAM and EEPROM before&#8230;&#8221; ~Iain</p>
<p>So then, a ROM firewall, ROM Bios or ROM Vacuum Cleaner might be effective.</p>
<p>I don&#8217;t know, but I am wondering, is it really that easy to manipulate BIOS and firmware firewalls?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213386">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213386">
						January 14, 2014 7:21 AM					</a>

				</p>

				<p>People are posting here that we will have to start fabricating our own hardware down to the VLSI design level. That seems to me to be an exaggeration. I rather doubt that the NSA has somehow installed hardware backdoors on FPGA chips which could be effective against custom programming, making them a useful high-level building block for secure hardware. The main roadblocks I see are (and please correct me if I am wrong, I&#8217;m not a real expert):</p>
<ul>
<li>There is a strong lack of open-source programming tools for higher-end FPGAs</li>
<li>At the high clock rates we would want, PCB board design requires special skills</li>
<li>Small batch manufacturing of the PCB boards will be expensive, along with the high-end FPGAs which are powerful enough to be turned into reasonable CPUs</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213387">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213387">
						January 14, 2014 7:30 AM					</a>

				</p>

				<p>@Iaim Moffat</p>
<p>‚Äú‚Ä¶there seems to be a family of firewall implants comprising different loaders for different vendors and hardware (Souffletrough, Jetplow, Halluxwater and Feedtrough) with a common higher layer (Bananaglee). The higher layer seems to work across different unix-like operating systems (I believe PIX post version 6 and ASA are Linux based and Juniper generally use OpenBSD) so the common higher layer of the implant probably depends more on a common CPU type and the ability to operate concealed by SMM, while the loaders are tailored to the boot process and available NVRAM/EEPROM hiding places in each platform.‚Äù</p>
<p>‚ÄúLooking at the PIX/ASA versions supported compatibility starts more or less at the transition from 486DX/Pentium Pro to Celeron or Pentium III processors. It would be interesting to know if the Pix 501 (the sole AMD PIX) was supported by Jetplow/Bananaglee as an aside.‚Äù</p>
<p>‚ÄúThis view of platform specific loaders for a common payload tends to be supported by use of almost the same graphic on the page with the slide linked from each article. The process in each case described here seems to be that something hiding at or below BIOS level patches the operating system to add a hidden process (Bananaglee) which is the working part of the implant. As such it is a first cousin of PC resident advanced persistent threats‚Ä¶ ‚Äú</p>
<p>‚Äú‚Ä¶the only other approach is for the trusted ROM code to explicitly zero all known NVRAM and EEPROM before proceeding to load the OS. This fails if some NVRAM or EEPROM embedded in the CPU or peripheral controllers is undocumented.‚Äù</p>
<p>That is interesting. I think you are on to something. I see that SMM started in the PIII series (1998).</p>
<p>‚ÄúSystem Management Mode (SMM) is an operating mode in which all normal execution (including the operating system) is suspended, and special separate software (usually firmware or a hardware-assisted debugger) is executed in high-privilege mode. It was first released with the Intel 386SL. While initially special SL versions were required for SMM, Intel incorporated SMM in its mainline 486 and Pentium processors in 1993. AMD copied Intel&#8217;s SMM with the Enhanced Am486 processors in 1994. It is available in all later microprocessors in the x86 architecture.‚Äù</p>
<p><a href="https://en.wikipedia.org/wiki/System_Management_Mode" rel="nofollow ugc">https://en.wikipedia.org/wiki/System_Management_Mode</a></p>
<p>iAMT is usually used for consumer products and seems to start in the 945 chipset. That would be the high-end P4‚Äôs and Core 2 processors (socket 775).</p>
<p><a href="https://en.wikipedia.org/wiki/Intel_AMT_versions" rel="nofollow ugc">https://en.wikipedia.org/wiki/Intel_AMT_versions</a></p>
<p>I see the earliest wide spread bios virus was in 1998.</p>
<p>‚ÄúCIH, also known as Chernobyl or Spacefiller [bios virus], is a Microsoft Windows 9x computer virus which first emerged in 1998. It is one of the most damaging viruses, overwriting critical information on infected system drives, and more importantly, in most cases overwriting the system BIOS. The virus was created by Chen Ing-hau who was a student at Tatung University in Taiwan. 60 million computers were believed to be infected by the virus internationally, resulting in an estimated $1 billion US dollars in commercial damages‚Ä¶ Chen claimed to have written the virus as a challenge against bold claims of antiviral efficiency by antivirus software developers. Chen stated that after the virus was spread across Tatung University by classmates, he apologized to the school and made an antivirus program available for public download‚Ä¶ In September 1998, Yamaha shipped a firmware update to their CD-R400 drives that was infected with the virus‚Ä¶CIH spreads under the Portable Executable file format under Windows 95, 98, and ME. CIH does not spread under Windows NT-based operating systems, such as Windows 2000, Windows XP, Windows Vista, Windows 7, Windows 8, and Windows 8.1.‚Äù</p>
<p>‚Äú&#8230;CIH infects Portable Executable files by splitting the bulk of its code into small slivers inserted into the inter-section gaps commonly seen in PE files, and writing a small re-assembly routine and table of its own code segments&#8217; locations into unused space in the tail of the PE header. This earned CIH another name, &#8220;Spacefiller&#8221;. The size of the virus is around 1 kilobyte, but due to its novel multiple-cavity infection method, infected files do not grow at all. It uses methods of jumping from processor ring 3 to 0 to hook system calls‚Ä¶‚Äù</p>
<p><a href="https://en.wikipedia.org/wiki/CIH_(computer_virus)" rel="nofollow ugc">https://en.wikipedia.org/wiki/CIH_(computer_virus)</a></p>
<p>If Chen wrote an anti-virus program why can&#8217;t the major Anti-virus makers do the same?</p>
<p>@Coyne Tibbets</p>
<p>&#8220;This is stronger support for the idea that UEFI is compromised by the NSA; that every modern UEFI machine is NSA-ready out of the box.&#8221;</p>
<p>That&#8217;s a very troubling thought.</p>
<p>@Tony H</p>
<p>‚Äúthe question is how does BANANAGLEE normally get installed? Or is it purely an administrative thing; TAO does all the installers, and DNT does the overall architecture, exfiltration network, etc? I&#8217;m still astonished all these haven&#8217;t been found in the wild.‚Äù</p>
<p>Good question. I would assume a bios flash would require a cold boot (possible a warm boot). And, a re-boot of a firewall should show up the logs and start alarm bells ringing. I wonder if this is an inside job (or possible a NSA/CIA ‚Äúbag job‚Äù).</p>
<p>@galileo galilei</p>
<p>‚ÄúNote, that most recent architecure change in motherboards involved puting BIOS on a dedicated chip.  Manufacturers will not spend a penny extra for no reason, and extra chip makes no difference for BIOS&#8217;s funcionality. So,what reason could that be? This was a hint that BIOS is used by NSA for implants, and manufacturers must be complicit.‚Äú</p>
<p>That‚Äôs is a possibility.</p>
<p>@Nix</p>
<p>‚ÄúDoes <em>anyone</em> still think System Management Mode is a good idea?‚Äù</p>
<p>No. Not any more. The system was based on trust. That trust is gone.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213388">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213388">
						January 14, 2014 8:20 AM					</a>

				</p>

				<p>@ Dorn, Iain, Bob,</p>
<p>The problem with NVRAM be it flash or other &#8220;electricaly alterable&#8221; ROM is it&#8217;s in many places.</p>
<p>There are two reasons for this, firstly it alows fast turn around of designs with field upgrades. This is historicaly not a hardware engineering but a software code cutter and marketing manager solution original pushed by the likes of Micro$haft.</p>
<p>The second reason is down to &#8220;dark silicon&#8221; basicaly transistor packing density on silicon is rising faster than individual transistor efficiency. It is in effect nolonger possible to pack continuously active transistors on silicon without causing it to glow quite nicely. However RAM/ROM is in effect static most of the time it&#8217;s only the small fraction you read or write to that is active. Therefore packing an SoC with RAM/ROM is in effect a freebie in that it can in effect be considered to be effectivly &#8220;dark silicon&#8221;.</p>
<p>Thus you find SoC&#8217;s on peripherals like HD&#8217;s that have three ARM CPU Cores (often of different generations) that have a large effectivly common block of memory into which programs can be placed. The number of different types of these SoCs in use is considerably smaller than the number of Intel CPU&#8217;s (some recone it&#8217;s only a couple).</p>
<p>The code on these SoC&#8217;s tends to be generic cludges of organicaly grown code that few code cutters would dare mess with, thus it makes a very easy target for those who have the skills to &#8220;Boldly Go&#8230;&#8221; etc.</p>
<p>Whilst this makes it easier to find and copy the cludgy code it does not solve the &#8220;pre-instaled malware&#8221; problem.</p>
<p>The solution to this is actualy to take a leaf out of the NSA&#8217;s book, which is &#8220;inline media encryptors&#8221; or similar.</p>
<p>Basicaly what you need to do is put your own micro between the motherboad and the periheral this micro needs to have two appropriate interfaces. Whilst most micro&#8217;s can data shift from I to O and back again it&#8217;s the processing that gives the hit and creates a bottle neck. However I&#8217;ve built one or two that do 10Mbit ethernet and 100M (but only 25M sustained) with limited processing/encryption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213389">

			<div class="comment by-iain-moffat ">

				<p class="commentcredit">

					<span class="commenter">Iain Moffat</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213389">
						January 14, 2014 8:24 AM					</a>

				</p>

				<p>Regarding countermeasures, the firewall vendors are in a slightly better place than the average PC user because they know exactly what their hardware build is so should be able &#8220;in theory&#8221; to go down the route of making a &#8220;good bios&#8221; that systematically clears all writeable storage in the machine as soon as it runs, for each model/board variation. This assumes that the BIOS flash process is not subverted by the implant to relocate new code and insert itself in the chain of execution.</p>
<p>I suspect that additional integrity checks and zeroing or checking of all EEPROM and NVRAM  is all that can be retrofitted to most existing products. There will (or should) now be market pressure for at least security devices to boot into something like that from really readonly  ROM before executing flash BIOS (the modern version of a 1980s Power on self test POST ROM if you like). The bigger problem is how to validate flash BIOS and legitimate NVRAM storage (like a router configuration) without adding a separate secure store for keys or checksums accessible only to the POST which needs to be designed into hardware. The POST almost needs to be a separate mask programmed CPU which is able to become bus master at power up to achieve that.</p>
<p>Having writable persistent storage in a separate chip or card is not necessarily bad &#8211; especially if it is socketed &#8211; as the removal beyond reasonable doubt of a &#8220;bad BIOS&#8221; only requires a spare good chip and an extraction tool ! the converse is obviously true unless the computer is physically secure of course &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213390">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213390">
						January 14, 2014 10:15 AM					</a>

				</p>

				<p>@ Dorn Hetzel</p>
<p>Thanks for the memory (Basic Binary Loader).  üôÇ   I cut my assembler teeth on an HP 2116 and its bullet-proof(!) toggle switches.  Small words on that machine, so we worked in octal, not hex.  My thumb developed a callous from clearing all switches, a la pianist, countless times.  Forget to set the upper memory write-protect and an errant program could trash the BBL  =&gt;  lots of practice toggling in the BBL again.</p>
<p>Load Address<br />
Run<br />
Ahhh&#8230; those were the days.</p>
<p>By the way, our mainframe at that time was a CDC Cyber 71, which we accessed with DECwriters.  I never laid eyes on the Cyber though (&#8220;glass house&#8221; mentality in those days).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213391">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213391">
						January 14, 2014 10:36 AM					</a>

				</p>

				<p>@ RonK</p>
<p>Yes, those are problems that need to be dealt with. Especially open tools for generating FPGA logic from low- or high-level specs. There&#8217;s <a href="http://www.openfpga.org/pages/Resources.aspx" rel="nofollow ugc">some</a> work in this area.</p>
<p>@ 65535</p>
<p>&#8220;‚ÄúDoes <em>anyone</em> still think System Management Mode is a good idea?‚Äù</p>
<p>No. Not any more. The system was based on trust. That trust is gone.&#8221;</p>
<p>Intel SMM was included in a 386 variant for power management. That was way before they were worried about trust or security. Heck, they had just gotten proper memory management. The evolution of it with more and more features is easily explained by business drivers. Yet, it was identified as a potential attack channel back in the 90&#8217;s due to privileged nature. Just another weakness Intel couldn&#8217;t get rid of for backward compatibility is most likely explanation. Same reason why so many 32-bit GB+ boards booted in real mode at 20bit and limited to 1MB of memory. üòâ</p>
<p>I&#8217;ll also add that Intel&#8217;s radical i432 architecture solves tons of security problems at OS or app layers. Yet, market turned it down in favor of insecure, fast, backward compatible chips. They tried another route of removing baggage with the introduction of Itanium architecture. It has take-up in mission critical computing but its future is uncertain. So, that&#8217;s one massive loss and one probable that Intel&#8217;s had because they bet on quality/security. One could say they&#8217;ve been forced in certain direction by the market &amp; the market as a whole is getting what it deserved.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213392">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213392">
						January 14, 2014 10:55 AM					</a>

				</p>

				<p>@qwertyuiop:</p>
<p>Open Source is not &#8220;the solution to all our problems&#8221; because &#8220;you can verify it yourself&#8221;&#8230;. indeed most people don&#8217;t have the expertise to do any verification.  You are correct about that.</p>
<p>It is the solution because the principle of openness restores trust when trust has been violated and destroyed in secret.  Continuing secrecy and more and more remonstrations that &#8220;everying&#8217;s ok, go back to sleep,&#8221; will just continue mistrust at this point.  But being more open about things will restore trust.</p>
<p>@Nix, @Parker, @Iain Moffat:</p>
<p>This principle of openness could apply to both our software and hardware.  Software is not the only thing that can be &#8220;open source&#8221; but hardware can also be &#8220;open source.&#8221;  Currently the only &#8220;open source&#8221; hardware I&#8217;m aware of is small embedded hobbyist devices like <a href="http://arduino.cc/" rel="nofollow ugc">http://arduino.cc/</a>, but I think the principle could be applied to bigger things&#8230; like, yes, chipsets, CPUs, whole motherboards, etc&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213393">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213393">
						January 14, 2014 1:19 PM					</a>

				</p>

				<p>@ DB</p>
<p>See opencores.com for other applications. As for Arduino, far as I can tell it&#8217;s just the board design that&#8217;s open: the CPU and other key chips are closed commercial designs. The sophisticated NSA attack vectors we&#8217;ve seen include vulnerable BIOS storage areas, CPU weaknesses (eg SMM), and firmware on peripheral device chips. So, an open board design can still be targeted quite well if there&#8217;s weaknesses in its components.</p>
<p>The minimal requirements some of us worked out are:</p>
<ol>
<li>A trusted main chip</li>
<li>A trusted, non-writable BIOS</li>
<li>Trusted boot process in control of owner</li>
<li>IOMMU or similar restrictions for untrusted devices</li>
<li>
<p>Verifiable tools for compiling, installing, etc software onto the device (esp privileged software).</p>
</li>
<li>
<p>(optional, but I prefer) Instruction set extensions for provably safer/secure software</p>
</li>
</ol>
<p>There&#8217;s currently no open device that meets these requirements. Hence, all open devices are potentially vulnerable. The good news is that the research papers I posted a while back and open core designs have already produced components that can meet these minimal requirements. What&#8217;s left are knowledgeable engineers getting paid to put it together, get it peer reviewed, and get it built.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213394">

			<div class="comment by-sobrado ">

				<p class="commentcredit">

					<span class="commenter">sobrado</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213394">
						January 14, 2014 1:35 PM					</a>

				</p>

				<p>@qwertyuiop, @DB: &#8220;<i>Open Source is not &#8220;the solution to all our problems&#8221; because &#8220;you can verify it yourself&#8221;&#8230;. indeed most people don&#8217;t have the expertise to do any verification. You are correct about that.</i>&#8221;</p>
<p>I would say you do not understand the open source model. No one asks <i>each individual user</i> to read and verify the source code himself. It is enough if the code has been audited by a few clever members of independent development teams at the community. As the code is open to public review anything wrong on it, either bugs or an intentional backdoor, will be spotted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213395">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213395">
						January 14, 2014 3:06 PM					</a>

				</p>

				<p>Why the fixation on a non-writable BOISes?  You want to order a new chip every time a bug is found in the code?  The solution is not preventing change, the solution is being more open about what&#8217;s in there (so that peer review can happen, and things have the capability of getting fixed, instead of festering)&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213396">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213396">
						January 14, 2014 3:17 PM					</a>

				</p>

				<p>@ sobrado:</p>
<p>Just being &#8220;open source&#8221; does not guarantee that there is a single member of any individual project community that is &#8220;clever&#8221; enough to audit it properly&#8230; it only guarantees that it&#8217;s POSSIBLE for there to be.  There are plenty of open source projects that are full of security holes, because their communities are not knowledgeable enough to fix them or have good architectures etc.  So open source is not a panacea that is automatically trustworthy, it just makes trust possible because of its openness.</p>
<p>But closed source can&#8217;t be trusted, because it is NOT POSSIBLE for someone with knowledge to verify it.  Whereas open source can.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213397">

			<div class="comment by-marcos-el-malo ">

				<p class="commentcredit">

					<span class="commenter">Marcos El Malo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213397">
						January 14, 2014 4:31 PM					</a>

				</p>

				<p>@DB</p>
<p>So, as I understand it, open source isn&#8217;t a panacea, but is better than nothing as long as it&#8217;s not instilling false confidence. It&#8217;s still placing trust in individuals, most likely strangers, but those strangers are at least publicly accountable (only important if their public reputation is important to them). A trusted developer could be suborned or a deep cover mole could work his or her way into a position of trust.</p>
<p>The major difference, all other things being equal, is that open source is slightly less likely to be compromised than proprietary software.</p>
<p>Regarding open source hardware, how do you even begin to check? Each individual batch of a CPU? Each individual CPU? Who does the testing?</p>
<p>As someone else suggested (if I am understanding correctly), it looks like we&#8217;re back to soldering diodes onto breadboards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213398">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213398">
						January 14, 2014 6:38 PM					</a>

				</p>

				<p>@Marcos open source hardware isn&#8217;t a panacea either.  it&#8217;s just a glorious giant leap in the right direction.  It&#8217;s just an application of the principle of openness, rather than secrecy.  The more openness there is in both software and hardware, the harder it becomes to nefariously hide stuff in there.</p>
<p>A true open source hardware system would be safer because there would be TONS of copycat places fabricating open source hardware designs, all of which can be verified both visually and behaviorally that they are as intended.  Any minor deviation and that place is liable to go out of business, let alone legal problems.  The building of it collaboratively would also eventually tend to emphasize robustness, modularity, optimization, simplicity, ease of building, ease of verification, and many other good attributes that are almost completely nonexistent in today&#8217;s large secretive market-driven monoculture, where the only thing that matters is making a buck off of it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213400">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213400">
						January 14, 2014 8:16 PM					</a>

				</p>

				<p>@Iain Moffat</p>
<p>Thanks for sharing your thoughts, unfortunately I&#8217;d say it is near on impossible for any normal user to know what functionality is included in any chip / card within a typical PC/laptop or router system.</p>
<p>In part this happens because exact functionality is often hidden from even the device manufactures. Chip making is a batch process so we inherently want to create a single device that can be customized by code for a variety of applications.  In today&#8217;s world that means that chips contain dedicated hardware for specific functions ADC&#8217;s, PLL&#8217;s, DAC&#8217;s, RF mixers, clock drivers &#8230;..ect additional to this they contain RAM, ROM , Flash and several CPU cores  (8085&#8217;s are very common as are ARM&#8217;s, Xcores, MIP&#8217;s, PiC&#8217;s and ADR&#8217;s) Many times the systems house is clueless about the existence of these support cores, All they typically see is the interface to the core that the chip maker makes available for manufactures customization.</p>
<p>Flash is often included as a stacked die (flash chip goes on top of SOC chip AND is often internally bonded as in you dont even see the pins externally)</p>
<p>The chip guys do not tell the manufactures what is inside the chip because they want to sell functionality rather then simply selling silicon by the yard (mm sq). Many times exactly the same chip is utilized for several products at the same manufacturer without the manufacturer even knowing this. To support this there are sticky bits and fuses that configure the chip (sometimes at the first boot), this means that as a chip guy I only really have to support one product  yet I can charge different amounts for each platform.  Helps enormously with profitability.</p>
<p>Now if you bother to Xray the chip you&#8217;ll see the Flash chip sitting on top, similarly if you bother to decap (remove black epoxy gunk) you&#8217;ll be able to see that the dies are identical for several different products.</p>
<p>The most extreme case I ever saw was when an ADC (analog to digital converter) that existed on a GSM chipset was sold as a stand-alone ADC, the chip was configured into a test mode whereby the ADC parallel output was observable on the chips IO pins.</p>
<p>I guess if nobody ever knew this than it does not represent a security risk BUT we know that the NSA is a long way ahead of the general public so I&#8217;d guess that they are very well aware of these tricks AND are fully aware of the hidden functions on the various chips.  In some ways it is easier to focus on the actual different die that a chip maker produces rather than get caught up in the whole obfuscation process. It seems to me that it makes sense for the NSA to just focus on the chip makers and focus on leveraging their chip firmware configuration processes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213401">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213401">
						January 14, 2014 10:39 PM					</a>

				</p>

				<p>@ DB</p>
<p>&#8220;Why the fixation on a non-writable BOISes? You want to order a new chip every time a bug is found in the code?&#8221;</p>
<p>How often do you update your BIOS? A physical switch blocking the electrical signals that make a write happen is an extremely cheap and simple way to minimize risk of BIOS compromise. The system can be booted into a clean state (eg LiveCD) before new BIOS is validated and installed. This update mode might also have almost all other functionality disabled and run things like the filesystem with all time-consuming (but effective) security checks on.</p>
<p>The alternative, which I&#8217;ve also promoted, is a dual BIOS design. One BIOS is read-only. One BIOS is writable (eg flash). The CPU boots from the read-only BIOS. This has a bootloader that loads other BIOS into memory, authenticates it, and transfers control if check is successful. The idea is that the first BIOS is simple enough to be made with high assurance techniques ensuring that replacing them a lot isn&#8217;t likely. The writable BIOS is where most of the firmware (or even initial kernel) is. It can be updated in a controlled way. This method has been used in a commercial system before.</p>
<p>The two ideas can even be combined. In any case, there are methods for making unauthorized writes to firmware hard or impossible. Some were used in older, inexpensive systems. There&#8217;s some today. That it&#8217;s not incompatible with commercial software business model makes it more likely to be accepted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213402">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213402">
						January 15, 2014 2:26 AM					</a>

				</p>

				<p>@ Nick P</p>
<p>‚Äú‚Ä¶it was identified as a potential attack channel back in the 90&#8217;s due to privileged nature. Just another weakness Intel couldn&#8217;t get rid of for backward compatibility is most likely explanation.‚Äù</p>
<p>Is ‚Äúbackward compatibility‚Äù like a banana up the rear? Either way we get screwed.</p>
<p>‚ÄúIntel&#8217;s radical i432 architecture solves tons of security problems at OS or app layers. Yet, market turned it down in favor of insecure, fast, backward compatible chips‚Ä¶ One could say they&#8217;ve been forced in certain direction by the market &amp; the market as a whole is getting what it deserved.‚Äù</p>
<p>Nick, as of now I have not seen Intel &#8220;getting what they deserved‚Äù such as lost revenue. Intel‚Äôs customers are getting it up rear-end (or getting what they deserved). At the end of the day we are less secure.</p>
<p>‚Äú‚Ä¶many 32-bit GB+ boards booted in real mode‚Ä¶‚Äù</p>
<p>That‚Äôs true. And, worse there are many popular 32 bit programs still running on Intel‚Äôs x86-64 architecture (after the OS being pwned on boot in real mode). I wonder what type of security hole this presents.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213403">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213403">
						January 15, 2014 2:49 AM					</a>

				</p>

				<p>@Nick P: what you just described seems to me more of a &#8220;limited writable&#8221; BIOS, rather than an &#8220;impossible to ever fix no matter how broken&#8221; BIOS.  I see no issue with properly-done hardware write-protection schemes, only an issue with burning half-baked code into a ROM chip that can then never be changed forever, and then integrated into an expensive motherboard.</p>
<p>I have flashed my BIOS or firmware in other devices on occasion.  Not too often, but it does happen.  It should be rare enough that allowing people the option to enforce physical access for an added security layer seems reasonable to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213404">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213404">
						January 15, 2014 2:51 AM					</a>

				</p>

				<p>@ DB,</p>
<p>As RobertT, Nick P, myself and others have pointed out now and quite a few times in the past on this blog, the &#8220;computing stack&#8221; is difficult to secure at best.</p>
<p>This is because of the &#8220;bubbling up&#8221; issue where the assumption is that each layer of the stack needs the layers below to be secure all the way down to the electrons wizzing around under quantum effects.</p>
<p>However the laws of physics tell us we cann&#8217;t (currently üòâ control these quantum effects all we can do is design around them to in effect mitigate them to a point where we can make usable devices. The laws of probability are not constrained to the electrons level either, it also applies at gate level &#8211;look up metastability&#8211; where latches amongst other basic logic devices need mitigation, which adds all sorts of complications to designs.</p>
<p>The point is device scientists and engineers know the only option is to mitigate. The problem is they have done a very good job, so much so that people working at higher levels of the computing stack belive in fully determanistic systems and further draw unwarrented conclusions about what can be done. This unfortunate assumption spills over into security and this in turn gives rise to the &#8220;bubbling up&#8221; issue.</p>
<p>What is worse is at higher levels we also tend to forget that even before the first electronic computer had been designed it had been proved in the 1930&#8217;s much to the dismay of mathmeticians and logicians that there are some things you just cannot do. One of which is that at any level in the computing stack it&#8217;s not possible at that level to determin if it is fully self consistant. Which boils down to an interesting argument about the futility of AV software, simply because it&#8217;s not possible for a computer to tell you it&#8217;s free of malware or for that matter free from defect either.</p>
<p>So contrary to the &#8220;bubbling up&#8221; belife, you cannot tell if the layers below are secure or not, you will always come to a point where the answer is expressed as a probability.</p>
<p>Contrary to the majority I tend to view it as not a hair pulling out disaster requiring the donning of sackcloth and ashes but a simple engineering issue.</p>
<p>That is like those working down close to the electron level I accept the issues and work out ways to mitigate them.</p>
<p>In this view I&#8217;m far from alone when you look at the history of the telecomms and space industries and likewise military wquipment supply requirments and modern high availability and high assurance systems.</p>
<p>So if you look at Nick P&#8217;s list above the first item is,</p>
<ul><i>1. A trusted main chip</i></ul>
<p>As RobertT has explained in the past the reality is with conventional design and production this is not possible for various human and technical reasons. And I suspect Nick P has said it to not get bogged down in details.</p>
<p>What it should say is,</p>
<ul><i>1. A mitigated main computing engine</i></ul>
<p>Which leaves the question of &#8220;how to mitigate&#8221; to get the required level of trust?&#8221;</p>
<p>In mythology there is the &#8220;guards riddle&#8221; where there are two guards and two seamingly identical doors. Unfortunatly behind one door lies certain death. If you do not know which you are permited to ask the guards one question. Unfortunatly one guard always lies the other always tells the truth, they will also kill you if you attempt to run away.</p>
<p>The solution to this riddle is to mitigate the lying guard to arive at the knowledge of which is the safe door. The way you do this is to ask a question that involves the answer of both guards, thus you know you will get a false answer which ever guard you ask. Thus the mythological question asked was to ask either guard &#8220;If I was to ask the other guard which door is certain death, which would he point to?&#8221; The guard will then point to the safe door to walk through (you can extend this to three or more guards providing you know how many of them are liers).</p>
<p>This &#8220;serial mitigation&#8221; can with more than two guards be done in parellel provided the number of lying guards is not the same as the number of truth telling guards. That is knowing if there are more or less lying guards you ask all guards to point to the certain death door and count how many guards point to either door. If the number of lying guards is greater than truth telling guards you walk through the door with the majority vote (it they are the minority you walk through the minority vote door).</p>
<p>This gives rise to the idea of voting protocols which appears to have originated out of the New York telephone company to improve system reliability and was then most often quoted as being used by NASA in space craft and launch systems. It&#8217;s also used on high high availability computer and high reliability military and industrial systems</p>
<p>Without going into all the ins and outs the minimum you need to start with is one computing engine that has been found to be reliable (as lier or truth teller) in operation by vigourus testing, you then work your way up to get three reliable systems that have as near as possible fully independent origins. This then provides the basis of your voting protocol system.</p>
<p>Provided they are of sufficiently independent origins then externaly injected malware can only effect one system at a time, so a disagrement will register untill all are infected. So if the system is immediately isolated on first error the malware will be caught and found.</p>
<p>Unfortunatly it does not stop &#8220;insider&#8221; injected malware if the voting system can be disabled and all three independant systems infected prior to the voting system being re-established.</p>
<p>One of the papers (&#8220;N-variant Systems&#8221;, cox et al, USNIX 2006) Nick P posted links to a few days ago talks about using a limited version using just two semi-idependent systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213405">

			<div class="comment by-qwertyuiop ">

				<p class="commentcredit">

					<span class="commenter">qwertyuiop</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213405">
						January 15, 2014 3:38 AM					</a>

				</p>

				<p>@sobrado &#8211; <i>&#8220;I would say you do not understand the open source model. No one asks each individual user to read and verify the source code himself. It is enough if the code has been audited by a few clever members of independent development teams&#8221;</i></p>
<p>I <b>do</b> understand the open source model and in an ideal world it <b>is</b> enough that the code can be verified by suitably qualified members of the community.</p>
<p>The problem is that we don&#8217;t live in an ideal world, never have. Unfortunately we now realise that it&#8217;s even further from ideal than we used to think!</p>
<p>What the open source model means in practice is that there <b>may</b> exist a version of the code that has been independently verified by people I&#8217;m prepared to trust and there is also a version of the code that I can download. They <b>may</b> be the same, they may not. If I&#8217;m not able to check for myself how do I know? OK, I can rely on MD5 or something similar but if the code can be replaced so can the checksum.</p>
<p>Am I paranoid? Yes! But it was only a little over a year ago many of us were being called paranoid for suggesting that the alphabet agencies around the world, but the UK and USA in particular, were intercepting vast amounts of traffic and now we don&#8217;t look so stupid after all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213406">

			<div class="comment by-db ">

				<p class="commentcredit">

					<span class="commenter">DB</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213406">
						January 15, 2014 4:26 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>That&#8217;s interesting.  I&#8217;m going to need to read it a few more times to digest that&#8230;</p>
<p>Along similar lines, I&#8217;ve also wondered if it might be possible to create a sort of &#8220;secure virtual machine&#8221; that can securely run on top of an insecure host environment, that would protect things inside it to some degree from insecurities around it&#8230;  If it could be made light enough it could even wrap individual programs in a secure blanket instead of a whole operating system&#8230;  panacea? of course not, but every bit helps&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213407">

			<div class="comment by-enkiv2 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://firstchurchofspacejesus.blogspot.com' rel='external nofollow ugc' class='url'>enkiv2</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213407">
						January 15, 2014 10:24 AM					</a>

				</p>

				<p>Conspiracy theory of the day: BANANAGLEE is BadBios üòâ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213408">

			<div class="comment by-marcos-el-malo ">

				<p class="commentcredit">

					<span class="commenter">Marcos El Malo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213408">
						January 15, 2014 11:17 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Thanks for the entertaining and clear explanation, perfect for this layman. I read about Kurt G√∂del in a philosophy class many years ago. That was the reference to what was proven in the 30s?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213409">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213409">
						January 15, 2014 12:45 PM					</a>

				</p>

				<p>@ 65535</p>
<p>&#8220;Is ‚Äúbackward compatibility‚Äù like a banana up the rear? Either way we get screwed.&#8221;</p>
<p>Haha I feel that way. To many customers, esp huge enterprise market, it&#8217;s the biggest selling point for a product. &#8220;Will all our existing software and systems continue to work when we add yours to the mix?&#8221; People who can&#8217;t say yes are often told to get lost. The net result: one must use similarly insecure stack to seemlessly interoperate with their existing components. There&#8217;s exceptions but that seems to be the rule.</p>
<p>&#8220;Nick, as of now I have not seen Intel &#8220;getting what they deserved‚Äù such as lost revenue. Intel‚Äôs customers are getting it up rear-end (or getting what they deserved). At the end of the day we are less secure.&#8221;</p>
<p>I was talking about the customers, not Intel. It&#8217;s the customers&#8217; fault whether they want to hear it or not. <b>Our IT industry is a capitalist, demand-driven industry. Security isn&#8217;t in demand [people pay for], so it isn&#8217;t produced.</b> I made the point before in a blog post where people asked why it USB sticks were so insecure by design and why manufacturers do nothing about it.</p>
<p><i>My assessment of situation in 2011 that still applies</i></p>
<p>&#8220;[It&#8217;s simple logic why systems are so insecure: ] Because manufacturers don&#8217;t focus on building secure systems. Why don&#8217;t they build secure systems? &gt;&gt;BECAUSE USERS DON&#8217;T BUY THEM!</p>
<p>Most users want the risk management paradigm where they buy insecure systems that are fast, pretty and cheap, then occasionally deal with a data loss or system fix. The segment of people willing to pay significantly more for quality is always very small and there are vendors that target that market (e.g. TIS, GD, Boeing and Integrity Global Security come to mind).</p>
<p>So, if users demand the opposite of security, aren&#8217;t capitalist system producers supposed to give them what they want? It&#8217;s basic economics Bruce. They do what&#8217;s good for the bottom line. The only time they started building secure PC&#8217;s en masse was when the government mandated them. Some corporations, part of the quality segment, even ordered them to protect I.P. at incubation firms and reduce insider risks at banks. When the government killed that [requirement] &amp; demand went low again, they all started producing insecure systems again. So, if user demand is required and they don&#8217;t demand it, who is at fault again? The user. They always were and always will be.</p>
<p>On the bright side, those same users are the reason I can send photo&#8217;s to friends on a thin, beautiful smartphone. They also gave us short-lived 1TB hard disks whose low cost made the short-lived part tolerable. They are also probably why I have a full-featured, fast, cheap wireless router at the home. So, at least some good comes from the users choices of demand. But, they definitely don&#8217;t accept the tradeoffs of real security, they don&#8217;t demand it, it doesn&#8217;t pay to produce it, &amp; that&#8217;s why it&#8217;s their fault. &#8221;</p>
<p><i>End of quote</i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213410">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213410">
						January 17, 2014 12:46 AM					</a>

				</p>

				<p>@ Marcos El Malo,</p>
<ul><i>I read about Kurt G√∂del in a philosophy class many years ago. That was the reference to what was proven in the 30&#8217;s?</i></ul>
<p>Yes, he, Church and Turing showed there were limits to what can be known with determanistic systems. And they based their work on that of Georg Cantor (diagonal argument for uncountable sets) from the 1870&#8217;s.</p>
<p>Cantor upset a lot of peoples &#8220;apple carts&#8221; in the mathmatical world and for that matter those in Christian churches as well. Whilst not as well known as Darwin he certainly had a similar effect on &#8220;mans understanding of his environment&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-213411">

			<div class="comment by-peter-gamache ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://github.com/kc0tfb' rel='external nofollow ugc' class='url'>Peter Gamache</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213411">
						January 20, 2014 11:05 AM					</a>

				</p>

				<p>There&#8217;s lots of speculation above about countermeasures, DIY systems to replace packaged VLSI, etc, etc.  Why is nobody talking about reliable detection methods?  Without backdoor detection, all other effort is fruitless &#8211; your adversary may have already subverted the system you thought you&#8217;d made clean (again).</p>
<p>There needs to be a secure DETECTION platform before there&#8217;s anything else.  Worrying about firewalls, checksums/signatures, etc is putting the cart before the horse.  Start by looking at the wire.  If it&#8217;s remotely controllable, it has to talk to something.  Environmental variables are also a clue; sudden changes in CPU load can be hidden from the OS, but thermal output cannot.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-213412">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/#comment-213412">
						January 20, 2014 1:11 PM					</a>

				</p>

				<p>@ Peter Gamache,</p>
<ul><i>If it&#8217;s remotely controllable, it has to talk to something</i></ul>
<p>True but the problem for a detection platform is &#8220;how&#8221; and is the platform capable of recognising it?</p>
<p>And the answer to that is very probably no, if the malware writer is half way competant.</p>
<p>There are basic domains for signaling in, where the information is impressed onto a carrier of some kind. The domains are,</p>
<p>1, Amplitude (AM etc)<br />
2, Frequency / phase (FM etc)<br />
3, Time (PWM, PPM, etc)<br />
4, Sequency (CDMA, SS, Walsh)<br />
5, Wavelet (UWB etc)</p>
<p>The carrier can be any energy signal be it direct or alternating, which carries out of a unit by conduction, radiation and in the case of thermal energy convection as well. Broadly they can be considered to be,</p>
<p>1, Electromagnetic (E&amp;H fields)<br />
2, Acoustic / mechanical<br />
3, Thermal<br />
4, Gravitational</p>
<p>We are aware of the NSA using the first two, we also know of low bandwidth attacks using the third, and although gravitational effects can be generated (by an appropriate quadrupole radiator) they are not currently exploitable for either transmission or reception of information as far as I&#8217;m aware.</p>
<p>Unfortunatly theinformation that gets impressed does not require a unique carrier. For instance information can be convayed by fractionaly modulating the transmission of another signal such as legitimate network packets. If the information is pre-encoded by a long cryptographic sequence &#8211;ie a stream cipher&#8211; it will not be possible to distinquish it except by refrence to an unmodulated signal source from within the unit. This may not be available if the signal bandwidth and modulation is below a certain threshold and injected into the unit from an external IO device such as the keyboard, because the unit is effectivly transparent. This is a consiquence of making a system as efficient as possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2014/01/souffletrough_n.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2014/01/souffletrough_n.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2014%2F01%2Fsouffletrough_n.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2014/01/souffletrough_n.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5160' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2014/01/how_the_nsa_thr.html" rel="prev">‚Üê How the NSA Threatens National Security</a>		<a href="https://www.schneier.com/blog/archives/2014/01/debunking_the_n.html" rel="next">Debunking the "NSA Mass Surveillance Could Have Stopped 9/11" Myth ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
