<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Jackpotting Attacks Against US ATMs - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Jackpotting Attacks Against US ATMs Comments Feed" href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/11452" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=11452' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2018%2F02%2Fjackpotting_att.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2018%2F02%2Fjackpotting_att.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-11452 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-11452" class="post-11452 post type-post status-publish format-standard hentry category-uncategorized tag-atms tag-malware tag-physical-security tag-tamper-detection tag-theft">

	<div class="article">

		<h2 class="entry">Jackpotting Attacks Against US ATMs</h2>
		<p>Brian Krebs is <a href="https://krebsonsecurity.com/2018/01/first-jackpotting-attacks-hit-u-s-atms/">reporting</a> sophisticated jackpotting attacks against US ATMs. The attacker gains physical access to the ATM, plants malware using specialized electronics, and then later returns and forces the machine to dispense all the cash it has inside.</p>
<blockquote><p>The Secret Service alert explains that the attackers typically use an endoscope &#8212; a slender, flexible instrument traditionally used in medicine to give physicians a look inside the human body &#8212; to locate the internal portion of the cash machine where they can attach a cord that allows them to sync their laptop with the ATM&#8217;s computer.</p>
<p>&#8220;Once this is complete, the ATM is controlled by the fraudsters and the ATM will appear Out of Service to potential customers,&#8221; reads the confidential Secret Service alert.</p>
<p>At this point, the crook(s) installing the malware will contact co-conspirators who can remotely control the ATMs and force the machines to dispense cash.</p>
<p>&#8220;In previous Ploutus.D attacks, the ATM continuously dispensed at a rate of 40 bills every 23 seconds,&#8221; the alert continues. Once the dispense cycle starts, the only way to stop it is to press cancel on the keypad. Otherwise, the machine is completely emptied of cash, according to the alert.</p></blockquote>
<p>Lots of details in the article.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/atms/" rel="tag">ATMs</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/physical-security/" rel="tag">physical security</a>, <a href="https://www.schneier.com/tag/tamper-detection/" rel="tag">tamper detection</a>, <a href="https://www.schneier.com/tag/theft/" rel="tag">theft</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html" rel="bookmark">Posted on February 1, 2018 at 6:23 AM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html#comments">24 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html" data-title="Jackpotting Attacks Against US ATMs" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-315495">

			<div class="comment by-dan-h ">

				<p class="commentcredit">

					<span class="commenter">Dan H</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315495">
						February 1, 2018 7:52 AM					</a>

				</p>

				<p>&#8220;The Secret Service alert says ATMs still running on Windows XP are particularly vulnerable, and it urged ATM operators to update to a version of Windows 7 to defeat this specific type of attack.&#8221;</p>
<p>If only OS/2 was still dominating the ATM market&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315496">

			<div class="comment by-dan-h ">

				<p class="commentcredit">

					<span class="commenter">Dan H</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315496">
						February 1, 2018 7:59 AM					</a>

				</p>

				<p>&#8220;In previous Ploutus.D attacks, the ATM continuously dispensed at a rate of 40 bills every 23 seconds,&#8221;</p>
<p>If the firewall has 3 access attempts in 5 seconds that fail then you block that IP.  Why not have the ATM stop dispensing cash if it dispenses 40 bills in 23 seconds?  If it&#8217;s still dispensing more bills after 23 seconds then they know it is a problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315497">

			<div class="comment by-fred ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html' rel='external nofollow ugc' class='url'>fred</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315497">
						February 1, 2018 9:28 AM					</a>

				</p>

				<p>Sticking with XP is a stupid decision. I can&#8217;t help but to think the cost certifying a new product to meet regulations is hurting innovation here.  If I&#8217;m correct, regulations are causing the very security problems they are designed to solve.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315498">

			<div class="comment by-scissors ">

				<p class="commentcredit">

					<span class="commenter">Scissors</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315498">
						February 1, 2018 9:39 AM					</a>

				</p>

				<p>@fred,<br />
To build on that thought, ATMs have the opposite problem most of the Internet of Things has: no regulation at all. This underscores the need to regulate wisely (not too much, not too little, not in stupid ways).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315499">

			<div class="comment by-impossibly-stupid ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.impossiblystupid.com' rel='external nofollow ugc' class='url'>Impossibly Stupid</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315499">
						February 1, 2018 9:47 AM					</a>

				</p>

				<p>@Dan H</p>
<blockquote><p>Why not have the ATM stop dispensing cash if it dispenses 40 bills in 23 seconds?</p></blockquote>
<p>Maybe they normally <em>do</em> have those sorts of checks in place, but the attack bypasses them.  The bigger question is why a machine as simple as an ATM gets built with a full-blown OS (of any kind) and apparently very little in the way of hardware failsafes.  If security mattered at all, there&#8217;s no way anyone with half a brain would leave it all up to software (and COTS at that).  Look for ATM fees to go up even further as we see this type of attack more and more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315500">

			<div class="comment by-keiner ">

				<p class="commentcredit">

					<span class="commenter">keiner</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315500">
						February 1, 2018 9:57 AM					</a>

				</p>

				<p>@fred,scissors</p>
<p>Never heard that banks are out of money. Never. Heard a lot on wrong decisions made out of pure greed or to safe a penny&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315501">

			<div class="comment by-vas-pup ">

				<p class="commentcredit">

					<span class="commenter">vas pup</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315501">
						February 1, 2018 10:00 AM					</a>

				</p>

				<p>@all:<br />
I was guessing that all ATMs in US and other developed countries do have video security camera which could capture image of attacker when (s)he physically get access to ATM internals. Just make capturing image angle of the camera wider.<br />
Or I am wrong on that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315502">

			<div class="comment by-jc ">

				<p class="commentcredit">

					<span class="commenter">jc</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315502">
						February 1, 2018 10:05 AM					</a>

				</p>

				<p>@Scissors</p>
<p>Nice haircut, not too long, not too short, but if you ask a barber, you always &mdash; err, umm, oh, I think those ATM robbers just substituted a garrote for that pair of scissors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315503">

			<div class="comment by-wayne ">

				<p class="commentcredit">

					<span class="commenter">Wayne</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315503">
						February 1, 2018 10:32 AM					</a>

				</p>

				<p>RE: XP.</p>
<p>A friend works for Diebold on ATMs, I expect he&#8217;s going to be busy after this.  He says that the ATM owner, i.e. the bank, is responsible for the ATM OS.  So the banks are the ones being morons about continuing to run XP.  I don&#8217;t know how accurate that is as he&#8217;s just starting the job.</p>
<p>And Krebs has posted an updated: One gang, there may be more, has been arrested.  They would partially disassemble the ATM, remove the HD, take it outside and the malware would be remotely loaded.  HD is reinstalled, jackpot.  By the ones actually running the scam installing the malware remotely, they know how much money is in the ATM to be spat out.</p>
<p>And no, you can&#8217;t put the computer inside the money vault.  The computer is secured in its own area that the ATM technician has keys to and presumably only the bank techs might, the money is in a vault that only the guards and armored car drivers have.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315504">

			<div class="comment by-petre-peter ">

				<p class="commentcredit">

					<span class="commenter">Petre Peter</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315504">
						February 1, 2018 10:35 AM					</a>

				</p>

				<p>This shouldn&#8217;t increase ATM fees since future ATMs need less features of the operating system not more. Since complexity is not a friend of security, then lowering the number of OS features needed in ATMs, should also lower the price of ATM fees.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315505">

			<div class="comment by-hmm ">

				<p class="commentcredit">

					<span class="commenter">hmm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315505">
						February 1, 2018 11:14 AM					</a>

				</p>

				<p>Physical access is step 1-2 of this attack.  Read and appreciate that.</p>
<p>XP is of course a joke but that&#8217;s not the point.  If they can get to an interface or a drive physically they might as well just physically get to the cash dispenser 1-2 feet in.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315506">

			<div class="comment by-callmelateforsupper ">

				<p class="commentcredit">

					<span class="commenter">CallMeLateForSupper</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315506">
						February 1, 2018 12:38 PM					</a>

				</p>

				<p>@Dan H<br />
&#8220;If only OS/2 was still dominating the ATM market.&#8221;</p>
<p>OMG!  I am <em>not</em> the only living being who knows what OS/2 is?  Well, there goes my book deal.  üòâ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315507">

			<div class="comment by-jeremy ">

				<p class="commentcredit">

					<span class="commenter">Jeremy</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315507">
						February 1, 2018 2:10 PM					</a>

				</p>

				<p>@Dan H</p>
<p><em>&gt; &#8220;If the firewall has 3 access attempts in 5 seconds that fail then you block that IP. Why not have the ATM stop dispensing cash if it dispenses 40 bills in 23 seconds? If it&#8217;s still dispensing more bills after 23 seconds then they know it is a problem.&#8221;</em></p>
<p>Imagine someone has built a dam on a river, holding back some huge amount of water.  Then they tell you that if there&#8217;s a flash flood, it might apply so much pressure that it breaks the dam, and all the water will flow through.</p>
<p>So you say &#8220;why not have the dam stop letting the water through if the flow rate is more than a certain amount?&#8221;</p>
<p>The ATM already has safeguards to stop the cash from being let out, and the crooks have already broken those safeguards.  It&#8217;s not that the dam is too stupid to realize that it <em>should</em> stop the water, it&#8217;s that the dam lacks the <em>ability</em> to stop the water, because we&#8217;re talking about a scenario where the dam has already been broken.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315508">

			<div class="comment by-k15 ">

				<p class="commentcredit">

					<span class="commenter">k15</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315508">
						February 1, 2018 2:32 PM					</a>

				</p>

				<p>If you see odd behavior that could possibly be related to this, who would you report it to?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315509">

			<div class="comment by-alejandro ">

				<p class="commentcredit">

					<span class="commenter">Alejandro</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315509">
						February 1, 2018 2:40 PM					</a>

				</p>

				<p>&#8220;&#8230;the ATM continuously dispensed at a rate of 40 bills every 23 seconds,&#8221; &#8230;(until)&#8230;. the machine is completely emptied of cash&#8230;&#8221;</p>
<p>Every time I go to the ATM I have that fantasy, too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315510">

			<div class="comment by-bigmacbear ">

				<p class="commentcredit">

					<span class="commenter">bigmacbear</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315510">
						February 1, 2018 3:51 PM					</a>

				</p>

				<p>@CallMeLateForSupper</p>
<p>You mean it doesn&#8217;t mean &#8220;half an operating system&#8221;? üôÇ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315511">

			<div class="comment by-65535 ">

				<p class="commentcredit">

					<span class="commenter">65535</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315511">
						February 1, 2018 4:20 PM					</a>

				</p>

				<p>@ Wayne and others</p>
<p>I have to agree the majority of your comments.</p>
<p>‚ÄúThey would partially disassemble the ATM, remove the HD, take it outside and the malware would be remotely loaded. HD is reinstalled, jackpot.‚Äù</p>
<p>A clear security SNFU.</p>
<p>That is what I understand. That is not easy and can be spotted by camera‚Äôs and individuals. I don‚Äôt think adding Win7 to Win10 would do much against the malware except possibly add bloatware and ASLR which is poorly enabled on Win machines. I will say there some hardened security templates that could have been used. But, if you can open a computer it is game over in general.</p>
<p>‚ÄúMicrosoft&#8217;s Windows Vista (released January 2007) and later have ASLR enabled for only those executables and dynamic link libraries specifically linked to be ASLR-enabled.[22] For compatibility, it is not enabled by default for other applications. Typically, only older software is incompatible and ASLR can be fully enabled by editing a registry entry &#8220;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\MoveImages&#8221;,[23] or by installing Microsoft&#8217;s Enhanced Mitigation Experience Toolkit.‚Äù-Wikipedia</p>
<p><a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization#Implementations" rel="nofollow ugc">https://en.wikipedia.org/wiki/Address_space_layout_randomization#Implementations</a></p>
<p>As a couple of Kreb‚Äôs commenter‚Äôs note:</p>
<p>‚Äú1‚Ä¶2‚Ä¶ then 3. The XFS protocol that the ATM computers use to speak with the cash dispenser does not authenticate. Meaning that you can hook a mini-pc up to the cash dispenser and send the XFS command to dispense and that‚Äôs it.‚Äù- JellyKid<br />
January 30, 2018 at 1:40 pm</p>
<p>Anybody care to explain the XFS protocol?</p>
<p><a href="https://krebsonsecurity.com/2018/01/drug-charges-tripped-up-suspects-in-first-known-atm-jackpotting-attacks-in-the-us/#more-42410" rel="nofollow ugc">https://krebsonsecurity.com/2018/01/drug-charges-tripped-up-suspects-in-first-known-atm-jackpotting-attacks-in-the-us/#more-42410</a></p>
<p>As I understand the attackers hit a standalone old NCR-Diebold Nixdorf machine in the Midwest where economic condition are poor.</p>
<p>‚ÄòAll of the known ATM jackpotting attacks in the U.S. so far appear to be targeting a handful of older model cash machines manufactured by ATM giant NCR-Diebold Nixdorf‚Ä¶&#8221;-Kerbs</p>
<p>&#8216;‚ÄúOften the malware requires entering of codes to dispense cash,‚Äù reads an FBI affidavit (PDF). ‚ÄúThese codes can be obtained by a third party, not at the location, who then provides the codes to the subjects at the ATM. This allows the third party to know how much cash is dispensed from the ATM, preventing those who are physically at the ATM from keeping cash for themselves instead of providing it to the criminal organization. The use of mobile phones is often used to obtain these dispensing codes.‚Äù‚Äô-Krebs</p>
<p><a href="https://krebsonsecurity.com/2018/01/drug-charges-tripped-up-suspects-in-first-known-atm-jackpotting-attacks-in-the-us/#more-42410" rel="nofollow ugc">https://krebsonsecurity.com/2018/01/drug-charges-tripped-up-suspects-in-first-known-atm-jackpotting-attacks-in-the-us/#more-42410</a></p>
<p>Thus, the Poutus.D malware has complex features that let the ‚Äúcontroller of the gang‚Äù know exactly the amount withdrawn and to sanction [sometimes brutally] their buddies who try to skim some of that cash. Krebs explains the malware is customize able for other machines, OS types,and features.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315512">

			<div class="comment by-hmm ">

				<p class="commentcredit">

					<span class="commenter">hmm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315512">
						February 2, 2018 1:13 AM					</a>

				</p>

				<p>If ASLR is all that&#8217;s keeping cash in cash machines, ATM-based civilization is screwed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315513">

			<div class="comment by-x2bike4u ">

				<p class="commentcredit">

					<span class="commenter">x2bike4u</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315513">
						February 2, 2018 9:15 AM					</a>

				</p>

				<p>The banks put up with the losses. The cost of remediation is probably a lot more than what they are loosing through these attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315514">

			<div class="comment by-uh-mike ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://xkcd.com/722' rel='external nofollow ugc' class='url'>uh, Mike</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315514">
						February 2, 2018 10:58 AM					</a>

				</p>

				<p>Physical control is the Achilles&#8217; heel of ATMs.  You have to allow the public to touch them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315515">

			<div class="comment by-mia ">

				<p class="commentcredit">

					<span class="commenter">Mia</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315515">
						February 2, 2018 4:05 PM					</a>

				</p>

				<p>@Dan H</p>
<blockquote><p>If the firewall has 3 access attempts in 5 seconds that fail then you block that IP. Why not have the ATM stop dispensing cash if it dispenses 40 bills in 23 seconds? If it&#8217;s still dispensing more bills after 23 seconds then they know it is a problem.</p></blockquote>
<p>Some ATMs only dispense $20 bills, and 40 of them is only $800. Some people do withdraw cash in those amounts, e.g. to pay building contractors (or even employees, at very small companies). A web search shows some US banks with $2000-$3000 ATM cash limits, so perhaps it could stop after that much‚Äîunless they intentionally allow overrides (maybe for preferred customers or if people call first).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315516">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315516">
						February 2, 2018 10:18 PM					</a>

				</p>

				<p>@hmm beat me to it, but essentially:</p>
<blockquote><p>They would partially disassemble the ATM, remove the HD, take it outside and the malware would be remotely loaded. HD is reinstalled, jackpot. By the ones actually running the scam installing the malware remotely, they know how much money is in the ATM to be spat out.</p></blockquote>
<p>The ATM security failed when they were able to pull the HD out. Does it even matter what the OS is?</p>
<p>Next step will be a custom *nix build that can drive the ATM hardware directly.</p>
<p>Attacking Windows XP here is pretty irrelevant I&#8217;d suggest!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-315517">

			<div class="comment by-cashless ">

				<p class="commentcredit">

					<span class="commenter">Cashless</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315517">
						February 4, 2018 3:34 AM					</a>

				</p>

				<p>After reconditioning these machines for 6 months as a student one summer, This is probably easier than you think. The HDD&#8217;s are 40GB IDE unencrypted and on there is a folder with the dispenser test scripts. One operates the dispenser on each note bank. This script can be run at any time regardless and does not communicate anything about it being run. Some machines operated on Windows NT4 as well.</p>
<p>We were shown all the physical vulnerabilities as it was assumed back then they were &#8216;too secure&#8217; to be remotely hacked. My favorite was the use of lighter gas. This was squirted into the cash slot and it would settle at the bottom of the safe. This was then lit with a fuse and it would blow the front door right off.</p>
<p>The door also had a pane of glass inside the mechanism that would break and double-lock if drilling out of the lock was attempted. No chance against gas though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-315518">

			<div class="comment by-a-winner-is-me ">

				<p class="commentcredit">

					<span class="commenter">A Winner Is Me</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/#comment-315518">
						February 8, 2018 5:13 PM					</a>

				</p>

				<p>Sometimes when I withdraw money from the ATM, I jump up and down shouting &#8220;I WON!!! I WON!!!&#8221; when the money comes out.</p>
<p>Maybe I oughta stop doing that for a while until the dust settles on this one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2018/02/jackpotting_att.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2018/02/jackpotting_att.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2018%2F02%2Fjackpotting_att.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2018/02/jackpotting_att.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='11452' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2018/01/israeli_scienti.html" rel="prev">‚Üê Israeli Scientists Accidentally Reveal Classified Information</a>		<a href="https://www.schneier.com/blog/archives/2018/02/signed_malware.html" rel="next">Signed Malware ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
