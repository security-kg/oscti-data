<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>TrueCrypt&#039;s Deniable File System - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; TrueCrypt&#039;s Deniable File System Comments Feed" href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/2369" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=2369' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F07%2Ftruecrypts_deni.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F07%2Ftruecrypts_deni.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-2369 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-2369" class="post-2369 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-cryptanalysis tag-cryptography tag-deniability tag-encryption tag-full-disk-encryption tag-truecrypt">

	<div class="article">

		<h2 class="entry">TrueCrypt&#039;s Deniable File System</h2>
		<p>Together with Tadayoshi Kohno, Steve Gribble, and three of their students at the University of Washington, I have  a <a href="http://www.schneier.com/paper-truecrypt-dfs.html">new paper</a> that breaks the deniable encryption feature of TrueCrypt version 5.1a.  Basically, modern operating systems leak information like mad, making deniability a very difficult requirement to satisfy.</p>
<blockquote><p><b>ABSTRACT:</b>  We examine the security requirements for creating a Deniable File System (DFS), and the efficacy with which the TrueCrypt disk-encryption software meets those requirements. We find that the Windows Vista operating system itself, Microsoft Word, and Google Desktop all compromise the deniability of a TrueCrypt DFS. While staged in the context of TrueCrypt, our research highlights several fundamental challenges to the creation and use of any DFS: even when the file system may be deniable in the pure, mathematical sense, we find that the environment surrounding that file system can undermine its deniability, as well as its contents. Finally, we suggest approaches for overcoming these challenges on modern operating systems like Windows.</p></blockquote>
<p>The students did most of the actual work.  I helped with the basic ideas, and contributed the threat model.  Deniability is a very hard feature to achieve.</p>
<blockquote><p>There are several threat models against which a DFS could potentially be secure:</p>
<ul>
<li>One-Time Access. The attacker has a single snapshot of the disk image. An example would be when the secret police seize Alice‚Äôs computer.
<li>Intermittent Access. The attacker has several snapshots of the disk image, taken at different times. An example would be border guards who make a copy of Alice‚Äôs hard drive every time she enters or leaves the country.
<li>Regular Access. The attacker has many snapshots of the disk image, taken in short intervals. An example would be if the secret police break into Alice‚Äôs apartment every day when she is away, and make a copy of the disk each time.</ul>
</blockquote>
<p>Since we wrote our paper, TrueCrypt released version 6.0 of its software, which <a href="http://www.truecrypt.org/docs/?s=hidden-operating-system">claims</a> <a href="http://www.truecrypt.org/docs/?s=hidden-volume-precautions">to</a> have addressed many of the issues we&#8217;ve uncovered.  In the paper, we said:</p>
<blockquote><p>We analyzed the most current version of TrueCrypt available at the writing of the paper, version 5.1a. We shared a draft of our paper with the TrueCrypt development team in May 2008. TrueCrypt version 6.0 was released in July 2008. We have not analyzed version 6.0, but observe that TrueCrypt v6.0 does take new steps to improve TrueCrypt‚Äôs deniability properties (e.g., via the  creation of deniable operating systems, which we also recommend in Section 5). We suggest that the breadth of our results for TrueCrypt v5.1a highlight the challenges to creating deniable file systems. Given these potential challenges, we encourage the users not to blindly trust the deniability of such systems. Rather, we encourage further research evaluating the deniability of such systems, as well as research on new yet light-weight methods for improving deniability.</p></blockquote>
<p>So we cannot break  the deniability feature in TrueCrypt 6.0.  But, honestly, I wouldn&#8217;t trust it.</p>
<p>There have been two <a href="http://www.darkreading.com/document.asp?doc_id=159192&#038;WT.svl=news2_1">news</a> <a href="http://www.pcworld.com/businesscenter/article/148513/data_can_leak_from_partially_encrypted_disks.html">articles</a> (and a Slashdot <a href="http://yro.slashdot.org/article.pl?sid=08/07/17/2043248">thread</a>) about the paper.</p>
<p>One talks about a generalization to encrypted partitions.  If you don&#8217;t encrypt the entire drive, there is the possibility &#8212; and it seems very probable &#8212; that information about the encrypted partition will leak onto the unencrypted rest of the drive.  Whole disk encryption is the smartest option.</p>
<p>Our paper will be presented at the <a href="https://131.106.3.253/events/hotsec08/index.html">3rd USENIX Workshop on Hot Topics in Security</a> (HotSec &#8217;08).  I&#8217;ve written about deniability <a href="https://www.schneier.com/blog/archives/2006/04/deniable_file_s.html">before</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/deniability/" rel="tag">deniability</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/full-disk-encryption/" rel="tag">full-disk encryption</a>, <a href="https://www.schneier.com/tag/truecrypt/" rel="tag">TrueCrypt</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html" rel="bookmark">Posted on July 18, 2008 at 6:56 AM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html#comments">73 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html" data-title="TrueCrypt&#039;s Deniable File System" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-93126">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93126">
						July 18, 2008 7:28 AM					</a>

				</p>

				<p>I never considered the plausible deniability claim by TrueCrypt to be accurate. I don&#8217;t think it is genuine plausible deniability.<br />
What is needed is a system in which the protected information, encrypted or not, cannot be proven by an adversary to even exist. As soon as an adversary encounters what is an OTS product, a password challenge, or what is obviously encrypted data, it&#8217;s all over. It doesn&#8217;t matter if the data is encrypted or how, or if the data is hidden on unformatted sectors. And any kind of password challenge is a complete giveaway. True plausible deniability is not easy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93127">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93127">
						July 18, 2008 7:36 AM					</a>

				</p>

				<p>The problem of &#8220;deniability&#8221; is not just MS OS&#8217;S but virtualy all multitasking OS&#8217;s.</p>
<p>It is to do with the trade off between efficiency and security.</p>
<p>As a rule of thumb (that I have yet to be seen broken) the more efficient a system then the less secure it is.</p>
<p>It is a more specific case of limited resources -v- security. That is the OS designers assume that resources are going to be limited in one way or another, for example system RAM is not going to be sufficient and also to slow, the result data is cached in both slower memory (hard disk) to make up for the lack of quantity and in much faster memory in the CPU.</p>
<p>Over and above the computer operating system is the windows manager and applications. The manager is designed in a similar way to the underlying operating system. This is because the applications are normaly designed to assume no resource limits and the windows manager and underlying OS must support this.</p>
<p>It is going to be difficult if not impossible to reverse this trend in design, except for very specialised security systems.</p>
<p>So the solution needs to be sought in another way.</p>
<p>That is where you have an operating system that makes the assumption that there is no hard disk to cache to and that the mutable storage is fragile (ie has very limited number of writes) such as Flash memory from a few years ago.</p>
<p>As an example an OS for a Diskless Client, or designed to run from ROM etc.</p>
<p>So &#8220;Knoppix&#8221; and a USB drive etc being the easiest to set up etc.</p>
<p>Also as several people will know NT based systems can be setup to run from ROM as well but it is not an every day task to do.</p>
<p>Obviously systems such as these, not having hard disks to write to, cannot leave traces on one.</p>
<p>The price is having to have a restricted system to work in where you might only be able to open one or two applications. Personaly I do not think this is a very high price to pay for the level of increased security you gain.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93128">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93128">
						July 18, 2008 7:37 AM					</a>

				</p>

				<p>I often wondered why boarder guards don&#8217;t ask for a defragmentation of Truecrypt volumes that may contain a hidden one. Then you can only deny plausible if you&#8217;ve got a good backup.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93129">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93129">
						July 18, 2008 7:37 AM					</a>

				</p>

				<p>Bruce, what about having a an hidden encrypted partition on a thumb drive?  Would the OS leak that information or would it be safer because it is on a removable drive?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93130">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93130">
						July 18, 2008 7:52 AM					</a>

				</p>

				<p>@ Alex,</p>
<p>&#8220;I often wondered why boarder guards don&#8217;t ask for a defragmentation of Truecrypt volumes that may contain a hidden one&#8221;</p>
<p>Defraging tools generaly have a very predictable behaviour, it would not be two difficult to design a hidden drive that would hide away at say the other end of the disk. As long as the user never put enough data onto the hard drive so that the hidden and normal data storage colided then no defraging would not touch the hiden data as it has nothing to shift (it does not know about the hidden data) and has no reason to move data upto the hidden area.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93131">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93131">
						July 18, 2008 8:08 AM					</a>

				</p>

				<p>With the price of hard drives today (since you can buy a hard drive for $200 today that is larger than the sum of all online storage for the entire earth cumulatively thru 1968 or so) it should be feasible to have a RAID-like array where significant quantities of information is hidden in the interaction of the bits that actually store other files. Of course I still dont know how you&#8217;d make that deniable once it was no longer obscure üôÅ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93132">

			<div class="comment by-davek ">

				<p class="commentcredit">

					<span class="commenter">DaveK</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93132">
						July 18, 2008 8:11 AM					</a>

				</p>

				<p>Homophone alert: you have the wrong kind of &#8216;principal&#8217; in footnote 3.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93133">

			<div class="comment by-rich-rumble ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://clearsite.sourceforge.net/' rel='external nofollow ugc' class='url'>rich rumble</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93133">
						July 18, 2008 8:28 AM					</a>

				</p>

				<p>@Mike, removable media may still leak the data as the paper pointed out, which in turn affects the deniablity of said data&#8230; Read section 4 and beyond on page 3 of the paper.<br />
-rich</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93134">

			<div class="comment by-merlin ">

				<p class="commentcredit">

					<span class="commenter">merlin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93134">
						July 18, 2008 8:43 AM					</a>

				</p>

				<p>The issues in your paper seem to apply more to Windows operating systems, which we all know were never built to be secure (and certainly not deniable).</p>
<p>In a sense, with Truecrypt 6.0 coming out a week ago, your paper is already obsolete.  Not only does the newer version allow for hidden operating systems (so that individual applications can no longer affect deniability) but hidden volume support has been added back into the Linux and MacOSX versions.</p>
<p>Also I think the Intermittent/Regular access attacks would be impossible if a hidden volume was nested inside another hidden volume (which would of course be in a Truecrypt container volume).</p>
<p>I would really love to see a follow-up paper, looking at Truecrypt 6.0 in particular:<br />
* a well-setup Linux machine (of particular interest, the /tmp directory on its own partition &#8211; perhaps encrypted &#8211; and periodically shredded),<br />
* the hidden OS mode,<br />
* nesting of hidden volumes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93135">

			<div class="comment by-bruce-schneier ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93135">
						July 18, 2008 8:48 AM					</a>

				</p>

				<p>&#8220;In a sense, with Truecrypt 6.0 coming out a week ago, your paper is already obsolete.&#8221;</p>
<p>I agree.</p>
<p>The general points are still valid, but an attack against an older version of TrueCrypt is much less interesting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93136">

			<div class="comment by-vwm ">

				<p class="commentcredit">

					<span class="commenter">vwm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93136">
						July 18, 2008 8:51 AM					</a>

				</p>

				<p>@Alex:</p>
<p>That depends on which one is more important to you: keeping the existence of the data secret or keeping the secret data existed&#8230;.</p>
<p>Furthermore, there is a legal question: are the ones that are searching you also allowed to tamper with / brake your stuff? UK authorities can force you to surrender the key to an encrypted drive &#8212; but are they allowed to destroy the drive simply to find out how you react? I don&#8217;t think so.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93137">

			<div class="comment by-stevej ">

				<p class="commentcredit">

					<span class="commenter">SteveJ</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93137">
						July 18, 2008 8:59 AM					</a>

				</p>

				<p>Less interesting to people already using the new version.</p>
<p>More interesting to any border guards etc. who have a bunch of full-disk images lying around out back that they can now re-analyse based on the new findings.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93138">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93138">
						July 18, 2008 9:04 AM					</a>

				</p>

				<p>BEWARE anytime someone says if only you used Linux, or anything NOT Microsoft, then you wouldn&#8217;t have any problems. It&#8217;s nonsense. They&#8217;re just repeating the same stuff they heard others say. Open Source is great, but most of the anti-MS crap is mindless university sub-culture.</p>
<p>Typically they will compare a flat Unix file system to a Windows system hosting various applications, then demo permissions, etc. Or, they&#8217;ll blab on and on about the kernel, etc. MS has definitely made mistakes, but they also went places no one else did. And they made it available to masses. Most vulnerabilities aren&#8217;t in the kernel to begin with. No matter what OS you use, as soon as you ask it to host an application the security is inherently weakened. And that goes for ANY system. Once you tell the OS to trust an application, or any one of a thousand applications with access to I/O, mem, etc. don&#8217;t compare a Unix kernel with a Windows system.</p>
<p>BTW, I am not interested in PD because I anticipate a confrontation with secret police, or any other sort of authority, nor because I store and carry illicit material.  It matters because the same aspects are valuable in detering an attacker &#8211; if they don&#8217;t even know it exists, they can&#8217;t hack it.</p>
<p>Even if a &#8220;hidden&#8221; file system is not obvious, if an OTS product such as TrueCrypt responds differently to one machine vs another, it is no longer hidden. And in many countries, what good will encryption do? They will just throw you in jail.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93139">

			<div class="comment by-stygmata ">

				<p class="commentcredit">

					<span class="commenter">Stygmata</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93139">
						July 18, 2008 9:12 AM					</a>

				</p>

				<p>I thought about this a bit on my own, and the solution that I think is practical to a certain extent is to use &#8220;portable&#8221; apps when you need to access your encrypted data.</p>
<p>Alice has her &#8220;deniable&#8221; volume, and she also carries a USB key, also disk-encrypted with a deniable volume, using WinPenPack or Portable Apps.  Each volume has a separate set of keys.  Alice practices a discipline such that she only accesses her encrypted data from the WinPenPack.</p>
<p>This of course will not alleviate the issues due to indexing and other OS operations on the deniable volume.  However, a potential solution to this as well would be to carry an entire encrypted virtual machine.  If the deniable volume only held a VM disk, such a disk does not readily expose data to the operating system.  To make the entire thing truly portable, though, one would need the VM component to be on the second, removable media device while the VM data resides on the computing device in a deniable volume.</p>
<p>I&#8217;m unsure if there is a practical combination of such tech available today &#8211; possibly if one had a bootable ISO of a Knoppix distribution on the removable media, with Xen or something similar compiled into the kernel.</p>
<p>I could envision such a package and method as being not <em>too</em> difficult to deploy and develop as a discipline, although it has significant practical disadvantages over simply accessing your encrypted volume from your primary OS on your primary device.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93140">

			<div class="comment by-nathan ">

				<p class="commentcredit">

					<span class="commenter">Nathan</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93140">
						July 18, 2008 9:16 AM					</a>

				</p>

				<p>The thing I found on the annoying side on the paper was they focused quite a bit on leaks in third party programs, not in truecrypt it self.   That should be by default a huge &#8220;DUH&#8221; &#8212; anyone who is paranoid about the security should know that MS and indexing programs will leak like a sieve. That is not a fault of Truecrypt (or other DFS).   You want secure, you use a bootable cd/dvd.  No chance of leak.</p>
<p>I did find the snapshot a very interesting proving vector.  Their isn&#8217;t a really good defense against that accept some sort of random swapping of sectors by truecrypt &#8212; but your talking some overhead to create the system so that it could handle sectors that move outside of the mounted volume.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93142">

			<div class="comment by-neill ">

				<p class="commentcredit">

					<span class="commenter">neill</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93142">
						July 18, 2008 9:28 AM					</a>

				</p>

				<p>what about a bootloader that would</p>
<p>1) after entering the correct password, boot your OS<br />
2) with a blank password boots a &#8216;clean&#8217; OS for TSA etc<br />
3) with the wrong one boots into self-destruct and starts erasing the disk (but keeps displaying nice XP screens to keep the intruder hopeing for success and gives it more time to erase)</p>
<p>i take my disk out of my dell (two screws and the tray slides out easily), and let my wife take it, so if anyone wants to see my laptop it&#8217;s just a useless piece of hardware!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93143">

			<div class="comment by-paul-a ">

				<p class="commentcredit">

					<span class="commenter">Paul A</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93143">
						July 18, 2008 9:46 AM					</a>

				</p>

				<p>Surely the existence of a entry in a Most Recently Used list, is proof that the file once existed. I had a tidy up of my desktop today so my MRU contains a lot of entries that point nowhere. Those files have now been deleted to DOD standards so truly do not exist. Is my denial of their existance plausible to you?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93144">

			<div class="comment by-rich-rumble ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://clearsite.blogspot.com/' rel='external nofollow ugc' class='url'>rich rumble</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93144">
						July 18, 2008 9:57 AM					</a>

				</p>

				<p>@neill The new version does most of that, two different passwords boot two different OS&#8217;s. The self destruct idea is interesting, but if TC 6 is a significant improvement, probably not necessary, especially if you use the &#8220;decoy&#8221; os as often or at least on the same days as you use the hidden os.<br />
-rich</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93145">

			<div class="comment by-michael-ash ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mikeash.com' rel='external nofollow ugc' class='url'>Michael Ash</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93145">
						July 18, 2008 10:05 AM					</a>

				</p>

				<p>@Steve</p>
<p>I think you may have misunderstood how TrueCrypt&#8217;s deniable filesystem works. The idea is that there are two separate filesystems. Which one you get depends on which password you enter. So the existence of a password prompt proves nothing. You just say that it&#8217;s for your encrypted drive which, of course, as a smart business traveler you keep for all of your important business documents. Then you put in your decoy password, which mounts your decoy filesystem with plausible business documents, and no real information.</p>
<p>Of course the fact that TrueCrypt is known to be able to have a decoy partition may then make your adversary suspicious, and he could go off looking for the hidden partition (which, I am told, is not as hidden as claimed if you look at things like HD sector access records) and use rubber hose cryptanalysis on you until you give up the real password.</p>
<p>I agree that true deniability is really tough, but TrueCrypt isn&#8217;t quite as obvious as you make it out to be.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93146">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93146">
						July 18, 2008 10:39 AM					</a>

				</p>

				<p>I&#8217;m curious &#8211; how does TrueCrypt prevent the decoy filesystem from overwriting data on the hidden one?</p>
<p>More specifically, when you have the decoy mounted and write to it, if the filesystem knows what blocks are allocated to the hidden system, then anyone given access to the decoy could prove that there is additional, hidden data.</p>
<p>If it doesn&#8217;t know what blocks are allocated for the hidden filesystem, then writing to the decoy could potentially overwrite and corrupt something hidden, and not having any recent modifications would be a good reason to suspect that you&#8217;re looking at the decoy data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93147">

			<div class="comment by-neill ">

				<p class="commentcredit">

					<span class="commenter">neill</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93147">
						July 18, 2008 10:53 AM					</a>

				</p>

				<p>@ ash</p>
<p>i used &#8220;defective sectors&#8221; in the past to hide data (marked as  def. by me) not a whole partition (few GB continous blocks are too easy to spot) &#8211; those sectors usually won&#8217;t be bothered by any OS</p>
<p>but then, anything your CPU can understand could be disassembled</p>
<p>i think real secure is only a hardware solution that remaps&amp;encrypts sectors depending on the password, maybe some nice disk-controller-firmware hack</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93148">

			<div class="comment by-stygmata ">

				<p class="commentcredit">

					<span class="commenter">Stygmata</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93148">
						July 18, 2008 11:26 AM					</a>

				</p>

				<p>Following up on my earlier comment:</p>
<p>Isn&#8217;t the real issue here &#8211; even aside from the OS &#8211; badly-behaved applications?</p>
<p>If you are using your primary device&#8217;s OS and apps to access your deniable filesystem, then any MRU or other pointers left by the apps you used to access it serve to defeat your security, by pointing to the (now-empty) location left behind when Alice dismounted her deniable filesystem.</p>
<p>Windows is a poor environment to enforce that security, because application behavior and security is highly fragmented and not subjected to a central API (MacOS comes closer to this &#8211; or even the iPhone) that would govern how those MRU&#8217;s and file data can and would be cleaned up after access.</p>
<p>Again, it would seem that the real solution here to the issue would be to either use truly portable apps (assuming you can somehow sandbox your encrypted volume from the regular OS), or to use an entirely virtual client system to access your encrypted data.  How else are you going to enforce the needed trust?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93149">

			<div class="comment by-merlin ">

				<p class="commentcredit">

					<span class="commenter">merlin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93149">
						July 18, 2008 11:28 AM					</a>

				</p>

				<p>@Steve:<br />
&#8220;BEWARE anytime someone says if only you used Linux, or anything NOT Microsoft, then you wouldn&#8217;t have any problems. It&#8217;s nonsense. They&#8217;re just repeating the same stuff they heard others say. Open Source is great, but most of the anti-MS crap is mindless university sub-culture.&#8221;</p>
<p>Sure, sometimes.  However is this instance the truth is that the vulnerabilities in Bruce&#8217;s paper apply to Windows, and <em>cannot</em> necessarily be mapped onto Linux.  The strict file permissions, and mounting of separate partitions in Linux gives it a clear edge, security-wise.  Re-iterating some of the risks in the paper:<br />
1. virtual memory (swap file)<br />
 &#8211; in Linux, just turn the thing off (swapoff -a) before you decrypt the drive.  Also on Linux, as the swap file is actually a partition it won&#8217;t move around the disk, so you can securely shred it periodically.</p>
<ol>
<li>programs writing files all-over the place
<ul>
<li>file permissions mitigate this issue.  Let&#8217;s say my home directory /home/USER is an encrypted hidden partition.  I might be working on some documents in there, and I know there is a chance autosave files will go elsewhere on the filesystem &#8211; but where?  Well the default permissions only allow a user to write to their own home directory (which in this case is encrypted) or to /tmp.  You can encrypt /tmp using Truecrypt, or you can temporarily disable it by mounting it in RAM so that on reboot the data is lost.</li>
</ul>
</li>
</ol>
<p>Windows does not provide any of the above abilities, it does not have the same flexibility because it has a different target audience.   As a result of this it is more difficult to keep it under control.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93150">

			<div class="comment by-patrick-cahalan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://padraic2112.wordpress.com' rel='external nofollow ugc' class='url'>Patrick Cahalan</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93150">
						July 18, 2008 11:32 AM					</a>

				</p>

				<blockquote><p>
  The students did most of the actual work.
</p></blockquote>
<p>Now I know why Bruce went corporate over academia.  C&#8217;mon, Bruce, don&#8217;t you know that this sort of admission is verboten! üòâ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93151">

			<div class="comment by-merlin ">

				<p class="commentcredit">

					<span class="commenter">merlin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93151">
						July 18, 2008 11:39 AM					</a>

				</p>

				<p>&#8220;Isn&#8217;t the real issue here &#8211; even aside from the OS &#8211; badly-behaved applications?<br />
&#8230;<br />
Again, it would seem that the real solution here to the issue would be to either use truly portable apps (assuming you can somehow sandbox your encrypted volume from the regular OS), or to use an entirely virtual client system to access your encrypted data. How else are you going to enforce the needed trust?&#8221;</p>
<p>No &#8211; the problem is the OS.  All the individual applications in the world cannot be expected to be &#8220;polite&#8221;, based on the assumption that one of their users might to trying to achieve deniable encryption.  Many of the application developers do not understand procedural security.  Take for example a Family Tree making application &#8211; is the author really going to care about a temporary file giving away the mere existence of a directory?  Of course not.</p>
<p>The behaviour of applications has to be enforced by the OS and by the filesystems.  Windows should probably have a secure mode which, when activated, severely restricts where programs can write files.  This would restrict what programs can run to only the &#8220;well behaved ones&#8221; you mention, but it is the only way (without hidden OS) to keep deniability.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93152">

			<div class="comment by-patrick-cahalan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://padraic2112.wordpress.com' rel='external nofollow ugc' class='url'>Patrick Cahalan</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93152">
						July 18, 2008 11:39 AM					</a>

				</p>

				<p>@ Merlin</p>
<blockquote>
<ol>
<li>virtual memory (swap file) &#8211; in Linux, just turn the thing off<br />
  (swapoff -a) before you decrypt the drive.</li>
</ol>
</blockquote>
<p>This is a workaround, not a solution.  And really, if your encryption tools require the user to do something to the operating system before you use them, they don&#8217;t work.  (P.S. -&gt; you can easily turn off the paging file in Windows)</p>
<blockquote>
<ol>
<li>programs writing files all-over the place &#8211; file permissions<br />
  mitigate this issue.</li>
</ol>
</blockquote>
<p>No, it doesn&#8217;t.  Trying to solve this problem with file permissions just means you&#8217;re going to wind up having things fail because they can&#8217;t write where the programs expect to be able to write.  This isn&#8217;t a &#8220;windows&#8221; problem, it&#8217;s a &#8220;people who write software for windows&#8221; problem.  Well behaved Windows applications write everything to the user&#8217;s profile, which has been the default location for many years now.</p>
<p>It&#8217;s also not a relevant differentiation between UNIX and Windows because you could take this &#8220;deny write permission&#8221; tack on both OSes.  (In fact, one of the rare advantages of Windows over UNIX is that the NTFS ACL&#8217;s have more group and user level security settings on NTFS, they&#8217;re just rarely used properly).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93153">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter">Carlo Graziani</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93153">
						July 18, 2008 11:46 AM					</a>

				</p>

				<p>I thought the paper was very clear and readable.  My main reaction &#8212; these vectors would be better-handled though virtual machines than through custom boot loaders &#8212; seems to have been covered by stygmata above.</p>
<p>As far as merlin&#8217;s comments on Linux-based leakage vectors are concerned, I would add that many Linux distributions package a version of mlocate/updatedb, which indexes &#8212; as root &#8212; all files on all available hard drives.  If the nightly cron-based update should happen to run while the hidden volume is mounted, you&#8217;re busted.  So, if you&#8217;re hiding a volume under Linux, take updatedb out of cron, or even better, uninstall it altogether.  &#8216;find&#8217; won&#8217;t work for you anymore, but then again it won&#8217;t work for the secret police either.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93154">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter">Carlo Graziani</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93154">
						July 18, 2008 11:46 AM					</a>

				</p>

				<p>I thought the paper was very clear and readable.  My main reaction &#8212; these vectors would be better-handled though virtual machines than through custom boot loaders &#8212; seems to have been covered by stygmata above.</p>
<p>As far as merlin&#8217;s comments on Linux-based leakage vectors are concerned, I would add that many Linux distributions package a version of mlocate/updatedb, which indexes &#8212; as root &#8212; all files on all available hard drives.  If the nightly cron-based update should happen to run while the hidden volume is mounted, you&#8217;re busted.  So, if you&#8217;re hiding a volume under Linux, take updatedb out of cron, or even better, uninstall it altogether.  &#8216;locate&#8217; won&#8217;t work for you anymore, but then again it won&#8217;t work for the secret police either.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93155">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter">Carlo Graziani</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93155">
						July 18, 2008 11:48 AM					</a>

				</p>

				<p>Sorry about the double post, I thought I stopped the first one after submitting it with a typo (&#8216;find&#8217; instead of &#8216;locate&#8217;).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93156">

			<div class="comment by-cragins ">

				<p class="commentcredit">

					<span class="commenter">CraginS</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93156">
						July 18, 2008 11:57 AM					</a>

				</p>

				<p>vwm said:<br />
&#8220;That depends on which one is more important to you: keeping the existence of the data secret or keeping the secret data existed&#8230;.&#8221;</p>
<p>What if the DFS had two passwords? The first open the DFS normally. The second, an &#8220;extreme duress password&#8221; appears to open the DFS normally, but activates a data destruction routine that deletes or overwrites a selected subset of the data in the DFS.<br />
  The user would maintain obviously sensitive data in the normal DFS area, but also maintain critical high sensitivity data in this emergency destruct area.<br />
  The user would have given up the first DFS password only under duress, anyway. That means the user is already up a creek without a paddle relative to the attackers / authorities knowing there was an intentional attempt to hide data.<br />
   If the attackers do not realize the double-wrapped data was deleted as they opened the DFS, they are happy because they found the cloaked data. The user is found out, and will be prose- or perse-cuted as appropriate by the attackers for having hidden the data. However, the user is happy that the truly sensitive data has been destroyed and not fallen into the hands of the attackers.<br />
   If the attackers do become aware of the existence of the destroyed data, then they may be even more upset at the user, BUT&#8230;<br />
   The user was already in trouble with them, anyway, for trying to sneak data past them, and, that data still is denied to the attackers because it got destroyed during the process of opening the DFS. The user will face the same hell as in the first case, and still has prevented the attackers from seeing the highly sensitive data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93157">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93157">
						July 18, 2008 12:12 PM					</a>

				</p>

				<p>@ Merlin, Patrick Cahalan,</p>
<p>The problem is below the application level for good reason (as I noted above).</p>
<p>It could be argued in some cases that some of the problems are even below the OS level, in that some Device Drivers that cache data for multi-phase commit etc will also cause problems.</p>
<p>However the main problem for uncontroled and unpredictable information leakage at the OS level is data buffers in the kernal&#8230;</p>
<p>That is when data is writen to a hard disk it may not be a full diskblock in size, likewise it may not be a full OS buffer in size either. Some OS&#8217;s but most don&#8217;t clean out buffers after a write to disk to ensure that sensitive data does not get left to be writen out somewhere else on disk.</p>
<p>As I noted above efficiency and security are usually in conflict, efficiency says don&#8217;t zero the buffer security says zero it. In this &#8220;performance driven&#8221; marketplace which do you think is going to get priority in a general purpose multi tasking OS?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93158">

			<div class="comment by-merlin ">

				<p class="commentcredit">

					<span class="commenter">merlin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93158">
						July 18, 2008 12:26 PM					</a>

				</p>

				<blockquote><p>
  This is a workaround, not a solution. And<br />
  really, if your encryption tools require the<br />
  user to do something to the operating system<br />
  before you use them, they don&#8217;t work. (P.S. &gt; &gt; you can easily turn off the paging file in<br />
  Windows)
</p></blockquote>
<p>No, it is not a workaround.  It&#8217;s a procedural security measure.  Passwords for examlpe require the user does not write them on post-it nots and stick them on the desk.</p>
<p>You can turn swapping off on Windows, but it requires a restart.  On Linux you can swapon/swapoff whenever you like.  Also the usage of the virtual memory is completely different on Linux and Windows&#8230; even if you have 2GB of RAM Windows will still use VM, however Linux only uses it once the memory gets 70-80% full.</p>
<blockquote><p>
  Trying to solve this problem with file<br />
  permissions just means you&#8217;re going to wind<br />
  up having things fail because they can&#8217;t write<br />
  where the programs expect to be able to<br />
  write.<br />
  Err no.  On Windows yes, but as I&#8217;ve already said Windows (or rather the backwards compatibility of Windows) is the problem.  There are many other OSes out there which effectively and securely implement proper file permissions and DON&#8217;T have programs crashing as a result.</p>
<p>  This isn&#8217;t a &#8220;windows&#8221; problem, it&#8217;s a<br />
  &#8220;people who write software for windows&#8221;<br />
  problem. Well behaved Windows applications<br />
  write everything to the user&#8217;s profile, which<br />
  has been the default location for many years<br />
  now.
</p></blockquote>
<p>But there is no <em>enforcement</em> to write to the user&#8217;s profile.  Also the user would have to edit a registry setting to put the Documents and Settings folder on an encrypted partition.</p>
<blockquote><p>
  It&#8217;s also not a relevant differentiation<br />
  between UNIX and Windows because you<br />
  could take this &#8220;deny write permission&#8221; tack<br />
  on both OSes.<br />
  Yeah &#8211; my point is that Linux (and BSD etc) already <em>do</em> take this deny write permission.  It is mature and it works &#8211; we don&#8217;t have programs crashing because they can&#8217;t write to /xyz&#8230; because they never could write to xyz.</p>
<p>  (In fact, one of the rare<br />
  advantages of Windows over UNIX is that the<br />
  NTFS ACL&#8217;s have more group and user level<br />
  security settings on NTFS, they&#8217;re just rarely<br />
  used properly).
</p></blockquote>
<p>ACLs are not really a security advantage &#8211; as when networks get large enough they are far too complex to properly analyse.  I have worked as a Server Engineer on both Windows and Linux, and I can say that general policy is to avoid ACLs is possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93159">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93159">
						July 18, 2008 12:32 PM					</a>

				</p>

				<p>@ CraginS,</p>
<p>&#8220;The user will face the same hell as in the first case, and still has prevented the attackers from seeing the highly sensitive data.&#8221;</p>
<p>I would not be to sure on that, hidding data that is not &#8220;criminal&#8221; but just say comercialy / politicaly sensitive, is effectivly a slap on the wrists in a lot of places.</p>
<p>Destroying evidence is most definatly a criminal offence in just about every place I can think of. In some places it could be argued that what you have destroyed was (for arguments sake) a terorist plot.. And having destroyed it how are you going to argue / prove otherwise?  As a result you could be looking at an indefinate period in an open air cage just outside the U.S.A as a guest of the armed forces without ever having seen a judge or a jury&#8230;</p>
<p>Unless anybody can come up with a better argument, I would say unless you know for sure that the data is going to get you a long time in jail (ie it&#8217;s criminal), I would keep the data encrypted and work your way through the process untill you arive at a court/judge then show them that you are telling the truth (ie it&#8217;s comercialy sensitive). The chances are you are going to be in a lot less trouble and more importantly your data can be kept sealed by court order.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93160">

			<div class="comment by-col-hectorgmail-com ">

				<p class="commentcredit">

					<span class="commenter">col.hector@gmail.com</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93160">
						July 18, 2008 2:42 PM					</a>

				</p>

				<p>True deniability is very difficult, if at all possible. At least TrueCrypt&#8217;s developers are putting in effort towards achieving this goal&#8230; and not for profit.</p>
<p>Yes, perhaps due to marketing exaggeration or ignorance, some might interpret TrueCrypt as promising or guaranteeing full security.<br />
Ahhh, the marketing&#8230; all those happy and smiling people in the ad&#8230; no matter how crappy or insignificant the product is. Have you seen anyone walking around similing all day because they switched to the advertised brand of cereal?<br />
If you consider functionality-to-price ratio TrueCrypt is far superior to PGP and lots others.<br />
Personally I wouldn&#8217;t trust PGP since that&#8217;s buying &#8220;a cat in a bag&#8221;.</p>
<p>I deal with enough technological dumb-asses whose attitude is &#8220;I don&#8217;t care&#8221; (until shit hits the fan and then it&#8217;s someone else&#8217;s fault), that I really don&#8217;t care what Joe-public thinks.<br />
What you don&#8217;t know can hurt you, so do your research yourself, experiment with it, try to break it and put it back together, etc. and don&#8217;t let one entity tell you what to do based on their opinions and prejudices.</p>
<p>I follow this site off-and-on, and I&#8217;ve seen someone ask Bruce if he&#8217;s looked at TrueCrypt. Has he? You never know, he might actually like it, I&#8217;m really curious&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93161">

			<div class="comment by-greatorwhat ">

				<p class="commentcredit">

					<span class="commenter">GreatOrWhat?</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93161">
						July 18, 2008 4:02 PM					</a>

				</p>

				<p>yo, great&#8230; Bruce discovered 2008 TrueCrypt. Security guru de la creme üòâ</p>
<p>Hey guys, crypt the <em>bootdisk</em></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93162">

			<div class="comment by-john-smith ">

				<p class="commentcredit">

					<span class="commenter">john smith</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93162">
						July 18, 2008 5:32 PM					</a>

				</p>

				<p>@neil, I like your line of thinking, but would like to see something else.</p>
<p>Instead of being prompted to enter a password, you boot straight into a clean, unencrypted OS that has no trace of TrueCrypt being installed under that OS.</p>
<p>I would like to have it so have you press and hold a certain key combination, that&#8217;s customizable so it&#8217;s not some standard key or key-combo, then you get the password prompt.  That behaves just as TrueCrypt 6.x does now.</p>
<p>You would then use the unencrypted OS most of the time, the &#8220;visible&#8221; encrypted OS a fair amount of the time and the hidden OS only for that data you truly wanted to keep hidden.</p>
<p>This would help any TSA person from seeing that you have &#8220;something to hide&#8221; (at least from their minimum wage, uneducated, I couldn&#8217;t become a cop, I like to feel people up and I happen to not use drugs, eyes), while still keeping your private data private.</p>
<p>Yes, if someone did an analysis of the hard drive they&#8217;d still find there&#8217;s something there, probably encrypted and with enough digging, by inspecting the MBR, they&#8217;d probably see that you at least are using TrueCrypt (or any other disk encryption technology) and thus you could be guilty until proven innocent.</p>
<p>I think just the fact alone that you have an encrypted disk prevents any possible &#8220;plausible deniability&#8221;, especially if you are using OTS software where it&#8217;s feature set is a known.  If you have the skills to create custom software that can perform disk encryption, then yes, you might be able to pull of &#8220;plausible deniablity&#8221;, but even then I think it would be difficult and only be as effective for as strong as your will is.  If you are being held by legal police you&#8217;re probably fine.  If you are being held by a criminal or terrorist organization, well it&#8217;ll probably be your life or your data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93163">

			<div class="comment by-neill ">

				<p class="commentcredit">

					<span class="commenter">neill</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93163">
						July 18, 2008 6:38 PM					</a>

				</p>

				<p>@john smith:<br />
let&#8217;s say you had a bios that asks for the password, relays the hash to the disk controller to use as a key for aes (or blowfish, bruce!) and remaps sectors depending on blank/noblank password (there&#8217;s only one specific hash for a blank one) &#8211; then you wouldn&#8217;t even find the mbr anymore, and an intruder would find a nice clean OS but analysis of the disk shows &#8220;garbage&#8221; (best case:&#8221;white noise&#8221;)<br />
personally at this time in my life nothing is worth loosing it over some data though (baby V0.3)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93164">

			<div class="comment by-joel ">

				<p class="commentcredit">

					<span class="commenter">Joel</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93164">
						July 18, 2008 7:46 PM					</a>

				</p>

				<p>To me this is all a forest for the trees thing.  The real question is: Do you want the bad guys to not get to your data or do you want them to not even suspect that there is data?  If it&#8217;s the latter you&#8217;d do better disguising a usb stick as a ball point pen.  You wouldn&#8217;t even have to encrypt the thing.<br />
Many of the scenarios described here just scream &#8220;I&#8217;m hiding something!&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93165">

			<div class="comment by-sean-ohara ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://diogenes-sinope.blogspot.com' rel='external nofollow ugc' class='url'>Sean O&#039;Hara</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93165">
						July 18, 2008 10:51 PM					</a>

				</p>

				<p>@Stygmata</p>
<p>&#8220;Isn&#8217;t the real issue here &#8211; even aside from the OS &#8211; badly-behaved applications? &#8221;</p>
<p>Is a program that keeps a record of your most recently opened applications badly-behaved or user-friendly? I think most people would vote for the latter.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93166">

			<div class="comment by-surface-mount ">

				<p class="commentcredit">

					<span class="commenter">surface mount</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93166">
						July 19, 2008 6:50 AM					</a>

				</p>

				<p>&#8220;If it&#8217;s the latter you&#8217;d do better disguising a usb stick as a ball point pen.&#8221;</p>
<p>@Joel</p>
<p>If I really, really wanted to hide a flash memory chip, I&#8217;d solder it right next to bunch of other chip packages.  It&#8217;s actually somewhat expensive to tell what any particular chip does unless you read the part number and pull the datasheet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93167">

			<div class="comment by-merlin ">

				<p class="commentcredit">

					<span class="commenter">merlin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93167">
						July 19, 2008 7:13 AM					</a>

				</p>

				<p>&#8220;Many of the scenarios described here just scream &#8216;I&#8217;m hiding something!'&#8221;</p>
<p>Like having Truecrypt installed in the first place&#8230; why did you use Truecrypt, rather than the OS builtin encryption (MacOSX &#8211; Vault; Windows &#8211; BitLocker; Linux &#8211; DMCrypt)?  The way things are going these days, I can see the courts arguing that having Truecrypt installed is enough to assume someone does have a hidden volume.  Actually in the UK now you can be forced to hand over encryption keys or face 5 years in jail (oh &#8211; sorry, unless you can prove that you don&#8217;t know them)&#8230; Put all this together: if Truecrypt is on a system they could start jailing people on the assumption that they have hidden volumes.</p>
<p>The only thing close to a solution would be to keep Truecrypt on a (read-only) CD.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93168">

			<div class="comment by-jdbertron ">

				<p class="commentcredit">

					<span class="commenter">jdbertron</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93168">
						July 19, 2008 9:39 AM					</a>

				</p>

				<p>Plausible Deniability should be impossible without off-line storage.<br />
You just can&#8217;t store X and Y in the space it takes to store only X. Otherwise you&#8217;ve discovered a nice new infinite compression method.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93169">

			<div class="comment by-joel ">

				<p class="commentcredit">

					<span class="commenter">Joel</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93169">
						July 19, 2008 8:46 PM					</a>

				</p>

				<p>Two other separate issues I&#8217;ve been considering are:</p>
<p>(1)  Are you hiding your data just for your own peace of mind; or<br />
(B)  You&#8217;re James Bond and you&#8217;d rather the data died (with you) rather than be revealed.</p>
<p>In (1) loss is no big deal, you could use rot13 and the (purse snatcher?) probably wouldn&#8217;t figure it out.  Or Big Brother would spare no expense deciphering your, uh, porn collection.  In either case all this high-power encryption is pointless &#8211; nobody really cares.</p>
<p>Point (B) is what counts.  What do any of us really know that we&#8217;d take a rubber-hose beating for?  Heck, I&#8217;ll give you my porn just by your asking for it.  Corporate data?  It&#8217;s a foreign language to most anyone outside the company.  Drug dealer data?  Give up the password and you&#8217;ve got a ticket to immunity.<br />
So what&#8217;s left?  Military espionage?  Assassination plots?  Kitty porn?  Terrorism?</p>
<p>So unless this is all an esoteric argument then someone tell me why I need a hidden OS with a DFS and an external drive disguised as a cigar box unless I&#8217;m <em>really</em> up to no good, which should trouble all of us.</p>
<p>&#8220;surface mount&#8221; got it right: a fistful of micro SD cards hot glued to a motherboard would fool %98.8 of the security in the world &#8211; they don&#8217;t even look at &#8220;raw&#8221; electronics; I&#8217;ve carried bare SATA drives through many airports with no incident &#8211; if it doesn&#8217;t have a power button they don&#8217;t care.  So why bother with all this?<br />
Disclosure:  I do use TCrypt, in case of loss or theft, but unless we&#8217;re overthrowing a gov&#8217;t this all seems like overkill (even if it&#8217;s very interesting reading, I love this stuff).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93170">

			<div class="comment by-thought-police ">

				<p class="commentcredit">

					<span class="commenter">thought police</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93170">
						July 19, 2008 10:01 PM					</a>

				</p>

				<p>Disclosure: I do use TCrypt, in case of loss or theft, but unless we&#8217;re overthrowing a gov&#8217;t this all seems like overkill (even if it&#8217;s very interesting reading, I love this stuff).</p>
<p>You couldn&#8217;t pick your nose without a computer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93171">

			<div class="comment by-joel ">

				<p class="commentcredit">

					<span class="commenter">Joel</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93171">
						July 19, 2008 10:04 PM					</a>

				</p>

				<p>@thought police<br />
Actually I use needle-nosed pliers.  What&#8217;s your problem?!?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93172">

			<div class="comment by-redfox ">

				<p class="commentcredit">

					<span class="commenter">Redfox</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93172">
						July 19, 2008 10:34 PM					</a>

				</p>

				<p>That remides me of:<br />
&#8220;StegFS &#8211; A Steganographic File System for Linux</p>
<p>StegFS is a Steganographic File System for Linux. Not only does it encrypt data, it also hides it such that it cannot be proved to be there.&#8221;</p>
<p><a href="http://www.mcdonald.org.uk/StegFS/" rel="nofollow ugc">http://www.mcdonald.org.uk/StegFS/</a></p>
<p>It might be an suitable FileSystem inside of a TrueCrypt-Container.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93173">

			<div class="comment by-carey-underwood ">

				<p class="commentcredit">

					<span class="commenter">Carey Underwood</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93173">
						July 20, 2008 5:51 AM					</a>

				</p>

				<p>Thorough introduction to the issues involved:  <a href="http://www.csl.sri.com/users/neumann/ncs92.html" rel="nofollow ugc">http://www.csl.sri.com/users/neumann/ncs92.html</a></p>
<p>It&#8217;s has a slightly different focus, but the problems are the same.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93174">

			<div class="comment by-rich-rumble ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://clearsite.sourceforge.net/' rel='external nofollow ugc' class='url'>rich rumble</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93174">
						July 20, 2008 7:18 AM					</a>

				</p>

				<p>My Company and several others I&#8217;ve worked for, encrypt the entire HD of their laptops&#8230; Is my company hiding something? If my company installs both decoy and hidden OS&#8217;s, are they hiding something, or better trying to protect their data? If I as an individual do the same, and I guilty by association for using the latest version of TC? No (dumbass). Just because TC6 can do something such as have 2 OS&#8217;s on it, does not mean that I did this. So it is NOT reasonable to assume that I have set up a decoy and hidden OS just because of versioning of the application.<br />
Just because I use the latest version of 7zip or winzip, and have a password protected archive, does that mean I&#8217;m hiding something, or protecting something?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93175">

			<div class="comment by-tg-18-99 ">

				<p class="commentcredit">

					<span class="commenter">T$G 18.99</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93175">
						July 20, 2008 4:37 PM					</a>

				</p>

				<p>I have to say I found the articles mentioned above to be very misleading. Probably not  intentionally but rather because the authors did not understand what they were writing about. Take the darkreading.com article as an example:</p>
<p>&#8220;Researchers break &#8216;deniable file system&#8217; steganography feature&#8221;</p>
<p>What exactly has been broken? When I read this sentence I thought the researchers had found a flaw in TrueCrypt&#8217;s encryption/&#8221;hiding&#8221; algorithm. Something that leaves the part of the HDD where the hidden data is stored with a detectable pattern for the attacker to find. But this is not the case.</p>
<p>The article that originally caught my attention is even worse. It can found at <a href="http://www.informationweek.com/blog/main/archives/2008/07/truecrypt_no_cl.html" rel="nofollow ugc">http://www.informationweek.com/blog/main/archives/2008/07/truecrypt_no_cl.html</a> and claims that the DFS feature has been &#8220;cracked&#8221;.</p>
<p>If the DFS itself had been &#8220;cracked&#8221; or &#8220;broken&#8221;, it would be possible to prove if a TC container or a TC partition contains  a hidden volume/partition even if it has never been mounted. This is, at least to my knowledge, not possible.</p>
<p>It&#8217;s a bit like announcing that &#8220;SSL has been broken&#8221; because a web browser cached a copy of a securely transmitted web page, or that &#8220;PGP is unsafe&#8221; because some email clients store the email bodies in plaintext after decryption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93176">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93176">
						July 20, 2008 5:06 PM					</a>

				</p>

				<p>@ rich rumble,</p>
<p>&#8220;does that mean I&#8217;m hiding something, or protecting something?&#8221;</p>
<p>It depends on the view point of the person looking at your PC&#8230;</p>
<p>Basicaly if they want to know then as you are &#8220;hiding&#8221; it from them they are probably going to assume the worst untill you prove otherwise, it&#8217;s Catch 22&#8230;</p>
<p>@ Joel,</p>
<p>&#8220;then someone tell me why I need a hidden OS with a DFS and an external drive disguised as a cigar box unless I&#8217;m <em>really</em> up to no good, which should trouble all of us.&#8221;</p>
<p>It depends on what you do for a living. Someone who does the payroll etc on a laptop that they work from home on, I would very much hope they did take these precautions.</p>
<p>Likewise an engineer working on leading edge or market sensitive designs should also have a duty of care to the shareholders.</p>
<p>How about your legal representative or your priest they have a duty of care over what you have told them.</p>
<p>I could give you a hundred and one people / reasons why virtualy everybody with a duty of confidence should use these tools (or the better way I described at the top of this blog page)</p>
<p>@ Joel,</p>
<p>&#8220;Actually I use needle-nosed pliers. What&#8217;s your problem?!?&#8221;</p>
<p>Ouch it brings tears to my eyes just thinking about it,<br />
 8(</p>
<p>What&#8217;s wrong with a bent paper clip? Apparently it&#8217;s the second most frequent use for a paper clip other than for it&#8217;s intended use (cleaning your ears is first)&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93177">

			<div class="comment by-youll-never-know ">

				<p class="commentcredit">

					<span class="commenter">you&#039;ll never know</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93177">
						July 21, 2008 5:56 AM					</a>

				</p>

				<p>Wouldn&#8217;t it be hilarious if the .deb and .exe files for TrueCrypt contained whitelisted government<br />
trojan(s)? How would the common user detect this?</p>
<p>How many people install the binary vs. building from source?</p>
<p>Amusing if you think about it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93178">

			<div class="comment by-plausible_excuse ">

				<p class="commentcredit">

					<span class="commenter">plausible_excuse?</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93178">
						July 21, 2008 11:30 AM					</a>

				</p>

				<p>Scenario: Secret police want to prove that Alice accessed a secret volume whilst in transit.</p>
<p>Attack from paper (proof technique): &#8220;compare the volume serial numbers in the relevant .lnk files to the volume serial numbers for all the volumes that Alice mounted [in presents of secret Police] and, if there is a discrepancy, he knows that there exists or existed a file system that Alice is not closing&#8221;</p>
<p>Problem: Alice may have allowed anyone to use her laptop during the flight.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93179">

			<div class="comment by-whoswork ">

				<p class="commentcredit">

					<span class="commenter">WhosWork?</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93179">
						July 21, 2008 11:37 AM					</a>

				</p>

				<p>Section 5.1 notes that a boot loader is now available in TrueCrypt v6. Was this as a result of the paper or work that TrueCrypt were already working on?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93180">

			<div class="comment by-pat-cahalan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://padraic2112.wordpress.com' rel='external nofollow ugc' class='url'>Pat Cahalan</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93180">
						July 21, 2008 6:57 PM					</a>

				</p>

				<p>@ merlin</p>
<blockquote><p>
  Passwords for example require the user does not write them<br />
  on post-it nots and stick them on the desk.
</p></blockquote>
<p>And this is why the password, as a stand alone authentication method, generally sucks.  Don&#8217;t get me wrong, I have lots of memorized complicated passwords myself, but the cold truth is the staggering percentage of computer users are not capable of memorizing and segregating properly complex passwords for each of the systems to which they require access.  If your security process requires that everyone in your user community behave a certain way, you&#8217;d better have both a small user community and some pretty major consequences imposed upon violation of policy.  Not even the entire body of the military does this extremely well (with a couple of notable exceptions), you can&#8217;t reasonably expect groups of average users outside of milspec security environments to behave well.</p>
<blockquote><p>
  You can turn swapping off on Windows, but it<br />
  requires a restart. On Linux you can swapon/swapoff whenever<br />
  you like.
</p></blockquote>
<p>Er, this is not relevant to my point.  In either case, you require the user to do something.  Unless they&#8217;re highly disciplined, they&#8217;re not going to do it every time.  Hell, people are accidentally shot by comrades in war despite months of severe indoctrination in fire discipline.  If a well-trained Marine can forget to check a chamber every now and then, you can&#8217;t possibly expect Joe Average computer user to remember to turn swap on and off.  Well, maybe you can expect it, but given a user population above N, it&#8217;s going to bite you in the hindquarters.</p>
<blockquote><p>
  Also the usage of the virtual memory is completely different on<br />
  Linux and Windows&#8230; even if you have 2GB of RAM Windows<br />
  will still use VM, however Linux only uses it once the<br />
  memory gets 70-80% full.
</p></blockquote>
<p>If you&#8217;re <em>really</em> worried about security, you should have more physical memory than you&#8217;re going to use and no paging file in any event.</p>
<p>All this statement shows is that you <em>know</em> you&#8217;re possibly screwing yourself if you have a paging file under Windows, and you&#8217;re only <em>possibly</em> screwing yourself if you have a paging file in Linux.  If you&#8217;re worried about the paging file being a vector for attack, whether it is in use 10% of the time or 99% of the time isn&#8217;t really relevant, is it?</p>
<blockquote><p>
  But there is no <em>enforcement</em> to write to the user&#8217;s<br />
  profile. Also the user would have to edit a registry setting<br />
  to put the Documents and Settings folder on an encrypted<br />
  partition.
</p></blockquote>
<p>There&#8217;s no <em>enforcement</em> to write to a user&#8217;s homedir, either.  By default, you can write to /tmp.  Changing this requires the user (or the systems administrator) to do something.</p>
<p>Sure, correctly maintaining file security on a Windows machine isn&#8217;t trivial, but conceptually there isn&#8217;t much of a difference between the two cases (either way, you need to <em>do</em> something to make sure you&#8217;re always writing possibly sensitive data to an encrypted file system).</p>
<blockquote><p>
  Yeah &#8211; my point is that Linux (and BSD etc) already <em>do</em><br />
  take this deny write permission. It is mature and it works<br />
  &#8211; we don&#8217;t have programs crashing because they can&#8217;t<br />
  write to /xyz&#8230; because they never could write to xyz.
</p></blockquote>
<p>Wow, uh, maybe I&#8217;ve worked different places than you have, but I&#8217;ve noticed more than one instance of horrible software running on a *NIX box that doesn&#8217;t act like this at all.  At least, not on a *NIX cluster that has been up and running for more than a year with active in-house development.  Maybe you&#8217;ve been lucky and you&#8217;ve never worked somewhere where a non-security minded person had sudo access.  But I digress&#8230; you&#8217;re talking &#8220;out of the box&#8221;.</p>
<p>Sure, out of the box a mortal user can only write to /tmp and their homedir.  Well, out of the box a mortal windows user can only write to their profile.  The major difference between the two is that most windows users don&#8217;t run as mortals, they run as Administrator.  This is just like having *NIX users running as root all the time.  They could write everywhere, too.</p>
<p>And, if Windows suddenly magically disappeared and all the current Windows users jumped to either Macintosh, Linux, or your favorite BSD flavor, you&#8217;d see a high percentage of them running their home box as root, just like they run their Windows box as administrator.</p>
<blockquote><p>
  ACLs are not really a security advantage &#8211; as when<br />
  networks get large enough they are far too complex to<br />
  properly analyse. I have worked as a Server Engineer on<br />
  both Windows and Linux, and I can say that general<br />
  policy is to avoid ACLs is possible.
</p></blockquote>
<p>Sure.</p>
<p>And having worked with both Windows and Linux <em>users</em>, I can say that as a general policy, you want your security software to be at &#8220;zero&#8221; to &#8220;within epsilon of zero&#8221; in the effort cateorgy for use, or your user population is going to use it improperly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93181">

			<div class="comment by-pat-cahalan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://padraic2112.wordpress.com' rel='external nofollow ugc' class='url'>Pat Cahalan</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93181">
						July 21, 2008 6:59 PM					</a>

				</p>

				<p>edit last comment to add:</p>
<blockquote><p>
  If you&#8217;re <em>really</em> worried about security, you should<br />
  have more physical memory than you&#8217;re going to use and<br />
  no paging file in any event.
</p></blockquote>
<p>And you should read Felten&#8217;s paper on attacks against volatile RAM so that you know when you should actually turn your computer <em>off</em> even if you only use swap. üôÇ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93182">

			<div class="comment by-snake ">

				<p class="commentcredit">

					<span class="commenter">snake</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93182">
						July 21, 2008 11:42 PM					</a>

				</p>

				<p>If your computer&#8217;s location has proper safeguards against intruders, it can be rigged with proper<br />
hardware, tripwires and such with lasers to signal an intruder is present, signalling the computer to shut down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93183">

			<div class="comment by-philip-le-riche ">

				<p class="commentcredit">

					<span class="commenter">Philip Le Riche</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93183">
						July 22, 2008 3:07 PM					</a>

				</p>

				<p>The basic problem with Truecrypt&#8217;s plausible deniability is that a chunk of crypto-grade random junk is a very strong indication that something has been encrypted. Nothing else has comparable entropy. Even though TC fills unused space beyond the end of the system partition with equally random junk which can&#8217;t be distinguished from a hidden o/s (if one exists), the fact that more than the fag-end of the last disk cylinder has apparently been left unused is a dead give-away.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93184">

			<div class="comment by-no-trash-for-me ">

				<p class="commentcredit">

					<span class="commenter">no trash for me</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93184">
						July 23, 2008 3:14 AM					</a>

				</p>

				<p>The very name &#8220;truecrypt&#8221; is enough for me to smell a foul odor. It has been my experience when anyone develops something with the opposite aim, they give it a sweet smelling name. Wait and see, something big will come out in a few months or years about this so-called encryption scheme. Baseless claims, you say, just wait. Enough people will adopt it and trust it and will be lulled into the lofty claims of the software and then the report will come out.</p>
<p>Go ahead, trust the binaries.. ahahahahahahahaaaahaha</p>
<p>TRUST THEM!</p>
<p>ahahaahahah!</p>
<p>After all, it&#8217;s TRUE!</p>
<p>hahahahahah!</p>
<p>I&#8217;ll pass on this trash software and stay with GPG.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93185">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93185">
						July 23, 2008 9:16 AM					</a>

				</p>

				<p>@Merlin: &#8220;why did you use Truecrypt, rather than the OS builtin encryption (MacOSX &#8211; Vault; Windows &#8211; BitLocker; Linux &#8211; DMCrypt)?&#8221;</p>
<p>See, there&#8217;s your reason: I use Windows and Linux (and &#8211; seldomly, though &#8211; MacOS) and I need my containers to be compatible between those platforms.</p>
<p>Furthermore, I haven&#8217;t seen a Vista variant yet that comes with BitLocker in use by anyone I know. (It only ships with Ultimate or Enterprise and mostly you get HomePremium or Business.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93186">

			<div class="comment by-passionate ">

				<p class="commentcredit">

					<span class="commenter">passionate</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93186">
						July 24, 2008 8:04 AM					</a>

				</p>

				<p>@ no trash for me: I have personally compiled TrueCrypt and compared it with the downloadable binaries: they are exactly the same thing &#8211;&gt; no backdoor, malware, virus, or anything else embedded.<br />
Also, TrueCrypt is not something new, so don&#8217;t expect anything coming out in the next few months.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93187">

			<div class="comment by-sybil-manston ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://is.gd/Fo2?888959948' rel='external nofollow ugc' class='url'>Sybil Manston</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93187">
						July 24, 2008 1:42 PM					</a>

				</p>

				<p>No, it simply means you can&#8217;t just use common applications like MS Word inside a &#8220;hidden partition&#8221; and maintain plausible deniability, anything that uses /tmp or the equivalent on whichever OS you&#8217;re using will reveal the existence of the hidden partition. If you&#8217;re just hiding data&#8230; not running apps, os&#8217;s and the like, its fine. downmod for sensational and false headline.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93189">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93189">
						August 1, 2008 9:13 AM					</a>

				</p>

				<p>They can already read your PGP and truecrypt encryption.</p>
<p>From a Washington Post article&#8230;<br />
&#8220;Also, officials may share copies of the laptop&#8217;s contents with other agencies and private entities for language translation, data decryption or other reasons, &#8221;</p>
<p>Assuming that PGP and truecrypt are on some of these laptops, it is reasonable to say that they are being cracked.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93190">

			<div class="comment by-maciej-tomczak ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.phototramp.com' rel='external nofollow ugc' class='url'>Maciej Tomczak</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93190">
						August 15, 2008 6:43 PM					</a>

				</p>

				<p>The paper uses an example of a human-rights worker in a hostile environment (e.g. an investigative journalist in Burma).  Though personal safety of a journalist is an issue, it&#8217;s an elected occupational hazard &#8211; protecting the local sources is far more important.  As the article concludes, even perfect deniability is not going to work here &#8211; if Alice knows the password(s), they can be revealed, one way or another, and incriminate people that trusted her.</p>
<p>There is another way.  Alice creates an asymmetric key-pair.  She leaves the secret key at home, and takes the public one with her.  She encrypts all her field work with the public key (subject to no-plain-text-autobackup, no-swap file, no-hibernation, no-keylogger etc. precautions).  She will decrypt the information when/if she safely returns home.</p>
<p>Such scheme alone doesn&#8217;t protect Alice at all against the legal or physical consequences of her clandestine work, but it does what really matters &#8211; it protects the sources.  Alice can not reveal the decryption key that she doesn&#8217;t have.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93191">

			<div class="comment by-dcl ">

				<p class="commentcredit">

					<span class="commenter">DCL</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93191">
						September 16, 2008 1:23 PM					</a>

				</p>

				<p>Hmm I¬¥dont care about Hi-Tech attack I just want to make intruders job a little bit harder, so why I am talking like I don¬¥t care BECAUSE EVERYTHING IS POSSIBLE (TODAY). Brains+Hands+Computer+Keyboard+some money=thats all you need</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93192">

			<div class="comment by-rh ">

				<p class="commentcredit">

					<span class="commenter">RH</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93192">
						March 2, 2009 7:21 PM					</a>

				</p>

				<p>As to those who want the data to &#8220;burn itself away&#8221; with a duress password, its simply not possible.</p>
<p>Because computers are Turing machines, there&#8217;s nothing they can do which cannot be simulated (except esoteric hardware like detuned radio receivers).</p>
<p>Now you could get lucky, and hide the poison pill REALLY well, and they might trip it before they back your data up.  or they might not, in which case they have a backup to work from, and now you have some serious explaining to do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93193">

			<div class="comment by-average-guy ">

				<p class="commentcredit">

					<span class="commenter">average guy</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93193">
						March 5, 2009 5:31 AM					</a>

				</p>

				<blockquote><p>
  Like having Truecrypt installed in the first<br />
  place&#8230; why did you use Truecrypt, rather than<br />
  the OS builtin encryption (MacOSX &#8211; Vault;<br />
  Windows &#8211; BitLocker; Linux &#8211; DMCrypt)?
</p></blockquote>
<p>There&#8217;s a very good reason : it&#8217;s cross platform. By using TCrypt, you can in a very user friendly manner keep your data encrypted (be it on an external HD or in a file container) and still work on it from any mainstream operating system (Win, Mac OS X, Linux/Unix). It&#8217;s there, it&#8217;s effective, it&#8217;s reviewed&#8230; No need to write your own utility. This is a very good reason why, for genuine legitimate reasons (eg business security) you may want to use TrueCrypt.</p>
<p>Then play with the plausible deniablity features should you like so, it&#8217;s not my business.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93194">

			<div class="comment by-m ">

				<p class="commentcredit">

					<span class="commenter">M.</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93194">
						April 6, 2009 9:57 AM					</a>

				</p>

				<p>@ Patrick Cahalan</p>
<p>You might look into OpenBSD&#8217;s automatic swap encryption.</p>
<p><a href="http://www.openbsd.org/papers/swapencrypt.ps" rel="nofollow ugc">http://www.openbsd.org/papers/swapencrypt.ps</a></p>
<p>All they need is good block-level encryption for the rest of the disk to go with it. I asked a friend to forward a list of suggestions I made, even though I am obviously not an expert on encryption.</p>
<p><a href="http://unix.org.in/UNIX-misc" rel="nofollow ugc">http://unix.org.in/UNIX-misc</a> openbsd bsd unix comp/messages/116613_Fwd-3A-Block-level-encryption.html</p>
<p>@ merlin</p>
<p>You forgot /var/tmp.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93195">

			<div class="comment by-m ">

				<p class="commentcredit">

					<span class="commenter">M.</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93195">
						April 6, 2009 10:43 AM					</a>

				</p>

				<p>@ Merlin</p>
<p>As far as &#8220;why not use the operating system&#8217;s built-in encryption?&#8221; goes, for Windows, that is a very easy question to answer.</p>
<p>Why not use Bitlocker?<br />
1. It is only &#8220;built-in&#8221; to the Ultimate and Enterprise editions of Vista. If you do not want to pay that much, and instead have Home Basic, Home Premium, or Business Vista, Bitlocker is not available. Even EFS is not available for Home Basic or Home Premium. Also, if you are using an older version of Windows, like XP or 2000, Bitlocker is not available.<br />
2. In addition to Ultimate or Enterprise Vista, Bitlocker also requires a Trusted Platform Module. Some people do not like Trusted Computing, and even if you do not mind, the TPM still costs extra money you may not want to pay.<br />
3. Truecrypt is open source. Say you like encryption software that can be peer-reviewed.<br />
4. Bitlocker uses AES. EFS uses DES and variations. Truecrypt supports Serpent and Twofish, which are more secure.</p>
<p>For Mac OS X users, why not use FileVault?<br />
1. Truecrypt is open source. Say you like encryption software than can be peer-reviewed.<br />
2. FileVault uses AES. Truecrypt supports Serpent and Twofish, which are more secure.</p>
<p>FileVault does not do full-disk encryption, but neither does the Macintosh version of of Truecrypt. Neither supports older version of Macintosh.</p>
<p>The question is more complicated for Linux users. All major alternatives are open source. What is built-in may depend on your distribution&#8217;s installer, but dm-crypt and loop-aes are generally the easiest to set up on Linux.</p>
<p>Dm-crypt, loop-aes, and Truecrypt all offer choices between Serpent, Twofish, and AES. Truecrypt offers cascades, but in Dm-crypt and loop-aes you can just create an encrypted partition within another encrypted partition.</p>
<p>One argument in favour of Truecrypt is the block cipher mode. Truecrypt uses XTS, which I believe is comparable to LRW, although I have not seen as much literature about XTS as LRW. The best you can do with dm-crypt or loop-aes is CBC-ESSIV, although loop-aes does have a nice multi-key mode.</p>
<p>On the other hand, I&#8217;m not sure how you would encrypt everything but the /boot device with Truecrypt. However, there is nothing to stop you from using Truecrypt in combination with dm-crypt or loop-aes. Everything but /boot is encrypted with dm-crypt or loop-aes, but something else is used for user files. Then Truecrypt must compete with EncFS and CryptoFS. EncFS and CryptoFS leak file system structure data, like number of files, size of files, and approximate size of file names. Truecrypt does not. However, Truecrypt containers are fixed size, while EncFS and CryptoFS can expand within the /home partition.</p>
<p>Of course for multi-booters there is the cross-platform argument.</p>
<p>For the open source BSDs, Truecrypt may not be an option. I&#8217;ve heard of people getting Truecrypt to work with FreeBSD, but for the most part, BSD users who want encryption do use the encryption system that comes with their operating system: geli fro FreeBSD, svnd for OpenBSD, and cgd for NetBSD. EncFS and CryptoFS may also be available.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93196">

			<div class="comment by-pawel ">

				<p class="commentcredit">

					<span class="commenter">Pawel</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93196">
						August 2, 2009 3:17 PM					</a>

				</p>

				<p>Though what is a bit concerning is that many of problems described in the comments can totally avoided with steganography fs &#8211; though anyone who starts it, seems to stop relatively soon&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93197">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93197">
						August 3, 2009 12:18 PM					</a>

				</p>

				<p>@ Pawel,</p>
<p>&#8220;&#8230; &#8230;can totally avoided with steganography fs &#8211; though anyone who starts it, seems to stop relatively soon&#8230;&#8221;</p>
<p>Stego irrespective of the method has a couple of problems,</p>
<p>1, It has a low signal to bandwidth ratio.<br />
2, There are numerous ways to detect it&#8217;s use.</p>
<p>These two are not unrelated to each other. Essentially what you are trying to do is modulate an existing signal with another signal that contains the hidden data, the lower the effective energy of the hidden signal to the carrier signal the lower the probability it will be detected.</p>
<p>However if you have a low energy signal in the presence of a high energy signal your receiver needs a good dynamic range for the wanted low level signal to be clearly detected. And this is the problem if the level of the hidden signal is sufficient to be detected by a receiver then it can also be detected by other methods which is why simple stego is doomed to be found.</p>
<p>the next trick is to use a moderate amount of energy for the hidden signal but keep it&#8217;s bandwidth very very small and spread it&#8217;s energy across the carrier signal bandwidth using a spread spectrum type system. This is what was used for digital watermarking and as history has shown that was not a great success for a number of reasons both technical and pragmatic.</p>
<p>Realistically simple signal recovery techniques on static files can have around a 96db equivalent dynamic range or 1 bit in 16. however complex signal estimation techniques based around Fourier / Walsh / Wavelet analysis and signal averaging can beat that by a significant margin and can find most coding sequences that are likely to be used. It is no coincidence then that the likes of the NSA and GCHQ place adds for maths grads with those particular applied mathematics skills&#8230;</p>
<p>Stego can be used for transferring snippets of information but they need to blend in with the background carrier data or it will be spotted.</p>
<p>For instance in a picture with a block of colour and a sharp edge. Simple analysis of the noise in the colour region and the appropriate application of edge sharpening algs will pull out the fact there is stego and of what type etc.</p>
<p>So the next stage is adaptive spread spectrum techniques where the carrier is analyzed through a programmable filter and this is used to tailor the spread spectrum characteristics so that it blends in better with the carrier.</p>
<p>However this ends up sending truly tiny amounts of data (think 1 byte in 100KByte) that the effort is hardly worth it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93198">

			<div class="comment by-awesome-deniability ">

				<p class="commentcredit">

					<span class="commenter">awesome deniability</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93198">
						October 17, 2009 7:28 PM					</a>

				</p>

				<p>I think TrueCrypt&#8217;s hidden volume feature is useless for plausible deniability, not just because of the paper in the post, but because it&#8217;s virtually impossible to <em>use</em> the outer volume without the filesystem trying to overwrite the hidden volume. Even if the hidden volume is protected, when the outer filesystem tries to write over the hidden volume, use of that space will be prevented, making it impossible to put the outer volume into common use.</p>
<p>I&#8217;ve taken a different approach to plausible deniability. I completely filled my 300 GB external drive with random data by creating a truecrypt whole-drive-encryption on it. Then I dumped that and created 15 20 GB logical partitions on it. I then use just a few of the partitions, with different passwords. That way I can reveal just a couple passwords under duress and deny that any more exist. Since I truly don&#8217;t have use for most of that space, this is plausible. This seems to me to replicate the main advantage of the Rubberhose filesystem under current software.</p>
<p>Of course, this doesn&#8217;t solve any of the problems mentioned in the paper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93200">

			<div class="comment by-marinegundoctor ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.facebook.com/marinegundoctor' rel='external nofollow ugc' class='url'>marinegundoctor</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93200">
						September 8, 2011 9:17 PM					</a>

				</p>

				<p>This is an old blog but some good (and some amusing) information. I hate to revive a nearly 2 year-old post, but some of these people are so paranoid they shouldn&#8217;t use a computer at all. They should just keep everything in their heads and deny it. lol</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93201">

			<div class="comment by-roland ">

				<p class="commentcredit">

					<span class="commenter">Roland</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/#comment-93201">
						March 20, 2012 4:07 AM					</a>

				</p>

				<pre><code> What about a triple plausible deniability system? Keep Truecrypt's system of an obvious encryption hiding another encryption inside of it, but instead of ending it there, the hidden encryption is hiding another encryption, and that encryption is hiding a third encryption. 
</code></pre>
<p>How easy then, would it be for anyone to actually determine that the evidence for any of the three hidden encryptions isn&#8217;t all for the same hidden encryption? And of course if someone is actually willing to put forth the time and effort, perhaps a system that allows for an infinite number of hidden encryptions within other subsequent encryptions so long as they have adequate space available. How easy would it be then to determine through window&#8217;s tell-tale signs the exact number of hidden encryptions and where indeed is the final encryption that has the sensitive data that they are actually looking for?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2008/07/truecrypts_deni.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2008/07/truecrypts_deni.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F07%2Ftruecrypts_deni.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2008/07/truecrypts_deni.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='2369' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2008/07/locksmiths_hate.html" rel="prev">‚Üê Locksmiths Hate Computer Geeks who Learn Lockpicking</a>		<a href="https://www.schneier.com/blog/archives/2008/07/midazolam_as_a.html" rel="next">Midazolam as a Non-Lethal Weapon ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
