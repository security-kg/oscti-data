<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Faking Hardware Memory Access - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Faking Hardware Memory Access Comments Feed" href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1418" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1418' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F03%2Ffaking_hardware.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F03%2Ffaking_hardware.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1418 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1418" class="post-1418 post type-post status-publish format-standard hentry category-uncategorized tag-computer-security tag-forensics tag-hardware tag-malware">

	<div class="article">

		<h2 class="entry">Faking Hardware Memory Access</h2>
		<p><a href="http://www.darkreading.com/document.asp?doc_id=118291">Interesting</a>:</p>
<blockquote><p>[Joanna] Rutkowksa will show how an attacker could prevent forensics investigators from getting a real image of the memory where the malware resides. &#8220;Even if they somehow find out that the system is compromised, they will be unable to get the real image of memory containing the malware, and consequently, they will be unable to analyze it,&#8221; says Rutkowska, senior security researcher for COSEINC.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/computer-security/" rel="tag">computer security</a>, <a href="https://www.schneier.com/tag/forensics/" rel="tag">forensics</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html" rel="bookmark">Posted on March 1, 2007 at 1:33 PM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html#comments">19 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html" data-title="Faking Hardware Memory Access" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-55529">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55529">
						March 1, 2007 2:09 PM					</a>

				</p>

				<p>And in other news, water is wet&#8230;</p>
<p>From within a compromised system, you can&#8217;t make any assertions about a compromised system, even if you know it IS compromised.  Rootkits are wonderful things, no.</p>
<p>Basically, it comes down to that &#8220;I think, therefore I am&#8221; is a load of bull***t.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55530">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55530">
						March 1, 2007 2:12 PM					</a>

				</p>

				<p>AHH, never mind.  Read the FA.  Its defeating monitors placed on the memory bus as part of malware analysis.</p>
<p>Here&#8217;s my bet.  Simply she keeps the malcode small and in L2 cache.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55531">

			<div class="comment by-junior ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobias.karlsson-online.com' rel='external nofollow ugc' class='url'>Junior</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55531">
						March 1, 2007 2:18 PM					</a>

				</p>

				<p>This isn&#8217;t news, me and some friends has been experimenting with TLB desynch attacks for quite some time. Forcing reads of one page to occur at one physical address, and executions of the same page at another isn&#8217;t that hard in a modern OS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55532">

			<div class="comment by-junior ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobias.karlsson-online.com' rel='external nofollow ugc' class='url'>Junior</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55532">
						March 1, 2007 2:34 PM					</a>

				</p>

				<p>Oh, and Nicholas, keeping something in L2 cache without keeping it in regular RAM is pretty much impossible on a multitasking computer. Also, the regular techniques found in rootkits (spoofing information by using hooks) won&#8217;t really help you against someone not using the hooked APIs. Using a falsified entry in the TLB you can &#8220;trick&#8221; a regular MOV, since the page table itself is compromised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55533">

			<div class="comment by-jim ">

				<p class="commentcredit">

					<span class="commenter">Jim</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55533">
						March 1, 2007 2:40 PM					</a>

				</p>

				<p>At least with the needle in the haystack, you know what the needle looks like.  Now you are looking for the proprietary needle and don&#8217;t know what you are looking for looks like.  Good luck finding it.  You might find it and not know what it is you found.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55534">

			<div class="comment by-junior ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobias.karlsson-online.com' rel='external nofollow ugc' class='url'>Junior</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55534">
						March 1, 2007 4:45 PM					</a>

				</p>

				<p>Well the problem is that when you start looking for the needle you&#8217;ll be automagically transfered to a haystack without a needle.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55535">

			<div class="comment by-morpheus ">

				<p class="commentcredit">

					<span class="commenter">Morpheus</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55535">
						March 1, 2007 6:25 PM					</a>

				</p>

				<p>With fully virtualizable processors (as I understand recent Intel processors are), isn&#8217;t this moot? If the malware ever figures out how to get &#8220;on the bare metal&#8221;, the operating environment that the forensics tools gets to run in will appear <em>exactly</em> how the malware wants it to appear. At this point, all you can do is break out the logic analyzer, because any operations that go through the CPU must be assumed to have been compromised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55536">

			<div class="comment by-morpheus ">

				<p class="commentcredit">

					<span class="commenter">Morpheus</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55536">
						March 1, 2007 6:33 PM					</a>

				</p>

				<p>Ok, so I didn&#8217;t RTFA first. The article confirms my assertion about the operating environment.</p>
<p>Looks like the emerging workaround is to plug something into the PCI bus.</p>
<p>It wouldn&#8217;t matter if it was somehow plugged directly into the FSB, because even that is a programmable multiplexor.</p>
<p>Couldn&#8217;t you still attach to the memory slot itself, and no way of obfuscating reads done there?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55537">

			<div class="comment by-junior ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobias.karlsson-online.com' rel='external nofollow ugc' class='url'>Junior</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55537">
						March 2, 2007 1:25 AM					</a>

				</p>

				<p>There are a lot of ways to get around TLB desynchs, unfortunately most of them requires heavily specialized gear.<br />
I think the only feasible way for most malware researchers is to modify the OS loader to guarantee first loading of a specialized module that keeps tabs on the buffers and makes sure nothing mucks with them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55538">

			<div class="comment by-greg ">

				<p class="commentcredit">

					<span class="commenter">greg</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55538">
						March 2, 2007 3:51 AM					</a>

				</p>

				<p>&#8220;There are a lot of ways to get around TLB desynchs, unfortunately most of them requires heavily specialized gear.&#8221;</p>
<p>Many of us have access to such gear. Never underestimate Eve. Hardware hacking is less talked about these days. But its done more than ever.</p>
<p>Even gettting data out of flash or turned off ram with distructive methods is carried out by many.</p>
<p>Things like electron microscopes and the like are readly avavlible to a <em>lot</em> of pepople and are cheaper enought that uni&#8217;s and companys don&#8217;t mind a little personal use. At my uni it was encoraged.</p>
<p>Even tamper resitant hardware is weak agaist a lot of attacts, and PC arn&#8217;t (yet) tamper resistant by design.</p>
<p>Long story short. If it doesn&#8217;t blow up when you open the case/package. You can work out whats going on. The code the keys&#8230; whatever.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55539">

			<div class="comment by-junior ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobias.karlsson-online.com' rel='external nofollow ugc' class='url'>Junior</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55539">
						March 2, 2007 5:30 AM					</a>

				</p>

				<p>&#8220;Many of us have access to such gear.&#8221;</p>
<p>I think many is a bit of an exaggeration to be honest. The number of organizations with access to the kind of equipment needed is a drop in the ocean compared to the number who would need the gear, but can&#8217;t get to it. Malware can use techniques for stealth today that requires extremely expensive and hard to find equipment to detect, and it doesn&#8217;t really take a lot of effort. Proof of concept code has been out for quite some time about TLB desynchs, and I&#8217;d be surprised if I didn&#8217;t come across malware that uses it within a year. The simplicity of the techniques makes it vital that research companies geared towards the consumer market has countermeasures that aren&#8217;t based on electron microscopes, custom made memory controllers, and so on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55540">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55540">
						March 2, 2007 6:11 AM					</a>

				</p>

				<p>@Junior:</p>
<p>If I recall correctly, some architectures (such as ARM) allow certain cache-lines to be locked in. Does anyone know x86 well enough to comment if it has any similar features?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55541">

			<div class="comment by-tobias ">

				<p class="commentcredit">

					<span class="commenter">Tobias</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55541">
						March 2, 2007 7:35 AM					</a>

				</p>

				<p>@Junior:</p>
<p>Doing forensic via FireWire seems to be pretty common these days. That seems to be the main target of Rutkowksa&#8217;s attack. There are open libraries for DMA access (primary focus of research was FireWire, but parsing memory snapshots is also possible) in development by David R. Piegdon, see <a href="http://david.piegdon.de/products.html" rel="nofollow ugc">http://david.piegdon.de/products.html</a> &#8211; He gave a talk about it at the CCC Cologne, but unfortunately there are no slides (and no code) available yet&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55542">

			<div class="comment by-chris-s ">

				<p class="commentcredit">

					<span class="commenter">Chris S</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55542">
						March 2, 2007 8:54 AM					</a>

				</p>

				<p>I don&#8217;t think anyone has yet invented an attack that can&#8217;t be detected, or a defense that can&#8217;t be circumvented.</p>
<p>But, if successful, this would appear to be relatively low-cost to implement, with a high cost to detect. Keep in mind that most forensics personnel don&#8217;t walk around with expensive hardware gear, so although <em>someone</em> can detect this, it&#8217;s going be a rare person compared to the average.</p>
<p>Think back to how widespread the Sony rootkit was before it was detected. Most people were running malware detection on top of the OS, unaware that the OS was lying to them.</p>
<p>In addition, as I understand it, if an attack used this and resided solely in memory, it would become much harder to detect. Much of the low-level hardware detection I&#8217;ve heard of involves rerunning stuff on after installing detectors on the hardware. Getting hardware detectors into a standard system without shutting it down would be very expensive.</p>
<p>The following data recovery would seem to on the level of this approach, following the Concorde crash&#8230;</p>
<p><a href="http://catless.ncl.ac.uk/Risks/21.05.html#subj11" rel="nofollow ugc">http://catless.ncl.ac.uk/Risks/21.05.html#subj11</a></p>
<p>&#8230; where data was recovered from a powered and running circuit by carefully supplying alternate power and moving the circuit to a new installation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55543">

			<div class="comment by-spider ">

				<p class="commentcredit">

					<span class="commenter">Spider</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55543">
						March 2, 2007 9:17 AM					</a>

				</p>

				<p>Help me out guys, if you really suspect a root kit why would you boot the infected operating system to try and find it? Why not move it to a visualized environment and just examine what its doing there. Why the need for electron microscopes or expensive gear to tap into the PCI bus?</p>
<p>At least put the disk into a know good system and run a scan on the suspect disk as a slave.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55544">

			<div class="comment by-junior ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobias.karlsson-online.com' rel='external nofollow ugc' class='url'>Junior</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55544">
						March 2, 2007 1:47 PM					</a>

				</p>

				<p>Dave: I can&#8217;t say I&#8217;m 100% sure (something is itching in the darker, rarely used, regions of my brain) but no, i&#8217;m fairly sure you can&#8217;t do that on the x86. The reason for the itch is most likely me reading something connected to it, but I can&#8217;t remember where, or exactly what it was about üôÇ</p>
<p>Tobias: Yes, and that&#8217;s exactly the problem. Analysis over firewire, or any memory-based method, simply won&#8217;t work if you have different pages for read and execute in the TLB.</p>
<p>Spider: The main problem would be that the malware would detect the virtualized environment and just stay under cover.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55545">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.calyptix.com' rel='external nofollow ugc' class='url'>Chris</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55545">
						March 2, 2007 2:24 PM					</a>

				</p>

				<p>When malware reaches kernel level priveleges it is already over. Everything should be assumed compromised and/or subverted in some way. This is interesting research but should be considered anti-forensics not &#8216;security&#8217;, the compromise has already happened, your data is already gone etc&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-55546">

			<div class="comment by-jim ">

				<p class="commentcredit">

					<span class="commenter">Jim</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55546">
						March 4, 2007 3:15 PM					</a>

				</p>

				<p>Burn the haystacks, find the needle.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-55547">

			<div class="comment by-david-koontz ">

				<p class="commentcredit">

					<span class="commenter">David Koontz</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/#comment-55547">
						March 4, 2007 3:54 PM					</a>

				</p>

				<p><a href="http://developer.amd.com/assets/IOMMU-ben-yehuda.pdf" rel="nofollow ugc">http://developer.amd.com/assets/IOMMU-ben-yehuda.pdf</a></p>
<p>Quote:<br />
&#8220;In IOMMU isolation solves a very different<br />
problem than IOMMU translation. Isolation restricts the access of an adapter to the specific area of memory that the IOMMU allows. Without isolation, an adapter controlled by an untrusted entity (such as a virtual machine when running with a hypervisor, or a non-root userlevel driver) could compromise the security or availability of the system by corrupting memory.&#8221;</p>
<p>In other words, the IOMMU can be used to prevent something in the I/O subsystem (PCI, etc.) from seeing all of memory.   Apparently some new Ultra SPARCs have IOMMUs, too?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2007/03/faking_hardware.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2007/03/faking_hardware.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F03%2Ffaking_hardware.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2007/03/faking_hardware.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1418' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2007/03/boston_police_b.html" rel="prev">‚Üê Boston Police Blow Up Traffic Counter</a>		<a href="https://www.schneier.com/blog/archives/2007/03/canadian_system.html" rel="next">Canadian Anti-Terrorism Law News ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
