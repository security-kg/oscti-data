<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>How the SolarWinds Hackers Bypassed Duo‚Äôs Multi-Factor Authentication - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; How the SolarWinds Hackers Bypassed Duo‚Äôs Multi-Factor Authentication Comments Feed" href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/60605" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=60605' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F12%2Fhow-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F12%2Fhow-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-60605 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-60605" class="post-60605 post type-post status-publish format-standard hentry category-uncategorized tag-authentication tag-breaches tag-network-security tag-two-factor-authentication">

	<div class="article">

		<h2 class="entry">How the SolarWinds Hackers Bypassed Duo‚Äôs Multi-Factor Authentication</h2>
		<p>This is <a href="https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/">interesting</a>:</p>
<blockquote><p>Toward the end of the second incident that Volexity worked involving Dark Halo, the actor was observed accessing the e-mail account of a user via OWA. This was unexpected for a few reasons, not least of which was the targeted mailbox was protected by MFA. Logs from the Exchange server showed that the attacker provided username and password authentication like normal but were not challenged for a second factor through Duo. The logs from the Duo authentication server further showed that no attempts had been made to log into the account in question. Volexity was able to confirm that session hijacking was not involved and, through a memory dump of the OWA server, could also confirm that the attacker had presented cookie tied to a Duo MFA session named <b>duo-sid</b>.</p>
<p>Volexity&#8217;s investigation into this incident determined the attacker had accessed the Duo integration secret key (<b>akey</b>) from the OWA server. This key then allowed the attacker to derive a pre-computed value to be set in the duo-sid cookie. After successful password authentication, the server evaluated the duo-sid cookie and determined it to be valid. This allowed the attacker with knowledge of a user account and password to then completely bypass the MFA set on the account. It should be noted this is not a vulnerability with the MFA provider and underscores the need to ensure that all secrets associated with key integrations, such as those with an MFA provider, should be changed following a breach.</p></blockquote>
<p>Again, this is not a Duo vulnerability. From <a href="https://arstechnica.com/information-technology/2020/12/solarwinds-hackers-have-a-clever-way-to-bypass-multi-factor-authentication/">ArsTechnica</a>:</p>
<blockquote><p>While the MFA provider in this case was Duo, it just as easily could have involved any of its competitors. MFA threat modeling generally doesn&#8217;t include a complete system compromise of an OWA server. The level of access the hacker achieved was enough to neuter just about any defense.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/authentication/" rel="tag">authentication</a>, <a href="https://www.schneier.com/tag/breaches/" rel="tag">breaches</a>, <a href="https://www.schneier.com/tag/network-security/" rel="tag">network security</a>, <a href="https://www.schneier.com/tag/two-factor-authentication/" rel="tag">two-factor authentication</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html" rel="bookmark">Posted on December 15, 2020 at 2:13 PM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html#comments">19 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html" data-title="How the SolarWinds Hackers Bypassed Duo‚Äôs Multi-Factor Authentication" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-360718">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360718">
						December 15, 2020 2:36 PM					</a>

				</p>

				<p>That sounds a lot like a security issue to me, there should be no reason for there to be anything stored on the service provider system that would allow you to forge a token from the identity provider, it just needs to be able to validate the token.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-360719">

			<div class="comment by-leo ">

				<p class="commentcredit">

					<span class="commenter">Leo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360719">
						December 15, 2020 2:41 PM					</a>

				</p>

				<p>I&#8217;m curious about the assertion that &#8220;This is not a Duo vulnerability&#8221;. Isn&#8217;t this a sophisticated form of session forgery? Shouldn&#8217;t there be some defense in the session that aligns the MFA information with the fact that MFA actually occurred? Just as an example, before accepting the duo-sid cookie, confirm that the session cookie has an entry with the timestamp of the MFA request&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-360721">

			<div class="comment by-evilkiru ">

				<p class="commentcredit">

					<span class="commenter">EvilKiru</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360721">
						December 15, 2020 3:03 PM					</a>

				</p>

				<p>@Leo: It&#8217;s a vulnerability in how OWA implemented their side of the MFA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-360725">

			<div class="comment by-stine ">

				<p class="commentcredit">

					<span class="commenter">stine</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360725">
						December 15, 2020 3:47 PM					</a>

				</p>

				<p>I&#8217;m not sure I understand this (or either of the quoted articles, which I have read.)</p>
<p>There should be no way to generate a valid MFA token, save on the MFA server itself.</p>
<p>The conclusion I came up with is that a proxy was hacked and that allowed the hackers to intercept the token being delivered to its original requestor.  It seems to me that this is simply a duplicate-and-reuse attack using a cookie, and why I always uncheck the &#8220;don&#8217;t ask again on this computer for 30 days&#8221; when prompted by various MFA schemes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-360726">

			<div class="comment by-rick ">

				<p class="commentcredit">

					<span class="commenter">Rick</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360726">
						December 15, 2020 4:11 PM					</a>

				</p>

				<p>Duo MFA admin here:</p>
<p>The SKEY (secret key) is one of three values you need when setting up any Duo Application, in addition to the Duo Instance Hostname and the Application Public Key. Knowing the secret key allows anyone to bypass the MFA protection the way they describe here.</p>
<p>Duo warns you up and down to protect your SKEYs. There is a mechanism to change your SKEYs if you think they&#8217;ve been compromised. There is a mechanism to encrypt your SKEYs in host registry (which I assume was not done here, since someone with admin access to the host server was able to recover them).</p>
<p>Its not a Duo vulnerability if some customer admin failed to protect the SKEY while they were implementing the protection. Duo has tons of documentation on this subject.</p>
<p>(there isn&#8217;t such thing as a Duo &#8220;akey&#8221; btw, that&#8217;s a type-o üòâ )</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-360730">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360730">
						December 15, 2020 5:23 PM					</a>

				</p>

				<p>Rick, thanks for taking the time to comment here.  Where I&#8217;m confused is in the design of the system such that the skey can be used to forge a token.  I could understand if a hacker was able to compromise the system and change the skey to a value for which they could forge a token.</p>
<p>Where I&#8217;m confused is that the protocol allows the attacker to forge a token purely with knowledge of the skey, I had assumed that a system like this would use pki for validation of the token where the sp contains only the public key used to validate the token and the private signing key never leaves duo&#8217;s servers.</p>
<p>Of course, once someone has write access to the sp all bets are effectively off, but I thought the distinction between having access to be able to modify the skey vs just knowledge of the skey was an interesting one.</p>
<p>Documentation of how sensitive the skey is certainly helps, but I&#8217;d argue that it doesn&#8217;t change the fact that the underlying protocol has an unecessary weakness if the skey is able to generate as well as validate a token.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-360731">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360731">
						December 15, 2020 6:01 PM					</a>

				</p>

				<p>Dan, TOTP and HOTP use a shared secret and a counter, so they don&#8217;t require 2-way communication with the authenticating device.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-360744">

			<div class="comment by-11umm ">

				<p class="commentcredit">

					<span class="commenter">1&amp;1~=Umm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360744">
						December 15, 2020 10:17 PM					</a>

				</p>

				<p>@ ALL,</p>
<p>Interesting comment at the bottom of the ARS article,</p>
<p>&#8220;The security company said Dark Halo is a sophisticated threat actor that had no links to any publicly known threat actors.&#8221;</p>
<p>So they do not think APT28 or APT29 or other known group. But why&#8230;</p>
<p>Well if you look towards the top of the Volexity article you find,</p>
<p>&#8220;FireEye attributed this activity to an unknown threat actor it tracks as UNC2452. Volexity has subsequently been able to tie these attacks to multiple incidents it worked in late 2019 and 2020 at a US-based think tank. Volexity tracks this threat actor under the name Dark Halo.&#8221;</p>
<p>OK so UNC2452 / Dark Halo are &#8216;new but old&#8217; that is as Volexity put it,</p>
<p>&#8220;During the investigation Volexity discovered no hints as to the attacker‚Äôs origin or any links to any publicly known threat actor.&#8221;</p>
<p>So not just &#8216;unknown&#8217; untill fairly recently but their location or who they work for is likewise &#8216;unknown&#8217; still.</p>
<p>But what linked Volexity&#8217;s &#8220;Dark Halo&#8221; and FireEye&#8217;s &#8220;UNC2452&#8221;, Was,</p>
<p>&#8220;At the time of the investigation, Volexity deduced that the likely infection was the result of the SolarWinds box on the target network&#8221;</p>
<p>Now to misquote @Bruce,</p>
<p>&#8220;That is interesting.&#8221;</p>
<p>But not as interesting as the fact that this attack was also one where secret keys used as credentials were obtained when they should not have been.</p>
<p>Yes read that paragraph again, it&#8217;s a very important point. What it is telling you is that,</p>
<p>&#8216;If your &#8220;Root of Trust&#8221; is not secure you have no security.&#8217;</p>
<p>We do not have enough &#8220;publicly known&#8221; information to know how the compromise happened in the attack on SolarWinds. But we can see how SolarWinds software was leveraged to compromise the &#8220;root of trust&#8221; or what is called by Volexity the &#8220;akey&#8221; on a fully compromised infrastructure server.</p>
<p>However the argument that you can not stop a secret key compromise to an infrastructure server that is fully compromised is actually not true, and has not been for a couple of decades or more&#8230;</p>
<p>Firstly, Intel and other CPU&#8217;s have ways to protect secret data in a computers memory in &#8220;enclaves&#8221;. Whilst there are now known &#8216;hardware&#8217; failings that can be exploited there is as yet no evidence for that in this case.</p>
<p>Secondly, the &#8216;enclave&#8217; idea was not original to Intel or other CPU manufacturers, they got the idea from earlier technology called &#8216;Hardware Security Modules&#8217; or just HSMs. But they in turn got it from earlier technology such as &#8216;Crypto-Coprocessors&#8217; going back to before the days of the ISA Bus in IBM PC&#8217;s (the earliest such device I remember was an AMD Z80 CPU 32k of ROM, 32k of RAM part of which was a battery backed up bytewide static RAM chip and Real Time Clock and an AMD DES chip).</p>
<p>These enabled secret keys and other secret data to be stored safely in seperate memory behind Crypto devices that performed the required cryptographic actions. Whilst not inexpensive they were generally thought to be secure.</p>
<p>The HSMs are modern equivalents used in Banking / Finance and other areas where security is taken a little more seriously. Possibly the one most known is at the top of the DNS-Sec system,</p>
<p><a href="https://www.cloudflare.com/dns/dnssec/root-signing-ceremony/" rel="nofollow ugc">https://www.cloudflare.com/dns/dnssec/root-signing-ceremony/</a></p>
<p>Whilst organisations do not need to have nuclear bunker type security around HSMs, the HSMs do give everyone down stream a &#8216;root of trust&#8217; that can be reasonably relied on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-360770">

			<div class="comment by-wiredog ">

				<p class="commentcredit">

					<span class="commenter">wiredog</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360770">
						December 16, 2020 4:54 AM					</a>

				</p>

				<blockquote><p>
Security researcher Vinoth Kumar told Reuters that, last year, he alerted the company that anyone could access SolarWinds‚Äô update server by using the password ‚Äúsolarwinds123‚Äù
</p></blockquote>
<p>That&#8217;s amazing! I&#8217;ve got the same combination on my luggage!</p>
<p><a href="https://www.reuters.com/article/global-cyber-solarwinds/hackers-at-center-of-sprawling-spy-campaign-turned-solarwinds-dominance-against-it-idUSKBN28P2N8" rel="nofollow ugc">https://www.reuters.com/article/global-cyber-solarwinds/hackers-at-center-of-sprawling-spy-campaign-turned-solarwinds-dominance-against-it-idUSKBN28P2N8</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-360784">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">Tom</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360784">
						December 16, 2020 7:15 AM					</a>

				</p>

				<p>&#8220;Whilst organisations do not need to have nuclear bunker type security around HSMs, the HSMs do give everyone down stream a ‚Äòroot of trust‚Äô that can be reasonably relied on.&#8221;</p>
<p>HSMs have also been subject to attacks in the past though.<br />
The latest one I remember being <a href="https://cryptosense.com/blog/how-ledger-hacked-an-hsm/" rel="nofollow ugc">https://cryptosense.com/blog/how-ledger-hacked-an-hsm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-360919">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-360919">
						December 17, 2020 10:35 PM					</a>

				</p>

				<p>NSA chimes in</p>
<p>hXXps://www.nsa.gov/News-Features/Feature-Stories/Article-View/Article/2451159/nsa-cybersecurity-advisory-malicious-actors-abuse-authentication-mechanisms-to/</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-361245">

			<div class="comment by-ray-morris ">

				<p class="commentcredit">

					<span class="commenter">Ray Morris</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-361245">
						December 21, 2020 1:50 PM					</a>

				</p>

				<p>The fact that random applications contain, in clear text, a secret that can be used to bypass the secrets of all users in a major flaw in Duo&#8217;s <em>protocol</em>. The industry standard TOTP and HOTP protocols don&#8217;t have this vulnerability.</p>
<p>One commenter said &#8220;it&#8217;s not Duo&#8217;s fault if an attacker gets the keys&#8221;.<br />
I say it is Duo&#8217;s fault that their system requires putting master keys in plaintext on random application servers.</p>
<p>It&#8217;s Duo&#8217;s fault that there <em>are</em> master keys, rather than requiring that the user&#8217;s key be used to login as that user.</p>
<p>In this case, Duo requires that the key be under the doormat, so it is Duo&#8217;s fault that they those keys are taken.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-362374">

			<div class="comment by-inthedocs ">

				<p class="commentcredit">

					<span class="commenter">Inthedocs</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-362374">
						January 7, 2021 7:37 PM					</a>

				</p>

				<p>Rick, a Duo MFA admin states: there isn‚Äôt such thing as a Duo ‚Äúakey‚Äù btw, that‚Äôs a type-o üòâ</p>
<p>But if you read the Duo docs:<br />
<a href="https://duo.com/docs/duoweb" rel="nofollow ugc">https://duo.com/docs/duoweb</a></p>
<p>Instructions<br />
1. Generate an akey</p>
<p>Your akey is a string that you generate and keep secret from Duo. It should be at least 40 characters long and stored alongside your Web SDK application&#8217;s integration key (ikey) and secret key (skey) in a configuration file.</p>
<p>You can generate a random string in Python with:</p>
<p>import os, hashlib<br />
print(hashlib.sha1(os.urandom(32)).hexdigest())</p>
<p>Safeguard your skey and akey!</p>
<p>The security of your Duo application is tied to the security of your skey and akey. Treat these pieces of data like a password. They should be stored in a secure manner with limited access, whether that is in a database, a file on disk, or another storage mechanism. Always transfer them via secure channels, and do not send them over unencrypted email, enter them into chat channels, or include them in other communications with Duo.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-362984">

			<div class="comment by-chris-drake ">

				<p class="commentcredit">

					<span class="commenter">Chris Drake</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-362984">
						January 15, 2021 2:39 AM					</a>

				</p>

				<p>YES IT IS a DUO vulnerability.</p>
<p>It is BEYOND OBVIOUS that nothing and nobody who has access to the server should be able to impersonate one of the users.</p>
<p>Just because some lazy programmer said that a vulnerability is &#8220;not in their threat model&#8221;, does not suddenly make everything hunky-dory OK.</p>
<p>DUO is an App on a smartphone.  Last time I checked, those are capable of doing asymmetric crypto themselves perfectly well &#8211; even using biometrics if you feel the need, and if you really want to solve some problems &#8211; performing mutual authentication and access logging as well.  All Obvious.  All missing from DUO.</p>
<p>This is the #1 problem with security.  Everyone uses what everyone else uses, and nobody bothers to think about, or even care about, all the out-of-scope holes in the stuff they&#8217;re using.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-363090">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-363090">
						January 15, 2021 4:32 AM					</a>

				</p>

				<p>@ Chris Drake,</p>
<blockquote><p>Just because some lazy programmer said that a vulnerability is ‚Äúnot in their threat model‚Äù, does not suddenly make everything hunky-dory OK.</p></blockquote>
<p>Saying something is outside your threat model is not of necessity &#8220;lazy&#8221; behaviour.</p>
<p>All authentication systems require &#8220;a shared secret&#8221; if you spend a little time thinking about it you will realise that software on a General Purpose Computer can not in any way protect such a secret.</p>
<p>To protect it you need certain hardware arrangements, but they are not in General Purpose Computing by design&#8230;</p>
<p>Whilst you might argue that there are &#8220;security enclaves&#8221; in modern CPU&#8217;s that actuall does not solve the problem it mearly moves it. Because where does the secret come from on power up?</p>
<p>Put simply either someone has to type it in, or it has to be read from semi-mutable memory such as a file on disk.</p>
<p>So how do you protect the file on disk? Well you could use encryption, but where do you get the key from?</p>
<p>You are in an endless loop that you can not solve with general purpose computers.</p>
<p>It&#8217;s one of the reasons Hardware Security Modules (HSMs) were designed, but they also have their own problems. As has been demonstrated with the attack on the Google 2FA key even secrets hidden in purpose designed chips are vulnerable to side channel attacks.</p>
<p>You thus have to be able to fully protect the shared secret,</p>
<p>1, When it is stored.<br />
2, When it is communicated.<br />
3, When it is processed.</p>
<p>And we realy do not know how to do all of those&#8230;</p>
<p>By all means feel free to try to &#8220;Invent a better mouse trap&#8221;, in software but I don&#8217;t think your chances are that good&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-365942">

			<div class="comment by-serg ">

				<p class="commentcredit">

					<span class="commenter">serg</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-365942">
						January 18, 2021 2:18 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>&#8220;Whilst you might argue that there are ‚Äúsecurity enclaves‚Äù in modern CPU‚Äôs that actuall does not solve the problem it mearly moves it. Because where does the secret come from on power up?&#8221;</p>
<p>Its 21st century. Nowadays most of the enterprise class PCs have &#8220;security enclaves&#8221; (Mac) or TPM (PC). The secret is stored inside these. Then you can &#8220;ask&#8221; these &#8220;security enclaves&#8221;/TPMs to use the stored secret to encrypt or sign. The secret NEVER leaves the &#8220;security enclaves&#8221;/TPMs in plain text</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-365946">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-365946">
						January 18, 2021 3:21 AM					</a>

				</p>

				<p>@ serg,</p>
<blockquote><p>The secret NEVER leaves the ‚Äúsecurity enclaves‚Äù/TPMs in plain text</p></blockquote>
<p>You&#8217;ve missed the point.</p>
<p>Those security enclaves when powered up do not have the secrets in them. Those secrets have to come from somewhere else.</p>
<p>Hence my rhetorical question of,</p>
<p>&#8220;Because where does the secret come from on power up?&#8221;</p>
<p>The secret has to be stored somewhere else, so as I indicated the &#8220;problem&#8221; has been moved not solved.</p>
<p>The secret is vulnerable when it is moved from semi mutable memory to mutable memory.</p>
<p>Even HSM&#8217;s and security tokens often fall foul of this problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-369378">

			<div class="comment by-chris-van-genderen ">

				<p class="commentcredit">

					<span class="commenter">Chris Van Genderen</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-369378">
						February 17, 2021 2:55 PM					</a>

				</p>

				<p>@Clive Robinson,All,</p>
<p>I agree, software based crypto is simply not adequate to protect and use highly sensitive keys.</p>
<p>To Clive Robinson&#8217;s point on key loading with respect to HSMs: HSMs typically have a &#8220;master key&#8221; or a &#8220;series of master keys&#8221; which are used to encrypt and manage all secrets within the secure perimeter of the device.  The master keys are all generated within the secure perimeter and loaded from non-volatile memory within the secure perimeter&#8230;i.e. the clear text key(s) never exists outside the secure perimeter and they are not &#8220;loaded in&#8221;.  However, unlike software, the secure perimeter of the HSM is protected physically (Epoxy Slurry, Semiconductor obfuscation, active tamper hardware ), and logically ( temperature monitoring, voltage monitoring, side channel obfuscation, and optionally requiring 2FA authorizing use of keys inside the HSM with other hardware based systems&#8230;i.e. Smart Card(s)) An HSM secure perimeter is an environment designed specifically to manage authorized use and protection of sensitive cryptographic keys. So, are they loading keys? Yes, but in a very controlled and hardware managed environment. Not anything remotely like an open software environment.</p>
<p>Are they perfect?&#8230;No&#8230;  However, they provide a formidable challenge to retrieving or achieving non-authorized use of a key. In general, if an HSM is used to manage a sensitive key; an attacker will find another path forward. It is effectively a Stop sign.</p>
<p>If the Duo skey / akey was able to be protected with an HSM, then this vector of attack to further compromise systems via use of authentic logins might have been closed.</p>
<p>In essence, the use of an HSM attempts to force an attacker to use a more easily discoverable penetration of a system.</p>
<p>With software based crypto, you are simply &#8220;leaving your keys under the mat&#8221; from an attackers perspective. They are going to go after them; especially if the end result is a valid user within the environment.  Much harder to discover an attacker that looks like you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-369380">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/#comment-369380">
						February 17, 2021 3:50 PM					</a>

				</p>

				<p>@ Chris Van Genderen, ALL,</p>
<blockquote><p>Are they perfect?‚Ä¶No‚Ä¶ However, they provide a formidable challenge to retrieving or achieving non-authorized use of a key.</p></blockquote>
<p>In all honesty I don&#8217;t believe they can be made perfect or 100% secure, but then I don&#8217;t believe anything can when it comes to security time makes fools of us all[1].</p>
<p>The only constants in life appear to be the laws of physics (so far) thus maybe if we design to those we might gain security over time.</p>
<p>Thus as security workers / researchers / designers / thinkers we need to work out ways to leverage the laws of physics into our designs as in effect &#8220;mitigation techniques&#8221; around systems we know are &#8220;good&#8221; but in reality can not be &#8220;good enough for long enough&#8221;.</p>
<p>We will never be able to mitigate insider attackers who walk around with a muti-tool in their handcand the root password in their pocket. But we can make their lives more difficult. However I think we can if we are prepared to do things in ways that work with the laws of physics in our favour but not those of outsiders, keep the outsiders out.</p>
<p>Thus the question falls to that of investment and economics, which are fields of endever where even the wise walk with caution.</p>
<p>[1] We used to joke about putting a computer in a block of concreate and droping it in the worlds deepest ocean trench&#8230; Then some famous film maker got involved and the next thing you know they&#8217;ve built and deployed a mini sub to go down and see the bottom of the trench real close up and gather samples&#8230; As has been observed security attacks tend to get better with time, and what could not be done just a handfull of years ago, is now beginning to look like childs play.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2020%2F12%2Fhow-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2020/12/how-the-solarwinds-hackers-bypassed-duo-multi-factor-authentication.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='60605' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2020/12/another-massive-russian-hack-of-us-government-networks.html" rel="prev">‚Üê Another Massive Russian Hack of US Government Networks</a>		<a href="https://www.schneier.com/blog/archives/2020/12/zodiac-killer-cipher-solved.html" rel="next">Zodiac Killer Cipher Solved ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
