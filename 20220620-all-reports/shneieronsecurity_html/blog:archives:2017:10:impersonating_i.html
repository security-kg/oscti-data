<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Impersonating iOS Password Prompts - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Impersonating iOS Password Prompts Comments Feed" href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/11329" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=11329' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F10%2Fimpersonating_i.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F10%2Fimpersonating_i.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-11329 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-11329" class="post-11329 post type-post status-publish format-standard hentry category-uncategorized tag-apple tag-impersonation tag-ios tag-passwords tag-social-engineering tag-spoofing tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">Impersonating iOS Password Prompts</h2>
		<p>This is an interesting security vulnerability: because it is <a href="https://krausefx.com/blog/ios-privacy-stealpassword-easily-get-the-users-apple-id-password-just-by-asking">so easy to impersonate</a> iOS password prompts, a malicious app can steal your password just by asking.</p>
<blockquote><p>Why does this work?</p>
<p>iOS asks the user for their iTunes password for many reasons, the most common ones are recently installed iOS operating system updates, or iOS apps that are stuck during installation.</p>
<p>As a result, users are trained to just enter their Apple ID password whenever iOS prompts you to do so. However, those popups are not only shown on the lock screen, and the home screen, but also inside random apps, e.g. when they want to access iCloud, GameCenter or In-App-Purchases.</p>
<p>This could easily be abused by any app, just by showing an UIAlertController, that looks exactly like the system dialog.</p>
<p>Even users who know a lot about technology have a hard time detecting that those alerts are phishing attacks.</p></blockquote>
<p>The essay proposes some solutions, but I&#8217;m not sure they&#8217;ll work. We&#8217;re all trained to trust our computers and the applications running on them.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/apple/" rel="tag">Apple</a>, <a href="https://www.schneier.com/tag/impersonation/" rel="tag">impersonation</a>, <a href="https://www.schneier.com/tag/ios/" rel="tag">iOS</a>, <a href="https://www.schneier.com/tag/passwords/" rel="tag">passwords</a>, <a href="https://www.schneier.com/tag/social-engineering/" rel="tag">social engineering</a>, <a href="https://www.schneier.com/tag/spoofing/" rel="tag">spoofing</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html" rel="bookmark">Posted on October 12, 2017 at 6:43 AM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html#comments">22 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html" data-title="Impersonating iOS Password Prompts" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-309089">

			<div class="comment by-jeffrey-friedl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://regex.info/blog/' rel='external nofollow ugc' class='url'>Jeffrey Friedl</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309089">
						October 12, 2017 7:23 AM					</a>

				</p>

				<p>I&#8217;ve long wondered about this on iOS and OSX, and thought that as part of the account-creation process they take a photo and store it securely, always showing that for system dialogs. Since only the system would have access to those pixels, you could trust any dialog that showed them as part of the prompt.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309090">

			<div class="comment by-catherine-punjani ">

				<p class="commentcredit">

					<span class="commenter">Catherine Punjani</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309090">
						October 12, 2017 7:27 AM					</a>

				</p>

				<p>My Cousin is always in trouble. Phishing is probably just one of the ways he &#8216;gets his revenge&#8217; on everyone &amp; everything when he&#8217;s angry. It&#8217;s unfortunate that not everyone reads or Subscribes to your Website! False dialog boxes? Nothing new!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309091">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309091">
						October 12, 2017 7:33 AM					</a>

				</p>

				<p>Not being nasty but many users are just like Pavlov&#8217;s dogs were supppsed to be&#8230;</p>
<p>I&#8217;m not realy sure there is a solution for &#8220;fixing the user&#8221; or for that matter &#8220;fixing the technology&#8221;.</p>
<p>The thing is it&#8217;s a question of &#8220;learned trust&#8221; the user sees the same prompt each time and just does it, they don&#8217;t see where the prompt has come from. Most humans are born to trust, it&#8217;s only experience that teaches them otherwise. Thus if they do not get immediate bad feedback or obviously attributable bad feedback later, they are none the wiser.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309092">

			<div class="comment by-tatutata ">

				<p class="commentcredit">

					<span class="commenter">Tat√ºtata</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309092">
						October 12, 2017 8:26 AM					</a>

				</p>

				<p>Yet another variation on phishing attacks.</p>
<p>Simulated login dialogues go back to mainframe computers, but back then it was more something of a juvenile prank than a security risk. In the same vein, it was possible on certain DEC systems to send messages from one terminal to another. With the appropriate VT52 control sequences you could provoke cussing by the user on terminal #0, by simulating the bootstrap console dialogue. That !@#!@ computer crashed again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309093">

			<div class="comment by-deimos ">

				<p class="commentcredit">

					<span class="commenter">Deimos</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309093">
						October 12, 2017 8:43 AM					</a>

				</p>

				<p>This question seems fundamental: How can a user be assured that a prompt for credentials can be trusted?</p>
<p>The PKI addresses this issue on the web. Local use of one-time passwords could mitigate the risk to a degree. But what about a prompt for a &#8220;master&#8221; password like that of an Apple keychain or a password manager? Really the only thing that a user currently has to guide them is the action that elicited the prompt, and users might have no idea what the connection between their action and the prompt is.</p>
<p>Can&#8217;t we do better than that?</p>
<p>(And don&#8217;t folks feel strange entering their Facebook or Google credentials into non-Facebook/non-Google web sites?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309094">

			<div class="comment by-mose ">

				<p class="commentcredit">

					<span class="commenter">Mose</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309094">
						October 12, 2017 10:35 AM					</a>

				</p>

				<p>Microsoft solved this in the nineties with CTRL ALT DELETE. It made the combination always go to the operating system, and trained users accordingly. On iOS, the home button is sacrosanct. Make the real dialogs require a click of the home button in a future iOS version. Show the new dialog during the post-update &#8220;Hello&#8221; wizard, and hit the user at least thrice in the week following the upgrade with the new dialog.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309095">

			<div class="comment by-iggy ">

				<p class="commentcredit">

					<span class="commenter">Iggy</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309095">
						October 12, 2017 11:12 AM					</a>

				</p>

				<p>As Heinlein said, there is no free lunch. I add no apps to my cell phones. I insist that my phone be a phone first and never a basket full of goo-gahs.</p>
<p>We&#8217;re trained to blindly comply. Conditioned, intimidated, and persuaded into complying, in the interest of convenience. The device and app makers learned early to sell us the illusion of sparing us troubling our pretty little heads over such things as taking the time to care for our privacy and security. Pish posh, let such dark and uncomfortable truths no longer be on our individual radar scopes, they&#8211;Apple, Google, Microsoft, Android, etc, etc&#8211;will slaughter our livestock for our dining pleasure so we need not give it a second thought.</p>
<p>Only&#8230; now we wear the ear tags, called the IMEI. Subdue that niggling nag in the gut, meekly comply. Dare to object, to hold back, to question and be served a quick rebuke of &#8220;look, do you want to use the phone or not?&#8221; Either or, in or out, no in between. Because now it&#8217;s gonna be very hard to pass a law that allows each individual to negotiate* the Terms of Use, better called the Terms of Disenfranchisement. In the interest of mass sales at break neck pace, Apple and Alphabet argue very successfully, we&#8217;ll put the docile on the hook with a simple &#8220;don&#8217;t agree? then don&#8217;t use, but we&#8217;ll keep your money, you keep the device.&#8221; And while the bulk of humanity stampedes to use-use-use, unless you do too, you are left in the dust of obsolescence and the Courts just blankly stare at you.</p>
<p>*At a minimum, build in opt-outs throughout the TOS where the buyer can at least customize their compliance.</p>
<p>Don&#8217;t worry about the customer&#8211;you and me&#8211;being now always wrong. No, no, we are not the customer&#8230; we are the livestock.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309096">

			<div class="comment by-brian-carnell ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://brian.carnell.com' rel='external nofollow ugc' class='url'>Brian Carnell</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309096">
						October 12, 2017 11:12 AM					</a>

				</p>

				<p>My experience buying an iPad recently after not using one for several years was very confusing on this point.</p>
<p>The request to enter either a device or Apple ID creds seemed inconsistent. For example, I was surprised that after using the device for a few weeks and wanting to install a free application that the device asked me for my Apple ID.</p>
<p>Similarly, I&#8217;m constantly asked to approve minor changes by entering the device password, but several apps let me open non-secure FTP servers to the device with just a toggle and no request for additional authorization.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309097">

			<div class="comment by-juvenile-prank ">

				<p class="commentcredit">

					<span class="commenter">juvenile prank</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309097">
						October 12, 2017 11:25 AM					</a>

				</p>

				<p>I remember back in 1985, the DOS 3.1 command prompt could be modified to display (for example) directory you were currently in, or date/time, etc.  In a juvenile prank I enjoyed then and still enjoy reminiscing about today, I changed the prompt on our laboratory data-acquisition computer to</p>
<p>C:\Enter password&gt;</p>
<p>just to tweak the tailfeathers of my boss (sorry, David!).  Needless to say (to this audience) there was no password.</p>
<p>I never explored the hacking possibilities, though.  My inclinations were elsewhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309098">

			<div class="comment by-mostly-harmful ">

				<p class="commentcredit">

					<span class="commenter">mostly harmful</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309098">
						October 12, 2017 11:38 AM					</a>

				</p>

				<p>My passwords are my keys.</p>
<p>When I want to get into my house, I go the front door and get out my housekey.</p>
<p>When I want access to my toolbox, or a car, I walk over to where it is, and get out the appropriate key.</p>
<p>It is never a surprise requirement. It is a known-in-advance, sufficient and necessary, condition for access to certain resources.</p>
<p>I use my keys to control my environment, not the other way around. And only certain parts of it. I know I need them, only and always, in specific contexts. The time is always of my choosing: when I choose to use the resource.</p>
<p>The day somebody accosts me and demands my keys in a context unforeseen, not of my choosing, I know I am either being robbed, or have entered a &#8220;Papers, please&#8221; police state scenario.</p>
<p>In a unix terminal environment, this physical analogy seems rather apt.</p>
<p>The problems arise, maybe, when one begins to imagine that &#8220;pop-up windows&#8221; are appropriate places to insert keys, instead of the rectangular openings found at the top of toasters. Perhaps the very name of the widget indicates the root of the problem.</p>
<p>Problems &#8220;pop up&#8221;. Locks stay where they are, and await your approach.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309099">

			<div class="comment by-rick-lobrecht ">

				<p class="commentcredit">

					<span class="commenter">Rick Lobrecht</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309099">
						October 12, 2017 11:44 AM					</a>

				</p>

				<p>Windows has a good solution for this if User Access Control (UAC) is turned on (and it really should be).  Any prompt for administrative credentials, or administrative privileges, is requested in a secure shell that is visually distinct from your user applications.  Assuming this idea isn&#8217;t patented, something similar could be done in MacOS or iOS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309100">

			<div class="comment by-mostly-harmful ">

				<p class="commentcredit">

					<span class="commenter">mostly harmful</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309100">
						October 12, 2017 11:50 AM					</a>

				</p>

				<blockquote><p>The problems arise, maybe, when one begins to imagine that &#8220;pop-up windows&#8221; are appropriate places to insert keys, instead of the rectangular openings found at the top of toasters.</p></blockquote>
<p>I phrased this poorly. <b>Do not ever insert your keys, or anything else metallic, into an electric toaster.</b> Death or serious injury may be the result!</p>
<p>I only meant that &#8220;pop-up window&#8221; would be a good name for the orifice found at the top of a vertical-style toaster.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309101">

			<div class="comment by-jeremy ">

				<p class="commentcredit">

					<span class="commenter">Jeremy</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309101">
						October 12, 2017 2:05 PM					</a>

				</p>

				<p>@Deimos <em>&#8220;And don&#8217;t folks feel strange entering their Facebook or Google credentials into non-Facebook/non-Google web sites?&#8221;</em></p>
<p>I&#8217;m&#8230;reasonably sure that you should NEVER be doing that.</p>
<p>If a site wants you to log in via (say) Google, it should <strong>redirect</strong> your browser to Google for the log-in process, and then Google should tell them who you are.  You should NOT be entering your Google password into the original web site.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309102">

			<div class="comment by-techno ">

				<p class="commentcredit">

					<span class="commenter">Techno</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309102">
						October 12, 2017 2:51 PM					</a>

				</p>

				<p>In order to show me the fake password prompt, the app has to be already on my iPhone and running. The damage is done!<br />
It&#8217;s like worrying that someone you already let in your home and is sleeping on your bed can cut your throat. D&#8217;uh!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309103">

			<div class="comment by-aph ">

				<p class="commentcredit">

					<span class="commenter">Aph</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309103">
						October 12, 2017 3:50 PM					</a>

				</p>

				<p>One thing that has always annoyed me about these prompts is that in addition to them coming up randomly, there is no way for me to dismiss the prompt and know where to enter the data later by following a recommended pathway.</p>
<p>E.g. if it&#8217;s an icloud prompt,it should say &#8220;Go to Settings::iCloud to enter the password later&#8221; or something like that.</p>
<p>This would also help users who use a password manager with a complex password, as it&#8217;s rare that the AppleID password would randomly be on the clipboard, and the prompts are often made when it&#8217;s not convenient to bring up a secondary device to get and retype the error-prone gobbledegook.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309104">

			<div class="comment by-mike-gualtieri ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.mike-gualtieri.com' rel='external nofollow ugc' class='url'>Mike Gualtieri</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309104">
						October 12, 2017 11:30 PM					</a>

				</p>

				<p>It&#8217;s also trivial to create a replica of the login modal using HTML/CSS, which means the phishing vector can be initiated from a mobile browser.  I posted a <a href="https://www.mike-gualtieri.com/posts/ios-credential-phishing-flaw-not-limited-to-malicious-apps" rel="nofollow ugc">brief blurb</a> yesterday after I came across the same post.  Doing a little digging I found that variations of the flaw have been used in phishing scams previously.  The sensible solution is to eliminate the popup modal and handle logins within the iOS settings.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309105">

			<div class="comment by-evilkiru ">

				<p class="commentcredit">

					<span class="commenter">EvilKiru</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309105">
						October 12, 2017 11:56 PM					</a>

				</p>

				<p>@Mike: You can get around the browser modal dialog attack on iDevices by double-tapping the home key and killing the browser.</p>
<p>I&#8217;ve also seen this type of attack in Windows web browsers. It&#8217;s easily defeated if you have multiple non-mirrored monitors, which I fortunately have on all of the computers I use, because the modal attack only applies to the monitor the browser is on. So all you have to do is click on the other monitor, Ctrl+Alt+Esc and kill the browser.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309106">

			<div class="comment by-werner ">

				<p class="commentcredit">

					<span class="commenter">Werner</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309106">
						October 13, 2017 1:32 AM					</a>

				</p>

				<p>A few thoughts and comments, mostly expanding on ideas from previous posters:</p>
<ul>
<li>have a reserved visual style for &#8220;official&#8221; prompts: easy to do, but<br />
1) how to ensure users understand what to look for ?<br />
2) how to resist the temptation of changing that style in the next release ?<br />
3) how to prevent apps from mimicking the style ?</li>
<li>add a segregated UI element to indicate that it&#8217;s an &#8220;official&#8221; prompt.<br />
That could be part of the screen, a LED, etc.<br />
This should simplify 3) from above, maybe leave few enough choices to<br />
eliminate 2), only leaving 1).</li>
<li>go one step further and outsource the dialog to an external authentication manager.<br />
Ideally combined with an end-to-end protocol, but in a pinch going through some trusted element in the phone (as long as that element doesn&#8217;t get compromised) would work, too.<br />
This has of course its own set of issues, e.g., that few people have such a thing in the first place.</li>
<li>have a &#8220;secure attention key&#8221; that enters a mode in which only that trusted part of the system can interact with the user. So when an application needs credentials, it would prompt the user to request the &#8220;official prompt&#8221; by pressing that SAK.<br />
Drawbacks:<br />
1) one extra interaction step,<br />
2) modal dialog may interfere with workflow,<br />
3) any 3rd party authentication helpers would need an explicit API (which may not be a bad thing per se),<br />
4) application could successfully pretend that mode is active longer than it actually is.</li>
</ul>
<p>The main problem for all this is that such requests tend to increase in number. If it&#8217;s just used for payment operations, it may be infrequent enough for users to pay attention. If it comes up for all sorts of things (e.g., to post an evaluation of an app, games nag you to create an account for saving scores, etc.), then no mechanism is safe in the long run. Even worse, the particularly strong ones that provide a clear distinction may suffer more since it may be harder to extend them to multiple levels.</p>
<p>In a way, this is a convergence: while things like payment are getting easier, the number of banalities that receive similar degrees of protection (&#8220;create a fully verified account and rate our whatever before we let you continue&#8221;, &#8220;register to read (something that&#8217;s public information)&#8221;, etc.) increases. Where they meet, the user gets overloaded and the phisher triumphs.</p>
<ul>
<li>Werner</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309107">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309107">
						October 13, 2017 2:17 AM					</a>

				</p>

				<p>I haven‚Äôt read the essay. Too tired. This is an area that secure I/O attempted to solve with various degrees of success. The main idea is to show the user a standard screen that no software component can overlay any elements on top of it. Both input and output have to be ‚Äúsecure‚Äù. Other enhancements were discussed somewhere in the deep bowls of this blog, e.g. look for multi-entity&copy; authentication (different than multi factor, and can be combined with multifactor), which invalidates stolen user‚Äô credentials: credentials are only valid if they are entered from an authenticated device. This way, a password of ‚Äú123‚Äù is not as weak as it looks. Details are somewhere here..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309108">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309108">
						October 13, 2017 2:34 AM					</a>

				</p>

				<p>A little off topic (if you don‚Äôt ‚Äúcatch my drift‚Äù)</p>
<p>Long time ago I used a Toshiba 2SA-49 Germanim transistor for an RF oscillator ~100MHz range. I also used a Silicon <b>2SC</b>-something for other things that I forgot.</p>
<p>So I‚Äôll call multi-entity authentication: 2SCA! Makes a lot of sense in my current goofy state. The ‚Äú2‚Äù isn‚Äôt really needed but looks more impressive. ‚ÄúDSCA‚Äù also works üôÇ</p>
<p>Not a difficult puzzle! First correct solution gets a virtual $10 (+1)</p>
<p>D stands for ‚ÄòDual‚Äô</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-309109">

			<div class="comment by-thaumatechnician ">

				<p class="commentcredit">

					<span class="commenter">ThaumaTechnician</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309109">
						October 13, 2017 6:50 AM					</a>

				</p>

				<p>In my case, the Apple password is long and random &#8211; I need to log into my password manager to retrieve it then I can paste it into the prompt &#8211; which I almost never do.</p>
<p>It&#8217;s a simple problem, with a simple fix:<br />
Never enter your password &#8211; ANYWHERE &#8211; unless <b>you</b> are doing something that requires the password.</p>
<p>More generally, don&#8217;t respond to any security/financial/personal inquiry/download/phonecall request that you did not initiate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-309110">

			<div class="comment by-mike-gualtieri ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.mike-gualtieri.com' rel='external nofollow ugc' class='url'>Mike Gualtieri</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/#comment-309110">
						October 13, 2017 8:28 AM					</a>

				</p>

				<p>@EvilKiru you bring up a good point with the home button, although I&#8217;m sure many folks would plug in their password without any additional checks.  The flaw presented in the article is also defeated with a home button press since the modal is part of the app being closed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2017/10/impersonating_i.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2017/10/impersonating_i.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2017%2F10%2Fimpersonating_i.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2017/10/impersonating_i.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='11329' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2017/10/more_on_kaspers.html" rel="prev">‚Üê More on Kaspersky and the Stolen NSA Attack Tools</a>		<a href="https://www.schneier.com/blog/archives/2017/10/technology_to_o.html" rel="next">Technology to Out Sex Workers ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
