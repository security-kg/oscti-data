<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Trojan Steals Credit Card Numbers - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Trojan Steals Credit Card Numbers Comments Feed" href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3748" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3748' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F01%2Ftrojan_steals_c.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F01%2Ftrojan_steals_c.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3748 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3748" class="post-3748 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-android tag-cell-phones tag-credit-cards tag-cybercrime tag-google tag-malware">

	<div class="article">

		<h2 class="entry">Trojan Steals Credit Card Numbers</h2>
		<p>It&#8217;s only a proof of concept, but it&#8217;s scary nonetheless.  It&#8217;s a <a href="http://www.thinq.co.uk/2011/1/20/android-trojan-captures-credit-card-details/">Trojan</a> for Android phones that looks for credit-card numbers, either typed or spoken, and relays them back to its controller.</p>
<blockquote><p>Software released for Android devices has to request permissions for each system function it accessesâ€”with apps commonly requesting access to the network, phone call functionality, internal and external storage devices, and miscellaneous hardware functions such as the backlight, LED, or microphone. These requests are grouped into categories and presented to the user at the point of installationâ€”helping to minimise the chance of a Trojan slipping by.</p>
<p>Soundminer takes a novel approach to these restrictions, by only requesting access to &#8216;Phone calls,&#8217; to read phone state and identity, &#8216;Your personal information,&#8217; to read contact data, and &#8216;Hardware controls&#8217; to record audioâ€”none of which will ring alarm bells if the app is marketed as a voice recording tool.</p></blockquote>
<p>Research paper <a href="https://www.cs.indiana.edu/~kapadia/papers/soundminer-ndss11.pdf">here</a>. YouTube <a href="http://www.youtube.com/watch?v=_wDhzLuyR68">demo</a>.  Another <a href="http://s.forbes.com/andygreenberg/2011/01/19/researchers-android-trojan-can-hear-credit-card-numbers/">blog post</a>.  <a href="https://www.cs.indiana.edu/~kapadia/papers/soundminer-ndss11.pdf">Research paper</a>; section 7.2 describes some defenses, but I&#8217;m not really impressed by any of them.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/android/" rel="tag">Android</a>, <a href="https://www.schneier.com/tag/cell-phones/" rel="tag">cell phones</a>, <a href="https://www.schneier.com/tag/credit-cards/" rel="tag">credit cards</a>, <a href="https://www.schneier.com/tag/cybercrime/" rel="tag">cybercrime</a>, <a href="https://www.schneier.com/tag/google/" rel="tag">Google</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html" rel="bookmark">Posted on January 29, 2011 at 7:45 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html#comments">43 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html" data-title="Trojan Steals Credit Card Numbers" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-154194">

			<div class="comment by-henning-makholm ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.henning.makholm.net/' rel='external nofollow ugc' class='url'>Henning Makholm</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154194">
						January 29, 2011 7:59 AM					</a>

				</p>

				<p>&#8220;Hardwars controls&#8221; does sound like an awfully broad permission to give.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154195">

			<div class="comment by-henning-makholm ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.henning.makholm.net/' rel='external nofollow ugc' class='url'>Henning Makholm</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154195">
						January 29, 2011 8:00 AM					</a>

				</p>

				<p>HardwarE too, even.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154196">

			<div class="comment by-go2null ">

				<p class="commentcredit">

					<span class="commenter">go2null</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154196">
						January 29, 2011 8:34 AM					</a>

				</p>

				<p>I&#8217;d also venture to say that most users just tap pass the permission screen without reading.  (Just like the EULA screens.)</p>
<p>This is partially due to the users not understanding (or caring) about the permissions, poorly wriiten apps that ask for unneeded permissions, and no way to revoke individual permissions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154197">

			<div class="comment by-bruce-stephens ">

				<p class="commentcredit">

					<span class="commenter">Bruce Stephens</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154197">
						January 29, 2011 9:02 AM					</a>

				</p>

				<p>All of the permissions are overly broad (IMHO).  And your options are to accept or reject all of them (rejecting meaning you don&#8217;t get the application).</p>
<p>OTOH, if the permissions were more specific you&#8217;d likely end up with terms that nobody would read.</p>
<p>And phones get installed with apps (sometimes hard to remove) from the manufacturer and (potentially) the network.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154198">

			<div class="comment by-nidhi ">

				<p class="commentcredit">

					<span class="commenter">Nidhi</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154198">
						January 29, 2011 9:31 AM					</a>

				</p>

				<p>Network communication? Really..why would an app need that?<br />
I am wondering how much testing do these cellphone companies so as to allow the existence of such apps and approve of the level of authorization asked for?</p>
<p>Phone calls, Data, Personal Information are broadly used terms and do not tell enough of the kind of information they require access to.</p>
<p>My question is why do they need it all and why are the app stores simply letting them.</p>
<p>The need to stay in the &#8220;apps&#8221; competition, companies are approving applications as long as app developers use the APIs provided and &#8220;follow&#8221; the T&amp;C.</p>
<p>By simply clicking on the T&amp;C does not guarantee that the app is not rogue. End users do not have that level of expertise to question everything they download.Coz their &#8220;trust&#8221; connection is  with the service provider or a cellphone company.</p>
<p>These thoughts lead me to question, who to be held responsible?<br />
Since its the user whose information is in danger, it must be it.</p>
<p>This makes user awareness extremely important.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154199">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154199">
						January 29, 2011 10:21 AM					</a>

				</p>

				<p>Nice use of &#8220;designed into the OS&#8221; side channels as a covert channel to communicate between the two apps.</p>
<p>And this is the real problem, some activities on these side channels you would expect from the app and somebody &#8220;black box watching&#8221; for security excursions would not of necesity see them.</p>
<p>For a simplistic example we know mechanical keys have to be &#8220;debounced&#8221; due to contact noise thus you expect to see momentary random fluctuation on the rising and falling edges. However if the switch is very noisy or pressed slowly the length of the fluctuation could easily exceed the software timer used to &#8220;debounc&#8221; thus it would not be unexpected to see the appropriate action to be repeated at the output of an action etc. Thus it would be easily possible for an application to add an encoded bit at the end of an action involving a key press to say control the volume. The OS convieniently passes this &#8220;bit&#8221; onto all other applications registered to control the volume.</p>
<p>Such covert channels in OS&#8217;s have been known for many years examples being using a printer or changing the access time file etc etc.</p>
<p>I wrote a brief bit about their near thirty year history and GJ Simmons who discovered them on this blog back in september along with some links ( <a href="http://www.schneier.com/blog/archives/2010/09/successful_atta.html#c458633" rel="nofollow ugc">http://www.schneier.com/blog/archives/2010/09/successful_atta.html#c458633</a> )</p>
<p>I also noted that they where nearly impossible to design out of a general purpose &#8220;efficient&#8221; computing platform such as a PC or in this case a Smart Phone.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154203">

			<div class="comment by-eric-vetillard ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://javacard.vetilles.com' rel='external nofollow ugc' class='url'>Eric Vetillard</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154203">
						January 29, 2011 4:08 PM					</a>

				</p>

				<p>In additoin to malware, this paper outlines privacy issues with Android. The &#8220;Read contact data&#8221; permission gives access to call history, meaning that it considers that knowing who I actually call is the same as knowing who I know. Similarly, the &#8220;Record audio&#8221; permission makes no difference between recording in plain sight (while the application is running and visible) or in stealth mode (when it runs in the background, and I don&#8217;t care about whether it just records phone conversations or also my direct conversations.</p>
<p>Also, the side channel part looks way too complicated to be realistic. In real life, it is likely that attackers will hide their malware in an application that legitimately access Internet. Why bother using such a complex scheme?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154204">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154204">
						January 29, 2011 5:09 PM					</a>

				</p>

				<p>The problem is that the permissions are too coarse-grained. They need to be fine-grained, specific and easy to revoke. The capability approach works very well for mobile apps designed for Android. OK Lab&#8217;s OKL4 kernel uses capabilities and a tiny kernel-space TCB to enforce security with quite a bit of assurance. They&#8217;ve already ported Android to run on top of it, with critical apps running directly on the microkernel. I think we need to break it up further, building a true microkernel OS that uses capabilities to enforce app restrictions. I don&#8217;t see any chance of preventing POLA-related attacks without going this route.</p>
<p>Fortunately, we already have products on the market that can do this. Just need the other parts of the OS ported to it. I also want a trusted path for the phone and a key or key combination that gives me an unspoofable way to launch or switch apps. That&#8217;s very critical. I won&#8217;t put a password manager on my phone until it has that feature. Too easy to steal a master password. Phone security now is basically lower than the security provided by Windows NT&#8217;s first release. It&#8217;s time to raise the bar.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154205">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154205">
						January 29, 2011 6:15 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Shh! Quit telling them about EMSEC and covert channels! How else am I going to untraceably sneak all their trade secrets out of their network from the comfort of my own home? ðŸ˜‰</p>
<p>Kidding aside, I do appreciate you posting the TCP paper. That was some really great work at MIT. Closing that channel without hurting performance would essentially require overwriting their storage area on every TCP packet that enters or exits a given node. A tad complicated in most organizations, don&#8217;t you think?</p>
<p>I liked all the good references in the paper more than anything else. I&#8217;m curious if it&#8217;s even possible to design even a fixed purpose device/app that provably has no covert channels. I recall that the A1 class systems had low bandwidth covert channels they couldn&#8217;t get rid of. If <em>they</em> couldn&#8217;t do it, what COTS product can?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154206">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154206">
						January 29, 2011 7:25 PM					</a>

				</p>

				<p>From <a href="http://developer.android.com/guide/topics/security/security.html" rel="nofollow ugc">http://developer.android.com/guide/topics/security/security.html</a> : &#8220;Additional finer-grained security features are provided through a permission mechanism that enforces restrictions on the specific operations that a particular process can perform, and per-URI permissions for granting ad-hoc access to specific pieces of data.&#8221; I think this PoC shows that they are actually still not quite there.</p>
<p>Then again, this can hardly be a surprise to anyone. Smartphone software stacks have yet to reach maturity. As phones have evolved into mini-PC&#8217;s and become more and more ubiquitous, so will viruses and malware targeted against them. Can&#8217;t wait to see the first smartphone botnet emerging. For now, I&#8217;m sticking to my old Motorola until such a time that I feel reasonably assured that the apps running on my future Android-based phone will do so at approximately the same security level as similar apps running on my preferred computing platform(s) today.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154209">

			<div class="comment by-seiran ">

				<p class="commentcredit">

					<span class="commenter">Seiran</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154209">
						January 30, 2011 12:41 AM					</a>

				</p>

				<p>First, the designers got it right with the blinking satellite icon and watermark when the GPS is in use. First, add a microphone icon to the notification bar (a transparent watermark when the bar is hidden) whenever the microphone is being accessed by a non-system app. Do the same for camera as well.</p>
<p>The permission model needs to be fixed so that users can deny individual permissions to applications. A problem with the Android security model is that it provides no way for users to control usage of permissions, only to grant them or deny installation. It would be nice to be able to be able to have accept, deny and prompt. Or an access level slider.</p>
<p>To further deter applications from insisting on having more permissions than they need, and coercing the user to allow it in order to access the app, much of the functionality could be blinded in a way that prevents the application from being able to determine if the permissions has truly been granted. Some functionality can be &#8220;sandboxed&#8221; or &#8220;virtualized&#8221; to provide all existing functionality while increasing security and privacy.</p>
<p>&#8212;&#8211; in detail,</p>
<p>Blinding:<br />
For example, the Read Phone State and Identity permission includes the ability to read the phone serial (IMEI,ESN,MEID) and the subscriber information. Coupled with network access, this can be used to enforce application licensing, but also poses privacy risks. OLPC&#8217;s security model (Bitfrost) might address this by simply preventing the permissions from being combined &#8211; as it does by preventing file viewers from accessing the network. I propose a replacement mechanism that preserves privacy, preserves functionality and can optionally preserve identity enforcement. Applications will receive a hashed serial based on the actual serial number and the publisher&#8217;s manifest signing key identity (using Pub. To allow access to the actual hardware serial number, for asset inventory apps for example, users must explicity grant that permission. This ensures that applications will receive the same pseudo-serial after an OS reinstall, but prevents serial numbers from being correlated with users across more than one software vendor. If the OS does not permit the user to specify their own custom serial number, software activation mechanisms that are intended to prevent license transfer or to limit the number of trials per device will still maintain their security. However, ad networks will not be able to build dossiers on mobile users.</p>
<p>Virtualizing:<br />
Applications that request Internet, Contact list or SD card access when the user doesn&#8217;t want to give that, can be told that the Internet is unreachable, the contact list is empty, and the SD card is empty. The &#8220;contact list&#8221; and &#8220;SD card&#8221; can be virtualized, similar to the Android secure partition for application installs. What the app sees as the SD card root is really stored in a folder. Therefore, it can store its map tiles, audio files, saved games and license files &#8211; but attempts to trash the SD card won&#8217;t affect other application storage. If a user wants a file manager, such as Astro file manager, the app can instruct them that they must go to system setttings, select the app, try to grant additional permissions, go through a &#8220;This app can delete your SD card&#8221; warning screen with a 5-second delay, and click the OK button after it is enabled.</p>
<p>Prompting:<br />
Another simpler example is the &#8220;Service that cost you money, directly place phone calls&#8221; feature. An application that shouldn&#8217;t need this permission might ask for it, and users will often approve without noticing. To reduce the risk associated with this behavior, Directly Place Phone Calls and Directly Send Messages can be enabled in a Prompt state by default. The very first time the application tries to dial a call, the user will receive a consent dialog with the application name, requested action, a method to check the parameters (phone number, SMS contents) and the ability to auto-accept future requests through the &#8220;Don&#8217;t ask again&#8221; checkbox.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154212">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154212">
						January 30, 2011 9:41 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;I&#8217;m curious if it&#8217;s even possible to design even a fixed purpose device/app that provably has no covert channels.&#8221;</p>
<p>I don&#8217;t think so when it comes to anything using the equivalent of a Universal Turing Engine.</p>
<p>Let me put it this way if you go back to the work of Alonzo Church and Alan Turing one thing that came up was the &#8220;halting problem&#8221;.</p>
<p>In essence it was shown beyond reasonable doubt that it was not possible to decide by analysis if any piece of code would halt or not.</p>
<p>The same reasoning can be applied to any piece of code with respect to subliminal channels. That is just by analysis it is not possible to know if there is a subliminal channel or not. You have to use other methods ie testing in one form or another (which is where the real ComSec secrets lurk ðŸ˜‰</p>
<p>The important point to remember about subliminal channels above all else is that you cannot see them, or touch them, or even usually recognise them if they are previously unknown to you (hence the basis for the ComSec secrets).</p>
<p>The real world solution to the halting problem is the same as that developed at Los Alomos for other reasons and gave rise to &#8220;Monte Carlo Methods&#8221;.</p>
<p>Essentialy what you do is impose a meaningfull policy or mechanism where by you force the system to halt.</p>
<p>Very aproximatly (sorry maths bods) in Monte Carlo Methods you make a known number of guessed inputs (the policy) and examine the output. Each guess in theory gets you another step closer to the answer. Thus if after a million meaningfull input guesses it has not halted you can say that with a probability of 2^(10^6) it&#8217;s not going to halt. However if it does halt then you know definatly ðŸ˜‰</p>
<p>This method used to be used for deciding if a very large odd number was prime or not.</p>
<p>So to stop subliminal channels you would need an an all important appropriate policy. And the weasle word hear is &#8220;appropriate&#8221;&#8230;</p>
<p>Even then you can only say probablisticaly that you don&#8217;t have a subliminal channel, or that by policy the app cannot leak a meaningfull amount of information in channel types you are aware of.</p>
<p>This is because you don&#8217;t know an unknown channels bandwidth, because you don&#8217;t know the data transportation or clocking method etc etc.</p>
<p>All you can say is that you have by design stoped any channel type you are aware of of being able to send X amount of information in Y time and that due to policy the secret S requires more bandwidth to be sent in Y time&#8230;.</p>
<p>Sounds good but&#8230; yes there is a &#8220;gaping whole&#8221; in that argument as well due to determanistic -v- true random,</p>
<p>For instance let us assume your design is to use 128bit key AES to send only 8bits per encryption and you change the key on each and every encryption as the policy.</p>
<p>You can clearly see there is not enough data bandwidth to send 128 bits of data required to send the encryption key.</p>
<p>However there is a catch any channel will always leak atleast one bit of information (ie it&#8217;s in use or not).</p>
<p>Thus you need to take one step back up the chain from the AES encryption key to how it is being generated and synced at both ends (it needs to be done determanisticaly otherwise meaningfull communication could not be establishesd over the 1 bit of &#8220;data is being sent&#8221;).</p>
<p>If say the AES key is being generated by CTR mode AES, as an adversary you need to know the CTR AES master key and the value of the CTR counter register. This might be only a handfull of bits due to the syncing method employed. Thus being able to leak just one bit per communication (by say timing jitter) could be enough to leak sufficient information to break the system&#8230;.</p>
<p>Even when you have only one possible data channel how do you decide if what is being sent is not &#8220;super-encoded&#8221; in some way say by time or against some other factor like power usage, blinking front pannel light, ultra sonic noise caused by resonance in a coil in the PSU or other part of the circuit etc etc&#8230;</p>
<p>You can start to see that there are a significant number of ways by which the data and it&#8217;s clock can be leaked. And that the amount of data needed in a determanistic system may be very very small and easily unknown to you which brings you back to the Halting problem.</p>
<p>Put simply if the app cannot communicate data or a synchronisation clock in any way it cannot leak information, otherwise all bets are off&#8230;</p>
<p>Which gives three possabilities,</p>
<p>1, Stop all communications.<br />
2, Stop data being sent.<br />
3, Stop a clock being sent.</p>
<p>But an app that does not communicate at all is not a lot of use to anyone. So on the assumption the app has to communicate usefully some way the usuall ComSec aproach is to stop the subliminal data being sent in a meanigful way or more correctly to stop it being received in a meaningfull way by the evesdroping party.</p>
<p>The two usuall ways to do this are to first clock the inputs and clock the outputs to the app so that external timing refrences to the app cannot get in other than in a controlled manner, the second trick is to fuzz the app output timing before it is transmitted into a comms channel.</p>
<p>This generaly acts a s a low pass filter stopping all high frequency communication (by timing). The next issue is to stop unwanted low frequency transmission usually this is by randomly breaking up the data being sent down the comms channel in various ways.</p>
<p>Hopefully at this point any clocking synchronisation by timing as well as data sent by time based codes has been effectivly removed.</p>
<p>To remove any illicit data from the app being sent on the comms channel the usuall method is to encrypt again using a different system.</p>
<p>However although this limits the problem it does not solve it.</p>
<p>Another method to aliviate the problem is to run the app so it does not have control over data entering or leaving the app in any way.</p>
<p>One soloution to this is you just feed data into the app and it gets on with it. At some random point you halt the app and examine it&#8217;s state, if it is stuck in one state then that is probably the answer (it&#8217;s like a moorly state machine in that respect). However that means that if the app can &#8220;become aware&#8221; of when it has being examined it could in theory change it&#8217;s answer for the next examination and in this way leak out information.</p>
<p>All other methods sort of follow one or more of these same ideas.</p>
<p>But as noted above they are not foolproof by any means.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154213">

			<div class="comment by-gabriel ">

				<p class="commentcredit">

					<span class="commenter">Gabriel</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154213">
						January 30, 2011 11:53 AM					</a>

				</p>

				<p>@Clive: it seems the best one can do is reduce throughput. No matter what one does to protect the system, an app still has the ability to be in one of two states, executing and not executing (sleep, wait for io) etc. That&#8217;s one horrendously slow bit, but it is a bit. And any os will let you view CPU usage of any process, even privileged, as a mean value. A few extra sleeps, and your usage goes down. A few extra loops with some number crunching (mul div etc) and usage goes up. There&#8217;s your bit of data, which can be enough throughput for a larger value if you have all day.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154214">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154214">
						January 30, 2011 12:13 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Thanks for your reply. I wanted to correct a statement related to the halting problem and static analysis. Modern formal methods and modelling have gotten around that for certain imperative languages. There are also methods to identify covert channels statically, like info flow analysis and shared resource matrices.</p>
<p>My question was more of is there a way to be sure we&#8217;ve found <em>all</em> of them? Thats the one i figure we get a bad answer for. Even with this question, i bet ur answers still apply.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154215">

			<div class="comment by-ryan-ingram ">

				<p class="commentcredit">

					<span class="commenter">Ryan Ingram</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154215">
						January 30, 2011 12:22 PM					</a>

				</p>

				<p>@Clive: I&#8217;m not sure your appeal to the Halting Problem and other hard/impossible to decide problems applies here.  It&#8217;s plenty easy to write a program that you can prove halts: &#8220;main() { return 1; }&#8221; for example.</p>
<p>So the question is, can you design a system that provably has no side channels?  My guess is yes, but that doing so for a system with any sort of useful functionality would be difficult.  If I was working on the problem I&#8217;d try to come up with a set of composable primitives that have desirable properties, prove things about the primitives and their compositions, and build a program entirely out of those.</p>
<p>But it would probably take orders of magnitude longer than just writing the software to functionality spec, which is why nobody does that.  Time to market wins again!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154216">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154216">
						January 30, 2011 2:24 PM					</a>

				</p>

				<p>@Ryan Ingram</p>
<p>Thats currently the best approach. In spite of market forces, there have been a few that went that far. The SKPP compliant kernels, seL4 kernel, CompCert compiler, Cryptol, GEMSOS, and Verisoft project are examples of the high assurance approach. I think Verisoft has the right idea: create a repository of verified modules that others can use, improve, or add to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154217">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter">Adam</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154217">
						January 31, 2011 6:09 AM					</a>

				</p>

				<p>Android&#8217;s finegrained security is fine in theory but in practice it leaves much to be desired. Apps are granted permissions during installation and there is no way to modify or override the permissions afterwards.</p>
<p>I might install a calendar app which asks for SMS permissions. It might need these for a niche feature e.g. to send a reminder to meeting participants. But I as a user have no way to veto the action once the app installed. Perhaps it needs the SMS for a niche feature or perhaps it is malware which texts some premium rate number. How do I know? How can I even tell when it calls out?</p>
<p>I think Android phones should assume that no downloaded app is trustworthy (at least initially). Popups should appear allowing the user to allow / deny certain action which have the potential to cause harm. If the user wishes to trust the app they can check a box which makes the phone remember the decision. But by default assume the worst and at least allow the user to control what permissions it gives out regardless of what perms the app says it needs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154218">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154218">
						January 31, 2011 8:08 AM					</a>

				</p>

				<p>@Nick P<br />
  If you want something to worry about I have found a way to alter ARM microcontrolers, the compute engine for almost all smart phones, without either ARM or the licensee knowing that the &#8220;hard macro&#8221; has been altered. This can be used to create hardware side-channels in over 40% of mobile platforms, known ONLY to the individual that created them.</p>
<p>You can talk about software TCB till you are blue in the face BUT it does not count for Jack if the hardware is corrupted!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154219">

			<div class="comment by-kevin-granade ">

				<p class="commentcredit">

					<span class="commenter">Kevin Granade</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154219">
						January 31, 2011 10:29 AM					</a>

				</p>

				<p>Addressing just one issue: why Android permissions are not revokable.</p>
<p>Unfortunately the reason for this is simple and pernicious, Google has prioritized app ease-of-authoring and &#8220;reliability&#8221; over security.</p>
<p>Building an application that can gracefully handle the random failure of various APIs is HARD, and the failure mode will not obviously be the fault of the application.  All the end user will see is that their apps are unstable.  More sophisticated users MIGHT notice that this happens when they have revoked permissions.</p>
<p>Google (probably correctly) predicts that a large number of application authors will not write sufficiently robust software, and that when a user does revoke permissions for an application, application instability will result.</p>
<p>I don&#8217;t have a solution for this problem, it is a very difficult one, but I can say I&#8217;d prefer to see the approach of trying to have the OS report misbehaving applications instead of trying to make everything &#8220;work&#8221; even if it means sacrificing various other characteristics of the platform.  Security foremost, but it impacts many other areas as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154220">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154220">
						January 31, 2011 11:14 AM					</a>

				</p>

				<p>@RobertT: Good point.  I remember reading about some research into hardware backdoors for modern CPUs, showing that it was possible to implement remotely-triggerable vulnerabilities into a CPU with less than two thousand gates (which is miniscule compared to the hundreds of millions of gates used in modern CPUs).  I think this was it:<br />
<a href="http://www.usenix.org/event/leet08/tech/full_papers/king/king.pdf" rel="nofollow ugc">http://www.usenix.org/event/leet08/tech/full_papers/king/king.pdf</a></p>
<p>Maybe this is one of the reasons why the NSA has their own chip fab.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154221">

			<div class="comment by-david-thornley ">

				<p class="commentcredit">

					<span class="commenter">David Thornley</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154221">
						January 31, 2011 11:48 AM					</a>

				</p>

				<p>The problem is not that the permissions are too coarse-grained, or that they&#8217;re irrevocable.  The problem is in expecting average users to manage permissions properly.</p>
<p>It&#8217;s not reasonable to expect an app to run properly without full permissions, and it&#8217;s not reasonable to expect a user to realize why it&#8217;s not.  Therefore, the permissions should be set to what they&#8217;re needed on app installation, and should be reset on app removal.  Displaying what permissions the app requires on installation is fine:  most people will disregard it, but it won&#8217;t be onerous, and a few people might find it useful.</p>
<p>Realistically, most users are incapable of finding the nefarious behaviors possible with permissions, and even if they could they couldn&#8217;t tell if a given app was performing said nefarious behavior.  Since there&#8217;s probably legitimate and illegitimate uses for all possible combinations of permissions, the information is inadequate to judge whether or not to install the app.</p>
<p>Therefore, the permissions review works more as a method of blaming the user than preventing malware, joining numerous other techniques (like UAC and telling users to avoid dodgy websites).</p>
<p>Seiran&#8217;s suggestion is a good one:  provide visual notification that some app is listening to your phone call.  Since the user can&#8217;t see the screen while talking normally, it would be best to have it linger for a bit after the call.  It should then be possible to find what apps are using what facilities.  Most importantly, the user must be able to mark apps as trusted to use those facilities:  if the user is used to having app A be active on the call, the user won&#8217;t notice from a notification that app B is also.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154223">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154223">
						January 31, 2011 1:40 PM					</a>

				</p>

				<p>@ Gabriel,</p>
<p>&#8220;And any os will let you view CPU usage of any process, even privileged, as a mean value.&#8221;</p>
<p>Yes it will (currently), and from the perspective of being on the machine the App is on, the game is effectivly over from this respect.</p>
<p>However it would not be overly difficult to remove the feature and add another process that makes random wildly different demands on the processor and memory such that it would render the information via that route very low bandwidth.</p>
<p>That being said, in my reply to Nick P the view I was looking at was the much more restricted and technically chalanging &#8220;black box&#8221; view. That is you are looking from the outside of the system be it just the app or the system it is running on. This is a much more technically challenging task for the design of a covert channel, as in theory &#8220;you can see&#8221; all the available comms channels as you test.</p>
<p>If you can show for this restricted case that you cannot prevent a subliminal channel then it holds for pretty much all cases not just the easy case of &#8220;sharing the box&#8221;.</p>
<p>Now you have to be careful what you mean by a black box system. In a very limited case it can be a logic lader state machine, through to a full blown computer system.</p>
<p>With a limited state machine where all the states are known, and the data being worked on does not in any way effect the functioning of the black box (such as a simple parity checker through a DSP chip doing a low pass function) it is effectivly working as a filter function.</p>
<p>Such a &#8220;filter&#8221; function should provide a well charecterised signiture that can be tested with all valid data inputs and any differences in the signiture noted and investigated during testing.</p>
<p>A similar rational applies to some of the &#8220;leaf sub&#8221; functions of more complex applications where the data can effect the flow of a program down through various levels of subs.</p>
<p>In essence these functions have either a very limited state or no state at all and do not react to the data passing through. That is for these limited functions data values cannot in any way be program values to be potentialy executed. Thus they cannot in any way be considered as a Turing Engine universal or otherwise.</p>
<p>However as you start to add state even though there is no conditional branching the level of complexity rapidly rises as the state effectivly adds to the number of input bits.</p>
<p>[remember for a simple logic circuit each output bit is defined by one of 2^m maps of the input bit permutations of which their are 2^n thus 2^2^n maps are possible. So four input bits gives 2^4 =16 input permutations of which there are 2^16 = 65536 distinct maps one of which defines the response for an individual output bit.]</p>
<p>It thus rapidly becomes impossible to test all potential states for even quite a small function and other methods need to be deployed (usually divide and conquer).</p>
<p>A similar issue of rapidly increasing complexity occurs when conditional branching on data can occur (such as Branch if Not Equal) that is at the simplest you potential have different maps for each branch condition based on the current data and current state relationship.</p>
<p>At this point the data can effect the behaviour of the function and thus it can cause a change in the functions signature that is potentialy visable outside of the function. One such way this can be seen is with a test and decriment loop which effectivly adds a delay proportional to the difference between the current data value and one stored in the functions state..</p>
<p>However even when such loops are eliminated data values will be leaked by other issues such as unbalanced branch behaviour.</p>
<p>Thus writing code to prevent this sort of time related subliminal channel generaly means not using any optomised code by the likes of the compiler and then &#8220;hand tuning&#8221; which is at best a laborious task.</p>
<p>In general the solution in the past was where possible, to strictly limit the functionality of a sub-function and use a logic ladder or well defined state machine for each sub-function and apply significant controls (re-clocking etc) on the interfaces.</p>
<p>As you can appreciate there is considerable work involved and the whole &#8220;bespoke&#8221; process is usually very inefficient in it&#8217;s utilization of resources.</p>
<p>One area that often gets over looked is &#8220;what to do on error&#8221;. Just about any error or exception will cause a significant change in the functions signature and this potentialy opens up a whole manner of subliminal channels via timing or resource usage. One simple way of dealing with such issues is &#8220;fail hard&#8221; and &#8220;back off for long random periods&#8221;.</p>
<p>In more recent times the use of formal methods has been looked at (have a look at Microsoft&#8217;s Verified Code Compiler and Z3). Part of this is so that the designs can be considerably less &#8220;bespoke&#8221; and also utilise resources more efficiently.</p>
<p>However formal methods whilst potentialy giving a proof of rightness about the code depend extreamly heavily on the correct specification to verify against and the ability of the programer to correctly translate the specification into the appropriate verification code.</p>
<p>Also formal proofs are still quite limited in scope, they cannot be used effectivly against even moderate size code basses with moderate state (such as would be found in a compleate OS).</p>
<p>Thus the &#8220;divide and conquer&#8221; technique is often used, however as it runs not on seperate hardware instances with carefully controled interfaces a new class of subliminal channels open at the next layer up and all the way up the rest of the stack due to amongst many reasons the issue you identifed of &#8220;resource utilization&#8221; being visable to all sub-functions either dirrectly from asking the OS  or indirectly through testing a resource utilization etc.</p>
<p>However even when formal methods are capable of proving a whole OS you still have to ask if the &#8220;specification being tested to&#8221; is correct or even possible to prove within a finite time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154224">

			<div class="comment by-kevin-granade ">

				<p class="commentcredit">

					<span class="commenter">Kevin Granade</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154224">
						January 31, 2011 2:21 PM					</a>

				</p>

				<p>@David Thomley:  You raise good points, but if a provider (which could be the OS author, phone manufacturer, or network provider) isn&#8217;t going to manage application permissions directly, then all that can be done is provide the user with tools they can use to manage application permissions themselves.</p>
<p>The proposal of notifying the user when certain resources are used is just another means of helping them manage security for themselves, with all the same problems related to the user being unprepared to do so.  As with permission controls, it suffers from the problem of granularity and information overload.  How many little blinking icons are you going to put on the screen to notify the user that an app is doing something that is potentially dangerous?</p>
<p>Coming from the other direction, if you&#8217;re just worried about call monitoring the problem is simple, but the fact is that there are a smorgasbord of capabilities that a bad application can use to do bad things, and then you have to strike a balance between too-low granularity (rendering the feature effectively worthless since almost everything needs some potentially dangerous capabilities) and too-high granularity (rendering the feature essentially worthless from information overload).</p>
<p>I&#8217;m not saying anything new here, but fundamentally I don&#8217;t think this is a technology problem, but rather a social problem.  We&#8217;re still trying to figure out how to strike a balance between enabling features for the user without exposing data about them to bad actors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154225">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154225">
						January 31, 2011 3:19 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>Actually, I totally agree and my previous posts on this blog mention the first layer is securing the hardware. I just don&#8217;t know how feasible this is at the moment from a platform OEM&#8217;s perspective when working with a mobile phone provider. They seem to make their own hardware decisions for reasons other than security. &#8220;Oh, it has TrustZone! That sounds so secure!&#8221;</p>
<p>Previously, the only semi-secure processor design I&#8217;ve seen that minimizes the hardware TCB was the MIT Aegis processor. However, I found a promising new architecture that works ground up to put a root of trust in the main chip that apps can leverage. Look up Princeton&#8217;s SecureCore and SP architectures if you haven&#8217;t already. They are awesome! Must still put measures in place to prevent backdoors, but these make good building blocks and require minimum alteration to an existing SOC. Vachharajani&#8217;s RIFLE framework was also interesting.</p>
<p>@ Clive Robinson</p>
<p>You might want to look at the Princeton SecureCore project as well because they&#8217;ve got a nice paper on using Intel&#8217;s hyperthreading for covert channels. I KNEW that crap was risky and it&#8217;s why I always had it turned off in secure designs. Anyway, they identified a SMT cache channel and a SMT functional unit channel. On a 2.8GHz P4, the cache channel leaked 3.2Mbps!! The functional unit channel was 500Kbps. I always appreciate how Intel applies Moore&#8217;s Law to the covert channels we try to remove. Thanks a lot, pricks!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154226">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154226">
						January 31, 2011 3:25 PM					</a>

				</p>

				<p>@ Kevin Granade</p>
<p>&#8220;then you have to strike a balance between too-low granularity (rendering the feature effectively worthless since almost everything needs some potentially dangerous capabilities) and too-high granularity (rendering the feature essentially worthless from information overload).&#8221;</p>
<p>Not necessarily. The operating system could employ very fine-grained permissions, but also provide coarse-grained groups of permissions that assign many granular permissions at once. The user could choose how granular of permissions they want to work with. Kind of like how many apps have both Regular and Power User modes.</p>
<p>One feature would be looking at the group permission to see which granular permissions an app needs, then getting rid of the group permission and assigning only the necessary ones. Admins already do this kind of thing when they create specific user accounts for specific applications to limit their privileges. If it&#8217;s a business phone, the admin could set the privileges of a given business app and push that out to the phone via a policy like some existing access control frameworks use.</p>
<p>Additionally, with mobile phone virtualization becoming more popular, the admin might keep one copy of each type of Android VM properly configured, update it, and push it out onto the phones in regular intervals. The phone would just have to change the VM rather than all the individual settings, like in desktop virtualization. Is any company doing this currently or did I just invent a new market and tip off the competition in one post? (sighs)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154227">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154227">
						January 31, 2011 10:28 PM					</a>

				</p>

				<p>@Nick P<br />
 I&#8217;d suggest you study some of the commercial secure processors, Infineon is a good spot to start. Look at the extreme levels they go to to prevent chip probing (preventing Optical, FiB and Needle probes). Now think about how completely silly this added active protective mesh layer is, if the attacker can have their own registers directly attached to the microcontroller bus, within the chip.</p>
<p>All the attacker has to do is to create some unknown registers that are activated by some unlikely code sequence. with this he can easily create a I/O mapped  FIFO that stores small sequences of ALU operations. If you have a multi processor environment it is easy to see how this hardware feature can be used to grab encryption keys and leak them through some  unsuspected low bandwidth &#8220;side channel&#8221;</p>
<p>The big problem is that modern microcontrollers  are constructed with feature sizes of 40nm and 60M transistors. New development is happening at 22nm. For those who have forgotten high school physics, violet light is about 440nm, so these features are about 1/20th of a wavelength. This makes it almost impossible to directly view the surface of the chip with any optical microscope.</p>
<p>Put another way, it is practically impossible for the fab&#8217;s customer (phone chip design company) to tell if the delivered chip, exactly corresponds to the ordered &#8220;taped-out&#8217; chip. Point is the Fab also does not know that the design has been altered and the Chip design company cannot see that changes have been made to the design.  They both exist in blissful ignorance that the hardware integrity has been compromised.</p>
<p>Now for the real problem.<br />
At the moment there are about 7 chip design companies seriously involved in the mobile phone space. But only 3 fabs.<br />
In order of importance these are:<br />
Mediatek (Taiwan / PRC design / Fabless UMC)<br />
Qualcomm (US design / fabless TSMC + GSM)<br />
Infineon (now Intel) (fabless TSMC)<br />
STM/NXP/Ericson (Europe) (own fab + TSMC?)<br />
TI (only for Nokia) (own + TSMC)<br />
Spreadtrum (PRC) (unsure SMIC?)<br />
Broadcom (US/UK design / fabless GSM)<br />
Mstar (Taiwan/PRC fabless TSMC + GSM)</p>
<p>Notice that at least 1/2 this design list is Taiwan or China based. And about 80% of the volume is fabbed at one of 3 Asian fabs. (TSMC, UMC and GSM)</p>
<p>In my mind, the combination of these factors,  makes the very  concept of Trusted phone chip hardware impossible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154228">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154228">
						February 1, 2011 1:28 AM					</a>

				</p>

				<p>@moo<br />
 Actually I&#8217;m suggesting that hardware can be maliciously altered AFTER the design is complete and without the company that designed the chip, even suspecting that ANYTHING was changed.</p>
<p>In essence, I can defeat all their hardware counter-measures and completely bypass all circuit review procedures.</p>
<p>Think about, the absurdity of a online cryptography, if someone can  sample ALU register contents at will and communicate these results through a side channel.  IMHO the existing production model is that broke.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154229">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154229">
						February 1, 2011 2:34 AM					</a>

				</p>

				<p>@NickP<br />
If you are interested in the Princeton work, have you read Jeffery Dwoskin&#8217;s thesis?<br />
<a href="http://www.jeffdwoskin.com/dissertation/DwoskinThesis-20100426-v1.53.pdf" rel="nofollow ugc">http://www.jeffdwoskin.com/dissertation/DwoskinThesis-20100426-v1.53.pdf</a></p>
<p>Contains some interesting ideas on the secure hardware concept.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154230">

			<div class="comment by-aissen ">

				<p class="commentcredit">

					<span class="commenter">Aissen</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154230">
						February 1, 2011 5:36 AM					</a>

				</p>

				<p>Yet another paper without reproducible results.<br />
Where&#8217;s the source code ? Are we supposed to take everything at face value ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154231">

			<div class="comment by-eymiha ">

				<p class="commentcredit">

					<span class="commenter">eymiha</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154231">
						February 1, 2011 9:51 AM					</a>

				</p>

				<p>There needs to be a &#8216;picture&#8217; of what&#8217;s needed by an app (or any code that is being installed) that shows the required routing to information on the system. At least that way, you could see what&#8217;s being hit&#8230; and the requests could be subject to analysis. Perhaps this could even be used to set up &#8216;allow&#8217;, &#8216;disallow&#8217; or &#8216;ask&#8217; properties for the different retrievals, with any unregistered retrieval being blocked. In any case, I like that a lot more than reading fine print.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154232">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154232">
						February 1, 2011 2:42 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>Thanks for the link. I noticed the name when you posted it: I downloaded all the papers relating to Princeton&#8217;s projects about two days ago, but only had time to read a few. Since you mentioned it, I moved it up to the top of my reading list. I definitely think their work, plus maybe Infineon-style chip protection, is the best route right now. That their architecture allows the reuse of existing ISA for running legacy applications just makes it even better. A totally clean slate is nice for security, but markets rarely accept it. I think SecureCore is a nice compromise that doesn&#8217;t compromise on security. What you think?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154233">

			<div class="comment by-mark-r ">

				<p class="commentcredit">

					<span class="commenter">Mark R</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154233">
						February 1, 2011 7:41 PM					</a>

				</p>

				<p>The sad thing about this is that we&#8217;ve taken a step backwards.  I used to own a Nokia phone running Symbian 60.  I could grant and revoke individual permissions (network access, local filesystem access, etc.) to applications.  I could also make grants temporary and be prompted each time the app requested permission.</p>
<p>Since then, the iPhone exploded and smart phones are no longer for geeks only.  Unfortunately this entails a &#8220;dumbing down&#8221; process; things should &#8220;just work&#8221; instead of worrying consumers with some fiddly permissions settings.  The obvious solution would be an &#8220;expert mode&#8221; with all the settings exposed, but I&#8217;m not sure the manufacturers or telcos have any motivation to fix this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154234">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154234">
						February 2, 2011 9:01 AM					</a>

				</p>

				<p>@ Nick P, Robert T,</p>
<p>What many people forget about the &#8220;channels&#8221; be they subliminal / side / covert, is that they work not only both ways, but also follow the law of unintended consiquences.</p>
<p>For instance there are a number of &#8220;security researchers&#8221; who should know this but appear for reasons unstated to ignore it.</p>
<p>The area this is most visable in is &#8220;Honey Nets&#8221; and time based channels. This alows a knowledgable attacker to &#8220;enumerate&#8221; a network and make a probabalistic determination as to the ratio of &#8220;real-:-virtual&#8221; hosts on a network segment.</p>
<p>This information can lead to the knowledgable person doing the enumeration of the &#8220;unknown&#8221; network deciding with good probability if a particular network segment is a honeynet / tarpit etc and thus avoiding them.</p>
<p>Further it enables the person enumerating a network to decide other factors about the network segment based on comparison with other networks.</p>
<p>The logical conciquence of this applies to directed attacks used for intel gathering or as people are talking about &#8220;Chinese APT&#8221; (see stuff on their j20 stealth plane development).</p>
<p>Put overly simply the enumeration works by looking at things like network time stamps and when they change and by how much.</p>
<p>In the case of TCP time stamps each real physical host has a signiture based on the behaviour of the internal system clock. With a virtual host it is going to show a high corelation with other virtual hosts on the same machine.</p>
<p>Further the change in these signitures is indicitive of the activity on the host (virtual or otherwise) which provide &#8220;tells&#8221; as to what it is being used for.</p>
<p>All that is required is simple mainly infrequent access to the IP stack from the Internet. This access can be well well below the noise floor for a persistant adversary who is going for stealth.</p>
<p>That is a cautiously tailored attack is effectivly invisable to network based Intrusion Detection/Prevention Systems. If then allied to one of many stealth systems (think some types of mutable memory malware hiding in IO cards etc etc) you have an effective APT tool.</p>
<p>Now something I have been looking into of recent times is to consider the case of &#8220;cloud computing&#8221;.</p>
<p>With alittle thought you will realise that most of the malware detecting tools available are just not going to work.</p>
<p>For instance IDS etc systems do not have a snow ball in hells&#8221; chance of seeing such attacks. Even using non mutable memory for OS images, flushing RAM and hashing BIOS etc is going to come up well short of the mark.</p>
<p>Thus  I can confidently predict that the &#8220;Chinese curse&#8221; of &#8220;living in interesting times&#8221; is comming true if not as we speak but real real soon now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154235">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154235">
						February 3, 2011 11:52 PM					</a>

				</p>

				<p>@Nick P<br />
 the problem with preventing hardware hacking is that it&#8217;s an arm&#8217;s race. Each level of complexity you add reduces the participant&#8217;s, but it will never eliminate everyone.</p>
<p>When I look at something like &#8220;securecore&#8221; I&#8217;m asking myself, who just got eliminated? or put another way, who&#8217;s still in the game? and what&#8217;s the new budget?</p>
<p>If you add complexity but do not substantially change the attack vector cost/participants, than your just wasting money.</p>
<p>WRT &#8220;securecore&#8221; what does this really mean?</p>
<p>Can it withstand FIB probing attacks?<br />
 How about Infrarad backside attacks (Pica)?<br />
 Are the DPA obfuscation circuits actually helpful? (see previous comments on LSFR spreading correlation or DSSS rake receivers)<br />
 Are RAM contents readable due to data &#8220;burn-in&#8221;?, numerous attacks use this vector.<br />
 Are Jtag (serial chip scan) capabilities really disabled permanently? If so how? can a single fib repair this scan capability?</p>
<p>What happens  to registers / RAM in Under-voltage operation? (say 0.3V to 0.4V)</p>
<p>What about super cooling to lock in data?</p>
<p>One aspect that worries me most is the new reliance of magically structures like PUF&#8217;s, they are the new secret sauce for the willfully blind. They secretly hold data only that can only be extracted by the authorized program and correct functioning hardware&#8230;hmm &#8230;my BS meter is hitting the limits!</p>
<p>So all these things look good on paper but they only really do two things<br />
1) delay the time to crack<br />
2) change the skills needed and thereby the cost to crack the hardware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154237">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154237">
						February 4, 2011 11:50 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>I appreciate the enumeration of attacks. I agree with your assessment of the two things the defenses do. I like that, though, for most situations. A hardware security technology that requires thousands of dollars, special equipment, special skills, and plenty of time to break would defeat many potential attack vectors and attackers. Well, it would allow us to build systems with a foundation strong enough to do so. I guess intelligence agencies and well-funded spies are still able to crack the things. I think accounting for the devices (and strong penalties for violators) is the best way to defeat the corporate spies.</p>
<p>As for secure hardware, your post indicates that the best strategy is still to physically guard the device or its user using machine-gun toting zealots in a locked down building in the middle of land with no grass/trees and hidden cameras and sensors everywhere (esp. to detect physical tunneling attempts). Good to know how expensive &#8220;secure&#8221; is. Even then, who knows.</p>
<p>Note: I just realized as I wrote my post that Area 51 uses this approach. I guess that&#8217;s some independent validation right off the bat. ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154238">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154238">
						February 5, 2011 1:10 AM					</a>

				</p>

				<p>@ RobertT,&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154239">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154239">
						February 5, 2011 6:40 AM					</a>

				</p>

				<p>@ RobertT,</p>
<p>First off my apologies for the above empty post to you. The keyboard driver on this LG Android smart phone decided to &#8220;take a walk in the park&#8221; again, necesitating a hard reboot. And as my patience with it&#8217;s not so little anoyances is wearing thin I went and did something else for a while (one day my patience will end and it will be reboot with a 14lb lump hammer time ðŸ˜‰</p>
<p>So back to your points,</p>
<p>&#8220;So all these things look good on paper but they only really do two things<br />
1) delay the time to crack.<br />
2) change the skills needed and thereby the cost to crack the hardware.&#8221;</p>
<p>If you think about it the second (2) point is just an example of the first (1) point. That is &#8220;cost&#8221; is directly equatable with time via resource generation and utilisation.</p>
<p>It is easy to fall into the thought process of,</p>
<p>If I have &#8220;one monkey typing for an infinite period of time&#8221; the cost is broadly equivalent to having &#8220;an infinite number of monkeys typing for one period of time&#8230;</p>
<p>However there is the oft forgoton issue of resource &#8220;setup time&#8221; of getting an infinite number of monkeys and typewriters prior to that one period of time (the falacy of throwing manpower at a problem). And then the &#8220;teardown time&#8221; of checking the infinite output to find the one true copy of Shakespear&#8217;s work and getting into your hand. Which even with another set of infinite resources would take another unit of time to check, then probably an infinite period of time to get it back to your hand (because the square root of unbounded is still unbounded)&#8230;</p>
<p>Yes there is an optimal &#8220;sweet spot&#8221; to be found with bounded problems but again you fall into setup time issues the same as the &#8220;traveling salesman&#8221; does. So even then you need to hope pobablistic methods (roll the dice) will work in your favour, but&#8230; even quite small bounded problems become effectivly unbounded when probablistic methods are employed. That is on occasions throwing the dice will take an infinite period of time to find the result, and on many other occasions it will take longer than the brut force search method&#8230;</p>
<p>Thus even in a finite bounded universe with quite a small well bounded problem, time still gets the &#8220;last laugh&#8221; according to Murphy ðŸ˜‰</p>
<p>So as can be seen the second point (2) is effectivly a special case of the first point (1).</p>
<p>Which gives rise to the question, are their any security measures that are not a subset of (1)?</p>
<p>I would say that with regards to (1) &#8216;delay the attack&#8217;,</p>
<p>&#8220;ALL and I do mean ALL security systems do this AND NOTHING MORE&#8230;&#8221;</p>
<p>thus no.</p>
<p>That is if you think about it sufficiently broadly even &#8220;provably secure&#8221; crypto such as the OTP will fail to an &#8220;end run&#8221; around it. That is the attacker simply moves outside of the carefully limited definition of &#8220;provably secure&#8221; to a suitably low hanging fruit such as a time based side channel.</p>
<p>It is a point that appears lost on many &#8220;System Designers&#8221;, they see &#8220;probably secure&#8221; and build it in on the mistaken belief their logic &#8220;chain relies on the strongest link&#8221;&#8230;</p>
<p>Thus missing the point that at the end of the day the security chain for either tangable physical or intangable information assets relies 100% on,</p>
<p>A) 100% control of the asset at all times and,<br />
B) the ability to 100% detect all attacks and,<br />
C) the ability to 100% respond effectivly and,<br />
D) in a sufficiently timely manner 100% of the time.</p>
<p>And it has to be in that order, that is a 100% effective response to an attack after you have lost control of the asset (the horse has left the stable) gets you nothing due to the perfect copy issue.</p>
<p>Thus if the base hardware that directly uses the asset cannot be checked, you don&#8217;t have 100% control of the asset so game over, or is it?</p>
<p>Are there ways you can get close to100%?</p>
<p>The answer is yes but there is a catch&#8230;</p>
<p>For instance if you know that you have locked the asset up in a safe and the safe is two difficult to break or move you have effectivly dealt with two of the attack vectors against the threat. But not all the catch is there are still other &#8220;human&#8221; attack vectors etc.</p>
<p>That is each time you identify an attack vector you can mitigate it but the chances are there will be atleast one vector you have either not thought of or not mitigated properly.</p>
<p>Again the question arises &#8220;Are there ways you can you get close to 100%?&#8221;</p>
<p>And the answer is again &#8220;yes with a catch&#8221; you can put bounds on the environment such that you reduce classes of attack vectors.</p>
<p>A simple example is the &#8220;air gap&#8221; provided it is sufficiently large and genuinely nothing crosses it then you have close to a 100% secure system.</p>
<p>There is of course a catch or two, the first of which is how big does the air gap have to be to ensure nothing can cross&#8230;</p>
<p>To which the only 100% answer is infinite, but physics appears to come to the rescue with the issue of all active systems suffer from &#8220;thermal noise&#8221; setting a &#8220;noise floor&#8221;. That is as a signal gets weaker with the square of the distance, noise floor becomess first comparable and then greater than the signal. So at a finite distance a signal will be comparable to the noise floor&#8230;</p>
<p>However there are still catches, the important &#8220;noise floor&#8221; (that is in the attackers receivers) is not under your control because they can use passive systems such as high gain antennas. Nore is the number of receivers the attacker employes or the spatial way they configure them so the noise floor distance is partly under the attackers control for any given signal.</p>
<p>But further there is another issue that of &#8220;signal bandwidth&#8221; the noise floor thus the minimum physical distance is also dependant on the bandwidth the attacker choses to use. That is although say the troughput of data to be encrypted is quite high thus having a relativly small noise floor distance. The bandwidth required to leak the encryption key could be very low and thus have a very large noise floor distance and importanly a much different effective carrier frequency to the data&#8230;</p>
<p>The other important catch is genuinely isolated systems serve no purpose and will fail. Thus air gaps have to be bridged for the systems to do useful work&#8230;</p>
<p>This means the bridges must operate in a restricted environment as well, but to be usefull they need a certain bandwidth which means the bridges are effectivly Shannon Communications channels. The catch is recognising all the channels and controling their &#8220;bandwidth, energy/time vectors etc.</p>
<p>Thus the process of securing a system can be likened to that of trying to keep a leaky boat afloat with the only materials available being maluable but porous or non maluable irregular shaped non pourous materials. Thus you can control the leaks you can see but you cann&#8217;t stop them, and you can not see all the leaks. So the boat will sink if other measures are not taken.</p>
<p>And it is this &#8220;seeing&#8221; business that is the issue.</p>
<p>As you note it is not possible to see if the &#8220;high end millon+ gate devices&#8221; are &#8220;backdoored&#8221; or not. So the question arises, does this matter?</p>
<p>Actually no, not if you design around it correctly.</p>
<p>Think back to GJ Simmons &#8220;prisoners problem&#8221;, by deffinition the prisoners (big chips) are untrusted and thus are kept issolated each in their own cell within the prison (environment).</p>
<p>As long as they are kept appart they cannot communicate directly thus if they cannot find a comms channel they have to rely on the good gracess of the prison warden to take messages back and forth between them which he does not have to do.</p>
<p>This lack of communications does not prevent the warden putting the prisoners to work. However if the prisoners work on related processes this does alow for a covert channel to be established.</p>
<p>However an astute prison warder will be aware of this and importantly that there are various steps they can take to &#8220;reduce the leaks&#8221; but that won&#8217;t stop them entirely.</p>
<p>What else can the prison warden do?</p>
<p>Well one thing he can do over and above reducing the basic channel bandwidth (flow) is to stop and start the channel randomly and swap work items in it around both in time and amoungst other prisoners. If the warden does this correctly he can get a fairly good work flow with very reduced covert channel bandwidth.</p>
<p>Further the warden can reduce the size and complexity of the work related items passed between prisoners thus reducing the ability to &#8220;hide information&#8221; within them.</p>
<p>Further the warden can augment Jeramy Bentham&#8217;s &#8220;Panoptican&#8221; idea and also ensure the prisoners have so much work going through they do not have spare resorces to either establish or use a covert channel.</p>
<p>So the air gap system can be improved by breaking it down into small issolated blocks with multiple units doing small identical parts of the task. The security hypervisor system (warden) randomly routes information through the multiple units (prisoners) along with random padding data (nulls).</p>
<p>Provided the hypervisor takes care in the way it does things no individual block can establish a reliable channel to any other block. Further the size of the data packet sent between the blocks is to small to carry meaningfull amounts of data. And provided there is sufficient capacity the data packets can be tempoarally stored, transposed and mixed with other unrelated or random data.</p>
<p>The system is not 100% but it makes an attackers life extraordinarily expensive in resources and time.</p>
<p>The thing to remember is that although the &#8220;prisoners&#8221; are unknown quantaties to the &#8220;warden&#8221;, the &#8220;warden&#8221; can make the &#8220;prison&#8221; environment and routien well know to themself but not to the &#8220;prisoners&#8221;.</p>
<p>So one design choice is to make the packet passing switches and store, in devices you can trust. So just for arguments sake the small dtat packets (assets) gets sent on a serial line to a piece of custom hardware built with very small function large gate size (7400/4000) chips that breaks any timing or power side channels down beyond a usefull &#8220;leak&#8221; value.</p>
<p>Also you can &#8220;share a task&#8221; around the prisoners. Think about basic functions like 16/32/64 bit XOR, ADD, SUB and even MUL and DIV with the likes of AES and RSA. Each function is unaware of where it sits within the overall structure, just that it gets input processes and outputs. Further any one function can be chained amongst several functions.</p>
<p>If you have two numbers that need to be added together you can split the numbers either by radix or value or both.</p>
<p>That is 27+31 can be split up by radix as A=7+1+0, B=3+2+0 C=radix*(B+Acarry+0) and D=C+A+0. By value you can simply do A=27+(-13), B=31+(26), C=B+(13), D=A+(-26), E=D+C. And both methods can be combined in various ways especialy using mod(x) techniques. At no point is any ADD node aware of what part of the chain it is nor which value is data and which value is the obsficating value supplied by the hypervisor. Likewise with a little thought the order of the operations can also be randomised. Although somewhat inefficient at all levels the same process can be done with larger functional blocks. Providing the randomization process carried out by the hypervisor is not (sufficiently) determanistic than only the hypervisor knows which node has the valid result.</p>
<p>The trick is thus the old &#8220;Divide and Conquer&#8221; aided by &#8220;Transpose and Randomize&#8221; with a further dose of &#8220;mixed traffic&#8221; and additional &#8220;null traffic&#8221;.</p>
<p>If done correctly what actually happens is the data side channels get encrypted with a random pad which makes any data leaked effectivly usless. And any covert channels from the nodes gets likewise randomly encrypted, but also due to the mixing of data streams spread across various channels, and at best partialy due to the hypervisor droping the null data as and when it feels like it the node cannot establish a covert channel above a certain bandwidth. Further the storage adds further temporal uncertainty to both the side and covert channels in exchange for delay.</p>
<p>Thus you don&#8217;t have to &#8220;not use&#8221; untrusted hardware you just have to make the attack vectors as near usless as you can whilst maintaing some measure of usefull through put.</p>
<p>Thus you are reducing &#8220;efficiency&#8221; to gain &#8220;security&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154240">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154240">
						February 6, 2011 10:11 PM					</a>

				</p>

				<p>@Clive<br />
 Lot&#8217;s of information, I&#8217;m not sure that I agree with everything you wrote, because you seem to place a little too much faith in the integrity of the Hypervisor, especially given that we are talking about an attacker intentionally modifying the hardware.</p>
<p>I agree completely that compute efficiency is the enemy of data security, In my mind the correct implementation of an inefficient process, is the hardware cryptographic equivalent of longer Keys. Both create a data space that is unfeasibly large to directly search (brute force). In the case of Hardware this increased data space must come from random padding random instructions, random timing, and random power usage, around all important operations.</p>
<p>@Nick P<br />
 One last thing to remember, the value of a viable hack increases exponentially with the uniqueness of your ability to hack the target hardware, (assuming it is worth doing at all). This last fact guarantees that sufficient resources will flow to the hacker to make the task economically viable, almost regardless of the difficulty level. Think of the process created to crack enigma, if you want a suitable example.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154241">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154241">
						February 8, 2011 2:52 AM					</a>

				</p>

				<p>@ RobertT</p>
<p>Yeah. This is true so long as the hardware is easily hackable by a particular attacker. I mean, we all know that there are savants and ingenious attackers who can do what most can&#8217;t. There are also defensive methods that are notoriously hard to beat. I think that and the further development of these methods keeps the pattern you mentioned in check. Well, at least for groups without enormous and unchecked resources. (Not naming names but I don&#8217;t think I have to&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154242">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154242">
						February 8, 2011 2:58 AM					</a>

				</p>

				<p>@ Clive Robinson (mostly) &amp; RobertT</p>
<p>&#8220;Lot&#8217;s of information&#8221;</p>
<p>Yeah, he does that. Asperger&#8217;s Syndrome, Clive? Haha, maybe or maybe not. Eccentric, for sure. The specifics? Unknown. How can he talk so much and I still don&#8217;t know if this is his diagnosis?</p>
<p>&#8220;I&#8217;m not sure that I agree with everything you wrote, because you seem to place a little too much faith in the integrity of the Hypervisor, especially given that we are talking about an attacker intentionally modifying the hardware.&#8221;</p>
<p>Lol, Clive, at least Robert has set the score in peer review: Castles 1, Prisons 0. Haha!</p>
<p>(Although, I&#8217;m not sure the castle approach can overcome the stated objections. Perhaps we&#8217;re both at 0 on this one. Back to square one or never left it. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154243">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154243">
						February 8, 2011 8:21 AM					</a>

				</p>

				<p>@ Nick P (mostly and Robert T some),</p>
<p>&#8220;Yeah, he does that. Asperger&#8217;s Syndrome, Clive Haha, maybe or maybe not. Eccentric, for sure. The specifics?&#8221;</p>
<p>I&#8217;ll put my hand up to eccentric and even ecclectic (I have a lot of unrelated hobbies including cooking and historical materials research for various types of bows, and a real interest in fieldcraft for living in the middle of nowhere starting from the clothes you stand in). But I&#8217;ve never been tested for Asperger&#8217;s or any other Autistic Specrum Disorder (I&#8217;m way older than that ðŸ˜‰</p>
<p>But back to the &#8220;trusting the hypervisor&#8221;, the question you should ask first is, &#8220;Do I need to trust the hypervisor and if so to what extent?&#8221; if you cannot answer this with a reasonable proof this then your are running on assumptions&#8230;</p>
<p>However there is the apparently philosophical question of &#8220;can you trust a liar?&#8221; to which the answer is yes (provided they consistantly lie).</p>
<p>That is the crux of the issue is &#8220;consistant behaviour&#8221; be it good or bad establishes a level of trust in it&#8217;s own right.</p>
<p>The next obvious question is, &#8220;How do you know the behaviour is consistant?&#8221;</p>
<p>Well the answer is you cannot know absolutely (ie 100%)</p>
<p>But oddly that does not realy matter, for a couple of reasons.</p>
<p>Firstly you can by randomly testing it get a high degree of confidence it&#8217;s behaviour is consistant (back to my long running idea of &#8220;probabalistic/Monte Carlo Security&#8221; ðŸ˜‰</p>
<p>Secondly is the question of &#8220;trigger data&#8221;, that is the assumption that hidden in the &#8220;black box&#8221; hypervisor is some unknown piece of logic (code/microcode/gates) that can be activated by the input data. That would once triggered by the input data cause the hypervisors behaviour to cease to be consistant. If you assume you have to &#8220;accept it as a hypotheses&#8221; (which you should) then you need to think on how to mitigate it in some manner. One simple way is to limit the hypervisor output behaviour options another is by probabilistic means (more of which later).</p>
<p>So asside from the probabilistic parts can you have a hypervisor that exhibit&#8217;s the required charecteristics of,</p>
<p>1, Consistant behaviour.<br />
2, Inability to interpret input data as code.</p>
<p>The simple answer is yes.</p>
<p>I have in the past talked about state machines which are hard programed (ie not Turing Machines) and do not treat nor cannot treat their input as a program.</p>
<p>However these are &#8220;filters&#8221; which we see with the likes of DSP&#8217;s etc, and do not take action on the data which is something we need the hypervisor to do.</p>
<p>Well as noted above if you limit the hypervisors output options you limit the attack vectors that can be derived from it.</p>
<p>For instance if you limit the hypervisor output to &#8220;good/bad&#8221; this puts a limit on what the hypervisor can be tricked into doing ie simple DoS.</p>
<p>Even this is still a communications channel so the next obvious question is &#8220;Can information leak or be leaked through this channel?&#8221;.</p>
<p>Which brings the hypervisor output into the realms of G Simmons &#8220;subliminal channels&#8221;, and the question of &#8220;Can they all be removed?&#8221;.</p>
<p>Which unlike the halting problem is still in the assumed state of &#8220;probably not&#8221;, thus we err on the side of caution and further assume &#8220;no&#8221;.</p>
<p>But again does this realy matter?</p>
<p>Actuall probably not for various reasons.</p>
<p>As we have discussed in the past &#8220;side channels&#8221; are a bit of a &#8220;black art&#8221; tucked away in the apparently arcane arts of TEMPEST or EmSec.</p>
<p>Where the &#8220;known&#8221; overiding rules to be applied outside a functional block (black box) are to,</p>
<p>1, limit the bandwidth.<br />
2, Limit the energy in.<br />
3, Clock the inputs.<br />
4, Clock the outputs.<br />
5, Fail hard.<br />
6, Fail long (and random).</p>
<p>The first two being the usual EMC stuff, the second two limit timing channels both from within the black box and importantly through the black box, the last two limit errors being used as a comms channel. There are a number of other rules (such as limiting &#8220;coupling&#8221;, control sequency etc) but generaly don&#8217;t apply till the above are nailed down, but in general are analogous to rule 1 for which ever domain you are looking at.</p>
<p>Then there are all the rules about what goes on inside a functional block such as,</p>
<p>1, No unknown states<br />
2, Limit number of states.<br />
3, Fail to a single state.<br />
4, Limit storage.<br />
5, Decouple Input from output.<br />
6, Decouple output from input.<br />
7, Limit branching.<br />
8, Avoid feedback.<br />
9, Avoid feedforward.<br />
10, No uncontroled loops.</p>
<p>Most of which also apply to &#8220;seperation and &#8220;segregation of function and data&#8221; within a system.</p>
<p>However&#8230;. If you examine all the rules you might conclude that they do not stop the potential for low bandwidth channels. This is not quite the case, hidden away in the &#8220;coupling&#8221; and &#8220;decouple&#8221; rules is the use of probabalistic methods. We are starting to see this with &#8220;fuzzing&#8221; and &#8220;whitening&#8221;.</p>
<p>That is by the use of true random data you can prevent a functional block having sufficient meaningful access to the input data to be able to activate a trigger (except by chance, which would in all probability throw an error somewhere).</p>
<p>As a simple example the trigger might be a series of known values in the data stream at known points. If you &#8220;whiten&#8221; the input data by either ADD or XOR it does not prevent the functional block carrying out valid activities on the data. For instance branching on equal value, if you add the same whitening value to both the data value and the comparison value then the functional block will work as expected but the functional block will have no idea what the actual unwhitened value is. Likewise if the position is important data can be randomly switched betweeen two identical functional blocks.</p>
<p>I could go on but I hope you have the gist of the idea.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-154244">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154244">
						February 9, 2011 12:49 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Much better post. The lists content applies to building functionally correct systems in general. State limitation, loop elimination and layering are all good approaches to increasing assurance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-154245">

			<div class="comment by-1300-number ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.veloxtelco.com.au' rel='external nofollow ugc' class='url'>1300 Number</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/#comment-154245">
						April 7, 2011 12:53 AM					</a>

				</p>

				<p>Thereâ€™s still a possibility that this can happen even if it is just a concept. If given in the wrong hands, who knows right? I hope they can make changes for this in order to protect and secure the fears of their consumers or customers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2011/01/trojan_steals_c.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2011/01/trojan_steals_c.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F01%2Ftrojan_steals_c.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2011/01/trojan_steals_c.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3748' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2011/01/domodedovo_airp.html" rel="prev">â† Domodedovo Airport Bombing</a>		<a href="https://www.schneier.com/blog/archives/2011/01/jury_says_its_o.html" rel="next">Jury Says it&#039;s Okay to Record the TSA â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
