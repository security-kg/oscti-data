<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Evasive Malicious Code - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Evasive Malicious Code Comments Feed" href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1614" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1614' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F06%2Fevasive_malicio.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F06%2Fevasive_malicio.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1614 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1614" class="post-1614 post type-post status-publish format-standard hentry category-uncategorized tag-malware tag-network-security tag-web">

	<div class="article">

		<h2 class="entry">Evasive Malicious Code</h2>
		<p><a href="http://news.zdnet.co.uk/security/0,1000000189,39287357,00.htm">New developments</a> in malware:</p>
<blockquote><p>Finjan reports an increasing trend for &#8220;evasive&#8221; web attacks, which keep track of visitors&#8217; IP addresses. Attack toolkits restrict access to a single-page view from each unique IP address. The second time an IP address tries to access the malicious page, a benign page is displayed in its place.</p>
<p>Evasive attacks can also identify the IP addresses of crawlers used by URL filtering, reputation services and search engines, and reply to these engines with legitimate content such as news. The malicious code on the host website accesses a database of IP addresses to determine whether to serve up malware or legitimate content.</p></blockquote>
<p>Just another step in the neverending arms race of network security.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/network-security/" rel="tag">network security</a>, <a href="https://www.schneier.com/tag/web/" rel="tag">web</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html" rel="bookmark">Posted on June 8, 2007 at 1:53 PM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html#comments">24 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html" data-title="Evasive Malicious Code" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-62676">

			<div class="comment by-foodoohackedyou ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.evexonline.com' rel='external nofollow ugc' class='url'>FooDooHackedYou</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62676">
						June 8, 2007 2:17 PM					</a>

				</p>

				<p>Yeah, and it appears that the hackers/criminals are again one step ahead of the security community&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62677">

			<div class="comment by-anonymous-sysadmin ">

				<p class="commentcredit">

					<span class="commenter">Anonymous Sysadmin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62677">
						June 8, 2007 2:45 PM					</a>

				</p>

				<p>I imagine one way to counter such things is for someone to develop a reputation system based on distributed requests from the client&#8217;s own computers.</p>
<p>Say I&#8217;m a security firm.  I distribute a piece of software to my customers.  It contains code to establish secure communication with my servers and only my servers (the encryption to do this exists).  The user configures how much bandwidth of theirs I am allowed to use.  My servers connect to this program and it acts as a customized web proxy for me to crawl the web looking for malicious pages.  It differs from a regular web proxy in that the headers it sends make the traffic appear to originate from a locally running browser.  A side benefit is that if I find something, the IP will be added to the list and the user protected from seeing the malicious code.</p>
<p>Use your imagination to fill in the details&#8230; and to think of the counter-countermeasure&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62678">

			<div class="comment by-joe-patterson ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.terremark.com/' rel='external nofollow ugc' class='url'>Joe Patterson</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62678">
						June 8, 2007 3:47 PM					</a>

				</p>

				<p>Heh.  So if I change my browser&#8217;s user-agent string to googlebot, I&#8217;ll get less attacks?</p>
<p>Not that that&#8217;s effective, but perhaps amusing&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62679">

			<div class="comment by-gigglestick ">

				<p class="commentcredit">

					<span class="commenter">GiggleStick</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62679">
						June 8, 2007 4:00 PM					</a>

				</p>

				<p>@Joe</p>
<p>I do something similar on occasion.  Sometimes, I&#8217;ve searched on a subject, and Google finds a local newspaper and when I get there, it wants me to sign up for a free account to see the content.  Well, obviously, Google was able to see the content, that&#8217;s how it found this page (in fact the little excerpt in the results showed the sentence with the words in question.)  Change your user-agent to the googlebot, and viola, there&#8217;s the content. A bit faster than bugmenot if you have the extension to change your user-agent quickly. I guess in this case, the &#8220;Sign up for an account&#8221; page was the malicious content. I think that Google frowns upon sites providing different content to its bot than to regular users, and some major companies have been dropped from results as punishment for doing that. I think it happened to BMW.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62680">

			<div class="comment by-david-dyer-bennet ">

				<p class="commentcredit">

					<span class="commenter">David Dyer-Bennet</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62680">
						June 8, 2007 4:56 PM					</a>

				</p>

				<p>Presenting specialized content to web-crawlers is an old search-engine optimization trick; sometimes used fairly legitemately if all it&#8217;s doing is presenting the ordinary content in a way the search engine can read (plain text instead of flash, say, in the early days), sometimes used to present entirely misleading information to the search engine in an attempt to lure more users.  And yes, Google frowns on it, to the point where <em>I</em> at least wouldn&#8217;t dream of implementing even the benign form today, since there&#8217;s no way to argue with google if they take against it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62681">

			<div class="comment by-another-googlebot ">

				<p class="commentcredit">

					<span class="commenter">Another Googlebot</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62681">
						June 8, 2007 5:18 PM					</a>

				</p>

				<p>I&#8217;ve found that NPR&#8217;s website serves up transcripts to browsers with the googlebot user-agent, but not to regular browsers.  Since reading is about 10x faster than listening, I always browse as googlebot when looking at the news on NPR&#8217;s site.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62682">

			<div class="comment by-trey ">

				<p class="commentcredit">

					<span class="commenter">Trey</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62682">
						June 8, 2007 10:54 PM					</a>

				</p>

				<p>Next we&#8217;ll see a browser plugin that requests each page twice and shows the second copy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62683">

			<div class="comment by-paddy_68 ">

				<p class="commentcredit">

					<span class="commenter">paddy_68</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62683">
						June 9, 2007 7:22 AM					</a>

				</p>

				<p>Next we¬¥ll see malicious websites that shows the &#8216;bad page&#8217; twice üòÄ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62684">

			<div class="comment by-jesse-weinstein ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://purl.org/NET/JesseW/SundryStuff/' rel='external nofollow ugc' class='url'>Jesse Weinstein</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62684">
						June 9, 2007 12:17 PM					</a>

				</p>

				<p>The link given in the post is just to a paraphrase of a press release from a company called Finjan.  The press release is here: <a href="http://www.finjan.com/Pressrelease.aspx?id=1527&amp;PressLan=1230&amp;lan=3" rel="nofollow ugc">http://www.finjan.com/Pressrelease.aspx?id=1527&#038;PressLan=1230&#038;lan=3</a><br />
titled, &#8220;Finjan‚Äôs Latest Web Security Trends Report Reveals New Genre of Evasive Attacks&#8221;.  It announces a report they put out, &#8220;Web Security Trends Report (Q2 2007)&#8221;, which (after putting something into a &#8220;we-want-your-personal-information&#8221; form) can be downloaded from: <a href="http://www.finjan.com/GetObject.aspx?ObjId=443&amp;Openform=50" rel="nofollow ugc">http://www.finjan.com/GetObject.aspx?ObjId=443&#038;Openform=50</a></p>
<p>The report includes various screenshots of the evasive attack; the attack tool they examined was &#8220;MPack v0.851 stat&#8221;.  They also mention per-country blocking, as another feature of the same attack tool.</p>
<p>The report is worth reading, but it doesn&#8217;t go into much technical detail.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62685">

			<div class="comment by-talky ">

				<p class="commentcredit">

					<span class="commenter">talky</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62685">
						June 9, 2007 2:16 PM					</a>

				</p>

				<p>This isn&#8217;t that new and Finjan are certainly not the first to report on this technique.</p>
<p>I think the first report of this technique being used to get users to infect their computers via a fake e-card site is on the MoMusings blog. Here&#8217;s a link to the actual article that discussses this technique and contains screen captures of the different visits from a single IP:</p>
<p><a href="http://momusings.com/momusings/2007/02/stupid-cupid-stop-picking-on-me.html" rel="nofollow ugc">http://momusings.com/momusings/2007/02/stupid-cupid-stop-picking-on-me.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62686">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://shimmershade' rel='external nofollow ugc' class='url'>Anonymous</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62686">
						June 9, 2007 6:32 PM					</a>

				</p>

				<p>I&#8217;m trying to imagine the implications of such a scenario for Tor users.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62687">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62687">
						June 10, 2007 11:32 AM					</a>

				</p>

				<p>&#8220;Sometimes, I&#8217;ve searched on a subject, and Google finds a local newspaper and when I get there, it wants me to sign up for a free account to see the content. Well, obviously, Google was able to see the content, that&#8217;s how it found this page (in fact the little excerpt in the results showed the sentence with the words in question.)&#8221;</p>
<p>This actually strikes me as reasonable.  People use google to find information, and information behind a subscription is still information.  What might be better is an arrangement between google and the website in question which would simultaneously 1) allow access to the googlebot and only the googlebot 2) not provide cached results, and 3) add a &#8220;SUBSCRIPTION REQUIRED&#8221; note before the link in the search results.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62688">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.AutoUpdatePlus.com' rel='external nofollow ugc' class='url'>Simon</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62688">
						June 11, 2007 2:15 AM					</a>

				</p>

				<p>When bored, I occasionally click on phishing links to see what the sites look like. Everyone knows that the phishing sites went from basic copies of graphics and poor grammar, to quite well polished sites which replicate all HTML, JS content and with much more polished grammar and spelling. It&#8217;s only in recent times that I have noticed that the phishers are getting even smarter, and browsing to the site twice (say, by refreshing the screen) causes the phishing hoax to be replaced by a blank screen. I imagine that it makes investigation of phishing attacks so much more difficult. The next step is probably for the phishing site to display content relevant to you (i.e a specific logon screen for Citibank, as you are a customer there), rather than the current situation where they simply hope that you are a customer of their target website.</p>
<p>Simon<br />
<a href="http://www.AutoUpdatePlus.com" rel="nofollow ugc">http://www.AutoUpdatePlus.com</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62689">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62689">
						June 11, 2007 4:11 AM					</a>

				</p>

				<p>@GiggleStick, &#8220;Change your user-agent to the googlebot, and viola, there&#8217;s the content.&#8221;</p>
<p>How do I do this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62690">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62690">
						June 11, 2007 4:17 AM					</a>

				</p>

				<p>@Simon,</p>
<p>Even better, on the second view the site could redirect you to a legitimate site.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62691">

			<div class="comment by-paul ">

				<p class="commentcredit">

					<span class="commenter">Paul</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62691">
						June 11, 2007 4:19 AM					</a>

				</p>

				<p>If i understand this correctly, any network which uses a NAT gateway such as an ADSL modem or forces all its web browsing through a proxy server (i.e. nearly every home/SMB network on the planet) should only ever have one machine on the network affected by this.  Of course, that machine could proceed to infect others that it can contact on the LAN, but still this seems like a fairly serious limitation.  I&#8217;d be willing to bet that next stop is displaying different results based on a tracking cookie.</p>
<p>Some interesting proxy-server-based protections (and corresponding workarounds, i&#8217;m sure) might be possible here, e.g. the equivalent of reverse greylisting web sites.  What i mean is this: the proxy server could request the page multiple times (with different user agent strings?), or manage cookies on behalf of the user, and possibly provide protection for a whole site.</p>
<p>Of course SSL kills protections like this instantly.  üôÅ  When i worked at a school, i seriously considered limiting SSL access to only whitelisted sites.  In a corporate network, i&#8217;m sure that wouldn&#8217;t wash &#8211; you&#8217;d have people setting up rogue ADSL connections all over the place just to get around proxy server restrictions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62692">

			<div class="comment by-studentwithproxy ">

				<p class="commentcredit">

					<span class="commenter">studentWithProxy</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62692">
						June 11, 2007 7:09 AM					</a>

				</p>

				<p>@Paul,</p>
<p>Why do you think that students won&#8217;t setup proxies?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62693">

			<div class="comment by-colin ">

				<p class="commentcredit">

					<span class="commenter">Colin</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62693">
						June 11, 2007 9:39 AM					</a>

				</p>

				<p>What makes this even worse is, with Firefox, often the &#8220;view source&#8221; button will fetch a NEW COPY of the page from the server for display.  Yes, you heard me right.  So you could potentially load up the mal-page, hit &#8220;view source&#8221;, and see something completely benign.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62694">

			<div class="comment by-tnt ">

				<p class="commentcredit">

					<span class="commenter">TNT</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62694">
						June 11, 2007 8:56 PM					</a>

				</p>

				<p>This technique has been around for a few months. Even worse, it&#8217;s the technique some malware authors are using of loading different malware (or for some countries, no malware at all) based on the Country the IP resides in. All this done server-side&#8230; The &#8220;Gromozon&#8221; group for instance (if you don&#8217;t know what it is, look it up) has been doing this for several months now, combined with:</p>
<ul>
<li>several header/referrer checks which make it almost impossible to crawl their pages with something like wget, even with &#8220;fake&#8221; user-agent headers</li>
<li>randomized location of the directory the exploits and the files reside in, changing every few minutes</li>
</ul>
<p>The amount of work and organization that&#8217;s been developed in the last months from the malware groups (particularly the ones from the former URSS) is stupefying.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62695">

			<div class="comment by-ralph ">

				<p class="commentcredit">

					<span class="commenter">Ralph</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62695">
						June 11, 2007 9:03 PM					</a>

				</p>

				<p>Add to this the practice of posting the code via the advertising content on third party sites.</p>
<p>You&#8217;ve got malicious code popping up randomly through large sites that&#8217;s very hard to track.</p>
<p>Also;<br />
The Finjan report has some nice examples in it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62696">

			<div class="comment by-fuic ">

				<p class="commentcredit">

					<span class="commenter">Fuic</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62696">
						June 11, 2007 9:51 PM					</a>

				</p>

				<p>@Colin<br />
Firefox does NOT reload pages from the server when you view source.  I have checked this by watching server logs.</p>
<p>I&#8217;m curious to know what you&#8217;re doing to make you think it does.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62697">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62697">
						June 12, 2007 7:08 AM					</a>

				</p>

				<p>@Fuic: &#8220;I&#8217;m curious to know what you&#8217;re doing to make you think it does.&#8221;</p>
<p>Sometimes I am under the same impression. It just takes too long to view source or save an image to disk (there should not be any serious progress bar for saving an 300kb JPG image from memory to disk). It really makes you think that the resource is being re-downloaded.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-62698">

			<div class="comment by-eam ">

				<p class="commentcredit">

					<span class="commenter">Eam</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62698">
						June 14, 2007 12:31 PM					</a>

				</p>

				<p>@Fuic:<br />
It usually hits up the cache, but it definitely does make a request to the server from time to time (it can be a total pain when debugging HTML output from an ASP.NET app). You&#8217;ll notice the &#8220;View Source&#8221; window actually has a Reload option in the View menu.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-62699">

			<div class="comment by-jedermann ">

				<p class="commentcredit">

					<span class="commenter">jedermann</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/#comment-62699">
						September 20, 2008 10:20 AM					</a>

				</p>

				<p>The kind of attack described in these posts seems to be (still ?) happening at the NPR home page. On the first visit to the page, an antivirus scanner ad for something called &#8220;bestantivirus &#8230;&#8221; pops up and doesn&#8217;t seem to allow itself to be declined, seems to lock up the controls on the browser, starts to &#8220;scan&#8221; your machine. Escape by forced kill of the browser. Subsequent visits don&#8217;t show this behavior. I&#8217;d warn NPR but I don&#8217;t want to go their page to get the contact email address.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2007/06/evasive_malicio.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2007/06/evasive_malicio.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F06%2Fevasive_malicio.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2007/06/evasive_malicio.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1614' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2007/06/watermarking_dn.html" rel="prev">‚Üê Watermarking DNA</a>		<a href="https://www.schneier.com/blog/archives/2007/06/friday_squid_bl_75.html" rel="next">Friday Squid Blogging: Squid Beaks ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
