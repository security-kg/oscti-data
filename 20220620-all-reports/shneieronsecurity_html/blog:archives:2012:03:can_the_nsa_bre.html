<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Can the NSA Break AES? - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Can the NSA Break AES? Comments Feed" href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4280" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4280' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F03%2Fcan_the_nsa_bre.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F03%2Fcan_the_nsa_bre.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4280 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4280" class="post-4280 post type-post status-publish format-standard hentry category-uncategorized tag-aes tag-cryptanalysis tag-cryptography tag-hardware tag-nsa tag-side-channel-attacks">

	<div class="article">

		<h2 class="entry">Can the NSA Break AES?</h2>
		<p>In an excellent <a href="http://www.wired.com/threatlevel/2012/03/ff_nsadatacenter/all/1">article</a> in <i>Wired</i>, James Bamford talks about the NSA&#8217;s codebreaking capability.</p>
<blockquote><p>According to another top official also involved with the program, the NSA made an enormous breakthrough several years ago in its ability to cryptanalyze, or break, unfathomably complex encryption systems employed by not only governments around the world but also many average computer users in the US. The upshot, according to this official: &#8220;Everybody&#8217;s a target; everybody with communication is a target.&#8221;</p></blockquote>
<p>Bamford has been writing about the NSA for decades, and people tell him all sorts of confidential things.  Reading the above, the obvious question to ask is: can the NSA break AES?</p>
<p>My guess is that they can&#8217;t.  That is, they don&#8217;t have a cryptanalytic attack against the AES algorithm that allows them to recover a key from known or chosen ciphertext with a reasonable time and memory complexity.  I believe that what the &#8220;top official&#8221; was referring to is attacks that focus on the implementation and bypass the encryption algorithm: side-channel attacks, attacks against the key generation systems (either exploiting bad random number generators or sloppy password creation habits), attacks that target the endpoints of the communication system and not the wire, attacks that exploit key leakage, attacks against buggy implementations of the algorithm, and so on.  These attacks are likely to be much more effective against computer encryption.</p>
<p>EDITED TO ADD (3/22):  Another option is that the NSA has built dedicated hardware capable of factoring 1024-bit numbers.  There&#8217;s quite a lot of RSA-1024 out there, so that would be a fruitful project.  So, maybe.</p>
<p>EDITED TO ADD (4/13):  The NSA <a href="http://www.wired.com/threatlevel/2012/03/nsa-denies-wired/">denies everything</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/aes/" rel="tag">AES</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/side-channel-attacks/" rel="tag">side-channel attacks</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html" rel="bookmark">Posted on March 22, 2012 at 7:17 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html#comments">130 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html" data-title="Can the NSA Break AES?" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-176830">

			<div class="comment by-per-thorsheim ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://securitynirvana.blogspot.com' rel='external nofollow ugc' class='url'>Per Thorsheim</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176830">
						March 22, 2012 7:37 AM					</a>

				</p>

				<p>Sloppy password creation habits.<br />
Always a winner.</p>
<p>Why would anyone ever attack the hardest part of any security mechanism?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176831">

			<div class="comment by-nobodyspecial ">

				<p class="commentcredit">

					<span class="commenter">NobodySpecial</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176831">
						March 22, 2012 7:39 AM					</a>

				</p>

				<p>Simple way to tell &#8211; see if the NSA&#8217;s opposition starts  to switch from AES.</p>
<p>The real guarantee we have that any of these systems are secure is that the CIA wouldn&#8217;t use them if the NSA could read them, the secret service would use them if the CIA could read them&#8230;and so on&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176832">

			<div class="comment by-blarkon ">

				<p class="commentcredit">

					<span class="commenter">Blarkon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176832">
						March 22, 2012 7:42 AM					</a>

				</p>

				<p>Bamford mentioned something similar in his 2008 &#8220;Shadow Factory&#8221;.  Crypto geeks were introduced to something which made them come away dumbfounded. The implication seemed to be some sort of very effective attack against computer encryption (my initial impression from the description there was was that NSA could do something similar to breaking AES but you are the expert in this area). Either way &#8211; it&#8217;s not the first time that Bamford has brought something like this up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176833">

			<div class="comment by-will ">

				<p class="commentcredit">

					<span class="commenter">Will</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176833">
						March 22, 2012 7:51 AM					</a>

				</p>

				<p>How about against certificates?  There are both exciting factoring shortcuts or brute force for short keys or against RC4 or it could be as simple as getting Verisign to sign any fake key.</p>
<p>Or maybe its practical Tempest attack against anyone via their home wiring?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176834">

			<div class="comment by-robert-vox ">

				<p class="commentcredit">

					<span class="commenter">Robert Vox</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176834">
						March 22, 2012 7:57 AM					</a>

				</p>

				<p>Maybe quantum computers ? so related to Discrete Log and Factorizing problem based ciphers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176835">

			<div class="comment by-whiskey ">

				<p class="commentcredit">

					<span class="commenter">Whiskey</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176835">
						March 22, 2012 8:02 AM					</a>

				</p>

				<p>Sounds to me like assymetrical encryption is broken. The NSA may have some way to factor very large semi-primes. This would break PGP, RSA, etc. The list of attacks that Schneier suggests are not an enormous breakthrough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176836">

			<div class="comment by-patrick ">

				<p class="commentcredit">

					<span class="commenter">Patrick</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176836">
						March 22, 2012 8:09 AM					</a>

				</p>

				<p>Suppose 1) the NSA could devise a cypher with a hidden back door such that only they could perform a cryptanalytic attack, and moreover that nobody else could detect its presence.  Also, suppose 2) they would choose to promote this cypher as the standard if it existed.</p>
<p>Item 1) is a tall order, requiring mathematical knowledge beyond what&#8217;s publicly known.  Still, the NSA has some smart people working with them in secret.  I&#8217;d estimate there&#8217;s a 10% chance of 1) and maybe a 50% chance of 2), for a total of a 5% chance that the NSA has been keeping quiet about a secret AES back door.</p>
<p>These probabilities can&#8217;t be based on hard data &#8211; we don&#8217;t have any.  You are welcome to tweak the 10% and 50% figures as you please.  I assert that while it&#8217;s probably true that AES doesn&#8217;t have a secret back door cryptanalysis, it would be foolish to assume the product of the chances of 1) and 2) is vanishingly small.  Discuss.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176837">

			<div class="comment by-brian-weeden ">

				<p class="commentcredit">

					<span class="commenter">Brian Weeden</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176837">
						March 22, 2012 8:35 AM					</a>

				</p>

				<p>I think the main point of the new Utah facility is to crack the past, not the present.  The NSA has been hovering up encrypted comms for decades and it may be that the combination of a petaflop computer plus terabytes of data might be enough to crack crypto weaker than 128-bit (and especially 64-bit).</p>
<p>But as far as cracking 256-bit AES coolly used now, I think Bruce has it right.  The vulnerability is poor implementation and side channel, not direct brute force.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176838">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176838">
						March 22, 2012 8:37 AM					</a>

				</p>

				<p>There is a &#8220;follow up&#8221; article of how the NSA have denied the article and the NSA representatives cannot even get the author&#8217;s name correct (even though he is the leading journalist in investigating the NSA so must be well known to them),</p>
<p><a href="http://www.wired.com/threatlevel/2012/03/nsa-denies-wired/" rel="nofollow ugc">http://www.wired.com/threatlevel/2012/03/nsa-denies-wired/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176839">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176839">
						March 22, 2012 8:41 AM					</a>

				</p>

				<p>@Patrick</p>
<p>The chance of 1 and 2 happening is hard to predict, but the chance of them happening with regard to AES is basically zero since the NSA didn&#8217;t design AES and didn&#8217;t select it as the standard.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176840">

			<div class="comment by-anon-coward ">

				<p class="commentcredit">

					<span class="commenter">anon coward</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176840">
						March 22, 2012 8:41 AM					</a>

				</p>

				<p>what should raise suspucion/inspire confidence is when there is a difference between US encryption and the rest of the world<br />
Either XXX is a good algo, or it is not, according to NSA knowledge. If it is not, the NSA takes a big chance not disclosing it to US citizens, effectively claiming that nobody but the NSA will ever find the loophole<br />
If there is a difference, it might be found, again a little anoying for befriended countries</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176841">

			<div class="comment by-ryan ">

				<p class="commentcredit">

					<span class="commenter">Ryan</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176841">
						March 22, 2012 8:43 AM					</a>

				</p>

				<blockquote><p>I believe that what the &#8220;top official&#8221; was referring to is attacks that focus on the implementation and bypass the encryption algorithm: side-channel attacks, attacks against the key generation systems (either exploiting bad random number generators or sloppy password creation habits), attacks that target the endpoints of the communication system and not the wire, attacks that exploit key leakage, attacks against buggy implementations of the algorithm, and so on.</p></blockquote>
<p>All the more reason why the public needs to be able to verify the correctness of the implementation, not just the soundness of the algorithm itself. Open-source software is the key.</p>
<p>Also, maybe its just me, but based on those I know who have discussed this, I would think this has more to do with the analytic capabilities that come with hoovering up so much data, such that you can do meaningful large-scale comparisons of different plain and cypher texts. The entire article is about a super-massive data storage center, so it isn&#8217;t an unreasonable conclusion.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176842">

			<div class="comment by-tim ">

				<p class="commentcredit">

					<span class="commenter">Tim</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176842">
						March 22, 2012 8:46 AM					</a>

				</p>

				<p>Patrick: Actually it is not so far fetched and may have already happened:</p>
<p><a href="http://en.wikipedia.org/wiki/Nothing_up_my_sleeve_number#Counterexamples" rel="nofollow ugc">http://en.wikipedia.org/wiki/Nothing_up_my_sleeve_number#Counterexamples</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176843">

			<div class="comment by-thin-king ">

				<p class="commentcredit">

					<span class="commenter">Thin King</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176843">
						March 22, 2012 8:48 AM					</a>

				</p>

				<p>The USA government promotes AES.  It uses it itself.  It is used in commerce in the USA.</p>
<p>If there were a back door, and that back door were discovered, commerce in the USA would be broken.  It would be foolish for the government to take that risk.</p>
<p>It seems unlikely that AES is broken.  Instead, this facility is probably processing the bounty provided by Google, Facebook, iCloud, Rackspace, Amazon EC2/S3, and the Narus boxes spliced off the Internet hubs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176844">

			<div class="comment by-ed ">

				<p class="commentcredit">

					<span class="commenter">ED</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176844">
						March 22, 2012 8:49 AM					</a>

				</p>

				<p><i>&#8220;EDITED TO ADD (3/22): Another option is that the <b>RSA</b> has built dedicated hardware capable of factoring 1024-bit numbers. There&#8217;s quite a lot of RSA-1024 out there, so that would be a fruitful project. So, maybe.&#8221;</i></p>
<p>You mean the &#8220;NSA has built&#8221;, right?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176845">

			<div class="comment by-mccoy-pauley ">

				<p class="commentcredit">

					<span class="commenter">McCoy Pauley</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176845">
						March 22, 2012 9:05 AM					</a>

				</p>

				<p>&#8220;It would be foolish for the government to take that risk.&#8221;</p>
<p>Yeah, they&#8217;ve got a proven record of not doing stupid stuff, right?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176846">

			<div class="comment by-jonathan-thornburg ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Thornburg</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176846">
						March 22, 2012 9:08 AM					</a>

				</p>

				<p>Traffic analysis, starting with the dialing records for a <em>lot</em> of phone calls&#8230;..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176847">

			<div class="comment by-geo ">

				<p class="commentcredit">

					<span class="commenter">geo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176847">
						March 22, 2012 9:16 AM					</a>

				</p>

				<p>Typo at the end; NSA, not RSA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176848">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176848">
						March 22, 2012 9:27 AM					</a>

				</p>

				<p>Thank you Bruce for finally commenting on this bit of Bamford&#8217;s story!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176849">

			<div class="comment by-dave-c ">

				<p class="commentcredit">

					<span class="commenter">Dave C.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176849">
						March 22, 2012 9:50 AM					</a>

				</p>

				<p>The biggest breakthrough would be if NSA could build a quantum computer that could implement Shor&#8217;s algorithm using the Quantum Fourier Transform (QFT). This breaks RSA and Diffie-Hellman. The quantum research program at NSA used to be headed up by Mark Heligman who is now at IARPA:<br />
<a href="http://www.iarpa.gov/manager_heiligman.html" rel="nofollow ugc">http://www.iarpa.gov/manager_heiligman.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176850">

			<div class="comment by-stephen ">

				<p class="commentcredit">

					<span class="commenter">Stephen</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176850">
						March 22, 2012 10:05 AM					</a>

				</p>

				<p>A big question is whether the NSA would knowingly allow the US Govt to use an encryption algorithm that has been broken: does their mandate to break other govts&#8217; communications trump their mandate to protect their own govt&#8217;s communications?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176851">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://catbag.wordpress.com' rel='external nofollow ugc' class='url'>Carlo Graziani</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176851">
						March 22, 2012 10:06 AM					</a>

				</p>

				<p>The conjecture is easy enough to test:  someone send an AES-256-encrypted e-mail from an internet cafe in a problematic country through a throwaway gmail account to another throwaway account.  The text should allude to an armed nuclear device in a case of bananas in a ship bound for Los Angeles.  If the port gets shut down, or the city is evacuated, or Seal Team 6 starts conducting impromptu customs inspections on inbound ships, we&#8217;ll know for sure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176852">

			<div class="comment by-m ">

				<p class="commentcredit">

					<span class="commenter">M</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176852">
						March 22, 2012 10:21 AM					</a>

				</p>

				<p>So this Bamford has been known to take information from government sources and speak about them to the press.  If I was the goverment, I would consider it an effective strategy to &#8220;leak&#8221; that they could do very advanced cryptanalysis even if they couldn&#8217;t.  You don&#8217;t actually need to be able to do it to promote the fear that you can.  It sounds like a typical government deterrent to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176853">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176853">
						March 22, 2012 10:33 AM					</a>

				</p>

				<p>Has the NSA found a weakness in AES well the answer is we know there are practical attacks against &#8220;online&#8221; implementations of AES, this has been known since it was just a candidate.</p>
<p>We also know that the NSA has approved AES for use at &#8220;code word&#8221; level, BUT the last time I looked only for &#8220;data at rest&#8221;.</p>
<p>The NSA without doubt knew about timing side channel attacks due to CPU Cache etc long long before the AES competition. But as NIST&#8217;s crypto advisors they chose (jointly or on their own) not to include this known problem into the competiton.</p>
<p>It has been noted that one of the criterion for the competition was &#8220;speed of operation&#8221; and that the example code became public. The result was that the code up on the site for download was effectivly optomised to make the issue of timing attacks the worst it could be without deliberate compromise, and also this bad code became part of just about every AES implementation or code library.</p>
<p>So there is some justification for believing that the NSA may well have done this deliberatly (however arguing from effect to cause is not a good way to carry out science).</p>
<p>Now to chuck a little more fuel on the fire, the NSA like GCHQ and a number of other govenment cipher security establishments are known to be ultra conservative in their outlook and their designs almost always have a sufficient but absolutly no more security margin. Further that they are reputed to not use a system unless they either know how to break it or know the only avenues by which it can be broken, and thus have a very very clear idea of just how long information will remain secure under it.</p>
<p>This is because we know that the NSA have deliberatly issued &#8220;field cipher&#8221; systems with keyspaces containing &#8220;weak and strong keys&#8221; in some cases 20% or less were strong keys. The NSA also persuaded a non governmental cipher company to do likewise.</p>
<p>It is believed that this was incase anybody copied the cipher design. Because in all probability the nation / entity copying the design are not going to know that there are weak keys, thus a high percentage of their communications would be open to the NSA, and knowledge of the standard plain texts used would in older systems aid in the breaking of the few messages encipherd under a strong key.</p>
<p>This view tends to be further supported by the fact that the NSA used to be the KeyMat controler and issued the key schedules etc so could easily use only the strong keys.</p>
<p>Now it is known that the NSA has been putting &#8220;network taps&#8221; in not at the boarders but the backbone where timing resolution is effectivly at it&#8217;s sharpest due to throughput and minimum distance to one end of the online encryption system. Thus they are well placed with such a system to best exploit any timing attacks against AES.</p>
<p>Now currently in the public domain the timing attacks against AES are active not passive, that is you need to activly send data or an application at/to the target system to open the cache and similar timing attack channels. However as the likes of the NSA and GCHQ are without doubt many years ahead of the public domain on EmSec then it is reasonable to think that they may well have one or more passive attacks against AES timing.</p>
<p>Then there is the old issue of &#8220;known plaintext&#8221;, there is an assumption that modern ciphers are effectivly immune to &#8220;known plaintext&#8221; attacks. But again the NSA and GCHQ are considerably more practiced at this than the academic community is. And the dominant presence of MS with it&#8217;s very very large quantity of &#8220;known plaintext&#8221; at &#8220;known offsets&#8221; in all of it&#8217;s Office and other file formats would certainly make a &#8220;known plaintext&#8221; attack considerably easier.</p>
<p>But are there other system implementation issues that would make the NSA, GCHQ et als lives easier?</p>
<p>Yes cipher modes, it is not that well known amongst application programers that you should avoid certain modes because it makes some attacks almost trivial. Further even in more secure modes there are issues over the likes of IV&#8217;s and Nonces and even how you should pad data to fill a block etc. And even less well known is that some modes whilst secure for some purposes are very weak for others (ie stream cipher use for communications and for disk storage).</p>
<p>With regards has the NSA &#8220;backdoored&#8221; AES to leak key bits, this is (as far as we know) very difficult with block ciphers due to the lack of redundancy in them (however RSA and other systems using a pair of primes have way way more redundancy in them thus making &#8220;backdooring&#8221; an implementation almost trivial).</p>
<p>Then the question arises about the use of systems, the number of user errors that can be made are almost more numerous than the number of users&#8230; One such fruitful area that keeps coming up time and time again is the issue of &#8220;poor entropy&#8221; or &#8220;predictable random bit stream generation&#8221;. Again we know there are ways to avoid many of the pitfalls but these are often unknown to application developers.</p>
<p>One significant tell against AES has always been it&#8217;s novel design with the &#8220;brick layer&#8221;, because it was novel little was realy known about it&#8217;s strengths and weaknesses at the competition selection stage. Does it have a significant weakness, well none that&#8217;s been published, but that does not mean it has not.</p>
<p>This gives rise to the question of would the NSA say anything if the knew of a significant weakness?</p>
<p>Well probably not directly, but if not an avoidable weakness they would be unlikley to allow AESs use beyond &#8220;confidential&#8221;.</p>
<p>But they might well do so if there is some way they could keep it under control such as weak keys in the keyspace, where they issue the keys for use&#8230;</p>
<p>As Bruce notes there are a whole number of system design, system implementation and system use issues over and above AES and in many respects these are much much more likley to be a fruitfull place for the NSA. Why, simply because there is little or no research being carried out in many of these areas. As I&#8217;ve noted EmSec is such an area, it&#8217;s only in the past few years any papers on EmSec have been carried out by the academic community. As for active EmSec there has been some work on smart cards but little or nothing in other areas. Over a quater of a century ago I investigated &#8220;active EmSec&#8221; attackss using EM carriers modulated by various waveforms. The only paper I can remember seeing to do with active EmSec attacks is by a couple of researchers at Cambridge Computer Labs where they subjected a 32bit True Random Number Generator with an unmodulated carrier and reduced it&#8217;s output from 32bits of entropy down to less than 8bits&#8230;</p>
<p>So it can be seen that there are very very large areas of the crypto landscape that have not been walked upon by accademics or other non Governmental researchers. Thus giving the NSA, GCHQ et al plenty of room to find some choice golden nuggets.</p>
<p>Not that I havent said this all before on various pages of this blog going back several years.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176854">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176854">
						March 22, 2012 10:43 AM					</a>

				</p>

				<p>@Clive</p>
<p>That about sums up my thoughts too. It all depends on what one means by &#8220;crack AES&#8221;. In it&#8217;s most technical sense I doubt highly that NSA can crack AES. But that doesn&#8217;t mean one&#8217;s data is safely merely because it&#8217;s encrypted with with some version of AES in some way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176855">

			<div class="comment by-john-kienitz ">

				<p class="commentcredit">

					<span class="commenter">John Kienitz</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176855">
						March 22, 2012 10:44 AM					</a>

				</p>

				<p>Couldn&#8217;t they factor all 1024 bit numbers and create a table?  This could easily be done on commodity hardware.  The resulting table would not even be that large, especially compared to a rainbow table.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176856">

			<div class="comment by-random-walk ">

				<p class="commentcredit">

					<span class="commenter">Random Walk</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176856">
						March 22, 2012 11:03 AM					</a>

				</p>

				<p>Check your math &#8230;</p>
<p>2<strong>1024 ~= 10</strong>306</p>
<p>So there are many more 1024 bit numbers than there are elementary particles in the universe (~ 10**82).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176857">

			<div class="comment by-sami-liedes ">

				<p class="commentcredit">

					<span class="commenter">Sami Liedes</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176857">
						March 22, 2012 11:42 AM					</a>

				</p>

				<p>The use any such breakthrough sees would be quite limited, because the existence of such an intelligence resource is much more sensitive than e.g. information (other than control codes) concerning spy satellites. My guess is that intelligence from such a source would generally only be used by dedicated personnel to independently confirm intelligence from other sources or to guide less sensitive resources, unless the intelligence is VERY valuable and credible (and even then they would work very hard to conceal the actual source and to create credible alternatives &#8212; see e.g. <a href="http://en.wikipedia.org/wiki/Zimmermann_Telegram" rel="nofollow ugc">Zimmermann telegram</a>, where there was an attempt to conceal both monitoring of a telegram cable and the capability to decrypt the German cipher).</p>
<p>It&#8217;s also hard to believe that they couldn&#8217;t control the small group entrusted with the knowledge enough to prevent rumors like this from spreading &#8212; although people are always the weakest link, this kind of classified information generally comes with enough surveillance of the personnel trusted with the information that they know better than to start rumors.</p>
<p>My guess is that this is just a plain old rumor. If it somehow originates from the government, it might be in the hope that potential targets switch from &#8220;untrusted&#8221; strong encryption (AES) to potentially weaker systems (this isn&#8217;t unheard of).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176858">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176858">
						March 22, 2012 11:53 AM					</a>

				</p>

				<p>@Clive: &#8220;[NSA] would be unlikley to allow AESs use beyond &#8220;confidential&#8221;. &#8221;</p>
<p>This one of the main arguments pro AES, IMHO.<br />
The NSA likely cannot have a practical break against AES and at the same time be convinced that AES has a high enough security margin to protect top secret data against foreign governments. Or would they be so arrogant?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176859">

			<div class="comment by-c-u-anon ">

				<p class="commentcredit">

					<span class="commenter">C U Anon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176859">
						March 22, 2012 12:03 PM					</a>

				</p>

				<p>@ Random Walk,</p>
<p><i>2<strong>1024 ~= 10</strong>306</i></p>
<p>Not all the numbers between 2^1024 and (2^1025)-1 are valid as RSA keys (just exactly how many are and are not on the other hand is quite a hard problem, but we know it&#8217;s very definatly less than half that are ðŸ˜‰</p>
<p>Oh for those wishing to get a reasonable aproximation of 2^n as 10^m in their heads or on a calculator which does not do large values of n</p>
<p>2^(n mod 10) x 10^(3 x int(n/10))</p>
<p>which for n= 1024</p>
<p>gives 2^4 x 10^(306) ~= 16 10^306 = 1.6 10^307</p>
<p>To get it a bit more acuratly on a calculator</p>
<p>1.024^(n/10) x 2^(n mod 10) x 10^(3 x int(n/10))</p>
<p>~1.76769 10^308</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176860">

			<div class="comment by-sean ">

				<p class="commentcredit">

					<span class="commenter">Sean</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176860">
						March 22, 2012 12:20 PM					</a>

				</p>

				<p>Proof positive that if a headline ends in a question mark, the author always answers that question with a &#8216;no&#8217;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176861">

			<div class="comment by-mikea ">

				<p class="commentcredit">

					<span class="commenter">MikeA</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176861">
						March 22, 2012 12:47 PM					</a>

				</p>

				<p>I find it interesting that while debating dancing-angel level details of encryption, the notion that &#8220;the government&#8221; acts as one mind is un-challenged.<br />
Have we forgotten the Thane of Glamis, loyal general to Duncan? I suspect it is quite rare in the history of the U.S. that the intelligence services, the armed forces, the executive branch, the courts, and the legislature all acted fully in accord.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176862">

			<div class="comment by-calum ">

				<p class="commentcredit">

					<span class="commenter">Calum</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176862">
						March 22, 2012 1:08 PM					</a>

				</p>

				<p>Sean, you may wish to review John Rentoul&#8217;s famous Internet series, &#8220;Questions To Which The Answer Is No&#8221;, or QTWTAIN.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176863">

			<div class="comment by-chris-b ">

				<p class="commentcredit">

					<span class="commenter">Chris B.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176863">
						March 22, 2012 1:43 PM					</a>

				</p>

				<p>Maybe they quietly proved P=NP. ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176864">

			<div class="comment by-richrumble ">

				<p class="commentcredit">

					<span class="commenter">richrumble</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176864">
						March 22, 2012 1:49 PM					</a>

				</p>

				<p>Unless the NSA is headed up by the people who do the UFO cover ups (those guys know what they are doing btw), then the NSA probably only has dedicated hardware to give it some &#8220;advantage&#8221;. I always thought it was funny that the US Gov&#8217;t approves your crypto for FIPS, as long as you pay for it. I wonder if they reject anyone that has the coin to apply in the first place. We saw how the Kingston, Blackbox, and Sandisk drive was 140-2 certified and yet had a simple mistake: <a href="http://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html" rel="nofollow ugc">http://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html</a><br />
Perhaps the NSA just has piles and piles of these kinds of flaws waiting to be used. How hard would it be for them to ask Veisign for THE root cert and it&#8217;s pass, they probably have it and many others already. Did/do the NSA have access to Carrier-IQ and it&#8217;s ilk? Did that USB drive get ok&#8217;d out of laziness, was it just a one time thing, a hiccup in the FIPS process&#8230;<br />
I bet AES is fine if done correctly, perhaps side-channels and other methods are better than brute force.<br />
-rich</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176865">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176865">
						March 22, 2012 2:15 PM					</a>

				</p>

				<p>Yeah, sure they can break AES. Just like they can&#8217;t break Skype. ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176866">

			<div class="comment by-ping-che-chen ">

				<p class="commentcredit">

					<span class="commenter">Ping-Che Chen</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176866">
						March 22, 2012 2:22 PM					</a>

				</p>

				<p>@C U Anon:</p>
<p>Since the number of prime numbers &lt; n is approximately n / ln(n), and for RSA to work well we&#8217;ll want two prime numbers of similar size, so we can roughly estimate using 2^512 numbers:</p>
<p>2^512 / ln(2^512) ~ 3.78&#215;10^151</p>
<p>around half of these are smaller than 2^511 so that&#8217;s roughly 1.89&#215;10^151. Now pick any of these two so the combinations are roughly</p>
<p>(1.89&#215;10^151)^2/2 ~ 1.78&#215;10^302</p>
<p>A few order of magnitude than 1.77&#215;10^308 but certainly still more than the size of the universe ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176867">

			<div class="comment by-rf ">

				<p class="commentcredit">

					<span class="commenter">RF</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176867">
						March 22, 2012 2:56 PM					</a>

				</p>

				<p>NSA published a short document called &#8220;The Case for Elliptic Curve Cryptography&#8221; in 2009 just saying factoring big numbers was getting easier and easier over time. So, there&#8217;s that.</p>
<p>Former NSA folks have also said a quantum computer seems like just a big engineering problem. That seems years away even with NSA&#8217;s billions, plus if we had them there would be tons of important non-cryptographic impact, but what do I know? (&#8220;But the harder the NSA studied, the more it came to the conclusion that quantum computing was simply a massively difficult engineering problem that may eventually be solved,&#8221; from a December 21, 2006 article.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176868">

			<div class="comment by-vik ">

				<p class="commentcredit">

					<span class="commenter">vik</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176868">
						March 22, 2012 3:50 PM					</a>

				</p>

				<p>Even if they can break aes, in most cases they wouldn&#8217;t be able to use the intel gathered in ant meaningful way, since this would reveal they&#8217;ve broken aes. Much like the breaking of enigma, really</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176869">

			<div class="comment by-fusion ">

				<p class="commentcredit">

					<span class="commenter">fusion</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176869">
						March 22, 2012 4:14 PM					</a>

				</p>

				<p>Are book ciphers still in use?  And how would they withstand attack today?  [shades of &#8216;The American Black Chamber&#8230;Yardley?]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176870">

			<div class="comment by-arkanoid ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://arkanoid.livejournal.com' rel='external nofollow ugc' class='url'>arkanoid</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176870">
						March 22, 2012 4:18 PM					</a>

				</p>

				<p>1024 bit RSA is doomed, that&#8217;s obvious. The real question is &#8220;does NSA have impressive advantage in quantum computing&#8221;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176871">

			<div class="comment by-c-u-anon ">

				<p class="commentcredit">

					<span class="commenter">C U Anon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176871">
						March 22, 2012 4:33 PM					</a>

				</p>

				<p>@ Ping-Che Chen</p>
<p><i>A few order of magnitude than 1.77&#215;10^308 but certainly still more than the size of the universe</i></p>
<p>Undoubtedly so, and also considerably closer to the exact answer than Random Walk&#8217;s original value of 2^306, but getting the exact answer is still going to be a hard problem&#8230;</p>
<p>However thats not the real fun of RSA pairs, have you any idea just how much redundancy there is in there that you can exploit to hide a secret that tells you either what one of the prime factors is or gives you a starting point reasonably close to one of the prime factors?</p>
<p>The fun is you can quickly demonstrate that providing the RSA generator software is a black box Oracle (as in Delphie) it is not possible to prove that it&#8217;s output is backdoored or not&#8230;</p>
<p>Which means you cannot trust &#8220;turnkey&#8221; code to generate your RSA key, you have to &#8220;roll your own&#8221;. Similar reasoning behind other asymetric key systems means potentialy we have a serious problem.</p>
<p>Even when you have the source to look at few people would recognise the &#8220;backdoor&#8221; code as it can be quite easily disguised to look like it is a valid part of the prime random selection process.</p>
<p>Few people can look at code and see the real &#8220;entropy&#8221; from a &#8220;determanistic process that looks random&#8221; which then gets hashed up etc as a starting point on the prime search.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176872">

			<div class="comment by-bob-roberts ">

				<p class="commentcredit">

					<span class="commenter">Bob Roberts</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176872">
						March 22, 2012 4:49 PM					</a>

				</p>

				<p>Is it possible that NSA is setting themselves in the internet backbone to effect massive MITM attacks every time an SSL session is initiated?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176873">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176873">
						March 22, 2012 5:27 PM					</a>

				</p>

				<p>From what I have seen, a lot of crypto-implementations suck badly, both in the actual crypto and in the randomness-gathering. Many people designing and implementing this stuff do not really understand what they are doing.</p>
<p>The other thing that typically sucks is the passwords/passphrases users select. For example, I would imagine the NSA has rainbow tables that make Googles data-storage capabilities look small. Nothing proper salting cannot defeat, but, again, many implementations do not salt properly or not at all.</p>
<p>As to AES, I am not worried. The astronomical damage a real-world AES break would do to the world (and US) economy would prevent them from using that capability in almost all cases. And they would have a massive interest in it not being there in the first place for the same reason. After all, if there is such a vulnerability, somebody else could find it.</p>
<p>Site note for the paranoid: You can allways combine different ciphers to make the problem much, much harder. TrueCrypt offers that out of the box, for example. If you combine, say, 3 AES finalists with independent keys in  OFB mode, that would be at least as secure as the strongest of them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176874">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176874">
						March 22, 2012 6:05 PM					</a>

				</p>

				<p>@ Gweihir</p>
<p>&#8220;For example, I would imagine the NSA has rainbow tables that make Googles data-storage capabilities look small&#8221;</p>
<p>I wouldn&#8217;t dare compare: Google and Amazon have massive capacity that only increases over time. NSA has this big datacenter. The other two have datacenter<b>s</b>. Processing power probably shifts in NSA&#8217;s direction. Anyway, nice guess at the rainbow tables. Having rainbow tables for the most complete dictionary for most common crypto schemes would be a tremendous advantage.</p>
<p>&#8220;Site note for the paranoid: You can allways combine different ciphers to make the problem much, much harder. TrueCrypt offers that out of the box, for example. If you combine, say, 3 AES finalists with independent keys in OFB mode, that would be at least as secure as the strongest of them. &#8221;</p>
<p>Excellent advice. I&#8217;ve given similar advice in the past. Triple encryption of a TrueCrypt volume on a midrange laptop from 2009 gave me 10MB/s-20MB/s disk throughput. So, performance is definitely ok. I&#8217;d add that TrueCrypt, like my recommendations, hides which algorithm(s) were used. So, when it gets the key, it has to try a whole bunch of them on a sample of data to figure out which one. For the adversary, if the cipher(s) are random, they have to try to attack <b>all</b> combinations.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176876">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176876">
						March 22, 2012 7:36 PM					</a>

				</p>

				<p>How much is all this NSA interception going to slow down the internet?  Where is the bandwidtch coming from to collect all that data or traffic?  Is it even feasible?</p>
<p>I suspect I am naive here but wouldn&#8217;t the factors of 1024 bit numbers be just a table lookup (though the size of that table is probably beyond my imagination).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176877">

			<div class="comment by-reed-solomon ">

				<p class="commentcredit">

					<span class="commenter">Reed-Solomon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176877">
						March 22, 2012 7:52 PM					</a>

				</p>

				<p>&#8220;For the adversary, if the cipher(s) are random, they have to try to attack all combinations. &#8221;</p>
<p>No, all they have to do is one or more of the following:</p>
<ul>
<li>Install pinhole wireless camera(s) aimed at the workstation/keyboard and/or at something which reflects towards the target area, example: a tiny camera aimed at your tv screen or other surface which is positioned in such a way where it can, by reflection, capture your keystrokes and other work at your workstation</li>
<li>Hardware keylogger or special blackop device inserted around or in a targeted hw device, recent announcements of special devices which go directly into the wall socket/power strip which are made to look like something innocent like an air freshener, etc.</li>
<li>Laser microphone for keyboard clicks</li>
<li>Stand outside or b.s. their way inside for sniffing of the keyboard</li>
<li>
<p>TEMPEST attacks</p>
</li>
<li>
<p>whitelisted or unable to be found malware slipped in through any number of online vectors</p>
</li>
<li>
<p>poisoned router and/or modem firmware with commercially supplied backdoor(s)</p>
</li>
<li>
<p>Powerline analysis (smartmeters may ease the lubrication)</p>
</li>
<li>
<p>Attacks on wifi from within or outside</p>
</li>
<li>
<p>Attacks on wired connections from within or outside / spliced connections</p>
</li>
<li>
<p>Force a kernel/memory dump (usually easier on Windows systems) which is logged to disk unless you disable it and possibly sent in part or in whole to Microsoft unless you disable this</p>
</li>
<li>
<p>social engineered or otherwise manipulated individuals friendly and allowed inside said workstation area or invited in under the disguise of a religious group or other spoofed organization to plant devices or otherwise access the workstation</p>
</li>
<li>
<p>discovering your TC password written somewhere in your environment or on your person (missing time, medical procedures where you&#8217;re &#8220;under&#8221;, otherwise out of the workstation area during a sneaky entry and exit)</p>
</li>
<li>
<p>new electronic or other bugged/poisoned gifts sent to you and you place within your workstation environment, simple envelopes or magazines, books, with a miniture bug(s)</p>
</li>
<li>
<p>that slut or stud you brought home with you for a one nighter</p>
</li>
<li>
<p>more and more and more</p>
</li>
</ul>
<p>Given wikileaks&#8217; exposure of some of the vast companies foreign and domestic willing to sell spyware software and hardware if THEY want your (you meaning anyone and THEY meaning any determined enemy) TC password, they already have it or will obtain it, and it won&#8217;t be through brute force.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176878">

			<div class="comment by-the-red-wire ">

				<p class="commentcredit">

					<span class="commenter">the red wire</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176878">
						March 22, 2012 8:09 PM					</a>

				</p>

				<p>what of:</p>
<p>&#8220;modified coins?&#8221;</p>
<p>You visit a store to buy something,<br />
an evil person arrives before you,</p>
<p>slips the cashier through a handoff or fake prearranged (or real) transaction,</p>
<p>one or more &#8220;special&#8221; coins, containing a video and/or audio &#8220;bug&#8221;, maybe with a nice wire which wraps around inside of the modified coinage several times,</p>
<p>convinces or through some other motivating factor(s) (or by chance) the cashier to give you said coin(s) for change during your transaction,</p>
<p>evil person exits the store and the fun begins.</p>
<p>How often do YOU check YOUR coins to make sure they are really the real thing or do you just dump them in the same room as your computer(s)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176879">

			<div class="comment by-johnston ">

				<p class="commentcredit">

					<span class="commenter">Johnston</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176879">
						March 22, 2012 9:12 PM					</a>

				</p>

				<p>@Reed-Solomon at March 22, 2012 7:52 PM</p>
<blockquote><p>
  No, all they have to do is one or more of the following:
</p></blockquote>
<p>Who are <i>they</i> in the context of your post?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176880">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176880">
						March 22, 2012 9:17 PM					</a>

				</p>

				<p>@kashmarek: Factorizing 1024 bit via table requires basically tables for all prime products up to 1024 bit.</p>
<p>As a lower boundary, you could estimate the number of primes smaller than 2^1024. (After all one of them has to be in any prime product and there should always be another prime to make the product roughly 1024 bits. Of course there are far more than one prime for each fixed given prime so that the product is about 1024 bits, hence this is a <em>lower</em> estimate.)</p>
<p>By the Prime Number Theorem, the number of primes smaller than n is roughly n/ln(n).</p>
<p>ln(2^1024)  =  1024*log(2) ~ 710.</p>
<p>710 ~ 2^9.5</p>
<p>2^1024 / 2^ 9.5 = 2^1014.5</p>
<p>Hence there are about 2^1014.5 primes smaller than 2^1024. That would be about 10^300 primes. So you would have to store more than that for all prime products less than  2^1024. Given that the universe only has something like 10^80 particles in it, this seems pretty infeasible by a huge margin ðŸ˜‰</p>
<p>So, no, for 1024 bit primes, tables will not cut it, you have to either factor or know something that greatly reduces the number of candidates (bad RNG, for example).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176881">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176881">
						March 22, 2012 9:23 PM					</a>

				</p>

				<p>That should read:</p>
<p>&#8220;So no, for <b>1024 bit products</b> of two primes&#8230;.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176882">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176882">
						March 22, 2012 9:24 PM					</a>

				</p>

				<p>@ Johnston</p>
<p>Thanks. That was quite a useless counter aside from enumerating threats for people who haven&#8217;t heard of them (or don&#8217;t need to care for most). We&#8217;re discussing the security of ciphers against cryptanalytic attacks on the cipher text. He&#8217;s thinking about total security of one&#8217;s data in use and at rest against&#8230; all the major intelligence agencies combined?</p>
<p>Perhaps people like him should actually read the topic and comments before posting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176883">

			<div class="comment by-s5jepgnwigtq ">

				<p class="commentcredit">

					<span class="commenter">S5jePgNwIgtq</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176883">
						March 22, 2012 9:59 PM					</a>

				</p>

				<p>@Johnston:</p>
<p>Read the final lines in the post.</p>
<p>It is explained for you.</p>
<p>Thanks for quoting the time of the post, too, it makes the intent and origin of the reply and user more obvious.</p>
<p>@Nick P:</p>
<p>&#8220;Thanks. That was quite a useless counter aside from enumerating threats for people who haven&#8217;t heard of them&#8221;</p>
<p>You might want to add more coal to the furnace, you&#8217;ll attract more trolls that way. Baiting &#8211; I love it!</p>
<p>&#8220;We&#8217;re discussing the security of ciphers against cryptanalytic attacks on the cipher text.&#8221;</p>
<p>Did you read the OP? It included mention of, &#8220;side-channel attacks&#8221;, read it:</p>
<p><a href="https://en.wikipedia.org/wiki/Side_channel_attack" rel="nofollow ugc">https://en.wikipedia.org/wiki/Side_channel_attack</a></p>
<p>Also: &#8220;attacks that exploit key leakage&#8221; and so on.</p>
<p>&#8220;He&#8217;s thinking about total security of one&#8217;s data in use and at rest against&#8230; all the major intelligence agencies combined?&#8221;</p>
<p>&#8220;THEY&#8221; or &#8220;THEM&#8221; were explained in the post, no alphabet soup agency was mentioned.</p>
<p>&#8220;Perhaps people like him should actually read the topic and comments before posting. &#8221;</p>
<p>I did, I responded on-topic.</p>
<p>The baiting continues.</p>
<p>I enjoyed the baiting by both parties in order to gain a response.</p>
<p>I&#8217;m such a fool, a fool in love with&#8230; oh that&#8217;s a touching song, isn&#8217;t it?</p>
<p>&#8220;people like him&#8221;</p>
<p>Have you ever considered what it would be like to be kind and humble? This is the second thread I&#8217;ve read where several people have circled their e-wagons around a poster who isn&#8217;t a regular.</p>
<p>@Johnston:</p>
<p>Pass along my reply to your &#8220;friends&#8221; with the timestamp and any logs, I&#8217;m always interested in making new &#8220;friends&#8221;.</p>
<p>au revoir</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176884">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176884">
						March 22, 2012 11:18 PM					</a>

				</p>

				<p>Hmm,</p>
<p>There appears to be an issue with people talking about rainbow tables for factoring primes and passwords etc.</p>
<p>Firstly it&#8217;s not the size of the table that&#8217;s important but how long it takes to use it in any given situation.</p>
<p>There are two major time issues with tables, the first is producing them, the second is how long it takes to do a lookup.</p>
<p>Yes there are more efficient ways of finding primes than checking each number in turn however work out how fast a simple incrementing counter would have to be to count to 2^1023 in say a year (which is a little less than 2^25 seconds)&#8230; then compare that with the current clock speed of GPU&#8217;s etc (which is currently less than 2^32),</p>
<p>2^(1023-25-32) = 2^966 ~= 6.24 x 10^290</p>
<p>Even with special optimization techniques and massively parallel hardware you are looking at an exeadingly long snooze while your table builds. I&#8217;ll leave the energy requirments for others to work out but lets put it this way (the last time I did a napkin calculation) if the table builds in your working lifetime (~2^30 secs) you are looking at being quite warm at a distance from your &#8220;computer&#8221; aproximatly the same distance as the outermost planets of the solar system are from the sun&#8230;</p>
<p>But lets assume I had the &#8220;NSA magic wand&#8221; and could actually magic up a table preloaded onto modern hard drives how long would a single query to the table take? and how would I make a million or so queries simultaniously?</p>
<p>Just a few years ago I did the math for a &#8220;Home RAID box&#8221; table for 40bit DES and each query was going to take ~100mS (that is half the longest access time for the head to move from the inside to the outside of the platter and go round one full revolution) so only 10 lookups/second in a 2^40 table so with that as a basic building block your performance is not going to be very good unless you develop a serious optomisation technique or three (ie sorting the queries into order and firing them off at individual blocks etc)</p>
<p>So a physical table stored on COTS hardware would not be practical.</p>
<p>Are there other techniques that could be used, well yes there are you can make your factoring a lot more efficient by finding how many unknow RSA keys share a common factor. Such a technique was recently discussed on this blog when researchers published results on just how bad the &#8220;shared factor&#8221; problem was with SSL Certs and concluded there were a lot of very bad random number generators out there.</p>
<p>Thus actually factoring a single RSA key (CPU cycle expensive) can be spread across many many RSA keys once you have found they have a common factor (CPU cycle cheap in comparison).</p>
<p>It&#8217;s this sort of thing that the likes of the NSA GCHQ et al with all their &#8220;caged mathematicians&#8221; do as &#8220;bread and butter&#8221; work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176885">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176885">
						March 23, 2012 5:13 AM					</a>

				</p>

				<p>@Clive Robinson: Normally you are right. But if space is infeasible, you do not even need to look at time and not only because of the large numbers involved.</p>
<p>If space is feasible, then you can look at building the table and at lookup. No need for that here.</p>
<p>I am wondering at that 40bit DES lookup though. You would need one each possible ciphertext with each possible plaintext as lookup-key and look up the key. (Unless you assume chosen plain or ciphertext as attack). That would be 128 bit key and 56 bit element sizes, i.e. 2^128 * 7 Byte storage space, which is about 2.8*10^39 bytes and quite infeasible.</p>
<p>Or is this for a lookup-table implementation for DES?  There you would get around 10ms access time for raw disk access and a storage size of 8* 2^(40+64) Bytes, which still should be pretty much infeasible. Unless you use a fixed key. Then you have 8*2^64 storage size which is feasible, but not without a rather large building for the 150 million 1TB disks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176886">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176886">
						March 23, 2012 5:24 AM					</a>

				</p>

				<p>Moral of the day don&#8217;t let anyone talk to you about this blog and your posting whilst you are enjoying your first pint (20floz for those in US) of badly needed restorative brownian motion generator (ie a nice hot cup of tea).</p>
<p>It has been pointed out (thanks Dave) that I should have finished my previous post rather than let it hang&#8230; And made it obvious for &#8220;code cutters&#8221;&#8230; So,</p>
<p>Firstly if you have not seen it already go look at a page on this blog,</p>
<p><a href="http://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html" rel="nofollow ugc">http://www.schneier.com/blog/archives/2012/02/lousy_random_nu.html</a></p>
<p>And follow the links to get more indepth information.</p>
<p>As I said before factoring RSA keys into the PQ primes is CPU Cycle hungry, I don&#8217;t know what the current public factoring is (@Bruce or others do you know?) but bassed on previous attempts the NSA should be up somewhere around factoring one 1024bit key a weak without overly stretching their resources.</p>
<p>Which does not sound like a lot. However if you have followed the links you should now know that it is comparativly easy to find out whole sets of keys that share one prime. So factoring a key from this set gives you a fast way into the rest of the keys as you simply divide by one or other of the recovered prime factors to discover the unknown prime factor in the other keys in the set. This uses trivial amounts of CPU cycles in comparison to the actuall factoring. Thuss relativly large numbers of RSA keys can be broken with just one factoring.</p>
<p>Now a little bit of crypto history, encrypted messages in large signal nets usually consist of two parts the Key discriminator and the message encrypted under the key.</p>
<p>The key discriminator is effectivly a way to tell the receiving operator which key has been used to encipher the message. Befor WWI (1914) and for some time into it the relativly few signals could use a code book to translate the key discriminator back into the key. However it was quickly found that this does not scale well and has all sorts of issues with key managment etc. But primarily it ment it was easy to find out which messages had been encrypted under the same key. This often alowed an attack in depth, the clasic example being an OTP used twice, by simply adding the two messages together in the right way you cancel out the key stream that gives it it&#8217;s security and end up with the two plain texts added together. There are then fairly simple but tedious techniques to recover the two plain texts upto the length of the shortest message (and maybe a few charecters more).</p>
<p>Prior to WWII the Germans realised that warfare was going to be heavily reliant on signals and they adopted the Enigma machine for use. However they were aware of the two messages under the same key problem and came up with a system of key discriminators that alowed individual messages to be encrypted under randomly selected keys. Unfortunatly they made a couple of mistakes firstly they double enciphered the key discriminator that alowed the rotor wiring to be recovered and secondly humans are very bad for many reasons at picking random sequences so many messages were enciphered under the same key, and this alowed three Polish Cryptographers to use the key discriminators to determine which signals were encrypted under the same keys and attack not only the key discriminator in depth but also the enciphered message. As we know know this work moved forward via the French to the British and so the Ultra Secret was born that went on to develop all sorts of new and interesting methods of attacking machine ciphers, some of which still remain &#8220;officialy clasified&#8221; to this day.</p>
<p>Now spring forward to current times and how do we send encipherd messages and establish secure communications. Well some people with small signal nets or who have very high security requirments (The NSA GCHQ et al) still effectivly use &#8220;issued keys&#8221; from the equivalent of a book. The rest of us because the size of our potential signals net is world wide mainly use asymetric cryptography based around RSA or other Public Key cryptography.</p>
<p>If you look at an Email or other message sent under public key cryptography what you actually find is the plaintext enciphered under a standard symetric cipher such as AES and an encrypted key that acts as the key discriminator. This is encrypted by the message originator using the RSA (or equivalent) public key of the recipient such that the receiving party can decrypt the symetric key to decipher the message body to recover the plain text.</p>
<p>Thus being able to factor somebodies public key alowes you to rebuild their private key which gives you access to all the symetric keys and thus the plaintext of every message they have ever received under that key.</p>
<p>Buy using the fast algorithm to build sets of all public keys that have one prime factor in common you are effectivly doing &#8220;an in depth attack on the key discriminant mechanism&#8221;, which has significant potential.</p>
<p>As we know (you have read the linked articles ðŸ˜‰ there are one heck of a lot of very poor random number generators out there so some of these sets that share a prime factor can be very very large. Thus factoring just one of the keys in the set alowes you to quickly recover the private keys for all the other keys in the set&#8230;</p>
<p>Now what the NSA may well be doing is hovering up all the public keys they can and building them into sets to recover keys.</p>
<p>However there is a further wrinkle they can use&#8230; Because it&#8217;s the same poor random number generator generating both primes this gives &#8220;likely factors&#8221; into other unknown keys generated by the same design of software or hardware. It is very worth while building these into a small Rainbow Table to try speculativly when factoring one or more keys in other sets. Such a small Rainbow Table could be kept in high speed RAM on the CPU &#8220;cluster&#8221;, and a bit of clever software coding could be used to keep much of the information in CPU Cache memory or registers of an appropriate CPU design (some GPU&#8217;s are almost made for the task).</p>
<p>Now back to what is and is not random and how much of it you need.</p>
<p>There are over 7billion people in this world and with all the bank cards, mobile phones, PC&#8217;s and &#8220;roles&#8221; people have it is easy to see we could have a need of something well over 100billion asymetric keys. This is 1 x 10^11 keys or ~ 2^37 keys consisting of two randomly selected primes.</p>
<p>Thus as the primes should be independent you would need two lots of 2^37 or 74bits of independent randomness. However there is a catch known as the &#8220;Birthday Paradox&#8221; which means to avoid random colisions you need twice the number of bits again. Thus an absolute minimum of 148 bits of fully independent or true randomness before we consider generating the two primes, and you realy should consider actually generating the same number of truely random bits as the total key length (ie 1024 bits for a 1024bit RSA key).</p>
<p>As indicated we know there are an awful lot of poor random number generators out there and worse on examining the code many are very very predictable due to not having true randomness or entropy as a source.</p>
<p>Also two many random number generators written by application programers apear to believe that they can generate entropy by using hash functions etc on a very very limited amount of true randomness derived from a physical source and properly debiased. All using a hash function does for you is spread your tiny amount of entropy across all the bits of your hash output. This is because the output bits of the hash are determanisticaly related to each other and not fully independant of each other.</p>
<p>We may not be able to role a hash backwards but the NSA certainly has the computing resources to work out the limited amount of entropy various devices and software generate and build a small(ish) Rainbow Table based on the entropy.</p>
<p>As Bruce and others have indicated in various books and papers gathering real entropy and generating good randomness from it is actually quite a hard problem.</p>
<p>And please don&#8217;t rely on &#8220;code libraries&#8221; even those (supposadly) written by experts because they don&#8217;t know about the reliability and charecteristics of the physical sources you chose to use as the input to their generators, as has been observed before you cannot magic stuff from thin air no matter how much &#8220;magic pixie dust&#8221; you use, and the GIGO principle applies with absolute certainty.</p>
<p>[For those who may not have heard of GIGO it stands for &#8220;Garbage In for Garbage Out&#8221; and thus clearly indicates the output quality of a determanistic process is 100% dependant on the input quality, if it&#8217;s bad then you get bad.]</p>
<p>Anyway I now feel the need for my third 20floz of strong brownian motion generator ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176887">

			<div class="comment by-kirt-cathey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://sysrisk.com' rel='external nofollow ugc' class='url'>Kirt Cathey</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176887">
						March 23, 2012 6:19 AM					</a>

				</p>

				<p>Provoking posting and great comments! I read all the way through and found some of the comments to be as consuming as the original post. That said, agree with Bruce in that the gov&#8217;t has probably not been successful, but also believe that it is possible with their resources. Especially, given the fact (as one poster pointed out too) that many of the opportunities to crack 1024 bit would be by a method other than factoring.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176888">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176888">
						March 23, 2012 6:57 AM					</a>

				</p>

				<p>@ Gweihi,</p>
<p><i>Clive Robinson: Normally you are right. But if space is infeasible, you do not even need to look at time and not only because of the large numbers involved</i></p>
<p>Well a couple of reasons to mention it,</p>
<p>Firstly people will talk about time/memory trade offs which to be honest I&#8217;ve never found pan out except in very special (read &#8220;very very expensive&#8221;) circumstances.</p>
<p>Secondly a Rainbow table does not have to be even remotely close to being even a fraction of one percent of the total space to be usefull and people will argue it&#8217;s still a valid aproach (which it can be as my post following it points out). A simple well known example is with MD5 hashes of simple one or two word passwords.</p>
<p>As for the 40bit DES home RAID box it came about due to cheap hard drives and somebody making the two arguments above. That is there are time memory trade offs to be made and sometimes you don&#8217;t need the whole space.</p>
<p>If you have (as some protocols unfortunatly do) a known plain text at a known position that exceeds the cipher block size then you end up with a one to one mapping on a subset of the total possible cipher text output in that block.</p>
<p>That is 2^40 keys will only give 2^40 cipher texts of 8 bytes each. The table produced is thus only 2^43bytes or 8 terabytes in size (you need a bit more as you have to alow for the HD manufactures fiddle of 1Tbyte = 1.0 x 10^12 bytes not 1.1 x 10^12).</p>
<p>However the table is fairly usless unless you come up with a way to sort it on the cipher texts. This can be done as it&#8217;s a sparse data set (ie only 2^40 out of 2^64 or 1 in 16777216) and it can also be speeded up (and marginaly compressed) by having a first byte or word of a hash pre index once it&#8217;s sorted.</p>
<p>The point of doing the math was to show that although it could be done and there was a time benifit it realy did not pay off due to the maximum access time to read your first byte, let alone the time to build the initial table and then sort it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176889">

			<div class="comment by-doubletalk ">

				<p class="commentcredit">

					<span class="commenter">doubletalk</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176889">
						March 23, 2012 7:55 AM					</a>

				</p>

				<p>Perhaps the question should be, what can the Chinese and Russians do?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176891">

			<div class="comment by-bob-t ">

				<p class="commentcredit">

					<span class="commenter">Bob T</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176891">
						March 23, 2012 8:29 AM					</a>

				</p>

				<p>So basically, the NSA sent a phishing email with a subject of &#8220;2011 Recruitment Plan&#8221; with an attached Excel spreadsheet containing an embedded flash object to an RSA engineer&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176892">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176892">
						March 23, 2012 10:15 AM					</a>

				</p>

				<p>@ Bob T</p>
<p>&#8220;So basically, the NSA sent a phishing email with a subject of &#8220;2011 Recruitment Plan&#8221; with an attached Excel spreadsheet containing an embedded flash object to an RSA engineer&#8230;&#8221;</p>
<p>Yeah, basically. Plus a few dozen other companies. Used Chinese relays. Et cetera.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176893">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">jack</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176893">
						March 23, 2012 10:20 AM					</a>

				</p>

				<p>So a question or two&#8230;</p>
<p>If a person gets a list of known primes, would current technology allow nearly anyone to do prime factorization of the crypto keys sufficiently fast?</p>
<p>And how large a list of known primes should a person try to get hold of at a bare minimum?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176894">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">jack</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176894">
						March 23, 2012 10:27 AM					</a>

				</p>

				<p>And another two questions&#8230;</p>
<p>If US government has found a way to do quick prime factorization (considering the shortcuts Clive and others mention I guess this is not farfetched) to decrypt the &#8220;enemy side&#8221; keys then the cat would be out of the of the bag and they would just have to deal with the fact that the technology also gives them ability to decrypt domestic communication as well.</p>
<p>For this reason I wanted to ask:<br />
1. does anyone know if any crypto tech exists that does not rely on prime numbers for keys?<br />
2. would it not be possible that some top secret communication channels use some cryptography (or other form of info hiding/channels/etc) that is not suspectible for prime factorization?</p>
<p>TIA</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176896">

			<div class="comment by-jimfive ">

				<p class="commentcredit">

					<span class="commenter">JimFive</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176896">
						March 23, 2012 11:20 AM					</a>

				</p>

				<p>@Gweihir/NickP</p>
<p>Re: &#8220;Site note for the paranoid: You can allways combine different ciphers to make the problem much, much harder. [&#8230;] at least as secure as the strongest of them. &#8221;</p>
<h2>I just wanted to point out that this isn&#8217;t necessarily true.  It is entirely possible that combining algorithms makes the resulting ciphertext easier to decipher.  Combining algorithms basically creates a new algorithm that needs to be analyzed independently.</h2>
<p>JimFive</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176897">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176897">
						March 23, 2012 12:19 PM					</a>

				</p>

				<p>I&#8217;m a devoted adherent of Occam&#8217;s razor:  while it&#8217;s impossible to rule out that NSA found a crack in AES, or figured out how to make useful quantum computers (etc. etc.) &#8230; suppose that NSA has simply applied what is already known and developed.</p>
<p>As Bruce observed, there&#8217;s still a lot of 1024-bit RSA around, even though the keylength guidance long ago recommended that they not be used past 2010.  The holders of the public RSA factoring record (a 768-bit product of randomly chosen primes of about the same size) estimated that factoring a 1024 bit RSA modulus would be about 1000 times as complex.</p>
<p>I did a some looking up and number crunching (won&#8217;t bore you with the details here), and estimated what it would take to factor a 1024-bit RSA modulus.</p>
<p>First, I expect that a core cost is energy (electricity), and estimate the cost to be roughly $200,000 to $400,000 per modulus factored.  If I assume the energy efficiency of the computing resources to be on the good side, or about $250,000 per modulus, then NSA could factor one modulus per day at a cost of about 2.5% of their estimated budget (officially, the NSA budget has never been disclosed).</p>
<p>I also made a very crude estimate that hardware sufficient to factor a 1024-bit modulus in 24 hours (using the most economical clustering techniques) might cost about $2 billion, or perhaps even less.  If this is correct, then the capital financing cost would be somewhat less than the energy cost (assuming continuous operation).</p>
<p>I have no idea whether NSA has done such a thing.  Certainly, it is feasible for NSA to have done so, and it makes sense for them to try.  Because the cost of discrete logarithms is supposed to be similar to that of factoring, the same hardware might be used to break 1024-bit Diffie-Hellman, which might be more useful in practice because of its application to online communication.</p>
<p>Note that is far as is publicly known, even the whole of the US security budget still would not suffice to break 2048-bit asymmetric encryption in a reasonable time frame.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176898">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">jack</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176898">
						March 23, 2012 1:22 PM					</a>

				</p>

				<p>@MarkH</p>
<h2>Note that is far as is publicly known, even the whole of the US security budget still would not suffice to break 2048-bit asymmetric encryption in a reasonable time frame.</h2>
<p>yes but isn&#8217;t that true ONLY if their process actually took the brute force factorization route?</p>
<p>I mean if they had some sort of tables with the prime numbers or some function that would generate the next prime number would it not be much faster?</p>
<p>For example would they not be able to utilize the RSA algorithm itself to generate keys that they can match with those that they want to break?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176899">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176899">
						March 23, 2012 1:42 PM					</a>

				</p>

				<p>@clive insightful as always.<br />
@Reed. You hit it exactly right on the real questions/methods in my humble opinion.<br />
@Bruce you summed it up nicely as what is probably really meant.<br />
I would tend to go with Occam&#8217;s Razor (joke) on this.</p>
<p>As much as the geek in me wants to believe that the super secret geeks/mathematicians/magicians have a really neat way of cracking AES, I have to realistically assess it as other, easier ways of cracking the encryption.</p>
<p>As usual the answer given can reveal as much about the questioner as the question itself.</p>
<p>I have to get the little kid in me restrained in these kind of discussions. ie. someone can crack the keycode to get into a building with a cracker..or they can see which numbers are clean/smudged&#8230;or just take a chainsaw to the side of the building..Why would the NSA build such a huge device if not needed?. Use only what is needed and spend money on more research&#8230;..Just saying&#8230;BTW I do think they are sucking every bit of information they can for later analysis, NSA testimony really parsed that carefully&#8230; ðŸ™</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176900">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176900">
						March 23, 2012 2:25 PM					</a>

				</p>

				<p>@jack:</p>
<p>Nobody factors large RSA moduli by &#8220;brute force&#8221; (i.e., trial division).  It is practically impossible.  The few examples that have been factored, were factored using the best publicly known algorithm, the General Number Field Sieve (GNFS).</p>
<p>It is on the basis of GNFS that I claim that as of today, 2048-bit moduli can&#8217;t be factored even with government-scale resources.</p>
<p>As to the use of tables, for attacking 1024-bit moduli (which are no longer recommended, being considered too small) &#8230;</p>
<p>&#8230; such moduli are usually the product of two 512-bit primes.  There are approximately 20,000,000,000,000,000,000,000,000,<br />000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,<br />000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,<br />000,000,000,000,000,000,000,000,000,000 such primes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176901">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176901">
						March 23, 2012 3:51 PM					</a>

				</p>

				<p>@JimFive: Generally, you are right. But for<br />
a) independent keys and<br />
b) OFB mode<br />
combining ciphers must be as secure or more secure than the most secure of them due to basic properties of XOR. Of course, OFB mode has problems as well, for example that one changed bit of plaintext produces one changed bit of ciphertext.</p>
<p>@Clive Robinson: As long as there is a space/time tradeoff, sure. But if memory is infesible by a very large margin, then there is no such tradeoff and time becomes irrelevant. Also note that what I describe is a very generously selected lower bound.</p>
<p>This is admittedly a special case. AFAIK there still is no efficient way to produce (count) all primes. That would indicate that you do not gain anything with partial rainbow-tables for RSA. Block-ciphers are fundamentally different.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176902">

			<div class="comment by-alo ">

				<p class="commentcredit">

					<span class="commenter">alo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176902">
						March 23, 2012 6:03 PM					</a>

				</p>

				<p>If I were NSA, I would have bought largest keyboard manufacturers years ago just to make sure they are non-TEMPEST.</p>
<p>Biggest problem being after that to keep their market share large enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176903">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176903">
						March 23, 2012 6:48 PM					</a>

				</p>

				<p>@alo:</p>
<p>Almost certainly, not necessary!  Probably every home or office keyboard you have ever seen leaks information badly.</p>
<p>Though this is not useful, without receivers in range of the right keyboards at the right times.  Inadvertant EM emissions tend to be at modest power levels, and not reliably readable without a receiver located nearby (perhaps 10 to 1000 meters).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176904">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176904">
						March 23, 2012 11:36 PM					</a>

				</p>

				<p>@ Gweihir, jack, MarkH,</p>
<p><i>That would indicate that you do not gain anything with partial rainbow-tables for RSA</i></p>
<p>Not in the &#8220;ideal RSA case&#8221;, but you do get a real step up with relativly small Raindow Tables for RSA keys whos primes were found from a lousy RNG of which there are many as numerous studies have shown.</p>
<p>And at the end of the day, ignoring for the minute &#8220;traffic analysis&#8221;, &#8220;getting at the plaintext&#8221; from the cipher text in the message is all the NSA is interested in.</p>
<p>So if getting the RSA protected AES key by getting at the prime factors of the RSA keys by exploiting weaknesses in poor random number generation works it&#8217;s good for them&#8230;</p>
<p>Now if you remember the watch word in journalism and spying alike is &#8220;protect your sources&#8221; so the NSA (I assume) is highly compartmentalised. Thus if you read the chain of events the other way around from plaintext backwards, applying Occam&#8217;s Razor each time,</p>
<p>As a highly compartmentalised NSA employee you get to see vast quantaties of these AES protected messsages being recovered, you and those you tell might logically assume the NSA has broken AES.</p>
<p>From a step back up the chain another highly compartmentalised employee might also assume as they see all these AES keys recovered from PKI protected messages that &#8220;the NSA had broken RSA etc&#8221;.</p>
<p>However at the next step back up the chain an NSA employee starts to see the real picture of weak RNGs in comms software used in applications and network devices having their starting state low entropy or poor entropy production being exploited.</p>
<p>Now at this point I will put my hand up and admit that I appear to be commiting the cardinal sin of arguing frrom effect back to cause (which I repeatedly tell people not to do). But&#8230; I&#8217;m actually starting from the known position of,</p>
<p>1, We know from recent research there are a lot of PKI certificates that have PubKeys with shared primes.</p>
<p>2, The research further indicates that certain &#8220;Net Devices&#8221; and &#8220;applications&#8221; made these PubKeys. (Because the researchers say they are in contact with the designers/manufactures to resolve the issues.)</p>
<p>3, We know that the usual way that large primes are found for key generation is by generating a random start point and walking forwards or backwards from that point untill a suitable prime is found.</p>
<p>4, We know that the random start point is almost always done by a determanistic software process labeled &#8220;Random Number generator&#8221; that few if any device/application developerss have any understanding of or interest in understanding.</p>
<p>5, We know that almost invariably the developers will either use someones &#8220;pet code&#8221; or &#8220;book example&#8221; or some &#8220;software library&#8221; because that is the path of least resistance.</p>
<p>6, We know that also the testing of such code is &#8220;it looks ok&#8221; not &#8220;it&#8217;s passed the following formal tests&#8221;, because the formal tests require knowledgable people to run them correctly, and there just isn&#8217;t that number of people out there to do it.</p>
<p>7, We know that nearly all the RNG software has non determanistic input from &#8220;entropy sources&#8221; but next to nobody knows how much entropy any given &#8220;unknown source&#8221; has if any it&#8217;s almost always &#8220;assumed&#8221; it&#8217;s enough. [Other RNGs such as BBS still need random data either for primes or a seed.]</p>
<p>8, We know that all entropy sources have bias but again next to nobody knows how to measure properly let alone remove it.</p>
<p>9, We know there is a long and inglorious history of &#8220;real world&#8221; failed crypto due to poor random number generators from causes 4-8</p>
<p>10, We know that a very big chunk of the people who can do steps 4-8 correctly work for the NSA, GCHQ, et al and the other major chunk in academia, few of the latter and generaly non of the former will assist in ensuring that a product has both a suitable Crypto RNG code driven by a suitable entropy source, and the protection mechanisms to ensure sufficient real entropy has entered the RNG before it makes an output.</p>
<p>So if I use &#8220;poor RNG&#8221; as my well known &#8220;cause&#8221; I can easily argue in the correct direction to the &#8220;effect&#8221; that looks like &#8220;NSA has broken AES&#8221; and show why NSA employees and journolists might believe that.</p>
<p>As for the use of Rainbow tables in &#8220;cracking RSA primes&#8221; I&#8217;m only talking about small tables of &#8220;good guess primes&#8221; to use as &#8220;an optimistic filter&#8221; that simplisticaly does a divide with each table entry in turn to see if the result is another prime. If not it&#8217;s no big loss you just move onto the next key. The aim is not to crack &#8220;a&#8221; key but crack &#8220;any&#8221; easy keys. In this respect it&#8217;s a bit like a car theif wandering around a carpark trying door handles to see if the car is unlocked, not a safebreaker with a sspecific target in mind.</p>
<p>Why might this work, well we also know that the real world failed cases of RNGs we have heard about existed for some considerable time before they became obvious. And in most cases the failure was due to,</p>
<p>1, A highly predictable input to the RNG that could be externaly predicted (such as a process ID, time of day, serial number, network numbers etc).</p>
<p>2, Incorrect implementation of RNG in software.</p>
<p>3, Little or no entropy in RNG input prior to use of output.</p>
<p>And in many cases the actual entropy at the RNG output was less than 2^20.</p>
<p>We can safely assume that the NSA, GCHQ, et al have people devoted to analysing any new devices and software which might be used by those they have a &#8220;mandate to listen upon&#8221;, and that the RNG would probably be a starting point so any failings would be well known to them. Especialy as there is actually so little Crypto RNG software out there.</p>
<p>Therefore it is safe to assume that the NSA would have both the technical skills and the actuall product knowledge to know how to build and correctly populate such Rainbow Tables.</p>
<p>We also know that a Rainbow Table with 2^20 entries (ie one million) will sit quite comfortably in a PC&#8217;s RAM even with 512bit entries (ie 512MByte or 0.5GByte).</p>
<p>Such a Rainbow Table system would be quite happy as an undergraduate research project using the PC&#8217;s in a universsity lab. The other parts would be quite happy as postgrad to doctoral thesis projects. It&#8217;s also the sort of thing I would expect to see five or six publishable papers written about the various aspects (and arguably some of the existing papers would just need a few sentances changed to give a different view point to make them relavent).</p>
<p>For instance the work done that Bruces blog page from last month posts to could easily have one or more second/derived papers written that show how once the &#8220;sets&#8221; of keys with common primes are identified the result of factoring just one key could give up all the other primes involved very quickly and these could be analysed either to show further weaknesses in the underlying RNGs or analysed for suitability for putting into a Rainbow Table system to use as a &#8220;quick guess&#8221; pre filter to make full key factoring unnecessary for a large number of PubKeys in use on the Internet.</p>
<p>If such papers did appear I&#8217;m reasonably certain they would attract a lot of attention and as such make a few peoples names sufficiently well know they could capitalize on the publicity career wise (and if you are reading this and think yes I&#8217;ll do that then buy me a beer ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176905">

			<div class="comment by-gweihir ">

				<p class="commentcredit">

					<span class="commenter">Gweihir</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176905">
						March 25, 2012 6:35 PM					</a>

				</p>

				<p>@Clive Robinson: With insufficient entropy in the key-generation process, all bets are off. And I agree that this is a common problem encountered in practice and that cleverly crafted rainbow-tables may help here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176906">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176906">
						March 26, 2012 11:47 PM					</a>

				</p>

				<p>@Clive R<br />
&#8220;1, A highly predictable input to the RNG that could be externaly predicted (such as a process ID, time of day, serial number, network numbers etc).</p>
<p>2, Incorrect implementation of RNG in software.&#8221;</p>
<p>I agree completely, I would only add that, designing good RNG&#8217;s is hard but testing &amp; compliance checking RNG&#8217;s is an hellishly difficult task.</p>
<p>Most engineers select a good basic design for an RNG, but screwup the implementation, especially wrt susceptibility to locking to external signals / power supply noise. Engineers then fail to ever properly test the resulting RNG.</p>
<p>Testing RNG&#8217;s raises the fundamental problem of &#8220;what is random&#8221;  If I test a single RNG and it never gives me the same number twice, is that random?<br />
 Is it random only if there is no determinable count pattern?<br />
Is the number only random when the &#8220;entropy&#8221; is evenly distributed across the entire length of the generated random number?  (think about what is implied by the concept of a maximum &#8220;1&#8217;s , 0&#8217;s&#8221; string distance)</p>
<p>Depending on your intended RNG application you can find at least half a dozen definitions for &#8220;random&#8221;. So compliance testing is a doubly difficult job.</p>
<p>BTW every managers a** will pucker up tighter than a snare drum, when you tell them the minimum sample size and necessary test time required to check for randomness.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176907">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176907">
						March 27, 2012 10:50 AM					</a>

				</p>

				<p>@ RobertT,</p>
<p><i>BTW every managers a** wil pucker up tighter than a snare drum, when you tell them the minimum sample size and necessary test time required to check for randomness</i></p>
<p>Last time I quoted to an Engineering Director, he looked like his 455 had suffered from &#8220;The healing hand of Jesus&#8221; as he fairly rapidly became full of it&#8230;</p>
<p>I don&#8217;t like using the word &#8220;Random&#8221; any longer when talking to engineers and the like I prefer &#8220;nondetermanistic&#8221;, because the word &#8220;Random&#8221; appears to engage &#8220;magic thinking&#8221; in many heads. Random also gives engineering mono focus on the output not the process and many people fall prey to this, not least of all the warious levels of software person (code cutters upwards including some computer scientists).</p>
<p>And this diferent outlook is vitaly important, one way of looking at a nondeterministic source is as a determanistic source with bias and noise. Where the determanistic source is either a chaotic oscillator or more correctly an amplifier of high gain.</p>
<p>Thus as you note any signal at it&#8217;s input is going to be reflected in the output. Now if this signal is sufficiently periodic then it &#8220;might&#8221; be picked up during the design and tessting processes but otherwise not.</p>
<p>But what if the signal is actually &#8220;truely random&#8221; in it&#8217;s own right? Yup zero chance of it being picked up in the design and test process.</p>
<p>Now if you say that to many engineers you get down to the &#8220;random is random&#8221; argument&#8230;</p>
<p>And it is not untill you ask them what would happen if you have two nondeterministic sources adjacent to each other both subject to the same truely random input signal that some of them get it. Others you have to say and what if I put a truley random signal on to an RF carrier and pointed it at your nondetermanistic process, before they get it. However a sizable number have to have it pointed out to them that as the attacker I now fairly well know what the output of their nondeterministic process is before the penny drops. Oh and then there are those destined for walnut corridor who say &#8220;yeah and what does that have to do with anything!&#8221;&#8230;.</p>
<p>[For those reading who might not be &#8220;old school engineers&#8221; several hundred years ago it was discovered that pendulums that were close enough together influenced each other and would fall into &#8220;lock step&#8221; where they would synchronize their movments. In modern electronics it&#8217;s called &#8220;injection locking&#8221; and the chances are you have an example in your home with the &#8220;colour burst&#8221; oscillator in your TV]</p>
<p>I was mucking about doing active fault injection attacks with modulated RF carriers back in the 1980&#8217;s fully independantly of others. What has amazed me is it was only very recently a couple of students wrote a paper showing how they had turned what was supposed to be a 32bit random number generator into one that was less than 8bits just by pointing an unmodulated RF carrier at it&#8230;.</p>
<p>And as we know the Russians amongst others have pointed both modulated and unmodulated carriers at various diplomatic missions and secure sites for years&#8230;.</p>
<p>Thus I would say it&#8217;s actually impossible to certify a nondetermanistic source unless you fully control it&#8217;s environment. And with 70dB above thermal noise easily achivable in an active attack most engineers are not going to get even close, and worse the users of their products never will either because the output will pass all the tests they throw at it&#8230;</p>
<p>And people ask me why I still use dice&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176908">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176908">
						March 27, 2012 12:45 PM					</a>

				</p>

				<p>@ JimFive</p>
<p>My scheme involves two good ciphers, AES or eStream grade, layered on top of each other with separate keys. I&#8217;ll reconsider it if you can show one case where a compromise occurred b/c two good ciphers were used in this way. So far, it seems to be a theoretical thing that never happens in practice. At least, it hasn&#8217;t come to my news wire.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176909">

			<div class="comment by-darren-r-starr ">

				<p class="commentcredit">

					<span class="commenter">Darren R. Starr</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176909">
						March 27, 2012 1:38 PM					</a>

				</p>

				<p>I&#8217;m not an expert on cryptography, though I&#8217;ve worked with AES a bit. My level of understanding of AES is not much more than what is found on Wikipedia at this time. That being said, it seems to me that it should be possible that if the header of the encrypted text is known or predictable, such as knowing that the first five bytes of an xml file is most certainly &#8220;&lt;?xml&#8221;, it should be possible to populate the first row and the first column of the second row with a known value.</p>
<p>From this, it should be possible to create an FPGA based engine with 256 vertical 32-bit SIMD (4&#215;8) multipliers and 65536 1&#215;8 multipliers and brute force possible roots to the Rijndael s-box within 2^16th * rounds employed cycles of cipher and test.</p>
<p>While that many multipliers sounds like a huge amount, if you have a budget large enough (NSA scale) and have access to VHDL developers with optimization skills, it should be possible to produce a relatively dense multiplier matrix model that could be synthesized in ASICs to do it.</p>
<p>Of course, I&#8217;m not an expert on this tech, but brute forcing a large portion of the final key in 2^48 clock cycles seems possible with a known prefix. That should decipher enough information to identify the count of rounds as well as a series of factors for the remaining key values. At that point, the egg heads in the math department could figure out how, using the 6th byte which is likely a space for example, the key can be factored further.</p>
<p>I&#8217;m pretty sure that the S-Box itself gets into the way of my theory, but I was under the impression there were algorithmic/mathematical attacks on that already.</p>
<p>Am I completely delusional, or would an approach like this be theoretically possible?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176910">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176910">
						March 28, 2012 3:31 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>So far, it seems to be a theoretical thing that never happens in practice</i></p>
<p>Depending on your view point it&#8217;s &#8220;does not happen now&#8221;&#8230;</p>
<p>Actually it probably does in a limited way but it should be of near zero significance these days.</p>
<p>That is if you have a known block of plain text and encrypt under one key then decrypt the resulting ciphertext under a different key will the resulting plaintext be the same as the original plain text?</p>
<p>Well you need to qualify the question a bit further by saying for &#8220;one, some or all the possible blocks of plaintext under the two keys&#8221;.</p>
<p>If you think about it because most of our block ciphers are based on a modified Fiestel round which in effect only XORS the plain text with the output of a (supposedly) one way function. All that needs to happen is that across the number of rounds the outputs of all the one way functions effectivly sum to the same value under the two different keys. Or to put it in a looser context on a bit by bit basis across the block width, all the coresponding one way function output bits to an individual plain text bit need only have the same parity&#8230;</p>
<p>Thus it can be seen that the design of the one way functions is quite challenging to prevent such an event occuring (and thus why many amateur block cipher designs are weak).</p>
<p>So to prevent the use of two chained ciphers looking like one cipher in part or whole you would need to look at both the round structure and one way functions and check to see that they are orthagonal to each other.</p>
<p>However most ciphers that made it to the final round of the AES are sufficiently well designed that it should not be an issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176911">

			<div class="comment by-joao ">

				<p class="commentcredit">

					<span class="commenter">Joao</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176911">
						March 28, 2012 9:01 PM					</a>

				</p>

				<p>Most probably what NSA (and is associates) have is a special quantum computer <a href="http://cryptome.org/2012/03/qc-footprint.htm" rel="nofollow ugc">Quantum Computation Cognitive Footprint</a> dedicated to find those private parts of RSA/ DSA/ EC asymmetric keys.<br />
Probably they can break each one (from 0 bits up to &#8220;infinite&#8221; bits of RSA/ DSA/ EC) in less then one second.</p>
<p>So in practice, because their isn&#8217;t normally anything else protecting AES encrypted messages on the Internet, they can intercept and decode every single one of the connections on real time, or later.</p>
<p>Even if they can&#8217;t break for example EC easily (that they are recommending for protecting confidential information)&#8230; does some one else notice that both NIST and ECRYPT II do state that for Elliptic Curve to have the same level of security like a symmetric 256 bits (security) algorithm it needs to have AT LEAST 512 bits, and use an hash algorithm with AT LEAST 512 bits&#8230; but NSA says that for those same 256 bits of security is only need 384 bits and an 384 bits hash&#8230; but according to the NIST that is only enough to protect up to 192 bits of security.</p>
<p>Sure you can encrypt the messages using just a phrase with at least 40 ASCII characters&#8230; but is only useful if it is just for a few persons&#8230; using e-mail&#8230; but any discloser (malware, video surveillance, and others) and the message get&#8217;s open. And&#8230; where is that software? And does that securely? And what about, how to be sure is from the real source?</p>
<p>Better option is to use 256 bits Serpent algorithm&#8230; considered the must secure AES finalist of all. But still&#8230; the implementation must be totally secure.</p>
<p>Also don&#8217;t forget&#8230; DES was also recommended by NSA, and on that time they reduce the strength in bits of the cipher in order to break it easily&#8230; AES (Rijndael) was considered the less secure from all at the contest (less security margin)&#8230; so the first to  probably be fully break (if it isn&#8217;t already by NSA and is associates).</p>
<p>Why they would put in risk their own confidential stuff, they have already done that in the past (DES), they are pretty sure no one else can break it easily&#8230; and doesn&#8217;t have access to the information in first place (or they think)&#8230; and for some reason they have Suite A&#8230; with secret algorithm to protect the real Ultra Top Secret information. So the rest of the world using AES is pretty good because they can intercept everything and decode in real time, to see if their is anything interesting inside.</p>
<p>Paranoia aside, even if they can break all RSA/ DSA/ EC keys and see all inside in clear, they still have to analyse, separate the good from the bad stuff, and store all of that&#8230; storing sure isn&#8217;t a problem for them, but the rest still seems to be because even to analyse the clear traffic is already a mess with so much junk out their, and not to add that encrypted traffic is in most cases not that much important, even for them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176912">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176912">
						March 29, 2012 12:40 PM					</a>

				</p>

				<p>@ Clive Robinson on Joao&#8217;s post</p>
<p>You care to take a look at it? A lot of unfamiliar terms for me. I&#8217;m not educated on the topic enough to confirm my suspicion it&#8217;s pseudoscience or just false.</p>
<p><a href="http://cryptome.org/2012/03/qc-footprint.htm" rel="nofollow ugc">http://cryptome.org/2012/03/qc-footprint.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176913">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176913">
						March 29, 2012 12:44 PM					</a>

				</p>

				<p>@ Clive Robinson on cipher issue</p>
<p>&#8220;However most ciphers that made it to the final round of the AES are sufficiently well designed that it should not be an issue. &#8221;</p>
<p>That&#8217;s what I was thinking, albeit with less expertise on the subject. ðŸ˜‰ I figure you can also benefit similarly from one of the eSTREAM stream ciphers, such as Bernstein&#8217;s Salsa20. I like Salsa20 specifically b/c it&#8217;s extremely fast &amp; can be made faster by subtracting rounds, which shouldn&#8217;t hurt security in practice b/c it&#8217;s overdone. Two stream chiphers, two block ciphers or stream+block (gotta be careful there).</p>
<p>We could also use older ciphers like Blowfish or IDEA that haven&#8217;t been cracked. Then, randomly picking a combination should give the adversaries looking at the ciphertext a hard time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176914">

			<div class="comment by-moeluv ">

				<p class="commentcredit">

					<span class="commenter">MoeLuv</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176914">
						March 29, 2012 2:52 PM					</a>

				</p>

				<p>Water follows the path of least resistance. If there is a wall in the way it will go under, around or depending on the material and if it is porous, through.<br />
@Joao the NSA uses Suite A for a reason&#8230;:-)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176915">

			<div class="comment by-joao ">

				<p class="commentcredit">

					<span class="commenter">Joao</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176915">
						March 29, 2012 6:32 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>&#8220;You care to take a look at it? A lot of unfamiliar terms for me. I&#8217;m not educated on the topic enough to confirm my suspicion it&#8217;s pseudoscience or just false.&#8221;</p>
<p>Most terms seem familiar to me, and based on my own previous investigations over the years, this does seem real, or at least close to the reality.</p>
<p>Their was a TV episode (like in History Channel or something like that) where some one that worked at NSA said that they were in 2004 (or earlier), about 50 years ahead in mentality and technology used their. Many things out their, where invented by them and years latter sold to private company&#8217;s to make profit (they own the patents), when they already had something much better&#8230; mostly electronic related stuff.</p>
<p>So having a Quantum Computing dedicated to break at least asymmetric algorithms like RSA/ DSA / EC, is almost sure! Don&#8217;t forget that for years they (NSA) where doing everything to stop PGP&#8230; and from one day to another they stop worrying&#8230; I would that be? Couldn&#8217;t be just some weakness in implementation, because those would be caught over time, has many have, having computer power to break RSA/ DSA/ EC is much easy to believe&#8230; since would be the only thing that would give some assurance that they could still surveillance everybody else, like it&#8217;s their job to do. Weakness would not be enough because many governments/ military/ commercial clients, use their own products design by really smart people that really understands what they are doing&#8230; and if they make it compatible with PGP/ OpenPGP&#8230; that would be the end of the game.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176916">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176916">
						March 29, 2012 10:42 PM					</a>

				</p>

				<p>@ Joao</p>
<p>You are vastly overestimating them. The early Bamford book that discussed their specific technology compared to COTS at the time showed they were often about 5 years ahead &amp; mostly on incremental type stuff. They might have a quantum computer. I&#8217;ve been promoting quantum resistant algorithms for some time now. The best is (NTRU?) right now. I&#8217;d advocate a dual signature approach, one being RSA and the other quantum resistant.</p>
<p>As for PGP, I think they stopped being concerned about it when they realized everyone was using computers that are easy to hack and backdoor. It&#8217;s almost trivial to break into modern home and corporate network if you have their level of sophistication. Just leave USB drives with stealthy rootkits &amp; covert channels in the parking lot, then BAM! You&#8217;re in!</p>
<p>The most likely case is that public key crypto is still secure enough against most opponents, maybe the NSA too. I think they&#8217;re more likely to try other means and the quantum computers would probably be doing shared batch jobs. This means they would only be able to handle so much, leading to prioritizing. So, even if they have QC, you&#8217;re still unlikely to be affected by it unless your <i>really</i> important.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176917">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176917">
						March 30, 2012 1:07 AM					</a>

				</p>

				<p>@Joao et al.</p>
<p>The cryptome link posted by Joao is simply a copy-and-paste from &#8230; a comment on Bruce&#8217;s blog!  The comment is signed &#8220;energyscholar&#8221;.</p>
<p>If I understand what it is saying, then it is flat wrong.  The core claim seems to be</p>
<p>&#8220;The QC approach that actually works, in a production-ready scale-able way, is to run a virtual Turing machine atop a winner-take-all-style teleportation/entanglement-based recurrent topological quantum neural network (QNN).&#8221;</p>
<p>Even if that volcanic eruption of Tom Swift jargon means something, a &#8220;virtual Turing machine&#8221; would have the same limitations as any Turing machine (in other words, any conventional computer).  Quantum computers can &#8220;run&#8221; Shor&#8217;s algorithm, <i>precisely because they are <b>not</b> Turing machines</i>.</p>
<p>So even if the way to make a practical &#8220;quantum computer&#8221; were to &#8220;run a virtual Turing machine&#8221; on some kind of quantum construction, such achievement would not be an advance in the factoring of giant numbers, or the computation of difficult discrete logarithms.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176918">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176918">
						March 30, 2012 6:41 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>&#8230; you can also benefit similarly from one of the eSTREAM stream ciphers &#8230;</i></p>
<p>I need to sound a note of caution about stream ciphers.</p>
<p>As I noted earlier designing good block ciphers is quite difficult, well it&#8217;s more than doubly so with stream ciphers. Further stream ciphers don&#8217;t attract as much analytic interest either from the cryptanalysis or engineering fraternity as they deserve.</p>
<p>Which is odd because stream ciphers are at a high level viewpoint easier to attack because the stream generation process is effectivly independent of the text input unlike block ciphers.</p>
<p>At a slightly lower level all stream cipher generators can be seen as a state array that is updated in some fashion and the value of the state array is &#8220;mapped down to the output bit(s)&#8221;. That is you could envisage the state array proviiding the address inputs to a very large ROM and the data output bits from the ROM being the stream cipher output.</p>
<p>Thus in use the weak points of the stream generator are the contents of the ROM and the state array update mechanisum which is often linear in process. In fact without other input it can be easily show (by simple induction) that all stream update processes are simply equivalent to incrementing the state array in your chosen counting method (binary / decimal increment with carry, Chinese Clock counting, Grey code, etc etc). So the reality is the only weakness is the &#8220;mapping down&#8221; process of the ROM contents and how it protects the actuall value of the state array.</p>
<p>So as a rough rule of thumb when chaining different cipher types, only use stream ciphers on plaintext before a block cipher or after a block cipher that has flattened the statistics of the plain text to an acceptable level.</p>
<p>How ever I urge you to take a step back from block ciphers and actually view them not as a single process but as the combination of two seperate processes.</p>
<p>The first process being the key expansion process which takes in the &#8220;key&#8221; and expands it to the &#8220;round keys&#8221;, in effect it is exactly the same as a stream generation process but without the continuouse update.</p>
<p>The second process being the rounds process which usually takes the form of a stack of Fiestel rounds acting alternativly on half the input block.Each round takes as it&#8217;s inputs into it&#8217;s one way functions both plain text from the previous round and an output from the rounds key.</p>
<p>Thus you can see that in effect the Fiestel round is at it&#8217;s heart a stream cipher the only difference being it does not update the state array by a fully determanistic process but from the plaintext input.</p>
<p>With a little thought in that area you can see that you can replace the traditional XOR mixing function of a stream cipher with a Fiestel rounds stack that would offer you a significant advantage for minimal effort. Likewise you could replace a block cipher key expansion process with a stream cipher and by keep updating it.</p>
<p>You will after a little further thought realise that the &#8220;one way function&#8221; is just another &#8220;mapping down&#8221; process and that a Hash function is likewise a &#8220;mapping down&#8221; process.</p>
<p>Thus if you wished to you could use a hash function as a stream cipher or as part of a Fiestel round. You can also reverse the logic to realise that stream ciphers, block ciphers and hash functions can all stand in for each other with a little care and that you can leverage the strengths of each in a single &#8220;combined cipher&#8221;.</p>
<p>So&#8230;</p>
<p>You could take Salsa and clock it&#8217;s input into an array that provides the rounds keys as half the input to a hash function, which is standing in as the one way fuction in a Fiestal round, the other half of the input to the hash being the half of the plaintext from the previous round that also gets passed to the next round unmodified.</p>
<p>Now if you think about it you don&#8217;t actually need to clock the stream cipher into an array for all the rounds in one go but do it on the fly with each round. You could also if you wished to be a little more tricky actually swap the order that the stream output fills the individual round keys. So with say sixteen half rounds the round keys might start being in the same order out from the stream cipher for the first block encryption. But for the next encryption the order might be offset around by say the value of the last four bits of the plain text from the previous block&#8230;</p>
<p>Providing the underlying hash function is secure you are adding extra confusion to the process in a dynamic way that generaly only has advantages.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176919">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176919">
						March 30, 2012 7:12 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>I&#8217;m not educated on the topic enough to confirm my suspicion it&#8217;s pseudoscience or just false</i></p>
<p>I suspect you are but have become distracted by trying to work out why on earth any one would want a Quantum Neural Net, or use it for something as mundane as building a recognition filter driven by trying to determine the cognative signature of the entity providing it&#8217;s input.</p>
<p>Others have mentioned about the limitation of Turings Universal Computing Engine.</p>
<p>However have a look at the bit that talks about reversable logic and XOR gates. One form of reversable logic is known as Friedkin gates, the idea is you have one or more inputs to the gate and an output and providing you can push the output back into the output it will come back out of the input thus no information is destroyed and thus no energy used.</p>
<p>Now consider the XOR gate it can be viewed as a &#8220;controled inverter&#8221; as we know the invertion function is reversable wiithout issue so no information is lost. So provided you know the output and the state of the &#8220;control&#8221; input on the XOR gate no information is lost as the other input state can be fully determined (it&#8217;s this ability that makes it so usefull for cryptography ðŸ˜‰</p>
<p>Now it&#8217;s fairly well known that the XOR gate can be made of four NAND gates or their logical replacment (via DeMorgan) with OR gates and inverters (which can easily be made with a NAND or NOR gate).</p>
<p>However consider the problem with both the OR and AND gates even with the knowledge of one of the inputs and the output, can the state of the other input be correctly be determined all the time?</p>
<p>Well the answer is no, in the case of the OR gat it cannot be done when the known input is high. Likewise with the AND gate it cannot be done when the known input is low.</p>
<p>Finally have a think about how you would arrange XOR gates to make an AND, OR, NAND or NOR gate and what implication this migt have on a Turing Universal Computing engine (quantum or otherwise).</p>
<p>Oh speaking of Turing, thiÃŸsssssssss[truncated]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176920">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176920">
						April 1, 2012 6:26 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Assuming you hadn&#8217;t already lost me, my mind definitely went blank on this one:</p>
<p>&#8220;Oh speaking of Turing, thiÃŸssssssssss[truncated]&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176921">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176921">
						April 2, 2012 12:04 AM					</a>

				</p>

				<p>@Nick P:</p>
<p>Presumably, this is a Turing machine tape, with an alphabet of 5 symbols, but without knowing the machine&#8217;s programme, how can we interpret it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176922">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176922">
						April 2, 2012 12:10 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>Oh speaking of Turing thiÃŸssssssssssssssss</i></p>
<p>The Android phone I (still) use had taken a walk in the park again&#8230; and it took so long to recharge and re boot again I&#8217;d forgoton to check my post and give the usual appology.</p>
<p>The final sentence should have said,</p>
<p>Oh speaking of Turing this year will be the hundredth anniversary of his Birth in North West London.</p>
<p>As for the rest of my post, it has been said &#8220;you can paint a picture with a thousand words&#8221; (or some such ðŸ˜‰ but there are times when a few simple pictures or sketches would make it clear with just a few strokes of the pen&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176923">

			<div class="comment by-rrtucci ">

				<p class="commentcredit">

					<span class="commenter">rrtucci</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176923">
						April 2, 2012 4:08 PM					</a>

				</p>

				<p>Nobody reads these comments, but maybe chinese and american spies will:</p>
<p>China&#8217;s Muppet Communique</p>
<p><a href="http://qbnets.wordpress.com/2012/04/01/chinas-muppet-communique/" rel="nofollow ugc">http://qbnets.wordpress.com/2012/04/01/chinas-muppet-communique/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176924">

			<div class="comment by-jose ">

				<p class="commentcredit">

					<span class="commenter">JOSE</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176924">
						April 3, 2012 5:04 PM					</a>

				</p>

				<p>Oh my god, I will need to clean and making back to life my &#8220;OTP&#8221; one time pad encryption software !!!  Hell Can I enjoy some time, feeling that my data is secure against all the bad guys (Included NSA)? Please ignorance is one better bed to sleep&#8230;&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176925">

			<div class="comment by-jose ">

				<p class="commentcredit">

					<span class="commenter">JOSE</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176925">
						April 3, 2012 5:47 PM					</a>

				</p>

				<p>Now understood, why they launched SOPA/PIPA diabolic program !!!! They want to limit , the quantitye of data to store in the wallet !!!! Yeah !!!!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176927">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176927">
						April 4, 2012 9:34 AM					</a>

				</p>

				<p>@JOSE:</p>
<p>If your &#8220;one time pad encryption software&#8221; is some kind of stream cipher (almost every crypto-noob who claims to use OTP, has re-invented stream ciphers for the n-thousandth time) &#8230; then it is probably a lot less secure than AES.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176928">

			<div class="comment by-jose ">

				<p class="commentcredit">

					<span class="commenter">JOSE</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176928">
						April 5, 2012 6:49 PM					</a>

				</p>

				<p>Well MarkH thanks for your advice, but Im aware of the basic, need of the &#8220;Pads&#8221; minimal requisites to be considered secure, 20 years of experience in the matter&#8230;&#8230; I suggest you use same program, if you wants you privacy with you , all days&#8230;..  The best for you. And happy easter.</p>
<p>JOSE</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176929">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176929">
						April 6, 2012 6:36 AM					</a>

				</p>

				<p>@JOSE:</p>
<p>If &#8212; and only if &#8212; the &#8220;OTP software&#8221; (A) requires you to securely retain a key at least as large as the sum total of all encrypted data, and (B) uses a key, every bit of which is as random as the result of tossing a fair coin (for example, from a GOOD hardware true random generator), then it is really OTP.</p>
<p>If the key is smaller than the data, then <strong>it is not OTP</strong>.  It is a stream cipher.  There&#8217;s nothing inherently wrong with stream ciphers, some have been quite successful.  But anyone selling such software as &#8220;OTP&#8221; is either ignorant, or committing fraud.</p>
<p>But <b>OTP can never be broken by cryptanalysis</b> &#8212; it is absolutely impossible for anyone to decrypt the ciphertext without the key, or conversely to reconstruct any part key without already knowing the corresponding plaintext.  Further, knowing part of the key (say, 1000000000 bits of it) does not in any way help in guessing any other bit of the key.  But these properties only hold, for <i>true</i> OTP.</p>
<p>A stream cipher can be cryptanalyzed like any other cipher, and may be broken despite once having been thought to be secure &#8212; many of them have.</p>
<p>Though the principle involved here is simple, thousands upon thousands of people without proper cryptographic education repeat this same mistake.  I hope that Jose already knows this, but so many fall into this trap I like to &#8220;set the record straight.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176930">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176930">
						April 6, 2012 7:07 AM					</a>

				</p>

				<p>@ MarkH,</p>
<p>When you said,</p>
<p><i>But OTP <b>can never be broken by cryptanalysis</b></i></p>
<p>You forgot to add the very important rider of,</p>
<p><b>when used properly</b></p>
<p>Because if the keytext gets used twice it&#8217;s trivialy simple to find and recover both plaintexts.</p>
<p>Which is another reason OTP is usually considereed impractical for ordinary use (though it is still used for certain specialised applications).</p>
<p>There is a partial solution to the &#8220;accidental reuse&#8221; problem by using a more complex mode for mixing the plaintext and keytext to get the ciphertext, thus increasing the difficulty of finding the reuse and recovering the texts. However this breaks the rule of &#8220;simplicity&#8221; for hand ciphers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176931">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176931">
						April 6, 2012 8:48 AM					</a>

				</p>

				<p>@Clive:</p>
<p>Homo sapiens being the doltish species that we are, it is indeed necessary to explicate that &#8220;one time pad&#8221; does not mean &#8220;n time pad&#8221; such that n &gt; 1.</p>
<p>I still marvel that people capable of missing such concepts fancy themselves crypto inventors.  I have to assume that &#8220;sapiens&#8221; was applied with a dash of irony.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176932">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176932">
						April 6, 2012 11:47 AM					</a>

				</p>

				<p>@ Mark H,</p>
<p>Only a &#8220;dash&#8221; ðŸ™‚</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176933">

			<div class="comment by-kent-borg ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.borg.org' rel='external nofollow ugc' class='url'>Kent Borg</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176933">
						April 6, 2012 3:37 PM					</a>

				</p>

				<p>Maybe the NSA can break AES.  But if they can, it is a big secret.  And that constrains them.</p>
<p>What happens if they read the secrets in your AES encrypted e-mail?  They will tread carefully, maybe try to &#8220;discover&#8221; the same thing again, but by a less sensitive technique.  They won&#8217;t want to reveal how they found out.  For example, they won&#8217;t give the plaintext to your local police department, but if the discovery is big maybe they tip off police or FBI with something vague.</p>
<p>Think of it as a partial, and self-imposed, exclusionary rule.</p>
<p>-kb</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176934">

			<div class="comment by-sino ">

				<p class="commentcredit">

					<span class="commenter">Sino</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176934">
						April 10, 2012 9:55 PM					</a>

				</p>

				<p>Frankly I hate math, and I&#8217;m probably on the wrong board.  But I use encryption because I sometimes travel to countries where organized crime and government snooping is a big problem.  Inferred government keeps building bigger and bigger supercomputers.  We seem to be in race to build a bigger one.  Human nature being what it is, the key is in the un encrypted data somewhere that someone wrote down (stored digitally), as most of us can&#8217;t remember our keys.  hence, these large computers are just a more powerful method of making &#8216;sideways&#8217; attacks looking for random human slip ups.  The NSA is secure.  They really do keep their mouth shut.  Its the other government that worries me.  What if they talk because money talks where they live.  Then someone in the criminal network has access to some of the world&#8217;s most powerful computers to search for all of those slip ups that people make.  Well, for now, they haven&#8217;t.  They are still using what you all would consider primitive, such as spoofing an email address so that some low level clerk reads it and lets them into the network.  But what if they get access to that (those) government super computers to run quantum level attacks? No, i never ventured anywhere near the physics labs. I meant gargantuan spoofing attacks.  And what if inferred government &#8216;sublets&#8217; its government hacking out to organized crime to cover its tracks?  And what if black becomes gray and the &#8216;black contractors&#8217; decide to make a little money on the side using those supercomputers for crime while they are hacking government computers?  I may not know much math.  It hasn&#8217;t happened, YET.  But sooner or later inferred government computers will be used for a giant bank heist on a level never seen before (again using all of that computing power to find some sloppy bank CEO who doesn&#8217;t like math either), leaving them very red faced.  Could that happen?  I may not know much math.  But  I can ask questions&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176936">

			<div class="comment by-cendo ">

				<p class="commentcredit">

					<span class="commenter">Cendo</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176936">
						April 16, 2012 5:21 PM					</a>

				</p>

				<p>I&#8217;ve programmed AES several times, like many others and evrebody knows, it&#8217;s impossible to break it. Math rules are invariable. You can still make own app to map bits on matrix,and move rows  or columns randomly, while you are only who knows right moves. There&#8217;s not algorhytm to arrange randomly mixed matrix. However, there&#8217;s still roundkey, wich makes it much more impossible ðŸ˜‰</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176937">

			<div class="comment by-trial ">

				<p class="commentcredit">

					<span class="commenter">Trial</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176937">
						April 24, 2012 11:35 AM					</a>

				</p>

				<p>If this whole talk of quantum computing starts to actually work in the next 10yrs it seems all these hash algorithms would be rendered useless.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176938">

			<div class="comment by-john-smythe ">

				<p class="commentcredit">

					<span class="commenter">John Smythe</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176938">
						July 15, 2012 7:55 PM					</a>

				</p>

				<p>So I guess all this means is that if I send an encrypted message to a friend asking if he wants the latest Playboy centerfold I have scanned or he wants a free copy of my ringtone, it will not be worth the G&#8217;s time, effort, and money to try and decipher my message.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176939">

			<div class="comment by-man-from-zurich ">

				<p class="commentcredit">

					<span class="commenter">Man from Zurich</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176939">
						August 21, 2012 6:15 AM					</a>

				</p>

				<p>What about this?<br />
<a href="http://en.wikipedia.org/wiki/TWIRL" rel="nofollow ugc">http://en.wikipedia.org/wiki/TWIRL</a></p>
<p>&#8220;TWIRL is still a hypothetical device &#8211; it has not yet been built. However, its designers, Adi Shamir and Eran Tromer, estimate that if TWIRL were built, it would be able to factor 1024-bit numbers in one year at the cost of &#8220;a few dozen million US dollars&#8221;. TWIRL could therefore have enormous repercussions in cryptography and computer security &#8211; many high-security systems still use 1024-bit RSA keys, which TWIRL would be able to break in a reasonable amount of time and for reasonable costs&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176940">

			<div class="comment by-fritz-sugarmountain ">

				<p class="commentcredit">

					<span class="commenter">Fritz Sugarmountain</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176940">
						August 21, 2012 11:59 AM					</a>

				</p>

				<p>Re the problem of &#8216;true&#8217; random number generation.<br />
Why not: &#8220;please hold your watch close to the radioactive-decay counter for at least 1 second&#8221; ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176941">

			<div class="comment by-james-yang ">

				<p class="commentcredit">

					<span class="commenter">james yang</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176941">
						September 24, 2012 3:02 AM					</a>

				</p>

				<p>we could have 2 level of sercurity 1. on password  , and 2nd on token + finger</p>
<p>2, the user needs to have the password to verify the user and the token + finger print to continue access it should be hard problem for a attacker</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176942">

			<div class="comment by-theregoesmydata ">

				<p class="commentcredit">

					<span class="commenter">ThereGoesMyData</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176942">
						November 12, 2012 10:45 PM					</a>

				</p>

				<p>Follow NSA&#8217;s money and what do you see?</p>
<p>Large investment.<br />
Highly restricted communication.<br />
Lots of smoke.<br />
Events prior to the event (slicing into 20+ telecoms, etc).</p>
<p>It means they have already discovered something really significant in their research lab and this is the roll out. Otherwise, money for a new mega facility would not have been justified.</p>
<p>This new development is not a fishing expedition to figure out how to do something. Labs are good enough to demonstrate capabilities and they already have labs.</p>
<p>In this case, they have likely hooked the big one and they intend to land it, or likely already have. The Jaguar was sitting there and they were playing around with it and they hit on something big.</p>
<p>They most likely have a proven way to access data hiding behind AES256 and everything thing beneath that. Likely not a brute force attack &#8211; another way &#8211; perhaps they found a weakness in AES, or not a weakness, but a back door designed from the beginning into AES by the designers.</p>
<p>Due to AES&#8217;s scrutiny, it is more likely a back door than a weakness. It is also more likely the NSA found it out by low tech means. Spying on the AES developers who, one careless day, used the backdoor they made and NSA followed them through it (by one of the myriad of ways already mentioned above).</p>
<p>&#8220;Bingo! We are in!&#8221;</p>
<p>Not hard to imagine or do in either case. Otherwise, why so secret, what justifies such a facility and such secrecy? Why report anything to a select few in Congress unless you actually have something worth reporting? And why approach Congress in the first place unless you need additional undisclosed funding for capitalizing on the new development or breakthrough?</p>
<p>What would it sound like?</p>
<p>&#8220;Dear Chairman, AES is compromised. We caught the developers using an undisclosed backdoor and now we also have unlimited access to every AES encrypted file we have ever collected and will ever collect. So we will monitor/persuade those two to make sure they keep it to themselves. In the meantime we need $XXX billion to make an intel factory to process and analyze all this data. This is the turning point in history for US Intel. We will continue promoting AES until we discover that the backdoor exploit has proliferated beyond the developers. So far, so good. To play it safe we will advise the most critical govt data that is using AES be shifted off of AES without public notice, or a modified version/application of AES sans the backdoor (at least, THAT backdoor) be implemented selectively by us for approved govt depts only. Oh, and this is actually how we caught Osama, but please don&#8217;t tell anyone or we will have to, ahem.&#8221;</p>
<p>Life basically goes on. They got their money, they built their factory and now everyone who thinks their data is safe, is basically living in the illusion of AES security &#8211; just the way the NSA likes them to live.</p>
<p>The very existence of the giant facility means it is a done deal, not a speculative venture to explore a hunch or theory. That&#8217;s my speculative hunch of a theory, at least.</p>
<p>On another note, I caught TrueCrypt taking a screen shot just after entering my password at the time of volume creation after clicking to create the volume. I had a really good anti-spy ware running that blocks and alerts you of all such things (key loggers, screen shots, etc). Then I see that the State Dept is a MAJOR donor, amongst other govt depts, of Truecrypt. The Aha moment.</p>
<p>Seems clear that Truecrypt takes a picture of the password/key/etc at the screen shot and either stores it out of sight as a type of forensics fingerprint that can be retrieved by the State Dept or any govt agency that wants to access your &#8220;protected&#8221; data when required?</p>
<p>Also, when you use three methods to encrypt your data (AES, TWOFISH, SERPENT, etc) it would seem that this would make your data stand out from the pack of other AES data and perhaps expose vulnerabilities that can be directly traced to your Truecrypt implementation? If I know immediately that your email comes from x.ip.999.99, then I backorafice your system into your Truecrypt application and download the 10kb gif files stored there to know every password and volume you ever created on each date via Truecrypt. Here is an old Japanese truism that always seems to hold true,</p>
<p>&#8220;The free gift is the most expensive.&#8221;</p>
<p>It seems that unless we have the capacity to &#8220;roll our own&#8221; in terms of creating our own implementations of encryption using our own ciphers (something like Google did with the android app inventor that allows even kids to make an app that works), that we will never have truely safe data, least so by depending on publicly available implementations that the govt approves of and supports financially. Looks like everything out there comes with a trojan back door.</p>
<p>What is the most cost-effective means of empowering the public to implement a truly safe &#8220;home made&#8221; cipher? It seems any tool you supply them will have the inherent risk of trojans, back doors, weak RNG, etc. Is there a fool-proof way an average Joe can remain an anonymous Jon without studying the craft?</p>
<p>The upcoming issue now seems to be the security of our brain. If they can reproduce a film you just watched by tapping your brain (and they have done it apparently), then they can tap your brain to get your password a lot easier than a brute force attack on AES. How do we secure our brains and thoughts from the thought police?</p>
<p>I know, that&#8217;s another discussion board.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176943">

			<div class="comment by-x ">

				<p class="commentcredit">

					<span class="commenter">x</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176943">
						December 3, 2012 8:16 AM					</a>

				</p>

				<p>@ThereGoesMyData</p>
<p>Your post is embarrassing. This applies to everything you say about the security of AES. But let&#8217;s instead look at this quote, which anyone who ever wrote even one line of code can understand:</p>
<p>&#8220;On another note, I caught TrueCrypt taking a screen shot just after entering my password at the time of volume creation after clicking to create the volume. [&#8230;] Then I see that the State Dept is a MAJOR donor, amongst other govt depts, of Truecrypt. The Aha moment.&#8221;</p>
<p>So TrueCrypt stores a screenshot of its own user interface to do what exactly? If it wanted to store the password it could do so.</p>
<p>Ridiculous claims.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176945">

			<div class="comment by-sean ">

				<p class="commentcredit">

					<span class="commenter">Sean</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176945">
						June 19, 2013 2:40 AM					</a>

				</p>

				<p>The Russians use elleptic-curve encryption for the asymmetric key exchange.</p>
<p>I won&#8217;t waste words but Shor&#8217;s Algorithm AND the Riemann hypothesis. Examine second to see how a short-cut is possible and know that billions are being poured into the former.</p>
<p>If you want total security, meet &amp; share 1-time pad. Even side-channel attacks have been successful to  break &#8216;quantum cryptography&#8217;!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176946">

			<div class="comment by-bruce-s ">

				<p class="commentcredit">

					<span class="commenter">Bruce S.</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176946">
						July 3, 2013 3:48 PM					</a>

				</p>

				<p>This is the energyscholar referred to above.  Yes, I posted that on Schneier dot com.  I was just googling myself and found this year-old conversation where I was quoted.</p>
<p>Mark H correctly pointed out that my pedagogy was poor.  I&#8217;ve been working on that, and on trying to find the right words to explain some very difficult technical stuff.  I consider myself a scientific journalist.</p>
<p>I liked this quote from Joao:</p>
<blockquote><p> &#8220;So having a Quantum Computing dedicated to break at least asymmetric algorithms like RSA/ DSA / EC, is almost sure! Don&#8217;t forget that for years they (NSA) where doing everything to stop PGP&#8230; and from one day to another they stop worrying&#8230; I would that be? Couldn&#8217;t be just some weakness in implementation, because those would be caught over time, has many have, having computer power to break RSA/ DSA/ EC is much easy to believe&#8230; since would be the only thing that would give some assurance that they could still surveillance everybody else, like it&#8217;s their job to do. &#8220;</p></blockquote>
<p>Joao astutely observes how the NSA suddenly stopped opposing the spread of strong cryptography circa 1996.  Note how that fits the timeline in my link, below.</p>
<p>Finally, I&#8217;d like to comment on Sean&#8217;s recent quote:</p>
<blockquote><p>&#8220;The Russians use elleptic-curve encryption for the asymmetric key exchange.</p>
<p>I won&#8217;t waste words but Shor&#8217;s Algorithm AND the Riemann hypothesis. Examine second to see how a short-cut is possible and know that billions are being poured into the former.&#8221;</p></blockquote>
<p>Sean, you have it.  I wasn&#8217;t aware that the Russians now use elliptic curve cryptography, but I&#8217;m not surprised.  Elliptic curve cryptography is not vulnerable to analysis by QC.  Sean also correctly put his finger on the Riemann hypothesis, in this context.  &#8220;A new form mathematics of zero&#8221; or why &#8220;zero is not always zero&#8221;.</p>
<p>Here&#8217;s a link to an open discussion about my thesis on this topic:  <a href="http://tinyurl.com/ayl93p6" rel="nofollow ugc">http://tinyurl.com/ayl93p6</a>  (skepticfriends.org, a website for scientific skeptics)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176947">

			<div class="comment by-bruce-step ">

				<p class="commentcredit">

					<span class="commenter">Bruce Step ...</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176947">
						July 3, 2013 4:56 PM					</a>

				</p>

				<p>Ooooops.  I realized I posted that last message as &#8216;Bruce S.&#8217;, which could easily be mistaken for &#8216;Bruce Schneier&#8217;, whose blog this is.  I am not he.  I happen to have the same initials and the same first name.</p>
<ul>
<li>energyscholar </li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176948">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176948">
						July 4, 2013 12:23 AM					</a>

				</p>

				<p>@ &#8220;Bruce Step&#8221;, previously &#8220;Bruce S.&#8221; (ha&#8230;)</p>
<p>&#8220;So having a Quantum Computing dedicated to break at least asymmetric algorithms like RSA/ DSA / EC, is almost sure! &#8221;</p>
<p>Unlikely. If this was the case, they wouldn&#8217;t have had so many hard times cracking opponents&#8217; messages well into the 21st century. Additionally, as I said before, these machines would likely be quite limited and they&#8217;d batch jobs onto them. You&#8217;d have to be pretty important to worry.</p>
<p>&#8220;Don&#8217;t forget that for years they (NSA) where doing everything to stop PGP&#8221;</p>
<p>The US government in general was. Between DJB and Zimmerman, enough clever legal strategy was used to get them to chill out on the crypto wars quite a bit. NSA wasn&#8217;t invincible by far. Zimmerman putting the source code on paper and getting it approved was clever. The Bernstein case had the software declared protected under Free Speech, throwing out their export regulations. These cases, along with other firepower, allowed the people to win the Crypto Wars.</p>
<p>NSA went home crying about being beaten, swearing it wouldn&#8217;t happen again, and&#8230; here we are with a massive NSA surveillance system. Darn. Least we have tools they wanted to ban for both secure and anonymous communications. Tools and techniques. <b>NSA didn&#8217;t stop caring due to some hypothetical breakthrough: the people on the side of freedom worked hard and risked their future to kick NSA&#8217;s a**. And kick it they did.</b></p>
<p>Besides, if anyone is <em>that</em> worried about public key crypto&#8230; ignoring all the other vulnerabilities NSA would use&#8230; then there&#8217;s many schemes available for protected communications without public key cryptography that simply stretch practical and usable limits. Without ever using or worrying about quantum tech. I&#8217;ve used one or two of these methods in the past.</p>
<p>@ MarkH</p>
<p>&#8220;Oh speaking of Turing, thiÃŸssssssssss[truncated]&#8221; (Clive)</p>
<p>&#8220;Presumably, this is a Turing machine tape, with an alphabet of 5 symbols, but without knowing the machine&#8217;s programme, how can we interpret it?&#8221; (MarkH)</p>
<p>LMAO. Had I remembered to check this thread for comments, I&#8217;d have suggested running it through a random, human oracle: Clive.</p>
<p>@ Clive Robinson</p>
<p>Most applicable part of your post</p>
<p>&#8220;So as a rough rule of thumb when chaining different cipher types, only use stream ciphers on plaintext before a block cipher or after a block cipher that has flattened the statistics of the plain text to an acceptable level.&#8221;</p>
<p>Good to know. I had been applying stream ciphers before the block ciphers due to worries about patterns and padding affecting security. (Preempted a SSL/TLS issue, did I? wink). The stream cipher would at least randomize the data stream before it was fed into the block cipher as an extra layer against analysis. It was also fast. I used to use RC4 [carefully] or a block cipher in Counter mode in the past. Now, I use AES (for hardware acceleration) in a counter variant or Salsa depending on the situation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176949">

			<div class="comment by-bruce-stephenson ">

				<p class="commentcredit">

					<span class="commenter">Bruce Stephenson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176949">
						July 7, 2013 11:44 AM					</a>

				</p>

				<p>@Nick P</p>
<blockquote><p>&#8220;These cases, along with other firepower, allowed the people to win the Crypto Wars.&#8221;  </p></blockquote>
<p>That was my original interpretation of these events, too, for the first decade after they occurred.  In retrospect, though, perhaps the IC gave up too easily.  If the NSA did have a tool for cracking PKK, they would want to <i>convey the impression</i> of reluctant defeat.  Spies are clever that way.  Did you read my proposed timetable, particularly just before</p>
<blockquote><p>1996 &#8211; President Bill Clinton signs the Executive order 13026, which relaxes USA rules on exporting strong encryption.</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176950">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176950">
						July 7, 2013 1:01 PM					</a>

				</p>

				<p>@ Bruce Stephenson re can NSA break AES and other stuff?</p>
<p>I see &#8216;B S&#8217; is the only common theme in your names. Is that an embedded joke about the worth of identities, a pun on Bruce Schneier, or both? ðŸ˜‰</p>
<p>&#8220;1996 &#8211; President Bill Clinton signs the Executive order 13026, which relaxes USA rules on exporting strong encryption.&#8221;</p>
<p>You&#8217;re confusing possibilities with probabilities. It&#8217;s a possibility that the NSA is playing a spy mind trick on people. It&#8217;s doesn&#8217;t become a believable theory, probability or anything else worthwhile until it&#8217;s corroborated by evidence. Right now, all evidence we have pushes in the opposite direction. Here&#8217;s some points for you or other readers to consider.</p>
<ol>
<li>NSA went to great lengths to restrict or subvert strong crypto mostly likely b/c they couldn&#8217;t break it. (And they testified to that to their Congressional overlords.)</li>
<li>NSA was an ineffective and horribly managed organization despite many brilliant technicians. Bamford&#8217;s books and Hayden&#8217;s transforming actions as director tell us this.</li>
<li>NSA&#8217;s goals in that time period were hampered by Congress and courts that favored the people a <em>little</em> bit more than today&#8217;s politicos.</li>
<li>NSA&#8217;s enemies had superior legal strategy in federal courts. The free speech strategy is a good example. US govt was loosing court battles left and right.</li>
</ol>
<p>And the big one:</p>
<ol>
<li>NSA&#8217;s enemies were also masters of the Internet, which NSA still didn&#8217;t quite understand, and would advance the strong crypto to others via the Internet. And would do so NO MATTER WHAT NSA DID. (Maybe minus murdering all of them. The continued existence of people like Zimmerman &amp; DJB shows IC isn&#8217;t as quick to black bag people as some claim, eh?)</li>
</ol>
<p>5.1 One of my own I haven&#8217;t seen anyone mention. NSA can&#8217;t manage the spread of something that&#8217;s totally underground. Criminalization creates the underground market for crypto. Decriminalization leads people do do everything in the open (or close to it). Voluntary regulation, with promised commercial benefits, (aka FIPS 140-2 and Common Criteria) means they can have some influence over crypto. They might have considered this benefit.</p>
<p>Conclusion</p>
<p>So, we have a domestically ineffective organization mostly focusing on legal battles to stop spread of strong crypto&#8230; whose opponents hand their ass to them in court, in State Dept reg loopholes, on BBS&#8217;s, and on the Internet. The strong crypto spreads internationally and paranoid people start using it plenty. This is <b>already enough</b> to explain the NSA giving up: the whole goal of their war was already lost. Then, people can add claim 5.1 and bring up things like timing channels &amp; possible ECC backdoors if they want a more sinister possibility. ðŸ˜‰</p>
<p>There&#8217;s simply no need for &#8220;NSA secretly outsmarted everyone&#8221; to explain the events. There&#8217;s also no evidence of to support they can break that stuff. There&#8217;s plenty of evidence to support the hypothesis that they failed to stop the spread of crypto they couldn&#8217;t break. So NSA can&#8217;t break AES. And if they can break public key, we&#8217;ve never seen signs of it. And they probably wouldn&#8217;t spend so much time trying to get 0-days and rootkits in enemy computers if they could crack the crypto they&#8217;re using. Cracking crypto would be stealthier. Just another supporting point that NSA can&#8217;t break it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176951">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176951">
						July 8, 2013 7:20 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Whilst I doubt the NSA can currently break RSA PK, with sufficient entropy in the primes, I can see plenty of evidence they could break PK where the primes have been selected by a poorly implemented RNG with fairly low entropy.</p>
<p>Bu let us assume for the moment they can break RSA PK by some mathmatical short cut. Would we actually get to see evidence of this?</p>
<p>Possibly not if you think back to Churchill&#8217;s &#8220;geese that lay golden eggs&#8221;. He was so worried that the &#8220;Ultra Secret&#8221; would become known to the Germans that he placed some fairly stringent rules on the use of the inteligence gained.</p>
<p>If you can get access to the UK National Archives (at Kew near Richmond in North Surrey / West London) you will find a fair amount of &#8220;complaints&#8221; that America was taking far to a caviler approach to Ultra intel on U-Boats in waters covered by American Forces.</p>
<p>It got to the point where the UK-USA &#8220;Special Relationship&#8221; was nearly scuppered before it got started as BRUSA and it&#8217;s changes to what we see today.</p>
<p>I suspect this historical lesson was not lost on those at NSA HQ and might account for some of the odd behaviour that happened long prior to 9/11 (for instance the obvious lies about DES and using custom hardware and PC clusters to crack it in short order).</p>
<p>The problem is as I&#8217;ve said befor about forensics we are arguing from visable effect to a guess on potential cause which means that we are taking the non-scientific or Aristotle route to argue the case.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176952">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176952">
						August 25, 2013 6:01 AM					</a>

				</p>

				<p>All I know is Obama can&#8217;t decrypt a Denny&#8217;s menu and the way the economy is going under him the NSA is probably using 5 year old emachines.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176953">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://na' rel='external nofollow ugc' class='url'>Mike</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176953">
						September 5, 2013 3:46 PM					</a>

				</p>

				<p>Just read your excellent article in the The Guardian Bruce.  Keep up the good work, we&#8217;re all with you on this! I think the Open Source community needs to come together on this one!<br />
<a href="http://www.theguardian.com/commentisfree/2013/sep/05/government-betrayed-internet-nsa-spying/print" rel="nofollow ugc">http://www.theguardian.com/commentisfree/2013/sep/05/government-betrayed-internet-nsa-spying/print</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176954">

			<div class="comment by-stephen-braithwaite ">

				<p class="commentcredit">

					<span class="commenter">Stephen Braithwaite</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176954">
						September 14, 2013 8:20 PM					</a>

				</p>

				<p>@ Thin King â€¢ March 22, 2012 8:48 AM</p>
<p>The history of DES, well known to many posters here pretty much breaks your argument.  Here is my summary:-</p>
<p>In the 70s, 80s and 90s, the encryption technology used was called the Data Encryption Standard (DES).  IBMâ€™s proposed algorithm in 1975 originally used a 128 bit key, but the U.S. National Security Agency (NSA) convinced IBM to reduce the key size to 56 bits.  The US government allowed only a 40 bit key version of the encryption to be exported. It is thought that the NSAâ€™s reason was to allow an easier brute force attack, possibly by means of specially crafted electronic hardware.</p>
<p>The NSA and the US Justice Department insisted that DES was unbreak- able even as late as 1997. The Electronic Frontier Foundation (EFF), however, believed that the 56 bit key version of the algorithm could be rapidly cracked, but saying so earned them the tag of â€œconspiracy theoristsâ€.  To prove their point the EFF started to design their own DES cracking hardware in 1997.  The EFF completed the DES cracker in July 1998 at a cost of cost of $250,000.oo.</p>
<p>â€œThe news is not that a DES cracker can be built; weâ€™ve known that for years,â€ said Bruce Schneier, the creator of Blowfish and President of Counterpane Systems. â€œThe news is that it can be built cheaply using off-the-shelf technology and minimal engineering, even though the department of Justice and the FBI have been denying that this was possibleâ€.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176955">

			<div class="comment by-nathanael ">

				<p class="commentcredit">

					<span class="commenter">Nathanael</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176955">
						September 19, 2013 12:23 PM					</a>

				</p>

				<p>Let&#8217;s just go ahead and switch to RSA-4096.  It&#8217;s unlikely that the NSA has a proper mathematical breakthrough (the pay would be better for revealing it).  Which means they&#8217;re essentially brute-forcing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176956">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176956">
						November 3, 2013 9:03 AM					</a>

				</p>

				<p>Makes one remember the past&#8230;</p>
<p>&#8220;We have one criticism of AES: we don&#8217;t quite trust the securityâ€¦ What concerns us the most about AES is its simple algebraic structureâ€¦ No other block cipher we know of has such a simple algebraic representation. We have no idea whether this leads to an attack or not, but not knowing is reason enough to be skeptical about the use of AES.&#8221; (Bruce Schneier and Niels Ferguson, Practical Cryptography, 2003, pages 56â€“57)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176957">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176957">
						December 29, 2013 2:10 AM					</a>

				</p>

				<p>word is NSA bribed RSA for a backdoor.</p>
<p>But then RSA is a company.</p>
<p>AES wasn&#8217;t made by a company so no one can be bought.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176958">

			<div class="comment by-kandi-klover ">

				<p class="commentcredit">

					<span class="commenter">Kandi Klover</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176958">
						March 4, 2014 7:00 AM					</a>

				</p>

				<p>Yeah load of shit they aint getting no aes256</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176960">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176960">
						July 3, 2014 3:20 AM					</a>

				</p>

				<p>Why did the NSA have to reiterate multiple times that they &#8220;don&#8217;t have the capability in the United States&#8221; ? Does it mean they have it elsewhere?&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176961">

			<div class="comment by-adrian ">

				<p class="commentcredit">

					<span class="commenter">Adrian</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176961">
						February 28, 2015 5:50 PM					</a>

				</p>

				<p>Let&#8217;s take the simple ceaser&#8217;s cypher.<br />
Sure, we can write a program that can run through all the possible solutions of a simple substitution cypher in a millisecond.<br />
At the end of the day though, the machine has no way of knowing when it has found the right substitution, it is down to a human operator.<br />
Modern day cryptography is hundreds of orders of magnitudes harder, meaning they still have to trawl through hundreds of trillions of billions of rubbish to get to the plaintext, Even if, they had the technology to brute force it (say quantum computers).<br />
Currently the problem appears to be for then (and us) not having the computing power to brute force the possibilities, if they manage that, their next problem must be sorting the Trillions of tons of chaff for that single piece of wheat that is the original plaintext.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176962">

			<div class="comment by-a-large-tree ">

				<p class="commentcredit">

					<span class="commenter">A Large Tree</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176962">
						April 13, 2015 3:42 PM					</a>

				</p>

				<p>Dave, it would seem they have that capability in another dimension thanks to Vesuvius.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176963">

			<div class="comment by-hmmmmm ">

				<p class="commentcredit">

					<span class="commenter">hmmmmm</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176963">
						April 8, 2016 4:46 PM					</a>

				</p>

				<p>well, i assume they can break it or somehow bypass it. since they are the ones using the cypher, they will not use anything they can&#8217;t break. let me explain this point of view. i use a lock in the door that needs a key. lets say the door and walls are very strong and the key is ok, but i can open the door without the actual key. i can pick a lock with a toothpick, if i lose the key or if it was changed. if that lock is too good and you can&#8217;t open it with a toothpick then it is a very very bad situation, if someone else steals that key or changes the key and ,here you go, you cant pick a lock, you cant break the walls, how do you get in? just like fbi and iphone problem(eventually they got in). so nsa tactics is promoting a breakable technology so that normal person would not be able to break but they would have all tools necessary to do so. that is why windows has a backdoor for nsa. just in case a bad man locks their data. or if a human being forgets a password, they would still be able to get in. so anyway these guys will not use anything unbreakable. but even if they know how, they wont tell you. because: 1 &#8211; if you know its possible to break it, you will also try to break it; 2- if you know it is possible to break it, you wont use it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176964">

			<div class="comment by-conundrum1885 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://gchq,gov' rel='external nofollow ugc' class='url'>Conundrum1885</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176964">
						September 4, 2016 4:26 AM					</a>

				</p>

				<p>I came up with a way to break AES in 2014 but lacked the equipment to test it at the time.<br />
Thanks to some very generous donations it might now be possible to crack AES-256 (ie used on some older devices to protect the content) which by extension would break a certain cloudy password issue.<br />
Its actually quite simple if you use the right hardware, reducing the time needed to around 3 months per key but the catch it it only works on that one machine so it is tied up for the entire time.<br />
Interestingly being able to know even a single photo or file on the original chip reduces the problem complexity by an order of magnitude so this should help the Zepto/Locky/C-L folks get their files back sooner.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-176965">

			<div class="comment by-gordon ">

				<p class="commentcredit">

					<span class="commenter">Gordon</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176965">
						December 20, 2017 1:21 PM					</a>

				</p>

				<p>&#8220;One hand lies, one tells the trurh.&#8221;</p>
<p>More likely this number crunching power is used to provide context driven profiles about the messenger and place limits on what is likely to be discussed.</p>
<p>Why crack it when you don&#8217;t need to do ao?</p>
<p>The CIA hired a lot of smart social scientists for good reasons. The HUMINT data that can be read is more valuable now than ever, especially when combined with language analysis, going back to Timothy Leary&#8217;s speech research.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-176966">

			<div class="comment by- ">

				<p class="commentcredit">

					<span class="commenter">-</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/#comment-176966">
						February 21, 2020 6:27 AM					</a>

				</p>

				<p>@ Moderator,</p>
<p>The above from &#8220;Ron de Jong&#8221; is unsolicited service advertising.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/03/can_the_nsa_bre.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/03/can_the_nsa_bre.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F03%2Fcan_the_nsa_bre.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/03/can_the_nsa_bre.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4280' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/03/another_liars_a.html" rel="prev">â† Another <i>Liars and Outliers</i> Excerpt</a>		<a href="https://www.schneier.com/blog/archives/2012/03/the_economist_d.html" rel="next"><i>The Economist</i> Debate on Airplane Security â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
