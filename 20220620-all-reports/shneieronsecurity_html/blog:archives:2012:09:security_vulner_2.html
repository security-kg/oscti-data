<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Security Vulnerability in Windows 8 Unified Extensible Firmware Interface (UEFI) - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Security Vulnerability in Windows 8 Unified Extensible Firmware Interface (UEFI) Comments Feed" href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4518" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4518' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F09%2Fsecurity_vulner_2.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F09%2Fsecurity_vulner_2.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4518 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4518" class="post-4518 post type-post status-publish format-standard hentry category-uncategorized tag-malware tag-operating-systems tag-rootkits tag-windows">

	<div class="article">

		<h2 class="entry">Security Vulnerability in Windows 8 Unified Extensible Firmware Interface (UEFI)</h2>
		<p>This is the <a href="http://www.theregister.co.uk/2012/09/19/win8_rootkit/">first one</a> discovered, I think.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/rootkits/" rel="tag">rootkits</a>, <a href="https://www.schneier.com/tag/windows/" rel="tag">Windows</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html" rel="bookmark">Posted on September 24, 2012 at 1:09 PM</a>			‚Ä¢
			<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html#comments">25 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html" data-title="Security Vulnerability in Windows 8 Unified Extensible Firmware Interface (UEFI)" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-186424">

			<div class="comment by-ryan-ries ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.myotherpcisacloud.com' rel='external nofollow ugc' class='url'>Ryan Ries</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186424">
						September 24, 2012 1:31 PM					</a>

				</p>

				<p>So the article seems to imply that turning on SecureBoot can prevent this sort of attack.</p>
<p>But when we thought we wouldn&#8217;t be able to turn off SecureBoot at first, all the Linux people cried foul.</p>
<p>Just can&#8217;t win&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186425">

			<div class="comment by-nicolai ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://Nicolaiblog.blogspot.com' rel='external nofollow ugc' class='url'>Nicolai</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186425">
						September 24, 2012 2:02 PM					</a>

				</p>

				<p>As I understand the attack, then it basically turn UEFI (SafeBoot) off. (So it&#8217;s not really an attack against UEFI, more like a side-channel attack).</p>
<p>You could defend against it by forcing SafeBoot on, but then Win8 wouldn&#8217;t be able to run on a lot of old computers ( + a certified Win8 computer wouldn&#8217;t be able to run Linux).</p>
<p>However, because MS demand that a computer need to support UEFI to become &#8220;Win8 Certified&#8221;, then we might see a Win9 that requires SafeBoot (which makes this attack useless).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186426">

			<div class="comment by-mark-tinberg ">

				<p class="commentcredit">

					<span class="commenter">Mark Tinberg</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186426">
						September 24, 2012 2:15 PM					</a>

				</p>

				<p>I think there is a misunderstanding here, this looks like the exact kind of bootkit that Secure Boot was designed to prevent and that it does prevent it.  The bootkit attacks the kernel by disabling module signature checking as the firmware loads the kernel image off disk.  Presumably later in the boot process is a kernel module which loads and hides the bootkit and all evidence of its activity.</p>
<p>This attack was previously demonstrated against Mac OS X as well.  Presumably it would also work against any OS.</p>
<p>Win8 certified hardware is required to have Secure Boot enabled by default although it is also required to allow Secure Boot to be disabled and to enroll new keys.  This is needed to be able to boot older OSs like Win7 on Win8 certified hardware.</p>
<p>Linux shouldn&#8217;t be affected at this time because you can disable or enroll keys on Win8 hardare and the major vendors are getting bootloaders signed by Microsoft so that they work out of the box without any fiddling.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186427">

			<div class="comment by-matthias-urlichs ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://matthias.urlichs.de' rel='external nofollow ugc' class='url'>Matthias Urlichs</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186427">
						September 24, 2012 2:32 PM					</a>

				</p>

				<p>What Mark said.</p>
<p>It&#8217;d be a major feat if that attack worked on a computer that had Secure Boot turned on (and by &#8220;work&#8221; I mean &#8220;the user doesn&#8217;t realize anything is wrong, even after rebooting&#8221;). But unless the thing also manages to turn SB off (or they got their rogue bootloader signed my Microsoft), this is a load of hot air.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186428">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186428">
						September 24, 2012 2:33 PM					</a>

				</p>

				<p>So, we didn&#8217;t trust UEFI for security or DRM-related issues. Now, it&#8217;s proven to be untrustworthy. The closest commercial offerings to the kind of trusted boot I advocate are Chromebook Verified Boot &amp; uLoad.</p>
<p>Chromebook verified boot<br />
<a href="http://chrome.blogspot.com/2011/07/chromebook-security-browsing-more.html" rel="nofollow ugc">http://chrome.blogspot.com/2011/07/chromebook-security-browsing-more.html</a></p>
<p>Cypherbridge uLoad<br />
<a href="http://www.phaedsys.org/principals/cypherbridge/cypherbridgeuloadsecureloader.html" rel="nofollow ugc">http://www.phaedsys.org/principals/cypherbridge/cypherbridgeuloadsecureloader.html</a></p>
<p>I find it easier to get verification correct if most effort is put into a ROM-based, TCB loader &amp; verifier. That way, if the rest turns out vulnerable, you can replace it with plenty of assurance without a recall. This would need careful consideration and wargaming of the various pieces of hardware on the system. Fail-safes like uLoad&#8217;s should exist to keep it from failing into an insecure state.</p>
<p>Additionally, I think there should be an easy (and CHEAP) way of replacing the public key used for verification. There are a few ways to do this. One is to put it in the writable flash, authenticated via TPM or firmware/microcode. Another is to get one&#8217;s own verifying bootloader signed by the manufacturer, then it loads &amp; can load arbitrary user-signed programs. Any system where the manufacturer has sole control over what runs is a slippery slope.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186429">

			<div class="comment by-phred14 ">

				<p class="commentcredit">

					<span class="commenter">phred14</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186429">
						September 24, 2012 2:46 PM					</a>

				</p>

				<p>My impression is that this IS something new.  I have been under the impression that if Secure Boot is enabled and you boot Windows 8 or other properly done Secure Boot OS, your system will be secure.  If you do not have Secure Boot enabled, at the very least Windows 8 will not boot.</p>
<p>Therefore one could argue that Windows 8 will ONLY boot securely.  This article seems to contradict that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186430">

			<div class="comment by-matthew-garrett ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mjg59.dreamwidth.org' rel='external nofollow ugc' class='url'>Matthew Garrett</a></span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186430">
						September 24, 2012 2:49 PM					</a>

				</p>

				<p>It&#8217;s really not a vulnerability as such &#8211; a standard UEFI setup will allow you to run untrusted code before the OS starts, and without a TPM you&#8217;ve got no way of verifying the OS state after the fact. It&#8217;s equivalent to the MBR-based bootkits that already exist in the BIOS world, but the various UEFI entry points mean that the hooks can be a little more elegant. Secure Boot (assuming a bug-free implementation) would secure against this attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186431">

			<div class="comment by-mark-tinberg ">

				<p class="commentcredit">

					<span class="commenter">Mark Tinberg</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186431">
						September 24, 2012 2:56 PM					</a>

				</p>

				<p>You might try reading some of the Secure Boot documentation written by Matt Garrett as it is the most succinct that I&#8217;ve seen</p>
<p><a href="http://mjg59.dreamwidth.org/" rel="nofollow ugc">http://mjg59.dreamwidth.org/</a></p>
<p>And of course Win8 will boot on non-UEFI and non-SecureBoot systems otherwise there&#8217;d be no way to install it on existing systems.</p>
<p>As far as putting effort into a firmware based loader and verifier, that seems to be what UEFI and Secure Boot is trying to achieve&#8230;  You can&#8217;t modify keys after the system boots but you can blacklist keys and install updates as long as they are signed by a key that the firmware already trusts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186432">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186432">
						September 24, 2012 2:57 PM					</a>

				</p>

				<p>EDIT: One more for those looking for better trusted boot designs.</p>
<p>Freescale Secure Boot<br />
<a href="http://cache.freescale.com/files/32bit/doc/white_paper/QORIQSECBOOTWP.pdf?fsrch=1&#038;sr=2" rel="nofollow ugc">http://cache.freescale.com/files/32bit/doc/white_paper/QORIQSECBOOTWP.pdf?fsrch=1&#038;sr=2</a></p>
<p>I forgot to include this one. Like Chromebook. they combine ROM, writable storage &amp; signatures. The part that makes them shine is how many extra precautions they take during the trusted boot process to prevent circumvention. Seems to be among the most trustworthy of the technologies so far. (Barring dedicated, security-related chips like Infineon&#8217;s.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186433">

			<div class="comment by-curtmack ">

				<p class="commentcredit">

					<span class="commenter">curtmack</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186433">
						September 24, 2012 3:34 PM					</a>

				</p>

				<p>@Nick</p>
<p>The Nintendo Wii uses a similar setup. To recall from memory:</p>
<p>The first firmware level, boot0, is built in hardware directly into the processor.</p>
<p>The next level, boot1, is stored in a special sector of the NAND flash, and the SHA-1 hash is burned onto unrewritable fuses in the processor itself; boot0 refuses to load boot1 if the hashes don&#8217;t match.</p>
<p>boot1 loads boot2, which Nintendo verifies by including an RSA signature of the SHA-1 hash. Then, finally, boot2 loads the system menu (which is also verified by a similar signature).</p>
<p>So to recap:</p>
<p>boot0 = literally unalterable for all Wiis ever<br />
boot1 = NP-hard to alter once originally written<br />
boot2 = NP-hard to alter without Nintendo&#8217;s private key</p>
<p>This structure actually came back to bite Nintendo in the ass because the first several production runs are forever marred with a major, security-destroying bug in boot1&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186434">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186434">
						September 24, 2012 10:10 PM					</a>

				</p>

				<p>@curtmack:<br />
Yeah, Sony botched the crypto in the PS3&#8217;s secure boot system too.  They used the same &#8220;random&#8221; number in two places which were each supposed to have their own random number.  Result: those fail0verflow guys did some algebra and recovered Sony&#8217;s private signing key&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186435">

			<div class="comment by-nobodyspecial ">

				<p class="commentcredit">

					<span class="commenter">NobodySpecial</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186435">
						September 24, 2012 11:07 PM					</a>

				</p>

				<p>&#8221; Secure Boot is enabled and you boot Windows 8 or other properly done Secure Boot OS, your system will be secure&#8221;</p>
<p>The trouble is that you buy a machine built by %cheapest supplier% with an OEM copy of Windows. Other than the hologram printed on the box how do you know that it&#8217;s secure?</p>
<p>Unless I order the secure BIOS chip direct form a trusted maker and solder it on myself, then install a retail DVD of Windows direct from Microsoft &#8211; then all these &#8220;security&#8221; features are like ordering  drugs on the internet and relying on them coming in a sealed package!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186436">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186436">
						September 25, 2012 3:32 AM					</a>

				</p>

				<p>To summarise, secure systems are possible but difficult</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186437">

			<div class="comment by-phred14 ">

				<p class="commentcredit">

					<span class="commenter">phred14</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186437">
						September 25, 2012 7:08 AM					</a>

				</p>

				<p>On the non-Windows 8 side of things, I&#8217;m a Gentoo user.  I build my own kernels, usually monthly or more often.  Let&#8217;s say that I buy into UEFI, secure boot, and all of that.</p>
<p>How do I at least attempt to build my own secure kernels?  At least Gentoo verifies checksums on what it downloads, so I&#8217;ve got some confidence that I have good kernel source.  I&#8217;ll also need tools and keys to sign my kernel, etc.  I can also believe that I will need to have downloaded at least once a kernel I can &#8220;trust&#8221;, and use that to start the trust chain of my own kernels, building the new kernel while running a &#8220;trusted&#8221; kernel, etc.</p>
<p>Can I do this online, or is it something where I have to unplug my network while building and signing the new kernel?  Do I need the further step of keeping my signing infrastructure on a USB key that is never plugged in while I&#8217;m networked?  If that&#8217;s the case, how do I set it up in the first place?</p>
<p>This seems to me to be a down-the-rabbit-hole line of thought.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186438">

			<div class="comment by-curtmack ">

				<p class="commentcredit">

					<span class="commenter">curtmack</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186438">
						September 25, 2012 11:37 AM					</a>

				</p>

				<p>@moo fail0verflow even contains many of the people who found the original Wii security bug (which, for the record, involved comparing SHA-1 hashes with strncmp).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186439">

			<div class="comment by-jeff ">

				<p class="commentcredit">

					<span class="commenter">Jeff</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186439">
						September 25, 2012 11:58 AM					</a>

				</p>

				<p>@phred14: The UEFI approach to security is &#8220;don&#8217;t bother trying to prevent malware from rooting the OS &#8211; the user&#8217;s files are unimportant; just prevent any unauthorized modifications of the OS from persisting across reboots&#8221;. Under this model there can be no place for a user compiling his own kernel at all because the OS will usually be under the control of malware which could infect it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186440">

			<div class="comment by-rh ">

				<p class="commentcredit">

					<span class="commenter">RH</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186440">
						September 25, 2012 5:00 PM					</a>

				</p>

				<p>@phred14: It seems to me that the instant you build a kernel on a machine, you trust that that machine is uncompromized (to the point of trusting the entire gcc toolchain).  You would need a trusted image (possibly a standalone image used for nothing but compiling).  Probably the best way to pull this off is a shared volume between your live install and a sanitized image with gcc.</p>
<p>At some point the DRM arguments need to separate from Secure booting, at which point security becomes a floating point rather than a binary secure/insecure.  For me, I&#8217;m happy just to be told when an untrusted image is about to be loaded for the first time.  If this happens at a time when I didn&#8217;t expect, then the computer is infected.  If it gets infected by a system that&#8217;s smart enough to wait for a Windows Update to do its infection&#8230; well so be it.  That&#8217;s my personal security/usability tradeoff point.  I&#8217;m quite positive Oak Ridge National Labs will prefer a much more stringent requirement (such as 2 factor authentication of checksums distributed on paper through secure channels).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186441">

			<div class="comment by-failure ">

				<p class="commentcredit">

					<span class="commenter">failure</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186441">
						September 25, 2012 5:29 PM					</a>

				</p>

				<p>Microsoft puts out an insecure o/s where nothing is sandboxed and the browser takes over your entire machine. They have something like 3,000 engineers per project and not one of them can write secure code so the MBAs got together and decided hey let&#8217;s just pawn this off on the hardware manufacturers.</p>
<p>This isn&#8217;t going to work either and eventually they will just run giant server farms and sell you a dumb terminals to connect to their DRM riddled &#8216;cloud&#8217; and everybody runs a remote desktop that checks for piracy or thoughtcrime every hour. Pay per use computing with a little paperclip that pops up telling you that possible ebook piracy has been detected, lawyers have been dispatched to your house.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186442">

			<div class="comment by-curtmack ">

				<p class="commentcredit">

					<span class="commenter">curtmack</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186442">
						September 26, 2012 3:18 PM					</a>

				</p>

				<p>@RH</p>
<p>I think I may have figured this out:</p>
<p>The build computer is a desktop computer located in a locked underground facility at an unmarked location. It is not connected to any network. It has no wireless devices, and even if it did, the room is a Faraday cage.</p>
<p>The build computer contains no storage except a small hard drive, which contains two partitions. It has no MBR and the system cannot boot by itself.</p>
<p>The first partition contains an extremely minimalistic installation of Linux. It is put together by hand and contains only the kernel (along with a small handful of needed modules), the usual required system commands, bash, PGP, sha1, and gcc.</p>
<p>It also contains a PGP signature file that signs the SHA-1 hash of every file on the drive save itself; init scripts verify that all files match and that no unexpected files are found. The second partition contains the same thing, except that every file is signed via a public-key MAC whose private key was destroyed. This allows recovery in case the first partition breaks or is tampered with, but allows the first partition to be updated if necessary.</p>
<p>As mentioned, the system cannot be booted by itself. It requires the boot key, a USB drive which contains the necessary boot code. The USB drive is a custom piece of hardare that contains fuses encoding the SHA-1 hash of the drive contents, and the USB drive will not start if the hash does not match. It uses a customized version of LILO that allows it to perform the restore process from partition 2, after verifying the MACs. The boot key is stored in a secure safe in the owner&#8217;s house. The boot key also contains the PGP private key for signing files on the first partition.</p>
<p>Finally, a second USB port is included. This is used for a USB drive that houses the files to be built. The drive is mounted, and the PGP signatures of the sources are checked. Once verified, the sources are built and the binaries are written back to the USB drive. Upgrading the Linux installation is similar, except that it writes to itself and updates the signature file, and then reboots.</p>
<p>Also, there are tigers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186443">

			<div class="comment by-curtmack ">

				<p class="commentcredit">

					<span class="commenter">curtmack</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186443">
						September 26, 2012 4:12 PM					</a>

				</p>

				<p>Obviously this will be set up only after performing a mathematical proof of correctness of every line of source code that will run on the build computer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186444">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186444">
						September 26, 2012 8:41 PM					</a>

				</p>

				<p>@ curtmark,</p>
<p><i>Also, there are tigers</i></p>
<p>There are no tigers if you place four special rocks (I can sell you üòâ around the entrance to your underground facility.</p>
<p>More seriously though how are you keeping other people from pluging in their own USB drives that act as boot keys?</p>
<p>The simple fact is that with the best will in the world you cannot make a system that is &#8220;known to be secure&#8221; only that you think &#8220;might&#8221; be secure.</p>
<p>Simply because historicaly we have the issue of &#8220;unknown unknowns&#8221; and we cannot see into the future&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186445">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186445">
						September 26, 2012 9:12 PM					</a>

				</p>

				<p>@ RH and curtmack</p>
<p>You guys are trying. It&#8217;s better to focus on practical security rather than total. The designs you&#8217;ve mentioned that try to be extremely secure fall short in extreme ways. It&#8217;s an easy trap to run into if you don&#8217;t do this stuff much. The more practical ideas mentioned are decent, including separate build machine &amp; extra security on it. If you&#8217;re using something like Linux or UEFI, all the formal methods and stuff don&#8217;t apply anyway because you&#8217;re guaranteeing something guaranteed to have residual, severe flaws. üòâ</p>
<p>I can&#8217;t find my big layer by layer breakdown right now. However, even though I promote high assurance, I have discouraged efforts I thought would go nowhere. The comment below shows you what you&#8217;re up against trying to make a useful, secure system with maybe a little custom hardware.</p>
<p><a href="http://www.schneier.com/blog/archives/2011/08/new_attack_on_a_1.html#c573251" rel="nofollow ugc">http://www.schneier.com/blog/archives/2011/08/new_attack_on_a_1.html#c573251</a></p>
<p>So, what to do for a practical build system or signature system? Well, at least two systems is a start. Might use something like minimized OpenBSD for the critical system. You need to get copies of important things like the kernel/OS, GCC toolchain, etc. Needs to be able to zip up a release &amp; sign it with protected private key. Also, need a process where developers&#8217; changes are checked, integrated with the local repository, and the final software rebuilt.</p>
<p>No matter how you do it, the physical machine must be safe from anyone untrustworthy. The critical stuff should be encrypted &amp; hashed just in case. It should NOT be connected to Internet. Transfer files to and from using a simple non-DMA link (home-made data diode, anyone?). Keep copies of everything downloaded from internet, with hash and signatures, on read-only memory (CDROMS, preferably, using diff PC). Optionally put the signing key in an encrypted volume with very strong password, only opened [into RAMdisk] during the signing phase itself.</p>
<p>Also, sometimes you can get free security benefits at high performance. An example is how one of you was going to check a bunch of files for modifications. The dates might lie, so your software would probably hash every file &amp; compare hashes to trusted baseline copy. Alternative: make a trustworthy system image, save it to hard disk as a whole image, &amp; hash that image. Next time, you just have to hash/check one big file, then load it. Simple, eh?</p>
<p>You might also wonder about subversion, OS issues, etc. Get several systems from different vendors under different names. Maybe even different processor architectures. Put different OS&#8217;s on them. Compile the release on all of them with the same settings and software. Trusted system checks that they match &amp; signs the result. Main security requirement is trusting the generation software (e.g. compiler) &amp; checker, which is less than trusting whole stack. Opponents have to compromise all kinds of stuff to slip one by.</p>
<p>Hope some of this helps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186446">

			<div class="comment by-jason-t-miller ">

				<p class="commentcredit">

					<span class="commenter">Jason T. Miller</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186446">
						September 27, 2012 3:54 AM					</a>

				</p>

				<p>@Nick P</p>
<p>Why trust any &#8220;home-made&#8221; removable storage device more than a $10 USB stick purchased at retail the morning of the build?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186447">

			<div class="comment by-curtmack ">

				<p class="commentcredit">

					<span class="commenter">curtmack</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186447">
						September 27, 2012 10:31 AM					</a>

				</p>

				<p>@RH: I was more interested in preventing tampering. Note that both the computer and the real, unaltered boot key have to be present at the same time to modify anything on the computer without being detected, unless you break SHA-1 or PGP. At the very least the attacker would need to steal the original boot key to get the PGP private key, and then he may as well just use that and use it to install Ubuntu: Malware Ahoy Edition directly.</p>
<p>@Nick: It was more intended to be a demonstration of why going heavily on the security side is ridiculous. Although it&#8217;d be a fun project to actually make that version of Linux.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186448">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> ‚Ä¢

					<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/#comment-186448">
						September 27, 2012 2:22 PM					</a>

				</p>

				<p>@ curtmack</p>
<p>Appreciate the clarification.</p>
<p>@ Jason</p>
<p>A data diode is a transfer device that enforces one-way transmission of data. They are simple enough that two or three were certified to EAL7, NSA&#8217;s highest standard. One manufacturer has a &#8220;oneway ethernet&#8221; design mainly involving modifying cables and driver. Very easy home project, but doesnt have to be ethernet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/09/security_vulner_2.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/09/security_vulner_2.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F09%2Fsecurity_vulner_2.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/09/security_vulner_2.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4518' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/09/sha-3_will_be_a.html" rel="prev">‚Üê SHA-3 to Be Announced</a>		<a href="https://www.schneier.com/blog/archives/2012/09/homomorphic_enc_1.html" rel="next">Homomorphic Encryption ‚Üí</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
