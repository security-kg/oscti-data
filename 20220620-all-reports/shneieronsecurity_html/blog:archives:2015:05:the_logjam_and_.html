<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>The Logjam (and Another) Vulnerability against Diffie-Hellman Key Exchange - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; The Logjam (and Another) Vulnerability against Diffie-Hellman Key Exchange Comments Feed" href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/7054" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=7054' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fthe_logjam_and_.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fthe_logjam_and_.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-7054 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-7054" class="post-7054 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-cryptanalysis tag-cryptography tag-encryption tag-gchq tag-https tag-keys tag-man-in-the-middle-attacks tag-ssh tag-tls tag-vpn tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">The Logjam (and Another) Vulnerability against Diffie-Hellman Key Exchange</h2>
		<p><a href="https://weakdh.org/">Logjam</a> is a new attack against the Diffie-Hellman key-exchange protocol used in TLS. Basically:</p>
<blockquote><p>The Logjam attack allows a man-in-the-middle attacker to downgrade vulnerable TLS connections to 512-bit export-grade cryptography. This allows the attacker to read and modify any data passed over the connection. The attack is reminiscent of the <a href="http://freakattack.com/">FREAK attack</a>, but is due to a flaw in the TLS protocol rather than an implementation vulnerability, and attacks a Diffie-Hellman key exchange rather than an RSA key exchange. The attack affects any server that supports <tt>DHE_EXPORT</tt> ciphers, and affects all modern web browsers. 8.4% of the Top 1 Million domains were initially vulnerable.</p></blockquote>
<p>Here&#8217;s the <a href="https://weakdh.org/imperfect-forward-secrecy.pdf">academic paper</a>.</p>
<p>One of the problems with patching the vulnerability is that it <a href="http://www.engadget.com/2015/05/20/logjam-browser-vulnerability-fix/">breaks things</a>:</p>
<blockquote><p>On the plus side, the vulnerability has largely been patched thanks to consultation with tech companies like Google, and updates are available now or coming soon for Chrome, Firefox and other browsers. The bad news is that the fix rendered many sites unreachable, including the main website at the University of Michigan, which is home to many of the researchers that <i>found</i> the security hole.</p></blockquote>
<p>This is a common problem with version downgrade attacks; patching them makes you incompatible with anyone who hasn&#8217;t patched. And it&#8217;s the vulnerability the media <a href="http://arstechnica.com/security/2015/05/https-crippling-attack-threatens-tens-of-thousands-of-web-and-mail-servers/">is</a> <a href="http://www.wsj.com/articles/new-computer-bug-exposes-broad-security-flaws-1432076565">focusing</a> <a href="http://it.slashdot.org/story/15/05/20/1258251/logjam-vulnerability-threatens-encrypted-connections">on</a>. </p>
<p>Much more interesting is the other vulnerability that the researchers found:</p>
<blockquote><p>Millions of HTTPS, SSH, and VPN servers all use the same prime numbers for Diffie-Hellman key exchange. Practitioners believed this was safe as long as new key exchange messages were generated for every connection. However, the first step in the number field sieve &#8212; the most efficient algorithm for breaking a Diffie-Hellman connection &#8212; is dependent only on this prime. After this first step, an attacker can quickly break individual connections.</p></blockquote>
<p>The researchers believe the NSA <a href="https://weakdh.org/">has been using</a> this attack:</p>
<blockquote><p>We carried out this computation against the most common 512-bit prime used for TLS and demonstrate that the Logjam attack can be used to downgrade connections to 80% of TLS servers supporting <tt>DHE_EXPORT</tt>. We further estimate that an academic team can break a 768-bit prime and that a nation-state can break a 1024-bit prime. Breaking the single, most common 1024-bit prime used by web servers would allow passive eavesdropping on connections to 18% of the Top 1 Million HTTPS domains. A second prime would allow passive decryption of connections to 66% of VPN servers and 26% of SSH servers. A close reading of published NSA leaks shows that the agency&#8217;s attacks on VPNs are consistent with having achieved such a break. </p></blockquote>
<p>Remember James Bamford&#8217;s <a href="http://www.wired.com/2012/03/ff_nsadatacenter/all/1">2012 comment</a> about the NSA&#8217;s cryptanalytic capabilities:</p>
<blockquote><p>According to another top official also involved with the program, the NSA made an enormous breakthrough several years ago in its ability to cryptanalyze, or break, unfathomably complex encryption systems employed by not only governments around the world but also many average computer users in the US. The upshot, according to this official: &#8220;Everybody&#8217;s a target; everybody with communication is a target.&#8221;</p>
<p>[&#8230;]</p>
<p>The breakthrough was enormous, says the former official, and soon afterward the agency pulled the shade down tight on the project, even within the intelligence community and Congress. &#8220;Only the chairman and vice chairman and the two staff directors of each intelligence committee were told about it,&#8221; he says. The reason? &#8220;They were thinking that this computing breakthrough was going to give them the ability to crack current public encryption.&#8221;</p></blockquote>
<p>And remember Director of National Intelligence James Clapper&#8217;s introduction to the 2013 &#8220;<a href="http://www.washingtonpost.com/world/national-security/black-budget-summary-details-us-spy-networks-successes-failures-and-objectives/2013/08/29/7e57bb78-10ab-11e3-8cdd-bcdc09410972_story.html?tid=pm_world_pop">Black Budget</a>&#8220;:</p>
<blockquote><p>Also, we are investing in groundbreaking cryptanalytic capabilities to defeat adversarial cryptography and exploit internet traffic.</p></blockquote>
<p>It&#8217;s a reasonable guess that this is what both Bamford&#8217;s source and Clapper are talking about. It&#8217;s an attack that requires a lot of precomputation &#8212; just the sort of thing a national intelligence agency would go for.</p>
<p>But that requirement also speaks to its limitations. The NSA isn&#8217;t going to put this capability at collection points like <a href="https://en.wikipedia.org/wiki/Room_641A">Room 641A</a> at AT&#038;T&#8217;s San Francisco office: the precomputation table is too big, and the sensitivity of the capability is too high. More likely, an analyst identifies a target through some other means, and then looks for data by that target in databases like XKEYSCORE. Then he sends whatever ciphertext he finds to the Cryptanalysis and Exploitation Services (CES) group, which decrypts it if it can using this and other techniques.</p>
<p>Ross Anderson <a href="https://www.lightbluetouchpaper.org/2015/05/02/meeting-snowden-in-princeton/">wrote about this</a> earlier this month, almost certainly quoting Snowden:</p>
<blockquote><p>As for crypto capabilities, a lot of stuff is decrypted automatically on ingest (e.g. using a &#8220;stolen cert&#8221;, presumably a private key obtained through hacking). Else the analyst sends the ciphertext to CES and they either decrypt it or say they can&#8217;t.</p></blockquote>
<p>The analysts are instructed not to think about how this all works. This <a href="http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security">quote</a> also applied to NSA employees:</p>
<blockquote><p>Strict guidelines were laid down at the GCHQ complex in Cheltenham, Gloucestershire, on how to discuss projects relating to decryption. Analysts were instructed: &#8220;Do not ask about or speculate on sources or methods underpinning Bullrun.&#8221;</p></blockquote>
<p>I remember the same instructions in documents I saw about the NSA&#8217;s CES.</p>
<p>Again, the NSA has put <a href="https://www.schneier.com/blog/archives/2015/03/the_democratiza_1.html">surveillance ahead of security</a>. It never bothered to tell us that many of the &#8220;secure&#8221; encryption systems we were using were not secure. And we don&#8217;t know what other national intelligence agencies independently discovered and used this attack.</p>
<p>The good news is now that we know reusing prime numbers is a bad idea, we can stop doing it.</p>
<p>EDITED TO ADD: The DH precomputation easily lends itself to custom ASIC design, and is something that pipelines easily. Using <a href="https://en.bitcoin.it/wiki/Mining_hardware_comparison">BitCoin mining hardware</a> as a rough comparison, this means a couple orders of magnitude speedup.</p>
<p>EDITED TO ADD (5/23): Good <a href="http://www.scottaaronson.com/blog/?p=2293">analysis</a> of the cryptography.</p>
<p>EDITED TO ADD (5/24): Good <a href="http://.cryptographyengineering.com/2015/05/attack-of-week-logjam.html">explanation</a> by Matthew Green.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/gchq/" rel="tag">GCHQ</a>, <a href="https://www.schneier.com/tag/https/" rel="tag">https</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/ssh/" rel="tag">SSH</a>, <a href="https://www.schneier.com/tag/tls/" rel="tag">TLS</a>, <a href="https://www.schneier.com/tag/vpn/" rel="tag">VPN</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html" rel="bookmark">Posted on May 21, 2015 at 6:30 AM</a>			â€¢
			<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html#comments">35 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html" data-title="The Logjam (and Another) Vulnerability against Diffie-Hellman Key Exchange" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-249446">

			<div class="comment by-thomas-m ">

				<p class="commentcredit">

					<span class="commenter">Thomas M</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249446">
						May 21, 2015 6:47 AM					</a>

				</p>

				<p>What about IPSEC VPNs?<br />
When using IPSEC, you must configure the &#8220;Diffie Hellman Group&#8221;, which is basically that you say which of those known primes you are using.</p>
<p>Is there any way to avoid this, without breaking the VPN?</p>
<p>All of the discussion is about SSL, but I think the DH issue affects IPSEC as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249447">

			<div class="comment by-zenzero ">

				<p class="commentcredit">

					<span class="commenter">Zenzero</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249447">
						May 21, 2015 6:54 AM					</a>

				</p>

				<p>From the site Bruce linked, they have have tests for both server &amp; browser:</p>
<p>Will show you if your browser is Vulnerable (at the top, may take a few seconds)<br />
<a href="https://weakdh.org/" rel="nofollow ugc">https://weakdh.org/</a></p>
<p>And tool here to test your server:<br />
<a href="https://weakdh.org/sysadmin.html" rel="nofollow ugc">https://weakdh.org/sysadmin.html</a></p>
<p>If the NSA in fact used this and I would be amazed if they didnt, then hopefully that will send a message to the american people what their government thinks of them.</p>
<p>Obama said the NSA would not site on Zero days unless &#8220;there is a clear national security or law enforcement need.&#8221;.  How on earth would making most of the world (including americans) vulnurable to this bug constitute national security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249448">

			<div class="comment by-mikeacker ">

				<p class="commentcredit">

					<span class="commenter">mike~acker</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249448">
						May 21, 2015 7:59 AM					</a>

				</p>

				<p>if you stop and think about things for a minute you&#8217;ll realize that the client computer must generate the session key.</p>
<p>initially the client holds the server&#8217;s public key in the x.509 certificate and the server holds the corresponding secret key.   this is a half-installed PGP link: it&#8217;s only secure from client to server and authentication is only possible from server to client.</p>
<p>this reveals a huge problem with SSL/TLS: on initial contact the client is supposed to use its local copy of the server&#8217;s x.509 certificate in order to authenticate the identity of the server.    but: x.509 certificate have been compromised.   the client should verify the server&#8217;s certificate itself &#8212; and then sign for it &#8212; using its own copy of PGP or GnuPG.    this is <em>critical</em> is it is absolutely necessary to the client to be sure who it is connecting with</p>
<p>a session key now needs to be generated.    the client has to do this because while, initially, the client can encrypt a secure message to the server &#8212; the server cannot encrypt to the client as it does not normally hold a Public Key for the client.</p>
<p>thus the client computer needs only to generate a 256 bit AES session key, encrypt it to the server and send it .   this will be a symmetric key used only for the session.   anyting than does not decrypt using the session key then is either an error or an intrusion &#8212; game over .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249449">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249449">
						May 21, 2015 8:15 AM					</a>

				</p>

				<p>So, despite what all cryptographers were saying right after Snowden, it turned out that the three-letter agencies actually had an ace up in their sleeve.</p>
<p>May be it&#8217;s time to recall the old rule of thumb from the commie block &#8211; if you can&#8217;t say it to the local comparty secretary&#8217;s face, better not talk about it over the phone. Or in your home. Or in someone else&#8217;s home.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249450">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249450">
						May 21, 2015 8:19 AM					</a>

				</p>

				<p>Generating your own prime is easy, it&#8217;s something that only takes a matter of seconds for a 2048-bit key. For ephemeral keys, there is no excuse for not generating a new one on first configuration. Hell, you could theoretically do it on server start if you don&#8217;t mind a slight delay.</p>
<p>I use OpenVPN and generating the prime is one of the first steps in all of the guides.</p>
<p>We do need to work on getting rid of export mode entirely, of course.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-249451">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter">Bruce Schneier</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249451">
						May 21, 2015 9:10 AM					</a>

				</p>

				<p>&#8220;So, despite what all cryptographers were saying right after Snowden, it turned out that the three-letter agencies actually had an ace up in their sleeve.&#8221;</p>
<p>I don&#8217;t think that&#8217;s right. <a href="https://www.schneier.com/blog/archives/2013/09/the_nsas_crypto_1.html" rel="nofollow ugc">This</a>, for example, is me in September 2013:</p>
<blockquote><p>More likely is that the NSA has some mathematical breakthrough that affects one or more public-key algorithms. There are a lot of mathematical tricks involved in public-key cryptanalysis, and absolutely no theory that provides any limits on how powerful those tricks can be.</p></blockquote>
<p>Also <a href="https://www.schneier.com/news/archives/2014/02/the_nsa_is_not_made.html" rel="nofollow ugc">this</a>, from 2014.</p>
<p>I wasn&#8217;t alone; others have said similar things.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249452">

			<div class="comment by-hanno ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://hboeck.de/' rel='external nofollow ugc' class='url'>Hanno</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249452">
						May 21, 2015 9:54 AM					</a>

				</p>

				<p>About reusing primes: Actually the situation is a bit more complex.</p>
<p>Looking back a bit at other attacks last year we had something called the triple handshake attack. It was not really one attack, but (like the logjam paper) a whole range of issues, but one of them involved attacking a client by sending him a bad DH group (which could then be used to fake a client authenticated connection to another host).</p>
<p>We thought we learned from the triple handshake attack that arbitrary primes in DH exchanges are bad. Therefore the IETF WG is working on a standard to fix the primes.</p>
<p>I&#8217;m not sure how aware the security community is, but the issue is more complex. There seem to be attacks that can profit from arbitrary primes, while others profit from fixed/shared primes. And to me right now it&#8217;s far from clear which one is worse. This needs clearly more investigation.</p>
<p>(One thing I don&#8217;t know and maybe Bruce or any other crypto guru can answer: Do we have the same precalculation problem with elliptic curve groups?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249453">

			<div class="comment by-cassandra ">

				<p class="commentcredit">

					<span class="commenter">Cassandra</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249453">
						May 21, 2015 10:42 AM					</a>

				</p>

				<p>I&#8217;d hope one outcome of this is to make the use of pre-shared keys easier. Key management, including key distribution and key changes is difficult &#8211; but one of the advantages of pre-shared keys is that you can make the stream unhackable (so long as you choose a sufficiently hard-to-guess key e.g. from a &#8216;sufficiently random&#8217; one-time-pad; and don&#8217;t use an encryption protocol designed to leak details of the key).</p>
<p>This means that pre-calculation attacks become impossible, and your vulnerabilty reduces to ensuring that the key cannot be obtained from your encryption and decryption equipment (which can be difficult if you are protecting agains nation-state attackers).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249454">

			<div class="comment by-rgaff ">

				<p class="commentcredit">

					<span class="commenter">rgaff</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249454">
						May 21, 2015 11:47 AM					</a>

				</p>

				<p>So since this depends on pre-calculating lots of data to make it fast and usable&#8230;. exactly how big of keys can be broken with &#8220;a yottabyte&#8221; of data?</p>
<p><a href="http://www.cnet.com/uk/news/nsa-to-store-yottabytes-in-utah-data-centre/" rel="nofollow ugc">http://www.cnet.com/uk/news/nsa-to-store-yottabytes-in-utah-data-centre/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249455">

			<div class="comment by-mikeacker ">

				<p class="commentcredit">

					<span class="commenter">mike~acker</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249455">
						May 21, 2015 11:58 AM					</a>

				</p>

				<p>I think it was generally conceded a while back that we needed to move on from prime numbers &#8230;</p>
<p>if you check on things you&#8217;ll find GnuPG 2.1 will support <a href="http://arstechnica.com/security/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/" rel="nofollow ugc"> Eliptic Curves </a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249456">

			<div class="comment by-rgaff ">

				<p class="commentcredit">

					<span class="commenter">rgaff</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249456">
						May 21, 2015 12:33 PM					</a>

				</p>

				<p>@mike~acker</p>
<p>Using the special NSA curves?  lol  just teasing ðŸ™‚</p>
<p><a href="https://en.wikipedia.org/wiki/Dual_EC_DRBG" rel="nofollow ugc">https://en.wikipedia.org/wiki/Dual_EC_DRBG</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249457">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cryptologie.net' rel='external nofollow ugc' class='url'>david</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249457">
						May 21, 2015 12:42 PM					</a>

				</p>

				<p>I think people might argue about re-using primes but it&#8217;s so simple to generate your own prime that there is no reason to re-use them.</p>
<p>Also my take on the attack: <a href="http://cryptologie.net/article/270/the-logjam-attack/" rel="nofollow ugc">http://cryptologie.net/article/270/the-logjam-attack/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249458">

			<div class="comment by-vas-pup ">

				<p class="commentcredit">

					<span class="commenter">vas pup</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249458">
						May 21, 2015 1:31 PM					</a>

				</p>

				<p>NOVA on hacking: like part related to new password concept:<br />
<a href="http://www.pbs.org/wgbh/nova/tech/rise-of-the-hackers.html" rel="nofollow ugc">http://www.pbs.org/wgbh/nova/tech/rise-of-the-hackers.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249459">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249459">
						May 21, 2015 1:49 PM					</a>

				</p>

				<p>@rgaff: YES.</p>
<p>Yes yes yes a thousand times yes use the NSA&#8217;s curves.</p>
<p>The NSA has an attitude that unclassified doesn&#8217;t matter: anything they actually care about defending ends up being classified.  So they are willing to throw all the unclassified systems at risk if it helps their ability to break things (e.g. Dual_EC).</p>
<p>The attitude is completely reversed for the classified space.  That is the one space where the NSA does truly value defense over offense, and will never knowingly use a weak algorithm.</p>
<p>Suite B is approved by the NSA for Top Secret communication, with AES256, curve P-384 (aka nistp384 and secp384r1), and SHA-384.</p>
<p>This approval, for Top Secret communication, is the ultimate NSA stamp of approval.  They are saying &#8220;We believe this is strong, even against us&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249460">

			<div class="comment by-curious ">

				<p class="commentcredit">

					<span class="commenter">Curious</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249460">
						May 21, 2015 2:46 PM					</a>

				</p>

				<p>I read the following sentence somewhere:<br />
&#8220;There is a law of diminishing returns with RSA key length.&#8221; (E.g 1024 bit vs 2048 bit)</p>
<p>What does that mean and is this comparable somehow to the use of &#8216;public key cryptography&#8217;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249461">

			<div class="comment by-do-you-believe-that ">

				<p class="commentcredit">

					<span class="commenter">Do you believe that?</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249461">
						May 21, 2015 3:27 PM					</a>

				</p>

				<p>@Nicholas Weaver- I can assure you that is what <em>they</em> have Suite A for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249462">

			<div class="comment by-lily ">

				<p class="commentcredit">

					<span class="commenter">lily</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249462">
						May 21, 2015 3:37 PM					</a>

				</p>

				<p>I&#8217;m surprised that you didn&#8217;t mention the fact that the second vulnerability results in a complete loss of forward secrecy. it effectively reduces the strength of each DH group to the strength of a single RSA key of the same length. forward secrecy that&#8217;s cheaper than generating a new RSA key pair for every connection was the main selling point of DH, so what point is there in using DH over RSA? the only reason I can think of is wanting people to think they have forward secrecy when they really don&#8217;t.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249463">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249463">
						May 21, 2015 4:05 PM					</a>

				</p>

				<p>@lily</p>
<p>As long as each server generates their own primes, according to the paper diffie-hellman will be more secure than RSA. With 2048-bit keys, you should be good regardless with either algorithm for the near future.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249464">

			<div class="comment by-jesse ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.lightsecond.com' rel='external nofollow ugc' class='url'>Jesse</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249464">
						May 21, 2015 4:11 PM					</a>

				</p>

				<p>@Cassandra: pre-shared keys cannot offer you perfect forward secrecy.</p>
<p>If you use a pre-shared key for a year, and then later somebody hacks one end of the connection they can get that key and decrypt all of your past conversations.</p>
<p>Ephemeral keys like those offered by carefully executed DH mean that 1&gt; you don&#8217;t have to store the keys actually used by the stream cipher to disk ever, so they should be next to impossible to ever recover in the future. 2&gt; If one key does somehow magically get recovered, then only the data encrypted using that (for 10 minutes or however long) is breakable, while even the very next set of ephemeral keys are not compromised in turn.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249465">

			<div class="comment by-lily ">

				<p class="commentcredit">

					<span class="commenter">lily</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249465">
						May 21, 2015 4:24 PM					</a>

				</p>

				<p>@Anura no, it will be not worse than RSA, but also not significantly better. to get forward secrecy, you would have to generate a new prime for every connection, which would be even slower than ephemeral RSA (which no one uses because of how slow it is).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249466">

			<div class="comment by-cassandra ">

				<p class="commentcredit">

					<span class="commenter">Cassandra</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249466">
						May 21, 2015 4:42 PM					</a>

				</p>

				<p>@Jesse<br />
Thank-you for pointing out the loss of Perfect Forward Secrecy. lily&#8217;s point above is pertinent. I don&#8217;t know which is better: to think you have perfect forward secrecy when in fact you don&#8217;t, because you are compromised by a poor DH implementation, or to have no forward secrecy and take appropriate mitigating actions.</p>
<p>This is partly why I mentioned the difficulty of key management. If changing pre-shared keys were made easy you could arrange matters so that compromise of an individual key compromised the encrypted stream for an arbitrarily short interval.</p>
<p>But, I acknowledge, properly executed 2048 bit DH should be good enough for a while.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249467">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249467">
						May 21, 2015 5:42 PM					</a>

				</p>

				<p>@lily</p>
<p>If they can break the 1024-bit primes generated on each server, then they can also break the 1024-bit RSA keys on each server (which are possibly one key for a group of servers). Either renders the protocol insecure. DH is still more secure because they actually have to break it, whereas with RSA they only need access to the server itself to gain the private key, allowing you to read all past messages, which is insecure regardless of key length. With 2048-bit DH keys, it is infeasible even for the NSA to break the keys, and the more likely attack would be that they would recover the RSA private keys to perform man-in-the middle attacks. By definition this is still perfect forward secrecy, as long as the primes are not breakable, even if the same prime is used everywhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249468">

			<div class="comment by-uh-mike ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://xkcd.com/722' rel='external nofollow ugc' class='url'>uh, Mike</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249468">
						May 21, 2015 6:11 PM					</a>

				</p>

				<p>!Bitcoin! by the way, provides an interesting empirical cryptology benchmark, eh?  Bitcoin mining boxes are basically brute-forcing the hash.  Bitcoin mining humans will be trying to break out of the statistical vault.</p>
<p>Immovable object, meet irresistible force.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249469">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249469">
						May 22, 2015 9:42 AM					</a>

				</p>

				<p>@Hanno:</p>
<p>For the sake of clarity &#8230;</p>
<p>By my reading, an accessory to the triple handshake vulnerability was not the use of &#8220;arbitrary primes&#8221;, but rather of <i>composite</i> values for parameter <b>p</b>.  It isn&#8217;t a matter of bad primes, though Sophie Germain primes are considered the safest.</p>
<p>Accordingly, it would be more correct to say &#8220;arbitrary <b>p</b> values&#8221; than &#8220;arbitrary primes&#8221;.</p>
<p>Of course, this doesn&#8217;t change the essence of the problem:  an attacker can use a bad value for <b>p</b>.</p>
<p>One way to respond to the problem, would be to require Sophie Germain primes. These can be dependably checked using pseudoprimality testing. So a checking process might look like:</p>
<p>(1) Is this <b>p</b> either published, or one we have validated from a different party? If so, reject.</p>
<p>(2) Is <b>p</b> a Sophie Germain prime? If not, reject.</p>
<p>Unfortunately, the testing costs significant CPU time (several times more than the DH key agreement protocol). However, once such a value has been checked, it could be safely re-used in future DH agreements between the two parties.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249470">

			<div class="comment by-paul-wouters ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://nohats.ca' rel='external nofollow ugc' class='url'>Paul Wouters</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249470">
						May 22, 2015 10:29 AM					</a>

				</p>

				<p>I did a write to explain the impact of this on IKE/IPsec VPNs (specifically libreswan and openswan)</p>
<p><a href="https://nohats.ca/wordpress/blog/2015/05/20/weakdh-and-ike-ipsec/" rel="nofollow ugc">https://nohats.ca/wordpress/blog/2015/05/20/weakdh-and-ike-ipsec/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249471">

			<div class="comment by-sam ">

				<p class="commentcredit">

					<span class="commenter">Sam</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249471">
						May 22, 2015 4:02 PM					</a>

				</p>

				<p>According to the weakdh server test site, this server (schneier.com) &#8220;uses a commonly-shared 1024-bit Diffie-Hellman group, and might be in range of being broken by a nation-state. It might be a good idea to generate a unique, 2048-bit group for the site&#8221;.</p>
<p>Sure this is mostly a cosmetic issue for public sites that don&#8217;t handle sensitive information, but I would think the site of a security professional would have a better image if it was as secure as reasonably possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249472">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249472">
						May 22, 2015 7:55 PM					</a>

				</p>

				<p>Also @Hanno:</p>
<p>No expert has yet weighed in, responding to your important question whether ECC has the same vulnerability to using &#8220;known&#8221; mathematical groups. So, as a tyro in the subject, here is my very non-expert perspective:</p>
<ol>
<li>As far as I have discovered, Pollard&#8217;s rho algorithm is the fastest known algorithm for solving discrete logs in elliptic curve groups. The rho algorithm has higher computational cost than the sieve algorithms applicable to non-ECC public key cryptography, which is perhaps one reason why ECC is considered to offer equivalent security at smaller key sizes.</li>
<li>As far as I understand Pollard&#8217;s rho algorithm, the values computed while working toward a solution depend on the argument (that is, the value whose discrete log is to be found). Accordingly, there would seem to be no opportunity for pre-computation.</li>
</ol>
<p>I would welcome the views of anybody who understands these matters beyond my very superficial understanding!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249473">

			<div class="comment by-lily ">

				<p class="commentcredit">

					<span class="commenter">lily</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249473">
						May 23, 2015 10:27 AM					</a>

				</p>

				<p>@Anura<br />
2048-bit primes can&#8217;t be broken yet, but will be broken eventually. the issue is that if someone records traffic to the server now and then breaks the server&#8217;s 2048-bit RSA key in 15 years, the worst they can do is attempt to impersonate the server with an expired certificate (assuming the server uses DHE_RSA and not plain RSA). if they break the server&#8217;s 2048-bit DH group in 15 years, they can decrypt all that recorded traffic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249474">

			<div class="comment by-mohammad-oweis ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.itprostuff.com' rel='external nofollow ugc' class='url'>Mohammad Oweis</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249474">
						May 23, 2015 1:39 PM					</a>

				</p>

				<p>Very good explanation.<br />
But, its not necessarily to become incompatible with un-patched systems, they could already be using 1024bit DH</p>
<p>You can find here some configuration changes for several servers, to mitigate the attack.<br />
<a href="http://mohammadoweis.hubpages.com/hub/Another-SSL-major-flow-LOGJAM-attack" rel="nofollow ugc">Another SSL major flow &#8211; LOGJAM attack</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249475">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249475">
						May 23, 2015 5:13 PM					</a>

				</p>

				<p>@lily</p>
<p>The impact of this isn&#8217;t as high as you imply. Most servers do not use PFS and instead use RSA for key exchange (and the ones that do provide PFS use ECDH), but even then PFS does not guarantee your server is secure if your key is too small. Using your own primes still means the NSA has to break those primes, and if the keys themselves are breakable then any PFS goes out the window. If the primes are breakable if they are on a per-server basis then it won&#8217;t be long until the keys are individually breakable in large numbers as well if you use a different prime for each session (since it&#8217;s only a linear increase in attack time). This is why you always need to ensure that your key length will outlive the usefulness of the data you are encrypting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249476">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249476">
						May 23, 2015 9:18 PM					</a>

				</p>

				<p>I can&#8217;t comment on the technical side, but from a political side I can see what I think is the most likely scenario where this ends.</p>
<p>And that&#8217;s where you get the NSA penetrated from foreign HUMINT activity. Either an agent recruited from the NSA or even an officer somehow planted into them. Then the enemy agency finds a way to get their hands on the precalculation data and starts using the exact same techniques the NSA does to pop nearly anything open. Now I get that the sheer quantity of data required in this situation means that you can&#8217;t exactly walk off with this in a flash drive. OTOH, agencies have managed to get their hands on whole tank engines in the past. Of course, if the NSA&#8217;s has done something more exotic like P=NP, then getting the secret out the door becomes much easier.</p>
<p>However it happens, if the NSA creates a backdoor, or encourages one to remain out there in public, and that backdoor falls into enemy hands, and then that becomes public, then the storm that ensues could justify congress popping the NSA open and drastically reforming them.</p>
<p>Anything short of that, and you&#8217;ll be facing the same arguments we&#8217;ve been fighting, winning in public, and then losing in private, going all the way back to the Jamie Gorelick and the Clipper Chip.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249477">

			<div class="comment by-fascist-nation ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.freedomsphoenix.com' rel='external nofollow ugc' class='url'>Fascist Nation</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249477">
						May 24, 2015 1:29 PM					</a>

				</p>

				<p>Apologies if someone posted the fix for Mozilla engine users.  I looked but didn&#8217;t see it.  Easy fix.  Disable the vulnerable cyphers.  Doesn&#8217;t require reboot browser as changes occur automatically.  PaleMoon users can do it from their menu.  Worked for me on Firefox and Seamonkey.  Running out of cyphers. ðŸ™‚</p>
<p>Test vulnerability:<br />
<a href="https://www.ssllabs.com/ssltest/viewMyClient.html#1432491406522&#038;frame_loaded" rel="nofollow ugc">https://www.ssllabs.com/ssltest/viewMyClient.html#1432491406522&#038;frame_loaded</a></p>
<p>The fix:<br />
<a href="http://forums.mozillazine.org/viewtopic.php?p=14165963#p14165963" rel="nofollow ugc">http://forums.mozillazine.org/viewtopic.php?p=14165963#p14165963</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249478">

			<div class="comment by-fascist-nation ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.freedomsphoenix.com' rel='external nofollow ugc' class='url'>Fascist Nation</a></span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249478">
						May 24, 2015 4:50 PM					</a>

				</p>

				<p>Matthew Green&#8217;s take (good write up):<br />
<a href="http://blog.cryptographyengineering.com/2015/05/attack-of-week-logjam.html" rel="nofollow ugc">http://blog.cryptographyengineering.com/2015/05/attack-of-week-logjam.html</a></p>
<p>[link hattip jwoods @ WindowsSecrets Forum]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-249479">

			<div class="comment by-anura ">

				<p class="commentcredit">

					<span class="commenter">Anura</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249479">
						May 24, 2015 6:25 PM					</a>

				</p>

				<p>I think we need to eventually phase out TLS for a new protocol that doesn&#8217;t support export grade cryptography, and gets around the problems (like the forging of handshake messages as stated in the article above). The protocol should go something like this:</p>
<p>1) Client requests handshake and sends random authentication token (to prevent replays), which the client may sign with a certificate they send at this point<br />
2) Server responds with certificate and a message signed with that certificate containing the authentication token and the list of supported cipher suites, all of them using either DH or ECDH for key-exchange. Server may also send back a response either requesting or requiring a client certificate if it wasn&#8217;t already sent<br />
3) Client picks a cipher suite, sends an ephemeral key and the parameters that it chooses to the server, optionally signed with the client certificate (if signed, it will also include the server response)<br />
4) Server responds with a signed message containing the authentication token, the server&#8217;s ephemeral key, and the client&#8217;s message from step 3<br />
5) Client and server compute a shared secret, and derive the encryption key and (if necessary) a separate MAC key</p>
<p>This does a few things, one it means that each client has their own prime number, since there are more clients than servers, it means you can&#8217;t figure out what a popular site uses, you have to attack each client individually (which should each derive their own prime, and can change it at any time). And two, by the server signing all messages the client sent, the client can make sure none of their unsigned messages have been forged to downgrade the encryption. On top of this, the client decides the cipher suite to use, not the server. This allows security-conscious users to ensure that by keeping their browser up-to-date, they only use secure cipher suites, as opposed to giving the server the choice where it might not choose PFS or it might choose a weaker hash function or encryption algorithm.</p>
<p>This does potentially add another problem, however; if the client generates their own prime and decides to use it then the server can use that to uniquely identify them, which might not be good. The client could get around this by simply preferring ECDH or keeping a list of primes, and generating new ones in the background so they are never reused.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-249480">

			<div class="comment by-john-blommers ">

				<p class="commentcredit">

					<span class="commenter">john blommers</span> â€¢

					<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/#comment-249480">
						May 25, 2015 3:39 PM					</a>

				</p>

				<p>The academic paper is also available at <a href="https://web.archive.org/web/20150521100729/https://weakdh.org/imperfect-forward-secrecy.pdf" rel="nofollow ugc">https://web.archive.org/web/20150521100729/https://weakdh.org/imperfect-forward-secrecy.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2015/05/the_logjam_and_.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2015%2F05%2Fthe_logjam_and_.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2015/05/the_logjam_and_.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='7054' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2015/05/research_on_pat.html" rel="prev">â† Research on Patch Deployment</a>		<a href="https://www.schneier.com/blog/archives/2015/05/new_pew_researc.html" rel="next">New Pew Research Report on Americans&#039; Attitudes on Privacy, Security, and Surveillance â†’</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
