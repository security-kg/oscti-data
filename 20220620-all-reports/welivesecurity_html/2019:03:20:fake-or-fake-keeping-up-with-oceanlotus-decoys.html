<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Romain Dumont',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Fake or Fake: Keeping up with OceanLotus decoys | WeLiveSecurity</title>
<meta name="description" content="ESET researchers detail the latest tricks and techniques OceanLotus uses to deliver its backdoor while staying under the radar in Fake or Fake."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Fake or Fake: Keeping up with OceanLotus decoys | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers detail the latest tricks and techniques OceanLotus uses to deliver its backdoor while staying under the radar in Fake or Fake." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-03-20T10:28:02+00:00" />
<meta property="article:modified_time" content="2019-04-02T08:16:22+00:00" />
<meta property="og:updated_time" content="2019-04-02T08:16:22+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/03/OceanLotus_Decoys-1.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/03/OceanLotus_Decoys-1.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="627" />
<meta property="og:image:alt" content="Fake or Fake" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers detail the latest tricks and techniques OceanLotus uses to deliver its backdoor while staying under the radar in Fake or Fake." />
<meta name="twitter:title" content="Fake or Fake: Keeping up with OceanLotus decoys | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/03/OceanLotus_Decoys-1.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/03/21/analyse-des-leurres-oceanlotus/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/03/22/grupo-oceanlotus-continua-mejorando-sus-metodos-de-engano/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/03/20/oceanlotus-streut-rtf-document-malware/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/03/21/analyse-des-leurres-oceanlotus/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/03/22/grupo-oceanlotus-continua-mejorando-sus-metodos-de-engano/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/03/20/oceanlotus-streut-rtf-document-malware/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/03/21/analyse-des-leurres-oceanlotus/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/03/22/grupo-oceanlotus-continua-mejorando-sus-metodos-de-engano/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/03/20/oceanlotus-streut-rtf-document-malware/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/03/OceanLotus_Decoys.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Fake or Fake: Keeping up with OceanLotus decoys</h1>
<div class="excerpt">ESET researchers detail the latest tricks and techniques OceanLotus uses to deliver its backdoor while staying under the radar</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/romaindupont/" title="Romain Dumont">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2018/03/20180322_114641-5-222x179.jpg" alt="Romain Dumont">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/romaindupont/" title="Romain Dumont">
                    Romain Dumont                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-03-20 11:28:02">20 Mar 2019 - 11:28AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F03%2F20%2Ffake-or-fake-keeping-up-with-oceanlotus-decoys%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F03%2F20%2Ffake-or-fake-keeping-up-with-oceanlotus-decoys%2F&text=Fake or Fake: Keeping up with OceanLotus decoys%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F03%2F20%2Ffake-or-fake-keeping-up-with-oceanlotus-decoys%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers detail the latest tricks and techniques OceanLotus uses to deliver its backdoor while staying under the radar</p>
                            </div>

                            <p>This article will first describe how the OceanLotus group (also known as APT32 and APT-C-00) recently used one of the publicly available exploits for <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" target="_blank" rel="noopener">CVE-2017-11882</a>, a memory corruption vulnerability present in Microsoft Office software, and how OceanLotus malware achieves persistence on compromised systems without leaving any traces. Then the article describes how, since the beginning of 2019, the group has been leveraging self-extracting archives to run code.</p>
<h2>Context</h2>
<p>Following OceanLotus’ activities is taking a tour in the world of deception. This group is known to lure victims by forging appealing documents to entice potential victims into executing the group’s backdoor, and keeps coming up with new ideas to diversify its toolset. The techniques employed for the decoys range from files with so-called double extensions, self-extracting archives and macro-enabled documents, to reusing known exploits. On top of that, they are very active and relentlessly continue to raid their favourite victims, South East Asian countries.</p>
<h2>Summing up the Equation Editor exploit</h2>
<p>In mid-2018, OceanLotus carried out a campaign using documents abusing the weakness exposed by the CVE-2017-11882 vulnerability. Indeed, several Proofs-of-Concept were made available. The vulnerability resides in the component responsible for rendering and editing mathematical equations. One of the malicious documents used by OceanLotus was analysed by <a href="https://ti.360.net/blog/articles/oceanlotus-targets-chinese-university/" target="_blank" rel="noopener">360 Threat Intelligence Center (in Chinese)</a> and includes details about the exploit. Let’s take a look at a similar document.</p>
<h2>First stage</h2>
<p>This document FW Report on demonstration of former CNRP in Republic of Korea.doc (<span style="font-family: 'courier new', courier, monospace;">SHA-1: D1357B284C951470066AAA7A8228190B88A5C7C3</span>) is similar to the one mentioned in the article above, and also interesting as it really targets people interested in Cambodian politics (the CNRP – Cambodia National Rescue Party – political party was dissolved in late 2017). Despite its .doc extension, the document is actually in RTF format (see Figure 1), contains many garbage groups, and is also malformed.</p>
<div id="attachment_123215" style="width: 627px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/rtf_format.png"><img class="size-full wp-image-123215" src="/wp-content/uploads/2019/03/rtf_format.png" alt="" width="617" height="67" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/rtf_format.png 617w, https://www.welivesecurity.com/wp-content/uploads/2019/03/rtf_format-300x33.png 300w" sizes="(max-width: 617px) 100vw, 617px" /></a><p class="wp-caption-text">Figure 1 &#8212; RTF garbage fields</p></div>
<p>Despite the presence of malformed elements, Word successfully opens this RTF file. As seen in (Figure 2), at offset 0xC00 there is an EQNOLEFILEHDR structure, followed by the MTEF header and then an MTEF record (Figure 3) <a href="http://rtf2latex2e.sourceforge.net/MTEF3.html#FONT_record" target="_blank" rel="noopener">for a font</a>.</p>
<div id="attachment_123216" style="width: 626px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/MTEF_record.png"><img class="size-full wp-image-123216" src="/wp-content/uploads/2019/03/MTEF_record.png" alt="" width="616" height="98" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/MTEF_record.png 616w, https://www.welivesecurity.com/wp-content/uploads/2019/03/MTEF_record-300x48.png 300w" sizes="(max-width: 616px) 100vw, 616px" /></a><p class="wp-caption-text">Figure 2 &#8212; FONT record values</p></div>
<p>&nbsp;</p>
<div id="attachment_123554" style="width: 310px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/FONT.png"><img class="size-medium wp-image-123554" src="/wp-content/uploads/2019/03/FONT-300x142.png" alt="" width="300" height="142" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/FONT-300x142.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/03/FONT.png 329w" sizes="(max-width: 300px) 100vw, 300px" /></a><p class="wp-caption-text">Figure 3 &#8212; <a href="http://rtf2latex2e.sourceforge.net/MTEF3.html#FONT_record" target="_blank" rel="noopener"><span style="text-decoration: underline;">FONT record format</span></a></p></div>
<p>An overflow in the <em>name</em> field is possible because its size isn’t checked before being copied. A name that is too long triggers the vulnerability. As seen in the RTF file content (offset 0xC26 in Figure 2), the buffer is filled with shellcode followed by a NOP (0x90) sled and the return address <span style="font-family: 'courier new', courier, monospace;">0x402114</span>. That address is a gadget in <span style="font-family: 'courier new', courier, monospace;">EQNEDT32.exe</span> pointing to a <span style="font-family: 'courier new', courier, monospace;">RET</span> instruction. This results in <span style="font-family: 'courier new', courier, monospace;">EIP</span> pointing at the beginning of the <em>name</em> field which contains the shellcode.</p>
<div id="attachment_123220" style="width: 660px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/nopsled.png"><img class="size-full wp-image-123220" src="/wp-content/uploads/2019/03/nopsled.png" alt="" width="650" height="241" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/nopsled.png 650w, https://www.welivesecurity.com/wp-content/uploads/2019/03/nopsled-300x111.png 300w" sizes="(max-width: 650px) 100vw, 650px" /></a><p class="wp-caption-text">Figure 4 &#8212; Start of the exploit shellcode</p></div>
<p>The address <span style="font-family: 'courier new', courier, monospace;">0x45BD3C</span> stores a variable that is dereferenced until it reaches a pointer to the currently loaded <span style="font-family: 'courier new', courier, monospace;">MTEFData</span> structure. That is where the rest of the shellcode resides.</p>
<p>The purpose of the shellcode is to execute a second piece of shellcode, embedded inside the open document. First, the initial shellcode tries to find the handle of the open document file by iterating through all the system’s handles (<span style="font-family: 'courier new', courier, monospace;">NtQuerySystemInformation</span> with the <span style="font-family: 'courier new', courier, monospace;">SystemExtendedHandleInformation</span> argument) and checking if the handle’s <em>PID</em> matches the <em>PID</em> of a <span style="font-family: 'courier new', courier, monospace;">WinWord</span> process and if the document was opened with the following access mask: <span style="font-family: 'courier new', courier, monospace;">0x12019F</span>. To confirm it found the right handle and not the handle of another open document, the content of the file is mapped with the <span style="font-family: 'courier new', courier, monospace;">CreateFileMapping</span> function and the shellcode checks if the last four bytes of the document are &#8220;<span style="font-family: 'courier new', courier, monospace;">yyyy</span>&#8220;; this technique is called “Egg Hunting”. Once it finds a match, the document is copied to a temporary folder (<span style="font-family: 'courier new', courier, monospace;">GetTempPath</span>) as <span style="font-family: 'courier new', courier, monospace;">ole.dll</span>. Then the last 12 bytes of the document are read.</p>
<div id="attachment_123221" style="width: 627px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/last_3_dword.png"><img class="size-full wp-image-123221" src="/wp-content/uploads/2019/03/last_3_dword.png" alt="" width="617" height="33" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/last_3_dword.png 617w, https://www.welivesecurity.com/wp-content/uploads/2019/03/last_3_dword-300x16.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/03/last_3_dword-601x33.png 601w" sizes="(max-width: 617px) 100vw, 617px" /></a><p class="wp-caption-text">Figure 5 &#8212; Markers at the end of the document</p></div>
<p>The 32-bit value between the <span style="font-family: 'courier new', courier, monospace;">AABBCCDD</span> and <span style="font-family: 'courier new', courier, monospace;">yyyy</span> markers is the offset to the next shellcode. It is invoked using the <span style="font-family: 'courier new', courier, monospace;">CreateThread</span> function. The extracted shellcode is the same that the OceanLotus group has been using for a while now. The Python <a href="https://github.com/eset/malware-research/tree/master/oceanlotus/shellcode_emulator" target="_blank" rel="noopener">emulator script</a> we released in March 2018 still works to dump the next stage.</p>
<h2>Second stage</h2>
<h3>Extracting the components</h3>
<p>The filenames and directories are chosen dynamically. The code randomly selects the filename of an executable or DLL file located in <span style="font-family: 'courier new', courier, monospace;">C:\Windows\system32</span>. It will then query its resources and extract the<span style="font-family: 'courier new', courier, monospace;"> FileDescription</span> field to use as a folder name. If this does not work, the code randomly chooses a folder name from the <span style="font-family: 'courier new', courier, monospace;">%ProgramFiles%</span> or <span style="font-family: 'courier new', courier, monospace;">C:\Windows</span> (from GetWindowsDirectoryW) directories. It avoids using a name that may clash with existing files by making sure it does not contain: <span style="font-family: 'courier new', courier, monospace;">windows, Microsoft, desktop, system, system32</span> or <span style="font-family: 'courier new', courier, monospace;">syswow64</span>. If the directory already exists, the directory name is appended with &#8220;NLS_{6 digits}&#8221;.</p>
<p>The stage’s <span style="font-family: 'courier new', courier, monospace;">0x102</span> resource is parsed and the files are dropped in either <span style="font-family: 'courier new', courier, monospace;">%ProgramFiles%</span> or <span style="font-family: 'courier new', courier, monospace;">%AppData%</span> in the randomly chosen folder. The creation times are changed to have the same values as <span style="font-family: 'courier new', courier, monospace;">kernel32.dll</span>.</p>
<p>For example, here is a folder and a list of files created by picking the <span style="font-family: 'courier new', courier, monospace;">C:\Windows\system32\TCPSVCS.exe</span> executable as a source of data.</p>
<div id="attachment_123222" style="width: 630px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/dropped.png"><img class="size-full wp-image-123222" src="/wp-content/uploads/2019/03/dropped.png" alt="" width="620" height="216" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/dropped.png 620w, https://www.welivesecurity.com/wp-content/uploads/2019/03/dropped-300x105.png 300w" sizes="(max-width: 620px) 100vw, 620px" /></a><p class="wp-caption-text">Figure 6 &#8212; Extraction of the different components</p></div>
<p>The structure of the resource 0x102 in the dropper is quite complex. In a nutshell, it contains:</p>
<ul>
<li>filenames</li>
<li>files’ size and content</li>
<li>compression format (<span style="font-family: 'courier new', courier, monospace;">COMPRESSION_FORMAT_LZNT1</span> used by <span style="font-family: 'courier new', courier, monospace;">RtlDecompressBuffer</span> function)</li>
</ul>
<p>The first file is dropped as <span style="font-family: 'courier new', courier, monospace;">TCPSVCS.exe</span> which is in fact Adobe’s legitimate <span style="font-family: 'courier new', courier, monospace;">AcroTranscoder.exe</span> (according to its <span style="font-family: 'courier new', courier, monospace;">FileDescription</span>, SHA-1: <span style="font-family: 'courier new', courier, monospace;">2896738693A8F36CC7AD83EF1FA46F82F32BE5A3</span>).</p>
<p>You may have noticed that the file size of some DLLs exceeds 11MB. This is because a large contiguous buffer of random data is placed inside the executable. It is possibly a way to evade detection by some security products.</p>
<h2>Achieving persistence</h2>
<p>The resource <span style="font-family: 'courier new', courier, monospace;">0x101</span> of the dropper contains two 32-bit integers that dictate how the persistence should be implemented. The value of the first one specifies how the malware will achieve persistence without administrator privileges.</p>

<table id="tablepress-659" class="tablepress tablepress-id-659">
<thead>
<tr class="row-1 odd">
	<th class="column-1">First integer value</th><th class="column-2">Persistence mechanism</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">0</td><td class="column-2">Do not achieve persistence</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">1</td><td class="column-2">Scheduled task as current user</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">2</td><td class="column-2">(HKLM|HKCU)\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">3</td><td class="column-2">Creation of a shortcut file (with a .lnk extension) in the subdirectory Microsoft\Windows\Start Menu\Programs\Startup under one of the environment variables: %ALLUSERSPROFILE%, %APPDATA% or %USERPROFILE%</td>
</tr>
</tbody>
</table>

<p>The value of the second integer specifies how the malware should try to achieve persistence if it runs with elevated privileges.</p>

<table id="tablepress-660" class="tablepress tablepress-id-660">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Second integer value</th><th class="column-2">Persistence mechanism</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">1</td><td class="column-2">Scheduled task as administrator</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">2</td><td class="column-2">Creation of a service</td>
</tr>
</tbody>
</table>

<p>The service name is the filename without extension; the display name is the folder name but if it already exists then the string “<span style="font-family: 'courier new', courier, monospace;">Revision 1</span>” is appended (the number is incremented until it finds an unused name). The operators made sure the persistence through the service would be resilient: on service failure, the service should restart after 1 second. Then, the registry value WOW64 of the new service key is set to 4 which indicates that it’s a 32-bit service.</p>
<p>The scheduled task is created via several COM interfaces: <span style="font-family: 'courier new', courier, monospace;">ITaskScheduler</span>, <span style="font-family: 'courier new', courier, monospace;">ITask</span>, <span style="font-family: 'courier new', courier, monospace;">ITaskTrigger</span>, <span style="font-family: 'courier new', courier, monospace;">IPersistFile</span> and <span style="font-family: 'courier new', courier, monospace;">ITaskScheduler</span>. Essentially, the malware creates a hidden task, sets the account information with the current user or the administrator information and sets the trigger.<br />
This is a daily task with a duration of 24 hours and the interval between two executions is set to 10 minutes, which means it will run all the time.</p>
<h2>The malicious bit</h2>
<p>In our example, the executable <span style="font-family: 'courier new', courier, monospace;">TCPSVCS.exe</span> (<span style="font-family: 'courier new', courier, monospace;">AcroTranscoder.exe</span>) is legitimate software side-loading the DLLs that were dropped with it. In this case, the<span style="font-family: 'courier new', courier, monospace;"> Flash Video Extension.dll</span> is the interesting one.</p>
<p>Its <span style="font-family: 'courier new', courier, monospace;">DLLMain</span> function just calls a single function. Some opaque predicates are present:</p>
<div id="attachment_123223" style="width: 832px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/opaque_predicates.png"><img class="size-full wp-image-123223" src="/wp-content/uploads/2019/03/opaque_predicates.png" alt="" width="822" height="108" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/opaque_predicates.png 822w, https://www.welivesecurity.com/wp-content/uploads/2019/03/opaque_predicates-300x39.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/03/opaque_predicates-768x101.png 768w" sizes="(max-width: 822px) 100vw, 822px" /></a><p class="wp-caption-text">Figure 7 &#8212; Opaque predicates</p></div>
<p>After these deceptive checks, the code gets the <span style="font-family: 'courier new', courier, monospace;">.text</span> section of <span style="font-family: 'courier new', courier, monospace;">TCPSVCS.exe</span>, changes its protection to <span style="font-family: 'courier new', courier, monospace;">PAGE_EXECUTE_READWRITE</span> and overwrites it with do-nothing instructions that have no side effects:</p>
<div id="attachment_123224" style="width: 249px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/instructions_withoutSideEffects.png"><img class="size-full wp-image-123224" src="/wp-content/uploads/2019/03/instructions_withoutSideEffects.png" alt="" width="239" height="335" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/instructions_withoutSideEffects.png 239w, https://www.welivesecurity.com/wp-content/uploads/2019/03/instructions_withoutSideEffects-214x300.png 214w" sizes="(max-width: 239px) 100vw, 239px" /></a><p class="wp-caption-text">Figure 8 &#8212; Sequence of instructions without side effects</p></div>
<p>At the end, a <span style="font-family: 'courier new', courier, monospace;">CALL</span> instruction to the address of the function <span style="font-family: 'courier new', courier, monospace;">FLVCore</span>::<span style="font-family: 'courier new', courier, monospace;">Uninitialize(void)</span> exported by <span style="font-family: 'courier new', courier, monospace;">Flash Video Extension.dll</span> is appended. This means that, after loading the malicious DLL, when the runtime calls <span style="font-family: 'courier new', courier, monospace;">WinMain</span> in <span style="font-family: 'courier new', courier, monospace;">TCPSVCS.exe</span>, the instruction pointer will point to the NOP sled, which will eventually call <span style="font-family: 'courier new', courier, monospace;">FLVCore::Uninitialize(void)</span>, the next stage.</p>
<p>This function simply creates a mutex starting with<span style="font-family: 'courier new', courier, monospace;">{181C8480-A975-411C-AB0A-630DB8B0A221}</span>and followed by the current username. Then, it reads the dropped file with the  .db3  extension, which contains position-independent code, and uses <span style="font-family: 'courier new', courier, monospace;">CreateThread</span> to execute its content.</p>
<p>The content of the .db3 file is shellcode commonly used by OceanLotus. Again, we successfully unpacked its payload using the emulator script we published <a href="https://github.com/eset/malware-research/tree/master/oceanlotus/shellcode_emulator" target="_blank" rel="noopener">on GitHub</a>.</p>
<p>The script extracts the final stage. This component is the backdoor that we already analysed in this white paper: <a href="https://www.welivesecurity.com/wp-content/uploads/2018/03/ESET_OceanLotus.pdf" target="_blank" rel="noopener">OceanLotus: Old techniques, new backdoor</a>. It is recognizable as such from the GUID <span style="font-family: 'courier new', courier, monospace;">{A96B020F-0000-466F-A96D-A91BBF8EAC96}</span> that is present in the binary. The configuration of the malware is still encrypted in a PE resource. It contains almost the same configuration but the C&amp;C servers are different from the ones that were already published:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">andreagahuvrauvin[.]com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">byronorenstein[.]com</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">stienollmache[.]xyz</span></li>
</ul>
<p>Once again OceanLotus showcases a large combination of techniques to stay under the radar. They came back with a “better” version of the infection process. By choosing random names and filling executables with random data, they reduce the number of reliable IoCs (hash-based and filename-based). Moreover, since they’re using DLL side-loading, the attackers only have to drop the legitimate <span style="font-family: 'courier new', courier, monospace;">AcroTranscoder</span> binary as-is.</p>
<h2>Self-Extracting archives</h2>
<p>After using RTF files, the group started using self-extracting (SFX) archives that use common document icons in an attempt to further mislead their victims. It was briefly documented by <a href="https://x.threatbook.cn/nodev4/vb4/article?threatInfoID=785" target="_blank" rel="noopener">Threatbook (in Chinese)</a>. When run, these self-extracting RAR files drop and execute DLL files (with a .ocx extension) with the final payload being the previously documented <span style="font-family: 'courier new', courier, monospace;">{A96B020F-0000-466F-A96D-A91BBF8EAC96}</span>.<span style="font-family: 'courier new', courier, monospace;">dll</span>. Since the middle of January 2019, OceanLotus began reusing the technique but changed some configuration over time. This section will describe the technique and what they have altered to achieve their goal.</p>
<h2>Falling for the decoy</h2>
<p>The document <span style="font-family: 'courier new', courier, monospace;">THICH-THONG-LAC-HANH-THAP-THIEN-VIET-NAM (1).EXE</span> (meaning &#8220;FAVORITE RELATIONSHIP OF VIETNAMESE PERFORMANCE&#8221; according to Google Translate, SHA-1: <span style="font-family: 'courier new', courier, monospace;">AC10F5B1D5ECAB22B7B418D6E98FA18E32BBDEAB</span>) was first seen in 2018. This SFX file is cleverly crafted, as the description (<em>Version Info</em>) states it’s a “JPEG Image”. The script of the SFX is the following:</p>
<div id="attachment_123555" style="width: 521px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/Fig-9.png"><img class="wp-image-123555 size-full" src="/wp-content/uploads/2019/03/Fig-9.png" alt="" width="511" height="112" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/Fig-9.png 511w, https://www.welivesecurity.com/wp-content/uploads/2019/03/Fig-9-300x66.png 300w" sizes="(max-width: 511px) 100vw, 511px" /></a><p class="wp-caption-text">Figure 9 &#8212; SFX commands</p></div>
<p>The malware drops <span style="font-family: 'courier new', courier, monospace;">{9ec60ada-a200-4159-b310-8071892ed0c3}.ocx</span> (SHA-1: <span style="font-family: 'courier new', courier, monospace;">EFAC23B0E6395B1178BCF7086F72344B24C04DCC</span>) as well as the image 2018 <span style="font-family: 'courier new', courier, monospace;">thich thong lac.jpg</span>.</p>
<p>The decoy image is the following:</p>
<div id="attachment_123226" style="width: 970px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/2018-thich-thong-lac.jpg"><img class="size-full wp-image-123226" src="/wp-content/uploads/2019/03/2018-thich-thong-lac.jpg" alt="" width="960" height="540" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/2018-thich-thong-lac.jpg 960w, https://www.welivesecurity.com/wp-content/uploads/2019/03/2018-thich-thong-lac-300x169.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2019/03/2018-thich-thong-lac-768x432.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2019/03/2018-thich-thong-lac-143x79.jpg 143w" sizes="(max-width: 960px) 100vw, 960px" /></a><p class="wp-caption-text">Figure 10 &#8212; Decoy image</p></div>
<p>You may have noticed the first two lines in the SFX script invoke the OCX file twice, but it is not a mistake&#8230;</p>
<h4>{9ec60ada-a200-4159-b310-8071892ed0c3}.ocx (ShLd.dll)</h4>
<p>The OCX file’s control flow is very similar to other OceanLotus components: there are a lot of <span style="font-family: 'courier new', courier, monospace;">JZ/JNZ and PUSH/RET</span> instruction sequences interleaved with junk code.</p>
<div id="attachment_123227" style="width: 556px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/obfu.png"><img class="size-full wp-image-123227" src="/wp-content/uploads/2019/03/obfu.png" alt="" width="546" height="516" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/obfu.png 546w, https://www.welivesecurity.com/wp-content/uploads/2019/03/obfu-300x284.png 300w" sizes="(max-width: 546px) 100vw, 546px" /></a><p class="wp-caption-text">Figure 11 &#8212; Obfuscated code</p></div>
<p>After filtering the junk code, the export <span style="font-family: 'courier new', courier, monospace;">DllRegisterServer</span> called by <span style="font-family: 'courier new', courier, monospace;">regsvr32.exe</span> looks like this:</p>
<div id="attachment_123228" style="width: 586px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/flow.png"><img class="size-full wp-image-123228" src="/wp-content/uploads/2019/03/flow.png" alt="" width="576" height="667" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/flow.png 576w, https://www.welivesecurity.com/wp-content/uploads/2019/03/flow-259x300.png 259w" sizes="(max-width: 576px) 100vw, 576px" /></a><p class="wp-caption-text">Figure 12 &#8212; Main code of the installer</p></div>
<p>Basically, the first time the <span style="font-family: 'courier new', courier, monospace;">DllRegisterServer</span> is called, it sets the registry value <span style="font-family: 'courier new', courier, monospace;">HKCU\SOFTWARE\Classes\CLSID\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\Model</span> to an encoded offset in the DLL (<span style="font-family: 'courier new', courier, monospace;">0x10001DE0</span>).<br />
The second time the function is called, it reads this very same value and executes the function at that address. From there, the resource is read and executed and many in-memory operations are executed.</p>
<p>The shellcode is the same PE loader used in the earlier OceanLotus campaigns. It can be emulated with our <a href="https://github.com/eset/malware-research/tree/master/oceanlotus/shellcode_emulator" target="_blank" rel="noopener">miasm emulation script</a>. Ultimately, it drops <span style="font-family: 'courier new', courier, monospace;">db293b825dcc419ba7dc2c49fa2757ee.dll</span>, loads it into memory and executes <span style="font-family: 'courier new', courier, monospace;">DllEntry</span>.</p>
<p>The DLL retrieves the content of its resource, decrypts (AES-256-CBC) and decompresses it (LZMA). The resource has a specific format that is quite easy to reverse engineer.</p>
<div id="attachment_123229" style="width: 1088px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/db893_rsrc.png"><img class="size-full wp-image-123229" src="/wp-content/uploads/2019/03/db893_rsrc.png" alt="" width="1078" height="360" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/db893_rsrc.png 1078w, https://www.welivesecurity.com/wp-content/uploads/2019/03/db893_rsrc-300x100.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/03/db893_rsrc-768x256.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/03/db893_rsrc-1024x342.png 1024w" sizes="(max-width: 1078px) 100vw, 1078px" /></a><p class="wp-caption-text">Figure 13 &#8212; Structure of the installer configuration (KaitaiStruct Visualizer)</p></div>
<p>The configuration is explicit: depending on the privilege level, the binary data will be written to either <span style="font-family: 'courier new', courier, monospace;">%appdata%\Intel\logs\BackgroundUploadTask.cpl</span> or <span style="font-family: 'courier new', courier, monospace;">%windir%\System32\BackgroundUploadTask.cpl</span> (or <span style="font-family: 'courier new', courier, monospace;">SysWOW64</span> for 64-bit systems).<br />
Next, persistence is achieved by creating a task named <span style="font-family: 'courier new', courier, monospace;">BackgroundUploadTask[junk].job</span> where a <span style="font-family: 'courier new', courier, monospace;">[junk]</span>is a collection of <span style="font-family: 'courier new', courier, monospace;">0x9D</span> and <span style="font-family: 'courier new', courier, monospace;">0xA0</span> bytes.<br />
The application name of the task is <span style="font-family: 'courier new', courier, monospace;">%windir%\System32\control.exe</span> and the parameter value is the path of the dumped binary. The hidden task is set to run every day.</p>
<p>Structurally, the CPL file is a DLL whose internal name is <span style="font-family: 'courier new', courier, monospace;">ac8e06de0a6c4483af9837d96504127e.dll</span> and that exports a <span style="font-family: 'courier new', courier, monospace;">CPlApplet</span> function. This file decrypts its only resource <span style="font-family: 'courier new', courier, monospace;">{A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll</span>, then loads that DLL and calls its only export, <span style="font-family: 'courier new', courier, monospace;">DllEntry</span>.</p>
<h2>Backdoor configuration file</h2>
<p>The backdoor has an encrypted configuration embedded in its resources. The structure of the configuration file is quite similar to the previous one.</p>
<div id="attachment_123230" style="width: 783px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/03/backdoor_conf.png"><img class="size-full wp-image-123230" src="/wp-content/uploads/2019/03/backdoor_conf.png" alt="" width="773" height="790" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/03/backdoor_conf.png 773w, https://www.welivesecurity.com/wp-content/uploads/2019/03/backdoor_conf-294x300.png 294w, https://www.welivesecurity.com/wp-content/uploads/2019/03/backdoor_conf-768x785.png 768w" sizes="(max-width: 773px) 100vw, 773px" /></a><p class="wp-caption-text">Figure 14 &#8212; Structure of the backdoor configuration (KaitaiStruct Visualizer)</p></div>
<p>Despite the structural similarity, of the values in many of these fields have been updated comparing this to that in <a href="https://www.welivesecurity.com/wp-content/uploads/2018/03/ESET_OceanLotus.pdf" target="_blank" rel="noopener">our white paper</a> from March 2018.<br />
The first element of the binaries array contains a DLL (<span style="font-family: 'courier new', courier, monospace;">HttpProv.dll</span> MD5: <span style="font-family: 'courier new', courier, monospace;">2559738D1BD4A999126F900C7357B759</span>) <a href="https://s.tencent.com/research/report/471.html" target="_blank" rel="noopener">identified by Tencent</a> but as the export name has been removed from the binary, the hashes don&#8217;t match.</p>
<h2>Going the extra mile</h2>
<p>While hunting for samples, a few characteristics stood out. The sample just analysed appeared around July 2018 and other similar were found very recently in mid-January through early-February 2019. The infection vector used was an SFX archive dumping a legitimate, decoy document and a malicious OCX file.</p>
<p>Even though OceanLotus uses fake timestamps, it has been observed that the timestamp of the SFX and OCX files are always the same (<span style="font-family: 'courier new', courier, monospace;">0x57B0C36A</span> (08/14/2016 @ 7:15pm UTC) and <span style="font-family: 'courier new', courier, monospace;">0x498BE80F</span> (02/06/2009 @ 7:34am UTC) respectively). This probably means that they have some kind of “builder” that reuses the same templates and just changes some characteristics.</p>
<p>Among the documents we analysed since early-2018, we saw different document names suggesting country-related targeting:</p>
<ul>
<li><em>The New Contact Information Of Cambodia Media(New).xls.exe</em></li>
<li><span style="font-family: 'courier new', courier, monospace;"><em>李建香</em><em> (</em><em>个人</em><em>简历</em></span><em><span style="font-family: 'courier new', courier, monospace;">)</span>.exe</em> (fake pdf document of a CV)</li>
<li><em>feedback, Rally in USA from July 28-29, 2018.exe</em></li>
</ul>
<p>Since the discovery of the <span style="font-family: 'courier new', courier, monospace;">{A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll</span> backdoor and its public analysis by multiple researchers, we observed some changes in the malware’s configuration data.<br />
First, the authors started removing the names from the helper DLLs (<span style="font-family: 'courier new', courier, monospace;">DNSprov.dll</span> and the two versions of <span style="font-family: 'courier new', courier, monospace;">HttpProv.dll</span>).<br />
Then the operators stopped packaging the third DLL (second version of <span style="font-family: 'courier new', courier, monospace;">HttpProv.dll</span>), choosing to embed just one.</p>
<p>Second, a lot of the backdoor configuration fields have been changed, perhaps to avoid detection, since many IoCs became available.<br />
The important fields that changed are the following:</p>
<ul>
<li>the &#8220;AppX&#8221; registry key changed (see IoCs)</li>
<li>the mutex encoding string (&#8220;def&#8221;, &#8220;abc&#8221;, &#8220;ghi&#8221;)</li>
<li>the port number</li>
</ul>
<p>Finally, all the new variants analysed have new C&amp;C servers, which are listed in the IoCs section.</p>
<h2><span style="font-family: georgia, palatino, serif;">Conclusion</span></h2>
<p>OceanLotus is very active and keeps evolving. The group really focuses on varying their toolsets and decoys. They cleverly wrap their payloads with attractive documents based on current events that are likely to be of interest to their intended victims. They keep coming up with different techniques and even reuse and readapt publicly available exploit code such as for the Equation Editor exploit. Moreover, they keep improving their techniques to reduce the number of artefacts left on their victims’ machines, thereby reducing the odds of detection by security products. As we have shown, a lot of in-memory operations are involved, filenames are randomly generated and the OceanLotus operators have modified their binaries to avoid being detected. Another very interesting point is that some domain names seem to be derived from a dictionary. OceanLotus is making the extra effort to continue carrying out their campaigns, but don’t hold your breath…</p>
<h2>Indicators of Compromise (IoCs)</h2>
<p>The IoCs in this blogpost, as well as the MITRE ATT&amp;CK attributes, are also available from our <a href="https://github.com/eset/malware-ioc/tree/master/oceanlotus">GitHub repository</a>.</p>
<h3>Registry keys/values:</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">HKCU\SOFTWARE\Classes\CLSID\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\Model</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">[HKCU|HKLM]\SOFTWARE\App\</span>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">AppXbf13d4ea2945444d8b13e2121cb6b663\</span>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">Application</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">DefaultIcon</span></li>
</ul>
</li>
<li><span style="font-family: 'courier new', courier, monospace;">AppX70162486c7554f7f80f481985d67586d\</span>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">Application</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">DefaultIcon</span></li>
</ul>
</li>
<li><span style="font-family: 'courier new', courier, monospace;">AppX37cc7fdccd644b4f85f4b22d5a3f105a\</span>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">Application</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">DefaultIcon</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Mutexes:</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">{181C8480-A975-411C-AB0A-630DB8B0A221}</span>_ (+ username)</li>
</ul>

<table id="tablepress-656" class="tablepress tablepress-id-656">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Domain names</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">aliexpresscn[.]net</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">andreagahuvrauvin[.]com</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">andreagbridge[.]com</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">aol.straliaenollma[.]xyz</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">beaudrysang[.]xyz</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">becreybour[.]com</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">byronorenstein[.]com</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">chinaport[.]org</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">christienoll[.]xyz</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">christienollmache[.]xyz</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">cloud.360cn[.]info</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">dieordaunt[.]com</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">dns.chinanews[.]network</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">illagedrivestralia[.]xyz</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">karelbecker[.]com</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">karolinblair[.]com</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">lauradesnoyers[.]com</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">ntop.dieordaunt[.]com</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">office.ourkekwiciver[.]com</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">ourkekwiciver[.]com</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">sophiahoule[.]com</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">stienollmache[.]xyz</td>
</tr>
<tr class="row-24 even">
	<td class="column-1">straliaenollma[.]xyz</td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">ursulapapst[.]xyz</td>
</tr>
</tbody>
</table>

<h3>Files:</h3>

<table id="tablepress-657" class="tablepress tablepress-id-657">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Documents exploiting CVE-2017-11882:</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><b>SHA-1 hashes</b></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">D1357B284C951470066AAA7A8228190B88A5C7C3</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">49DFF13500116B6C085C5CE3DE3C233C28669678</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">9DF3F0D8525EDF2B88C4A150134C7699A85A1508</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">50A755B30E8F3646F9476080F2C3AE1347F8F556</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">BB060E5E7F7E946613A3497D58FBF026AE7C369A</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">E2D949CF06842B5F7AE6B2DFFAA49771A93A00D9</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><b>ESET detection names</b></td>
</tr>
<tr class="row-10 even">
	<td class="column-1">Win32/Exploit.CVE-2017-11882.BU</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Win32/Exploit.CVE-2017-11882.A</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">Win32/Exploit.Agent.KT</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Win32/Exploit.Agent.LT</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">Win32/Exploit.CVE-2017-11882.EI</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1"><b>SFX archives and OCX droppers:</b></td>
</tr>
<tr class="row-16 even">
	<td class="column-1"><b>SHA-1 hashes</b></td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">AC10F5B1D5ECAB22B7B418D6E98FA18E32BBDEAB</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">7642F2181CB189965C596964D2EDF8FE50DA742B</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">CD13210A142DA4BC02DA47455EB2CFE13F35804A</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">377FDC842D4A721A103C32CE8CB4DAF50B49F303</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">B4E6DDCD78884F64825FDF4710B35CDBEAABE8E2</td>
</tr>
<tr class="row-22 even">
	<td class="column-1">BD39591A02B4E403A25AAE502648264308085DED</td>
</tr>
<tr class="row-23 odd">
	<td class="column-1">B998F1B92ED6246DED13B79D069AA91C35637DEC</td>
</tr>
<tr class="row-24 even">
	<td class="column-1">CC918F0DA51794F0174437D336E6F3EDFDD3CBE4</td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">83D520E8C3FDAEFB5C8B180187B45C65590DB21A</td>
</tr>
<tr class="row-26 even">
	<td class="column-1">EFAC23B0E6395B1178BCF7086F72344B24C04DCC</td>
</tr>
<tr class="row-27 odd">
	<td class="column-1">8B991D4F2C108FD572C9C2059685FC574591E0BE</td>
</tr>
<tr class="row-28 even">
	<td class="column-1">B744878E150A2C254C867BAD610778852C66D50A</td>
</tr>
<tr class="row-29 odd">
	<td class="column-1">3DFC3D81572E16CEAAE3D07922255EB88068B91D</td>
</tr>
<tr class="row-30 even">
	<td class="column-1">77C42F66DADF5B579F6BCD0771030ADC7AEFA97C</td>
</tr>
<tr class="row-31 odd">
	<td class="column-1"><b>ESET detection names</b></td>
</tr>
<tr class="row-32 even">
	<td class="column-1">Win32/Agent.ZUR</td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-658" class="tablepress tablepress-id-658">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1193/" rel="noopener" target="_blank"><b>T1193</b></a></td><td class="column-3">Spearphishing Attachment</td><td class="column-4">Deceitful RTF documents and self-extracting archives are sent to potential victims.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="3" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank"><b>T1204</b></a></td><td class="column-3">User Execution</td><td class="column-4">The user needs to execute the self-extracting archive or open the RTF document.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1117/" rel="noopener" target="_blank"><b>T1117</b></a></td><td class="column-3">Regsvr32</td><td class="column-4">The self-extracting archives execute <code>regsvr32</code> to run the OceanLotus' backdoor.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1035/" rel="noopener" target="_blank"><b>T1035</b></a></td><td class="column-3">Service Execution</td><td class="column-4">The second stage of the exploit tries to run OceanLotus' backdoor as a service.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="3" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1050/" rel="noopener" target="_blank"><b>T1050</b></a></td><td class="column-3">New Service</td><td class="column-4">The second stage of the exploit tries to achieve persistence by creating a service.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank"><b>T1060</b></a></td><td class="column-3">Registry Run Keys / Start Folder</td><td class="column-4">The second stage of the exploit tries to achieve persistence by adding a value in the Run registry key.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank"><b>T1053</b></a></td><td class="column-3">Scheduled Task</td><td class="column-4">The second stage of the exploit tries to achieve persistence by creating a schedule task.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="5" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1009/" rel="noopener" target="_blank"><b>T1009</b></a></td><td class="column-3">Binary Padding</td><td class="column-4">The second stage of the exploit fills dropped executables with random data.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1073/" rel="noopener" target="_blank"><b>T1073</b></a></td><td class="column-3">DLL Side-Loading</td><td class="column-4">OceanLotus' backdoor is side-loaded by dropping a library and a legitimate, signed executable (AcroTranscoder).</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank"><b>T1112</b></a></td><td class="column-3">Modify Registry</td><td class="column-4">OceanLotus' backdoor stores its configuration in a registry key.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank"><b>T1027</b></a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">The second stage of the exploit drops an encrypted shellcode.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1099/" rel="noopener" target="_blank"><b>T1099</b></a></td><td class="column-3">Timestomp</td><td class="column-4">The creation time of the files dropped by the second stage of the exploit is set to match the creation time of <code>kernel32.dll</code>.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="3" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank"><b>T1083</b></a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">OceanLotus' backdoor can list files and directories.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1012/" rel="noopener" target="_blank"><b>T1012</b></a></td><td class="column-3">Query Registry</td><td class="column-4">OceanLotus' backdoor can query the Windows Registry to gather system information.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank"><b>T1082</b></a></td><td class="column-3">System Information Discovery</td><td class="column-4">OceanLotus' backdoor captures system information and sends it to its C&amp;C server.</td>
</tr>
<tr class="row-17 odd">
	<td rowspan="4" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1002/" rel="noopener" target="_blank"><b>T1002</b></a></td><td class="column-3">Data Compressed</td><td class="column-4">OceanLotus' backdoor uses LZMA compression before exfiltration.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank"><b>T1022</b></a></td><td class="column-3">Data Encrypted</td><td class="column-4">OceanLotus' backdoor uses RC4 encryption before exfiltration.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank"><b>T1041</b></a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Data exfiltration is done using the already opened channel with the C&amp;C server</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1203/" rel="noopener" target="_blank"><b>T1203</b></a></td><td class="column-3">Exploitation for Client Execution</td><td class="column-4">The RTF document includes an exploit to execute malicious code. (CVE‑2017‑11882)</td>
</tr>
<tr class="row-21 odd">
	<td rowspan="2" class="column-1">Command And Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1094/" rel="noopener" target="_blank"><b>T1094</b></a></td><td class="column-3">Custom Command and Control Protocol</td><td class="column-4">OceanLotus' backdoor can exfiltrate data by encoding it in the subdomain field of DNS packets.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1065/" rel="noopener" target="_blank"><b>T1065</b></a></td><td class="column-3">Uncommonly Used Port</td><td class="column-4">OceanLotus' backdoor use HTTP over an uncommon TCP port (14146). Port is specified in the backdoor configuration.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/romaindupont/" title="Romain Dumont">
                    Romain Dumont                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-03-20 11:28:02">20 Mar 2019 - 11:28AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Fake or Fake: Keeping up with OceanLotus decoys">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Fake or Fake: Keeping up with OceanLotus decoys">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Fake or Fake: Keeping up with OceanLotus decoys">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Fake or Fake: Keeping up with OceanLotus decoys">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F03%2F20%2Ffake-or-fake-keeping-up-with-oceanlotus-decoys%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F03%2F20%2Ffake-or-fake-keeping-up-with-oceanlotus-decoys%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F03%2F20%2Ffake-or-fake-keeping-up-with-oceanlotus-decoys%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"123214 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=123214","disqusShortname":"welivesecurity","disqusTitle":"Fake or Fake: Keeping up with OceanLotus decoys","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/03\/20\/fake-or-fake-keeping-up-with-oceanlotus-decoys\/","postId":"123214"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>