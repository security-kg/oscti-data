<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Aleksandr Matrosov',
        'ArticleCategory': 'Banking',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Caphaw attacking major European banks using webinject plugin | WeLiveSecurity</title>
<meta name="description" content="Analysis of malicious code dubbed Win32/Caphaw (a.k.a. Shylock) attacking major European banks, with ability to automatically steal money when the user is actively accessing his banking account."/>
<link rel="canonical" href="https://www.welivesecurity.com/2013/02/25/caphaw-attacking-major-european-banks-with-webinject-plugin/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Caphaw attacking major European banks using webinject plugin | WeLiveSecurity" />
<meta property="og:description" content="Analysis of malicious code dubbed Win32/Caphaw (a.k.a. Shylock) attacking major European banks, with ability to automatically steal money when the user is actively accessing his banking account." />
<meta property="og:url" content="https://www.welivesecurity.com/2013/02/25/caphaw-attacking-major-european-banks-with-webinject-plugin/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="banking" />
<meta property="article:tag" content="Malware" />
<meta property="article:tag" content="stealing" />
<meta property="article:tag" content="Trojan" />
<meta property="article:section" content="Banking" />
<meta property="article:published_time" content="2013-02-25T01:13:32+00:00" />
<meta property="article:modified_time" content="2013-09-10T09:58:10+00:00" />
<meta property="og:updated_time" content="2013-09-10T09:58:10+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2013/02/banking-trojan-code.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2013/02/banking-trojan-code.png" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="384" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Analysis of malicious code dubbed Win32/Caphaw (a.k.a. Shylock) attacking major European banks, with ability to automatically steal money when the user is actively accessing his banking account." />
<meta name="twitter:title" content="Caphaw attacking major European banks using webinject plugin | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2013/02/banking-trojan-code.png" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Caphaw attacking major European banks using webinject plugin</h1>
<div class="excerpt">Analysis of malicious code dubbed Win32/Caphaw (a.k.a. Shylock) attacking major European banks, with ability to automatically steal money when the user is actively accessing his banking account.</div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2013-02-25 01:13:32">25 Feb 2013 - 01:13AM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F02%2F25%2Fcaphaw-attacking-major-european-banks-with-webinject-plugin%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F02%2F25%2Fcaphaw-attacking-major-european-banks-with-webinject-plugin%2F&text=Caphaw attacking major European banks using webinject plugin%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F02%2F25%2Fcaphaw-attacking-major-european-banks-with-webinject-plugin%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Analysis of malicious code dubbed Win32/Caphaw (a.k.a. Shylock) attacking major European banks, with ability to automatically steal money when the user is actively accessing his banking account.</p>
                            </div>

                            <p>Malicious code dubbed Win32/Caphaw (also known as Shylock) has been attacking major European banks for more than a year (it started to spread in the fall of 2011). Caphaw caught my attention at the beginning of 2013 and I started tracking this threat closely. In this blog post I’ve collected the more interesting observations made over this time period, including the fact that this is one of the few pieces of malware that can automatically steal money when the user is actively accessing his banking account. (Earlier I published detailed analysis regarding <a title="Matrosov on Russian banking malware" href="/search/?s=russian+banks+matrosov&amp;x=0&amp;y=0" target="_blank">attacks on Russian banks</a> and cybercrime group activity in the Russian region:Carberp, Ranbyus, Hodprot, and others.)</p>
<p>The most common regions for detecting Caphaw are the United Kingdom, Italy, Denmark and Turkey. According to ESET detection statistics, the period when it was most actively spreading was during the last months of 2012. <a href="http://www.virusradar.com/en/Win32_Caphaw/map">ESET Virus Radar</a> statistics show the regions most affected by Caphaw infection during the last week.<br />
<a href="/wp-content/uploads/2013/02/capshaw-on-virusradar.png"><img class="aligncenter  wp-image-18907" title="capshaw-on-virusradar" alt="" src="/wp-content/uploads/2013/02/capshaw-on-virusradar.png" width="618" height="289" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/capshaw-on-virusradar.png 883w, https://www.welivesecurity.com/wp-content/uploads/2013/02/capshaw-on-virusradar-300x140.png 300w" sizes="(max-width: 618px) 100vw, 618px" /></a></p>
<h2>The Bot</h2>
<p><a href="http://www.virusradar.com/en/Win32_Caphaw.K/description">Win32/Caphaw</a> has functionality typical of banking malware and in this part of the blog I describe only its more interesting traits. This threat has many techniques for bypassing security software and evading automated malware samples processing. Caphaw injects its body into all running processes and has multithreading event based architecture for the execution of C&amp;C tasks. Injected malicious code can use inter-process communication (IPC) mechanisms via a named pipe.<br />
<img class="wp-image-18885 aligncenter" title="win32caphaw-trojan (2)" alt="inter-process communication (IPC) mechanisms via a named pipe" src="/wp-content/uploads/2013/02/win32caphaw-trojan-2.png" width="538" height="161" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-2.png 538w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-2-300x89.png 300w" sizes="(max-width: 538px) 100vw, 538px" /><br />
Caphaw sets many hooks for system functions and one of the most interesting intercepted functions is <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa376874(v=vs.85).aspx"><em>InitiateSystemShutdownEx()</em></a>. This hook makes it possible to control the reboot/shutdown process and makes it possible for the malware to restore itself after some antivirus cleaning procedures have been carried out.</p>
<p><img class="aligncenter size-full wp-image-18886" title="win32caphaw-trojan (3)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-3.png" width="377" height="338" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-3.png 377w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-3-300x268.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-3-87x77.png 87w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-3-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-3-85x75.png 85w" sizes="(max-width: 377px) 100vw, 377px" /></p>
<p>All string constants in the Caphaw body are encrypted by a simple custom algorithm:<br />
<a href="/wp-content/uploads/2013/02/shylock-4-5.png"><img class="wp-image-18903 aligncenter" title="shylock-4-5" alt="decomplied assembly and python" src="/wp-content/uploads/2013/02/shylock-4-5.png" width="607" height="358" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/shylock-4-5.png 867w, https://www.welivesecurity.com/wp-content/uploads/2013/02/shylock-4-5-300x177.png 300w" sizes="(max-width: 607px) 100vw, 607px" /></a></p>
<p>Caphaw provides indirect checks for execution under popular virtual machine environments (VMware, VirtualBox and VirtualPC). Caphaw detects virtual machines based on names of active processes and drivers. All those names are stored in the custom hash values by following algorithm:</p>
<p><img class="aligncenter size-full wp-image-18904" title="shylock-6-7" alt="" src="/wp-content/uploads/2013/02/shylock-6-7.png" width="611" height="254" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/shylock-6-7.png 611w, https://www.welivesecurity.com/wp-content/uploads/2013/02/shylock-6-7-300x124.png 300w" sizes="(max-width: 611px) 100vw, 611px" /></p>
<p>This is what some example code for VMware detection looks like:</p>
<p><a href="/wp-content/uploads/2013/02/win32caphaw-trojan-8.png"><img class="aligncenter size-full wp-image-18891" title="win32caphaw-trojan (8)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-8.png" width="627" height="482" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-8.png 627w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-8-300x230.png 300w" sizes="(max-width: 627px) 100vw, 627px" /></a></p>
<p>These tricks make it possible for Capshaw to bypass automated sandbox analysis. And every few hours dropper files on the C&amp;C server are repacked by a custom polymorphic cryptor service in order to bypass static detection by antivirus signature. Drive-by URLs with repacked droppers look like this list:</p>
<p><a href="/wp-content/uploads/2013/02/win32caphaw-trojan-9.png"><img class="aligncenter  wp-image-18892" title="win32caphaw-trojan (9)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-9.png" width="585" height="82" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-9.png 731w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-9-300x41.png 300w" sizes="(max-width: 585px) 100vw, 585px" /></a><br />
The URLs have the following format:</p>
<p><span style="color: #0000ff;">https://[random subdomain].[domain]/[DIR]/[DIR-random string]/[dropper file]?r=[random number]</span></p>
<p>At first glance this may look as if random numbers in URL are created by a special generation algorithm. But this is not the case, and it&#8217;s possible for the malware to use any random numbers. In Caphaw&#8217;s body the random number generation algorithm looks like this:</p>
<p><img class="aligncenter size-full wp-image-18893" title="win32caphaw-trojan (10)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-10.png" width="491" height="161" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-10.png 491w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-10-300x98.png 300w" sizes="(max-width: 491px) 100vw, 491px" /></p>
<p>The URLs for requesting additional modules, webinjects, configuration files and transfer of data to the C&amp;C are in the following format:</p>
<p><img class="aligncenter size-full wp-image-18894" title="win32caphaw-trojan (11)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-11.png" width="491" height="84" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-11.png 491w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-11-300x51.png 300w" sizes="(max-width: 491px) 100vw, 491px" /></p>
<p>Here&#8217;s an illustration of how a bot configuration file request from C&amp;C is built according to a special pattern:</p>
<p><span style="color: #0000ff;">http://[URL format]/[key]&amp;id=[bot id]&amp;inst=[master or slave]&amp;net[botnet id] &amp;cmd=cfg</span></p>
<p>A response from the C&amp;C side looks like this:</p>
<p><img class="aligncenter size-full wp-image-18895" title="win32caphaw-trojan (12)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-12.png" width="609" height="75" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-12.png 609w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-12-300x36.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-12-601x75.png 601w" sizes="(max-width: 609px) 100vw, 609px" /></p>
<p>Such responses have the following structure:</p>
<p><span style="color: #0000ff;">http:// [random subdomain].[domain]/[DIR]/[file_name.jpg]?r=[random number]</span></p>
<p>The bot configuration file is encrypted by an RC4 stream cypher. The encryption scheme has following structure: Base64(RC4(cfg_data)). After decryption the configuration file has XML code like this:</p>
<p><a href="/wp-content/uploads/2013/02/win32caphaw-trojan-13.png"><img class="aligncenter  wp-image-18896" title="win32caphaw-trojan (13)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-13.png" width="760" height="305" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-13.png 1266w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-13-300x120.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-13-1024x411.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-13-340x137.png 340w" sizes="(max-width: 760px) 100vw, 760px" /></a></p>
<p>Inside configuration file we find the name of the botnet, C&amp;C addresses and request format for downloadable plugins.</p>
<h2>Plugins</h2>
<p>Win32/Caphaw has functionality for downloading and executing additional plugins. All the downloaded plugins for the whole period where we&#8217;ve been tracking this botnet are described in the following table:</p>
<table width="640" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="127">
<p align="center"><strong>plugin name</strong></p>
</td>
<td valign="top" width="186">
<p style="text-align: center;" align="center"><strong>detection name</strong></p>
</td>
<td valign="top" width="327">
<p align="center"><strong>Description</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="127">BackSocks</td>
<td valign="top" width="186">Win32/Caphaw.N</td>
<td valign="top" width="327">back-connect proxy based on SOCKS5</td>
</tr>
<tr>
<td valign="top" width="127">ftpgrabber</td>
<td valign="top" width="186">Win32/Caphaw.N</td>
<td valign="top" width="327">collecting FTP passwords and search information in MS Outlook email’s format (.pst files)</td>
</tr>
<tr>
<td valign="top" width="127">VNC</td>
<td valign="top" width="186">Win32/Caphaw.N</td>
<td valign="top" width="327">standard VNC functionality like plugin from Zeus</td>
</tr>
<tr>
<td valign="top" width="127">DiskSpread</td>
<td valign="top" width="186">Win32/AutoRun.Caphaw.A</td>
<td valign="top" width="327">worm functionality that spreads via shared folders and removable media</td>
</tr>
<tr>
<td valign="top" width="127">MessengerSpread</td>
<td valign="top" width="186">Win32/Caphaw.M</td>
<td valign="top" width="327">worm functionality that spreads via Skype messages</td>
</tr>
<tr>
<td valign="top" width="127">Rootkit</td>
<td valign="top" width="186">Win32/Wolcape.A (driver)Win32/Wolcape.B (dropper)</td>
<td valign="top" width="327">MBR bootkit component replacing user-mode trojan by request</td>
</tr>
<tr>
<td valign="top" width="127">VideoGrabber</td>
<td valign="top" width="186">Win32/Caphaw</td>
<td valign="top" width="327">embedded plugin in main bot body for recording stream video and send to C&amp;C in rar archive</td>
</tr>
</tbody>
</table>
<p>A plugin that distributes Win32/Caphaw through Skype for the first time was tracked in January 2013 by Yurii Khvyl and Peter Kruse from CSIS (<a href="http://www.csis.dk/en/csis/blog/3811/">Shylock calling Skype</a>). The next interesting plugin is an MBR-bootkit module (detected by ESET as  <a href="http://www.virusradar.com/en/Win32_Wolcape.A/description">Win32/Wolcape.A</a>) which is downloaded to infected machines by special request from C&amp;C. This bootkit is based on MBR modification and provides manual loading for an unsigned driver. The malicious int13 handler (this interrupt reads sectors from the hard drive) in the infected MBR looks like this:</p>
<p><img class="aligncenter size-full wp-image-18897" title="win32caphaw-trojan (14)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-14.png" width="629" height="578" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-14.png 629w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-14-300x275.png 300w" sizes="(max-width: 629px) 100vw, 629px" /></p>
<p>The malicious driver is stored in the NTFS file system in the following directory:</p>
<p><img class="aligncenter size-full wp-image-18898" title="win32caphaw-trojan (15)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-15.png" width="513" height="56" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-15.png 513w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-15-300x32.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-15-500x56.png 500w" sizes="(max-width: 513px) 100vw, 513px" /></p>
<p>The driver module is encrypted by RC4 cipher with a key length 256 bytes, but originally the entropy of the key is 4 bytes due to expansion of 4-byte constant “KuKu” (this constant fills the range with 256 bytes). Here&#8217;s the call graph for the routine that loads the malicious driver :</p>
<p><a href="/wp-content/uploads/2013/02/win32caphaw-trojan-16.png"><img class="aligncenter size-full wp-image-18899" title="win32caphaw-trojan (16)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-16.png" width="408" height="185" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-16.png 408w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-16-300x136.png 300w" sizes="(max-width: 408px) 100vw, 408px" /></a></p>
<p>The malicious driver hooks typical system functions for hiding files and processes. The most interesting hooks are implemented to intercept <em>\\Driver\nsiproxy </em>and <em>\\Device\Tcp</em> objects in order to monitor/modify network traffic on an infected machine. The bootkit module configuration file has the same encryption scheme as user-mode Win32/Caphaw. The decrypted configuration file has the same XML structure as Win32/Caphaw, as presented here:<br />
<a href="/wp-content/uploads/2013/02/win32caphaw-trojan-17.png"><img class="aligncenter  wp-image-18900" title="win32caphaw-trojan (17)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-17.png" width="585" height="153" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-17.png 835w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-17-300x78.png 300w" sizes="(max-width: 585px) 100vw, 585px" /></a></p>
<h2>Webinjects and money stealing scheme</h2>
<p>Downloaded webinjects take the same form as configuration data, but the encryption algorithm is different. This first compresses with zlib in deflate mode and subsequently encrypts with the same algorithm with string encryption. Decrypted webinjects look like this:</p>
<p><a href="/wp-content/uploads/2013/02/win32caphaw-trojan-18.png"><img class="aligncenter size-full wp-image-18901" title="win32caphaw-trojan (18)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-18.png" width="428" height="276" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-18.png 428w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-18-300x193.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-18-65x42.png 65w" sizes="(max-width: 428px) 100vw, 428px" /></a></p>
<p>Here is a list of attacked banks from the latest configuration files with webinjects:</p>
<table width="540" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="200">
<p align="center"><strong>region</strong></p>
</td>
<td valign="top" width="340">
<p align="center"><strong>attacked banks</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="200">United Kingdom</td>
<td valign="top" width="340">hsbc.co.uk<br />
barclays.co.uk<br />
santander.co.uk<br />
bankofscotland.co.uk<br />
firstdirect.co.uk<br />
natwest.co.uk<br />
rbs.co.uk</td>
</tr>
<tr>
<td valign="top" width="200">Italy</td>
<td valign="top" width="340">poste.it<br />
unicredit.it<br />
cedacri.it<br />
fineco.it</td>
</tr>
</tbody>
</table>
<p>One of the interesting details in the code injected into a bank&#8217;s web page is the substitution of all phone numbers with fake numbers owned by the attacker (<a href="http://www.symantec.com/connect/blogs/merchant-malice-trojanshylock-injects-phone-numbers-online-banking-websites">Merchant of Malice: Trojan.Shylock Injects Phone Numbers into Online Banking Websites</a>). This substitution is based on a special configuration of webinjects and has a unique structure for the web page of each bank attacked.</p>
<p><a href="/wp-content/uploads/2013/02/win32caphaw-trojan-19.png"><img class="aligncenter  wp-image-18902" title="win32caphaw-trojan (19)" alt="" src="/wp-content/uploads/2013/02/win32caphaw-trojan-19.png" width="628" height="419" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-19.png 698w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-19-300x200.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-19-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-19-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2013/02/win32caphaw-trojan-19-97x65.png 97w" sizes="(max-width: 628px) 100vw, 628px" /></a></p>
<p>Win32/Caphaw is an interesting financial malware family: one of the few that has autoload functionality for automatically stealing money when the user is actively accessing his banking account. An infected user can’t recognize that his money is being stolen, because he sees fake data on the banking web page based on the webinjects&#8217; rules. (Autoloads bypass one-time password security checks.) The same functionality was tracked in the Carberp (<a href="/2012/05/24/carberp-gang-evolution-at-caro-2012/">Carberp Gang Evolution</a>), Gataka (<a href="/2012/08/13/win32gataka-banking-trojan-detailed-analysis/">Win32/Gataka banking Trojan – Detailed analysis</a>), Win32/Spy.Ranbyus (<a href="/2012/12/19/win32spy-ranbyus-modifying-java-code-in-rbs/">Win32/Spy.Ranbyus modifying Java code in RBS Ukraine systems</a>) and Tinba malware families. Just for the record, ESET antimalware does detect all of these threats.</p>
<p><em>Special thanks to my colleagues Anton Cherepanov and Yurii Khvyl (CSIS)</em></p>
<p><strong>Aleksandr Matrosov, Security Intelligence Team Lead</strong></p>
<p><strong>SHA1 hashes for analyzed samples:</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a57049a5715744109" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Win32/Wolcape.A (driver)            766da148d74f7ea9aca692246a945bd70da6cf18</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a57049a5715744109-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a57049a5715744109-1"><span class="crayon-v">Win32</span><span class="crayon-o">/</span><span class="crayon-v">Wolcape</span><span class="crayon-sy">.</span><span class="crayon-e">A</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">driver</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">766da148d74f7ea9aca692246a945bd70da6cf18</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a57049af582105993" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Win32/Wolcape.B (bootkit dropper)   f8da98763e345f42c62db02e51bf5d80342cd4d2</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a57049af582105993-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a57049af582105993-1"><span class="crayon-v">Win32</span><span class="crayon-o">/</span><span class="crayon-v">Wolcape</span><span class="crayon-sy">.</span><span class="crayon-e">B</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">bootkit </span><span class="crayon-v">dropper</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">f8da98763e345f42c62db02e51bf5d80342cd4d2</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a57049b1700811979" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Win32/Caphaw.N (VNC)                b408c56af46237d04e23f77b40c0c6367f3adee7</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a57049b1700811979-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a57049b1700811979-1"><span class="crayon-v">Win32</span><span class="crayon-o">/</span><span class="crayon-v">Caphaw</span><span class="crayon-sy">.</span><span class="crayon-e">N</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">VNC</span><span class="crayon-sy">)</span>        <span class="crayon-h"> </span>       <span class="crayon-v">b408c56af46237d04e23f77b40c0c6367f3adee7</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a57049b2223843950" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Win32/Caphaw.N (ftpgrabber)         1cc0ce07950f5b8589344977f15e2409a819efb9</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a57049b2223843950-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a57049b2223843950-1"><span class="crayon-v">Win32</span><span class="crayon-o">/</span><span class="crayon-v">Caphaw</span><span class="crayon-sy">.</span><span class="crayon-e">N</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ftpgrabber</span><span class="crayon-sy">)</span>         <span class="crayon-cn">1cc0ce07950f5b8589344977f15e2409a819efb9</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a57049b3182249512" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Win32/Caphaw.N (BackSocks)          43a6ff8c6e17e188e4650316d0627ebb110073d5</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a57049b3182249512-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a57049b3182249512-1"><span class="crayon-v">Win32</span><span class="crayon-o">/</span><span class="crayon-v">Caphaw</span><span class="crayon-sy">.</span><span class="crayon-e">N</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">BackSocks</span><span class="crayon-sy">)</span>          <span class="crayon-cn">43a6ff8c6e17e188e4650316d0627ebb110073d5</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a57049b4565603278" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Win32/Caphaw.M (MessengerSpread)    aef115814e5b6af49187d07f3068130c5c910d84</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a57049b4565603278-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a57049b4565603278-1"><span class="crayon-v">Win32</span><span class="crayon-o">/</span><span class="crayon-v">Caphaw</span><span class="crayon-sy">.</span><span class="crayon-e">M</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">MessengerSpread</span><span class="crayon-sy">)</span>    <span class="crayon-v">aef115814e5b6af49187d07f3068130c5c910d84</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581a57049b5235787739" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Win32/AutoRun.Caphaw.A (DiskSpread) 5da3dc57836c351d80653fb09a78a8a8dad87317</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581a57049b5235787739-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581a57049b5235787739-1"><span class="crayon-v">Win32</span><span class="crayon-o">/</span><span class="crayon-v">AutoRun</span><span class="crayon-sy">.</span><span class="crayon-v">Caphaw</span><span class="crayon-sy">.</span><span class="crayon-e">A</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">DiskSpread</span><span class="crayon-sy">)</span> <span class="crayon-cn">5da3dc57836c351d80653fb09a78a8a8dad87317</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2013-02-25 01:13:32">25 Feb 2013 - 01:13AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Caphaw attacking major European banks using webinject plugin">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Caphaw attacking major European banks using webinject plugin">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Caphaw attacking major European banks using webinject plugin">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Caphaw attacking major European banks using webinject plugin">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F02%2F25%2Fcaphaw-attacking-major-european-banks-with-webinject-plugin%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F02%2F25%2Fcaphaw-attacking-major-european-banks-with-webinject-plugin%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F02%2F25%2Fcaphaw-attacking-major-european-banks-with-webinject-plugin%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"18876 \/?p=18876","disqusShortname":"welivesecurity","disqusTitle":"Caphaw attacking major European banks using webinject plugin","disqusUrl":"https:\/\/www.welivesecurity.com\/2013\/02\/25\/caphaw-attacking-major-european-banks-with-webinject-plugin\/","postId":"18876"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>