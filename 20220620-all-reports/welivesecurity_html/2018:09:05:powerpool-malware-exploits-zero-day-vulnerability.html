<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Matthieu Faou',
        'ArticleCategory': 'Vulnerability',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability | WeLiveSecurity</title>
<meta name="description" content="Malware from a newly uncovered group PowerPool has been exploiting zero-day vulnerability in the wild, only two days after its disclosure. The vulnerability affects Microsoft Windows OSes from Windows 7 to Windows 10 and in particular, the ALPC function, and allows a LPE."/>
<link rel="canonical" href="https://www.welivesecurity.com/2018/09/05/powerpool-malware-exploits-zero-day-vulnerability/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability | WeLiveSecurity" />
<meta property="og:description" content="Malware from a newly uncovered group PowerPool has been exploiting zero-day vulnerability in the wild, only two days after its disclosure. The vulnerability affects Microsoft Windows OSes from Windows 7 to Windows 10 and in particular, the ALPC function, and allows a LPE." />
<meta property="og:url" content="https://www.welivesecurity.com/2018/09/05/powerpool-malware-exploits-zero-day-vulnerability/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Vulnerability" />
<meta property="article:published_time" content="2018-09-05T12:57:13+00:00" />
<meta property="article:modified_time" content="2018-09-12T06:44:44+00:00" />
<meta property="og:updated_time" content="2018-09-12T06:44:44+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/09/PowerPool_0Days.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2018/09/PowerPool_0Days.jpg" />
<meta property="og:image:width" content="1280" />
<meta property="og:image:height" content="872" />
<meta property="og:image:alt" content="PowerPool" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Malware from a newly uncovered group PowerPool has been exploiting zero-day vulnerability in the wild, only two days after its disclosure. The vulnerability affects Microsoft Windows OSes from Windows 7 to Windows 10 and in particular, the ALPC function, and allows a LPE." />
<meta name="twitter:title" content="PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2018/09/PowerPool_0Days.jpg" />
<meta name="twitter:creator" content="@matthieu_faou" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2018/09/07/malware-powerpool-explora-vulnerabilidade-zero-day-no-windows/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2018/09/06/powerpool-jour-zero-alpc-lpe/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2018/09/05/powerpool-malware-exploits-zero-day-vulnerability/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2018/09/06/malware-powerpool-explota-vulnerabilidad-zero-day-windows/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2018/09/05/powerpool-malware-windows-zero-day-exploit-durchleuchtet/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2018/09/07/malware-powerpool-explora-vulnerabilidade-zero-day-no-windows/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2018/09/06/powerpool-jour-zero-alpc-lpe/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2018/09/06/malware-powerpool-explota-vulnerabilidad-zero-day-windows/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2018/09/05/powerpool-malware-windows-zero-day-exploit-durchleuchtet/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2018/09/07/malware-powerpool-explora-vulnerabilidade-zero-day-no-windows/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2018/09/06/powerpool-jour-zero-alpc-lpe/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2018/09/06/malware-powerpool-explota-vulnerabilidad-zero-day-windows/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2018/09/05/powerpool-malware-windows-zero-day-exploit-durchleuchtet/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2018/09/PowerPool_0Days.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability</h1>
<div class="excerpt">Malware from newly uncovered group PowerPool exploits zero-day vulnerability in the wild, only two days after its disclosure</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/02/Matthieu-Faou-222x179.jpg" alt="Matthieu Faou">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2018-09-05 14:57:13">5 Sep 2018 - 02:57PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F09%2F05%2Fpowerpool-malware-exploits-zero-day-vulnerability%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F09%2F05%2Fpowerpool-malware-exploits-zero-day-vulnerability%2F&text=PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F09%2F05%2Fpowerpool-malware-exploits-zero-day-vulnerability%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Malware from newly uncovered group PowerPool exploits zero-day vulnerability in the wild, only two days after its disclosure</p>
                            </div>

                            <p><em>Update (11 September 2018): <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8440" target="_blank" rel="noopener">Microsoft has provided a patch</a> for this in today’s Windows Update.</em></p>
<p>On August 27, 2018, a so-called <em>zero-day</em> vulnerability affecting Microsoft Windows was published on GitHub and publicized via a rather acerbic tweet.</p>
<div id="attachment_116050" style="width: 593px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/09/Sandbox-Tweet-Edited.jpg"><img class="size-full wp-image-116050" src="/wp-content/uploads/2018/09/Sandbox-Tweet-Edited.jpg" alt="" width="583" height="492" /></a><p class="wp-caption-text">Source: Twitter</p></div>
<p>It seems obvious that this was not part of a coordinated vulnerability disclosure and there was no patch at the time this tweet (since deleted) was published to fix the vulnerability.</p>
<p>It affects Microsoft Windows OSes from Windows 7 to Windows 10, and in particular the Advanced Local Procedure Call (ALPC) function, and allows a Local Privilege Escalation (LPE). LPE allows an executable or process to escalate privileges. In that specific case, it allows an executable launched by a restricted user to gain administrative rights.</p>
<p>The tweet linked to a <a href="https://github.com/SandboxEscaper/randomrepo/" target="_blank" rel="noopener">GitHub repository that contains</a> Proof-of-Concept code for the exploit. Not only was a compiled version released – the source code was also. Consequently, anyone can modify and recompile the exploit, in order to &#8220;improve it&#8221;, evade detection, or even incorporate it into their code.</p>
<p>As one could have predicted, it took only two days before we first identified the use of this exploit in a malicious campaign from a group we have dubbed PowerPool. This group has a small number of victims and according to both our telemetry and uploads to VirusTotal (we only considered manual uploads from the web interface), the targeted countries include Chile, Germany, India, the Philippines, Poland, Russia, the United Kingdom, the United States and Ukraine.</p>
<h2>PowerPool arsenal</h2>
<p>This newly isolated group already has quite a range of tools at its disposal. We will provide brief analyses of some of them here.</p>
<h3>ALPC Local Privilege Escalation exploit</h3>
<p>The PowerPool developers did not reuse the binary that was provided by the vulnerability’s discloser. They modified the source code slightly and recompiled it.</p>
<p>The exploit has been documented by its original author and has been covered by <a href="https://doublepulsar.com/task-scheduler-alpc-exploit-high-level-analysis-ff08cda6ad4f" target="_blank" rel="noopener">security researchers</a> and <a href="https://www.kb.cert.org/vuls/id/906424" target="_blank" rel="noopener">CERTs</a>.</p>
<div id="attachment_116053" style="width: 1240px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/09/comments-exploit.png"><img class="size-full wp-image-116053" src="/wp-content/uploads/2018/09/comments-exploit.png" alt="" width="1230" height="235" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/09/comments-exploit.png 1230w, https://www.welivesecurity.com/wp-content/uploads/2018/09/comments-exploit-300x57.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/09/comments-exploit-768x147.png 768w, https://www.welivesecurity.com/wp-content/uploads/2018/09/comments-exploit-1024x196.png 1024w" sizes="(max-width: 1230px) 100vw, 1230px" /></a><p class="wp-caption-text">Figure 1 &#8211; Description of the exploit by its author</p></div>
<p>The flaw is in the <span style="font-family: courier new, courier, monospace;">SchRpcSetSecurity</span> API function, which does not check the user’s permissions correctly. Thus, a user can have write permissions on any file in <span style="font-family: courier new, courier, monospace;">C:\Windows\Task</span> regardless of its actual permissions. That allows a user with only read permissions to replace the content of a write-protected file.</p>
<p>As any user is able to write in <span style="font-family: courier new, courier, monospace;">C:\Windows\Task</span>, it is possible to create a file in this folder that is a hard link to any <em>target</em> file. Then, by calling the broken function <span style="font-family: courier new, courier, monospace;">SchRpcSetSecurity</span>, it is possible to gain write access to that <em>target</em> file. To create a Local Privilege Escalation, the attacker needs to choose the <em>target</em> file that will be overwritten. This needs to be done carefully: it needs to be a file that is executed automatically with administrative rights. For example, it can be a system file, or the updater of previously installed software that is regularly executed by a task. The final step is to replace the content of this protected <em>target</em> file with malicious code. Thus, at the next automatic execution, the malware will have administrative rights regardless of its original rights.</p>
<p>PowerPool’s developers chose to change the content of the file <span style="font-family: courier new, courier, monospace;">C:\Program Files (x86)\Google\Update\GoogleUpdate.exe.</span> This is the legitimate updater for Google applications and is regularly run under administrative privileges by a Microsoft Windows task.</p>
<div id="attachment_116054" style="width: 895px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/09/ida1.png"><img class="size-full wp-image-116054" src="/wp-content/uploads/2018/09/ida1.png" alt="" width="885" height="73" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/09/ida1.png 885w, https://www.welivesecurity.com/wp-content/uploads/2018/09/ida1-300x25.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/09/ida1-768x63.png 768w" sizes="(max-width: 885px) 100vw, 885px" /></a><p class="wp-caption-text">Figure 2 &#8211; Creation of a hardlink to the Google Updater</p></div>
<div id="attachment_116055" style="width: 984px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/09/ida2.png"><img class="size-full wp-image-116055" src="/wp-content/uploads/2018/09/ida2.png" alt="" width="974" height="235" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/09/ida2.png 974w, https://www.welivesecurity.com/wp-content/uploads/2018/09/ida2-300x72.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/09/ida2-768x185.png 768w" sizes="(max-width: 974px) 100vw, 974px" /></a><p class="wp-caption-text">Figure 3 &#8211; Abuse of SchRpcCreateFolder to change the permissions of the Google Updater executable</p></div>
<p>The sequence of operations shown in the figure above allows the PowerPool operators to gain write access to the executable <span style="font-family: courier new, courier, monospace;">GoogleUpdate.exe</span>. Then, they overwrite it with a copy of their second-stage malware, described below, in order to gain SYSTEM privileges the next time the updater is called.</p>
<h2>Initial compromise</h2>
<p>The PowerPool group uses different approaches to initially compromise a victim. One is to send emails with their first-stage malware as an attachment. It may be too early to say, but to date we&#8217;ve seen very few occurrences in our telemetry, so we assume that the recipients are carefully chosen rather than PowerPool running a massive spam campaign.</p>
<p>On the other hand, we know that their spams have been spotted in the past. According to a <a href="https://isc.sans.edu/forums/diary/Malware+Distributed+via+slk+Files/23687" target="_blank" rel="noopener">SANS blogpost released in May 2018</a>, they used a trick with Symbolic Link (.slk) files to distribute their malware. Microsoft Excel can load these files that update a cell and force Excel to execute PowerShell code. These .slk files seem to be distributed in spam messages too. Pivoting from the first file mentioned in the SANS blogpost (SHA-1: b2dc703d3af1d015f4d53b6dbbeb624f5ade5553), on VirusTotal, it is possible to find the related spam sample (SHA-1: e0882e234cba94b5cf3df2c05949e2e228bedd2b):</p>
<div id="attachment_116056" style="width: 1013px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/09/spam.png"><img class="size-full wp-image-116056" src="/wp-content/uploads/2018/09/spam.png" alt="" width="1003" height="652" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/09/spam.png 1003w, https://www.welivesecurity.com/wp-content/uploads/2018/09/spam-300x195.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/09/spam-768x499.png 768w, https://www.welivesecurity.com/wp-content/uploads/2018/09/spam-65x42.png 65w" sizes="(max-width: 1003px) 100vw, 1003px" /></a><p class="wp-caption-text">Figure 4 &#8211; PowerPool spam message</p></div>
<h2>Windows backdoors</h2>
<p>The PowerPool group mainly uses two different backdoors: a first-stage backdoor used just after the first compromise and then a second-stage backdoor, probably on the most interesting machines.</p>
<h3>First-stage backdoor</h3>
<p>This is basic malware used for reconnaissance on the machine. It comprises two Windows executables.</p>
<p>The first of these is the main backdoor. It establishes persistence through a service. It also creates a mutex named <span style="font-family: courier new, courier, monospace;">MyDemonMutex%d</span> where <span style="font-family: courier new, courier, monospace;">%d</span> ranges from 0 to 10. It is able to collect proxy information and the address of the C&amp;C server is hardcoded into this binary. It can execute commands and performs some basic reconnaissance of the machine, which is then exfiltrated to the C&amp;C server.</p>
<div id="attachment_116057" style="width: 754px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/09/ida-proxy.png"><img class="size-full wp-image-116057" src="/wp-content/uploads/2018/09/ida-proxy.png" alt="" width="744" height="399" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/09/ida-proxy.png 744w, https://www.welivesecurity.com/wp-content/uploads/2018/09/ida-proxy-300x161.png 300w" sizes="(max-width: 744px) 100vw, 744px" /></a><p class="wp-caption-text">Figure 5 &#8211; Gathering of proxy information</p></div>
<p>The second of these executables has a single purpose. It takes a screenshot of the victim’s display and writes it in <span style="font-family: courier new, courier, monospace;">MyScreen.jpg<span style="font-family: georgia, palatino, serif;">.</span></span> This file can then be exfiltrated by the main backdoor.</p>
<h3>Second-stage backdoor</h3>
<p>This malware is downloaded via the first stage, presumably when the operators believe the machine is interesting enough for them to stay on it for a longer time. However, it is clearly not a state-of-the-art APT backdoor.</p>
<p>Again, the C&amp;C server address is hardcoded in the binary, and has no mechanism to update this crucial configuration item. This backdoor seeks commands from <span style="font-family: courier new, courier, monospace;">http://[C&amp;C domain]/cmdpool</span> and downloads additional files from <span style="font-family: courier new, courier, monospace;">http://[C&amp;C domain]/upload</span>. These additional files are mainly the lateral-movement tools mentioned below.</p>
<p>The supported commands are:</p>
<ul>
<li>Execute a command</li>
<li>Kill a process</li>
<li>Upload a file</li>
<li>Download a file</li>
<li>List a folder</li>
</ul>
<p>They are sent in JSON format. The examples below are instructions to execute a command and to list a folder:</p>
<div id="attachment_116059" style="width: 835px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2018/09/Figure6.png"><img class="size-full wp-image-116059" src="/wp-content/uploads/2018/09/Figure6.png" alt="" width="825" height="79" srcset="https://www.welivesecurity.com/wp-content/uploads/2018/09/Figure6.png 825w, https://www.welivesecurity.com/wp-content/uploads/2018/09/Figure6-300x29.png 300w, https://www.welivesecurity.com/wp-content/uploads/2018/09/Figure6-768x74.png 768w" sizes="(max-width: 825px) 100vw, 825px" /></a><p class="wp-caption-text">Figure 6 &#8211; Examples of backdoor commands</p></div>
<h2>Lateral movement tools</h2>
<p>Once the PowerPool operators have persistent access to a machine with the second-stage backdoor, they use several open-source tools, mostly written in PowerShell, to move laterally on the network.</p>
<ul>
<li><strong><a href="https://github.com/rapid7/metasploit-framework/blob/master/data/exploits/powershell/powerdump.ps1" target="_blank" rel="noopener">PowerDump</a></strong>: This is a Metasploit module that can retrieve usernames and hashes from the Security Account Manager (SAM).</li>
<li><strong><a href="https://github.com/PowerShellMafia/PowerSploit" target="_blank" rel="noopener">PowerSploit</a></strong>: This is a post-exploitation framework in PowerShell, à la Metasploit.</li>
<li><strong><a href="https://github.com/Kevin-Robertson/Invoke-TheHash/blob/master/Invoke-SMBEnum.ps1" target="_blank" rel="noopener">SMBExec</a></strong>: A PowerShell tool to perform pass-the-hash SMB connections.</li>
<li><strong><a href="https://blog.quarkslab.com/quarks-pwdump.html" target="_blank" rel="noopener">Quarks PwDump</a></strong>: A Windows executable that can retrieve Windows credentials.</li>
<li><strong><a href="https://securityxploded.com/firemaster.php" target="_blank" rel="noopener">FireMaster</a></strong>: A Windows executable that can retrieve stored passwords from Outlook, web browsers, etc.</li>
</ul>
<h2>Conclusion</h2>
<p>The disclosure of vulnerabilities outside of a coordinated disclosure process generally puts many users at risk. In this case, even the most up-to-date version of Windows could be compromised as no patch was released when the vulnerability and exploit were published. <a href="https://www.kb.cert.org/vuls/id/906424" target="_blank" rel="noopener">The CERT-CC provides</a> some mitigations but Microsoft has not officially approved them.</p>
<p>This specific campaign targets a limited number of users, but don’t be fooled by that: it shows that cybercriminals also follow the news and work on employing exploits as soon as they are publicly available.</p>
<p><em>ESET Researchers will continue tracking any malicious usage of this new vulnerability.</em> <em>Indicators of Compromise can <a href="https://github.com/eset/malware-ioc/tree/master/powerpool" target="_blank" rel="noopener">also be found on GitHub</a>. For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com.</em></p>
<p><em>Update (11 September 2018): Microsoft has provided a <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8440">patch</a> for this in today&#8217;s Windows Update.</em></p>
<h2>Indicators of compromise</h2>
<h3>Hashes</h3>

<table id="tablepress-576" class="tablepress tablepress-id-576">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>SHA-1</strong></th><th class="column-2"><strong>Type</strong></th><th class="column-3"><strong>Detection name</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">038f75dcf1e5277565c68d57fa1f4f7b3005f3f3</td><td class="column-2">First stage backdoor</td><td class="column-3">Win32/Agent.SZS</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">247b542af23ad9c63697428c7b77348681aadc9a</td><td class="column-2">First stage backdoor</td><td class="column-3">Win32/Agent.TCH</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">0423672fe9201c325e33f296595fb70dcd81bcd9</td><td class="column-2">Second stage backdoor</td><td class="column-3">Win32/Agent.TIA</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">b4ec4837d07ff64e34947296e73732171d1c1586</td><td class="column-2">Second stage backdoor</td><td class="column-3">Win32/Agent.TIA</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">9dc173d4d4f74765b5fc1e1c9a2d188d5387beea</td><td class="column-2">ALPC LPE exploit</td><td class="column-3">Win64/Exploit.Agent.H</td>
</tr>
</tbody>
</table>


<table id="tablepress-577" class="tablepress tablepress-id-577">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Detection names</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Win32/Agent.SZS</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Win32/Agent.TCH</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Win32/Agent.TEL</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Win32/Agent.THT</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Win32/Agent.TDK</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Win32/Agent.TIA</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Win32/Agent.TID</td>
</tr>
</tbody>
</table>


<table id="tablepress-578" class="tablepress tablepress-id-578">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>C&amp;C servers</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">newsrental[.]net</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">rosbusiness[.]eu</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">afishaonline[.]eu</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">sports-collectors[.]com</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">27.102.106[.]149</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2018-09-05 14:57:13">5 Sep 2018 - 02:57PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/vulnerability/" class="category-tag-btn">Vulnerability</a>                                                <a href="https://www.welivesecurity.com/2021/03/16/google-fixes-chrome-zero-day-bug-exploited-wild/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/google-chrome-zero-day-patch.jpg"
                                                         alt="PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/16/google-fixes-chrome-zero-day-bug-exploited-wild/">
                                                    Google fixes Chrome zero-day bug exploited in the wild                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/vulnerability/" class="category-tag-btn">Vulnerability</a>                                                <a href="https://www.welivesecurity.com/2021/03/04/microsoft-fixes-four-exchange-server-zero-day-vulnerabilities/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/shutterstock_785514268-623x432.jpg"
                                                         alt="PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/04/microsoft-fixes-four-exchange-server-zero-day-vulnerabilities/">
                                                    Microsoft rushes out fixes for four zero-day flaws in Exchange Server                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/vulnerability/" class="category-tag-btn">Vulnerability</a>                                                <a href="https://www.welivesecurity.com/2021/02/15/record-breaking-number-vulnerabilities-reported-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/vulnerabilities-reports-2020-record-623x427.jpg"
                                                         alt="PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/15/record-breaking-number-vulnerabilities-reported-2020/">
                                                    Record-high number of vulnerabilities reported in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/vulnerability/" class="category-tag-btn">Vulnerability</a>                                                <a href="https://www.welivesecurity.com/2021/02/10/microsoft-patches-windows-kernel-flaw/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2020/11/Patch-tuesday-fixes-17-critical-bugs-windows-zeroday.jpg"
                                                         alt="PowerPool malware exploits ALPC LPE zero&#8209;day vulnerability">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/10/microsoft-patches-windows-kernel-flaw/">
                                                    Microsoft patches actively exploited Windows kernel flaw                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F09%2F05%2Fpowerpool-malware-exploits-zero-day-vulnerability%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F09%2F05%2Fpowerpool-malware-exploits-zero-day-vulnerability%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2018%2F09%2F05%2Fpowerpool-malware-exploits-zero-day-vulnerability%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"116049 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=116049","disqusShortname":"welivesecurity","disqusTitle":"PowerPool malware exploits ALPC LPE zero\u2011day vulnerability","disqusUrl":"https:\/\/www.welivesecurity.com\/2018\/09\/05\/powerpool-malware-exploits-zero-day-vulnerability\/","postId":"116049"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>