<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Robert Lipovsky',
        'ArticleCategory': 'Cybercrime',
        'ArticleSection': '(not set)',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Corkow: Analysis of a business&#8209;oriented banking Trojan | WeLiveSecurity</title>
<meta name="description" content="Corkow: Analysis of a business-oriented banking Trojan"/>
<link rel="canonical" href="https://www.welivesecurity.com/2014/02/27/corkow-analysis-of-a-business-oriented-banking-trojan/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Corkow: Analysis of a business&#8209;oriented banking Trojan | WeLiveSecurity" />
<meta property="og:description" content="Corkow: Analysis of a business-oriented banking Trojan" />
<meta property="og:url" content="https://www.welivesecurity.com/2014/02/27/corkow-analysis-of-a-business-oriented-banking-trojan/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="banking" />
<meta property="article:tag" content="Malware" />
<meta property="article:tag" content="Trojan" />
<meta property="article:section" content="Cybercrime" />
<meta property="article:published_time" content="2014-02-27T01:54:51+00:00" />
<meta property="article:modified_time" content="2014-03-03T13:37:53+00:00" />
<meta property="og:updated_time" content="2014-03-03T13:37:53+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2014/02/cardbank21-1024x695.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2014/02/cardbank21-1024x695.jpg" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="695" />
<meta property="og:image:alt" content="Corkow2 (Rex)" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Corkow: Analysis of a business-oriented banking Trojan" />
<meta name="twitter:title" content="Corkow: Analysis of a business&#8209;oriented banking Trojan | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2014/02/cardbank21.jpg" />
<meta name="twitter:creator" content="@Robert_Lipovsky" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Corkow: Analysis of a business&#8209;oriented banking Trojan</h1>
<div class="excerpt">Win32/Corkow is banking malware with a focus on corporate banking users. We can confirm that several thousand users, mostly in Russia and Ukraine, were victims of the Trojan in 2013. In this post, we expand on its unique functionality. </div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2014-02-27 01:54:51">27 Feb 2014 - 01:54AM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F02%2F27%2Fcorkow-analysis-of-a-business-oriented-banking-trojan%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F02%2F27%2Fcorkow-analysis-of-a-business-oriented-banking-trojan%2F&text=Corkow: Analysis of a business&#8209;oriented banking Trojan%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F02%2F27%2Fcorkow-analysis-of-a-business-oriented-banking-trojan%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Win32/Corkow is banking malware with a focus on corporate banking users. We can confirm that several thousand users, mostly in Russia and Ukraine, were victims of the Trojan in 2013. In this post, we expand on its unique functionality. </p>
                            </div>

                            <p class=" wp-image-40654 " dir="ltr">In his <a href="/2014/02/11/corkow-bitcoin-russian-banking-trojan/"> blog post</a> last week, Graham Cluley introduced the <a href="http://www.virusradar.com/en/Win32_Corkow.F/description">Win32/Corkow</a> banking Trojan. The malware, which has been in the wild since at least 2011, has demonstrated continuous activity in the past year, infecting thousands of users. Version numbering of the various <a href="http://www.virusradar.com/en/glossary/trojan-horse">Trojan</a> modules is another indicator that the malware authors are continually developing the trojan.</p>
<p dir="ltr">The most common infection vector – drive-by downloads – has been used to spread the malware.</p>
<p dir="ltr">This Russian tool for committing bank fraud shares many characteristics with other malware families with a similar purpose, such as <a href="/search/?s=ZBOT&amp;x=0&amp;y=0">Zeus</a> (also known as Zbot), <a href="/search/?s=carberp">Carberp</a>, <a href="/2013/09/04/hesperbot-a-new-advanced-banking-trojan-in-the-wild/">Hesperbot</a>, or <a href="/2013/12/18/qadars-a-banking-trojan-with-the-netherlands-in-its-sights/">Qadars</a>, for example, but also contains some unique functionality.</p>
<p dir="ltr">Several features, like enumeration of smart cards, targeting of dedicated banking applications mostly used by corporate customers and looking for user activity regarding online banking sites and applications, electronic trading platform sites and applications and so forth, all suggest that the attackers are focusing their sights on financial professionals and enterprises, whose bank accounts usually hold a higher balance than those of most individuals.</p>
<p dir="ltr">In this post, we expand on the information mentioned by Graham and provide additional technical details.</p>
<h1 dir="ltr">Analysis</h1>
<p dir="ltr">As is the case with other banking Trojans (for example<a href="/2013/09/06/hesperbot-technical-analysis-part-12/"> Win32/Spy.Hesperbot</a>), the architecture of Win32/Corkow is comprised of a main module and several plug-in modules to deliver specific functionality. Each of Corkow’s plug-in modules is implemented as a Dynamic Link Library (DLL). We will refer to the main component as the ‘core DLL’. Most of the other plugins are embedded in the core module but some are downloaded from the <a href="http://www.virusradar.com/en/glossary/command-and-control-server">C&amp;C server</a>. In either case, the core DLL will load and run these modules, injecting them into various processes in the system. Table 1 presents the different modules seen in all of the Win32/Corkow samples we have analyzed. Note that not all samples necessarily contain every module.</p>
<p>Table 1</p>
<div id="attachment_40652" style="width: 634px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/02/corkowtable1.jpg"><img class=" wp-image-40652 " alt="Table 1 - Description of analysed Win32/Corkow modules" src="/wp-content/uploads/2014/02/corkowtable1.jpg" width="624" height="344" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/02/corkowtable1.jpg 892w, https://www.welivesecurity.com/wp-content/uploads/2014/02/corkowtable1-300x165.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2014/02/corkowtable1-143x79.jpg 143w, https://www.welivesecurity.com/wp-content/uploads/2014/02/corkowtable1-298x165.jpg 298w" sizes="(max-width: 624px) 100vw, 624px" /></a><p class="wp-caption-text">Table 1 &#8211; Description of analysed Win32/Corkow modules</p></div>
<p dir="ltr" id="docs-internal-guid-7e320319-5343-cadf-26ce-281a51f0b1df">While the core DLL is responsible for launching every module and for downloading configuration data from the C&amp;C, each plug-in module contains the C&amp;C URLs as well and uploads collected data directly.</p>
<p dir="ltr">As can be seen in the table above, Win32/Corkow contains functionality that one would expect from a typical banking trojan, including keystroke logging, screenshots and <em>HTTP</em> form-grabbing for intercepting log-in credentials to online banking. However, the last three listed modules have caught our attention. The trojan uses two dedicated modules to target Russian banking clients: one for iBank2, a widely-used banking application used by several banks, and one for Sberbank, Russia’s largest bank. The module called ‘DC’ searches for indicators of user activity relating to various trading platform applications and sites, standalone banking applications, banking sites, <a href="/search/?s=Bitcoin&amp;x=0&amp;y=0">Bitcoin</a> sites, and software and Google Play developer activity. We’ll describe these modules and the core module more in-depth in the following text.</p>
<p dir="ltr">But before we get to that, let’s take a look at Corkow’s installation procedure and its ‘hardware-binding’ technique.</p>
<h2 dir="ltr">Installation</h2>
<p dir="ltr">Win32/Corkow features an interesting and relatively sophisticated installation procedure. The trojan is usually delivered to the victim by a dropper executable that contains the core DLL in its resources. When the dropper is run, the installation is carried out in the following steps:</p>
<div id="attachment_40408" style="width: 655px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/02/1lip.png"><img class=" wp-image-40408 " alt="1lip" src="/wp-content/uploads/2014/02/1lip-1024x784.png" width="645" height="494" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/02/1lip-1024x784.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2014/02/1lip-300x229.png 300w" sizes="(max-width: 645px) 100vw, 645px" /></a><p class="wp-caption-text">Figure 1 &#8211; Installation procedure of Win32/Corkow</p></div>
<ul>
<li dir="ltr">
<p dir="ltr">The dropper decrypts the embedded core DLL and calls its <em>DllMain</em> function, passing it one of three paths as a parameter. This path determines where and how the trojan should be installed. The chosen path depends on whether the trojan is being run under a standard user account or an administrator account. The possible values are listed in Table 2.</p>
</li>
<li dir="ltr">
<p dir="ltr">When the code of the core DLL is running, it will seek a host file to infect. For this, Corkow will select a legitimate DLL file from the <em>%SystemRoot%\System32</em> directory that meets certain criteria (the file has to be <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa382536%28v=vs.85%29.aspx">unprotected</a>; and some specific file names and DLL imports are excluded).</p>
</li>
<li dir="ltr">
<p dir="ltr">Corkow will then infect the selected DLL file by encrypting itself and writing its encrypted body into the resources section of the host. A decryption stub is also written to the file and added as a new export function, so that the malware’s body will be launchable after installation. The name of the export is also dependent on the installation path.</p>
</li>
<li dir="ltr">
<p dir="ltr">The infected DLL is then saved to the installation path. Note that the host DLL file in the <em>System32</em> directory remains unchanged.</p>
</li>
<li dir="ltr" style="text-align: left;">
<p dir="ltr">A Registry entry is made to ensure the malware’s persistence on the system. Again, the Registry key depends on the installation path and is listed in Table 2.</p>
<p>&nbsp;</li>
</ul>
<p><strong> Table 2 &#8211; Possible Installation Paths</strong></p>
<p>&nbsp;</p>
<p style="text-align: center;"><a href="/wp-content/uploads/2014/02/corkowtable2.jpg"><img class="aligncenter" alt="Table 2 - Possible installation paths" src="/wp-content/uploads/2014/02/corkowtable2.jpg" width="631" height="263" /></a></p>
<p><strong> </strong></p>
<p dir="ltr" id="docs-internal-guid-2001bafb-534e-33d2-c4fe-f69a3847ddd8">There are multiple ways to load a DLL and Win32/Corkow will use one of the three methods listed in the table above. Each of the methods loads a different DLL export, hence the different possible names for the decryption stub written into the host DLL during infection.</p>
<p dir="ltr">As stated above, the Corkow core DLL is written in the host DLL’s resources in an encrypted form and also compressed using aPLib, a popular compression library. The encryption used is <em>XOR</em> with the encryption <a href="http://en.wikipedia.org/wiki/Keystream">keystream</a> generated by the <a href="http://en.wikipedia.org/wiki/Multiply-with-carry">multiply-with-carry</a> algorithm and derived from the Volume Serial Number of the C:\ disk volume. This way, after installation the Corkow-infected-DLL is bound to the infected machine and will not run on a different computer. This is one way in which Corkow protects itself against malware analysis.</p>
<h2 dir="ltr">Core DLL, C&amp;C communication</h2>
<p dir="ltr">The main module of Win32/Corkow is responsible for extracting the other embedded modules and injecting them into corresponding processes, and for communication with the C&amp;C server.</p>
<p dir="ltr">Corkow contains a list of URLs to which it tries to connect. The initial<em> HTTP</em> requests sent to the server contain some basic system information, the version numbers of individual modules and a generated bot ID. In this way the key for encrypting the communication (consisting of the C&amp;C domain name and the bot ID) is established. The server will then respond with one of a few commands. The supported commands include:</p>
<ul>
<li dir="ltr">
<p dir="ltr">Reboot</p>
</li>
<li dir="ltr">
<p dir="ltr">Download and execute arbitrary executable or DLL</p>
</li>
<li dir="ltr">
<p dir="ltr">Update bot</p>
</li>
<li dir="ltr">
<p dir="ltr">Download configuration for certain modules</p>
</li>
<li dir="ltr">
<p dir="ltr">Wipe an arbitrary file on the system (by rewriting it with random data)</p>
</li>
<li dir="ltr">
<p dir="ltr">Uninstall itself, with the option of destroying the system</p>
</li>
</ul>
<p dir="ltr">The last two mentioned commands show that, apart from data theft, Win32/Corkow is also able to cause irreparable damage to the system. When the uninstall command is sent with a specific parameter, the trojan will attempt to delete critical system files and overwrite the <a href="http://www.virusradar.com/en/glossary/master-boot-record">Master Boot Record</a> and Master File Table with random data, rendering the system unbootable.</p>
<p dir="ltr">The core DLL also contains the functionality to capture screenshots of the desktop, block specific applications from running and enumerate smartcards installed on the system.</p>
<p dir="ltr">The application-blocking functionality is determined by the bot’s configuration. The trojan iterates through running processes (the standard method with <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489%28v=vs.85%29.aspx">CreateToolhelp32Snapshot</a> is used) in an infinite loop, and if the undesired process name is found, attempts to <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714%28v=vs.85%29.aspx">terminate</a> it. Of course, the chances of success for this method in User Mode are limited. It is most probably used to prevent victims from running banking applications (to check their account balances, and so forth).</p>
<p dir="ltr">Unlike other <a href="/2012/06/05/smartcard-vulnerabilities-in-modern-banking-malware/">more sophisticated trojans</a>, Corkow cannot interact with smartcards, only enumerate them. Interestingly, it doesn’t even use common Windows API functions for interacting with smartcards, but instead enumerates all hardware devices (using the <a href="http://support.microsoft.com/kb/259695">SetupDi API</a>) and searches for specific device names.</p>
<h2 dir="ltr">Targeting dedicated banking applications</h2>
<p dir="ltr">The way Corkow targets the iBank2 application is quite interesting. iBank2 is a <a href="/search/?s=Java&amp;x=0&amp;y=0">Java</a> application, so Corkow attempts to capture its data by injecting its own malicious Java class into the Java Virtual Machine running iBank2. To achieve this, the trojan first injects its IB2 module into each newly spawned Java process (<em>java.exe</em> or <em>javaw.exe</em>)</p>
<div id="attachment_40410" style="width: 491px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/02/2lip.png"><img class="size-full wp-image-40410" style="border: 2px solid black;" alt="2lip" src="/wp-content/uploads/2014/02/2lip.png" width="481" height="655" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/02/2lip.png 481w, https://www.welivesecurity.com/wp-content/uploads/2014/02/2lip-220x300.png 220w" sizes="(max-width: 481px) 100vw, 481px" /></a><p class="wp-caption-text">Figure 2 &#8211; Corkow code for attaching to a Java Virtual Machine</p></div>
<p dir="ltr">The injected code then uses Java Native Interface (JNI) functions to get the pointer to the running Java VM, attaches itself to it (Figure 2) and loads its malicious Java class inside the VM. Figure 3 shows part of the decompiled Java class. The class contains methods for getting the current balance of the victim’s bank account and making screenshots, and is able to copy key files used to authenticate the user.</p>
<div id="attachment_40411" style="width: 727px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/02/3lip.png"><img class=" wp-image-40411 " alt="3lip" src="/wp-content/uploads/2014/02/3lip-1024x563.png" width="717" height="394" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/02/3lip-1024x563.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2014/02/3lip-300x165.png 300w, https://www.welivesecurity.com/wp-content/uploads/2014/02/3lip-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2014/02/3lip-298x165.png 298w, https://www.welivesecurity.com/wp-content/uploads/2014/02/3lip.png 1162w" sizes="(max-width: 717px) 100vw, 717px" /></a><p class="wp-caption-text">Figure 3 &#8211; Corkow&#8217;s malicious Java class used against iBank2</p></div>
<p>Notice that the code supports English, Russian and Ukrainian versions of the iBank2 application.</p>
<p dir="ltr">The Java injection technique described does not exploit any vulnerability in the iBank2 application itself. Other banking trojans that have targeted the Java-based iBank2 platform include <a href="/2012/12/19/win32spy-ranbyus-modifying-java-code-in-rbs/">Win32/Spy.Ranbyus</a> and <a href="/2013/03/25/carberp-the-never-ending-story/">Win32/Carberp</a>, although different techniques were used in both those cases.</p>
<p dir="ltr">The SBRF module targets banking applications (Win32 platform) used by corporate customers of Sberbank. Like the iBank2 module, the SBRF module can create screenshots and copy key files for authentication.</p>
<h2 dir="ltr">DC module</h2>
<p dir="ltr">This module scans for user activity by searching the following:</p>
<ul>
<li dir="ltr">
<p dir="ltr">Running processes</p>
</li>
<li dir="ltr">
<p dir="ltr">Browser history – Corkow runs the 3rd party utility <a href="http://www.nirsoft.net/utils/browsing_history_view.html">BrowsingHistoryView</a> in order to read the history of Microsoft Internet Explorer, Mozilla Firefox, Google Chrome and Apple Safari. The Opera web browser history file is opened directly.</p>
</li>
<li dir="ltr">
<p dir="ltr">Installed applications – by enumerating files in common installation directories</p>
</li>
<li dir="ltr">
<p dir="ltr">Last-used applications – by enumerating the corresponding Registry entries</p>
</li>
</ul>
<p dir="ltr">Interestingly, though, the module does not send the full results of the search to the remote server. Instead it parses the data and looks for specific finance-related strings from a defined list. The analyzed sample contained strings relating to banking, electronic trading platforms and stock brokerages, digital currencies (including various Bitcoin software and websites), various payment systems, and Google Play developer activity:</p>
<div id="attachment_40656" style="width: 605px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2014/02/corkowtable3.jpg"><img class=" wp-image-40656 " alt="Table 3 - Various finance-related software and websites referred to by Corkow's DC module" src="/wp-content/uploads/2014/02/corkowtable3.jpg" width="595" height="477" srcset="https://www.welivesecurity.com/wp-content/uploads/2014/02/corkowtable3.jpg 744w, https://www.welivesecurity.com/wp-content/uploads/2014/02/corkowtable3-300x240.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2014/02/corkowtable3-222x179.jpg 222w" sizes="(max-width: 595px) 100vw, 595px" /></a><p class="wp-caption-text">Table 3 &#8211; Various finance-related software and websites referred to by Corkow&#8217;s DC module</p></div>
<p dir="ltr">Apart from Russian and Ukrainian banks and software, the list also includes a wide range of banks based in Switzerland, Singapore, Latvia, Lithuania, Estonia, Denmark, Croatia, the United Kingdom, Austria and Cyprus (including some banks that are now defunct).</p>
<p dir="ltr">The bot will then notify the attacker if any of the above-mentioned strings are found on the victim’s system.</p>
<h1 dir="ltr">Conclusion</h1>
<p dir="ltr"><a href="http://www.virusradar.com/en/Win32_Corkow.F/description">Win32/Corkow</a> is an example of the consequences of leaked source code <a href="/2013/06/26/carberp-code-leak-could-lead-to-new-wave-of-attacks/">from other banking trojans</a>. During the analysis of the Corkow code, it proved fairly easy to spot various different programming styles and parts that were written by the malware authors themselves and other parts that were literally ‘copy &amp; pasted’ from other banking trojans. While Corkow may be technically less sophisticated than some other malware that we’ve analyzed, it will get the job done.</p>
<p dir="ltr">Furthermore, the perpetrators operating the Corkow botnets apparently have a well-conceived modus operandi with a focus on corporate banking users. We can confirm that several thousand users, mostly in Russia and Ukraine, were victims of the Trojan in 2013.</p>
<p dir="ltr">We continue monitoring the threat and will keep you informed of further developments.</p>
<p dir="ltr"><strong>Thanks to Anton Cherepanov for his thorough analysis of this malware</strong>.</p>
<h1 dir="ltr">List of SHA1s</h1>
<p dir="ltr"><strong>c08b899f0cbe26057e474396b829a8c69c4bcd31</strong></p>
<p dir="ltr"><strong>5462f5b2ac221ed3f93828447c975c97e9690ef2</strong></p>
<p dir="ltr"><strong>9024e81a45156736c9d5946620ab63be510c54ed</strong></p>
<p dir="ltr"><strong>1f54b6624a1a93fe47631b7844acd2f02ab1d66a</strong></p>
<p dir="ltr"><strong>73ea52373c0478103d2194f61ea0e179b7416ab9</strong></p>
<p dir="ltr"><strong>cf0ec48d4294b8c288c4dd97e3db3967fecad554</strong></p>
<p dir="ltr"><strong>c806c8d1774341db0e9f1cf9bfc309c1ec245689</strong></p>
<p dir="ltr"><strong>4a06e4cb4838d78813306bac1cdcf982ec5c0e35</strong></p>
<p dir="ltr"><strong>1ea1fa8b917a700c2be7edb963c0b193aaae6c7a</strong></p>
<p dir="ltr"><strong>f3fbf41433757e6cbbfbe6f9c99929eeeadd5373</strong></p>
<p dir="ltr"><strong>16d75b3135803a2d60962d9677e8b91fc34b4fb7</strong></p>
<p dir="ltr"><strong>c43efc00cd459639b277690983afa6fb7abc91cc</strong></p>
<p dir="ltr"><strong>ba03301d444da65116c08f0e3f897cc91a47ed4a</strong></p>
<p dir="ltr"><strong>1cd4ec8ce834b97e1be4e215071b7cda4bb7d9c1</strong></p>
<p dir="ltr"><strong>c5eda109e125bba20a27cd52e779d1106ece7762</strong></p>
<p dir="ltr"><strong>982b06c53e37bc14d5fb7c515cbb479ad6fb1343</strong></p>
<p dir="ltr"><strong>4e78bb4e3aea2a80184d99ea2a0d36ec811655ef</strong></p>
<p dir="ltr"><strong>cc061159ef6284edc6d46cf45e756b9db1258a27</strong></p>
<p dir="ltr"><strong>b2b78353b1fbef895922c47c41f4431781a14afa</strong></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2014-02-27 01:54:51">27 Feb 2014 - 01:54AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Corkow: Analysis of a business&#8209;oriented banking Trojan">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Corkow: Analysis of a business&#8209;oriented banking Trojan">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/03/not-all-cybercriminals-are-sophisticated/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/not-all-cybercriminals-are-sophisticated-623x432.jpg"
                                                         alt="Corkow: Analysis of a business&#8209;oriented banking Trojan">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/03/not-all-cybercriminals-are-sophisticated/">
                                                    Not all cybercriminals are sophisticated                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Corkow: Analysis of a business&#8209;oriented banking Trojan">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F02%2F27%2Fcorkow-analysis-of-a-business-oriented-banking-trojan%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F02%2F27%2Fcorkow-analysis-of-a-business-oriented-banking-trojan%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2014%2F02%2F27%2Fcorkow-analysis-of-a-business-oriented-banking-trojan%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"40401 \/?p=40401","disqusShortname":"welivesecurity","disqusTitle":"Corkow: Analysis of a business\u2011oriented banking Trojan","disqusUrl":"https:\/\/www.welivesecurity.com\/2014\/02\/27\/corkow-analysis-of-a-business-oriented-banking-trojan\/","postId":"40401"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>