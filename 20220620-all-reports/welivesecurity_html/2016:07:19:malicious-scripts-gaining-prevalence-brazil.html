<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Matías Porolli',
        'ArticleCategory': 'Trojan',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Malicious scripts gaining prevalence in Brazil | WeLiveSecurity</title>
<meta name="description" content="Malicious scripts are gaining prevalence in Brazil, reports ESET&#039;s Matías Porolli."/>
<link rel="canonical" href="https://www.welivesecurity.com/2016/07/19/malicious-scripts-gaining-prevalence-brazil/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Malicious scripts gaining prevalence in Brazil | WeLiveSecurity" />
<meta property="og:description" content="Malicious scripts are gaining prevalence in Brazil, reports ESET&#039;s Matías Porolli." />
<meta property="og:url" content="https://www.welivesecurity.com/2016/07/19/malicious-scripts-gaining-prevalence-brazil/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Trojan" />
<meta property="article:published_time" content="2016-07-19T12:30:28+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2016/07/Worldgraphics.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2016/07/Worldgraphics.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="410" />
<meta property="og:image:alt" content="malicious scripts" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Malicious scripts are gaining prevalence in Brazil, reports ESET&#039;s Matías Porolli." />
<meta name="twitter:title" content="Malicious scripts gaining prevalence in Brazil | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2016/07/Worldgraphics.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Malicious scripts gaining prevalence in Brazil</h1>
<div class="excerpt">Malicious scripts are gaining prevalence in Brazil, reports ESET's Matías Porolli. </div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2015/01/matias_porolli_eset-222x179.jpg" alt="Matías Porolli">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                    Matías Porolli                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2016-07-19 14:30:28">19 Jul 2016 - 02:30PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F07%2F19%2Fmalicious-scripts-gaining-prevalence-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F07%2F19%2Fmalicious-scripts-gaining-prevalence-brazil%2F&text=Malicious scripts gaining prevalence in Brazil%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F07%2F19%2Fmalicious-scripts-gaining-prevalence-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Malicious scripts are gaining prevalence in Brazil, reports ESET&#8217;s Matías Porolli. </p>
                            </div>

                            <p>Had we looked at a map of malware detections in Brazil a year ago, we would have seen that the two main computer threats were the downloaders that installed banking trojans, and the banking trojans themselves. Today the situation remains the same, but with an extra special ingredient: while threats used to be Windows .exe files, today there are also <b>Java </b>.jar files, as well as <b>Visual Basic Script</b> and <b></b><b>JavaScript</b> among the top 10 threats.</p>
<p>To understand this change in the platforms used by cybercriminals, we will, in this article, analyze both a JavaScript and a Java threat.</p>
<p>But first, let&#8217;s take a look at the <strong>t</strong><b>op 10</b> threat detections in Brazil for the first five months of 2016. The most prevalent one is a generic detection of obfuscated scripts. Even though the final payload may vary, below we will see a connection between this kind of detection and banking trojans. Although we will not elaborate on the other nine threats in this article, it is worth noting the many <strong>d</strong><b>ifferent programming languages and platforms</b> that are being used in attacks that target Brazil today.</p>

<table id="tablepress-240" class="tablepress tablepress-id-240">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Name of the Threat</th><th class="column-2">Level of Prevalence</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">VBS/Obfuscated.G</td><td class="column-2">10.52%</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">JS/Danger.ScriptAttachment</td><td class="column-2">4.60%</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">VBS/Kryptik.FN</td><td class="column-2">3.50%</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Win32/Toptools.A</td><td class="column-2">3.09%</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">JS/TrojanDownloader.Iframe.NKE</td><td class="column-2">2.66%</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Java/TrojanDownloader.Banload.AK</td><td class="column-2">2.24%</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Java/TrojanDownloader.Banload.AE</td><td class="column-2">2.18%</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Win32/Toptools.D</td><td class="column-2">2.18%</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">JS/Adware.Agent.L</td><td class="column-2">2.09%</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">JS/Toolbar.Crossrider.G</td><td class="column-2">2.06%</td>
</tr>
</tbody>
</table>

<p>In particular, at ESET’s Latin American Malware Research Laboratory we have seen a malware campaign in which the threats are being hosted on the MEO cloud service, which is based in Portugal. In most cases, these are <b><a href="http://www.tomsguide.com/us/banking-trojan-definition,news-18457.html" target="_blank">banking trojans</a></b>. The propagation method is carried out through emails with a link to download the malware.</p>
<p>We can take one of those files as an example: Boleto_NFe_1405201421.PDF.js, detected by ESET as<em> VBS/Obfuscated.G</em>.</p>
<p>Although the script code is obfuscated, the encryption used is easy to reverse. Even without decrypting, we can see that a file <b>disguised as a .</b><b>jpg</b><b> file</b> is downloaded to the ProgramData folder under the name flashplayer.exe, which is then executed.</p>
<p><img class="aligncenter size-full wp-image-81491" src="/wp-content/uploads/2016/07/01-scriptjsofus.jpg" alt="[01] scriptjsofus" width="728" height="781" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/01-scriptjsofus.jpg 728w, https://www.welivesecurity.com/wp-content/uploads/2016/07/01-scriptjsofus-280x300.jpg 280w" sizes="(max-width: 728px) 100vw, 728px" /></p>
<p>This file – flashplayer.exe – is, in turn, a banking trojan downloader, which downloads and runs a third executable named Edge.exe. This executable is detected as a <em>Win32/Spy.KeyLogger.NDW</em> variant; however, apart from recording the keystroke events, it has all the functionalities of a <b>banker</b>. Among its many features, it obtains the address of the website the user is visiting and checks it against a list of banking websites, using <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms648774%28v=vs.85%29.aspx" target="_blank">DDE</a>, as we described in the article <a href="/la-es/2016/02/02/como-reconstruir-toyano-sistema-infectado/" target="_blank">Cómo reconstruir lo que envía un troyano desde un sistema infectado</a> (How to rebuild what a trojan sends from an infected system).</p>
<p>The difference is that, this time, the trojan includes code for a larger number of browsers including:</p>
<p><img class="aligncenter size-full wp-image-81492" src="/wp-content/uploads/2016/07/02-codigonavegadores.jpg" alt="[02] codigonavegadores" width="524" height="846" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/02-codigonavegadores.jpg 524w, https://www.welivesecurity.com/wp-content/uploads/2016/07/02-codigonavegadores-186x300.jpg 186w" sizes="(max-width: 524px) 100vw, 524px" /></p>
<p>The strings are encrypted with a custom XOR-based algorithm. some of them can be seen below. It is clearly trying to <b>steal access credentials </b>to Brazilian banking sites.<br />
<img class="aligncenter wp-image-81569" src="/wp-content/uploads/2016/07/Untitled.png" alt="Untitled" width="751" height="523" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/Untitled.png 921w, https://www.welivesecurity.com/wp-content/uploads/2016/07/Untitled-300x209.png 300w, https://www.welivesecurity.com/wp-content/uploads/2016/07/Untitled-768x535.png 768w" sizes="(max-width: 751px) 100vw, 751px" /></p>
<p>We can see how cybercrime is evolving in Brazil, migrating to new platforms and using various programming languages in its attempt to evade detection. Its goals, however, have not changed that much – stealing banking credentials is still the most profitable form of attack and is, therefore, the most common one.</p>
<p>Now, while examining the cloud services used to host the JavaScript malware, we found that they were also hosting other computer threats found in <b>Brazil&#8217;s Top 10</b>. In particular, we have found a lot of activity related to malicious files that are detected by ESET as <em>Java/TrojanDownloader.Banload.AK</em>.</p>
<p>These files are .jar executables, with names such as <i>Boleto_Cobranca</i>, <i>Pedido_Atualizacao</i>, or <i>Imprimir_Debitos</i>. Once decompiled, we get obfuscated code with extremely long variable names and methods:</p>
<p><img class="aligncenter size-full wp-image-81493" src="/wp-content/uploads/2016/07/03-codigoofuscado.jpg" alt="[03] codigoofuscado" width="496" height="587" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/03-codigoofuscado.jpg 496w, https://www.welivesecurity.com/wp-content/uploads/2016/07/03-codigoofuscado-253x300.jpg 253w" sizes="(max-width: 496px) 100vw, 496px" /></p>
<p>Despite this obfuscation, we can see some of the imports in the image. The last five imported classes have to do with <b>encryption</b>, since they use the <b>DES </b>symmetric algorithm. Thus, if we are able to identify the decryption methods, and replace the names of those methods and variables with more representative ones, we will have something like this (comments have also been added):</p>
<p><img class="aligncenter size-full wp-image-81494" src="/wp-content/uploads/2016/07/04-descifradoDES.jpg" alt="[04] descifradoDES" width="735" height="604" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/04-descifradoDES.jpg 735w, https://www.welivesecurity.com/wp-content/uploads/2016/07/04-descifradoDES-300x247.jpg 300w" sizes="(max-width: 735px) 100vw, 735px" /></p>
<p>The key used for decryption is the Java class name. Therefore, if we adapt the code in<em> main</em>, we can make the malware <b>decrypt all its strings</b> for us. In fact, we can parse the main class to search for these strings, and then pass this list to our modified code to carry out the decryption process.</p>
<p>Finally, we will see some encrypted and decrypted strings:</p>
<p><img class="aligncenter size-full wp-image-81495" src="/wp-content/uploads/2016/07/05-stringsDescifradasJava.jpg" alt="[05] stringsDescifradasJava" width="651" height="601" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/05-stringsDescifradasJava.jpg 651w, https://www.welivesecurity.com/wp-content/uploads/2016/07/05-stringsDescifradasJava-300x277.jpg 300w" sizes="(max-width: 651px) 100vw, 651px" /></p>
<p>We have underlined the server&#8217;s IP address contacted by the malware. Note that the C&amp;C server varies in the different samples we have analyzed. A <b>Visual Basic Script</b> file is then created, executed by cscript.exe.</p>
<p>It is worth noting that the analyzed files also have more features, which can be found in the other <i>imports</i>. One of the most interesting features of the malware is its ability to detect virtualized environments, after which it would self-terminate. Some other functions <b>download files from the internet</b>, as can also be seen in the rest of the <i>imports</i>:</p>
<p><img class="aligncenter size-full wp-image-81496" src="/wp-content/uploads/2016/07/06-importsjava.jpg" alt="[06] importsjava" width="373" height="416" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/06-importsjava.jpg 373w, https://www.welivesecurity.com/wp-content/uploads/2016/07/06-importsjava-269x300.jpg 269w" sizes="(max-width: 373px) 100vw, 373px" /></p>
<p>Although the diversity of languages and platforms used in the malware attacks in Brazil is remarkable, the objectives of cybercriminals and their propagation methods remain the same.</p>
<p>The two downloaders analyzed so far were being hosted by a Portugal-based cloud service. We found, however, a third downloader, hosted on a different file-sharing service. The latter is a Visual Basic script, which shows us the diversity of languages and platforms used in malware attacks in Brazil.</p>
<p>All these threats use the same propagation method – fraudulent emails purporting to be from banks. Once we download the .vbs file, we can see that it is obfuscated:</p>
<p><img class="aligncenter size-full wp-image-81497" src="/wp-content/uploads/2016/07/07-vbs_ofuscado.jpg" alt="[07] vbs_ofuscado" width="830" height="555" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/07-vbs_ofuscado.jpg 830w, https://www.welivesecurity.com/wp-content/uploads/2016/07/07-vbs_ofuscado-300x201.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2016/07/07-vbs_ofuscado-768x514.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2016/07/07-vbs_ofuscado-65x42.jpg 65w, https://www.welivesecurity.com/wp-content/uploads/2016/07/07-vbs_ofuscado-114x76.jpg 114w, https://www.welivesecurity.com/wp-content/uploads/2016/07/07-vbs_ofuscado-97x65.jpg 97w" sizes="(max-width: 830px) 100vw, 830px" /></p>
<p>The hex-encoded, <strong>XOR-obfuscated</strong> main routine of this script can easily be restored to its original code in <em>Visual Basic Script</em>. That code downloads a password-protected archive that is then extracted with another application, also downloaded by the malware: 7za.exe. While not in itself malicious, it is used to obtain an executable from the downloaded .zip file, which is then run by the script:</p>
<p><img class="aligncenter size-full wp-image-81498" src="/wp-content/uploads/2016/07/08-vbs_desofuscado.jpg" alt="[08] vbs_desofuscado" width="738" height="928" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/08-vbs_desofuscado.jpg 738w, https://www.welivesecurity.com/wp-content/uploads/2016/07/08-vbs_desofuscado-239x300.jpg 239w" sizes="(max-width: 738px) 100vw, 738px" /></p>
<p>The Portuguese comment “<em>link do seu do modulo</em>“ in the excerpt of the original code, above, can be translated as &#8220;<em>link to your module&#8221;</em>. Then the word <em>you</em><em>r</em> caught our attention, making us think that the script was created with a script generator, or that the code was copied from some example code from elsewhere, since it does not say <em>m</em><em>y</em> module.</p>
<p>Regarding the file that was extracted and executed by the script, ESET detects it as a variant of <em>Win32/Packed.Autoit.R</em>, introducing yet another programming language. The executable, generated from an <em>AutoIt</em> script, has no purpose other than to <strong>inject a banking trojan</strong> into memory. First, a process is created in a suspended state; then its image is replaced in memory by the malware; and finally, its execution is resumed (this technique is known as RunPE).</p>
<p>The injected executable is detected by ESET as <em>Win32/Spy.Banker.ACSJ</em>, a banking trojan written in Delphi (which we typically see in Brazil). It has encrypted strings that use the same custom algorithm for decryption as the banker we mentioned earlier (the one installed by the JavaScript downloader).</p>
<p>Although we will not discuss the details of this banking trojan in this article, it is worth mentioning that it does not use DDE, as did the banker installed by the <em>JavaScript</em> threat. Instead, it imports functions from <a href="https://msdn.microsoft.com/en-us/library/ms923851.aspx" target="_blank">oleaut32.dll</a>, so as to automate malicious tasks whenever it detects that the victim is browsing certain banking websites using Internet Explorer. When the victim browses a targeted site, this banking trojan loads fake forms with images that are very similar to the ones used in legitimate sites, with the purpose of harvesting banking credentials and account information.</p>
<p><img class="aligncenter size-full wp-image-81499" src="/wp-content/uploads/2016/07/09-bancos.png" alt="[09] bancos" width="751" height="1008" srcset="https://www.welivesecurity.com/wp-content/uploads/2016/07/09-bancos.png 751w, https://www.welivesecurity.com/wp-content/uploads/2016/07/09-bancos-224x300.png 224w" sizes="(max-width: 751px) 100vw, 751px" /></p>
<p>We have been able to associate threats in multiple programming languages or platforms with the same campaign. It is amazing how many different techniques and resources cybercriminals are using to propagate their threats in Brazil. And even though the final stage in these attacks is still a banking trojan written in Delphi &#8211; the most common malware attack scenario seen in recent years in Brazil &#8211; we have now started to see that <strong>its code is being updated</strong> to keep up with the new security measures implemented by Brazilian banks.</p>
<h2>Analyzed Samples</h2>

<table id="tablepress-241" class="tablepress tablepress-id-241">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">File Name</th><th class="column-3">Detection Name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">8ceaae91d20c9d1aa1fbd579fcfda6ecfdef8070</td><td class="column-2">Boleto_NFe_1405201421.PDF.js</td><td class="column-3">VBS/Obfuscated.G</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">016bd00717c69f85f003cbffb4ebc240189893ad</td><td class="column-2">flashplayer.exe</td><td class="column-3">Win32/TrojanDownloader.Banload.XGT</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">c4c4f2a12ed69b95520e5d824854d12c8c4f80ab</td><td class="column-2">Edge.exe</td><td class="column-3">Win32/Spy.KeyLogger.NDW variant</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">2c8385fbe7c4a57345bf72205a7c963f9f781900</td><td class="column-2">Imprimir_Debitos9874414541555.jar</td><td class="column-3">Java/TrojanDownloader.Banload.AK</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">363f04edd57087f9916bdbf502a2e8f1874f292c</td><td class="column-2">Atualizacao_de_Boleto_Vencido_10155455096293504.jar</td><td class="column-3">Java/TrojanDownloader.Banload.AK</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">8b50c2b5bb4fad5a0049610efc980296af43ddcd</td><td class="column-2">LU 1.jar</td><td class="column-3">Java/TrojanDownloader.Banload.AK</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">d588a69a231aeb695bbc8ebc4285ca0490963685</td><td class="column-2">Comprovante Deposito-Acordo N7656576l (3) (4) (4).vbs</td><td class="column-3">VBS/TrojanDownloader.Agent.OGG</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">dde2af50498d30844f151b76cb6e39fc936534a7</td><td class="column-2">7b0gct262q.exe</td><td class="column-3">Win32/Packed.Autoit.R</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">256ad491d9d011c7d51105da77bf57e55c47f977</td><td class="column-2"></td><td class="column-3">Win32/Spy.Banker.ACSJ</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                    Matías Porolli                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2016-07-19 14:30:28">19 Jul 2016 - 02:30PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2018/11/09/emotet-launches-major-new-spam-campaign/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/11/Emotet_Spam-623x432.jpg"
                                                         alt="Malicious scripts gaining prevalence in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/11/09/emotet-launches-major-new-spam-campaign/">
                                                    Emotet launches major new spam campaign                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/trojan/" class="category-tag-btn">Trojan</a>                                                <a href="https://www.welivesecurity.com/2018/09/21/danabot-targeting-europe-adds-new-features/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/09/DanaBot_Trojan-623x432.jpg"
                                                         alt="Malicious scripts gaining prevalence in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/09/21/danabot-targeting-europe-adds-new-features/">
                                                    DanaBot shifts its targeting to Europe, adds new features                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/trojan/" class="category-tag-btn">Trojan</a>                                                <a href="https://www.welivesecurity.com/2017/09/25/banking-trojan-returns-google-play/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2017/09/onlinebanking_trojan-623x432.jpg"
                                                         alt="Malicious scripts gaining prevalence in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2017/09/25/banking-trojan-returns-google-play/">
                                                    BankBot trojan returns to Google Play with new tricks                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2017/04/06/sathurbot-distributed-wordpress-password-attack/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2017/04/sathurbot-623x427.jpg"
                                                         alt="Malicious scripts gaining prevalence in Brazil">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2017/04/06/sathurbot-distributed-wordpress-password-attack/">
                                                    Sathurbot: Distributed WordPress password attack                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F07%2F19%2Fmalicious-scripts-gaining-prevalence-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F07%2F19%2Fmalicious-scripts-gaining-prevalence-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2016%2F07%2F19%2Fmalicious-scripts-gaining-prevalence-brazil%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"81567 \/?p=81567","disqusShortname":"welivesecurity","disqusTitle":"Malicious scripts gaining prevalence in Brazil","disqusUrl":"https:\/\/www.welivesecurity.com\/2016\/07\/19\/malicious-scripts-gaining-prevalence-brazil\/","postId":"81567"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-240').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
$('#tablepress-241').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>