<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Jean-Ian Boutin',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Gamaredon group grows its game | WeLiveSecurity</title>
<meta name="description" content="ESET research discovers several previously undocumented post-compromise tools used by the highly active Gamaredon APT group in various malicious campaigns."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/06/11/gamaredon-group-grows-its-game/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Gamaredon group grows its game | WeLiveSecurity" />
<meta property="og:description" content="ESET research discovers several previously undocumented post-compromise tools used by the highly active Gamaredon APT group in various malicious campaigns." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/06/11/gamaredon-group-grows-its-game/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:author" content="https://www.facebook.com/jiboutin" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-06-11T09:30:52+00:00" />
<meta property="article:modified_time" content="2020-06-11T10:25:41+00:00" />
<meta property="og:updated_time" content="2020-06-11T10:25:41+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/06/Gamaredon-group-grows-its-game-2.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/06/Gamaredon-group-grows-its-game-2.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="674" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET research discovers several previously undocumented post-compromise tools used by the highly active Gamaredon APT group in various malicious campaigns." />
<meta name="twitter:title" content="Gamaredon group grows its game | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/06/Gamaredon-group-grows-its-game-2.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2020/06/16/gamaredon-usa-macros-do-outlook-para-distribuir-malware/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2020/06/12/gamaredon-prochain-niveau/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/06/11/gamaredon-group-grows-its-game/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/06/16/grupo-apt-gamaredon-utiliza-macros-outlook-distribuir-malware/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/06/11/gamaredon-gruppe-vba-makros-gegen-outlook/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2020/06/16/gamaredon-usa-macros-do-outlook-para-distribuir-malware/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/06/12/gamaredon-prochain-niveau/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/06/16/grupo-apt-gamaredon-utiliza-macros-outlook-distribuir-malware/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/06/11/gamaredon-gruppe-vba-makros-gegen-outlook/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2020/06/16/gamaredon-usa-macros-do-outlook-para-distribuir-malware/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/06/12/gamaredon-prochain-niveau/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/06/16/grupo-apt-gamaredon-utiliza-macros-outlook-distribuir-malware/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/06/11/gamaredon-gruppe-vba-makros-gegen-outlook/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/06/Gamaredon-group-grows-its-game-1.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Gamaredon group grows its game</h1>
<div class="excerpt">Active APT group adds cunning remote template injectors for Word and Excel documents; unique Outlook mass-mailing macro</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/boutin/" title="Jean-Ian Boutin">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/01/jean-ianboutin-222x179.jpg" alt="Jean-Ian Boutin">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/boutin/" title="Jean-Ian Boutin">
                    Jean-Ian Boutin                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-06-11 11:30:52">11 Jun 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F06%2F11%2Fgamaredon-group-grows-its-game%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F06%2F11%2Fgamaredon-group-grows-its-game%2F&text=Gamaredon group grows its game%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F06%2F11%2Fgamaredon-group-grows-its-game%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Active APT group adds cunning remote template injectors for Word and Excel documents; unique Outlook mass-mailing macro</p>
                            </div>

                            <p>ESET researchers have discovered several previously undocumented post-compromise tools used by the highly active Gamaredon threat group in various malicious campaigns. One tool, a VBA macro targeting Microsoft Outlook, uses the target’s email account to send spearphishing emails to contacts in the victim’s Microsoft Office address book. We also analyzed further Gamaredon tools that have the ability to inject malicious macros and remote templates into existing Office documents.</p>
<div class="update-block"></p>
<p><em>Tools linked to Gamaredon and discussed in this blogpost are detected as variants of MSIL/Pterodo, Win32/Pterodo or Win64/Pterodo by ESET’s products.</em></p>
<p></div>
<p>The Gamaredon group has been active since at least 2013. It has been responsible for a number of attacks, mostly against Ukrainian institutions, as evidenced in <a href="https://cert.gov.ua/news/42" target="_blank" rel="noopener">several reports</a> from <a href="https://cert.gov.ua/news/46" target="_blank" rel="noopener">CERT-UA</a> and from other official Ukrainian bodies over time.</p>
<p>In the last few months, there has been an increase in activity from this group, with constant waves of malicious emails hitting their targets’ mailboxes. The attachments to these emails are documents with malicious macros that, when executed, try to download a multitude of different malware variants.</p>
<p>Gamaredon has leveraged many different programming languages in the past few months, ranging from C# to VBScript, batch files and C/C++. The tools used by Gamaredon are very simple and are designed to gather sensitive information from compromised systems and to spread further.</p>
<p>Contrary to other APT groups, the Gamaredon group seems to make no effort in trying to stay under the radar. Even though their tools have the capacity to download and execute arbitrary binaries that could be far stealthier, it seems that this group’s main focus is to spread as far and fast as possible in their target’s network while trying to exfiltrate data. Could we be missing something?</p>
<h2>Background</h2>
<p>Figure 1 illustrates a typical compromise chain in a Gamaredon campaign.</p>
<div id="attachment_139403" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-1.png"><img class="wp-image-139403" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-1-150x150.png" alt="" width="750" height="140" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-1-300x56.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-1-768x143.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-1-1024x190.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-1.png 1500w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 1. Typical Gamaredon compromise chain</i></p></div>
<p>While most of the recent publications have focused on the spearphishing emails together with the downloaders they contain, this blogpost focuses on the post-compromise tools deployed on these systems.</p>
<h2>Outlook VBA module</h2>
<p>The Gamaredon group uses a package that includes a custom Microsoft Outlook Visual Basic for Applications (VBA) project. Using Outlook macros to deliver malware is something we rarely see while investigating malicious campaigns.</p>
<p>This bundle of malicious code starts out with a VBScript that first kills the Outlook process if it is running, and then removes security around VBA macro execution in Outlook by changing registry values. It also saves to disk the malicious OTM file (Outlook VBA project) that contains a macro, the malicious email attachment and, in some cases, a list of recipients that the emails should be sent to.</p>
<p>Next, it relaunches Outlook with a special option, <span style="font-family: courier new, courier, monospace;">/altvba &lt;OTM filename&gt;</span>, which loads the Gamaredon VBA project. The malicious code is executed once the Application.Startup <a href="https://docs.microsoft.com/en-us/office/vba/api/outlook.application.startup" target="_blank" rel="noopener">event</a> is received. They have been using this module in three different ways to send malicious email to:</p>
<ul>
<li>Everyone in the victim’s address book</li>
<li>Everyone within the same organization</li>
<li>A predefined list of targets</li>
</ul>
<p>While abusing a compromised mailbox to send malicious emails without the victim’s consent is not a new technique, we believe this is the first publicly documented case of an attack group using an OTM file and Outlook macro to achieve it.</p>
<div id="attachment_139404" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-2.png"><img class="wp-image-139404" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-2-150x150.png" alt="" width="750" height="143" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-2-300x57.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-2-768x146.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-2-1024x195.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-2.png 1120w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 2. Outlook VBA script creating the malicious email</i></p></div>
<p>Based on the “send to all in contact list” behavior of this malicious VBA code, we believe that this module might have led some organizations to think they were targeted by Gamaredon when they were merely collateral damage. For example, recent samples uploaded to VirusTotal coming from regions that are not traditionally targeted by Gamaredon, such as <a href="https://blog.trendmicro.co.jp/archives/24285" target="_blank" rel="noopener">Japan</a>, could be explained by the actions of this module.</p>
<p>As seen in Figure 2, the VBA code builds the email body and attaches the malicious document to the email. We’ve seen both <span style="font-family: courier new, courier, monospace;">.docx</span> and <span style="font-family: courier new, courier, monospace;">.lnk</span> files being used as attachments. These are very similar to the content of the malicious attachments used in Gamaredon’s initial spearphishing campaigns. Figure 3 shows an email generated by this malicious component.</p>
<div id="attachment_139405" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3.png"><img class="wp-image-139405" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3-150x150.png" alt="" width="750" height="494" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3-300x198.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3-768x506.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3-97x65.png 97w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-3.png 951w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 3. Email generated by the Outlook VBA module with a Word document attachment that contains a remote template</i></p></div>
<p>The email contains both English and Russian text. However, as illustrated in Figure 3, there is a problem with the Russian encoding. This was fixed in a later version of this module — another example of the Gamaredon group’s fast development pace and apparent lack of attention to detail.</p>
<h2>Office macro injection module &#8211; CodeBuilder</h2>
<p>We analyzed different variants of malicious modules used by the Gamaredon group to inject malicious macros or remote templates into documents already present on the compromised system. This is a very efficient way of moving laterally within an organization’s network as documents are routinely shared amongst colleagues. Also, as these macros are run when opening the documents, it is a good way to persist on a system as some of these documents are likely to be opened multiple times and at different times.</p>
<p>These macro injection modules also have the functionality to tamper with the Microsoft Office macro security settings. Thus, affected users have no idea that they are again compromising their workstations whenever they open the documents. We have seen this module implemented in two different languages: C# and VBScript.</p>
<h3>C#</h3>
<p>This module was delivered, like many other tools, in a 7z self-extracting archive. Inside, there was a password-protected RAR archive containing a few files. Notably, there were two text files, one for Word and one for Excel, containing the VBA source code of the malicious macro to be inserted into the targeted documents, and the .NET assembly responsible for finding and compromising existing documents. As illustrated in Figure 4, the assembly name is CodeBuilder.</p>
<div id="attachment_139406" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-4.png"><img class="wp-image-139406" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-4-150x150.png" alt="" width="600" height="544" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-4-300x272.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-4-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-4.png 607w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 4. CodeBuilder functions in a version that is not obfuscated</i></p></div>
<p>This .NET module first reduces Office macro security settings for various document types by modifying the following registry values:</p>
<p><span style="font-family: courier new, courier, monospace;">HKCU\Software\Microsoft\Office\&lt;version&gt;\&lt;product&gt;\Security\VBAWarnings</span><br />
<span style="font-family: courier new, courier, monospace;">HKCU\Software\Microsoft\Office\&lt;version&gt;\&lt;product&gt;\Security\AccessVBOM</span></p>
<p>It iterates over all possible Office &lt;version&gt; values for both <span style="font-family: courier new, courier, monospace;">Word</span> and <span style="font-family: courier new, courier, monospace;">Excel</span> &lt;product&gt; values. It then scans for documents with valid Word or Excel file extensions on all drives connected to the system. For the drive containing the Windows installation, it scans only specific locations, namely the <span style="font-family: courier new, courier, monospace;">Desktop</span> and <span style="font-family: courier new, courier, monospace;">Downloads</span> folders. For the others, it scans the entire drive. The malware moves each located document into the <span style="font-family: courier new, courier, monospace;">AppData</span> folder, inserts malicious Word or Excel macros into it using a <span style="font-family: courier new, courier, monospace;">Microsoft.Office.Interop</span> object, and then moves the document back into its original folder. In the samples we analyzed, the injected macros were simple downloaders.</p>
<h3>Batch file/VBScript</h3>
<p>The VBScript version of this module is similar in behavior to the .NET one. The main difference is that instead of inserting a malicious macro into existing documents, it inserts references to a remote template into them.</p>
<div id="attachment_139407" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-5.png"><img class="wp-image-139407" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-5-150x150.png" alt="" width="750" height="172" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-5-300x69.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-5-768x177.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-5.png 987w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 5. VBScript using the Document.AttachedTemplate property to inject a reference to a remote template into existing documents</i></p></div>
<p>This VBScript module also comes packaged in a self-extracting archive, containing one batch file and two VBS files responsible for iterating through documents and adding the remote template references to them.</p>
<h2>Module updates</h2>
<p>Interestingly, some of the custom tools described in Palo Alto Networks’ <a href="https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/" target="_blank" rel="noopener">2017 blogpost</a> on Gamaredon are still being updated and in use today. Some show significant similarities while others are rewrites in different coding languages. The most prevalent tools downloaded and installed on compromised machines can be broadly grouped into two different categories: downloaders and backdoors.</p>
<h3>Downloaders</h3>
<p>There are many variations of their downloaders, most of them written in either C# or VBScript. This section will cover only two of their most original variants; the others have not evolved that much and are very simple.</p>
<h4><strong><em>C# compiler module</em></strong></h4>
<p>This .NET executable, similar to many other tools used by the Gamaredon group, uses obfuscation techniques such as junk code insertion and string obfuscation. It contains in its body the base64-encoded source code of a downloader. It decodes that source code and compiles it directly on the system using the built-in <span style="font-family: courier new, courier, monospace;">Microsoft.CSharp.CSharpCodeProvider</span> class. It places the resulting executable in an existing directory and creates a scheduled task that will launch it every 10 minutes. As can be seen in Figure 6, the decoded source code still has comments in it, illustrating the apparent sloppiness of Gamaredon’s operators.</p>
<div id="attachment_139408" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-6.png"><img class="wp-image-139408" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-6-150x150.png" alt="" width="750" height="122" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-6-300x49.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-6-768x124.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-6-1024x166.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-6.png 1401w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 6. Part of the C# downloader source code included in the C# compiler module</i></p></div>
<h4><strong><em>GitHub project module</em></strong></h4>
<p>As seen in Figure 7, this .NET executable uses a GitHub repository to obtain and execute a downloader. This repository is now gone, but we were able to download a copy of it while it was still available.</p>
<div id="attachment_139409" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-7.png"><img class="wp-image-139409" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-7-150x150.png" alt="" width="750" height="441" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-7-300x177.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-7-768x452.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-7-1024x603.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-7.png 1057w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 7. .NET module responsible for downloading and executing a payload stored on github.com</i></p></div>
<p>The repository contained a single file — <span style="font-family: courier new, courier, monospace;">readme.txt</span> — that was a base64-encoded .NET downloader executable. The role of the GitHub project module is to download this file, decode it and execute it.</p>
<h3>Backdoors – file stealers</h3>
<p>While some variations exist in functionalities, the main purpose of these modules is to enumerate all documents on a compromised system and upload them to the C&amp;C server. These file stealers can also download and execute arbitrary code from the C&amp;C server. As with many other tools used by the Gamaredon group, they come in four different coding languages: C/C++, C#, batch file and VBScript.</p>
<h4><strong><em>C/C++</em></strong></h4>
<p>This variant is the successor of the USBStealer module described <a href="https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/" target="_blank" rel="noopener">here</a>. Although the latest versions are now quite different, examining samples of this module throughout its development clearly shows it originates from the same source code.</p>
<p>One sample that illustrates this shift well is a 64-bit DLL with internal name <span style="font-family: courier new, courier, monospace;">Harvesterx64.dll</span>, compiled in June 2019. It still has most of the strings used in the older variants, but also exhibits two improvements that are still in the newer ones. First, it now resolves Windows APIs via name hashing and second, it uses a basic text file instead of a SQLite database to track which files were already uploaded to the C&amp;C server.</p>
<p>The behavior of this module is quite straightforward: it scans the system for new Microsoft Office documents, both on local and removable drives, and uploads them to the C&amp;C server. To know whether the document is new, the module keeps, in a text file, one MD5 hash per file uploaded to the server. These MD5 hashes are not based on the file content, but rather on a string composed of the file name, its size and its last modified time. The module’s strings are stored in its .data section, encrypted with a simple XOR key. It also has the ability to download and execute arbitrary code from its C&amp;C server.</p>
<h4><strong><em>C#</em></strong></h4>
<p>This is a reimplementation in C# of the C/C++ version. The major difference is that it also takes screenshots of the compromised computer every minute. As seen in Figure 8, the version we analyzed has five different threads with evocative names.</p>
<div id="attachment_139410" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-8.png"><img class="wp-image-139410" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-8-150x150.png" alt="" width="750" height="424" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-8-300x170.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-8-768x434.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-8.png 854w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 8. C# backdoor thread creation routine</i></p></div>
<h4><strong><em>Batch file/VBScript</em></strong></h4>
<p>This version comprises several scripts, written in both batch file form and VBScript. The ultimate goal is the same, though: scanning the system for sensitive documents. The main mechanism is a batch file that searches for Word documents (<span style="font-family: courier new, courier, monospace;">*.doc*</span>) on the system and stores their names in a text file (see Figure 9).</p>
<div id="attachment_139411" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-9.png"><img class="wp-image-139411" src="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-9-150x150.png" alt="" width="750" height="261" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-9-300x104.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-9-768x267.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/06/Figure-9.png 806w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 9.Example <span style="font-family: courier new, courier, monospace;">inject.txt</span> file containing the result of the backdoor’s document file scan</i></p></div>
<p>The package also contains encrypted script files named <span style="font-family: courier new, courier, monospace;">1.log</span>, <span style="font-family: courier new, courier, monospace;">2.log</span>, <span style="font-family: courier new, courier, monospace;">3.log</span>, <span style="font-family: courier new, courier, monospace;">4.log</span> and <span style="font-family: courier new, courier, monospace;">5.log</span>. Once decrypted, these scripts are obfuscated VBScript downloaders that are able to download and execute arbitrary code.</p>
<h2>Network infrastructure</h2>
<p>The Gamaredon group uses many different domains, both free and paid, for its C&amp;C servers. Free domains are mostly DDNS from No-IP: <span style="font-family: courier new, courier, monospace;">hopto.org</span>, <span style="font-family: courier new, courier, monospace;">ddns.net</span>, <span style="font-family: courier new, courier, monospace;">myftp.biz</span>, while paid domains are registered through the REG.RU registrar and include the <span style="font-family: courier new, courier, monospace;">.fun</span>, <span style="font-family: courier new, courier, monospace;">.site</span>, <span style="font-family: courier new, courier, monospace;">.space</span>, <span style="font-family: courier new, courier, monospace;">.ru</span>, <span style="font-family: courier new, courier, monospace;">.website</span> and <span style="font-family: courier new, courier, monospace;">.xyz</span> TLDs.</p>
<p>They are constantly changing the domains used by their tools, but mostly on a small number of ASNs. Careful analysis suggests they use separate domains for small groups of victims. Please check <a href="https://github.com/eset/malware-ioc/tree/master/gamaredon" target="_blank" rel="noopener">ESET’s GitHub account</a> for an extensive list of domains used by the Gamaredon group.</p>
<h2>Quality of execution</h2>
<p>We were able to collect numerous different samples of malicious scripts, executables and documents used by the Gamaredon group throughout their campaigns. We noticed several mistakes in these, especially in scripts. It is of course impossible to know the exact reason behind these bugs or oversights, but the volume of samples the group produces and their rapid development could explain it. The fact that there were comments left in the source code included in some C# compiler module samples or that the Russian encoding was wrong in email generated by the Outlook VBA module shows that there is no stringent review or testing before releasing their many tools and using them in the wild.</p>
<p>However, while these errors might lower their tools’ overall effectiveness, this group’s rapid execution and adaptation also has some advantages. The volume and relentlessness of the attacks can create a state of constant dread in their targets. And although the code is very simple, some techniques, such as script obfuscation, make it hard to fully automate the analysis, making the analyst’s job tedious.</p>
<p>Their GitHub project allowed us a glimpse into the rapid development of their tools. The code that was committed there clearly showed the evolution of the C# downloader. The first versions showed no signs of obfuscation; then the developers added different string obfuscations and junk code to make the analysis harder.</p>
<p>In terms of persistence, several different techniques are used, but the most common ones are scheduled tasks, autorun registry keys and leveraging the Startup folder. Although these techniques are very simple and have been known for a long time, the Gamaredon group’s strategy of trying to install multiple scripts and executables on each system, and constantly updating them, significantly complicates the defender’s lives.</p>
<h2>Conclusion</h2>
<p>Despite the simplicity of most of their tools, the Gamaredon group also is capable of deploying some novelty, such as their Outlook VBA module. However, as it is far from stealthy, in the long run it is no match for a capable organization. The variety of tools Gamaredon has at its disposal can be very effective at fingerprinting a machine and understanding what sensitive data is available, then spreading throughout the network. Could this just be a way to deploy a much stealthier payload?</p>
<p><em>Special thanks to ESET Senior Malware Researcher <a href="https://www.welivesecurity.com/author/acherepanov/" target="_blank" rel="noopener">Anton Cherepanov</a> for his help in this research.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>

<table id="tablepress-844" class="tablepress tablepress-id-844">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">ESET detection name</th><th class="column-3">Comments</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">6F75F2490186225C922FE605953038BDEB537FEE</span></td><td class="column-2">DOC/TrojanDownloader.Agent.ARJ</td><td class="column-3">Outlook VBA module</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">DFC941F365E065187B5C4A4BF42E770035920856</span></td><td class="column-2">Win32/Pterodo.XG.gen</td><td class="column-3">C# Office macro injection module</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">9AFC9D6D72F78B2EB72C5F2B87BDC7D59C1A14ED</span></td><td class="column-2">Win32/Pterodo.ZM</td><td class="column-3">Batch file/‌VBScript Office macro injection module</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">3DD83D7123AEFBE5579C9DC9CF3E68BCAFC9E65E</span></td><td class="column-2">MSIL/Pterodo.CD</td><td class="column-3">C# compiler module</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">941F341770B67F9E8EE811B4B8383101F35B27CD</span></td><td class="column-2">MSIL/Pterodo.CA</td><td class="column-3">GitHub project module</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">DC8BD2F65FD2199CE402C76A632A9743672EFE2D</span></td><td class="column-2">Win32/Pterodo.XC</td><td class="column-3">C/C++ backdoor</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">336C1244674BB378F041E9064EA127E9E077D59D</span></td><td class="column-2">MSIL/Pterodo.DP</td><td class="column-3">C# backdoor</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">5FC1B6A55A9F5A52422872A8E34A284CDBDD0526</span></td><td class="column-2">Win32/Pterodo.YE</td><td class="column-3">Batch file/‌VBScript backdoor</td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>

<table id="tablepress-845" class="tablepress tablepress-id-845">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="2" class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1193/" rel="noopener" target="_blank">T1193</a></td><td class="column-3">Spearphishing Attachment</td><td class="column-4">Gamaredon group sends emails with malicious attachments to its targets.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1199/" rel="noopener" target="_blank">T1199</a></td><td class="column-3">Trusted Relationship</td><td class="column-4">Gamaredon group malware abuses a compromised organization’s email accounts to send emails with malicious attachments to the victim’s contacts.</td>
</tr>
<tr class="row-4 even">
	<td rowspan="4" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1064/" rel="noopener" target="_blank">T1064</a></td><td class="column-3">Scripting</td><td class="column-4">Gamaredon group uses scripting heavily, mostly Batch files and VBScript.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1085/" rel="noopener" target="_blank">T1085</a></td><td class="column-3">Rundll32</td><td class="column-4">Gamaredon group malware uses <span style="font-family: courier new, courier, monospace;"> rundll32</span>  to launch malicious DLLs, for example the C/C++ backdoor.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Execution through API</td><td class="column-4">Gamaredon group malware uses <span style="font-family: courier new, courier, monospace;"> CreateProcess</span>  to launch additional components, for example to execute payloads received from its C&amp;C servers.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1204" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">Initial compromise by the Gamaredon group usually requires the user to execute a malicious email attachment.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="3" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Gamaredon group malware registers several of its modules (downloaders, backdoors, etc.) as scheduled tasks.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Gamaredon group uses Run keys and the Startup folder to ensure its modules are executed at every reboot.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1137/" rel="noopener" target="_blank">T1137</a></td><td class="column-3">Office Application Startup</td><td class="column-4">Gamaredon group malware inserts malicious macros into existing documents, providing persistence when they are reopened.</td>
</tr>
<tr class="row-11 odd">
	<td rowspan="6" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">Gamaredon group makes heavy use of compressed archives, some password protected, to deliver its malicious payloads. Strings are routinely obfuscated or encrypted in these malicious modules.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">Gamaredon group malware modifies several registry keys to deactivate security mechanisms in Microsoft Office related to macros.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1116/" rel="noopener" target="_blank">T1116</a></td><td class="column-3">Code Signing</td><td class="column-4">Gamaredon group uses signed binaries in its malicious campaigns. One notable example is wget samples signed with a valid certificate from Jernej Simončič and available <a href="https://eternallybored.org/misc/wget/" rel="noopener" target="_blank">here</a>.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Gamaredon group uses simple string deobfuscation and decryption routines in its modules.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1221/" rel="noopener" target="_blank">T1221</a></td><td class="column-3">Template Injection</td><td class="column-4">Gamaredon group adds remote templates to documents it sends to targets.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1500/" rel="noopener" target="_blank">T1500</a></td><td class="column-3">Compile After Delivery</td><td class="column-4">Gamaredon group C# compiler module contains an obfuscated downloader that it compiles using <span style="font-family: courier new, courier, monospace;"> csc.exe</span>  and then executes.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Gamaredon group uses its backdoors to automatically list interesting files (such as Office documents) found on a system for future exfiltration.</td>
</tr>
<tr class="row-18 even">
	<td rowspan="2" class="column-1">Lateral Movement</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1080/" rel="noopener" target="_blank">T1080</a></td><td class="column-3">Taint Shared Content</td><td class="column-4">Gamaredon group malware injects malicious macros into all Word and Excel documents reachable by the compromised system.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1534/" rel="noopener" target="_blank">T1534</a></td><td class="column-3">Internal Spearphishing</td><td class="column-4">Gamaredon group uses its Outlook VBA macro to send email with malicious attachments to other targets within the same organization.</td>
</tr>
<tr class="row-20 even">
	<td rowspan="5" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">Gamaredon group malware actively searches for sensitive documents on the local system.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1025/" rel="noopener" target="_blank">T1025</a></td><td class="column-3">Data from Removable Media</td><td class="column-4">Gamaredon group malware scans all drives for sensitive data and also watches for removable drives being inserted into a system.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1039/" rel="noopener" target="_blank">T1039</a></td><td class="column-3">Data from Network Shared Drive</td><td class="column-4">Gamaredon group malware scans all drives A: – Z: for sensitive data, so it will scan any network shares mounted as drives.</td>
</tr>
<tr class="row-23 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Gamaredon group uses a backdoor that takes screenshots every minute.</td>
</tr>
<tr class="row-24 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1119/" rel="noopener" target="_blank">T1119</a></td><td class="column-3">Automated Collection</td><td class="column-4">Gamaredon group deploys scripts on compromised systems that automatically scan for interesting documents.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">Gamaredon group malware uses both HTTP and HTTPS for command and control.</td>
</tr>
<tr class="row-26 even">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1020/" rel="noopener" target="_blank">T1020</a></td><td class="column-3">Automated Exfiltration</td><td class="column-4">Gamaredon group uses modules that automatically upload harvested documents to the C&amp;C server.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/boutin/" title="Jean-Ian Boutin">
                    Jean-Ian Boutin                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-06-11 11:30:52">11 Jun 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Gamaredon group grows its game">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Gamaredon group grows its game">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Gamaredon group grows its game">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Gamaredon group grows its game">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F06%2F11%2Fgamaredon-group-grows-its-game%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F06%2F11%2Fgamaredon-group-grows-its-game%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F06%2F11%2Fgamaredon-group-grows-its-game%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"139311 https:\/\/backend.welivesecurity.com\/?p=139311","disqusShortname":"welivesecurity","disqusTitle":"Gamaredon group grows its game","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/06\/11\/gamaredon-group-grows-its-game\/","postId":"139311"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>