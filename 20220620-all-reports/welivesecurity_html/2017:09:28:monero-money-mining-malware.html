<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Peter Kálnai',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Money&#8209;making machine: Monero&#8209;mining malware | WeLiveSecurity</title>
<meta name="description" content="Monero mining malware software is quietly working in the background and making a very healthy profit exploiting a known vulnerability in Microsoft IIS 6.0"/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/09/28/monero-money-mining-malware/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Money&#8209;making machine: Monero&#8209;mining malware | WeLiveSecurity" />
<meta property="og:description" content="Monero mining malware software is quietly working in the background and making a very healthy profit exploiting a known vulnerability in Microsoft IIS 6.0" />
<meta property="og:url" content="https://www.welivesecurity.com/2017/09/28/monero-money-mining-malware/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2017-09-28T12:54:42+00:00" />
<meta property="article:modified_time" content="2018-04-17T08:05:32+00:00" />
<meta property="og:updated_time" content="2018-04-17T08:05:32+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/09/Monero-mining-malware.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/09/Monero-mining-malware.jpg" />
<meta property="og:image:width" content="621" />
<meta property="og:image:height" content="393" />
<meta property="og:image:alt" content="Monero-mining malware" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Monero mining malware software is quietly working in the background and making a very healthy profit exploiting a known vulnerability in Microsoft IIS 6.0" />
<meta name="twitter:title" content="Money&#8209;making machine: Monero&#8209;mining malware | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/09/Monero-mining-malware.jpg" />
<meta name="twitter:creator" content="@pkalnai" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2017/09/29/malware-para-extrair-monero/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2017/09/28/monero-money-mining-malware/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/09/29/malware-que-mina-monero/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2017/09/29/monero-malware-auf-der-spur/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2017/09/29/malware-para-extrair-monero/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/09/29/malware-que-mina-monero/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/09/29/monero-malware-auf-der-spur/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2017/09/29/malware-para-extrair-monero/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/09/29/malware-que-mina-monero/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/09/29/monero-malware-auf-der-spur/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2017/09/Monero-mining-malware.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Money&#8209;making machine: Monero&#8209;mining malware</h1>
<div class="excerpt">While far behind Bitcoin in market capitalization, Monero has several features that make it a very attractive cryptocurrency to be mined by malware.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/pkalnai/" title="Peter Kálnai">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2016/12/kalnai_peter_photo-222x179.png" alt="Peter Kálnai">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/pkalnai/" title="Peter Kálnai">
                    Peter Kálnai                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mposlusny/" title="Michal Poslušný">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2017/09/Michal-Poslusny-2-222x179.jpg" alt="Michal Poslušný">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mposlusny/" title="Michal Poslušný">
                    Michal Poslušný                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-09-28 14:54:42">28 Sep 2017 - 02:54PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F28%2Fmonero-money-mining-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F28%2Fmonero-money-mining-malware%2F&text=Money&#8209;making machine: Monero&#8209;mining malware%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F28%2Fmonero-money-mining-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>While far behind Bitcoin in market capitalization, Monero has several features that make it a very attractive cryptocurrency to be mined by malware.</p>
                            </div>

                            <p>While the world is holding its breath, wondering where notorious cybercriminal groups like Lazarus or Telebots will strike next with another destructive malware such as WannaCryptor or Petya, there are many other, less aggressive, much stealthier and often very profitable operations going on.</p>
<p>One such operation has been going on since at least May 2017, with attackers infecting unpatched Windows webservers with a malicious cryptocurrency miner. The goal: use the servers’ computing power to mine Monero (XMR), one of the newer cryptocurrency alternatives to Bitcoin.</p>
<p>To achieve this, attackers modified legitimate open source Monero mining software and exploited a known vulnerability in Microsoft IIS 6.0 to covertly install the miner on unpatched servers. Over the course of three months, the crooks behind the campaign have created a botnet of several hundred infected servers and made over USD 63,000 worth of Monero.</p>
<p>ESET customers are protected against any attempts to exploit the CVE-2017-7269 vulnerability, even if their machines aren’t patched against it, as was <a href="https://www.welivesecurity.com/2017/05/18/protected-against-wannacryptor/" target="_blank" rel="noopener">the case with EternalBlue, the exploit used to spread WannaCryptor</a>.</p>
<p><a href="/wp-content/uploads/2017/09/Monero.png"><img class="aligncenter wp-image-100932 size-full" src="/wp-content/uploads/2017/09/Monero.png" alt="" width="189" height="197" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/Monero.png 189w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Monero-32x32.png 32w" sizes="(max-width: 189px) 100vw, 189px" /></a></p>
<h2>Why mine Monero and not Bitcoin?</h2>
<p>While far behind Bitcoin in market capitalization, Monero has several features that make it a very attractive cryptocurrency to be mined by malware – untraceable transactions and a proof of work algorithm called CryptoNight, which favors computer or server CPUs and GPUs, in contrast to specialized mining hardware needed for Bitcoin mining.</p>
<p>We can observe the exchange rate jumping up from 40 USD/XMR up to 150 USD/XMR over the past month, falling back to 100 USD/XMR.</p>
<div id="attachment_100933" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/09/figure1.png"><img class="wp-image-100933" src="/wp-content/uploads/2017/09/figure1-300x201.png" alt="" width="640" height="429" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/figure1-300x201.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/09/figure1-768x514.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/09/figure1-1024x686.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/09/figure1-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2017/09/figure1-97x65.png 97w, https://www.welivesecurity.com/wp-content/uploads/2017/09/figure1.png 1133w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure1. Candlestick chart of the XMR/USD exchange rate in August, 2017</p></div>
<h2>The Cryptominer</h2>
<p>First seen in-the-wild on 26<sup>th</sup> May, 2017, the malicious mining software is a fork of a legitimate open source Monero CPU miner called <a href="https://github.com/xmrig/xmrig/releases/tag/v0.8.2" target="_blank" rel="noopener">xmrig</a>, version 0.8.2 (also released May 26  2017).</p>
<p>When creating the malicious mining software, the crooks did not apply any changes to the original open source codebase apart from adding hardcoded command line arguments of the attacker’s wallet address and the mining pool URL, plus a few arguments to kill all previously running instances of itself so as not to compete with its new instance. This couldn’t have taken the cybercrooks more than just couple of minutes as suggested by the fact that we saw it in-the-wild on the same day the base version of xmrig was released.</p>
<p>You can see the attacker’s modified cryptominer and its identification with the available source code in the figures below.</p>
<p><a href="/wp-content/uploads/2017/09/Figure2a.png"><img class="aligncenter wp-image-100934" src="/wp-content/uploads/2017/09/Figure2a-300x189.png" alt="" width="640" height="403" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure2a-300x189.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure2a-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure2a-275x172.png 275w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure2a.png 653w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<div id="attachment_100935" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/09/Figure2b.png"><img class="wp-image-100935" src="/wp-content/uploads/2017/09/Figure2b-300x131.png" alt="" width="640" height="279" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure2b-300x131.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure2b-768x335.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure2b.png 943w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure2. Code comparison between original and adapted versions</p></div>
<h2>Scanning and Exploitation</h2>
<p>The distribution of the miner to victims’ computers is the hardest part of this operation, but even here, the attackers went for the easiest approach. There are two IP addresses that we identified as the source of brute-force scans for the <a href="http://www.cvedetails.com/cve/CVE-2017-7269/" target="_blank" rel="noopener">CVE-2017-7269</a> vulnerability and both point to servers in the Amazon Web Services cloud.</p>
<p>The vulnerability exploited by the attackers was discovered in March 2017 by <a href="http://www.cvedetails.com/cve/cve-2017-7269" target="_blank" rel="noopener">Zhiniang Peng and Chen Wu</a>. It is a vulnerability in the WebDAV service that is part of Microsoft IIS version 6.0, the webserver in Windows Server 2003 R2. A dangerous buffer overflow in the <span style="font-family: courier new,courier,monospace;">ScStoragePathFromUrl</span> function is triggered when the vulnerable server is processing a malicious HTTP request. In particular, a specifically crafted PROPFIND request leads to a buffer overflow due to a reallocation of double sized buffer when the count of Unicode characters is mistakenly provided instead of a byte-count. A very detailed analysis of the mechanism by Javier M. Mellid can be found <a href="https://javiermunhoz.com/blog/2017/04/17/cve-2017-7269-iis-6.0-webdav-remote-code-execution.html" target="_blank" rel="noopener">here</a>. This vulnerability is especially susceptible to exploitation, since it’s located in a webserver service, which in most cases is meant to be visible from the internet and therefore can be easily accessed and exploited by anyone.</p>
<p>The payload comes necessarily in the form of an alphanumeric string. The attackers replaced the string leading to the execution of the Windows calculator from the proof-of-concept with one leading to the download and execution of their malicious payload.  However, this didn’t require much sophistication either, as there are online tools like <a href="https://github.com/SkyLined/alpha3/" target="_blank" rel="noopener">alpha3</a> that help to convert any shellcode into the desired string.</p>
<p>The shellcode is the expected download-and-execute action (downloading <em>dasHost.exe</em> from hxxt://postgre[.]tk/ into the %TEMP% folder):</p>
<div id="attachment_100936" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/09/Figure3-2.png"><img class="wp-image-100936" src="/wp-content/uploads/2017/09/Figure3-2-300x145.png" alt="" width="640" height="309" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure3-2-300x145.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure3-2-768x371.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure3-2-1024x495.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure3-2.png 1039w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure3. Shellcode delivered by the exploit</p></div>
<p>Based on our data, the very first in-the-wild exploitation of this vulnerability happened just two days after its publication on 26<sup>th</sup> March 2017 and it has been actively exploited ever since.</p>
<p>This particular malicious miner was first seen in-the-wild on 26<sup>th</sup> May 2017. Since then, it has been appearing in waves, on a weekly or less frequent basis, which implies that the attacker scans the internet for vulnerable machines.</p>
<div id="attachment_100937" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/09/Figure4-1.png"><img class="wp-image-100937" src="/wp-content/uploads/2017/09/Figure4-1-300x208.png" alt="" width="640" height="443" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure4-1-300x208.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure4-1-623x432.png 623w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure4-1.png 739w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure4. Graph of infection waves over time</p></div>
<p>Scanning is always done from one IP address, which seems to be a machine hosted on an Amazon cloud server that the attacker had rented and deployed their scanning software, and continue to use it to launch their attacks.</p>
<h2>Mitigation</h2>
<p>ESET detects the malicious binaries of the miner as <strong>Win32/CoinMiner.AMW trojan</strong> and the exploitation attempts at the network layer under the detection name <strong>webDAV/ExplodingCan</strong>. This is a real-world example of a packet that would be blocked:</p>
<div id="attachment_100938" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/09/Figure5-2.png"><img class="wp-image-100938" src="/wp-content/uploads/2017/09/Figure5-2-300x152.png" alt="" width="640" height="325" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure5-2-300x152.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure5-2-768x390.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure5-2.png 802w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure5. Specifically crafted HTTP request with an encoded shellcode</p></div>
<p><a href="https://www.microsoft.com/en-us/cloud-platform/windows-server-2003" target="_blank" rel="noopener">Microsoft ended its regular update support for Windows Server 2003 in July 2015</a> and did not release any patch for this vulnerability until June 2017, when several critical vulnerabilities for its older systems were discovered and brought to the attention of malware authors. The good news is that despite the end-of-life status of the system, Microsoft decided to patch these critical vulnerabilities in order to avoid large-scale destructive attacks similar to the WannaCryptor (aka WannaCry) outbreak. However, keeping Windows Server 2003 up-to-date might be difficult due to the fact that automatic updates don’t always work smoothly (e.g. <a href="http://clintboessen.blogspot.cz/2016/12/how-to-patch-windows-server-2003-with.html" target="_blank" rel="noopener">this blog post</a> by Clint Boessen confirms our own troubles with updating the system). Consequently, many of these systems are still vulnerable to this day. We strongly advise users of Windows Server 2003 to apply <a href="https://www.microsoft.com/en-us/download/details.aspx?id=55422" target="_blank" rel="noopener">KB3197835</a> and other critical patches as soon as possible (if automatic updates fail then download and install the security update manually!).</p>
<h2>Statistics</h2>
<p>Thanks to the mining pool stats being publicly available, we were able to see the combined hash rate of all victims, which represents the computing power dedicated to the mining account. The value seemed to consistently reach around 100 kilohashes per second (kH/s), with a surge of up to 160 kH/s in late August 2017, which we attribute to campaigns launched on August 23 and 30.</p>
<p>Overall, the infected machines were making approximately XMR5.5 daily by the end of August and have made over XMR420 in total over the course of three months. According to the exchange rate of 150 USD/XMR at the time, these values were equal to USD 825 per day and over USD 63,000 in total, respectively.</p>
<p>The attackers were very active at the end of August but have gone quiet since early this month with no new infections coming in. Moreover, because the miner has no persistence mechanism, the attackers have slowly begun losing already compromised machines, and the total hash rate has dropped all the way down to 60 kH/s at the time of writing. This is not the first time the attackers took such a break and it is likely a new campaign will be launched in the near future.</p>
<p>The total number of victims is not known to us, but can be estimated from the total hash rate produced by the attacker. According to the <a href="http://monerobenchmarks.info/#cpu" target="_blank" rel="noopener">CPU benchmarks</a>, a high-end consumer Intel i7 processor has a hash rate of around 0.3-0.4 kH/s. However, considering the fact that the exploit is limited to systems running Windows Server 2003, which will most likely be running on older hardware with weaker CPUs, the average hash rate per victim will be much lower and the total number of infected machines probably much higher.</p>
<div id="attachment_100939" style="width: 650px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2017/09/Figure6-2.png"><img class="wp-image-100939" src="/wp-content/uploads/2017/09/Figure6-2-300x191.png" alt="" width="640" height="408" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure6-2-300x191.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure6-2-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2017/09/Figure6-2.png 474w" sizes="(max-width: 640px) 100vw, 640px" /></a><p class="wp-caption-text">Figure6: Statistics of the attackers’ wallet provided by the mining pool</p></div>
<h2>Conclusion</h2>
<p>We see that minimal know-how together with very low operating costs and a low risk of getting caught – in this case, misusing legitimate open-source cryptocurrency mining software and targeting old systems likely to be left unpatched – can be sufficient for securing a relatively high outcome.</p>
<p>Sometimes it takes very little to gain a lot, and this is especially true in today’s world of cybersecurity, where even well-documented, long-known and warned about vulnerabilities are still very effective due to the lack of awareness of many users.</p>

<table id="tablepress-386" class="tablepress tablepress-id-386">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><h3>IoCs</h3></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Download Site:</strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">hxxp://postgre.tk</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">hxxp://ntpserver.tk</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong>Source IPs:</strong></td>
</tr>
<tr class="row-6 even">
	<td class="column-1">54.197.4.10</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">52.207.232.106</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">18.220.190.151</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><strong>Hashes:</strong></td>
</tr>
<tr class="row-10 even">
	<td class="column-1">31721AE37835F792EE792D8324E307BA423277AE</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">A0BC6EA2BFA1D3D895FE8E706737D490D5FE3987</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">37D4CC67351B2BD8067AB99973C4AFD7090DB1E9</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">0902181D1B9433B5616763646A089B1BDF428262</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">0AB00045D0D403F2D8F8865120C1089C09BA4FEE</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">11D7694987A32A91FB766BA221F9A2DE3C06D173</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">9FCB3943660203E99C348F17A8801BA077F7CB40</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">52413AE19BBCDB9339D38A6F305E040FE83DEE1B</td>
</tr>
</tbody>
</table>

<h4>If you are interested in this topic you might also be interested in the following:</h4>
<p><a href="https://www.welivesecurity.com/2017/09/14/cryptocurrency-web-mining-union-profit/" target="_blank" rel="noopener">https://www.welivesecurity.com/2017/09/14/cryptocurrency-web-mining-union-profit/</a></p>
<p><a href="https://www.welivesecurity.com/2017/09/12/cryptocurrency-state-sponsorship/" target="_blank" rel="noopener">https://www.welivesecurity.com/2017/09/12/cryptocurrency-state-sponsorship/ </a></p>
<p><a href="https://fialovam.wixsite.com/portfolio" target="_blank" rel="noopener"><span style="font-family: georgia,palatino,serif;"><em>Image Credit: © Markéta Fialová</em></span></a></p>
<p><span style="font-family: arial,helvetica,sans-serif;"><em> </em></span></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/pkalnai/" title="Peter Kálnai">
                    Peter Kálnai                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mposlusny/" title="Michal Poslušný">
                    Michal Poslušný                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-09-28 14:54:42">28 Sep 2017 - 02:54PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Money&#8209;making machine: Monero&#8209;mining malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Money&#8209;making machine: Monero&#8209;mining malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Money&#8209;making machine: Monero&#8209;mining malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Money&#8209;making machine: Monero&#8209;mining malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F28%2Fmonero-money-mining-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F28%2Fmonero-money-mining-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F09%2F28%2Fmonero-money-mining-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"100923 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=100923","disqusShortname":"welivesecurity","disqusTitle":"Money\u2011making machine: Monero\u2011mining malware","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/09\/28\/monero-money-mining-malware\/","postId":"100923"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>