<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Anton Cherepanov',
        'ArticleCategory': 'Threats',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Firefox Under Fire: Anatomy of latest 0&#8209;day attack | WeLiveSecurity</title>
<meta name="description" content="The recent Firefox attacks are an example of active in-the-wild exploitation of a serious software vulnerability."/>
<link rel="canonical" href="https://www.welivesecurity.com/2015/08/11/firefox-under-fire-anatomy-of-latest-0-day-attack/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Firefox Under Fire: Anatomy of latest 0&#8209;day attack | WeLiveSecurity" />
<meta property="og:description" content="The recent Firefox attacks are an example of active in-the-wild exploitation of a serious software vulnerability." />
<meta property="og:url" content="https://www.welivesecurity.com/2015/08/11/firefox-under-fire-anatomy-of-latest-0-day-attack/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="FireFox" />
<meta property="article:tag" content="Vulnerability" />
<meta property="article:section" content="Threats" />
<meta property="article:published_time" content="2015-08-11T12:00:01+00:00" />
<meta property="article:modified_time" content="2015-08-12T13:14:49+00:00" />
<meta property="og:updated_time" content="2015-08-12T13:14:49+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2015/08/firefox1-623x4101.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2015/08/firefox1-623x4101.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="410" />
<meta property="og:image:alt" content="firefox zero-day" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="The recent Firefox attacks are an example of active in-the-wild exploitation of a serious software vulnerability." />
<meta name="twitter:title" content="Firefox Under Fire: Anatomy of latest 0&#8209;day attack | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2015/08/firefox1-623x4101.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/2015/08/11/firefox-under-fire-anatomy-of-latest-0-day-attack/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2015/08/11/firefox-bajo-fuego-anatomia-ataque-0-day/" hreflang="es" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2015/08/11/firefox-bajo-fuego-anatomia-ataque-0-day/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2015/08/11/firefox-bajo-fuego-anatomia-ataque-0-day/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Firefox Under Fire: Anatomy of latest 0&#8209;day attack</h1>
<div class="excerpt">The recent Firefox attacks are an example of active in-the-wild exploitation of a serious software vulnerability.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Anton_Cherepanov-222x179.jpg" alt="Anton Cherepanov">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                    Anton Cherepanov                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2015-08-11 12:00:01">11 Aug 2015 - 12:00PM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F08%2F11%2Ffirefox-under-fire-anatomy-of-latest-0-day-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F08%2F11%2Ffirefox-under-fire-anatomy-of-latest-0-day-attack%2F&text=Firefox Under Fire: Anatomy of latest 0&#8209;day attack%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F08%2F11%2Ffirefox-under-fire-anatomy-of-latest-0-day-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>The recent Firefox attacks are an example of active in-the-wild exploitation of a serious software vulnerability.</p>
                            </div>

                            <p>On the August 6<sup>th</sup>, the Mozilla Foundation released a security update for the Firefox web browser that fixes the <a href="https://www.mozilla.org/en-US/security/advisories/mfsa2015-78/">CVE-2015-4495</a> vulnerability in Firefox&#8217;s embedded PDF viewer, <a href="https://mozillalabs.com/en-US/pdfjs/">PDF.js</a>. This vulnerability allows attackers to bypass the <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same-origin policy</a> and execute JavaScript remotely that will be interpreted in the local file context. This, in turn, allows attackers to read and write files on local machine as well as upload them to a remote server. The exploit for this vulnerability is being actively used in the wild, so Firefox users are advised to update to the <a href="https://www.mozilla.org/en-US/firefox/all/">latest version</a> (39.0.3 at the time of writing) immediately.</p>
<p>In this blog we provide an analysis of two versions of the script and share details about the associated attacks against Windows, Linux and OS X systems.</p>
<p>According to ESET&#8217;s LiveGrid® telemetry, the server at the IP address 185.86.77.48, which was hosting the malicious script, has been up since July 27, 2015. Also we can find corroboration on one of the compromised forums:</p>
<div id="attachment_67118" style="width: 774px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image1.png"><img class="wp-image-67118 size-full" src="/wp-content/uploads/2015/08/image1.png" alt="image1" width="764" height="120" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image1.png 764w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image1-300x47.png 300w" sizes="(max-width: 764px) 100vw, 764px" /></a><p class="wp-caption-text">Image 1: Forum user is curious about malicious script injected into the page</p></div>
<p>&nbsp;</p>
<p>Operatives from the <a href="http://cybercrime.gov.ua/">Department on Combating Cybercrime of the Ministry of Internal Affairs of Ukraine</a>, who responded promptly to our notification, have also confirmed that the malicious exfiltration server, hosted in Ukraine, has been online since July 27, 2015.</p>
<p>According to our monitoring of the threat, the server became inactive on August 8, 2015.</p>
<h1>The script</h1>
<p>The script used is not obfuscated and easy to analyze. Nevertheless, the code shows that the attackers had good knowledge of Firefox internals.</p>
<p>The malicious script creates an IFRAME with an empty PDF blob. When Firefox is about to open the PDF blob with the internal PDF viewer (PDF.js), new code is injected into the IFRAME (Figure 2). When this code executes, a new sandboxContext property is created within wrappedJSObject. A JavaScript function is written to the sandboxContext property. This function will later be invoked by subsequent code. Together, these steps lead to the successful bypass of the same-origin policy.</p>
<div id="attachment_67119" style="width: 742px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image2.png"><img class="wp-image-67119 size-full" src="/wp-content/uploads/2015/08/image2.png" alt="Code that creates sandboxContext property" width="732" height="362" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image2.png 732w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image2-300x148.png 300w" sizes="(max-width: 732px) 100vw, 732px" /></a><p class="wp-caption-text">Image 2: Code that creates sandboxContext property</p></div>
<p>&nbsp;</p>
<p>The exploit is very reliable and works smoothly. However, it may display a warning which can catch the attention of tech-savvy users.</p>
<div id="attachment_67120" style="width: 485px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image3.png"><img class="wp-image-67120 size-full" src="/wp-content/uploads/2015/08/image3.png" alt="The warning message showed on compromised site" width="475" height="81" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image3.png 475w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image3-300x51.png 300w" sizes="(max-width: 475px) 100vw, 475px" /></a><p class="wp-caption-text">Image 3: The warning message showed on compromised site</p></div>
<p>&nbsp;</p>
<p>After successful exploitation of the bug, execution passes to the exfiltration part of code. The script supports both the Linux and Windows platforms. On Windows it searches for configuration files belonging to popular FTP clients (such as FileZilla, SmartFTP and others), <a href="https://en.wikipedia.org/wiki/Comparison_of_Subversion_clients">SVN</a> client, instant messaging clients (Psi+ and Pidgin), and the Amazon S3 client.</p>
<div id="attachment_67121" style="width: 691px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image4.png"><img class="wp-image-67121" src="/wp-content/uploads/2015/08/image4.png" alt="The list of collected files on Windows at the first stage of attack" width="681" height="313" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image4.png 629w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image4-300x138.png 300w" sizes="(max-width: 681px) 100vw, 681px" /></a><p class="wp-caption-text">Image 4: The list of collected files on Windows at the first stage of attack</p></div>
<p>&nbsp;</p>
<p>These configuration files may contain saved login and password details.</p>
<p>On the Linux systems, the script sends following files to the remote server:</p>
<ul>
<li>/etc/passwd</li>
<li>/etc/hosts</li>
<li>/etc/hostname</li>
<li>/etc/issue</li>
</ul>
<p>It also parses the <strong>/etc/passwd</strong> file in the order to get the home directories (homedir) of users on the system. The script then searches files by mask in the home directories collected, and it avoids searching in the home directories of standard system users (such as daemon, bin, sys, sync and so forth).</p>
<div id="attachment_67122" style="width: 659px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image5.png"><img class="wp-image-67122" src="/wp-content/uploads/2015/08/image5.png" alt="The list of collected files on Linux at stage 1 of attack" width="649" height="278" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image5.png 637w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image5-300x129.png 300w" sizes="(max-width: 649px) 100vw, 649px" /></a><p class="wp-caption-text">Image 5: The list of collected files on Linux at stage 1 of attack</p></div>
<p>&nbsp;</p>
<p>It collects and uploads such files as:</p>
<ul>
<li>history (bash, MySQL, PostgreSQL)</li>
<li>SSH related configuration files and authorization keys</li>
<li>Configuration files for remote access software – Remmina</li>
<li>FileZilla configuration files</li>
<li>PSI+ configuration</li>
<li>text files with possible credentials and shell scripts</li>
</ul>
<p>As is evident here, the purpose of the first version of the malicious script was to gather data used mostly by webmasters and site administrators. This allowed attackers to move on to compromising more websites.</p>
<h1>The second version</h1>
<p>The day after Mozilla released the patch for Firefox the attackers decided to go “all-in”: they registered two new domains and improved their script.</p>
<p>The two new malicious domains were maxcdnn[.]com (93.115.38.136) and acintcdn[.]net (185.86.77.48). The second IP address is the same one as used in the first version. Attackers selected these names because the domains look as if they belong to a content delivery network (<a href="https://en.wikipedia.org/wiki/Content_delivery_network">CDN</a>).</p>
<p>The improved script on the Windows platform not only collects configuration files for applications; it also collects text files containing almost all combinations of words of possible value to attackers (such as password, accounts, bitcoins, credit cards, exploits, certificates, and so on):</p>
<div id="attachment_67123" style="width: 827px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image6.png"><img class="wp-image-67123 size-full" src="/wp-content/uploads/2015/08/image6.png" alt="List of files collected on Windows during the second attack stage" width="817" height="258" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image6.png 817w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image6-300x95.png 300w" sizes="(max-width: 817px) 100vw, 817px" /></a><p class="wp-caption-text">Image 6: List of files collected on Windows during the second attack stage</p></div>
<p>&nbsp;</p>
<p>The attackers improved the Linux script by adding new files to collect and also developed code that works on the Mac OS X operating system:</p>
<div id="attachment_67124" style="width: 710px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image7.png"><img class="wp-image-67124 size-full" src="/wp-content/uploads/2015/08/image7.png" alt="List of files collected on Macs during the second stage of an attack" width="700" height="352" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image7.png 700w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image7-300x151.png 300w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text">Image 7: List of files collected on Macs during the second stage of an attack</p></div>
<p>&nbsp;</p>
<p>Some Russian-speaking commentators misattributed this code to the Duqu malware, because some variables in the code have the text “dq” in them.</p>
<h1>A copycat attack</h1>
<p>Since the bug is easy to exploit and a working copy of the script is available to cybercriminals, different attackers have started to use it. We have seen that various groups quickly adopted the exploit and started to serve it, mostly on adult sites from google-user-cache[.]com (108.61.205.41)</p>
<p>This malicious script does all the same things as the original script, but it collects different files:</p>
<div id="attachment_67125" style="width: 698px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2015/08/image8.png"><img class="wp-image-67125 size-full" src="/wp-content/uploads/2015/08/image8.png" alt="The list of collected files used in copycat attack" width="688" height="19" srcset="https://www.welivesecurity.com/wp-content/uploads/2015/08/image8.png 688w, https://www.welivesecurity.com/wp-content/uploads/2015/08/image8-300x8.png 300w" sizes="(max-width: 688px) 100vw, 688px" /></a><p class="wp-caption-text">Image 8: The list of collected files used in copycat attack</p></div>
<h1></h1>
<h1>Conclusion</h1>
<p>The recent Firefox attacks are an example of active in-the-wild exploitation of a serious software vulnerability. The exploit shows that the malware-writers had a deep knowledge of Firefox internals. It is also an interesting one, since in most cases, exploits are used as an infection vector for other data-stealing trojans. In this instance, however, that was not necessary, because the malicious script alone was able to steal sensitive files from victims’ systems.</p>
<p>Additionally, the exploit started to be reused by other malware operators shortly after its discovery. This is common practice in the malware world.</p>
<p>ESET detects the malicious scripts as <strong>JS/Exploit.CVE-2015-4495</strong>. We also urge Firefox users to <a href="https://www.mozilla.org/en-US/firefox/new/">update their browser</a> to the patched version (39.0.3). The internal Firefox PDF reader can also be <a href="http://kb.mozillazine.org/About:config">disabled by changing</a> the pdfjs.disabled setting to true.</p>
<h1>Indicators of Compromise</h1>
<h2>A partial list of compromised servers:</h2>
<p>hxxp://www.akipress.org/<br />
hxxp://www.tazabek.kg/<br />
hxxp://www.super.kg/<br />
hxxp://www.rusmmg.ru/<br />
hxxp://forum.cs-cart.com/<br />
hxxp://www.searchengines.ru/<br />
hxxp://forum.nag.ru/</p>
<h2>Servers used in attack:</h2>
<p>maxcdnn[.]com (93.115.38.136)<br />
acintcdn[.]net (185.86.77.48)<br />
google-user-cache[.]com (108.61.205.41)</p>
<h2>Hashes (SHA1):</h2>
<p>0A19CC67A471A352D76ACDA6327BC179547A7A25<br />
2B1A220D523E46335823E7274093B5D44F262049<br />
19BA06ADF175E2798F17A57FD38A855C83AAE03B<br />
3EC8733AB8EAAEBD01E5379936F7181BCE4886B3</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                    Anton Cherepanov                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2015-08-11 12:00:01">11 Aug 2015 - 12:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/threats/" class="category-tag-btn">Threats</a>                                                <a href="https://www.welivesecurity.com/2019/09/12/vulnerability-instagram-private-information/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2019/09/vulnerabilidad-instagram-expone-informacion-usuarios.jpg"
                                                         alt="Firefox Under Fire: Anatomy of latest 0&#8209;day attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2019/09/12/vulnerability-instagram-private-information/">
                                                    A vulnerability in Instagram exposes personal information of users                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/threats/" class="category-tag-btn">Threats</a>                                                <a href="https://www.welivesecurity.com/2018/03/28/scanning-qr-codes-ios-11s/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/03/qrcode-623x425.jpeg"
                                                         alt="Firefox Under Fire: Anatomy of latest 0&#8209;day attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/03/28/scanning-qr-codes-ios-11s/">
                                                    Be wary when scanning QR codes with iOS 11's camera app                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/threats/" class="category-tag-btn">Threats</a>                                                <a href="https://www.welivesecurity.com/2016/12/06/service-providers-indirect-damage/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2016/12/service-providers-mobile-world-congress-623x410.jpg"
                                                         alt="Firefox Under Fire: Anatomy of latest 0&#8209;day attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2016/12/06/service-providers-indirect-damage/">
                                                    Indirect damage: Why service providers should care about customer security                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/threats/" class="category-tag-btn">Threats</a>                                                <a href="https://www.welivesecurity.com/2016/06/02/crouching-tiger-hidden-dns/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2016/05/Imagentle-623x410.jpg"
                                                         alt="Firefox Under Fire: Anatomy of latest 0&#8209;day attack">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2016/06/02/crouching-tiger-hidden-dns/">
                                                    Crouching Tiger, Hidden DNS                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F08%2F11%2Ffirefox-under-fire-anatomy-of-latest-0-day-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F08%2F11%2Ffirefox-under-fire-anatomy-of-latest-0-day-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2015%2F08%2F11%2Ffirefox-under-fire-anatomy-of-latest-0-day-attack%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"67113 \/?p=67113","disqusShortname":"welivesecurity","disqusTitle":"Firefox Under Fire: Anatomy of latest 0\u2011day attack","disqusUrl":"https:\/\/www.welivesecurity.com\/2015\/08\/11\/firefox-under-fire-anatomy-of-latest-0-day-attack\/","postId":"67113"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>